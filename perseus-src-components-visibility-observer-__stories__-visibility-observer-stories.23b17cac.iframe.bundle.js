(self.webpackChunkperseus=self.webpackChunkperseus||[]).push([[3519],{"./packages/perseus/src/components/visibility-observer/__stories__/visibility-observer.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{AlertWhenNotVisible:()=>AlertWhenNotVisible,__namedExportsOrder:()=>__namedExportsOrder,default:()=>visibility_observer_stories});var react=__webpack_require__("./node_modules/react/index.js"),react_dom=__webpack_require__("./node_modules/react-dom/index.js");__webpack_require__("./node_modules/intersection-observer/intersection-observer.js");class NativeVisibilityObserver{constructor(rootElement,onVisibilityChange,rootMargin){this._intersectionObserver=new IntersectionObserver(this._handleIntersection,{root:rootElement,threshold:Number.EPSILON,rootMargin}),this._onVisibilityChange=onVisibilityChange}_handleIntersection=entries=>{for(const entry of entries)this._onVisibilityChange(entry.isIntersecting,entry.rootBounds)};setTargetElement(targetElement){this._intersectionObserver.disconnect(),this._intersectionObserver.observe(targetElement)}disconnect(){this._intersectionObserver.disconnect()}}const getParents=function(node,parents){return node.parentNode?getParents(node.parentNode,parents.concat([node])):parents},style=function(node,prop){return getComputedStyle(node).getPropertyValue(prop)},get_scroll_parent_scroll=function(node){return/(auto|scroll)/.test(function(node){return style(node,"overflow")+style(node,"overflow-y")+style(node,"overflow-x")}(node))};function findPositionInScrollContainer(childNode,bounds,scrollParentIsNotBody){try{const scrollParent=function(node){if(!(node instanceof HTMLElement))return;const parents=node.parentNode?getParents(node.parentNode,[]):[];for(let i=0;i<parents.length;i+=1){const element=parents[i];if(get_scroll_parent_scroll(element))return element}return document.documentElement}(childNode);if(!scrollParent)return"unknown";const parentRect=scrollParent.getBoundingClientRect(),childRect=childNode.getBoundingClientRect();return(scrollParentIsNotBody&&scrollParent!==document.body?childRect.bottom<parentRect.top:childRect.bottom<bounds.top)?"hidden-above":"hidden-below"}catch(e){return"unknown"}}class VisibilityObserver extends react.Component{static defaultProps={onChange:()=>{}};componentDidMount(){this._node=react_dom.findDOMNode(this),this.registerVisibilityObserver()}componentWillUnmount(){this.unregisterVisibilityObserver()}handleVisibilityChange=(isVisible,rootBounds)=>{const{scrollParentIsNotBody,onChange}=this.props;if(isVisible)onChange("visible");else{onChange(findPositionInScrollContainer(this._node,rootBounds,!!scrollParentIsNotBody))}};registerVisibilityObserver(){const{rootMargin}=this.props;this._node&&(this._observer=function createVisibilityObserver(rootElement,onVisibilityChange,rootMargin){return new NativeVisibilityObserver(rootElement,onVisibilityChange,rootMargin)}(null,this.handleVisibilityChange,rootMargin),this._observer.setTargetElement(this._node))}unregisterVisibilityObserver(){this._observer&&this._observer.disconnect()}render(){return this.props.children}}const visibility_observer=VisibilityObserver;try{VisibilityObserver.displayName="VisibilityObserver",VisibilityObserver.__docgenInfo={description:"",displayName:"VisibilityObserver",props:{rootMargin:{defaultValue:null,description:"",name:"rootMargin",required:!1,type:{name:"string"}},scrollParentIsNotBody:{defaultValue:null,description:"",name:"scrollParentIsNotBody",required:!1,type:{name:"boolean"}},onChange:{defaultValue:{value:"() => {}"},description:"",name:"onChange",required:!1,type:{name:"(visibility: ScrollVisibility) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/perseus/src/components/visibility-observer/visibility-observer.tsx#VisibilityObserver"]={docgenInfo:VisibilityObserver.__docgenInfo,name:"VisibilityObserver",path:"packages/perseus/src/components/visibility-observer/visibility-observer.tsx#VisibilityObserver"})}catch(__react_docgen_typescript_loader_error){}const visibility_observer_stories={title:"Perseus/Components/Visibility Observer"};class VisibilityTest extends react.Component{state={sectionVisibility:"unknown"};handleVisibilityChanged=visibility=>{this.setState({sectionVisibility:visibility})};render(){const{sectionVisibility}=this.state,visibleText="visible"===sectionVisibility?"Visible":"Not Visible";return react.createElement("div",null,react.createElement("p",null,"Visibility: ",visibleText),react.createElement("p",null,"hidden-above"===sectionVisibility?"The Section IS UP HERE!!!":"---"),react.createElement("div",{style:{height:150,width:800,overflow:"scroll",backgroundColor:"white",scrollbars:"visible"}},react.createElement("p",null,"Ocicat american shorthair. Egyptian mau himalayan or grimalkin maine coon cheetah lion but himalayan. American bobtail lion kitten. Kitty bombay puma. Savannah scottish fold for tabby but sphynx for bombay kitten ragdoll. Puma russian blue yet singapura birman and kitty russian blue. Egyptian mau cheetah, donskoy for himalayan singapura abyssinian . Singapura himalayan. Malkin abyssinian but balinese but bobcat. Leopard puma, norwegian forest mouser and turkish angora. Lynx bengal tiger. American shorthair. Donskoy ragdoll. Siberian turkish angora cougar and russian blue. Burmese savannah and siamese norwegian forest yet cheetah himalayan lion. Ocelot kitten or munchkin but kitten savannah. Cougar manx or russian blue american shorthair so jaguar but havana brown. Cheetah havana brown manx. Tiger thai american bobtail. Ragdoll bengal yet kitten, bengal grimalkin scottish fold. Abyssinian jaguar. Turkish angora bengal but kitty sphynx."," "),react.createElement(visibility_observer,{scrollParentIsNotBody:!0,onChange:this.handleVisibilityChanged},react.createElement("p",{style:{backgroundColor:"#eeddee",fontWeight:"bold"}},"American shorthair devonshire rex but cheetah and ragdoll but bombay. Kitty. Tomcat cornish rex donskoy but tom donskoy havana brown. Jaguar sphynx. Cheetah kitty for kitty, but balinese . British shorthair cheetah devonshire rex birman panther. Kitten tabby but siamese, sphynx. Bombay maine coon so lynx and donskoy kitten, but cougar. Sphynx sphynx, so american bobtail or mouser or puma. Mouser munchkin and ragdoll yet mouser cheetah balinese . Egyptian mau siamese mouser, cougar ragdoll. Persian birman tabby. Norwegian forest norwegian forest cornish rex bengal. Panther bombay. Kitty siamese ragdoll and egyptian mau. Tabby. Cheetah havana brown, kitty for havana brown. Cornish rex siberian russian blue so persian but thai burmese. Maine coon puma. Lynx.")),react.createElement("p",null,"Jaguar tom but himalayan birman. Turkish angora balinese grimalkin but birman or kitty or munchkin. American shorthair bobcat. Donskoy cornish rex malkin. Ocicat tabby or siamese, birman. Devonshire rex tomcat yet thai jaguar mouser and donskoy, lynx. Grimalkin bombay."," "),react.createElement("p",null,"Eat grass, throw it back up mice and cats are fats i like to pets them they like to meow back, cough furball into food bowl then scratch owner for a new one purr as loud as possible, be the most annoying cat that you can, and, knock everything off the table, lick the other cats. Furrier and even more furrier hairball cat is love, cat is life so ooh, are those your $250 dollar sandals? lemme use that as my litter box. Lick arm hair love to play with owner's hair tie hunt anything that moves. Destroy couch as revenge when in doubt, wash.")),react.createElement("p",null,"hidden-below"===sectionVisibility?"The Section IS DOWN HERE!!!":"---"))}}const AlertWhenNotVisible=args=>react.createElement(VisibilityTest,null);AlertWhenNotVisible.parameters={...AlertWhenNotVisible.parameters,docs:{...AlertWhenNotVisible.parameters?.docs,source:{originalSource:"(args: StoryArgs): React.ReactElement => {\n  return <VisibilityTest />;\n}",...AlertWhenNotVisible.parameters?.docs?.source}}};const __namedExportsOrder=["AlertWhenNotVisible"];try{AlertWhenNotVisible.displayName="AlertWhenNotVisible",AlertWhenNotVisible.__docgenInfo={description:"",displayName:"AlertWhenNotVisible",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/perseus/src/components/visibility-observer/__stories__/visibility-observer.stories.tsx#AlertWhenNotVisible"]={docgenInfo:AlertWhenNotVisible.__docgenInfo,name:"AlertWhenNotVisible",path:"packages/perseus/src/components/visibility-observer/__stories__/visibility-observer.stories.tsx#AlertWhenNotVisible"})}catch(__react_docgen_typescript_loader_error){}},"./node_modules/intersection-observer/intersection-observer.js":()=>{!function(){"use strict";if("object"==typeof window)if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});else{var document=function(startDoc){for(var doc=window.document,frame=getFrameElement(doc);frame;)frame=getFrameElement(doc=frame.ownerDocument);return doc}(),registry=[],crossOriginUpdater=null,crossOriginRect=null;IntersectionObserver.prototype.THROTTLE_TIMEOUT=100,IntersectionObserver.prototype.POLL_INTERVAL=null,IntersectionObserver.prototype.USE_MUTATION_OBSERVER=!0,IntersectionObserver._setupCrossOriginUpdater=function(){return crossOriginUpdater||(crossOriginUpdater=function(boundingClientRect,intersectionRect){crossOriginRect=boundingClientRect&&intersectionRect?convertFromParentRect(boundingClientRect,intersectionRect):{top:0,bottom:0,left:0,right:0,width:0,height:0},registry.forEach((function(observer){observer._checkForIntersections()}))}),crossOriginUpdater},IntersectionObserver._resetCrossOriginUpdater=function(){crossOriginUpdater=null,crossOriginRect=null},IntersectionObserver.prototype.observe=function(target){if(!this._observationTargets.some((function(item){return item.element==target}))){if(!target||1!=target.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:target,entry:null}),this._monitorIntersections(target.ownerDocument),this._checkForIntersections()}},IntersectionObserver.prototype.unobserve=function(target){this._observationTargets=this._observationTargets.filter((function(item){return item.element!=target})),this._unmonitorIntersections(target.ownerDocument),0==this._observationTargets.length&&this._unregisterInstance()},IntersectionObserver.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},IntersectionObserver.prototype.takeRecords=function(){var records=this._queuedEntries.slice();return this._queuedEntries=[],records},IntersectionObserver.prototype._initThresholds=function(opt_threshold){var threshold=opt_threshold||[0];return Array.isArray(threshold)||(threshold=[threshold]),threshold.sort().filter((function(t,i,a){if("number"!=typeof t||isNaN(t)||t<0||t>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return t!==a[i-1]}))},IntersectionObserver.prototype._parseRootMargin=function(opt_rootMargin){var margins=(opt_rootMargin||"0px").split(/\s+/).map((function(margin){var parts=/^(-?\d*\.?\d+)(px|%)$/.exec(margin);if(!parts)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(parts[1]),unit:parts[2]}}));return margins[1]=margins[1]||margins[0],margins[2]=margins[2]||margins[0],margins[3]=margins[3]||margins[1],margins},IntersectionObserver.prototype._monitorIntersections=function(doc){var win=doc.defaultView;if(win&&-1==this._monitoringDocuments.indexOf(doc)){var callback=this._checkForIntersections,monitoringInterval=null,domObserver=null;this.POLL_INTERVAL?monitoringInterval=win.setInterval(callback,this.POLL_INTERVAL):(addEvent(win,"resize",callback,!0),addEvent(doc,"scroll",callback,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in win&&(domObserver=new win.MutationObserver(callback)).observe(doc,{attributes:!0,childList:!0,characterData:!0,subtree:!0})),this._monitoringDocuments.push(doc),this._monitoringUnsubscribes.push((function(){var win=doc.defaultView;win&&(monitoringInterval&&win.clearInterval(monitoringInterval),removeEvent(win,"resize",callback,!0)),removeEvent(doc,"scroll",callback,!0),domObserver&&domObserver.disconnect()}));var rootDoc=this.root&&(this.root.ownerDocument||this.root)||document;if(doc!=rootDoc){var frame=getFrameElement(doc);frame&&this._monitorIntersections(frame.ownerDocument)}}},IntersectionObserver.prototype._unmonitorIntersections=function(doc){var index=this._monitoringDocuments.indexOf(doc);if(-1!=index){var rootDoc=this.root&&(this.root.ownerDocument||this.root)||document,hasDependentTargets=this._observationTargets.some((function(item){var itemDoc=item.element.ownerDocument;if(itemDoc==doc)return!0;for(;itemDoc&&itemDoc!=rootDoc;){var frame=getFrameElement(itemDoc);if((itemDoc=frame&&frame.ownerDocument)==doc)return!0}return!1}));if(!hasDependentTargets){var unsubscribe=this._monitoringUnsubscribes[index];if(this._monitoringDocuments.splice(index,1),this._monitoringUnsubscribes.splice(index,1),unsubscribe(),doc!=rootDoc){var frame=getFrameElement(doc);frame&&this._unmonitorIntersections(frame.ownerDocument)}}}},IntersectionObserver.prototype._unmonitorAllIntersections=function(){var unsubscribes=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var i=0;i<unsubscribes.length;i++)unsubscribes[i]()},IntersectionObserver.prototype._checkForIntersections=function(){if(this.root||!crossOriginUpdater||crossOriginRect){var rootIsInDom=this._rootIsInDom(),rootRect=rootIsInDom?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach((function(item){var target=item.element,targetRect=getBoundingClientRect(target),rootContainsTarget=this._rootContainsTarget(target),oldEntry=item.entry,intersectionRect=rootIsInDom&&rootContainsTarget&&this._computeTargetAndRootIntersection(target,targetRect,rootRect),rootBounds=null;this._rootContainsTarget(target)?crossOriginUpdater&&!this.root||(rootBounds=rootRect):rootBounds={top:0,bottom:0,left:0,right:0,width:0,height:0};var newEntry=item.entry=new IntersectionObserverEntry({time:window.performance&&performance.now&&performance.now(),target,boundingClientRect:targetRect,rootBounds,intersectionRect});oldEntry?rootIsInDom&&rootContainsTarget?this._hasCrossedThreshold(oldEntry,newEntry)&&this._queuedEntries.push(newEntry):oldEntry&&oldEntry.isIntersecting&&this._queuedEntries.push(newEntry):this._queuedEntries.push(newEntry)}),this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},IntersectionObserver.prototype._computeTargetAndRootIntersection=function(target,targetRect,rootRect){if("none"!=window.getComputedStyle(target).display){for(var rect1,rect2,top,bottom,left,right,width,height,intersectionRect=targetRect,parent=getParentNode(target),atRoot=!1;!atRoot&&parent;){var parentRect=null,parentComputedStyle=1==parent.nodeType?window.getComputedStyle(parent):{};if("none"==parentComputedStyle.display)return null;if(parent==this.root||9==parent.nodeType)if(atRoot=!0,parent==this.root||parent==document)crossOriginUpdater&&!this.root?!crossOriginRect||0==crossOriginRect.width&&0==crossOriginRect.height?(parent=null,parentRect=null,intersectionRect=null):parentRect=crossOriginRect:parentRect=rootRect;else{var frame=getParentNode(parent),frameRect=frame&&getBoundingClientRect(frame),frameIntersect=frame&&this._computeTargetAndRootIntersection(frame,frameRect,rootRect);frameRect&&frameIntersect?(parent=frame,parentRect=convertFromParentRect(frameRect,frameIntersect)):(parent=null,intersectionRect=null)}else{var doc=parent.ownerDocument;parent!=doc.body&&parent!=doc.documentElement&&"visible"!=parentComputedStyle.overflow&&(parentRect=getBoundingClientRect(parent))}if(parentRect&&(rect1=parentRect,rect2=intersectionRect,top=void 0,bottom=void 0,left=void 0,right=void 0,width=void 0,height=void 0,top=Math.max(rect1.top,rect2.top),bottom=Math.min(rect1.bottom,rect2.bottom),left=Math.max(rect1.left,rect2.left),right=Math.min(rect1.right,rect2.right),height=bottom-top,intersectionRect=(width=right-left)>=0&&height>=0&&{top,bottom,left,right,width,height}||null),!intersectionRect)break;parent=parent&&getParentNode(parent)}return intersectionRect}},IntersectionObserver.prototype._getRootRect=function(){var rootRect;if(this.root&&!isDoc(this.root))rootRect=getBoundingClientRect(this.root);else{var doc=isDoc(this.root)?this.root:document,html=doc.documentElement,body=doc.body;rootRect={top:0,left:0,right:html.clientWidth||body.clientWidth,width:html.clientWidth||body.clientWidth,bottom:html.clientHeight||body.clientHeight,height:html.clientHeight||body.clientHeight}}return this._expandRectByRootMargin(rootRect)},IntersectionObserver.prototype._expandRectByRootMargin=function(rect){var margins=this._rootMarginValues.map((function(margin,i){return"px"==margin.unit?margin.value:margin.value*(i%2?rect.width:rect.height)/100})),newRect={top:rect.top-margins[0],right:rect.right+margins[1],bottom:rect.bottom+margins[2],left:rect.left-margins[3]};return newRect.width=newRect.right-newRect.left,newRect.height=newRect.bottom-newRect.top,newRect},IntersectionObserver.prototype._hasCrossedThreshold=function(oldEntry,newEntry){var oldRatio=oldEntry&&oldEntry.isIntersecting?oldEntry.intersectionRatio||0:-1,newRatio=newEntry.isIntersecting?newEntry.intersectionRatio||0:-1;if(oldRatio!==newRatio)for(var i=0;i<this.thresholds.length;i++){var threshold=this.thresholds[i];if(threshold==oldRatio||threshold==newRatio||threshold<oldRatio!=threshold<newRatio)return!0}},IntersectionObserver.prototype._rootIsInDom=function(){return!this.root||containsDeep(document,this.root)},IntersectionObserver.prototype._rootContainsTarget=function(target){var rootDoc=this.root&&(this.root.ownerDocument||this.root)||document;return containsDeep(rootDoc,target)&&(!this.root||rootDoc==target.ownerDocument)},IntersectionObserver.prototype._registerInstance=function(){registry.indexOf(this)<0&&registry.push(this)},IntersectionObserver.prototype._unregisterInstance=function(){var index=registry.indexOf(this);-1!=index&&registry.splice(index,1)},window.IntersectionObserver=IntersectionObserver,window.IntersectionObserverEntry=IntersectionObserverEntry}function getFrameElement(doc){try{return doc.defaultView&&doc.defaultView.frameElement||null}catch(e){return null}}function IntersectionObserverEntry(entry){this.time=entry.time,this.target=entry.target,this.rootBounds=ensureDOMRect(entry.rootBounds),this.boundingClientRect=ensureDOMRect(entry.boundingClientRect),this.intersectionRect=ensureDOMRect(entry.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0}),this.isIntersecting=!!entry.intersectionRect;var targetRect=this.boundingClientRect,targetArea=targetRect.width*targetRect.height,intersectionRect=this.intersectionRect,intersectionArea=intersectionRect.width*intersectionRect.height;this.intersectionRatio=targetArea?Number((intersectionArea/targetArea).toFixed(4)):this.isIntersecting?1:0}function IntersectionObserver(callback,opt_options){var options=opt_options||{};if("function"!=typeof callback)throw new Error("callback must be a function");if(options.root&&1!=options.root.nodeType&&9!=options.root.nodeType)throw new Error("root must be a Document or Element");this._checkForIntersections=function throttle(fn,timeout){var timer=null;return function(){timer||(timer=setTimeout((function(){fn(),timer=null}),timeout))}}(this._checkForIntersections.bind(this),this.THROTTLE_TIMEOUT),this._callback=callback,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(options.rootMargin),this.thresholds=this._initThresholds(options.threshold),this.root=options.root||null,this.rootMargin=this._rootMarginValues.map((function(margin){return margin.value+margin.unit})).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}function addEvent(node,event,fn,opt_useCapture){"function"==typeof node.addEventListener?node.addEventListener(event,fn,opt_useCapture||!1):"function"==typeof node.attachEvent&&node.attachEvent("on"+event,fn)}function removeEvent(node,event,fn,opt_useCapture){"function"==typeof node.removeEventListener?node.removeEventListener(event,fn,opt_useCapture||!1):"function"==typeof node.detatchEvent&&node.detatchEvent("on"+event,fn)}function getBoundingClientRect(el){var rect;try{rect=el.getBoundingClientRect()}catch(err){}return rect?(rect.width&&rect.height||(rect={top:rect.top,right:rect.right,bottom:rect.bottom,left:rect.left,width:rect.right-rect.left,height:rect.bottom-rect.top}),rect):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function ensureDOMRect(rect){return!rect||"x"in rect?rect:{top:rect.top,y:rect.top,bottom:rect.bottom,left:rect.left,x:rect.left,right:rect.right,width:rect.width,height:rect.height}}function convertFromParentRect(parentBoundingRect,parentIntersectionRect){var top=parentIntersectionRect.top-parentBoundingRect.top,left=parentIntersectionRect.left-parentBoundingRect.left;return{top,left,height:parentIntersectionRect.height,width:parentIntersectionRect.width,bottom:top+parentIntersectionRect.height,right:left+parentIntersectionRect.width}}function containsDeep(parent,child){for(var node=child;node;){if(node==parent)return!0;node=getParentNode(node)}return!1}function getParentNode(node){var parent=node.parentNode;return 9==node.nodeType&&node!=document?getFrameElement(node):(parent&&parent.assignedSlot&&(parent=parent.assignedSlot.parentNode),parent&&11==parent.nodeType&&parent.host?parent.host:parent)}function isDoc(node){return node&&9===node.nodeType}}()}}]);