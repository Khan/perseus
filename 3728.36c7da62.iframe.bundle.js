"use strict";(self.webpackChunkperseus=self.webpackChunkperseus||[]).push([[3728],{"./packages/perseus-editor/src/widgets/label-image-editor.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _khanacademy_perseus__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./packages/perseus/src/index.ts"),aphrodite__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/aphrodite/lib/index.js"),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/index.js"),_components_form_wrapped_text_field__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/perseus-editor/src/components/form-wrapped-text-field.tsx"),_label_image_answer_choices__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./packages/perseus-editor/src/widgets/label-image/answer-choices.tsx"),_label_image_behavior__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./packages/perseus-editor/src/widgets/label-image/behavior.tsx"),_label_image_question_markers__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./packages/perseus-editor/src/widgets/label-image/question-markers.tsx"),_label_image_select_image__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./packages/perseus-editor/src/widgets/label-image/select-image.tsx");class LabelImageEditor extends react__WEBPACK_IMPORTED_MODULE_2__.Component{static defaultProps={choices:[],imageAlt:"",imageUrl:"",imageWidth:0,imageHeight:0,markers:[],multipleAnswers:!1,hideChoicesFromInstructions:!1};static widgetName="label-image";componentDidUpdate(prevProps){const coordsToMarkers={};prevProps.markers.forEach((marker=>coordsToMarkers[`${marker.x}.${marker.y}`]=marker));const newIndices=this.props.markers.map(((marker,index)=>coordsToMarkers.hasOwnProperty(`${marker.x}.${marker.y}`)?-1:index)).filter((index=>-1!==index));newIndices.length&&this._questionMarkers&&this._questionMarkers.openDropdownForMarkerIndices(newIndices)}getSaveWarnings=()=>{const{choices,imageAlt,imageUrl,markers}=this.props,warnings=[];if(choices.length<2&&warnings.push("Question requires at least two answer choices"),imageUrl?imageAlt||warnings.push("Question image has no alt text"):warnings.push("Image is not specified for question"),markers.length){let numNoAnswers=0,numNoLabels=0;for(const marker of markers)marker.answers.length||numNoAnswers++,marker.label||numNoLabels++;numNoAnswers&&warnings.push(`Question has ${numNoAnswers} markers with no answers selected`),numNoLabels&&warnings.push(`Question has ${numNoLabels} markers with no ARIA label`)}else warnings.push("Question has no markers, to label answers on image");return warnings};serialize(){return _khanacademy_perseus__WEBPACK_IMPORTED_MODULE_0__.yU.serialize.call(this)}handleImageChange=url=>{this.props.onChange({imageUrl:url,imageWidth:0,imageHeight:0}),url&&_khanacademy_perseus__WEBPACK_IMPORTED_MODULE_0__.Util.getImageSize(url,((width,height)=>{this.props.onChange({imageWidth:width,imageHeight:height})}))};handleAltChange=alt=>{this.props.onChange({imageAlt:alt})};handleChoicesChange=choices=>{this.props.onChange({choices})};handleMarkersChange=markers=>{this.props.onChange({markers})};handleBehaviorChange=options=>{this.props.onChange(options)};render(){const{choices,imageAlt,imageUrl,imageWidth,imageHeight,markers,multipleAnswers,hideChoicesFromInstructions}=this.props,imageSelected=imageUrl&&imageWidth>0&&imageHeight>0;return react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_2__.createElement(_label_image_select_image__WEBPACK_IMPORTED_MODULE_7__.Z,{onChange:this.handleImageChange,url:imageUrl}),react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:(0,aphrodite__WEBPACK_IMPORTED_MODULE_1__.css)(styles.smallSpacer)}),imageSelected&&react__WEBPACK_IMPORTED_MODULE_2__.createElement(_components_form_wrapped_text_field__WEBPACK_IMPORTED_MODULE_3__.Z,{placeholder:"Alt text (for screen readers)",onChange:e=>this.handleAltChange(e.target.value),value:imageAlt,width:"100%"}),react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:(0,aphrodite__WEBPACK_IMPORTED_MODULE_1__.css)(styles.largeSpacer)}),react__WEBPACK_IMPORTED_MODULE_2__.createElement(_label_image_question_markers__WEBPACK_IMPORTED_MODULE_6__.Z,{choices,imageUrl:imageSelected?imageUrl:"",imageWidth,imageHeight,markers,onChange:this.handleMarkersChange,ref:node=>this._questionMarkers=node}),react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:(0,aphrodite__WEBPACK_IMPORTED_MODULE_1__.css)(styles.largeSpacer)}),react__WEBPACK_IMPORTED_MODULE_2__.createElement(_label_image_answer_choices__WEBPACK_IMPORTED_MODULE_4__.Z,{choices,onChange:this.handleChoicesChange}),react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:(0,aphrodite__WEBPACK_IMPORTED_MODULE_1__.css)(styles.largeSpacer)}),react__WEBPACK_IMPORTED_MODULE_2__.createElement(_label_image_behavior__WEBPACK_IMPORTED_MODULE_5__.Z,{multipleAnswers,hideChoicesFromInstructions,onChange:this.handleBehaviorChange}))}}const styles=aphrodite__WEBPACK_IMPORTED_MODULE_1__.StyleSheet.create({largeSpacer:{height:32},smallSpacer:{height:16}}),__WEBPACK_DEFAULT_EXPORT__=LabelImageEditor;try{LabelImageEditor.displayName="LabelImageEditor",LabelImageEditor.__docgenInfo={description:"",displayName:"LabelImageEditor",props:{choices:{defaultValue:{value:"[]"},description:"",name:"choices",required:!1,type:{name:"readonly string[]"}},imageAlt:{defaultValue:{value:""},description:"",name:"imageAlt",required:!1,type:{name:"string"}},imageUrl:{defaultValue:{value:""},description:"",name:"imageUrl",required:!1,type:{name:"string"}},imageWidth:{defaultValue:{value:"0"},description:"",name:"imageWidth",required:!1,type:{name:"number"}},imageHeight:{defaultValue:{value:"0"},description:"",name:"imageHeight",required:!1,type:{name:"number"}},markers:{defaultValue:{value:"[]"},description:"",name:"markers",required:!1,type:{name:"readonly MarkerType[]"}},multipleAnswers:{defaultValue:{value:"false"},description:"",name:"multipleAnswers",required:!1,type:{name:"boolean"}},hideChoicesFromInstructions:{defaultValue:{value:"false"},description:"",name:"hideChoicesFromInstructions",required:!1,type:{name:"boolean"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(options: any) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/perseus-editor/src/widgets/label-image-editor.tsx#LabelImageEditor"]={docgenInfo:LabelImageEditor.__docgenInfo,name:"LabelImageEditor",path:"packages/perseus-editor/src/widgets/label-image-editor.tsx#LabelImageEditor"})}catch(__react_docgen_typescript_loader_error){}},"./packages/perseus-editor/src/widgets/label-image/answer-choices.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>answer_choices});var src=__webpack_require__("./packages/perseus/src/index.ts"),lib=__webpack_require__("./node_modules/aphrodite/lib/index.js"),react=__webpack_require__("./node_modules/react/index.js"),form_wrapped_text_field=__webpack_require__("./packages/perseus-editor/src/components/form-wrapped-text-field.tsx");class Link extends react.Component{static defaultProps={highlighted:!1,href:"javascript:void(0)",style:[],element:"a"};render(){const{children,className,highlighted,href,inlineStyles,referrer,style,target,testId,element,...otherProps}=this.props,[hrefWithoutHash,hash]=href?href.split("#"):["javascript:void(0)"];let url=hrefWithoutHash;referrer&&(url.indexOf("?")>-1?url+="&ref="+referrer:url+="?ref="+referrer),hash&&(url+="#"+hash);const delegatedStyles=[styles.link,highlighted&&styles.highlighted];Array.isArray(style)?delegatedStyles.push(...style):delegatedStyles.push(style);const delegatedClassName=className?" "+className:"",urlProp="a"===element?{href:url}:{to:url};let rel=otherProps.rel;return"_blank"!==target||rel||(rel="noopener noreferrer"),react.createElement(element,{"data-test-id":testId,...otherProps,...urlProp,className:(0,lib.css)(...delegatedStyles)+delegatedClassName,style:inlineStyles,target,rel},children)}}const styles=lib.StyleSheet.create({link:{backgroundColor:"transparent",color:"inherit",textDecoration:"none",":hover":{textDecoration:"underline"}},highlighted:{textDecoration:"underline"}}),components_link=Link,{colors,typography}=src.globalStyles,{Icon}=src.components,addIcon={path:"M11 11V7a1 1 0 0 1 2 0v4h4a1 1 0 0 1 0 2h-4v4a1 1 0 0 1-2 0v-4H7a1 1 0 0 1 0-2h4zm1 13C5.373 24 0 18.627 0 12S5.373 0 12 0s12 5.373 12 12-5.373 12-12 12zm0-2c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z",width:24,height:24},removeIcon={path:"M12 24C5.373 24 0 18.627 0 12S5.373 0 12 0s12 5.373 12 12-5.373 12-12 12zm0-2c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10zm-5-9a1 1 0 0 1 0-2h10a1 1 0 0 1 0 2H7z",width:24,height:24},DraggableGripIcon=()=>react.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16"},react.createElement("filter",{id:"draggable-grip-shadow",width:"112.5%",height:"116.7%",x:"-6.2%",y:"-8.3%",filterUnits:"objectBoundingBox"},react.createElement("feGaussianBlur",{in:"SourceAlpha",stdDeviation:".5",result:"shadowBlurInner"}),react.createElement("feOffset",{in:"shadowBlurInner",dy:"1",result:"shadowOffsetInner"}),react.createElement("feComposite",{in:"shadowOffsetInner",in2:"SourceAlpha",k2:"-1",k3:"1",operator:"arithmetic",result:"shadowInnerInner"}),react.createElement("feColorMatrix",{in:"shadowInnerInner",values:"0 0 0 0 0.129411765 0 0 0 0 0.141176471 0 0 0 0 0.17254902 0 0 0 0.2 0"})),react.createElement("path",{d:"M1 4a1 1 0 1 1 0-2h14a1 1 0 0 1 0 2H1zm0 10a1 1 0 0 1 0-2h14a1 1 0 0 1 0 2H1zm0-5a1 1 0 1 1 0-2h14a1 1 0 0 1 0 2H1z",fill:colors.gray17,filter:"url(#draggable-grip-shadow)"})),AddAnswer=_ref=>{let{onClick}=_ref;return react.createElement(components_link,{className:(0,lib.css)(answer_choices_styles.addAnswer,editorStyles.addAnswer),onClick},react.createElement(Icon,{icon:addIcon,size:24}),react.createElement("div",{className:(0,lib.css)(answer_choices_styles.spacer)}),"Add an answer choice")},Answer=_ref2=>{let{answer,onChange,onRemove}=_ref2;return react.createElement("li",{className:(0,lib.css)(answer_choices_styles.answer)},react.createElement(components_link,{onClick:onRemove},react.createElement(Icon,{icon:removeIcon,size:24,color:"#D92916"})),react.createElement("div",{className:(0,lib.css)(answer_choices_styles.spacer)}),react.createElement(form_wrapped_text_field.Z,{grow:1,onChange:e=>onChange(e.target.value),value:answer}),react.createElement("div",{className:(0,lib.css)(answer_choices_styles.spacer)}),react.createElement(components_link,{style:[answer_choices_styles.disabled],title:"Answer reordering is not implemented."},react.createElement(DraggableGripIcon,null)))},answer_choices_styles=lib.StyleSheet.create({title:{...typography.bodyXsmallBold,marginBottom:6,color:colors.gray17},answers:{marginTop:12,marginBottom:12},answer:{display:"flex",flexDirection:"row",alignItems:"center",":not(:first-child)":{marginTop:12}},addAnswer:{...typography.bodyXsmallBold,display:"flex",flexDirection:"row",alignItems:"center",color:"#1865f2"},spacer:{width:16},disabled:{cursor:"not-allowed"}}),editorStyles=lib.StyleSheet.create({addAnswer:{":link":{color:"#1865f2"}}}),answer_choices=_ref3=>{let{choices,onChange}=_ref3;return react.createElement("div",null,react.createElement("div",{className:(0,lib.css)(answer_choices_styles.title)},"Answer Choices"),react.createElement("ul",{className:(0,lib.css)(answer_choices_styles.answers)},choices.map(((answer,index)=>react.createElement(Answer,{answer,key:index,onChange:answer=>onChange([...choices.slice(0,index),answer,...choices.slice(index+1)]),onRemove:()=>onChange([...choices.slice(0,index),...choices.slice(index+1)])})))),react.createElement(AddAnswer,{onClick:()=>onChange([...choices,""])}))};try{answerchoices.displayName="answerchoices",answerchoices.__docgenInfo={description:"The list of choices, handles adding, removing and reording of answers.",displayName:"answerchoices",props:{choices:{defaultValue:null,description:"",name:"choices",required:!0,type:{name:"readonly string[]"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(choices: readonly string[]) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/perseus-editor/src/widgets/label-image/answer-choices.tsx#answerchoices"]={docgenInfo:answerchoices.__docgenInfo,name:"answerchoices",path:"packages/perseus-editor/src/widgets/label-image/answer-choices.tsx#answerchoices"})}catch(__react_docgen_typescript_loader_error){}},"./packages/perseus-editor/src/widgets/label-image/behavior.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>label_image_behavior});var src=__webpack_require__("./packages/perseus/src/index.ts"),lib=__webpack_require__("./node_modules/aphrodite/lib/index.js"),react=__webpack_require__("./node_modules/react/index.js");class HoverBehavior extends react.Component{static defaultProps={startHovered:!1,shouldUpdate:()=>!0};constructor(props){super(props),this.state={focused:!1,hovered:props.startHovered}}handleClick=e=>{this.props.disabled||(this.props.shouldUpdate()&&(this.waitingForClick=!1),this.props.onClick&&!this.props.disabled&&this.props.onClick(e))};handleMouseEnter=()=>{this.props.disabled||!this.props.shouldUpdate()||this.waitingForClick||this.setState({hovered:!0})};handleMouseLeave=()=>{this.props.disabled||!this.props.shouldUpdate()||this.waitingForClick||this.setState({hovered:!1})};handleTouchStart=()=>{!this.props.disabled&&this.props.shouldUpdate()&&this.setState({hovered:!0})};handleTouchEnd=()=>{!this.props.disabled&&this.props.shouldUpdate()&&(this.setState({hovered:!1}),this.waitingForClick=!0)};handleMouseDown=()=>{!this.props.disabled&&this.props.shouldUpdate()&&(this.setState({focused:!1}),this.focusFlag=!0)};handleBlur=()=>{!this.props.disabled&&this.props.shouldUpdate()&&this.setState({focused:!1})};handleFocus=()=>{!this.props.disabled&&this.props.shouldUpdate()&&(this.focusFlag?this.focusFlag=!1:this.setState({focused:!0}))};render(){const handlers={onBlur:this.handleBlur,onClick:this.handleClick,onFocus:this.handleFocus,onMouseDown:this.handleMouseDown,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd},{children}=this.props;return children?.(this.state,handlers)||null}}function _extends(){return _extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}const{borderRadius,colors}=src.globalStyles,onChangeCheckboxNoop=event=>{};class Checkbox extends react.Component{static defaultProps={checked:!1,onChange:onChangeCheckboxNoop};render(){const{checked,disabled,appearDisabled,onChange,tabIndex,style,dataTestId,id}=this.props,checkedColor=colors.gray41;return react.createElement(HoverBehavior,null,((_ref,handlers)=>{let{focused}=_ref;return react.createElement("div",_extends({},handlers,{className:(0,lib.css)(styles.container,focused&&styles.focused),style,"data-test-id":dataTestId,"data-checked":checked}),react.createElement("svg",{className:(0,lib.css)(styles.svg,(disabled||appearDisabled)&&styles.disabled),width:sizeWithPadding,height:sizeWithPadding,viewBox:`-${padding} -${padding}\n                         ${sizeWithPadding} ${sizeWithPadding}`},react.createElement("g",{fill:"none",fillRule:"evenodd"},checked&&react.createElement("g",null,react.createElement("rect",{fill:checkedColor,width:size,height:size,x:"0",y:"0",rx:borderRadius}),react.createElement("path",{fill:colors.white,stroke:colors.white,d:"M4.98 7.41a0.58.58 0 1 0-0.81.81L6.47 10.53c0.23.23.59.23.81 0l4.55-4.55a0.58.58 0 0 0-0.81-0.81L6.88 9.31 4.98 7.41z"})),!checked&&react.createElement("rect",{fill:colors.white,stroke:colors.gray68,width:size-2*padding,height:size-2*padding,x:padding,y:padding,rx:"4",strokeWidth:borderWidth}))),react.createElement("input",{type:"checkbox",id,checked,className:(0,lib.css)(styles.checkbox,disabled&&styles.defaultCursor),disabled,onChange,tabIndex}))}))}}const size=16,padding=.5,borderWidth=1,sizeWithPadding=size+2*padding,styles=lib.StyleSheet.create({container:{position:"relative",display:"inline-block",verticalAlign:"middle",lineHeight:0,borderRadius,width:sizeWithPadding,height:sizeWithPadding,flexShrink:0},focused:{"::before":{content:'""',position:"absolute",top:-2,right:-2,bottom:-2,left:-2,borderRadius:borderRadius+2,backgroundColor:"lightblue"}},svg:{position:"absolute",left:0,top:0},checkbox:{appearance:"none",opacity:0,position:"absolute",top:padding,width:size,height:size,margin:0,outline:"none",cursor:"pointer"},disabled:{opacity:.5},defaultCursor:{cursor:"default"}});try{checkbox.displayName="checkbox",checkbox.__docgenInfo={description:"",displayName:"checkbox",props:{checked:{defaultValue:{value:"false"},description:"",name:"checked",required:!1,type:{name:"boolean"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},appearDisabled:{defaultValue:null,description:"",name:"appearDisabled",required:!1,type:{name:"boolean"}},onChange:{defaultValue:{value:"(event: React.ChangeEvent<HTMLInputElement>) => {}"},description:"",name:"onChange",required:!1,type:{name:"(event: ChangeEvent<HTMLInputElement>) => void"}},tabIndex:{defaultValue:null,description:"",name:"tabIndex",required:!1,type:{name:"string | number"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"{ marginTop: number; }"}},dataTestId:{defaultValue:null,description:"",name:"dataTestId",required:!1,type:{name:"string"}},id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/perseus-editor/src/components/checkbox.tsx#checkbox"]={docgenInfo:checkbox.__docgenInfo,name:"checkbox",path:"packages/perseus-editor/src/components/checkbox.tsx#checkbox"})}catch(__react_docgen_typescript_loader_error){}const{colors:behavior_colors,typography}=src.globalStyles,behavior_styles=lib.StyleSheet.create({title:{...typography.bodyXsmallBold,marginBottom:6,color:behavior_colors.gray17},option:{display:"flex",padding:"6px 0"},label:{...typography.smallSubheadingMobile,marginLeft:16,color:behavior_colors.gray17}}),label_image_behavior=_ref=>{let{multipleAnswers,hideChoicesFromInstructions,onChange}=_ref;return react.createElement("div",null,react.createElement("div",{className:(0,lib.css)(behavior_styles.title)},"Behavior"),react.createElement("ul",null,react.createElement("li",{className:(0,lib.css)(behavior_styles.option)},react.createElement(Checkbox,{checked:multipleAnswers,onChange:()=>onChange({multipleAnswers:!multipleAnswers})}),react.createElement("span",{className:(0,lib.css)(behavior_styles.label)},"Allow multiple answers per marker")),react.createElement("li",{className:(0,lib.css)(behavior_styles.option)},react.createElement(Checkbox,{checked:hideChoicesFromInstructions,onChange:()=>onChange({hideChoicesFromInstructions:!hideChoicesFromInstructions})}),react.createElement("span",{className:(0,lib.css)(behavior_styles.label)},"Do not display answer choices in instructions"))))};try{behavior.displayName="behavior",behavior.__docgenInfo={description:"",displayName:"behavior",props:{multipleAnswers:{defaultValue:null,description:"",name:"multipleAnswers",required:!0,type:{name:"boolean"}},hideChoicesFromInstructions:{defaultValue:null,description:"",name:"hideChoicesFromInstructions",required:!0,type:{name:"boolean"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(options: { multipleAnswers?: boolean | undefined; hideChoicesFromInstructions?: boolean | undefined; }) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/perseus-editor/src/widgets/label-image/behavior.tsx#behavior"]={docgenInfo:behavior.__docgenInfo,name:"behavior",path:"packages/perseus-editor/src/widgets/label-image/behavior.tsx#behavior"})}catch(__react_docgen_typescript_loader_error){}},"./packages/perseus-editor/src/widgets/label-image/question-markers.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>QuestionMarkers});var _khanacademy_perseus__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./packages/perseus/src/index.ts"),aphrodite__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/aphrodite/lib/index.js"),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/index.js"),_marker__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/perseus-editor/src/widgets/label-image/marker.tsx");function _extends(){return _extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}const{colors,typography}=_khanacademy_perseus__WEBPACK_IMPORTED_MODULE_0__.globalStyles;class QuestionMarkers extends react__WEBPACK_IMPORTED_MODULE_2__.Component{_markers=[];openDropdownForMarkerIndices(indices){indices.forEach((index=>{this._markers[index]&&this._markers[index].openDropdown()}))}handleImageDoubleClick=e=>{e.preventDefault();const rect=e.currentTarget.getBoundingClientRect(),x=Math.round((e.clientX-rect.left)/rect.width*1e3)/10,y=Math.round((e.clientY-rect.top)/rect.height*1e3)/10,{markers,onChange}=this.props;onChange([...markers,{answers:[],label:"",x,y}])};render(){const{choices,imageUrl,imageWidth,imageHeight,markers,onChange}=this.props,staticUrl=_khanacademy_perseus__WEBPACK_IMPORTED_MODULE_0__.Dependencies.getDependencies().staticUrl;return react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:(0,aphrodite__WEBPACK_IMPORTED_MODULE_1__.css)(styles.title)},"Markers"),react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:(0,aphrodite__WEBPACK_IMPORTED_MODULE_1__.css)(styles.subtitle)},imageUrl?react__WEBPACK_IMPORTED_MODULE_2__.createElement("span",null,"Double-click on the image to add a marker.",react__WEBPACK_IMPORTED_MODULE_2__.createElement("br",null),react__WEBPACK_IMPORTED_MODULE_2__.createElement("br",null),"Markers are read by screen readers in the order that you add them here, so add in a logical order for the learner (e.g. sequentially, clockwise). You can test order by using keyboard tabbing."):"Upload an image to place markers."),imageUrl&&react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:(0,aphrodite__WEBPACK_IMPORTED_MODULE_1__.css)(styles.markersCanvas),style:{maxWidth:imageWidth,maxHeight:imageHeight}},react__WEBPACK_IMPORTED_MODULE_2__.createElement("img",{alt:"",className:(0,aphrodite__WEBPACK_IMPORTED_MODULE_1__.css)(styles.image),src:staticUrl(_khanacademy_perseus__WEBPACK_IMPORTED_MODULE_0__.Util.getRealImageUrl(imageUrl)),onDoubleClick:this.handleImageDoubleClick}),markers.map(((marker,index)=>react__WEBPACK_IMPORTED_MODULE_2__.createElement(_marker__WEBPACK_IMPORTED_MODULE_3__.Z,_extends({},marker,{choices,key:`${marker.x}.${marker.y}`,onChange:marker=>onChange([...markers.slice(0,index),marker,...markers.slice(index+1)]),onRemove:()=>onChange([...markers.slice(0,index),...markers.slice(index+1)]),ref:node=>this._markers[index]=node}))))))}}const styles=aphrodite__WEBPACK_IMPORTED_MODULE_1__.StyleSheet.create({title:{...typography.bodyXsmallBold,marginBottom:6,color:colors.gray17},subtitle:{...typography.labelSmall,marginBottom:12,color:colors.gray68},markersCanvas:{position:"relative",border:"solid 1px rgba(33, 36, 44, 0.16)"},image:{display:"block",maxWidth:"100%"}});try{questionmarkers.displayName="questionmarkers",questionmarkers.__docgenInfo={description:"",displayName:"questionmarkers",props:{choices:{defaultValue:null,description:"",name:"choices",required:!0,type:{name:"readonly string[]"}},imageUrl:{defaultValue:null,description:"",name:"imageUrl",required:!0,type:{name:"string"}},imageWidth:{defaultValue:null,description:"",name:"imageWidth",required:!0,type:{name:"number"}},imageHeight:{defaultValue:null,description:"",name:"imageHeight",required:!0,type:{name:"number"}},markers:{defaultValue:null,description:"",name:"markers",required:!0,type:{name:"readonly MarkerType[]"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(markers: readonly MarkerType[]) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/perseus-editor/src/widgets/label-image/question-markers.tsx#questionmarkers"]={docgenInfo:questionmarkers.__docgenInfo,name:"questionmarkers",path:"packages/perseus-editor/src/widgets/label-image/question-markers.tsx#questionmarkers"})}catch(__react_docgen_typescript_loader_error){}},"./packages/perseus-editor/src/widgets/label-image/select-image.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _khanacademy_perseus__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./packages/perseus/src/index.ts"),_khanacademy_wonder_blocks_button__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@khanacademy/wonder-blocks-button/dist/es/index.js"),aphrodite__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/aphrodite/lib/index.js"),react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/index.js"),_components_form_wrapped_text_field__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./packages/perseus-editor/src/components/form-wrapped-text-field.tsx");const{colors,typography}=_khanacademy_perseus__WEBPACK_IMPORTED_MODULE_0__.globalStyles,styles=aphrodite__WEBPACK_IMPORTED_MODULE_2__.StyleSheet.create({title:{...typography.bodyXsmallBold,marginBottom:6,color:colors.gray17},components:{display:"flex"},spacer:{width:16},btn:{minWidth:90}}),__WEBPACK_DEFAULT_EXPORT__=_ref=>{let{onChange,url}=_ref;return react__WEBPACK_IMPORTED_MODULE_3__.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_3__.createElement("div",{className:(0,aphrodite__WEBPACK_IMPORTED_MODULE_2__.css)(styles.title)},"Image"),react__WEBPACK_IMPORTED_MODULE_3__.createElement("div",{className:(0,aphrodite__WEBPACK_IMPORTED_MODULE_2__.css)(styles.components)},react__WEBPACK_IMPORTED_MODULE_3__.createElement(_components_form_wrapped_text_field__WEBPACK_IMPORTED_MODULE_4__.Z,{placeholder:"URL",grow:1,onChange:e=>onChange(e.target.value),value:url}),react__WEBPACK_IMPORTED_MODULE_3__.createElement("div",{className:(0,aphrodite__WEBPACK_IMPORTED_MODULE_2__.css)(styles.spacer)}),react__WEBPACK_IMPORTED_MODULE_3__.createElement(_khanacademy_wonder_blocks_button__WEBPACK_IMPORTED_MODULE_1__.Z,{disabled:!url,"aria-label":url?"":"Not implemented. Use the 'Add Image' button in the editor to upload image, then copy the URL here.",onClick:()=>onChange(""),style:styles.btn},url?"Remove":"Upload")))};try{selectimage.displayName="selectimage",selectimage.__docgenInfo={description:"",displayName:"selectimage",props:{onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(url: string) => void"}},url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/perseus-editor/src/widgets/label-image/select-image.tsx#selectimage"]={docgenInfo:selectimage.__docgenInfo,name:"selectimage",path:"packages/perseus-editor/src/widgets/label-image/select-image.tsx#selectimage"})}catch(__react_docgen_typescript_loader_error){}}}]);