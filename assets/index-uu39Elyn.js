import{r as o}from"./index-qhcEwEpg.js";const a={Immediately:"schedule-immediately",OnDemand:"schedule-on-demand"},n={Resolve:"resolve-on-clear",Cancel:"cancel-on-clear"};class u{constructor(t,e,i=a.Immediately){if(this._timeoutId=void 0,this._action=void 0,this._timeoutMs=void 0,typeof t!="function")throw new Error("Action must be a function");if(e<0)throw new Error("Timeout period must be >= 0");this._action=t,this._timeoutMs=e,i===a.Immediately&&this.set()}get isSet(){return this._timeoutId!=null}set(){this.isSet&&this.clear(n.Cancel),this._timeoutId=setTimeout(()=>this.clear(n.Resolve),this._timeoutMs)}clear(t=n.Cancel){const e=this._timeoutId;this._timeoutId=null,e!=null&&(clearTimeout(e),t===n.Resolve&&this._action())}}class h{constructor(t,e,i=a.Immediately){if(this._intervalId=void 0,this._action=void 0,this._intervalMs=void 0,typeof t!="function")throw new Error("Action must be a function");if(e<1)throw new Error("Interval period must be >= 1");this._action=t,this._intervalMs=e,i===a.Immediately&&this.set()}get isSet(){return this._intervalId!=null}set(){this.isSet&&this.clear(n.Cancel),this._intervalId=setInterval(()=>this._action(),this._intervalMs)}clear(t=n.Cancel){const e=this._intervalId;this._intervalId=null,e!=null&&(clearInterval(e),t===n.Resolve&&this._action())}}class d{constructor(t,e=a.Immediately){if(this._animationFrameId=void 0,this._action=void 0,typeof t!="function")throw new Error("Action must be a function");this._action=t,e===a.Immediately&&this.set()}get isSet(){return this._animationFrameId!=null}set(){this.isSet&&this.clear(n.Cancel),this._animationFrameId=requestAnimationFrame(t=>this.clear(n.Resolve,t))}clear(t=n.Cancel,e){const i=this._animationFrameId;this._animationFrameId=null,i!=null&&(cancelAnimationFrame(i),t===n.Resolve&&this._action(e||performance.now()))}}class l{constructor(){this._disabled=!1,this._registeredActions=[]}timeout(t,e,i){if(this._disabled)return l.NoopAction;const s=new u(t,e,i==null?void 0:i.schedulePolicy);return this._registeredActions.push(()=>s.clear(i==null?void 0:i.clearPolicy)),s}interval(t,e,i){if(this._disabled)return l.NoopAction;const s=new h(t,e,i==null?void 0:i.schedulePolicy);return this._registeredActions.push(()=>s.clear(i==null?void 0:i.clearPolicy)),s}animationFrame(t,e){if(this._disabled)return l.NoopAction;const i=new d(t,e==null?void 0:e.schedulePolicy);return this._registeredActions.push(()=>i.clear(e==null?void 0:e.clearPolicy)),i}clearAll(){const t=[...this._registeredActions];this._registeredActions=[],t.forEach(e=>e())}disable(){this._disabled=!0,this.clearAll()}}l.NoopAction={set:()=>{},get isSet(){return!1},clear:()=>{}};class m extends o.Component{constructor(...t){super(...t),this._actionScheduler=new l}componentWillUnmount(){this._actionScheduler.disable()}render(){const{children:t}=this.props;return t(this._actionScheduler)}}function c(){return c=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},c.apply(this,arguments)}function f(r){const t=`withActionScheduler(${r.displayName||r.name})`,e=i=>o.createElement(m,null,s=>o.createElement(r,c({},i,{schedule:s})));return e.displayName=t,e}export{f as w};
