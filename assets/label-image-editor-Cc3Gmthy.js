var y=Object.defineProperty;var C=(l,o,e)=>o in l?y(l,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[o]=e;var i=(l,o,e)=>(C(l,typeof o!="symbol"?o+"":o,e),e);import{j as t}from"./jsx-runtime-BT65X5dW.js";import"./index-default-BcKQpA1a.js";import"./index-D4RUTT-W.js";import{l as k,U as v}from"./util-CrZiaDht.js";import"./all-widgets-XF60Wo7n.js";import"./index-DBQpxcp6.js";import"./answer-choices-WdG_zQRn.js";import"./index-CltwzEvY.js";import{r as w}from"./index-C6mWTJJr.js";import"./index-B1Gws05u.js";import"./i18n-context-3AkWzTTj.js";import"./perseus-api-DVNrAHa_.js";import"./renderer-3GL5f_A0.js";import"./index-D7h-teXI.js";import"./jquery-CkHB0_Mt.js";import"./dependencies-BsVPGK1s.js";import"./zoomable-tex-Dy-nElJT.js";import"./svg-image-DqgMiLy8.js";import{n as h}from"./no-important-DlFk8a1I.js";import"./number-input-CCpvAvJd.js";import"./simple-keypad-input-dM_dVtNP.js";import"./text-input-BpDjKk2n.js";import"./phet-simulation-Dwl7eCLH.js";import"./sortable-BCmqu_o5.js";import"./fixed-to-responsive-CTsII9Xx.js";import"./math-input-DwJIx8gh.js";import"./video-transcript-link-7CsmY5l0.js";import"./item-version-DD_Gxog4.js";import"./article-renderer-LQMIjGHl.js";import"./server-item-renderer-DpAc5pGB.js";import"./hints-renderer-DGFAhmFj.js";import"./base-radio-DdZUVbla.js";import"./button-group-B24xCvY2.js";import"./hud-CP_ly967.js";import"./icon-BfyZ3piz.js";import"./index-C4QcQXcY.js";import"./inline-icon-AJRwMA4Z.js";import"./multi-button-group-U6RQwTwG.js";import"./range-input-CCItGE6x.js";import"./text-list-editor-C2gddtxS.js";import"./index-Dd-cahjY.js";import{E as A}from"./editor-jsonify-Bx7jzhrT.js";import{F as x}from"./form-wrapped-text-field-BTRvuk8B.js";import{A as b}from"./answer-choices-cZ8Vg97u.js";import{B as I}from"./behavior-DVs9g8xZ.js";import{Q as q}from"./question-markers-MkMMBEys.js";import{S}from"./select-image-DGlQotmY.js";class c extends w.Component{constructor(){super(...arguments);i(this,"_questionMarkers");i(this,"getSaveWarnings",()=>{const{choices:e,imageAlt:n,imageUrl:s,markers:a}=this.props,r=[];if(e.length<2&&r.push("Question requires at least two answer choices"),s?n||r.push("Question image has no alt text"):r.push("Image is not specified for question"),!a.length)r.push("Question has no markers, to label answers on image");else{let m=0,p=0;for(const d of a)d.answers.length||m++,d.label||p++;m&&r.push(`Question has ${m} markers with no answers selected`),p&&r.push(`Question has ${p} markers with no ARIA label`)}return r});i(this,"handleImageChange",e=>{this.props.onChange({imageUrl:e,imageWidth:0,imageHeight:0}),e&&v.getImageSize(e,(n,s)=>{this.props.onChange({imageUrl:e,imageWidth:n,imageHeight:s})})});i(this,"handleAltChange",e=>{this.props.onChange({imageAlt:e})});i(this,"handleChoicesChange",e=>{this.props.onChange({choices:e})});i(this,"handleMarkersChange",e=>{this.props.onChange({markers:e})});i(this,"handleBehaviorChange",e=>{this.props.onChange(e)})}componentDidUpdate(e){const n={};e.markers.forEach(a=>n[`${a.x}.${a.y}`]=a);const s=this.props.markers.map((a,r)=>n.hasOwnProperty(`${a.x}.${a.y}`)?-1:r).filter(a=>a!==-1);s.length&&this._questionMarkers&&this._questionMarkers.openDropdownForMarkerIndices(s)}serialize(){return A.serialize.call(this)}render(){const{choices:e,imageAlt:n,imageUrl:s,imageWidth:a,imageHeight:r,markers:m,multipleAnswers:p,hideChoicesFromInstructions:d}=this.props,f=s&&a>0&&r>0;return t.jsxs("div",{children:[t.jsx(S,{onChange:this.handleImageChange,url:s}),t.jsx("div",{className:h.css(u.smallSpacer)}),f&&t.jsx(x,{placeholder:"Alt text (for screen readers)",onChange:g=>this.handleAltChange(g.target.value),value:n,width:"100%"}),t.jsx("div",{className:h.css(u.largeSpacer)}),t.jsx(q,{choices:e,imageUrl:f?s:"",imageWidth:a,imageHeight:r,markers:m,onChange:this.handleMarkersChange,ref:g=>this._questionMarkers=g}),t.jsx("div",{className:h.css(u.largeSpacer)}),t.jsx(b,{choices:e,onChange:this.handleChoicesChange}),t.jsx("div",{className:h.css(u.largeSpacer)}),t.jsx(I,{preferredPopoverDirection:"NONE",multipleAnswers:p,hideChoicesFromInstructions:d,onChange:this.handleBehaviorChange})]})}}i(c,"defaultProps",k.defaultWidgetOptions),i(c,"widgetName","label-image");const u=h.StyleSheet.create({largeSpacer:{height:32},smallSpacer:{height:16}});c.__docgenInfo={description:"",methods:[{name:"getSaveWarnings",docblock:null,modifiers:[],params:[],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:{type:{name:"any"}}},{name:"handleImageChange",docblock:null,modifiers:[],params:[{name:"url",optional:!1,type:{name:"string"}}],returns:null},{name:"handleAltChange",docblock:null,modifiers:[],params:[{name:"alt",optional:!1,type:{name:"string"}}],returns:null},{name:"handleChoicesChange",docblock:null,modifiers:[],params:[{name:"choices",optional:!1,type:{name:"ReadonlyArray",elements:[{name:"string"}],raw:"ReadonlyArray<string>",alias:"ReadonlyArray"}}],returns:null},{name:"handleMarkersChange",docblock:null,modifiers:[],params:[{name:"markers",optional:!1,type:{name:"Array",raw:'PerseusLabelImageWidgetOptions["markers"]'}}],returns:null},{name:"handleBehaviorChange",docblock:null,modifiers:[],params:[{name:"options",optional:!1,type:{name:"any"}}],returns:null}],displayName:"LabelImageEditor",props:{choices:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:"",defaultValue:{value:"[]",computed:!1}},imageAlt:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'""',computed:!1}},imageUrl:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'""',computed:!1}},imageWidth:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},imageHeight:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},markers:{required:!1,tsType:{name:"Array",raw:'PerseusLabelImageWidgetOptions["markers"]'},description:"",defaultValue:{value:"[]",computed:!1}},multipleAnswers:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},hideChoicesFromInstructions:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(options: any) => void",signature:{arguments:[{type:{name:"any"},name:"options"}],return:{name:"void"}}},description:""}}};export{c as L};
