import{_ as c}from"./underscore-885MUNGo.js";function Nt(n,e){return typeof n=="number"&&typeof e=="number"?Math.abs(n-e)<1e-9:n===e}function $e(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!$e(n[t],e[t]))return!1;return!0}return Array.isArray(n)||Array.isArray(e)?!1:typeof n=="function"&&typeof e=="function"?Nt(n,e):typeof n=="function"||typeof e=="function"?!1:typeof n=="object"&&typeof e=="object"&&n&&e?n===e||c.all(n,function(t,r){return $e(e[r],t)})&&c.all(e,function(t,r){return $e(n[r],t)}):typeof n=="object"&&n||typeof e=="object"&&e?!1:Nt(n,e)}const wt={PLOT:"PLOT",PARABOLA:"PARABOLA",SINUSOID:"SINUSOID"};function Lt(n){let e=n[0],t=n[1],r=n[2];const s=n[3];e<0&&(e*=-1,t*=-1,r*=-1);const i=2*Math.PI;for(t<0&&(t*=-1,r*=-1,r+=i/2);r>0;)r-=i;for(;r<0;)r+=i;return[e,t,r,s]}function Ct(n){let e=n[0],t=n[1],r=n[2];const s=n[3];e<0&&(e*=-1,t*=-1,r*=-1);const i=Math.PI;for(t<0&&(t*=-1,r*=-1,r+=i/2);r>0;)r-=i;for(;r<0;)r+=i;return[e,t,r,s]}const Ce={areEqual:function(n,e){return $e(n,e)},movable:wt.PLOT,getPropsForCoeffs:function(n){return{fn:c.partial(this.getFunctionForCoeffs,n)}}},ln=c.extend({},Ce,{url:"https://ka-perseus-graphie.s3.amazonaws.com/67aaf581e6d9ef9038c10558a1f70ac21c11c9f8.png",defaultCoords:[[.25,.75],[.75,.75]],getCoefficients:function(n){const e=n[0],t=n[1],r=t[0]-e[0],s=t[1]-e[1];if(r===0)return;const i=s/r,a=t[1]-i*t[0];return[i,a]},getFunctionForCoeffs:function(n,e){const t=n[0],r=n[1];return t*e+r},getEquationString:function(n){const e=this.getCoefficients(n),t=e[0],r=e[1];return"y = "+t.toFixed(3)+"x + "+r.toFixed(3)}}),un=c.extend({},Ce,{url:"https://ka-perseus-graphie.s3.amazonaws.com/e23d36e6fc29ee37174e92c9daba2a66677128ab.png",defaultCoords:[[.5,.5],[.75,.75]],movable:wt.PARABOLA,getCoefficients:function(n){const e=n[0],t=n[1],r=e[0],s=e[1],i=(t[1]-s)/((t[0]-r)*(t[0]-r)),a=-2*r*i,l=i*r*r+s;return[i,a,l]},getFunctionForCoeffs:function(n,e){const t=n[0],r=n[1],s=n[2];return(t*e+r)*e+s},getPropsForCoeffs:function(n){return{a:n[0],b:n[1],c:n[2]}},getEquationString:function(n){const e=this.getCoefficients(n),t=e[0],r=e[1],s=e[2];return"y = "+t.toFixed(3)+"x^2 + "+r.toFixed(3)+"x + "+s.toFixed(3)}}),hn=c.extend({},Ce,{url:"https://ka-perseus-graphie.s3.amazonaws.com/3d68e7718498475f53b206c2ab285626baf8857e.png",defaultCoords:[[.5,.5],[.6,.6]],movable:wt.SINUSOID,getCoefficients:function(n){const e=n[0],t=n[1],r=t[1]-e[1],s=Math.PI/(2*(t[0]-e[0])),i=e[0]*s,a=e[1];return[r,s,i,a]},getFunctionForCoeffs:function(n,e){const t=n[0],r=n[1],s=n[2],i=n[3];return t*Math.sin(r*e-s)+i},getPropsForCoeffs:function(n){return{a:n[0],b:n[1],c:n[2],d:n[3]}},getEquationString:function(n){const e=this.getCoefficients(n),t=e[0],r=e[1],s=e[2],i=e[3];return"y = "+t.toFixed(3)+" sin("+r.toFixed(3)+"x - "+s.toFixed(3)+") + "+i.toFixed(3)},areEqual:function(n,e){return $e(Lt(n),Lt(e))}}),pn=c.extend({},Ce,{url:"https://ka-perseus-graphie.s3.amazonaws.com/7db80d23c35214f98659fe1cf0765811c1bbfbba.png",defaultCoords:[[.5,.5],[.75,.75]],getCoefficients:function(n){const e=n[0],t=n[1],r=t[1]-e[1],s=Math.PI/(4*(t[0]-e[0])),i=e[0]*s,a=e[1];return[r,s,i,a]},getFunctionForCoeffs:function(n,e){const t=n[0],r=n[1],s=n[2],i=n[3];return t*Math.tan(r*e-s)+i},getEquationString:function(n){const e=this.getCoefficients(n),t=e[0],r=e[1],s=e[2],i=e[3];return"y = "+t.toFixed(3)+" sin("+r.toFixed(3)+"x - "+s.toFixed(3)+") + "+i.toFixed(3)},areEqual:function(n,e){return $e(Ct(n),Ct(e))}}),Vt=c.extend({},Ce,{url:"https://ka-perseus-graphie.s3.amazonaws.com/9cbfad55525e3ce755a31a631b074670a5dad611.png",defaultCoords:[[.5,.55],[.75,.75]],defaultAsymptote:[[0,.5],[1,.5]],extraCoordConstraint:function(n,e,t,r,s){const i=r[0][1];return c.all(t,a=>a[1]!==i)},extraAsymptoteConstraint:function(n,e,t,r,s){const i=n[1];if(c.all(t,h=>h[1]>i)||c.all(t,h=>h[1]<i))return[e[0],i];const l=e[1];if(c.all(t,h=>h[1]>l)){const h=c.min(c.map(t,f=>f[1]));return[e[0],h-s.snapStep[1]]}const O=c.max(c.map(t,h=>h[1]));return[e[0],O+s.snapStep[1]]},allowReflectOverAsymptote:!0,getCoefficients:function(n,e){const t=n[0],r=n[1],s=e[0][1],i=Math.log((t[1]-s)/(r[1]-s))/(t[0]-r[0]);return[(t[1]-s)/Math.exp(i*t[0]),i,s]},getFunctionForCoeffs:function(n,e){const t=n[0],r=n[1],s=n[2];return t*Math.exp(r*e)+s},getEquationString:function(n,e){if(!e)return null;const t=this.getCoefficients(n,e),r=t[0],s=t[1],i=t[2];return"y = "+r.toFixed(3)+"e^("+s.toFixed(3)+"x) + "+i.toFixed(3)}}),fn=c.extend({},Ce,{url:"https://ka-perseus-graphie.s3.amazonaws.com/f6491e99d34af34d924bfe0231728ad912068dc3.png",defaultCoords:[[.55,.5],[.75,.75]],defaultAsymptote:[[.5,0],[.5,1]],extraCoordConstraint:function(n,e,t,r,s){const i=r[0][0];return c.all(t,a=>a[0]!==i)&&t[0][1]!==t[1][1]},extraAsymptoteConstraint:function(n,e,t,r,s){const i=n[0];if(c.all(t,h=>h[0]>i)||c.all(t,h=>h[0]<i))return[i,e[1]];const l=e[0];return c.all(t,h=>h[0]>l)?[c.min(c.map(t,f=>f[0]))-s.snapStep[0],e[1]]:[c.max(c.map(t,h=>h[0]))+s.snapStep[0],e[1]]},allowReflectOverAsymptote:!0,getCoefficients:function(n,e){const t=s=>[s[1],s[0]],r=Vt.getCoefficients(c.map(n,t),c.map(e,t));if(r){const s=-r[2]/r[0],i=1/r[0];return[1/r[1],i,s]}},getFunctionForCoeffs:function(n,e,t){const r=n[0],s=n[1],i=n[2];return r*Math.log(s*e+i)},getEquationString:function(n,e){if(!e)return null;const t=this.getCoefficients(n,e),r=t[0],s=t[1],i=t[2];return"y = ln("+r.toFixed(3)+"x + "+s.toFixed(3)+") + "+i.toFixed(3)}}),dn=c.extend({},Ce,{url:"https://ka-perseus-graphie.s3.amazonaws.com/8256a630175a0cb1d11de223d6de0266daf98721.png",defaultCoords:[[.5,.5],[.75,.75]],getCoefficients:function(n){const e=n[0],t=n[1],r=t[0]-e[0],s=t[1]-e[1];if(r===0)return;let i=Math.abs(s/r);t[1]<e[1]&&(i*=-1);const a=e[0],l=e[1];return[i,a,l]},getFunctionForCoeffs:function(n,e){const t=n[0],r=n[1],s=n[2];return t*Math.abs(e-r)+s},getEquationString:function(n){const e=this.getCoefficients(n),t=e[0],r=e[1],s=e[2];return"y = "+t.toFixed(3)+"| x - "+r.toFixed(3)+"| + "+s.toFixed(3)}}),zt={linear:ln,quadratic:un,sinusoid:hn,tangent:pn,exponential:Vt,logarithm:fn,absolute_value:dn},ia=c.keys(zt);function aa(n){return zt[n]}function Bt(n){return{type:"success",value:n}}function kt(n){return{type:"failure",detail:n}}function pe(n){return n.type==="failure"}function it(n){return n.type==="success"}function gn(n,e=t=>t){const t=[],r=[];for(const s of n)s.type==="success"?t.push(s.value):r.push(s.detail);return r.length>0?kt(r.reduce(e)):Bt(t)}const Ne=(n,e)=>e.success(n);function E(n){return(e,t)=>{if(!Array.isArray(e))return t.failure("array",e);const r=e.map((s,i)=>n(s,t.forSubtree(i)));return gn(r,mn)}}function mn(n,e){return[...n,...e]}function k(n,e){return typeof n=="boolean"?e.success(n):e.failure("boolean",n)}function w(n){return(e,t)=>e!==n?t.failure(String(JSON.stringify(n)),e):t.success(n)}function H(...n){return(e,t)=>{if(typeof e=="string"){const s=n.indexOf(e);if(s>-1)return t.success(n[s])}const r=n.map(s=>JSON.stringify(s));return t.failure(r,e)}}function Ue(n){return n!=null&&Object.getPrototypeOf(n)===Object.prototype}function V(n){return(e,t)=>e===null?t.success(e):n(e,t)}const x=(n,e)=>typeof n=="number"?e.success(n):e.failure("number",n);function m(n){return(e,t)=>{if(!Ue(e))return t.failure("object",e);const r={...e},s=[];for(const[i,a]of Object.entries(n)){const l=a(e[i],t.forSubtree(i));it(l)?(l.value!==void 0||i in e)&&(r[i]=l.value):s.push(...l.detail)}return s.length>0?kt(s):t.success(r)}}function o(n){return(e,t)=>e===void 0?t.success(e):n(e,t)}function Q(n,e){return(t,r)=>{if(!Array.isArray(t))return r.failure("array",t);if(t.length!==2)return r.failure("array of length 2",t);const[s,i]=t,a=n(s,r.forSubtree(0));if(pe(a))return a;const l=e(i,r.forSubtree(1));return pe(l)?l:r.success([a.value,l.value])}}function fe(n){return new Ot(n)}class Ot{constructor(e){this.parser=e}then(e){return new Ot(yn(this.parser,e))}}function yn(n,e){return(t,r)=>{const s=n(t,r);return pe(s)?s:e(s.value,r)}}function Ut(n,e){return(t,r)=>{if(!Ue(t))return r.failure("object",t);const s={},i=[];for(const[a,l]of Object.entries(t)){const g=r.forSubtree(a),O=n(a,g);pe(O)&&i.push(...O.detail);const h=e(l,g);pe(h)&&i.push(...h.detail),it(O)&&it(h)&&(s[O.value]=h.value)}return i.length>0?kt(i):r.success(s)}}const u=(n,e)=>typeof n=="string"?e.success(n):e.failure("string",n);function at(n,e,t){return(r,s)=>{if(!Array.isArray(r))return s.failure("array",r);if(r.length!==3)return s.failure("array of length 3",r);const i=n(r[0],s.forSubtree(0));if(pe(i))return i;const a=e(r[1],s.forSubtree(1));if(pe(a))return a;const l=t(r[2],s.forSubtree(2));return pe(l)?l:s.success([i.value,a.value,l.value])}}function le(n){return new Pt(n)}class Pt{constructor(e){this.parser=e}or(e){return new Pt(bn(this.parser,e))}}function bn(n,e){return(t,r)=>{const s=n(t,r);return it(s)?s:e(t,r)}}function D(n,e){return(t,r)=>t==null?Bt(e(t)):n(t,r)}const vn=D(Ut(u,m({width:x,height:x})),()=>({}));function B(n,e){return m({type:n,static:o(k),graded:o(k),alignment:o(u),options:e,key:o(V(x)),version:o(m({major:x,minor:x}))})}function je(n,e,t){return m({type:e,static:o(k),graded:o(k),alignment:o(u),options:t,key:o(V(x)),version:n})}const xn=B(w("categorizer"),m({items:E(u),categories:E(u),randomizeItems:D(k,()=>!1),static:D(k,()=>!1),values:E(D(x,()=>0)),highlightLint:o(k),linterContext:o(m({contentType:u,paths:E(u),stack:E(u)}))})),wn=B(w("cs-program"),m({programID:u,programType:Ne,settings:E(m({name:u,value:u})),showEditor:k,showButtons:k,height:x,static:D(k,()=>!1)})),kn=B(w("definition"),m({togglePrompt:u,definition:u,static:D(k,()=>!1)})),On=B(w("dropdown"),m({placeholder:D(u,()=>""),ariaLabel:o(u),visibleLabel:o(u),static:D(k,()=>!1),choices:E(m({content:u,correct:k}))})),Pn=B(w("explanation"),m({showPrompt:u,hidePrompt:u,explanation:u,widgets:D((n,e)=>He(n,e),()=>({})),static:D(k,()=>!1)})),jt=["PLUS","MINUS","NEGATIVE","TIMES","DIVIDE","DECIMAL","PERIOD","PERCENT","CDOT","EQUAL","NEQ","GT","LT","GEQ","LEQ","FRAC_INCLUSIVE","FRAC_EXCLUSIVE","FRAC","EXP","EXP_2","EXP_3","SQRT","CUBE_ROOT","RADICAL","LEFT_PAREN","RIGHT_PAREN","LN","LOG","LOG_N","SIN","COS","TAN","PI","THETA","UP","RIGHT","DOWN","LEFT","BACKSPACE","DISMISS","JUMP_OUT_PARENTHESES","JUMP_OUT_EXPONENT","JUMP_OUT_BASE","JUMP_INTO_NUMERATOR","JUMP_OUT_NUMERATOR","JUMP_OUT_DENOMINATOR","NUM_0","NUM_1","NUM_2","NUM_3","NUM_4","NUM_5","NUM_6","NUM_7","NUM_8","NUM_9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Ht=(n,e)=>{let t="v";e==="__lib_version__"&&(t="");const r=`${t}${e}`;if(typeof globalThis<"u"){globalThis.__perseus_debug__=globalThis.__perseus_debug__??{};const s=globalThis.__perseus_debug__[n];if(s){if(s!==r){const i=Array.isArray(s)?s:[s];i.push(r),globalThis.__perseus_debug__[n]=i,console.warn(`Multiple versions of ${n} loaded on this page: ${i.sort().join(", ")}`)}}else globalThis.__perseus_debug__[n]=r}else console.warn(`globalThis not found found (${r})`)},Tn="@khanacademy/kas",Sn="__lib_version__";Ht(Tn,Sn);(function(){var n=function(O,h,f,p){for(f=f||{},p=O.length;p--;f[O[p]]=h);return f},e=[1,11],t=[1,9],r=[8,17],s=[6,11],i=[6,11,13,17],a={trace:function(){},yy:{},symbols_:{error:2,unitvalue:3,magnitude:4,unit:5,EOF:6,float:7,POW:8,int:9,multatoms:10,DIV:11,expatom:12,MUL:13,atom:14,"^":15,nat:16,ATOM:17,FLOAT:18,NAT:19,NEG:20,$accept:0,$end:1},terminals_:{2:"error",6:"EOF",8:"POW",11:"DIV",13:"MUL",15:"^",17:"ATOM",18:"FLOAT",19:"NAT",20:"NEG"},productions_:[0,[3,3],[3,2],[4,3],[4,1],[5,3],[5,1],[10,3],[10,2],[10,1],[12,3],[12,1],[14,1],[7,1],[7,1],[16,1],[9,2],[9,1]],performAction:function(h,f,p,y,d,P,S){var N=P.length-1;switch(d){case 1:return{type:"unitMagnitude",magnitude:P[N-2],unit:P[N-1]};case 2:return{type:"unitStandalone",unit:P[N-1]};case 3:this.$=P[N-2]+"e"+P[N];break;case 4:case 13:case 14:case 15:case 17:this.$=P[N];break;case 5:this.$={num:P[N-2],denom:P[N]};break;case 6:this.$={num:P[N],denom:null};break;case 7:this.$=[P[N-2]].concat(P[N]);break;case 8:this.$=[P[N-1]].concat(P[N]);break;case 9:this.$=[P[N]];break;case 10:this.$={name:P[N-2],pow:P[N]};break;case 11:this.$={name:P[N],pow:1};break;case 12:this.$=h;break;case 16:this.$="-"+P[N];break}},table:[{3:1,4:2,5:3,7:4,10:5,12:8,14:10,16:7,17:e,18:[1,6],19:t},{1:[3]},{5:12,10:5,12:8,14:10,17:e},{6:[1,13]},{8:[1,14],17:[2,4]},{6:[2,6],11:[1,15]},n(r,[2,13]),n(r,[2,14]),n(s,[2,9],{12:8,14:10,10:17,13:[1,16],17:e}),n([6,8,11,13,17],[2,15]),n(i,[2,11],{15:[1,18]}),n([6,11,13,15,17],[2,12]),{6:[1,19]},{1:[2,2]},{9:20,19:[1,22],20:[1,21]},{10:23,12:8,14:10,17:e},{10:24,12:8,14:10,17:e},n(s,[2,8]),{16:25,19:t},{1:[2,1]},{17:[2,3]},{19:[1,26]},{17:[2,17]},{6:[2,5]},n(s,[2,7]),n(i,[2,10]),{17:[2,16]}],defaultActions:{13:[2,2],19:[2,1],20:[2,3],22:[2,17],23:[2,5],26:[2,16]},parseError:function(h,f){if(f.recoverable)this.trace(h);else throw new Error(h)},parse:function(h){var f=this,p=[0],y=[null],d=[],P=this.table,S="",N=0,j=0,X=2,we=1,Ke=d.slice.call(arguments,1),Z=Object.create(this.lexer),ne={yy:{}};for(var de in this.yy)Object.prototype.hasOwnProperty.call(this.yy,de)&&(ne.yy[de]=this.yy[de]);Z.setInput(h,ne.yy),ne.yy.lexer=Z,ne.yy.parser=this,typeof Z.yylloc>"u"&&(Z.yylloc={});var te=Z.yylloc;d.push(te);var Xe=Z.options&&Z.options.ranges;typeof ne.yy.parseError=="function"?this.parseError=ne.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function pt(){var ye;return ye=Z.lex()||we,typeof ye!="number"&&(ye=f.symbols_[ye]||ye),ye}for(var re,oe,A,F,T={},M,q,C,ke;;){if(oe=p[p.length-1],this.defaultActions[oe]?A=this.defaultActions[oe]:((re===null||typeof re>"u")&&(re=pt()),A=P[oe]&&P[oe][re]),typeof A>"u"||!A.length||!A[0]){var R="";ke=[];for(M in P[oe])this.terminals_[M]&&M>X&&ke.push("'"+this.terminals_[M]+"'");Z.showPosition?R="Parse error on line "+(N+1)+`:
`+Z.showPosition()+`
Expecting `+ke.join(", ")+", got '"+(this.terminals_[re]||re)+"'":R="Parse error on line "+(N+1)+": Unexpected "+(re==we?"end of input":"'"+(this.terminals_[re]||re)+"'"),this.parseError(R,{text:Z.match,token:this.terminals_[re]||re,line:Z.yylineno,loc:te,expected:ke})}if(A[0]instanceof Array&&A.length>1)throw new Error("Parse Error: multiple actions possible at state: "+oe+", token: "+re);switch(A[0]){case 1:p.push(re),y.push(Z.yytext),d.push(Z.yylloc),p.push(A[1]),re=null,j=Z.yyleng,S=Z.yytext,N=Z.yylineno,te=Z.yylloc;break;case 2:if(q=this.productions_[A[1]][1],T.$=y[y.length-q],T._$={first_line:d[d.length-(q||1)].first_line,last_line:d[d.length-1].last_line,first_column:d[d.length-(q||1)].first_column,last_column:d[d.length-1].last_column},Xe&&(T._$.range=[d[d.length-(q||1)].range[0],d[d.length-1].range[1]]),F=this.performAction.apply(T,[S,j,N,ne.yy,A[1],y,d].concat(Ke)),typeof F<"u")return F;q&&(p=p.slice(0,-1*q*2),y=y.slice(0,-1*q),d=d.slice(0,-1*q)),p.push(this.productions_[A[1]][0]),y.push(T.$),d.push(T._$),C=P[p[p.length-2]][p[p.length-1]],p.push(C);break;case 3:return!0}}return!0}},l=function(){var O={EOF:1,parseError:function(f,p){if(this.yy.parser)this.yy.parser.parseError(f,p);else throw new Error(f)},setInput:function(h,f){return this.yy=f||this.yy||{},this._input=h,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var h=this._input[0];this.yytext+=h,this.yyleng++,this.offset++,this.match+=h,this.matched+=h;var f=h.match(/(?:\r\n?|\n).*/g);return f?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),h},unput:function(h){var f=h.length,p=h.split(/(?:\r\n?|\n)/g);this._input=h+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-f),this.offset-=f;var y=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),p.length-1&&(this.yylineno-=p.length-1);var d=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:p?(p.length===y.length?this.yylloc.first_column:0)+y[y.length-p.length].length-p[0].length:this.yylloc.first_column-f},this.options.ranges&&(this.yylloc.range=[d[0],d[0]+this.yyleng-f]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(h){this.unput(this.match.slice(h))},pastInput:function(){var h=this.matched.substr(0,this.matched.length-this.match.length);return(h.length>20?"...":"")+h.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var h=this.match;return h.length<20&&(h+=this._input.substr(0,20-h.length)),(h.substr(0,20)+(h.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var h=this.pastInput(),f=new Array(h.length+1).join("-");return h+this.upcomingInput()+`
`+f+"^"},test_match:function(h,f){var p,y,d;if(this.options.backtrack_lexer&&(d={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(d.yylloc.range=this.yylloc.range.slice(0))),y=h[0].match(/(?:\r\n?|\n).*/g),y&&(this.yylineno+=y.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:y?y[y.length-1].length-y[y.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+h[0].length},this.yytext+=h[0],this.match+=h[0],this.matches=h,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(h[0].length),this.matched+=h[0],p=this.performAction.call(this,this.yy,this,f,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),p)return p;if(this._backtrack){for(var P in d)this[P]=d[P];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var h,f,p,y;this._more||(this.yytext="",this.match="");for(var d=this._currentRules(),P=0;P<d.length;P++)if(p=this._input.match(this.rules[d[P]]),p&&(!f||p[0].length>f[0].length)){if(f=p,y=P,this.options.backtrack_lexer){if(h=this.test_match(p,d[P]),h!==!1)return h;if(this._backtrack){f=!1;continue}else return!1}else if(!this.options.flex)break}return f?(h=this.test_match(f,d[y]),h!==!1?h:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var f=this.next();return f||this.lex()},begin:function(f){this.conditionStack.push(f)},popState:function(){var f=this.conditionStack.length-1;return f>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(f){return f=this.conditionStack.length-1-Math.abs(f||0),f>=0?this.conditionStack[f]:"INITIAL"},pushState:function(f){this.begin(f)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(f,p,y,d){switch(y){case 0:return 11;case 1:return"(";case 2:return")";case 3:return 8;case 4:return 15;case 5:return 13;case 6:return 18;case 7:return 19;case 8:return 20;case 9:return 17;case 10:return 17;case 11:return 17;case 12:break;case 13:return 6}},rules:[/^(?:\/)/,/^(?:\()/,/^(?:\))/,/^(?:(\*|x|\u00d7|\u2219|\u22c5|\u00b7)\s*10\s*\^)/,/^(?:\^)/,/^(?:\*)/,/^(?:[0-9]+\.[0-9]+)/,/^(?:[0-9]+)/,/^(?:-)/,/^(?:\u00b0( ?)[cCfF])/,/^(?:fl\.? oz\.?)/,/^(?:[\u00b5]?([A-Za-z-]+|[\u2103\u2109\u212b]))/,/^(?:\s+)/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};return O}();a.lexer=l;function g(){this.yy={}}return g.prototype=a,a.Parser=g,new g})();var Ve=function(){var n=function(oe,A,F,T){for(F=F||{},T=oe.length;T--;F[oe[T]]=A);return F},e=[1,7],t=[1,17],r=[1,13],s=[1,14],i=[1,15],a=[1,32],l=[1,22],g=[1,23],O=[1,24],h=[1,25],f=[1,26],p=[1,33],y=[1,27],d=[1,28],P=[1,29],S=[1,30],N=[1,20],j=[1,36],X=[1,37],we=[5,6,8,10,33,35,41,43,45],Ke=[1,39],Z=[1,40],ne=[5,6,8,10,12,14,16,19,21,22,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],de=[10,16,19,21,22,28,29,30,31,32,34,37,39,42,43,44,46],te=[5,6,8,10,12,14,16,18,19,21,22,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],Xe={trace:function(){},yy:{},symbols_:{error:2,equation:3,expression:4,SIGN:5,EOF:6,additive:7,"+":8,multiplicative:9,"-":10,triglog:11,"*":12,negative:13,"/":14,trig:15,TRIG:16,trigfunc:17,"^":18,TRIGINV:19,logbase:20,ln:21,log:22,_:23,subscriptable:24,power:25,primitive:26,variable:27,VAR:28,CONST:29,INT:30,FLOAT:31,"{":32,"}":33,"(":34,")":35,function:36,FUNC:37,invocation:38,sqrt:39,"[":40,"]":41,abs:42,"|":43,"LEFT|":44,"RIGHT|":45,FRAC:46,$accept:0,$end:1},terminals_:{2:"error",5:"SIGN",6:"EOF",8:"+",10:"-",12:"*",14:"/",16:"TRIG",18:"^",19:"TRIGINV",21:"ln",22:"log",23:"_",28:"VAR",29:"CONST",30:"INT",31:"FLOAT",32:"{",33:"}",34:"(",35:")",37:"FUNC",39:"sqrt",40:"[",41:"]",42:"abs",43:"|",44:"LEFT|",45:"RIGHT|",46:"FRAC"},productions_:[0,[3,4],[3,2],[3,1],[4,1],[7,3],[7,3],[7,1],[9,2],[9,3],[9,3],[9,1],[13,2],[13,1],[15,1],[17,1],[17,3],[17,1],[20,1],[20,1],[20,3],[11,2],[11,2],[11,1],[25,3],[25,1],[27,1],[24,3],[24,1],[24,1],[24,1],[24,1],[24,3],[24,3],[36,1],[38,4],[38,4],[38,7],[38,4],[38,3],[38,3],[38,4],[26,1],[26,1],[26,7]],performAction:function(A,F,T,M,q,C,ke){var R=C.length-1;switch(q){case 1:return new M.Eq(C[R-3],C[R-2],C[R-1]);case 2:return C[R-1];case 3:return new M.Add([]);case 4:case 7:case 11:case 13:case 15:case 20:case 23:case 25:case 42:case 43:this.$=C[R];break;case 5:this.$=M.Add.createOrAppend(C[R-2],C[R]);break;case 6:this.$=M.Add.createOrAppend(C[R-2],M.Mul.handleNegative(C[R],"subtract"));break;case 8:this.$=M.Mul.fold(M.Mul.createOrAppend(C[R-1],C[R]));break;case 9:this.$=M.Mul.fold(M.Mul.createOrAppend(C[R-2],C[R]));break;case 10:this.$=M.Mul.fold(M.Mul.handleDivide(C[R-2],C[R]));break;case 12:this.$=M.Mul.handleNegative(C[R]);break;case 14:case 17:this.$=[A];break;case 16:this.$=C[R-2].concat(C[R]);break;case 18:this.$=M.Log.natural();break;case 19:this.$=M.Log.common();break;case 21:this.$=M.Trig.create(C[R-1],C[R]);break;case 22:this.$=M.Log.create(C[R-1],C[R]);break;case 24:this.$=new M.Pow(C[R-2],C[R]);break;case 26:case 34:this.$=A;break;case 27:this.$=new M.Var(C[R-2],C[R]);break;case 28:this.$=new M.Var(C[R]);break;case 29:this.$=new M.Const(A.toLowerCase());break;case 30:this.$=M.Int.create(Number(A));break;case 31:this.$=M.Float.create(Number(A));break;case 32:this.$=C[R-1].completeParse();break;case 33:this.$=C[R-1].completeParse().addHint("parens");break;case 35:case 36:this.$=M.Pow.sqrt(C[R-1]);break;case 37:this.$=new M.Pow.nthroot(C[R-1],C[R-4]);break;case 38:case 39:case 40:this.$=new M.Abs(C[R-1]);break;case 41:this.$=new M.Func(C[R-3],C[R-1]);break;case 44:this.$=M.Mul.handleDivide(C[R-4],C[R-1]);break}},table:[{3:1,4:2,6:[1,3],7:4,9:5,10:e,11:8,13:6,15:12,16:t,17:9,19:r,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:l,30:g,31:O,32:h,34:f,36:31,37:p,38:19,39:y,42:d,43:P,44:S,46:N},{1:[3]},{5:[1,34],6:[1,35]},{1:[2,3]},n([5,6],[2,4],{8:j,10:X}),n(we,[2,7],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:Ke,14:Z,16:t,19:r,21:s,22:i,28:a,29:l,30:g,31:O,32:h,34:f,37:p,39:y,42:d,44:S,46:N}),n(ne,[2,11]),{10:e,11:8,13:41,15:12,16:t,17:9,19:r,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:l,30:g,31:O,32:h,34:f,36:31,37:p,38:19,39:y,42:d,43:P,44:S,46:N},n(ne,[2,13]),{10:e,11:8,13:42,15:12,16:t,17:9,19:r,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:l,30:g,31:O,32:h,34:f,36:31,37:p,38:19,39:y,42:d,43:P,44:S,46:N},{10:e,11:8,13:43,15:12,16:t,17:9,19:r,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:l,30:g,31:O,32:h,34:f,36:31,37:p,38:19,39:y,42:d,43:P,44:S,46:N},n(ne,[2,23]),n(de,[2,15],{18:[1,44]}),n(de,[2,17]),n(de,[2,18]),n(de,[2,19],{23:[1,45]}),n(ne,[2,25],{18:[1,46]}),n([10,16,18,19,21,22,28,29,30,31,32,34,37,39,42,43,44,46],[2,14]),n(te,[2,42]),n(te,[2,43]),{32:[1,47]},n(te,[2,28],{23:[1,48]}),n(te,[2,29]),n(te,[2,30]),n(te,[2,31]),{7:49,9:5,10:e,11:8,13:6,15:12,16:t,17:9,19:r,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:l,30:g,31:O,32:h,34:f,36:31,37:p,38:19,39:y,42:d,43:P,44:S,46:N},{7:50,9:5,10:e,11:8,13:6,15:12,16:t,17:9,19:r,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:l,30:g,31:O,32:h,34:f,36:31,37:p,38:19,39:y,42:d,43:P,44:S,46:N},{32:[1,52],34:[1,51],40:[1,53]},{34:[1,54]},{7:55,9:5,10:e,11:8,13:6,15:12,16:t,17:9,19:r,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:l,30:g,31:O,32:h,34:f,36:31,37:p,38:19,39:y,42:d,43:P,44:S,46:N},{7:56,9:5,10:e,11:8,13:6,15:12,16:t,17:9,19:r,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:l,30:g,31:O,32:h,34:f,36:31,37:p,38:19,39:y,42:d,43:P,44:S,46:N},{34:[1,57]},n([5,6,8,10,12,14,16,18,19,21,22,23,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],[2,26]),{34:[2,34]},{4:58,7:4,9:5,10:e,11:8,13:6,15:12,16:t,17:9,19:r,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:l,30:g,31:O,32:h,34:f,36:31,37:p,38:19,39:y,42:d,43:P,44:S,46:N},{1:[2,2]},{9:59,10:e,11:8,13:6,15:12,16:t,17:9,19:r,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:l,30:g,31:O,32:h,34:f,36:31,37:p,38:19,39:y,42:d,43:P,44:S,46:N},{9:60,10:e,11:8,13:6,15:12,16:t,17:9,19:r,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:l,30:g,31:O,32:h,34:f,36:31,37:p,38:19,39:y,42:d,43:P,44:S,46:N},n(ne,[2,8]),{10:e,11:8,13:61,15:12,16:t,17:9,19:r,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:l,30:g,31:O,32:h,34:f,36:31,37:p,38:19,39:y,42:d,43:P,44:S,46:N},{10:e,11:8,13:62,15:12,16:t,17:9,19:r,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:l,30:g,31:O,32:h,34:f,36:31,37:p,38:19,39:y,42:d,43:P,44:S,46:N},n(ne,[2,12]),n(ne,[2,21]),n(ne,[2,22]),{10:e,11:8,13:63,15:12,16:t,17:9,19:r,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:l,30:g,31:O,32:h,34:f,36:31,37:p,38:19,39:y,42:d,43:P,44:S,46:N},{24:64,27:21,28:a,29:l,30:g,31:O,32:h,34:f},{10:e,11:8,13:65,15:12,16:t,17:9,19:r,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:l,30:g,31:O,32:h,34:f,36:31,37:p,38:19,39:y,42:d,43:P,44:S,46:N},{7:66,9:5,10:e,11:8,13:6,15:12,16:t,17:9,19:r,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:l,30:g,31:O,32:h,34:f,36:31,37:p,38:19,39:y,42:d,43:P,44:S,46:N},{24:67,27:21,28:a,29:l,30:g,31:O,32:h,34:f},{8:j,10:X,33:[1,68]},{8:j,10:X,35:[1,69]},{7:70,9:5,10:e,11:8,13:6,15:12,16:t,17:9,19:r,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:l,30:g,31:O,32:h,34:f,36:31,37:p,38:19,39:y,42:d,43:P,44:S,46:N},{7:71,9:5,10:e,11:8,13:6,15:12,16:t,17:9,19:r,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:l,30:g,31:O,32:h,34:f,36:31,37:p,38:19,39:y,42:d,43:P,44:S,46:N},{7:72,9:5,10:e,11:8,13:6,15:12,16:t,17:9,19:r,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:l,30:g,31:O,32:h,34:f,36:31,37:p,38:19,39:y,42:d,43:P,44:S,46:N},{7:73,9:5,10:e,11:8,13:6,15:12,16:t,17:9,19:r,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:l,30:g,31:O,32:h,34:f,36:31,37:p,38:19,39:y,42:d,43:P,44:S,46:N},{8:j,10:X,43:[1,74]},{8:j,10:X,45:[1,75]},{7:76,9:5,10:e,11:8,13:6,15:12,16:t,17:9,19:r,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:l,30:g,31:O,32:h,34:f,36:31,37:p,38:19,39:y,42:d,43:P,44:S,46:N},{6:[1,77]},n(we,[2,5],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:Ke,14:Z,16:t,19:r,21:s,22:i,28:a,29:l,30:g,31:O,32:h,34:f,37:p,39:y,42:d,44:S,46:N}),n(we,[2,6],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:Ke,14:Z,16:t,19:r,21:s,22:i,28:a,29:l,30:g,31:O,32:h,34:f,37:p,39:y,42:d,44:S,46:N}),n(ne,[2,9]),n(ne,[2,10]),n(de,[2,16]),n(de,[2,20]),n(ne,[2,24]),{8:j,10:X,33:[1,78]},n(te,[2,27]),n(te,[2,32]),n(te,[2,33]),{8:j,10:X,35:[1,79]},{8:j,10:X,33:[1,80]},{8:j,10:X,41:[1,81]},{8:j,10:X,35:[1,82]},n(te,[2,39]),n(te,[2,40]),{8:j,10:X,35:[1,83]},{1:[2,1]},{32:[1,84]},n(te,[2,35]),n(te,[2,36]),{32:[1,85]},n(te,[2,38]),n(te,[2,41]),{7:86,9:5,10:e,11:8,13:6,15:12,16:t,17:9,19:r,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:l,30:g,31:O,32:h,34:f,36:31,37:p,38:19,39:y,42:d,43:P,44:S,46:N},{7:87,9:5,10:e,11:8,13:6,15:12,16:t,17:9,19:r,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:l,30:g,31:O,32:h,34:f,36:31,37:p,38:19,39:y,42:d,43:P,44:S,46:N},{8:j,10:X,33:[1,88]},{8:j,10:X,33:[1,89]},n(te,[2,44]),n(te,[2,37])],defaultActions:{3:[2,3],33:[2,34],35:[2,2],77:[2,1]},parseError:function(A,F){if(F.recoverable)this.trace(A);else throw new Error(A)},parse:function(A){var F=this,T=[0],M=[null],q=[],C=this.table,ke="",R=0,ye=0,sn=2,It=1,an=q.slice.call(arguments,1),se=Object.create(this.lexer),We={yy:{}};for(var ft in this.yy)Object.prototype.hasOwnProperty.call(this.yy,ft)&&(We.yy[ft]=this.yy[ft]);se.setInput(A,We.yy),We.yy.lexer=se,We.yy.parser=this,typeof se.yylloc>"u"&&(se.yylloc={});var dt=se.yylloc;q.push(dt);var on=se.options&&se.options.ranges;typeof We.yy.parseError=="function"?this.parseError=We.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function cn(){var Ge;return Ge=se.lex()||It,typeof Ge!="number"&&(Ge=F.symbols_[Ge]||Ge),Ge}for(var ue,Ee,he,gt,Re={},et,be,Mt,tt;;){if(Ee=T[T.length-1],this.defaultActions[Ee]?he=this.defaultActions[Ee]:((ue===null||typeof ue>"u")&&(ue=cn()),he=C[Ee]&&C[Ee][ue]),typeof he>"u"||!he.length||!he[0]){var mt="";tt=[];for(et in C[Ee])this.terminals_[et]&&et>sn&&tt.push("'"+this.terminals_[et]+"'");se.showPosition?mt="Parse error on line "+(R+1)+`:
`+se.showPosition()+`
Expecting `+tt.join(", ")+", got '"+(this.terminals_[ue]||ue)+"'":mt="Parse error on line "+(R+1)+": Unexpected "+(ue==It?"end of input":"'"+(this.terminals_[ue]||ue)+"'"),this.parseError(mt,{text:se.match,token:this.terminals_[ue]||ue,line:se.yylineno,loc:dt,expected:tt})}if(he[0]instanceof Array&&he.length>1)throw new Error("Parse Error: multiple actions possible at state: "+Ee+", token: "+ue);switch(he[0]){case 1:T.push(ue),M.push(se.yytext),q.push(se.yylloc),T.push(he[1]),ue=null,ye=se.yyleng,ke=se.yytext,R=se.yylineno,dt=se.yylloc;break;case 2:if(be=this.productions_[he[1]][1],Re.$=M[M.length-be],Re._$={first_line:q[q.length-(be||1)].first_line,last_line:q[q.length-1].last_line,first_column:q[q.length-(be||1)].first_column,last_column:q[q.length-1].last_column},on&&(Re._$.range=[q[q.length-(be||1)].range[0],q[q.length-1].range[1]]),gt=this.performAction.apply(Re,[ke,ye,R,We.yy,he[1],M,q].concat(an)),typeof gt<"u")return gt;be&&(T=T.slice(0,-1*be*2),M=M.slice(0,-1*be),q=q.slice(0,-1*be)),T.push(this.productions_[he[1]][0]),M.push(Re.$),q.push(Re._$),Mt=C[T[T.length-2]][T[T.length-1]],T.push(Mt);break;case 3:return!0}}return!0}},pt=function(){var oe={EOF:1,parseError:function(F,T){if(this.yy.parser)this.yy.parser.parseError(F,T);else throw new Error(F)},setInput:function(A,F){return this.yy=F||this.yy||{},this._input=A,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var A=this._input[0];this.yytext+=A,this.yyleng++,this.offset++,this.match+=A,this.matched+=A;var F=A.match(/(?:\r\n?|\n).*/g);return F?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),A},unput:function(A){var F=A.length,T=A.split(/(?:\r\n?|\n)/g);this._input=A+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-F),this.offset-=F;var M=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),T.length-1&&(this.yylineno-=T.length-1);var q=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:T?(T.length===M.length?this.yylloc.first_column:0)+M[M.length-T.length].length-T[0].length:this.yylloc.first_column-F},this.options.ranges&&(this.yylloc.range=[q[0],q[0]+this.yyleng-F]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(A){this.unput(this.match.slice(A))},pastInput:function(){var A=this.matched.substr(0,this.matched.length-this.match.length);return(A.length>20?"...":"")+A.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var A=this.match;return A.length<20&&(A+=this._input.substr(0,20-A.length)),(A.substr(0,20)+(A.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var A=this.pastInput(),F=new Array(A.length+1).join("-");return A+this.upcomingInput()+`
`+F+"^"},test_match:function(A,F){var T,M,q;if(this.options.backtrack_lexer&&(q={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(q.yylloc.range=this.yylloc.range.slice(0))),M=A[0].match(/(?:\r\n?|\n).*/g),M&&(this.yylineno+=M.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:M?M[M.length-1].length-M[M.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+A[0].length},this.yytext+=A[0],this.match+=A[0],this.matches=A,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(A[0].length),this.matched+=A[0],T=this.performAction.call(this,this.yy,this,F,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),T)return T;if(this._backtrack){for(var C in q)this[C]=q[C];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var A,F,T,M;this._more||(this.yytext="",this.match="");for(var q=this._currentRules(),C=0;C<q.length;C++)if(T=this._input.match(this.rules[q[C]]),T&&(!F||T[0].length>F[0].length)){if(F=T,M=C,this.options.backtrack_lexer){if(A=this.test_match(T,q[C]),A!==!1)return A;if(this._backtrack){F=!1;continue}else return!1}else if(!this.options.flex)break}return F?(A=this.test_match(F,q[M]),A!==!1?A:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var F=this.next();return F||this.lex()},begin:function(F){this.conditionStack.push(F)},popState:function(){var F=this.conditionStack.length-1;return F>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(F){return F=this.conditionStack.length-1-Math.abs(F||0),F>=0?this.conditionStack[F]:"INITIAL"},pushState:function(F){this.begin(F)},stateStackSize:function(){return this.conditionStack.length},options:{flex:!0},performAction:function(F,T,M,q){switch(M){case 0:break;case 1:break;case 2:break;case 3:return"INT";case 4:return"FLOAT";case 5:return"^";case 6:return"*";case 7:return"*";case 8:return"*";case 9:return"*";case 10:return"/";case 11:return"/";case 12:return"-";case 13:return"-";case 14:return"+";case 15:return"^";case 16:return"(";case 17:return")";case 18:return"(";case 19:return")";case 20:return"[";case 21:return"]";case 22:return"{";case 23:return"}";case 24:return"{";case 25:return"}";case 26:return"_";case 27:return"|";case 28:return"LEFT|";case 29:return"RIGHT|";case 30:return"!";case 31:return"SIGN";case 32:return T.yytext="<=","SIGN";case 33:return T.yytext=">=","SIGN";case 34:return T.yytext="<=","SIGN";case 35:return T.yytext=">=","SIGN";case 36:return T.yytext="<>","SIGN";case 37:return T.yytext="<>","SIGN";case 38:return T.yytext="<>","SIGN";case 39:return T.yytext="<>","SIGN";case 40:return T.yytext="<=","SIGN";case 41:return T.yytext=">=","SIGN";case 42:return"FRAC";case 43:return"FRAC";case 44:return"sqrt";case 45:return"abs";case 46:return"ln";case 47:return"log";case 48:return"TRIG";case 49:return"TRIG";case 50:return"TRIG";case 51:return"TRIG";case 52:return T.yytext="sin","TRIG";case 53:return T.yytext="cos","TRIG";case 54:return T.yytext="tan","TRIG";case 55:return T.yytext="csc","TRIG";case 56:return T.yytext="sec","TRIG";case 57:return T.yytext="cot","TRIG";case 58:return T.yytext="arcsin","TRIG";case 59:return T.yytext="arccos","TRIG";case 60:return T.yytext="arctan","TRIG";case 61:return T.yytext="arccsc","TRIG";case 62:return T.yytext="arcsec","TRIG";case 63:return T.yytext="arccot","TRIG";case 64:return"TRIGINV";case 65:return"TRIGINV";case 66:return T.yytext="sinh","TRIG";case 67:return T.yytext="cosh","TRIG";case 68:return T.yytext="tanh","TRIG";case 69:return T.yytext="csch","TRIG";case 70:return T.yytext="sech","TRIG";case 71:return T.yytext="tanh","TRIG";case 72:return"CONST";case 73:return T.yytext="pi","CONST";case 74:return T.yytext="pi","CONST";case 75:return"VAR";case 76:return T.yytext="theta","VAR";case 77:return T.yytext="theta","VAR";case 78:return"VAR";case 79:return T.yytext="phi","VAR";case 80:return T.yytext="phi","VAR";case 81:return F.symbolLexer(T.yytext);case 82:return"EOF";case 83:return"INVALID";case 84:console.log(T.yytext);break}},rules:[/^(?:\s+)/,/^(?:\\space)/,/^(?:\\ )/,/^(?:[0-9]+\.?)/,/^(?:([0-9]+)?\.[0-9]+)/,/^(?:\*\*)/,/^(?:\*)/,/^(?:\\cdot|·)/,/^(?:\\times|×)/,/^(?:\\ast)/,/^(?:\/)/,/^(?:\\div|÷)/,/^(?:-)/,/^(?:−)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:\\left\()/,/^(?:\\right\))/,/^(?:\[)/,/^(?:\])/,/^(?:\{)/,/^(?:\})/,/^(?:\\left\{)/,/^(?:\\right\})/,/^(?:_)/,/^(?:\|)/,/^(?:\\left\|)/,/^(?:\\right\|)/,/^(?:\!)/,/^(?:<=|>=|<>|<|>|=)/,/^(?:\\le)/,/^(?:\\ge)/,/^(?:\\leq)/,/^(?:\\geq)/,/^(?:=\/=)/,/^(?:\\ne)/,/^(?:\\neq)/,/^(?:≠)/,/^(?:≤)/,/^(?:≥)/,/^(?:\\frac)/,/^(?:\\dfrac)/,/^(?:sqrt|\\sqrt)/,/^(?:abs|\\abs)/,/^(?:ln|\\ln)/,/^(?:log|\\log)/,/^(?:sin|cos|tan)/,/^(?:csc|sec|cot)/,/^(?:sinh|cosh|tanh)/,/^(?:csch|sech|coth)/,/^(?:\\sin)/,/^(?:\\cos)/,/^(?:\\tan)/,/^(?:\\csc)/,/^(?:\\sec)/,/^(?:\\cot)/,/^(?:\\arcsin)/,/^(?:\\arccos)/,/^(?:\\arctan)/,/^(?:\\arccsc)/,/^(?:\\arcsec)/,/^(?:\\arccot)/,/^(?:arcsin|arccos|arctan)/,/^(?:arccsc|arcsec|arccot)/,/^(?:\\sinh)/,/^(?:\\cosh)/,/^(?:\\tanh)/,/^(?:\\csch)/,/^(?:\\sech)/,/^(?:\\coth)/,/^(?:pi)/,/^(?:π)/,/^(?:\\pi)/,/^(?:theta)/,/^(?:θ)/,/^(?:\\theta)/,/^(?:phi)/,/^(?:φ)/,/^(?:\\phi)/,/^(?:[a-zA-Z])/,/^(?:$)/,/^(?:.)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84],inclusive:!0}}};return oe}();Xe.lexer=pt;function re(){this.yy={}}return re.prototype=Xe,Xe.Parser=re,new re}();const Ft=function(n){return n!==n},An=function(n,e){var t=e-n;return Math.random()*t+n};var Dt=12,Rt=9;function ze(n,e){const t=[],r=[];return c.forEach(n,(s,i,a)=>{e(s,i,a)?t.push(s):r.push(s)}),[t,r]}function Wn(n){return n instanceof ge}const st=function(n){return n instanceof ee};function En(n){return n instanceof $}function yt(n){return n instanceof v?n.terms:[n]}class ge{constructor(){this.hints={parens:!1}}construct(e){const t=this.func,r=new t(...e);if(typeof r>"u")throw new Error("constructor function returning undefined");return r}recurse(e,...t){var r=this.args().map(function(s){return c.isString(s)||c.isNumber(s)?s:s==null?void 0:s[e].apply(s,t)});return this.construct(r)}eval(e={},t){throw new Error("Abstract method - must override for expr: "+this.print())}codegen(){throw new Error("Abstract method - must override for expr: "+this.print())}compile(){var e=this.codegen();try{return new Function("vars","return "+e+";")}catch{throw new Error("Function did not compile: "+e)}}asTex(e){e=e||{},c.defaults(e,{display:!0,dynamic:!0,times:!1});let t=this.tex();return e.display&&(t="\\displaystyle "+t),e.dynamic&&(t=t.replace(/\(/g,"\\left("),t=t.replace(/\)/g,"\\right)")),e.times&&(t=t.replace(/\\cdot/g,"\\times")),t}name(){return this.func.name}repr(){return this.name()+"("+this.args().map(function(e){return c.isString(e)||c.isNumber(e)?e:e==null?void 0:e.repr()}).join(",")+")"}strip(){return this.recurse("strip")}normalize(){return this.recurse("normalize")}expand(){return this.recurse("expand")}factor(e){return this.recurse("factor",e)}collect(e){return this.recurse("collect",e)}equals(e){return this.normalize().print()===e.normalize().print()}simplify(e){e={once:!1,...e};var t=this.factor(e),r=t.collect(e);t.equals(r)&&(r=this.collect(e));var s=r.expand(),i=s.collect(e);s.equals(i)&&(i=r.collect(e));var a=i;return e.once||this.equals(a)?a:a.simplify(e)}isSimplified(){return this.equals(this.simplify())}exprArgs(){return this.args().filter(Wn)}getVars(e){return c.uniq(c.flatten(c.invoke(this.exprArgs(),"getVars",e))).sort()}getConsts(){return c.uniq(c.flatten(c.invoke(this.exprArgs(),"getConsts"))).sort()}getUnits(){return c.flatten(c.invoke(this.exprArgs(),"getUnits"))}is(e){return this instanceof e}has(e){return this instanceof e?!0:c.any(this.exprArgs(),function(t){return t.has(e)})}raiseToThe(e,t){return new _(this,e)}isSubtract(){return!1}isDivide(){return!1}isRoot(){return!1}needsExplicitMul(){return this.exprArgs()[0].needsExplicitMul()}sameVars(e){var t=this.getVars(),r=e.getVars(),s=function(g,O){return!c.difference(g,O).length},i=function(g){return c.uniq(c.invoke(g,"toLowerCase")).sort()},a=s(t,r),l=s(i(t),i(r));return{equal:a,equalIgnoringCase:l}}compare(e){if(e instanceof Be)return!1;var t=c.union(this.getVars(!0),e.getVars(!0)),r=function(d,P){return Math.abs(d)<1||Math.abs(P)<1?Math.abs(d-P):Math.abs(1-d/P)},s=function(d,P){var S=r(d,P);return d===P||Ft(d)&&Ft(P)||S<Math.pow(10,-Rt)};if(!c.union(this.getVars(!1),e.getVars(!1)).length&&!this.has(ce)&&!e.has(ce))return s(this.eval(),e.eval());var a=this.collect(),l=e.collect(),g=this.getUnits(),O=e.getUnits();if(!c.isEqual(g,O))return!1;for(var h=0;h<Dt;h++){var f={},p=Math.pow(10,1+Math.floor(3*h/Dt)),y=h%2===0;c.each(t,function(P){f[P]=y?An(-p,p):c.random(-p,p)});let d;if(a.has(Pe)||l.has(Pe)||a.has(ce)||l.has(ce)){const P=a.partialEval(f),S=l.partialEval(f);d=P.simplify().equals(S.simplify())}else{const P=a.eval(f),S=l.eval(f);d=s(P,S)}if(!d)return!1}return!0}partialEval(e){return this instanceof ce?this:this.has(Pe)?this instanceof Pe?new Pe(this.symbol,this.arg.partialEval(e)):this.recurse("partialEval",e):new ie(+this.eval(e).toFixed(Rt)).collect()}sameForm(e){return this.strip().equals(e.strip())}findGCD(e){return this.equals(e)?e:J}getDenominator(){return J}asMul(){return new v(J,this)}isPositive(){throw new Error("Abstract method - must override for expr: "+this.print())}isNegative(){return!1}asPositiveFactor(){return this.isPositive()?this:J}addHint(e){if(!e)return this;var t=this.construct(this.args());return t.hints=c.clone(this.hints),t.hints[e]=!0,t}completeParse(){return this.recurse("completeParse")}abs(){throw new Error("Abstract method - must override for expr: "+this.print())}negate(){return new v(xe,this)}}class ot extends ge{constructor(...e){super(),e.length===1?this.terms=e[0]:this.terms=e}args(){return this.terms}normalize(){var e=c.sortBy(c.invoke(this.terms,"normalize"),t=>t.print());return new this.func(e)}expand(){return this.recurse("expand").flatten()}partition(){var[e,t]=ze(this.terms,r=>r instanceof G);return[new this.func(e),new this.func(t)]}flatten(){var e=this,t=c.reject(this.terms,a=>a.equals(e.identity));if(t.length===0)return e.identity;if(t.length===1)return t[0];const[r,s]=ze(t,a=>a instanceof e.func);var i=s.concat(c.flatten(c.pluck(r,"terms"),!0));return new e.func(i)}isPositive(){var e=c.invoke(this.terms,"collect");return c.all(c.invoke(e,"isPositive"))}replace(e,t){const r=e instanceof ge?c.indexOf(this.terms,e):e;var s=[];Array.isArray(t)?s=t:t&&(s=[t]);var i=this.terms.slice(0,r).concat(s).concat(this.terms.slice(r+1));return new this.func(i)}remove(e){return this.replace(e)}getDenominator(){return new v(c.invoke(this.terms,"getDenominator")).flatten()}}class ee extends ot{constructor(){super(...arguments),this.identity=Je,this.func=ee}eval(e={},t){return c.reduce(this.terms,(r,s)=>r+s.eval(e,t),0)}codegen(){return c.map(this.terms,e=>"("+e.codegen()+")").join(" + ")||"0"}print(){return c.invoke(this.terms,"print").join("+")}tex(){let e="";return c.each(this.terms,t=>{!e||t.isSubtract()?e+=t.tex():e+="+"+t.tex()}),e}collect(e){var t=c.invoke(this.terms,"collect",e),r=[];c.each(t,a=>{if(a instanceof v){var l=a.partition();r.push([l[1].flatten(),l[0].reduce(e)])}else a instanceof G?r.push([J,a]):r.push([a,J])});var s=c.groupBy(r,a=>a[0].normalize().print()),i=c.compact(c.map(s,a=>{var l=a[0][0],g=new ee(c.zip.apply(c,a)[1]),O=g.reduce(e);return new v(O,l).collect(e)}));return new ee(i).flatten()}factor(e={keepNegative:!1}){const t=this.terms.map(l=>l.collect());let r;t[0]instanceof v?r=t[0].terms:r=[t[0]],c.each(c.rest(this.terms),l=>{r=c.map(r,g=>l.findGCD(g))}),!e.keepNegative&&this.isNegative()&&r.push(xe);const s=new v(r).flatten().collect(),i=t.map(l=>v.handleDivide(l,s).simplify()),a=new ee(i).flatten();return v.createOrAppend(s,a).flatten()}reduce(e){return c.reduce(this.terms,(t,r)=>t.add(r,e),this.identity)}needsExplicitMul(){return!1}isNegative(){var e=c.invoke(this.terms,"collect");return c.all(c.invoke(e,"isNegative"))}negate(){return new ee(c.invoke(this.terms,"negate"))}static createOrAppend(e,t){return e instanceof ee?new ee(e.terms.concat(t)):new ee(e,t)}}class v extends ot{constructor(){super(...arguments),this.identity=J,this.func=v}eval(e={},t){return c.reduce(this.terms,(r,s)=>r*s.eval(e,t),1)}codegen(){return c.map(this.terms,e=>"("+e.codegen()+")").join(" * ")||"0"}print(){return c.map(this.terms,e=>e instanceof ee?"("+e.print()+")":e.print()).join("*")}getUnits(){var e=c(this.terms).chain().map(t=>t.getUnits()).flatten().value();return e.sort((t,r)=>t.unit.localeCompare(r.unit)),e}tex(){for(var e=" \\cdot ",t=c.groupBy(this.terms,d=>d.isDivide()?"inverse":d instanceof G?"number":"other"),r=t.inverse||[],s=t.number||[],i=t.other||[],a="",l,g=0;g<s.length;g++){var O=s[g]instanceof $&&!(s[g]instanceof I);if(O&&i.length>0&&r.length>0){var h=s.slice();h.splice(g,1);var f=h.concat(r).concat(i);return s[g].tex()+new v(f).tex()}}if(s=c.compact(c.map(s,d=>{var P=!d.hints.fraction||r.length>0;if(d instanceof $&&!(d instanceof I)&&P){r.push(new _(new I(d.d),Te));var S=new I(d.n);return S.hints=d.hints,c.any(d.hints)?S:null}else return d})),s.length===0&&i.length===1)l=i[0].tex();else{var p="";c.each(s,d=>{d.hints.subtract&&d.hints.entered?(a+="-",p+=(p?e:"")+d.abs().tex()):d instanceof I&&d.n===-1&&(d.hints.negate||d.hints.subtract)?a+="-":p+=(p?e:"")+d.tex()}),c.each(i,d=>{d.needsExplicitMul()?p+=(p?e:"")+d.tex():d instanceof ee?p+="("+d.tex()+")":p+=d.tex()}),l=p||"1"}if(r.length){var y=new v(c.invoke(r,"asDivide")).flatten().tex();return a+"\\frac{"+l+"}{"+y+"}"}else return a+l}strip(){var e=c.map(this.terms,t=>t instanceof G?t.abs():t.strip());return new v(e).flatten()}expand(){const e=function(O){return O instanceof _&&O.exp.isNegative()},t=function(O){return e(O)&&st(O.base)},r=this.recurse("expand").flatten(),s=yt(r),i=c.any(s,st),a=c.any(s,t);if(!(i||a))return r;let[l,g]=ze(s,e);if(i){const[O,h]=ze(g,st),f=c.reduce(O,function(y,d){return c.reduce(y,function(P,S){return P.concat(c.map(d.terms,N=>S.concat(N)))},[])},[[]]),p=c.map(f,function(y){return new v(h.concat(y)).flatten()});g=[new ee(p)]}if(a){const O=new v(c.invoke(l,"getDenominator")).flatten();l=[new _(O.expand(),Te)]}return new v(g.concat(l)).flatten()}factor(e){var t=this.recurse("factor",e).flatten();if(!(t instanceof v))return t;var[r,s]=ze(t.terms,l=>l instanceof $);const i=c.reduce(r,(l,g)=>({n:l.n*g.n,d:l.d*g.d}),{n:1,d:1}),a=i.d===1?new I(i.n):new $(i.n,i.d);return new v(s.concat(a)).flatten()}collect(e){var t=this.recurse("collect",e).partition(),r=t[0].reduce(e);if(r.eval()===0)return Je;const s=t[1].flatten();if(!(s instanceof v))return new v(r,s).flatten();const i=s.terms;var a=[];c.each(i,S=>{S instanceof _?a.push([S.base,S.exp]):a.push([S,J])});var l=c.groupBy(a,S=>S[0].normalize().print()),g=c.compact(c.map(l,S=>{var N=S[0][0],j=new ee(c.zip.apply(c,S)[1]),X=j.collect(e);return X instanceof G&&X.eval()===0?null:[N,X]}));const O=c.groupBy(g,S=>S[0]instanceof z&&S[0].isBasic()?"trig":S[0]instanceof ae?"log":"expr");let h=O.trig||[],f=O.log||[];const p=O.expr||[];if(h.length>1){var y=c.groupBy(h,S=>S[0].arg.normalize().print());h=[],c.each(y,S=>{const N=S[0][0].arg;let j={sin:Je,cos:Je};c.each(S,X=>{j[X[0].type]=X[1]}),v.handleNegative(j.sin).collect(e).equals(j.cos)&&(j.cos.isNegative()?j={tan:j.sin}:j={cot:j.cos}),c.each(j,(X,we)=>{h.push([new z(we,N),X])})})}if(f.length>1){var d=c.groupBy(f,S=>S[0].base.normalize().print());f=[],c.each(d,S=>{S.length===2&&v.handleNegative(S[0][1]).collect(e).equals(S[1][1])?S[0][1].isNegative()?f.push([new ae(S[0][0].power,S[1][0].power),S[1][1]]):f.push([new ae(S[1][0].power,S[0][0].power),S[0][1]]):f=f.concat(S)})}var P=c.map([...h,...f,...p],S=>new _(S[0],S[1]).collect(e));return new v([r].concat(P)).flatten()}isSubtract(){return c.any(this.terms,e=>e instanceof G&&!!e.hints.subtract)}factorIn(e){var t=this.partition(),r=t[0].terms,s=r.length&&c.all(r,a=>a.n>0);if(s){var i=r[0].negate();return i.hints=r[0].hints,this.replace(r[0],i.addHint(e))}else return new v([G.negativeOne(e)].concat(this.terms))}factorOut(){var e=!1,t=c.compact(c.map(this.terms,r=>!e&&r instanceof G&&r.hints.divide?(e=!0,r.n!==-1?r.negate():null):r));return t.length===1?t[0]:new v(t)}reduce(e){return c.reduce(this.terms,(t,r)=>t.mul(r,e),this.identity)}findGCD(e){return new v(c.invoke(this.terms,"findGCD",e)).flatten()}asMul(){return this}asPositiveFactor(){if(this.isPositive())return this;{const e=yt(this.collect()).map(t=>t.asPositiveFactor());return new v(e).flatten()}}isNegative(){const e=yt(this.collect()).map(t=>t.isNegative());return c.any(e)}fold(){return v.fold(this)}negate(){var e=r=>r instanceof G;const t=c.find(this.terms,e);return t?this.replace(t,t.negate()):new v([xe].concat(this.terms))}static handleNegative(e,t){if(e instanceof G&&e.n>0){var r=e.negate();return r.hints=e.hints,r.addHint(t)}else return e instanceof v?e.factorIn(t):new v(G.negativeOne(t),e)}static handleDivide(e,t){if(t instanceof v){var r=v.handleDivide(e,t.terms[0]),s=new v(c.rest(t.terms)).flatten();return v.handleDivide(r,s)}var i=p=>p instanceof I,a=p=>p instanceof $;if(i(t)&&e instanceof v&&c.any(e.terms,i)){var l=e.terms.slice().reverse(),g=l.find(a);if(!i(g))return new v(e.terms.concat([new $(1,t.n).addHint("fraction")]));var O=new $(g.n,t.n);return O.hints=g.hints,g===l[0]&&(O=O.addHint("fraction")),g.n<0&&t.n<0?(O.d=-O.d,e.replace(g,[xe,O])):e.replace(g,O)}var h=(p,y)=>{if(y instanceof I){if(p instanceof I)return p.n<0&&y.n<0?[xe,new $(p.n,-y.n).addHint("fraction")]:[new $(p.n,y.n).addHint("fraction")];var d=new $(1,y.eval());return y.eval()<0?[p,d.addHint("negate")]:[p,d]}else{var P;if(y instanceof z&&y.exp){var S=y.exp;y.exp=void 0,y=new _(y,S)}return y instanceof _?P=new _(y.base,v.handleNegative(y.exp,"divide")):P=new _(y,Te),p instanceof I&&p.n===1?[P]:[p,P]}};if(e instanceof v){var f=h(c.last(e.terms),t);return new v(c.initial(e.terms).concat(f))}else{var f=h(e,t);return new v(f).flatten()}}static fold(e){if(e instanceof v){var t=c.find(c.initial(e.terms),p=>(p instanceof z||p instanceof ae)&&!!p.hints.open);if(t){const p=c.last(e.terms);if(t.hints.parens||p.hints.parens||p.has(z)||p.has(ae))t.hints.open=!1;else{const y=t instanceof z?z.create([t.type,t.exp],v.createOrAppend(t.arg,p).fold()):ae.create(t.base,v.createOrAppend(t.power,p).fold()),d=c.indexOf(e.terms,t);return d===0?y:new v(e.terms.slice(0,d).concat(y)).fold()}}var r=e.partition(),s=r[0].terms,i=p=>p.n>0,a=p=>p.n===-1&&!!p.hints.negate,l=function(p){return i(p)||a(p)};const h=s.find(i),f=s.find(a);if(s.length>1&&f&&h&&c.every(s,l)){var g=c.indexOf(e.terms,f),O=c.indexOf(e.terms,h);if(g<O)return e.replace(O,e.terms[O].negate()).remove(g)}}return e}static createOrAppend(e,t){return e instanceof v?new v(e.terms.concat(t)):new v(e,t)}}const K=class K extends ge{constructor(e,t){super(),this.func=K,this.base=e,this.exp=t}args(){return[this.base,this.exp]}eval(e={},t){var r=this.base.eval(e,t),s=this.exp.eval(e,t);if(r<0){var i=this.exp.simplify();if(i instanceof ie){var a=i.n,l=(a-+a.toFixed()).toString().length-2,g=Math.pow(10,l),O=new $(a*g,g);i=O.simplify()}if(i instanceof $){var h=Math.abs(i.d)%2===1;if(h){var f=Math.abs(i.n)%2===1,p=f?-1:1;return p*Math.pow(-1*r,s)}}}return Math.pow(r,s)}getUnits(){return this.base.getUnits().map(e=>({unit:e.unit,pow:e.pow*this.exp.n}))}codegen(){return"Math.pow("+this.base.codegen()+", "+this.exp.codegen()+")"}print(){var e=this.base.print();return(this.base instanceof ot||this.base instanceof K)&&(e="("+e+")"),e+"^("+this.exp.print()+")"}tex(){if(this.isDivide())return"\\frac{1}{"+this.asDivide().tex()+"}";if(this.isRoot()&&En(this.exp)){if(this.exp.n!==1)throw new Error("Node marked with hint 'root' does not have exponent of form 1/x.");return this.exp.d===2?"\\sqrt{"+this.base.tex()+"}":"\\sqrt["+this.exp.d+"]{"+this.base.tex()+"}"}else if(this.base instanceof z&&!this.base.isInverse()&&this.exp instanceof G&&this.exp.isSimple()&&this.exp.eval()>=0){var e=this.base.texSplit();return e[0]+"^{"+this.exp.tex()+"}"+e[1]}else{var t=this.base.tex();return this.base instanceof ot||this.base instanceof K||this.base instanceof G&&!this.base.isSimple()?t="("+t+")":(this.base instanceof z||this.base instanceof ae)&&(t="["+t+"]"),t+"^{"+this.exp.tex()+"}"}}needsExplicitMul(){return this.isRoot()?!1:this.base.needsExplicitMul()}expand(){var e=this.recurse("expand");if(e.base instanceof v){var t=c.map(e.base.terms,l=>new K(l,e.exp));return new v(t).expand()}else if(e.base instanceof ee&&e.exp instanceof I&&e.exp.abs().eval()>1){var r=e.exp.eval()>0,s=e.exp.abs().eval(),i=function(f){return r?f:new K(f,Te)};const l={1:e.base};for(var a=2;a<=s;a*=2){const f=new v(l[a/2],l[a/2]);l[a]=f.expand().collect()}if(s in l)return i(l[s]);let g=c.map(s.toString(2).split(""),function(f,p,y){return Number(f)*Math.pow(2,y.length-p-1)});g=c.without(g,0);const O=[];for(const f of g)f in l&&O.push(l[f]);const h=new v(O).expand().collect();return i(h)}else if(e.exp instanceof ee){const l=c.map(e.exp.terms,g=>new K(e.base,g).expand());return new v(l).expand()}else return e}factor(){var e=this.recurse("factor");if(e.base instanceof v){var t=c.map(e.base.terms,r=>r instanceof I&&e.exp.equals(Te)?new $(1,r.n):new K(r,e.exp));return new v(t)}else return e}collect(e){if(this.base instanceof K){const s=this.base.base,i=v.createOrAppend(this.base.exp,this.exp);return new K(s,i).collect(e)}const t=this.recurse("collect",e),r=function(s){return s instanceof ae&&s.base.equals(t.base)};if(t.exp instanceof G&&t.exp.eval()===0)return J;if(t.exp instanceof G&&t.exp.eval()===1)return t.base;if(r(t.exp))return t.exp.power;if(t.exp instanceof v&&c.any(t.exp.terms,r)){const s=t.exp.terms.find(r),i=s.power,a=t.exp.remove(s).flatten();return new K(i,a).collect(e)}else if(t.base instanceof G&&t.exp instanceof G){if(e&&e.preciseFloats){const s=t.exp.asRational(),i=t.base.getDecimalPlaces();if(new K(t.base,new $(1,s.d)).collect().getDecimalPlaces()>i){const g=new K(t.base,new I(s.n)).collect();return new K(g,new $(1,s.d))}}return t.base.raiseToThe(t.exp,e)}else return t}isDivide(){var e=function(t){return t instanceof G&&!!t.hints.divide};return e(this.exp)||this.exp instanceof v&&c.any(this.exp.terms,e)}asDivide(){if(this.exp instanceof G){if(this.exp.eval()===-1)return this.base;var e=this.exp.negate();return e.hints=c.clone(this.exp.hints),e.hints.divide=!1,new K(this.base,e)}else{if(this.exp instanceof v)return new K(this.base,this.exp.factorOut());throw new Error("called asDivide() on an Expr that wasn't a Num or Mul")}}isRoot(){return this.exp instanceof $&&!!this.exp.hints.root}isSquaredTrig(){return this.base instanceof z&&!this.base.isInverse()&&this.exp instanceof G&&this.exp.eval()===2}getDenominator(){if(this.exp instanceof G&&this.exp.eval()===-1)return v.createOrAppend(this.base,this.base.getDenominator()).flatten();if(this.exp.isNegative()){var e=new K(this.base,v.handleNegative(this.exp).collect());return v.createOrAppend(e,e.collect().getDenominator()).flatten()}else return this.base instanceof G?new K(this.base.getDenominator(),this.exp).collect():J}findGCD(e){const[t,r]=e instanceof K?[e.base,e.exp]:[e,J];if(this.base.equals(t)){if(this.exp.equals(r))return this;if(this.exp instanceof G&&r instanceof G)return new K(this.base,G.min(this.exp,r)).collect();if(this.exp instanceof G||r instanceof G)return J;var s=this.exp.asMul().partition(),i=r.asMul().partition();if(s[1].equals(i[1])){var a=G.min(s[0].reduce(),i[0].reduce()),l=new v(a,s[1].flatten()).flatten();return new K(t,l).collect()}}return J}isPositive(){if(this.base.isPositive())return!0;var e=this.exp.simplify();return e instanceof I&&e.eval()%2===0}asPositiveFactor(){if(this.isPositive())return this;var e=this.exp.simplify();if(e instanceof I){var t=e.eval();if(t>2)return new K(this.base,new I(t-1));if(t<-2)return new K(this.base,new I(t+1))}return J}static sqrt(e){return new K(e,Mn)}};K.nthroot=function(e,t){var r=v.fold(v.handleDivide(new I(1),t));return new K(e,r.addHint("root"))};let _=K;class ae extends ge{constructor(e,t){super(),this.func=ae,this.base=e,this.power=t,this.hints={...this.hints,open:!1}}args(){return[this.base,this.power]}eval(e={},t){return Math.log(this.power.eval(e,t))/Math.log(this.base.eval(e,t))}codegen(){return"(Math.log("+this.power.codegen()+") / Math.log("+this.base.codegen()+"))"}print(){var e="("+this.power.print()+")";return this.isNatural()?"ln"+e:"log_("+this.base.print()+") "+e}tex(){var e="("+this.power.tex()+")";return this.isNatural()?"\\ln"+e:"\\log_{"+this.base.tex()+"}"+e}collect(e){var t=this.recurse("collect",e);return t.power instanceof G&&t.power.eval()===1?Je:t.base.equals(t.power)?J:t.power instanceof _&&t.power.base.equals(t.base)?t.power.exp:t}expand(){var e=this.recurse("expand");if(e.power instanceof v){var t=c.map(e.power.terms,r=>new ae(e.base,r).expand());return new ee(t)}else return e.power instanceof _?new v(e.power.exp,new ae(e.base,e.power.base).expand()).flatten():e.isNatural()?e:v.handleDivide(new ae(Me.e,e.power),new ae(Me.e,e.base))}isPositive(){var e=this.collect();return e instanceof ae&&e.base instanceof G&&e.power instanceof G?this.eval()>0:!1}needsExplicitMul(){return!1}isNatural(){return this.base.equals(Me.e)}static natural(){return Me.e}static common(){return Nn}static create(e,t){var r=new ae(e,t);return t.hints.parens||(r=r.addHint("open")),r}}class z extends ge{constructor(e,t){super(),this.func=z,this.functions={sin:{eval:Math.sin,codegen:"Math.sin((",tex:"\\sin",expand:()=>this},cos:{eval:Math.cos,codegen:"Math.cos((",tex:"\\cos",expand:()=>this},tan:{eval:Math.tan,codegen:"Math.tan((",tex:"\\tan",expand:()=>v.handleDivide(z.sin(this.arg),z.cos(this.arg))},csc:{eval:r=>1/Math.sin(r),codegen:"(1/Math.sin(",tex:"\\csc",expand:()=>v.handleDivide(J,z.sin(this.arg))},sec:{eval:r=>1/Math.cos(r),codegen:"(1/Math.cos(",tex:"\\sec",expand:()=>v.handleDivide(J,z.cos(this.arg))},cot:{eval:r=>1/Math.tan(r),codegen:"(1/Math.tan(",tex:"\\cot",expand:()=>v.handleDivide(z.cos(this.arg),z.sin(this.arg))},arcsin:{eval:Math.asin,codegen:"Math.asin((",tex:"\\arcsin"},arccos:{eval:Math.acos,codegen:"Math.acos((",tex:"\\arccos"},arctan:{eval:Math.atan,codegen:"Math.atan((",tex:"\\arctan"},arccsc:{eval:r=>Math.asin(1/r),codegen:"Math.asin(1/(",tex:"\\operatorname{arccsc}"},arcsec:{eval:r=>Math.acos(1/r),codegen:"Math.acos(1/(",tex:"\\operatorname{arcsec}"},arccot:{eval:r=>Math.atan(1/r),codegen:"Math.atan(1/(",tex:"\\operatorname{arccot}"},sinh:{eval:r=>(Math.exp(r)-Math.exp(-r))/2,codegen:r=>"((Math.exp("+r+") - Math.exp(-("+r+"))) / 2)",tex:"\\sinh",expand:()=>this},cosh:{eval:r=>(Math.exp(r)+Math.exp(-r))/2,codegen:r=>"((Math.exp("+r+") + Math.exp(-("+r+"))) / 2)",tex:"\\cosh",expand:()=>this},tanh:{eval:r=>(Math.exp(r)-Math.exp(-r))/(Math.exp(r)+Math.exp(-r)),codegen:r=>"((Math.exp("+r+") - Math.exp(-("+r+"))) / (Math.exp("+r+") + Math.exp(-("+r+"))))",tex:"\\tanh",expand:()=>v.handleDivide(z.sinh(this.arg),z.cosh(this.arg))},csch:{eval:r=>2/(Math.exp(r)-Math.exp(-r)),codegen:r=>"(2 / (Math.exp("+r+") - Math.exp(-("+r+"))))",tex:"\\csch",expand:()=>v.handleDivide(J,z.sinh(this.arg))},sech:{eval:r=>2/(Math.exp(r)+Math.exp(-r)),codegen:r=>"(2 / (Math.exp("+r+") + Math.exp(-("+r+"))))",tex:"\\sech",expand:()=>v.handleDivide(J,z.cosh(this.arg))},coth:{eval:r=>(Math.exp(r)+Math.exp(-r))/(Math.exp(r)-Math.exp(-r)),codegen:r=>"((Math.exp("+r+") + Math.exp(-("+r+"))) / (Math.exp("+r+") - Math.exp(-("+r+"))))",tex:"\\coth",expand:()=>v.handleDivide(z.cosh(this.arg),z.sinh(this.arg))}},this.type=e,this.arg=t,this.hints={...this.hints,open:!1}}args(){return[this.type,this.arg]}isEven(){return c.contains(["cos","sec"],this.type)}isInverse(){return this.type.indexOf("arc")===0}isBasic(){return c.contains(["sin","cos"],this.type)}eval(e={},t){var r=this.functions[this.type].eval,s=this.arg.eval(e,t);return r(s)}codegen(){var e=this.functions[this.type].codegen;if(typeof e=="function")return e(this.arg.codegen());if(typeof e=="string")return e+this.arg.codegen()+"))";throw new Error("codegen not implemented for "+this.type)}print(){return this.type+"("+this.arg.print()+")"}tex(){var e=this.functions[this.type].tex,t="("+this.arg.tex()+")";return e+t}texSplit(){var e=this.functions[this.type].tex,t="("+this.arg.tex()+")";return[e,t]}isPositive(){var e=this.collect();return e instanceof z&&e.arg instanceof G?this.eval()>0:!1}completeParse(){if(this.exp){var e=new _(this,this.exp);return this.exp=void 0,e}else return this}needsExplicitMul(){return!1}expand(){var e=this.recurse("expand");if(e.isInverse())return e;var t=e.functions[e.type].expand;return c.bind(t,e)()}collect(e){var t=this.recurse("collect",e);if(!t.isInverse()&&t.arg.isNegative()){const r=t.arg instanceof G?t.arg.abs():v.handleDivide(t.arg,xe).collect(e);return t.isEven()?new z(t.type,r):new v(xe,new z(t.type,r))}else return t}static create(e,t){var r=e[0],s=e[1];s&&s.equals(xe)&&(r="arc"+r,s=void 0);var i=new z(r,t);return t.hints.parens||(i=i.addHint("open")),s&&(i.exp=s),i}static sin(e){return new z("sin",e)}static cos(e){return new z("cos",e)}static sinh(e){return new z("sinh",e)}static cosh(e){return new z("cosh",e)}}class Ye extends ge{constructor(e){super(),this.func=Ye,this.arg=e}args(){return[this.arg]}eval(e={},t){return Math.abs(this.arg.eval(e,t))}codegen(){return"Math.abs("+this.arg.codegen()+")"}print(){return"abs("+this.arg.print()+")"}tex(){return"\\left|"+this.arg.tex()+"\\right|"}collect(e){var t=this.recurse("collect",e);if(t.arg.isPositive())return t.arg;if(t.arg instanceof G)return t.arg.abs();if(t.arg instanceof v){var r=c.groupBy(t.arg.terms,i=>i.isPositive()?"positive":i instanceof G?"number":"other"),s=r.positive.concat(c.invoke(r.number,"abs"));return r.other.length&&s.push(new Ye(new v(r.other).flatten())),new v(s).flatten()}else return t}expand(){var e=this.recurse("expand");if(e.arg instanceof v){var t=c.map(e.arg.terms,r=>new Ye(r));return new v(t)}else return e}isPositive(){return!0}}class Be extends ge{constructor(e,t,r){super(),this.func=Be,this.signs={"=":" = ","<":" < ",">":" > ","<>":" \\ne ","<=":" \\le ",">=":" \\ge "},this.left=e,this.type=t,this.right=r}args(){return[this.left,this.type,this.right]}needsExplicitMul(){return!1}print(){return this.left.print()+this.type+this.right.print()}tex(){return this.left.tex()+this.signs[this.type]+this.right.tex()}normalize(){var e=this.recurse("normalize");return c.contains([">",">="],e.type)?new Be(e.right,e.type.replace(">","<"),e.left):e}asExpr(e=!1){var t=g=>g instanceof G&&g.isSimple()&&g.eval()===0;let r=[];this.left instanceof ee?r=c.clone(this.left.terms):t(this.left)||(r=[this.left]),this.right instanceof ee?r=r.concat(this.right.negate().terms):t(this.right)||r.push(this.right.negate());var s=!this.isEquality();r=c.invoke(r,"collect",{preciseFloats:!0});for(var i=0;i<r.length;i++){var a=r[i].getDenominator();s&&!a.isPositive()&&(a=a.asPositiveFactor()),a.equals(J)||(r=c.map(r,g=>v.createOrAppend(g,a).simplify({once:!0,preciseFloats:!0})))}var l=new ee(r).flatten();return e?l:this.divideThrough(l)}divideThrough(e){const t=!this.isEquality(),r=e.simplify({once:!0}),s=r.factor({keepNegative:t});if(!(s instanceof v))return e;const i=s.terms,a=p=>!!p.getVars().length,l=p=>p.equals(J),[g,O]=ze(i,st);if(g.length&&this.isEquality())return new v(g).flatten();let h=O;g.length||(h=c.reject(h,a)),t&&(h=c.invoke(h,"asPositiveFactor")),h=c.reject(h,l),h=c.map(h,p=>new _(p,Te));const f=new v(i.concat(h)).collect();return f.equals(s)?r:f}isEquality(){return c.contains(["=","<>"],this.type)}compare(e){if(!(e instanceof Be))return!1;var t=this.normalize(),r=e.normalize();if(t.type!==r.type)return!1;var s=t.divideThrough(t.asExpr(!0).collect()),i=r.divideThrough(r.asExpr(!0).collect());return t.isEquality()?s.compare(i)||s.compare(v.handleNegative(i)):s.compare(i)}sameForm(e){var t=this.normalize(),r=e.normalize(),s=t.left.sameForm(r.left)&&t.right.sameForm(r.right);return t.isEquality()?s||t.left.sameForm(r.right)&&t.right.sameForm(r.left):s}isSimplified(){var e=this.asExpr(!0),t=this.divideThrough(e).simplify();return e.equals(t)&&this.left.isSimplified()&&this.right.isSimplified()}solveLinearEquationForVariable(e){var t=this.asExpr();if(!(t instanceof ee)||t.terms.length!==2)throw new Error("Can only handle linear equations of the form a + bx (= 0)");var r=l=>l.has(ct)&&c.contains(l.getVars(),e.symbol);const s=r(t.terms[0]),i=s?v.handleNegative(t.terms[1]):v.handleNegative(t.terms[0]),a=s?v.handleDivide(t.terms[0],e):v.handleDivide(t.terms[1],e);return v.handleDivide(i,a).simplify()}}class Le extends ge{needsExplicitMul(){return!1}findGCD(e){return e instanceof Le||e instanceof G?this.equals(e)?this:J:e.findGCD(this)}}class Pe extends Le{constructor(e,t){super(),this.func=Pe,this.symbol=e,this.arg=t}args(){return[this.symbol,this.arg]}print(){return this.symbol+"("+this.arg.print()+")"}tex(){return this.symbol+"("+this.arg.tex()+")"}eval(e={},t){var r=this.arg,s=e[this.symbol],i=c.extend(c.clone(e),{x:r.eval(e,t)}),a=Tt(s,t);return a.parsed?a.expr.eval(i,t):a}codegen(){return'vars["'+this.symbol+'"]('+this.arg.codegen()+")"}getUnits(){return this.arg.getUnits()}getVars(e){return e?this.arg.getVars():c.union(this.arg.getVars(),[this.symbol]).sort()}getConsts(){return this.arg.getConsts()}}class ct extends Le{constructor(e,t){super(),this.func=ct,this.symbol=e,this.subscript=t}args(){return[this.symbol,this.subscript]}exprArgs(){return[]}recurse(){return this}print(){var e="";return this.subscript&&(e="_("+this.subscript.print()+")"),this.symbol+e}prettyPrint(){var e=this.subscript;return e&&(e instanceof G||e instanceof Le)?this.symbol+"_"+e.print():this.print()}tex(){var e="";this.subscript&&(e="_{"+this.subscript.tex()+"}");var t=this.symbol.length>1?"\\":"";return t+this.symbol+e}repr(){return"Var("+this.print()+")"}eval(e={},t){return e[this.prettyPrint()]}codegen(){return'vars["'+this.prettyPrint()+'"]'}getVars(){return[this.prettyPrint()]}isPositive(){return!1}}const Ie=class Ie extends Le{constructor(e){super(),this.func=Ie,this.symbol=e}args(){return[this.symbol]}recurse(){return this}eval(e={},t){return this.symbol==="pi"?Math.PI:this.symbol==="e"?Math.E:void 0}codegen(){return this.symbol==="pi"?"Math.PI":this.symbol==="e"?"Math.E":void 0}print(){return this.symbol}tex(){return this.symbol==="pi"?"\\pi ":this.symbol==="e"?"e":void 0}isPositive(){return this.eval()>0}abs(){return this.eval()>0?this:v.handleNegative(this)}getConsts(){return[this.print()]}};Ie.e=new Ie("e"),Ie.pi=new Ie("pi");let Me=Ie;class G extends ge{constructor(){super(),this.n=0,this.hints={...this.hints,negate:!1,subtract:!1,divide:!1,root:!1,fraction:!1,entered:!1}}repr(){return this.print()}strip(){return this.abs()}recurse(){return this}codegen(){return this.print()}isSubtract(){return!!this.hints.subtract}needsExplicitMul(){return!0}isPositive(){return this.eval()>0}isNegative(){return this.eval()<0}asPositiveFactor(){return this.isPositive()?this:this.abs()}getDecimalPlaces(){var e=(""+this.n).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0}static negativeOne(e){return e==="subtract"?In:e==="divide"?Te:xe}static findGCD(e,t){var r;if(e=Math.abs(e),t=Math.abs(t),e!==Math.floor(e)||t!==Math.floor(t))return 1;for(;t;)r=e%t,e=t,t=r;return e}static min(...e){return c.min(e,t=>t.eval())}static max(...e){return c.max(e,t=>t.eval())}}class $ extends G{constructor(e,t){super(),this.func=$;var r=e,s=t;s<0&&(r=-r,s=-s),this.n=r,this.d=s}args(){return[this.n,this.d]}eval(){return this.n/this.d}print(){return this.n.toString()+"/"+this.d.toString()}tex(){var e="\\frac{"+Math.abs(this.n).toString()+"}{"+this.d.toString()+"}";return this.n<0?"-"+e:e}add(e,t){return e instanceof $?new $(this.n*e.d+this.d*e.n,this.d*e.d).collect():e.add(this,t)}mul(e,t){return e instanceof $?new $(this.n*e.n,this.d*e.d).collect():e.mul(this,t)}collect(){var e=G.findGCD(this.n,this.d),t=this.n/e,r=this.d/e;return r===1?new I(t):new $(t,r)}negate(){return new $(-this.n,this.d)}abs(){return new $(Math.abs(this.n),this.d)}findGCD(e){if(e instanceof $){var t=G.findGCD(this.n*e.d,e.n*this.d),r=this.d*e.d;return new $(t,r).collect()}else return e instanceof I?new $(G.findGCD(this.n,e.n),this.d):e.findGCD(this)}raiseToThe(e){if(e instanceof I){var t=e.eval()>0,r=e.abs().eval(),s=Math.pow(this.n,r),i=Math.pow(this.d,r);return t?new $(s,i).collect():new $(i,s).collect()}else return new ie(this.eval()).raiseToThe(e)}getDenominator(){return new I(this.d)}isSimple(){return!1}asRational(){return this}}class I extends ${constructor(e){super(e,1),this.func=I}args(){return[this.n]}print(){return this.n.toString()}tex(){return this.n.toString()}negate(){return new I(-this.n)}abs(){return new I(Math.abs(this.n))}isSimple(){return!0}findGCD(e){return e instanceof I?new I(G.findGCD(this.n,e.n)):e.findGCD(this)}static create(e){return new I(e).addHint("entered")}}class ie extends G{constructor(e){super(),this.func=ie,this.n=e}args(){return[this.n]}eval(){return this.n}print(){return this.n.toString()}tex(){return this.n.toString()}add(e,t){return t&&t.preciseFloats?ie.toDecimalPlaces(this.n+e.eval(),Math.max(this.getDecimalPlaces(),e.getDecimalPlaces())):new ie(this.n+e.eval()).collect()}mul(e,t){return t&&t.preciseFloats?ie.toDecimalPlaces(this.n*e.eval(),this.getDecimalPlaces()+e.getDecimalPlaces()):new ie(this.n*e.eval()).collect()}collect(e){return this}negate(){return new ie(-this.n)}abs(){return new ie(Math.abs(this.n))}findGCD(e){return e instanceof G?new ie(G.findGCD(this.eval(),e.eval())).collect():e.findGCD(this)}raiseToThe(e,t){return t&&t.preciseFloats&&e instanceof I&&e.n>1?ie.toDecimalPlaces(new _(this,e).eval(),this.getDecimalPlaces()*e.n):new ie(new _(this,e).eval()).collect()}asRational(){var e=this.n.toString().split(".");if(e.length===1)return new $(this.n,1);var t=Number(e.join("")),r=Math.pow(10,e[1].length);return new $(t,r).collect()}getDenominator(){return this.asRational().getDenominator()}isSimple(){return!0}static create(e){return new ie(e).addHint("entered")}static toDecimalPlaces(e,t){return new ie(+e.toFixed(Math.min(t,20))).collect()}}const xe=new I(-1).addHint("negate"),In=new I(-1).addHint("subtract"),Te=new I(-1).addHint("divide"),Mn=new $(1,2).addHint("root"),Je=new I(0),J=new I(1),Nn=new I(10);var Ln=function(n,e){throw new Error(e.loc.first_column)};Ve.yy={Add:ee,Mul:v,Pow:_,Log:ae,Trig:z,Eq:Be,Abs:Ye,Func:Pe,Const:Me,Var:ct,Int:I,Float:ie,parseError:Ln,constants:["e"],symbolLexer:function(n){return c.contains(Ve.yy.constants,n)?"CONST":c.contains(Ve.yy.functions,n)?"FUNC":"VAR"}};const Tt=function(n,e){try{e&&e.functions?Ve.yy.functions=c.without(e.functions,"i"):Ve.yy.functions=[],e&&e.decimal_separator&&(n=n.split(e.decimal_separator).join("."));var t=Ve.parse(n).completeParse();return{parsed:!0,expr:t}}catch(r){return{parsed:!1,error:r.message}}};class ce extends Le{constructor(e){super(),this.func=ce,this.symbol=e}args(){return[this.symbol]}recurse(){return this}eval(e={},t){return 1}getUnits(){return[{unit:this.symbol,pow:1}]}codegen(){return"1"}print(){return this.symbol}tex(){return this.symbol}collect(e){if(c(Cn).has(this.symbol))return this;if(c(Gt).has(this.symbol))return Gt[this.symbol].conversion;throw new Error("could not understand unit: "+this.symbol)}}var Cn={m:new ce("m"),g:new ce("g"),s:new ce("s"),A:new ce("A"),K:new ce("K"),mol:new ce("mol"),cd:new ce("cd")};new _(new I(10),new I(-18)),new _(new I(10),new I(-15)),new _(new I(10),new I(-12)),new _(new I(10),new I(-9)),new _(new I(10),new I(-6)),new _(new I(10),new I(-3)),new _(new I(10),new I(-2)),new _(new I(10),new I(-1)),new I(10),new _(new I(10),new I(2)),new _(new I(10),new I(3)),new _(new I(10),new I(6)),new _(new I(10),new I(9)),new _(new I(10),new I(12)),new _(new I(10),new I(15)),new _(new I(10),new I(18)),new _(new I(10),new I(27));const Y="hasPrefixes",W="hasntPrefixes",b=function(n,e){var t=n.split("|"),r=t[0].trim(),s=t[1].trim(),i=J;r!==""&&(i=Tt(r).expr);var a=s.split("/"),l=[i];return a[0]&&a[0].split(" ").filter(g=>g!=="").forEach(g=>l.push(new ce(g))),a[1]&&a[1].split(" ").filter(g=>g!=="").forEach(g=>l.push(new _(new ce(g),Te))),{conversion:new v(l),prefixes:e}};var Gt={Da:b("1.6605388628 x 10^-24 | g",Y),u:b("| Da",W),meter:b("| m",W),meters:b("| m",W),in:b("254 / 10000 | m",W),ft:b("3048  / 10000 | m",W),yd:b("9144  / 10000 | m",W),mi:b("1609344 / 1000 | m",W),ly:b("9.4607 x 10^15 | m",W),nmi:b("1852 | m",W),Å:b("10^-10 | m",W),pc:b("3.0857 x 10^16 | m",W),min:b("60 | s",W),hr:b("3600 | s",W),sec:b("| s",W),day:b("86400 | s",W),wk:b("604800 | s",W),fortnight:b("14 | day",W),shake:b("10^-8 | s",W),olympiad:b("126200000 | s",W),"°C":b("1 | K",W),"°F":b("5/9 | K",W),"°R":b("5/9 | K",W),e:b("1.6021765314 x 10^-19 | C",W),c:b("299792458 | m / s",W),kn:b("514/1000 | m / s",W),kt:b("| kn",W),knot:b("| kn",W),J:b("| N m",Y),BTU:b("1060 | J",W),cal:b("4184 / 1000 | J",Y),eV:b("1.602176514 x 10^-19 | J",Y),erg:b("10^−7 | J",Y),W:b("| J / s",Y),"H-e":b("80 | W",W),N:b("1000 | g m / s s",Y),lb:b("4448221615 / 1000000000 | N",W),dyn:b("10^-5 | N",W),Pa:b("1 | N / m m m",Y),bar:b("10^5 | Pa",Y),"㏔":b("1/1000 | bar",W),"㍴":b("| bar",W),atm:b("101325 | Pa",W),Torr:b("1/760 | atm",W),mmHg:b("| Torr",W),ha:b("10^4 | m m",W),b:b("10^−28 | m m",Y),barn:b("| b",Y),acre:b("4046.87 | m m",W),skilodge:b("10^-31 | m m",W),outhouse:b("10^-34 | m m",W),shed:b("10^-52 | m m",W),L:b("1/1000 | m m m",Y),gal:b("3785/1000 | L",Y),cup:b("1/16 | gal",W),qt:b("1/4 | gal",W),quart:b("| qt",W),p:b("1/8 | gal",W),pt:b("| p",W),pint:b("| p",W),"fl oz":b("1/8 | cup",W),"fl. oz.":b("1/8 | cup",W),tbsp:b("1/16 | cup",W),tsp:b("1/3 | tbsp",W),rev:b("2 pi | rad",W),deg:b("180 pi | rad",W),"°":b("| deg",W),arcminute:b("1/60 | deg",W),arcsec:b("1/3600 | deg",W),Hu:b("1000 | dB",Y),dozen:b("12 |",W),mol:b("6.0221412927 x 10^23 |",Y),"%":b("1/100 |",W),percent:b("| %",W),ppm:b("1/1000000 |",W),V:b("1000 | g m m / s s C",Y),C:b("| A s",Y),ampere:b("| A",W),Ω:b("| V / A",Y),ohm:b("| Ω",W),F:b("| C / V",Y),H:b("| ohm s",Y),T:b("1000 | g / C s",Y),Wb:b("1000 | g m m / C s",Y),lm:b("pi x 10^4 | cd / m m",W),lx:b("| lm / m m",W),nit:b("| cd / m m",W),sb:b("10^4 | cd / m m",W),stilb:b("1 | sb",W),apostilb:b("1 / pi x 10^(-4) | sb",W),blondel:b("| apostilb",W),asb:b("| apostilb",W),la:b("| lm",W),Lb:b("| lm",W),sk:b("10^-7 | lm",W),skot:b("| sk",W),bril:b("10^-11 | lm",W),Hz:b("| / s",Y)};function Kt(n){if(n.extraKeys)return n.extraKeys;const e=["PI"];if(n.answerForms==null)return e;const t={},r={};for(const l of n.answerForms){const g=Tt(l.value,n);if(g.parsed){const O=g.expr,h=y=>y==="pi"||y==="theta",f=y=>h(y)?y.toUpperCase():y,p=y=>jt.includes(y);for(const y of O.getVars()){const d=f(y);p(d)&&(t[d]=!0)}for(const y of O.getConsts()){const d=f(y);p(d)&&(r[d]=!0)}}}const s=Object.keys(t).sort(),i=Object.keys(r).sort(),a=[...s,...i];return a.length?a:e}function me(n){return(e,t)=>t.success(n(e))}const Fn=H("basic","basic+div","trig","prealgebra","logarithms","basic relations","advanced relations","scientific"),St=D(E(Fn),()=>["basic","trig","prealgebra","logarithms"]);function Xt(n,e){return new At(n,e,t=>t,(t,r)=>r.failure("widget options with a known version number",t))}class At{constructor(e,t,r,s){this.migrateToLatest=r,this.parseOtherVersions=s;const i=fe(t).then(me(this.migrateToLatest)).parser;this.parser=(a,l)=>{if(!Ue(a))return l.failure("object",a);const g=Dn(a,l);return pe(g)?g:g.value.version.major!==e?this.parseOtherVersions(a,l):i(a,l)}}withMigrationFrom(e,t,r){const s=this.parser,i=a=>this.migrateToLatest(r(a));return new At(e,t,i,s)}}const Dn=m({version:D(m({major:x,minor:x}),()=>({major:0,minor:0}))}),Rn=le(u).or(x).or(w(null)).or(w(void 0)).parser,Yt=m({value:o(u),form:D(k,()=>!1),simplify:D(k,()=>!1),considered:H("correct","wrong","ungraded"),key:fe(Rn).then(me(String)).parser});function Jt(n){const e=[];for(const t of n){const{value:r}=t;r!=null&&e.push({...t,value:r})}return e}const Gn=m({major:w(2),minor:x}),qn=je(Gn,w("expression"),m({answerForms:fe(E(Yt)).then(me(Jt)).parser,functions:E(u),times:k,visibleLabel:o(u),ariaLabel:o(u),buttonSets:St,buttonsVisible:o(H("always","never","focused")),extraKeys:E(H(...jt))})),_n=m({major:w(1),minor:x}),$n=je(_n,w("expression"),m({answerForms:fe(E(Yt)).then(me(Jt)).parser,functions:E(u),times:k,visibleLabel:o(u),ariaLabel:o(u),buttonSets:St,buttonsVisible:o(H("always","never","focused"))}));function Vn(n){const{options:e}=n;return{...n,version:{major:2,minor:0},options:{times:e.times,buttonSets:e.buttonSets,functions:e.functions,buttonsVisible:e.buttonsVisible,visibleLabel:e.visibleLabel,ariaLabel:e.ariaLabel,answerForms:e.answerForms,extraKeys:Kt(e)}}}const zn=o(m({major:w(0),minor:x})),Bn=je(zn,w("expression"),m({functions:E(u),times:k,visibleLabel:o(u),ariaLabel:o(u),form:k,simplify:k,value:u,buttonSets:St,buttonsVisible:o(H("always","never","focused"))}));function Un(n){const{options:e}=n;return{...n,version:{major:1,minor:0},options:{times:e.times,buttonSets:e.buttonSets,functions:e.functions,buttonsVisible:e.buttonsVisible,visibleLabel:e.visibleLabel,ariaLabel:e.ariaLabel,answerForms:[{considered:"correct",form:e.form,simplify:e.simplify,value:e.value}]}}}const jn=Xt(2,qn).withMigrationFrom(1,$n,Vn).withMigrationFrom(0,Bn,Un).parser,Hn=fe(w(!1)).then(me(()=>null)).parser,Qt=m({title:D(u,()=>""),hasHint:o(V(k)),hint:le(Hn).or(w(null)).or(w(void 0)).or((n,e)=>Qe(n,e)).parser,content:u,widgets:(n,e)=>He(n,e),widgetEnabled:o(V(k)),immutableWidgets:o(V(k)),images:Ut(u,m({width:x,height:x}))}),Kn=B(w("graded-group"),Qt),Xn=B(w("graded-group-set"),m({gradedGroups:E(Qt)}));function lt(n){const e=(t,r)=>Ue(t)?r.forSubtree(n).failure("a valid value",t[n]):r.failure("object",t);return new Wt(n,e)}class Wt{constructor(e,t){this.discriminantKey=e,this.parser=t}withBranch(e,t){const r=Yn(this.discriminantKey,e,t,this.parser);return new Wt(this.discriminantKey,r)}}function Yn(n,e,t,r){return(s,i)=>Ue(s)?s[n]===e?t(s,i):r(s,i):i.failure("object",s)}const Oe=Q(x,x),ve=Q(Oe,Oe),Jn=B(w("grapher"),m({availableTypes:E(H("absolute_value","exponential","linear","logarithm","quadratic","sinusoid","tangent")),correct:lt("type").withBranch("absolute_value",m({type:w("absolute_value"),coords:V(ve)})).withBranch("exponential",m({type:w("exponential"),asymptote:ve,coords:V(ve)})).withBranch("linear",m({type:w("linear"),coords:V(ve)})).withBranch("logarithm",m({type:w("logarithm"),asymptote:ve,coords:V(ve)})).withBranch("quadratic",m({type:w("quadratic"),coords:V(ve)})).withBranch("sinusoid",m({type:w("sinusoid"),coords:V(ve)})).withBranch("tangent",m({type:w("tangent"),coords:V(ve)})).parser,graph:m({backgroundImage:m({bottom:o(x),height:o(x),left:o(x),scale:o(x),url:o(V(u)),width:o(x)}),box:o(Oe),editableSettings:o(E(H("graph","snap","image","measure"))),gridStep:o(Oe),labels:Q(u,u),markings:H("graph","none","grid"),range:Q(Oe,Oe),rulerLabel:w(""),rulerTicks:x,showProtractor:o(k),showRuler:o(k),showTooltips:o(k),snapStep:o(Oe),step:Oe,valid:o(le(k).or(u).parser)})})),Qn=B(w("group"),(n,e)=>Qe(n,e)),Zn=B(w("iframe"),m({url:u,settings:o(E(m({name:u,value:u}))),width:le(x).or(u).parser,height:le(x).or(u).parser,allowFullScreen:D(k,()=>!1),allowTopNavigation:o(k),static:D(k,()=>!1)})),Zt=(n,e)=>{if(typeof n=="number")return e.success(n);const t=+n;return n===""||isNaN(t)?e.failure("a number or numeric string",n):e.success(t)};function er(n){return n===""?0:n}const tr=fe(le(x).or(u).parser).then(me(er)).then(Zt).parser,qe=D(tr,()=>{}),ut=m({url:o(V(u)),width:qe,height:qe,top:qe,left:qe,bottom:qe,scale:qe}),bt=Q(x,x),nr=B(w("image"),m({title:o(u),caption:o(u),alt:o(u),backgroundImage:ut,static:o(k),labels:o(E(m({content:u,alignment:u,coordinates:E(x)}))),range:o(Q(bt,bt)),box:o(bt)})),rr=(n,e)=>typeof n=="boolean"?e.success(String(n)):e.failure("boolean",n),sr=B(w("input-number"),m({answerType:o(H("number","decimal","integer","rational","improper","mixed","percent","pi")),inexact:o(k),maxError:o(le(x).or(u).parser),rightAlign:o(k),simplify:H("required","optional","enforced"),size:H("normal","small"),value:le(x).or(u).or(rr).parser,customKeypad:o(k)})),_e=Q(x,x),nt=D(u,()=>""),Se=fe(o(u)).then(me(String)).parser,ir=m({type:w("function"),key:Se,options:m({value:u,funcName:u,rangeMin:u,rangeMax:u,color:u,strokeDasharray:u,strokeWidth:x})}),ar=m({type:w("label"),key:Se,options:m({label:u,color:u,coordX:u,coordY:u})}),or=m({type:w("line"),key:Se,options:m({color:u,startX:u,startY:u,endX:u,endY:u,strokeDasharray:u,strokeWidth:x,arrows:u})}),cr=m({type:w("movable-line"),key:Se,options:m({startX:u,startY:u,startSubscript:x,endX:u,endY:u,endSubscript:x,constraint:u,snap:x,constraintFn:u,constraintXMin:u,constraintXMax:u,constraintYMin:u,constraintYMax:u})}),lr=m({type:w("movable-point"),key:Se,options:m({startX:u,startY:u,varSubscript:x,constraint:u,snap:x,constraintFn:u,constraintXMin:nt,constraintXMax:nt,constraintYMin:nt,constraintYMax:nt})}),ur=m({type:w("parametric"),key:Se,options:m({x:u,y:u,rangeMin:u,rangeMax:u,color:u,strokeDasharray:u,strokeWidth:x})}),hr=m({type:w("point"),key:Se,options:m({color:u,coordX:u,coordY:u})}),pr=m({type:w("rectangle"),key:Se,options:m({color:u,coordX:u,coordY:u,width:u,height:u})}),fr=B(w("interaction"),m({static:D(k,()=>!1),graph:m({editableSettings:o(E(H("canvas","graph"))),box:_e,labels:E(u),range:Q(_e,_e),gridStep:_e,markings:H("graph","grid","none"),snapStep:o(_e),valid:o(le(k).or(u).parser),backgroundImage:o(ut),showProtractor:o(k),showRuler:o(k),rulerLabel:o(u),rulerTicks:o(x),tickStep:_e}),elements:E(lt("type").withBranch("function",ir).withBranch("label",ar).withBranch("line",or).withBranch("movable-line",cr).withBranch("movable-point",lr).withBranch("parametric",ur).withBranch("point",hr).withBranch("rectangle",pr).parser)})),oa=["calculator","chi2Table","financialCalculatorMonthlyPayment","financialCalculatorTotalAmount","financialCalculatorTimeToPayOff","periodicTable","periodicTableWithKey","tTable","zTable"],ca=["correct","wrong","ungraded"],dr=["blue","green","grayH","purple","pink","orange","red"],la={blue:"#3D7586",green:"#447A53",grayH:"#3B3D45",purple:"#594094",pink:"#B25071",red:"#D92916",orange:"#946700"},ua={none:0,white:1,translucent:.4,solid:1},gr=["bar","line","pic","histogram","dotplot"],L=Q(x,x),mr=m({type:w("angle"),showAngles:o(k),allowReflexAngles:o(k),angleOffsetDeg:o(x),snapDegrees:o(x),match:o(w("congruent")),coords:o(at(L,L,L)),startCoords:o(at(L,L,L))}),yr=m({type:w("circle"),center:o(L),radius:o(x),startCoords:o(m({center:L,radius:x})),coord:o(L)}),br=m({type:w("linear"),coords:o(V(Q(L,L))),startCoords:o(Q(L,L)),coord:o(L)}),vr=m({type:w("linear-system"),coords:o(V(E(Q(L,L)))),startCoords:o(E(Q(L,L))),coord:o(L)}),xr=m({type:w("none")}),wr=m({type:w("point"),numPoints:o(le(x).or(w("unlimited")).parser),coords:o(V(E(L))),startCoords:o(E(L)),coord:o(L)}),kr=m({type:w("polygon"),numSides:o(le(x).or(w("unlimited")).parser),showAngles:o(k),showSides:o(k),snapTo:o(H("grid","angles","sides")),match:o(H("similar","congruent","approx","exact")),startCoords:o(E(L)),coord:o(L)}),Or=m({type:w("quadratic"),coords:o(V(at(L,L,L))),startCoords:o(at(L,L,L)),coord:o(L)}),Pr=m({type:w("ray"),coords:o(V(Q(L,L))),startCoords:o(Q(L,L)),coord:o(L)}),Tr=m({type:w("segment"),numSegments:o(x),coords:o(V(E(Q(L,L)))),startCoords:o(E(Q(L,L))),coord:o(L)}),Sr=m({type:w("sinusoid"),coords:o(V(E(L))),startCoords:o(E(L)),coord:o(L)}),qt=lt("type").withBranch("angle",mr).withBranch("circle",yr).withBranch("linear",br).withBranch("linear-system",vr).withBranch("none",xr).withBranch("point",wr).withBranch("polygon",kr).withBranch("quadratic",Or).withBranch("ray",Pr).withBranch("segment",Tr).withBranch("sinusoid",Sr).parser,Fe=H(...dr),en=H("none","white","translucent","solid"),ht=H("solid","dashed"),De=m({type:w("label"),coord:L,text:u,color:Fe,size:H("small","medium","large")}),xt=m({type:w("point"),coord:L,color:Fe,filled:k,labels:o(E(De)),ariaLabel:o(u)}),Ar=m({type:w("line"),kind:H("line","ray","segment"),points:Q(xt,xt),color:Fe,lineStyle:ht,showPoint1:D(k,()=>!1),showPoint2:D(k,()=>!1),labels:o(E(De)),ariaLabel:o(u)}),Wr=m({type:w("vector"),points:Q(L,L),color:Fe,labels:o(E(De)),ariaLabel:o(u)}),Er=m({type:w("ellipse"),center:L,radius:L,angle:x,color:Fe,fillStyle:en,strokeStyle:ht,labels:o(E(De)),ariaLabel:o(u)}),Ir=m({type:w("polygon"),points:E(L),color:Fe,showVertices:k,fillStyle:en,strokeStyle:ht,labels:o(E(De)),ariaLabel:o(u)}),Mr=D(Q(D(x,()=>-1/0),D(x,()=>1/0)),()=>[-1/0,1/0]),Nr=m({type:w("function"),color:Fe,strokeStyle:ht,equation:u,directionalAxis:H("x","y"),domain:Mr,labels:o(E(De)),ariaLabel:o(u)}),Lr=lt("type").withBranch("point",xt).withBranch("line",Ar).withBranch("vector",Wr).withBranch("ellipse",Er).withBranch("polygon",Ir).withBranch("function",Nr).withBranch("label",De).parser,Cr=B(w("interactive-graph"),m({step:L,gridStep:o(L),snapStep:o(L),backgroundImage:o(ut),markings:H("graph","grid","none"),labels:o(E(u)),showProtractor:k,showRuler:o(k),showTooltips:o(k),rulerLabel:o(u),rulerTicks:o(x),range:Q(L,L),graph:D(qt,()=>({type:"linear"})),correct:qt,lockedFigures:o(E(Lr)),fullGraphLabel:o(u),fullGraphAriaDescription:o(u)})),Fr=B(w("label-image"),m({choices:E(u),imageUrl:u,imageAlt:u,imageHeight:x,imageWidth:x,markers:E(m({answers:E(u),label:u,x,y:x})),hideChoicesFromInstructions:k,multipleAnswers:k,static:D(k,()=>!1)})),Dr=B(w("matcher"),m({labels:E(u),left:E(u),right:E(u),orderMatters:k,padding:k})),Rr=le(x).or(u).parser,Gr=fe(D(Rr,()=>NaN)).then(Zt).parser,qr=B(D(w("matrix"),()=>"matrix"),m({prefix:o(u),suffix:o(u),answers:E(E(Gr)),cursorPosition:o(E(x)),matrixBoardSize:E(x),static:o(k)})),_r=B(w("measurer"),m({image:D(ut,()=>({url:null,top:0,left:0})),showProtractor:k,showRuler:k,rulerLabel:u,rulerTicks:x,rulerPixels:x,rulerLength:x,box:Q(x,x),static:D(k,()=>!1)})),$r=B(w("molecule-renderer"),m({widgetId:u,rotationAngle:o(x),smiles:o(u)})),Vr=fe(w("")).then(me(()=>null)).parser,zr=B(w("number-line"),m({range:E(x),labelRange:E(V(le(x).or(Vr).parser)),labelStyle:u,labelTicks:k,isTickCtrl:o(V(k)),divisionRange:E(x),numDivisions:o(V(x)),snapDivisions:D(x,()=>2),tickStep:o(V(x)),correctRel:o(V(u)),correctX:V(x),initialX:o(V(x)),showTooltips:o(k),static:D(k,()=>!1)})),_t=H("integer","mixed","improper","proper","decimal","percent","pi"),$t=fe(le(w(null)).or(w(void 0)).or(k).or(w("required")).or(w("correct")).or(w("enforced")).or(w("optional")).or(w("accepted")).parser).then(me(Br)).parser;function Br(n){switch(n){case"enforced":case"required":case"optional":return n;default:return"required"}}const Ur=B(w("numeric-input"),m({answers:E(m({message:u,value:o(V(x)),status:u,answerForms:D(E(_t),()=>{}),strict:k,maxError:o(V(x)),simplify:$t})),labelText:o(u),size:u,coefficient:D(k,()=>!1),rightAlign:o(k),static:D(k,()=>!1),answerForms:o(E(m({name:_t,simplify:$t})))}));function vt(n,e){return Qe(n,e)}const jr=(n,e)=>n==="large"?e.success("auto"):e.success(n),Hr=B(w("orderer"),m({options:D(E(vt),()=>[]),correctOptions:E(vt),otherOptions:E(vt),height:fe(H("normal","auto","large")).then(jr).parser,layout:D(H("horizontal","vertical"),()=>"horizontal")})),Kr=B(w("passage-ref"),m({passageNumber:x,referenceNumber:x,summaryText:o(u)})),Xr=B(w("passage"),m({footnotes:D(u,()=>""),passageText:u,passageTitle:D(u,()=>""),showLineNumbers:k,static:D(k,()=>!1)})),Yr=B(w("phet-simulation"),m({url:u,description:u})),Jr=B(w("plotter"),m({labels:E(u),categories:E(u),type:H(...gr),maxY:x,scaleY:D(x,()=>1),labelInterval:o(V(x)),snapsPerLine:D(x,()=>2),starting:E(x),correct:E(x),picUrl:o(V(u)),picSize:o(V(x)),picBoxHeight:o(V(x)),plotDimensions:D(E(x),()=>[380,300])})),Qr=B(w("python-program"),m({programID:u,height:x})),Zr={major:2,minor:0};function tn(n){const{choices:e,numCorrect:t}=n;return t??e.filter(r=>r.correct).length}const es={2:n=>({...n,numCorrect:tn(n)}),1:n=>{const{noneOfTheAbove:e,...t}=n;if(e)throw new Error("radio widget v0 no longer supports auto noneOfTheAbove");return{...t,hasNoneOfTheAbove:!1}}},ts={choices:[{},{},{},{}],displayCount:null,randomize:!1,hasNoneOfTheAbove:!1,multipleSelect:!1,countChoices:!1,deselectEnabled:!1},ns=o(m({major:w(2),minor:x})),rs=je(ns,w("radio"),m({numCorrect:o(x),choices:E(m({content:D(u,()=>""),clue:o(u),correct:o(k),isNoneOfTheAbove:o(k),widgets:o((n,e)=>He(n,e))})),hasNoneOfTheAbove:o(k),countChoices:o(k),randomize:o(k),multipleSelect:o(k),deselectEnabled:o(k),onePerLine:o(k),displayCount:o(Ne),noneOfTheAbove:o(w(!1))})),ss=o(m({major:w(1),minor:x})),is=je(ss,w("radio"),m({choices:E(m({content:D(u,()=>""),clue:o(u),correct:o(k),isNoneOfTheAbove:o(k),widgets:D((n,e)=>He(n,e),()=>{})})),hasNoneOfTheAbove:o(k),countChoices:o(k),randomize:o(k),multipleSelect:o(k),deselectEnabled:o(k),onePerLine:o(k),displayCount:o(Ne),noneOfTheAbove:o(w(!1))}));function as(n){const{options:e}=n;return{...n,version:{major:2,minor:0},options:{...e,numCorrect:tn(e)}}}const os=o(m({major:w(0),minor:x})),cs=je(os,w("radio"),m({choices:E(m({content:D(u,()=>""),clue:o(u),correct:o(k),isNoneOfTheAbove:o(k),widgets:o((n,e)=>He(n,e))})),hasNoneOfTheAbove:o(k),countChoices:o(k),randomize:o(k),multipleSelect:o(k),deselectEnabled:o(k),onePerLine:o(k),displayCount:o(Ne),noneOfTheAbove:o(w(!1))}));function ls(n){const{options:e}=n,{noneOfTheAbove:t,...r}=e;return{...n,version:{major:1,minor:0},options:{...r,hasNoneOfTheAbove:!1}}}const us=Xt(2,rs).withMigrationFrom(1,is,as).withMigrationFrom(0,cs,ls).parser,hs=B(w("sorter"),m({correct:E(u),padding:k,layout:H("horizontal","vertical")})),ps=B(w("table"),m({headers:E(u),rows:x,columns:x,answers:E(E(u))})),fs=B(w("video"),m({location:u,static:o(k)})),He=(n,e)=>{if(!Ue(n))return e.failure("PerseusWidgetsMap",n);const t={};for(const r of Object.keys(n)){const s=ds([r,n[r]],t,e.forSubtree(r));if(pe(s))return s}return e.success(t)},ds=([n,e],t,r)=>{const s=ms(n.split(" "),r.forSubtree("(widget ID)"));if(pe(s))return s;const[i,a]=s.value;function l(g,O){const h=O(e,r);return pe(h)?h:(t[g]=h.value,r.success(void 0))}switch(i){case"categorizer":return l(`categorizer ${a}`,xn);case"cs-program":return l(`cs-program ${a}`,wn);case"definition":return l(`definition ${a}`,kn);case"dropdown":return l(`dropdown ${a}`,On);case"explanation":return l(`explanation ${a}`,Pn);case"expression":return l(`expression ${a}`,jn);case"grapher":return l(`grapher ${a}`,Jn);case"group":return l(`group ${a}`,Qn);case"graded-group":return l(`graded-group ${a}`,Kn);case"graded-group-set":return l(`graded-group-set ${a}`,Xn);case"iframe":return l(`iframe ${a}`,Zn);case"image":return l(`image ${a}`,nr);case"input-number":return l(`input-number ${a}`,sr);case"interaction":return l(`interaction ${a}`,fr);case"interactive-graph":return l(`interactive-graph ${a}`,Cr);case"label-image":return l(`label-image ${a}`,Fr);case"matcher":return l(`matcher ${a}`,Dr);case"matrix":return l(`matrix ${a}`,qr);case"measurer":return l(`measurer ${a}`,_r);case"molecule-renderer":return l(`molecule-renderer ${a}`,$r);case"number-line":return l(`number-line ${a}`,zr);case"numeric-input":return l(`numeric-input ${a}`,Ur);case"orderer":return l(`orderer ${a}`,Hr);case"passage":return l(`passage ${a}`,Xr);case"passage-ref":return l(`passage-ref ${a}`,Kr);case"passage-ref-target":return l(`passage-ref-target ${a}`,Ne);case"phet-simulation":return l(`phet-simulation ${a}`,Yr);case"plotter":return l(`plotter ${a}`,Jr);case"python-program":return l(`python-program ${a}`,Qr);case"radio":return l(`radio ${a}`,us);case"sorter":return l(`sorter ${a}`,hs);case"table":return l(`table ${a}`,ps);case"video":return l(`video ${a}`,fs);case"sequence":return l(`sequence ${a}`,rt);case"lights-puzzle":return l(`lights-puzzle ${a}`,rt);case"simulator":return l(`simulator ${a}`,rt);case"transformer":return l(`transformer ${a}`,rt);default:return l(`${i} ${a}`,B(w(i),Ne))}},rt=B((n,e)=>e.success("deprecated-standin"),m({})),gs=(n,e)=>typeof n!="string"||!/^(0|[1-9][0-9]*)$/.test(n)?e.failure("a string representing a non-negative integer",n):e.success(+n),ms=Q(u,gs),Qe=D(m({content:D(u,()=>""),widgets:D((n,e)=>He(n,e),()=>({})),images:vn,metadata:Ne}),()=>({content:"",widgets:{},images:{}}));le(Qe).or(E(Qe)).parser;fe(D(m({}),()=>({}))).then(me(ys)).parser;function ys(n){return{zTable:!!n.zTable,calculator:!!n.calculator,chi2Table:!!n.chi2Table,financialCalculatorMonthlyPayment:!!n.financialCalculatorMonthlyPayment,financialCalculatorTotalAmount:!!n.financialCalculatorTotalAmount,financialCalculatorTimeToPayOff:!!n.financialCalculatorTimeToPayOff,periodicTable:!!n.periodicTable,periodicTableWithKey:!!n.periodicTableWithKey,tTable:!!n.tTable}}const bs="@khanacademy/perseus-core",vs="__lib_version__";Ht(bs,vs);function xs(n){return{items:n.items,categories:n.categories,randomizeItems:n.randomizeItems,static:n.static}}const ws={items:[],categories:[],values:[],randomizeItems:!1},ks={name:"categorizer",defaultWidgetOptions:ws,getPublicWidgetOptions:xs};function Os(n){return n}const Ps=400,Ts={programID:"",programType:null,settings:[{name:"",value:""}],showEditor:!1,showButtons:!1,height:Ps},Ss={name:"cs-program",defaultWidgetOptions:Ts,supportedAlignments:["block","full-width"],getPublicWidgetOptions:Os},As={togglePrompt:"",definition:""},Ws={name:"definition",defaultWidgetOptions:As,defaultAlignment:"inline"};function Es(n){return{choices:n.choices.map(e=>({content:e.content})),placeholder:n.placeholder,static:n.static,visibleLabel:n.visibleLabel,ariaLabel:n.ariaLabel}}const Is={placeholder:"",choices:[{content:"",correct:!1}]},Ms={name:"definition",defaultWidgetOptions:Is,defaultAlignment:"inline-block",getPublicWidgetOptions:Es},Ns={showPrompt:"Explain",hidePrompt:"Hide explanation",explanation:`explanation goes here

more explanation`,widgets:{}},Ls={name:"explanation",defaultWidgetOptions:Ns,defaultAlignment:"inline"},Cs={major:2,minor:0},Fs={2:n=>({times:n.times,buttonSets:n.buttonSets,functions:n.functions,buttonsVisible:n.buttonsVisible,visibleLabel:n.visibleLabel,ariaLabel:n.ariaLabel,answerForms:n.answerForms,extraKeys:n.extraKeys||Kt(n)}),1:n=>({times:n.times,buttonSets:n.buttonSets,functions:n.functions,buttonsVisible:n.buttonsVisible,visibleLabel:n.visibleLabel,ariaLabel:n.ariaLabel,extraKeys:n.extraKeys,answerForms:[{considered:"correct",form:n.form,simplify:n.simplify,value:n.value}]})},Ds={answerForms:[],times:!1,buttonSets:["basic"],functions:["f","g","h"]};function Rs(n){return{buttonSets:n.buttonSets,functions:n.functions,times:n.times,visibleLabel:n.visibleLabel,ariaLabel:n.ariaLabel,buttonsVisible:n.buttonsVisible,extraKeys:n.extraKeys}}const Gs={name:"expression",version:Cs,widgetOptionsUpgrades:Fs,defaultWidgetOptions:Ds,defaultAlignment:"inline-block",getPublicWidgetOptions:Rs},qs={title:"",content:"",widgets:{},images:{},hint:null},_s={name:"graded-group",defaultWidgetOptions:qs},$s={gradedGroups:[]},Vs={name:"graded-group-set",defaultWidgetOptions:$s};function zs(n){const{correct:e,...t}=n;return t}const Bs={graph:{labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],backgroundImage:{url:null},markings:"graph",rulerLabel:"",rulerTicks:10,valid:!0,showTooltips:!1},correct:{type:"linear",coords:null},availableTypes:["linear"]},Us={name:"grapher",defaultWidgetOptions:Bs,getPublicWidgetOptions:zs},js={content:"",widgets:{},images:{}},Hs={name:"group",defaultWidgetOptions:js};function Ks(n){return n}const Xs={url:"",settings:[{name:"",value:""}],width:"400",height:"400",allowFullScreen:!1,allowTopNavigation:!1},Ys={name:"iframe",defaultWidgetOptions:Xs,getPublicWidgetOptions:Ks},Js={title:"",range:[[0,10],[0,10]],box:[400,400],backgroundImage:{url:null,width:0,height:0},labels:[],alt:"",caption:""},Qs={name:"image",defaultWidgetOptions:Js,supportedAlignments:["block","full-width"],defaultAlignment:"block"},Zs={value:0,simplify:"required",size:"normal",inexact:!1,maxError:.1,answerType:"number",rightAlign:!1},ei={name:"input-number",defaultWidgetOptions:Zs,defaultAlignment:"inline-block"},ti={graph:{box:[400,400],labels:["x","y"],range:[[-10,10],[-10,10]],tickStep:[1,1],gridStep:[1,1],markings:"graph"},elements:[]},ni={name:"interaction",defaultWidgetOptions:ti};function ri(n){const{correct:e,...t}=n;return t}const si={labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],backgroundImage:{url:null},markings:"graph",showTooltips:!1,showProtractor:!1,graph:{type:"linear"},correct:{type:"linear",coords:null}},ii={name:"interactive-graph",defaultWidgetOptions:si,getPublicWidgetOptions:ri};function ai(n){return{...n,markers:n.markers.map(oi)}}function oi(n){const{answers:e,...t}=n;return t}const ci={choices:[],imageAlt:"",imageUrl:"",imageWidth:0,imageHeight:0,markers:[],multipleAnswers:!1,hideChoicesFromInstructions:!1},li={name:"label-image",defaultWidgetOptions:ci,getPublicWidgetOptions:ai},ha=n=>{const e=Et(n.problemNum);let t;n.orderMatters?t=Ze(n.left,e,!0):t=n.left;const r=Ze(n.right,e,!0);return{left:t,right:r}};function ui(n){let e;n.orderMatters?e=Ze(n.left,Math.random,!0):e=n.left;const t=Ze(n.right,Math.random,!0);return{left:e,right:t}}function hi(n){const{left:e,right:t}=ui(n);return{...n,left:e,right:t}}const pi={left:["$x$","$y$","$z$"],right:["$1$","$2$","$3$"],labels:["test","label"],orderMatters:!1,padding:!0},fi={name:"matcher",defaultWidgetOptions:pi,getPublicWidgetOptions:hi};function di(n){const{answers:e,...t}=n;return t}const gi={matrixBoardSize:[3,3],answers:[[]],prefix:"",suffix:"",cursorPosition:[0,0]},mi={name:"matrix",defaultWidgetOptions:gi,getPublicWidgetOptions:di},yi={major:1,minor:0},bi={1:n=>{const{imageUrl:e,imageTop:t,imageLeft:r,...s}=n;return{...s,image:{url:e,top:t,left:r}}}},vi={box:[480,480],image:{},showProtractor:!0,showRuler:!1,rulerLabel:"",rulerTicks:10,rulerPixels:40,rulerLength:10},xi={name:"measurer",version:yi,widgetOptionsUpgrades:bi,defaultWidgetOptions:vi};function wi(n){const{correctX:e,correctRel:t,...r}=n;return r}const ki={range:[0,10],labelRange:[null,null],labelStyle:"decimal",labelTicks:!0,divisionRange:[1,12],numDivisions:5,snapDivisions:2,tickStep:null,correctRel:"eq",correctX:null,initialX:null,showTooltips:!1},Oi={name:"number-line",defaultWidgetOptions:ki,getPublicWidgetOptions:wi};function Pi(n){const{answerForms:e,simplify:t,status:r}=n;return{answerForms:e,simplify:t,status:r}}function Ti(n){const{answers:e,...t}=n;return{...t,answers:e.map(Pi)}}const Si={answers:[{value:null,status:"correct",message:"",simplify:"required",answerForms:[],strict:!1,maxError:null}],size:"normal",coefficient:!1,labelText:"",rightAlign:!1},Ai={name:"numeric-input",defaultWidgetOptions:Si,defaultAlignment:"inline-block",getPublicWidgetOptions:Ti};function Wi(n){return{options:n.options,height:n.height,layout:n.layout}}const Ei={correctOptions:[{content:"$x$"}],otherOptions:[{content:"$y$"}],height:"normal",layout:"horizontal"},Ii={name:"orderer",defaultWidgetOptions:Ei,getPublicWidgetOptions:Wi},Mi={passageTitle:"",passageText:"",footnotes:"",showLineNumbers:!0},Ni={name:"passage",defaultWidgetOptions:Mi},Li={major:0,minor:1},Ci={passageNumber:1,referenceNumber:1,summaryText:""},Fi={name:"passageRef",version:Li,defaultWidgetOptions:Ci,defaultAlignment:"inline"},Di={content:""},Ri={name:"passageRefTarget",defaultWidgetOptions:Di,defaultAlignment:"inline"},Gi={url:"",description:""},qi={name:"phet-simulation",defaultWidgetOptions:Gi};function _i(n){const{correct:e,...t}=n;return t}const $i={scaleY:1,maxY:10,snapsPerLine:2,correct:[1],starting:[1],type:"bar",labels:["",""],categories:[""],picSize:30,picBoxHeight:36,plotDimensions:[275,200],labelInterval:1,picUrl:null},Vi={name:"plotter",defaultWidgetOptions:$i,getPublicWidgetOptions:_i},zi={programID:"",height:400},Bi={name:"python-program",defaultWidgetOptions:zi};function Ui(n){const{content:e,isNoneOfTheAbove:t,widgets:r}=n;return{content:e,isNoneOfTheAbove:t,widgets:r}}function ji(n,e,t){return n&&e&&t}function Hi(n){const{numCorrect:e,choices:t,multipleSelect:r,countChoices:s}=n;return{...n,numCorrect:ji(r,s,e)?e:void 0,choices:t.map(Ui)}}const Ki={name:"radio",version:Zr,widgetOptionsUpgrades:es,defaultWidgetOptions:ts,getPublicWidgetOptions:Hi};function Xi(n){const e=Ze(n.correct,Math.random,!0);return{...n,correct:e,isCorrectShuffled:!0}}const Yi={correct:["$x$","$y$","$z$"],layout:"horizontal",padding:!0},Ji={name:"sorter",defaultWidgetOptions:Yi,getPublicWidgetOptions:Xi};function Qi(n){const{answers:e,...t}=n;return t}const nn=4,rn=1,Zi=new Array(nn).fill(0).map(()=>new Array(rn).fill("")),ea={headers:[""],rows:nn,columns:rn,answers:Zi},ta={name:"table",defaultWidgetOptions:ea,getPublicWidgetOptions:Qi},na={location:""},ra={name:"video",defaultWidgetOptions:na,supportedAlignments:["block","float-left","float-right","full-width"],defaultAlignment:"block"},Ae={};function U(n,e){Ae[n]=e}function pa(n){return!!Ae[n]}function fa(n){const e=Ae[n];return(e==null?void 0:e.version)||{major:0,minor:0}}const da=n=>{var e;return((e=Ae[n])==null?void 0:e.getPublicWidgetOptions)??(t=>t)};function ga(n){const e=Ae[n];return(e==null?void 0:e.widgetOptionsUpgrades)||{}}function ma(n){const e=Ae[n];return(e==null?void 0:e.defaultWidgetOptions)||{}}const ya=n=>{var t;const e=Ae[n];return(t=e==null?void 0:e.supportedAlignments)!=null&&t[0]?e==null?void 0:e.supportedAlignments:["default"]},ba=n=>{const e=Ae[n];return e!=null&&e.defaultAlignment?e.defaultAlignment:"block"};U("categorizer",ks);U("cs-program",Ss);U("definition",Ws);U("dropdown",Ms);U("explanation",Ls);U("expression",Gs);U("graded-group",_s);U("graded-group-set",Vs);U("grapher",Us);U("group",Hs);U("iframe",Ys);U("image",Qs);U("input-number",ei);U("interaction",ni);U("interactive-graph",ii);U("label-image",li);U("matcher",fi);U("matrix",mi);U("measurer",xi);U("number-line",Oi);U("numeric-input",Ai);U("orderer",Ii);U("passage",Ni);U("passage-ref",Fi);U("passage-ref-target",Ri);U("phet-simulation",qi);U("plotter",Vi);U("python-program",Bi);U("radio",Ki);U("sorter",Ji);U("table",ta);U("video",ra);const Et=function(n){let e=n;return function(){let t=e;return t=t+2127912214+(t<<12)&4294967295,t=(t^3345072700^t>>>19)&4294967295,t=t+374761393+(t<<5)&4294967295,t=(t+3550635116^t<<9)&4294967295,t=t+4251993797+(t<<3)&4294967295,t=(t^3042594569^t>>>16)&4294967295,(e=t&268435455)/268435456}};function Ze(n,e,t=!1){const r=c.clone(n);if(!r.length||c.all(r,function(i){return c.isEqual(i,r[0])}))return r;let s;typeof e=="function"?s=e:s=Et(e);do for(let i=r.length;i>0;i--){const a=Math.floor(s()*i),l=r[a];r[a]=r[i-1],r[i-1]=l}while(t&&c.isEqual(n,r));return r}const va=Et(new Date().getTime()&4294967295);export{Ze as $,ba as A,ni as B,ii as C,Ss as D,_s as E,Vs as F,Us as G,ia as H,oa as I,Hs as J,Ys as K,mi as L,xi as M,Ii as N,Ni as O,ca as P,Fi as Q,Ri as R,ta as S,ra as T,$e as U,pa as V,fa as W,ga as X,ma as Y,Nt as Z,aa as _,Ms as a,va as a0,ha as a1,ei as b,ks as c,Ws as d,Ls as e,Ai as f,Vi as g,gr as h,Qs as i,Bi as j,tn as k,li as l,fi as m,Oi as n,la as o,qi as p,da as q,Ki as r,Ji as s,Tt as t,ji as u,Gs as v,Kt as w,ua as x,Ht as y,ya as z};
