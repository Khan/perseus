var Fs=(i,t,e)=>{if(!t.has(i))throw TypeError("Cannot "+e)};var Ae=(i,t,e)=>(Fs(i,t,"read from private field"),e?e.call(i):t.get(i)),Ti=(i,t,e)=>{if(t.has(i))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(i):t.set(i,e)},_i=(i,t,e,o)=>(Fs(i,t,"write to private field"),o?o.call(i,e):t.set(i,e),e);import{j as zt,a as ki}from"./jsx-runtime-BGVbfQ2Z.js";import{C as jn}from"./index-TymzEsVR.js";import{c as Jn}from"./index-dnMhQZ-1.js";import{$ as P}from"./jquery-5v7aFUvu.js";import{r as ri}from"./index-qhcEwEpg.js";import{_ as b}from"./index-default-4_ZsnO94.js";import{g as ye}from"./dependencies-fnqF3NiV.js";import{P as $t,E as Ft,L as De}from"./perseus-error-OpXxk17X.js";import{b as Qn,e as on,c as to,f as eo,d as io,K as Ut,r as so,s as no,U as kt}from"./util-2H85FoUC.js";import{F as Bs}from"./fixed-to-responsive-ybwlrogx.js";import{R as rn}from"./index-E09jvG0x.js";import{e as oo}from"./index-J2t_5nK1.js";import{R as ro}from"./index-oMd7J_hd.js";import{I as ao}from"./inline-icon-MJBS_-2U.js";import{c as lo}from"./icon-paths-AuJwhOz7.js";import{I as je}from"./image-loader-BrzYBUzY.js";function an(i){return i.reduce((t,e)=>t+e,0)}function co(i){return i.reduce((t,e)=>t*e,1)}function Ne(...i){const t=Math.min(...i.map(o=>o.length)),e=[];for(let o=0;o<t;o++)e.push(i.map(a=>a[o]));return e}function jr(i,t){return[t(i[0],0),t(i[1],1)]}function ho(i,t){return!Array.isArray(i)||t!==void 0&&i.length!==t?!1:i.every(Qn)}function Di(i){return Pt(i,1/qi(i))}function qi(i){return Math.sqrt(Ni(i,i))}function Ni(i,t){const o=Ne(i,t).map(co);return an(o)}function ct(...i){return Ne(...i).map(an)}function ht(i,t){return Ne(i,t).map(e=>e[0]-e[1])}function uo(i){return i.map(t=>-t)}function Pt(i,t){return i.map(e=>e*t)}function fo(i,t,e){return i.length===t.length&&Ne(i,t).every(o=>on(o[0],o[1],e))}function po(i){const t=qi(i);let e=Math.atan2(i[1],i[0]);return e<0&&(e+=2*Math.PI),[t,e]}function Xt(i){const t=po(i);return[t[0],t[1]*180/Math.PI]}function go(i,t=0){return[i*Math.cos(t),i*Math.sin(t)]}function pe(i,t=0){return go(i,t*Math.PI/180)}function Je(i,t){const e=Xt(i),o=e[1]+t;return pe(e[0],o)}function mo(i,t){const e=Ni(i,t)/Ni(t,t);return Pt(t,e)}function vo(i,t){return i.map((e,o)=>to(e,t[o]||t))}function bo(i,t){return i.map((e,o)=>eo(e,t[o]||t))}function yo(i,t){return i.map((e,o)=>io(e,t[o]||t))}function ln(i,t){return qi(ht(i,t))}function Jr(i,t){const e=ht(t[1],t[0]),o=ht(i,t[0]),a=mo(o,e),h=ht(Pt(a,2),o);return ct(t[0],h)}const Jt=ho,Vs=ct,de=ct,Zi=fo,Wi=vo,$i=bo,Ki=yo;function Os(i){return[(i[0][0]+i[1][0])/2,(i[0][1]+i[1][1])/2]}function xo(){const i=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(const e in t)if(i.style[e]!==void 0)return{end:t[e]};return!1}P.fn.emulateTransitionEnd=function(i){let t=!1;const e=this;return P(this).one("bsTransitionEnd",function(){t=!0}),setTimeout(function(){t||P(e).trigger(P.support.transition.end)},i),this};P(function(){P.support.transition=xo(),P.support.transition&&(P.event.special.bsTransitionEnd={bindType:P.support.transition.end,delegateType:P.support.transition.end,handle:function(i){if(P(i.target).is(this))return i.handleObj.handler.apply(this,arguments)}})});function cn(i,t){const e=window.scrollX,o=window.scrollY,a=document.querySelector("meta[name=viewport]");a?a.setAttribute("content",i):P("head").append(`<meta name="viewport" content="${i}">`),document.body.style.opacity=.9999,setTimeout(()=>{document.body.style.opacity=1,window.scrollTo(e,o),t&&setTimeout(t,0)},0)}function qt(){}qt.prototype._initialize=function(i){this._$document||(this._activeZoom=this._initialScrollPosition=this._initialTouchPosition=this._touchMoveListener=null,this._$document=P(document),this._$window=P(window),this._$body=P(document.body),this._boundClick=P.proxy(this._clickHandler,this),this._enableMobilePinch=i)};qt.prototype.handleZoomClick=function(i,t){this._initialize(t);const e=i.target;if(!(!e||e.tagName!=="IMG")&&!this._$body.hasClass("zoom-overlay-open")){if(i.metaKey||i.ctrlKey)return window.open(i.target.src,"_blank");!t&&e.width>=window.innerWidth-Et.getOffset()||(this._activeZoomClose(!0),t?cn("width=device-width, initial-scale=1, minimum-scale=1",()=>this._zoom(e)):this._zoom(e),t||(this._$window.on("scroll.zoom",P.proxy(this._scrollHandler,this)),this._$document.on("keyup.zoom",P.proxy(this._keyHandler,this)),this._$document.on("touchstart.zoom",P.proxy(this._touchStart,this))),document.addEventListener("click",this._boundClick,!0),i.stopPropagation())}};qt.prototype._zoom=function(i){this._activeZoom=new Et(i,this._enableMobilePinch),this._activeZoom.zoomImage()};qt.prototype._activeZoomClose=function(i){this._activeZoom&&(i?(this._activeZoom.dispose(),this._disposeActiveZoom()):cn(`width=device-width, initial-scale=1, minimum-scale=1,
            maximum-scale=1`,()=>{this._activeZoom&&(this._activeZoom.close(),this._disposeActiveZoom())}))};qt.prototype._disposeActiveZoom=function(){this._$window.off(".zoom"),this._$document.off(".zoom"),document.removeEventListener("click",this._boundClick,!0),this._activeZoom=null};qt.prototype._scrollHandler=function(i){this._initialScrollPosition===null&&(this._initialScrollPosition=window.scrollY);const t=this._initialScrollPosition-window.scrollY;Math.abs(t)>=40&&this._activeZoomClose()};qt.prototype._keyHandler=function(i){i.keyCode===27&&this._activeZoomClose()};qt.prototype._clickHandler=function(i){i.stopPropagation(),i.preventDefault(),this._activeZoomClose()};qt.prototype._touchStart=function(i){this._initialTouchPosition=i.originalEvent.touches[0].pageY,P(i.target).on("touchmove.zoom",P.proxy(this._touchMove,this))};qt.prototype._touchMove=function(i){Math.abs(i.originalEvent.touches[0].pageY-this._initialTouchPosition)>10&&(this._activeZoomClose(),P(i.target).off("touchmove.zoom"))};function Et(i,t){this._fullHeight=this._fullWidth=this._overlay=null,this._targetImage=i,this._enableMobilePinch=t,this._$body=P(document.body)}Et._OFFSET=80;Et._MAX_WIDTH=2560;Et._MAX_HEIGHT=4096;Et.getOffset=function(i){return i?0:Et._OFFSET};Et.prototype.getOffset=function(){return Et.getOffset(this._enableMobilePinch)};Et.prototype.zoomImage=function(){const i=document.createElement("img"),t=P(i);i.onload=(function(){this._fullHeight=Number(i.height),this._fullWidth=Number(i.width);const e=this._imageOffset=P(this._targetImage).offset(),o=this._left=e.left-P(window).scrollLeft(),a=this._top=e.top-P(window).scrollTop();t.css({left:o,top:a,width:this._targetImage.width,height:this._targetImage.height}),this._zoomOriginal()}).bind(this),i.src=this._targetImage.src,this.$zoomedImage=t};Et.prototype._zoomOriginal=function(){var i,t,e;this.$zoomedImage.addClass("zoom-img").attr("data-action","zoom-out"),P(this._targetImage).css("visibility","hidden"),this._backdrop=document.createElement("div"),this._backdrop.className="zoom-backdrop",(i=document.body)==null||i.appendChild(this._backdrop),this._overlay=document.createElement("div"),this._overlay.className="zoom-overlay",(t=document.body)==null||t.appendChild(this._overlay),(e=this._overlay)==null||e.appendChild(this.$zoomedImage[0]),this._calculateZoom(),this._triggerAnimation()};Et.prototype._calculateZoom=function(){const i=this._fullWidth,t=this._fullHeight,e=window.innerHeight-this.getOffset(),o=window.innerWidth-this.getOffset(),a=i/this._targetImage.width,h=i/t,f=o/e;i<o&&t<e?this._imgScaleFactor=a:h<f?this._imgScaleFactor=e/t*a:this._imgScaleFactor=o/(i??0)*a};Et.prototype._triggerAnimation=function(){const i=P(window).scrollTop()+window.innerHeight/2,t=P(window).scrollLeft()+window.innerWidth/2,e=this._imgScaleFactor,o=this._imageOffset.top+this._targetImage.height/2,a=this._imageOffset.left+this._targetImage.width/2;this._translateY=(i-o)/e,this._translateX=(t-a)/e,this._zoomedInTransformString=`
        scale(${e})
        translate3d(${this._translateX}px, ${this._translateY}px, 0)
    `,this.$zoomedImage.css({transform:this._zoomedInTransformString}).addClass("zoom-transition").one(P.support.transition.end,P.proxy(this._onZoomInFinish,this)).emulateTransitionEnd(300),this._$body.addClass("zoom-overlay-open")};Et.prototype._onZoomInFinish=function(){const i=this._targetImage.height*this._imgScaleFactor,t=this._targetImage.width*this._imgScaleFactor;let e=0,o=0,a=0,h=0,f=0,v=0;t<window.innerWidth?(e="50%",a=-t/2):f=(t-window.innerWidth)/2,i<window.innerHeight?(o="50%",h=-i/2):v=(i-window.innerHeight)/2,this.$zoomedImage.css({height:i,left:e,marginLeft:a,marginTop:h,top:o,transform:"",width:t}).removeClass("zoom-transition"),P(this._overlay).scrollLeft(f).scrollTop(v)};Et.prototype.close=function(){this._$body.removeClass("zoom-overlay-open").addClass("zoom-overlay-transitioning"),this.$zoomedImage.css({height:this._targetImage.height,left:this._left,marginLeft:0,marginTop:0,top:this._top,transform:this._zoomedInTransformString,width:this._targetImage.width}).removeClass("zoom-transition"),P(this._overlay).scrollLeft(0).scrollTop(0),setTimeout(()=>{this.$zoomedImage.css({transform:"scale(1)"}).addClass("zoom-transition").one(P.support.transition.end,P.proxy(this.dispose,this)).emulateTransitionEnd(300)},10)};Et.prototype.dispose=function(){this.$zoomedImage&&this.$zoomedImage[0].parentNode&&(this.$zoomedImage.remove(),this.$zoomedImage=null,this._overlay.parentNode.removeChild(this._overlay),this._backdrop.parentNode.removeChild(this._backdrop),this._$body.removeClass("zoom-overlay-transitioning")),P(this._targetImage).css("visibility","visible"),this._targetImage.focus()};const wo=new qt;function Gs(i,t){return i+":"+t}function Mo(i){return i.split(":")[0]}const hn={_fireEvent:function(i,...t){for(const e of i)e.call(this,...t)},_applyConstraints:function(i,t,e){let o=!1;return b.reduce(this.state.constraints,(a,h)=>{if(a===!1)return!1;if(o)return a;const f=h.call(this,a,t,{onSkipRemaining:()=>{o=!0},...e});if(f===!1)return!1;if(Jt(f,2))return f;if(f===!0||f==null)return a;throw new $t("Constraint returned invalid result: "+f,Ft.Internal)},i,this)},draw:function(){const i=this.cloneState();hn._fireEvent.call(this,this.state.draw,i,this.prevState),this.prevState=i},listen:function(i,t,e){this._listenerMap=this._listenerMap||{};const o=Gs(i,t),a=this._listenerMap[o]=this._listenerMap[o]||this.state[i].length;this.state[i][a]=e},unlisten:function(i,t){this._listenerMap=this._listenerMap||{};const e=Gs(i,t),o=this._listenerMap[e];if(o!==void 0){this.state[i].splice(o,1),delete this._listenerMap[e];const a=b.keys(this._listenerMap);b.each(a,function(h){Mo(h)===i&&this._listenerMap[h]>o&&this._listenerMap[h]--},this)}}};let Ci=null;function So(){const i=document.createElement("div"),t=["transform","msTransform","MozTransform","WebkitTransform","OTransform"];let e=null;return b.each(t,function(o){typeof i.style[o]<"u"&&(e=o)}),e}let Ai=null;function To(){const i=document.createElement("div"),t=Tt.getPrefixedTransform();return i.style[t]="translateZ(0px)",!!i.style[t]}const _o=["add","modify","draw","remove","constraints","onMoveStart","onMove","onMoveEnd","onClick"],Tt={assert:function(i,t){if(!i)throw new $t("Assertion Error"+(t?": "+t:""),Ft.Internal)},createGettersFor:function(i,t){b.each(b.keys(t),function(e){i.prototype[e]===void 0&&(i.prototype[e]=function(){return this.state[e]})})},addMovableHelperMethodsTo:function(i){b.each(hn,function(t,e){i.prototype[e]===void 0&&(i.prototype[e]=t)})},arrayify:function(i){return i==null?[]:b.isArray(i)?b.filter(b.flatten(i),b.identity):[i]},normalizeOptions:function(i){const t={...i};return _o.forEach(function(e){i[e]!==void 0&&(t[e]=Tt.arrayify(i[e]))}),t},getPrefixedTransform:function(){return Ci=Ci||So(),Ci},getCanUse3dTransform:function(){return Ai==null&&(Ai=To()),Ai}};/*!
 * Raphael 1.5.2 - JavaScript Vector Library
 *
 * Copyright (c) 2010 Dmitry Baranovskiy (http://raphaeljs.com)
 * Licensed under the MIT (http://raphaeljs.com/license.html) license.
 */const jt=function(){var i;"".trim?i=function(n,s,r){n.setAttribute(s,String(r).trim())}:i=function(n,s,r){n.setAttribute(s,String(r))};function t(){if(t.is(arguments[0],pt)){for(var n=arguments[0],s=mi[E](t,n.splice(0,3+t.is(n[0],rt))),r=s.set(),l=0,c=n[I];l<c;l++){var d=n[l]||{};o[f](d.type)&&r[K](s[d.type]().attr(d))}return r}return mi[E](t,arguments)}t.version="1.5.2";var e=/[, ]+/,o={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},a=/\{(\d+)\}/g,h="prototype",f="hasOwnProperty",v=document,x=window,y={was:Object[h][f].call(x,"Raphael"),is:x.Raphael},M=function(){this.customAttributes={}},w,S="appendChild",E="apply",C="concat",L="createTouch"in v,k="",V=" ",B=String,O="split",j="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend orientationchange touchcancel gesturestart gesturechange gestureend"[O](V),tt={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},J="join",I="length",ot=B[h].toLowerCase,X=Math,z=X.max,st=X.min,nt=X.abs,$=X.pow,lt=X.PI,rt="number",W="string",pt="array",wt="toString",Lt="fill",re=Object[h][wt],K="push",Me=/^url\(['"]?([^\)]+?)['"]?\)$/i,Be=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,ui={NaN:1,Infinity:1,"-Infinity":1},ae=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,G=X.round,Y=parseFloat,et=parseInt,dt=" progid:DXImageTransform.Microsoft",xt=B[h].toUpperCase,Mt={blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/",opacity:1,path:"M0,0",r:0,rotation:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",translation:"0 0",width:0,x:0,y:0},Ct={along:"along",blur:rt,"clip-rect":"csv",cx:rt,cy:rt,fill:"colour","fill-opacity":rt,"font-size":rt,height:rt,opacity:rt,path:"path",r:rt,rotation:"csv",rx:rt,ry:rt,scale:"csv",stroke:"colour","stroke-opacity":rt,"stroke-width":rt,translation:"csv",width:rt,x:rt,y:rt},vt="replace",Se=/^(from|to|\d+%?)$/,ne=/\s*,\s*/,le={hs:1,rg:1},Ve=/,?([achlmqrstvxz]),?/gi,En=/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/ig,Ln=/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/ig,ss=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,In=function(n,s){return n.key-s.key};if(t.type=x.SVGAngle||v.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML",t.type=="VML"){var fi=v.createElement("div"),Oe;if(fi.innerHTML='<v:shape adj="1"/>',Oe=fi.firstChild,Oe.style.behavior="url(#default#VML)",!(Oe&&typeof Oe.adj=="object"))return t.type=null;fi=null}t.svg=!(t.vml=t.type=="VML"),M[h]=t[h],w=M[h],t._id=0,t._oid=0,t.fn={},t.is=function(n,s){return s=ot.call(s),s=="finite"?!ui[f](+n):s=="null"&&n===null||s==typeof n||s=="object"&&n===Object(n)||s=="array"&&Array.isArray&&Array.isArray(n)||re.call(n).slice(8,-1).toLowerCase()==s},t.angle=function(n,s,r,l,c,d){if(c==null){var p=n-r,u=s-l;return!p&&!u?0:((p<0)*180+X.atan(-u/-p)*180/lt+360)%360}else return t.angle(n,s,c,d)-t.angle(r,l,c,d)},t.rad=function(n){return n%360*lt/180},t.deg=function(n){return n*180/lt%360},t.snapTo=function(n,s,r){if(r=t.is(r,"finite")?r:10,t.is(n,pt)){for(var l=n.length;l--;)if(nt(n[l]-s)<=r)return n[l]}else{n=+n;var c=s%n;if(c<r)return s-c;if(c>n-r)return s-c+n}return s};function Ge(){for(var n=[],s=0;s<32;s++)n[s]=(~~(X.random()*16))[wt](16);return n[12]=4,n[16]=(n[16]&3|8)[wt](16),"r-"+n[J]("")}t.setWindow=function(n){x=n,v=x.document};var ze=function(n){if(t.vml){var s=/^\s+|\s+$/g,r;try{var l=new ActiveXObject("htmlfile");l.write("<body>"),l.close(),r=l.body}catch{r=createPopup().document.body}var c=r.createTextRange();ze=Ht(function(p){try{r.style.color=B(p)[vt](s,k);var u=c.queryCommandValue("ForeColor");return u=(u&255)<<16|u&65280|(u&16711680)>>>16,"#"+("000000"+u[wt](16)).slice(-6)}catch{return"none"}})}else{var d=v.createElement("i");d.title="Raphaël Colour Picker",d.style.display="none",v.body[S](d),ze=Ht(function(p){return d.style.color=p,v.defaultView.getComputedStyle(d,k).getPropertyValue("color")})}return ze(n)},ns=function(){return"hsb("+[this.h,this.s,this.b]+")"},Rn=function(){return"hsl("+[this.h,this.s,this.l]+")"},Dn=function(){return this.hex};t.hsb2rgb=function(n,s,r,l){return t.is(n,"object")&&"h"in n&&"s"in n&&"b"in n&&(r=n.b,s=n.s,n=n.h,l=n.o),t.hsl2rgb(n,s,r/2,l)},t.hsl2rgb=function(n,s,r,l){t.is(n,"object")&&"h"in n&&"s"in n&&"l"in n&&(r=n.l,s=n.s,n=n.h),(n>1||s>1||r>1)&&(n/=360,s/=100,r/=100);var c={},d=["r","g","b"],p,u,g;if(!s)c={r,g:r,b:r};else{r<.5?p=r*(1+s):p=r+s-r*s,u=2*r-p;for(var m=0;m<3;m++)g=n+1/3*-(m-1),g<0&&g++,g>1&&g--,g*6<1?c[d[m]]=u+(p-u)*6*g:g*2<1?c[d[m]]=p:g*3<2?c[d[m]]=u+(p-u)*(2/3-g)*6:c[d[m]]=u}return c.r*=255,c.g*=255,c.b*=255,c.hex="#"+(16777216|c.b|c.g<<8|c.r<<16).toString(16).slice(1),t.is(l,"finite")&&(c.opacity=l),c.toString=Dn,c},t.rgb2hsb=function(n,s,r){if(s==null&&t.is(n,"object")&&"r"in n&&"g"in n&&"b"in n&&(r=n.b,s=n.g,n=n.r),s==null&&t.is(n,W)){var l=t.getRGB(n);n=l.r,s=l.g,r=l.b}(n>1||s>1||r>1)&&(n/=255,s/=255,r/=255);var c=z(n,s,r),d=st(n,s,r),p,u,g=c;if(d==c)return{h:0,s:0,b:c,toString:ns};var m=c-d;return u=m/c,n==c?p=(s-r)/m:s==c?p=2+(r-n)/m:p=4+(n-s)/m,p/=6,p<0&&p++,p>1&&p--,{h:p,s:u,b:g,toString:ns}},t.rgb2hsl=function(n,s,r){if(s==null&&t.is(n,"object")&&"r"in n&&"g"in n&&"b"in n&&(r=n.b,s=n.g,n=n.r),s==null&&t.is(n,W)){var l=t.getRGB(n);n=l.r,s=l.g,r=l.b}(n>1||s>1||r>1)&&(n/=255,s/=255,r/=255);var c=z(n,s,r),d=st(n,s,r),p,u,g=(c+d)/2,m;if(d==c)m={h:0,s:0,l:g};else{var T=c-d;u=g<.5?T/(c+d):T/(2-c-d),n==c?p=(s-r)/T:s==c?p=2+(r-n)/T:p=4+(n-s)/T,p/=6,p<0&&p++,p>1&&p--,m={h:p,s:u,l:g}}return m.toString=Rn,m},t._path2string=function(){return this.join(",")[vt](Ve,"$1")};function Ht(n,s,r){function l(){var c=Array[h].slice.call(arguments,0),d=c[J]("►"),p=l.cache=l.cache||{},u=l.count=l.count||[];return p[f](d)||(u[I]>=1e3&&delete p[u.shift()],u[K](d),p[d]=n[E](s,c)),r?r(p[d]):p[d]}return l}t.getRGB=Ht(function(n){if(!n||(n=B(n)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1};if(n=="none")return{r:-1,g:-1,b:-1,hex:"none"};!(le[f](n.toLowerCase().substring(0,2))||n.charAt()=="#")&&(n=ze(n));var s,r,l,c,d,p,u=n.match(Be);return u?(u[2]&&(l=et(u[2].substring(5),16),r=et(u[2].substring(3,5),16),s=et(u[2].substring(1,3),16)),u[3]&&(l=et((d=u[3].charAt(3))+d,16),r=et((d=u[3].charAt(2))+d,16),s=et((d=u[3].charAt(1))+d,16)),u[4]&&(p=u[4][O](ne),s=Y(p[0]),p[0].slice(-1)=="%"&&(s*=2.55),r=Y(p[1]),p[1].slice(-1)=="%"&&(r*=2.55),l=Y(p[2]),p[2].slice(-1)=="%"&&(l*=2.55),u[1].toLowerCase().slice(0,4)=="rgba"&&(c=Y(p[3])),p[3]&&p[3].slice(-1)=="%"&&(c/=100)),u[5]?(p=u[5][O](ne),s=Y(p[0]),p[0].slice(-1)=="%"&&(s*=2.55),r=Y(p[1]),p[1].slice(-1)=="%"&&(r*=2.55),l=Y(p[2]),p[2].slice(-1)=="%"&&(l*=2.55),(p[0].slice(-3)=="deg"||p[0].slice(-1)=="°")&&(s/=360),u[1].toLowerCase().slice(0,4)=="hsba"&&(c=Y(p[3])),p[3]&&p[3].slice(-1)=="%"&&(c/=100),t.hsb2rgb(s,r,l,c)):u[6]?(p=u[6][O](ne),s=Y(p[0]),p[0].slice(-1)=="%"&&(s*=2.55),r=Y(p[1]),p[1].slice(-1)=="%"&&(r*=2.55),l=Y(p[2]),p[2].slice(-1)=="%"&&(l*=2.55),(p[0].slice(-3)=="deg"||p[0].slice(-1)=="°")&&(s/=360),u[1].toLowerCase().slice(0,4)=="hsla"&&(c=Y(p[3])),p[3]&&p[3].slice(-1)=="%"&&(c/=100),t.hsl2rgb(s,r,l,c)):(u={r:s,g:r,b:l},u.hex="#"+(16777216|l|r<<8|s<<16).toString(16).slice(1),t.is(c,"finite")&&(u.opacity=c),u)):{r:-1,g:-1,b:-1,hex:"none",error:1}},t),t.getColor=function(n){var s=this.getColor.start=this.getColor.start||{h:0,s:1,b:n||.75},r=this.hsb2rgb(s.h,s.s,s.b);return s.h+=.075,s.h>1&&(s.h=0,s.s-=.2,s.s<=0&&(this.getColor.start={h:0,s:1,b:s.b})),r.hex},t.getColor.reset=function(){delete this.start},t.parsePathString=Ht(function(n){if(!n)return null;var s={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},r=[];return t.is(n,pt)&&t.is(n[0],pt)&&(r=Ye(n)),r[I]||B(n)[vt](En,function(l,c,d){var p=[],u=ot.call(c);for(d[vt](Ln,function(g,m){m&&p[K](+m)}),u=="m"&&p[I]>2&&(r[K]([c][C](p.splice(0,2))),u="l",c=c=="m"?"l":"L");p[I]>=s[u]&&(r[K]([c][C](p.splice(0,s[u]))),!!s[u]););}),r[wt]=t._path2string,r}),t.findDotsAtSegment=function(n,s,r,l,c,d,p,u,g){var m=1-g,T=$(m,3)*n+$(m,2)*3*g*r+m*3*g*g*c+$(g,3)*p,D=$(m,3)*s+$(m,2)*3*g*l+m*3*g*g*d+$(g,3)*u,N=n+2*g*(r-n)+g*g*(c-2*r+n),F=s+2*g*(l-s)+g*g*(d-2*l+s),R=r+2*g*(c-r)+g*g*(p-2*c+r),A=l+2*g*(d-l)+g*g*(u-2*d+l),_=(1-g)*n+g*r,q=(1-g)*s+g*l,U=(1-g)*c+g*p,it=(1-g)*d+g*u,Z=90-X.atan((N-R)/(F-A))*180/lt;return(N>R||F<A)&&(Z+=180),{x:T,y:D,m:{x:N,y:F},n:{x:R,y:A},start:{x:_,y:q},end:{x:U,y:it},alpha:Z}};var He=Ht(function(n){if(!n)return{x:0,y:0,width:0,height:0};n=qe(n);for(var s=0,r=0,l=[],c=[],d,p=0,u=n[I];p<u;p++)if(d=n[p],d[0]=="M")s=d[1],r=d[2],l[K](s),c[K](r);else{var g=Nn(s,r,d[1],d[2],d[3],d[4],d[5],d[6]);l=l[C](g.min.x,g.max.x),c=c[C](g.min.y,g.max.y),s=d[5],r=d[6]}var m=st[E](0,l),T=st[E](0,c);return{x:m,y:T,width:z[E](0,l)-m,height:z[E](0,c)-T}}),Ye=function(n){var s=[];(!t.is(n,pt)||!t.is(n&&n[0],pt))&&(n=t.parsePathString(n));for(var r=0,l=n[I];r<l;r++){s[r]=[];for(var c=0,d=n[r][I];c<d;c++)s[r][c]=n[r][c]}return s[wt]=t._path2string,s},di=Ht(function(n){(!t.is(n,pt)||!t.is(n&&n[0],pt))&&(n=t.parsePathString(n));var s=[],r=0,l=0,c=0,d=0,p=0;n[0][0]=="M"&&(r=n[0][1],l=n[0][2],c=r,d=l,p++,s[K](["M",r,l]));for(var u=p,g=n[I];u<g;u++){var m=s[u]=[],T=n[u];if(T[0]!=ot.call(T[0]))switch(m[0]=ot.call(T[0]),m[0]){case"a":m[1]=T[1],m[2]=T[2],m[3]=T[3],m[4]=T[4],m[5]=T[5],m[6]=+(T[6]-r).toFixed(3),m[7]=+(T[7]-l).toFixed(3);break;case"v":m[1]=+(T[1]-l).toFixed(3);break;case"m":c=T[1],d=T[2];default:for(var D=1,N=T[I];D<N;D++)m[D]=+(T[D]-(D%2?r:l)).toFixed(3)}else{m=s[u]=[],T[0]=="m"&&(c=T[1]+r,d=T[2]+l);for(var F=0,R=T[I];F<R;F++)s[u][F]=T[F]}var A=s[u][I];switch(s[u][0]){case"z":r=c,l=d;break;case"h":r+=+s[u][A-1];break;case"v":l+=+s[u][A-1];break;default:r+=+s[u][A-2],l+=+s[u][A-1]}}return s[wt]=t._path2string,s},0,Ye),Te=Ht(function(n){(!t.is(n,pt)||!t.is(n&&n[0],pt))&&(n=t.parsePathString(n));var s=[],r=0,l=0,c=0,d=0,p=0;n[0][0]=="M"&&(r=+n[0][1],l=+n[0][2],c=r,d=l,p++,s[0]=["M",r,l]);for(var u=p,g=n[I];u<g;u++){var m=s[u]=[],T=n[u];if(T[0]!=xt.call(T[0]))switch(m[0]=xt.call(T[0]),m[0]){case"A":m[1]=T[1],m[2]=T[2],m[3]=T[3],m[4]=T[4],m[5]=T[5],m[6]=+(T[6]+r),m[7]=+(T[7]+l);break;case"V":m[1]=+T[1]+l;break;case"H":m[1]=+T[1]+r;break;case"M":c=+T[1]+r,d=+T[2]+l;default:for(var D=1,N=T[I];D<N;D++)m[D]=+T[D]+(D%2?r:l)}else for(var F=0,R=T[I];F<R;F++)s[u][F]=T[F];switch(m[0]){case"Z":r=c,l=d;break;case"H":r=m[1];break;case"V":l=m[1];break;case"M":c=s[u][s[u][I]-2],d=s[u][s[u][I]-1];default:r=s[u][s[u][I]-2],l=s[u][s[u][I]-1]}}return s[wt]=t._path2string,s},null,Ye),Xe=function(n,s,r,l){return[n,s,r,l,r,l]},os=function(n,s,r,l,c,d){var p=.3333333333333333,u=2/3;return[p*n+u*r,p*s+u*l,p*c+u*r,p*d+u*l,c,d]},rs=function(n,s,r,l,c,d,p,u,g,m){var T=lt*120/180,D=lt/180*(+c||0),N=[],F,R=Ht(function(Ds,Ns,Ke){var $n=Ds*X.cos(Ke)-Ns*X.sin(Ke),Kn=Ds*X.sin(Ke)+Ns*X.cos(Ke);return{x:$n,y:Kn}});if(m)yt=m[0],at=m[1],mt=m[2],ut=m[3];else{F=R(n,s,-D),n=F.x,s=F.y,F=R(u,g,-D),u=F.x,g=F.y;var A=(n-u)/2,_=(s-g)/2,q=A*A/(r*r)+_*_/(l*l);q>1&&(q=X.sqrt(q),r=q*r,l=q*l);var U=r*r,it=l*l,Z=(d==p?-1:1)*X.sqrt(nt((U*it-U*_*_-it*A*A)/(U*_*_+it*A*A))),mt=Z*r*_/l+(n+u)/2,ut=Z*-l*A/r+(s+g)/2,yt=X.asin(((s-ut)/l).toFixed(9)),at=X.asin(((g-ut)/l).toFixed(9));yt=n<mt?lt-yt:yt,at=u<mt?lt-at:at,yt<0&&(yt=lt*2+yt),at<0&&(at=lt*2+at),p&&yt>at&&(yt=yt-lt*2),!p&&at>yt&&(at=at-lt*2)}var St=at-yt;if(nt(St)>T){var Dt=at,Yt=u,Zt=g;at=yt+T*(p&&at>yt?1:-1),u=mt+r*X.cos(at),g=ut+l*X.sin(at),N=rs(u,g,r,l,c,0,p,Yt,Zt,[at,Dt,mt,ut])}St=at-yt;var Qt=X.cos(yt),At=X.sin(yt),ue=X.cos(at),Nt=X.sin(at),te=X.tan(St/4),oe=4/3*r*te,Ps=4/3*l*te,Es=[n,s],fe=[n+oe*At,s-Ps*Qt],Ls=[u+oe*Nt,g-Ps*ue],Is=[u,g];if(fe[0]=2*Es[0]-fe[0],fe[1]=2*Es[1]-fe[1],m)return[fe,Ls,Is][C](N);N=[fe,Ls,Is][C](N)[J]()[O](",");for(var Rs=[],ee=0,Wn=N[I];ee<Wn;ee++)Rs[ee]=ee%2?R(N[ee-1],N[ee],D).y:R(N[ee],N[ee+1],D).x;return Rs},Ue=function(n,s,r,l,c,d,p,u,g){var m=1-g;return{x:$(m,3)*n+$(m,2)*3*g*r+m*3*g*g*c+$(g,3)*p,y:$(m,3)*s+$(m,2)*3*g*l+m*3*g*g*d+$(g,3)*u}},Nn=Ht(function(n,s,r,l,c,d,p,u){var g=c-2*r+n-(p-2*c+r),m=2*(r-n)-2*(c-r),T=n-r,D=(-m+X.sqrt(m*m-4*g*T))/2/g,N=(-m-X.sqrt(m*m-4*g*T))/2/g,F=[s,u],R=[n,p],A;return nt(D)>"1e12"&&(D=.5),nt(N)>"1e12"&&(N=.5),D>0&&D<1&&(A=Ue(n,s,r,l,c,d,p,u,D),R[K](A.x),F[K](A.y)),N>0&&N<1&&(A=Ue(n,s,r,l,c,d,p,u,N),R[K](A.x),F[K](A.y)),g=d-2*l+s-(u-2*d+l),m=2*(l-s)-2*(d-l),T=s-l,D=(-m+X.sqrt(m*m-4*g*T))/2/g,N=(-m-X.sqrt(m*m-4*g*T))/2/g,nt(D)>"1e12"&&(D=.5),nt(N)>"1e12"&&(N=.5),D>0&&D<1&&(A=Ue(n,s,r,l,c,d,p,u,D),R[K](A.x),F[K](A.y)),N>0&&N<1&&(A=Ue(n,s,r,l,c,d,p,u,N),R[K](A.x),F[K](A.y)),{min:{x:st[E](0,R),y:st[E](0,F)},max:{x:z[E](0,R),y:z[E](0,F)}}}),qe=Ht(function(n,s){for(var r=Te(n),l=s&&Te(s),c={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},d={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},p=function(A,_){var q,U;if(!A)return["C",_.x,_.y,_.x,_.y,_.x,_.y];switch(!(A[0]in{T:1,Q:1})&&(_.qx=_.qy=null),A[0]){case"M":_.X=A[1],_.Y=A[2];break;case"A":A=["C"][C](rs[E](0,[_.x,_.y][C](A.slice(1))));break;case"S":q=_.x+(_.x-(_.bx||_.x)),U=_.y+(_.y-(_.by||_.y)),A=["C",q,U][C](A.slice(1));break;case"T":_.qx=_.x+(_.x-(_.qx||_.x)),_.qy=_.y+(_.y-(_.qy||_.y)),A=["C"][C](os(_.x,_.y,_.qx,_.qy,A[1],A[2]));break;case"Q":_.qx=A[1],_.qy=A[2],A=["C"][C](os(_.x,_.y,A[1],A[2],A[3],A[4]));break;case"L":A=["C"][C](Xe(_.x,_.y,A[1],A[2]));break;case"H":A=["C"][C](Xe(_.x,_.y,A[1],_.y));break;case"V":A=["C"][C](Xe(_.x,_.y,_.x,A[1]));break;case"Z":A=["C"][C](Xe(_.x,_.y,_.X,_.Y));break}return A},u=function(A,_){if(A[_][I]>7){A[_].shift();for(var q=A[_];q[I];)A.splice(_++,0,["C"][C](q.splice(0,6)));A.splice(_,1),T=z(r[I],l&&l[I]||0)}},g=function(A,_,q,U,it){A&&_&&A[it][0]=="M"&&_[it][0]!="M"&&(_.splice(it,0,["M",U.x,U.y]),q.bx=0,q.by=0,q.x=A[it][1],q.y=A[it][2],T=z(r[I],l&&l[I]||0))},m=0,T=z(r[I],l&&l[I]||0);m<T;m++){r[m]=p(r[m],c),u(r,m),l&&(l[m]=p(l[m],d)),l&&u(l,m),g(r,l,c,d,m),g(l,r,d,c,m);var D=r[m],N=l&&l[m],F=D[I],R=l&&N[I];c.x=D[F-2],c.y=D[F-1],c.bx=Y(D[F-4])||c.x,c.by=Y(D[F-3])||c.y,d.bx=l&&(Y(N[R-4])||d.x),d.by=l&&(Y(N[R-3])||d.y),d.x=l&&N[R-2],d.y=l&&N[R-1]}return l?[r,l]:r},null,Ye),as=Ht(function(n){for(var s=[],r=0,l=n[I];r<l;r++){var c={},d=n[r].match(/^([^:]*):?([\d\.]*)/);if(c.color=t.getRGB(d[1]),c.color.error)return null;c.color=c.color.hex,d[2]&&(c.offset=d[2]+"%"),s[K](c)}for(r=1,l=s[I]-1;r<l;r++)if(!s[r].offset){for(var p=Y(s[r-1].offset||0),u=0,g=r+1;g<l;g++)if(s[g].offset){u=s[g].offset;break}u||(u=100,g=l),u=Y(u);for(var m=(u-p)/(g-r+1);r<g;r++)p+=m,s[r].offset=p+"%"}return s}),ls=function(n,s,r,l){var c;if(t.is(n,W)||t.is(n,"object")){if(c=t.is(n,W)?v.getElementById(n):n,c.tagName)return s==null?{container:c,width:c.style.pixelWidth||c.offsetWidth,height:c.style.pixelHeight||c.offsetHeight}:{container:c,width:s,height:r}}else return{container:1,x:n,y:s,width:r,height:l}},pi=function(n,s){var r=this;for(var l in s)if(s[f](l)&&!(l in n))switch(typeof s[l]){case"function":(function(c){n[l]=n===r?c:function(){return c[E](r,arguments)}})(s[l]);break;case"object":n[l]=n[l]||{},pi.call(this,n[l],s[l]);break;default:n[l]=s[l];break}},ce=function(n,s){n==s.top&&(s.top=n.prev),n==s.bottom&&(s.bottom=n.next),n.next&&(n.next.prev=n.prev),n.prev&&(n.prev.next=n.next)},cs=function(n,s){s.top!==n&&(ce(n,s),n.next=null,n.prev=s.top,s.top.next=n,s.top=n)},hs=function(n,s){s.bottom!==n&&(ce(n,s),n.next=s.bottom,n.prev=null,s.bottom.prev=n,s.bottom=n)},us=function(n,s,r){ce(n,r),s==r.top&&(r.top=n),s.next&&(s.next.prev=n),n.next=s.next,n.prev=s,s.next=n},fs=function(n,s,r){ce(n,r),s==r.bottom&&(r.bottom=n),s.prev&&(s.prev.next=n),n.prev=s.prev,s.prev=n,n.next=s},ds=function(n){return function(){throw new Error("Raphaël: you are calling to method “"+n+"” of removed object")}};if(t.pathToRelative=di,t.svg){w.svgns="http://www.w3.org/2000/svg",w.xlink="http://www.w3.org/1999/xlink",G=function(n){return+n+(~~n===n)*.5};var Q=function(n,s){if(s)for(var r in s)s[f](r)&&i(n,r,B(s[r]));else return n=v.createElementNS(w.svgns,n),n.style.webkitTapHighlightColor="rgba(0,0,0,0)",n};t[wt]=function(){return`Your browser supports SVG.
You are running Raphaël `+this.version};var ps=function(n,s){var r=Q("path");s.canvas&&s.canvas[S](r);var l=new gt(r,s);return l.type="path",Kt(l,{fill:"none",stroke:"#000",path:n}),l},_e=function(n,s,r){var l="linear",c=.5,d=.5,p=n.style;if(s=B(s)[vt](ss,function(_,q,U){if(l="radial",q&&U){c=Y(q),d=Y(U);var it=(d>.5)*2-1;$(c-.5,2)+$(d-.5,2)>.25&&(d=X.sqrt(.25-$(c-.5,2))*it+.5)&&d!=.5&&(d=d.toFixed(5)-1e-5*it)}return k}),s=s[O](/\s*\-\s*/),l=="linear"){var u=s.shift();if(u=-Y(u),isNaN(u))return null;var g=[0,0,X.cos(u*lt/180),X.sin(u*lt/180)],m=1/(z(nt(g[2]),nt(g[3]))||1);g[2]*=m,g[3]*=m,g[2]<0&&(g[0]=-g[2],g[2]=0),g[3]<0&&(g[1]=-g[3],g[3]=0)}var T=as(s);if(!T)return null;var D=n.getAttribute(Lt);D=D.match(/^url\(#(.*)\)$/),D&&r.defs.removeChild(v.getElementById(D[1]));var N=Q(l+"Gradient");N.id=Ge(),Q(N,l=="radial"?{fx:c,fy:d}:{x1:g[0],y1:g[1],x2:g[2],y2:g[3]}),r.defs[S](N);for(var F=0,R=T[I];F<R;F++){var A=Q("stop");Q(A,{offset:T[F].offset?T[F].offset:F?"100%":"0%","stop-color":T[F].color||"#fff"}),N[S](A)}return Q(n,{fill:"url(#"+N.id+")",opacity:1,"fill-opacity":1}),p.fill=k,p.opacity=1,p.fillOpacity=1,1},gi=function(n){var s=n.getBBox();Q(n.pattern,{patternTransform:t.format("translate({0},{1})",s.x,s.y)})},Kt=function(n,s){var r={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},l=n.node,c=n.attrs,d=n.rotate(),p=function(at,St){if(St=r[ot.call(St)],St){for(var Dt=at.attrs["stroke-width"]||"1",Yt={round:Dt,square:Dt,butt:0}[at.attrs["stroke-linecap"]||s["stroke-linecap"]]||0,Zt=[],Qt=St[I];Qt--;)Zt[Qt]=St[Qt]*Dt+(Qt%2?1:-1)*Yt;Q(l,{"stroke-dasharray":Zt[J](",")})}};s[f]("rotation")&&(d=s.rotation);var u=B(d)[O](e);u.length-1?(u[1]=+u[1],u[2]=+u[2]):u=null,Y(d)&&n.rotate(0,!0);for(var g in s)if(s[f](g)){if(!Mt[f](g))continue;var m=s[g];switch(c[g]=m,g){case"blur":n.blur(m);break;case"rotation":n.rotate(m,!0);break;case"href":case"title":case"target":var T=l.parentNode;if(ot.call(T.tagName)!="a"){var D=Q("a");T.insertBefore(D,l),D[S](l),T=D}g=="target"&&m=="blank"?T.setAttributeNS(n.paper.xlink,"show","new"):T.setAttributeNS(n.paper.xlink,g,m);break;case"cursor":l.style.cursor=m;break;case"clip-rect":var N=B(m)[O](e);if(N[I]==4){n.clip&&n.clip.parentNode.parentNode.removeChild(n.clip.parentNode);var F=Q("clipPath"),R=Q("rect");F.id=Ge(),Q(R,{x:N[0],y:N[1],width:N[2],height:N[3]}),F[S](R),n.paper.defs[S](F),Q(l,{"clip-path":"url(#"+F.id+")"}),n.clip=R}if(!m){var A=v.getElementById(l.getAttribute("clip-path")[vt](/(^url\(#|\)$)/g,k));A&&A.parentNode.removeChild(A),Q(l,{"clip-path":k}),delete n.clip}break;case"path":n.type=="path"&&Q(l,{d:m?c.path=Te(m):"M0,0"});break;case"width":if(i(l,g,m),c.fx)g="x",m=c.x;else break;case"x":c.fx&&(m=-c.x-(c.width||0));case"rx":if(g=="rx"&&n.type=="rect")break;case"cx":u&&(g=="x"||g=="cx")&&(u[1]+=m-c[g]),i(l,g,m),n.pattern&&gi(n);break;case"height":if(i(l,g,m),c.fy)g="y",m=c.y;else break;case"y":c.fy&&(m=-c.y-(c.height||0));case"ry":if(g=="ry"&&n.type=="rect")break;case"cy":u&&(g=="y"||g=="cy")&&(u[2]+=m-c[g]),i(l,g,m),n.pattern&&gi(n);break;case"r":n.type=="rect"?Q(l,{rx:m,ry:m}):i(l,g,m);break;case"src":n.type=="image"&&l.setAttributeNS(n.paper.xlink,"href",m);break;case"stroke-width":l.style.strokeWidth=m,i(l,g,m),c["stroke-dasharray"]&&p(n,c["stroke-dasharray"]);break;case"stroke-dasharray":p(n,m);break;case"translation":var _=B(m)[O](e);_[0]=+_[0]||0,_[1]=+_[1]||0,u&&(u[1]+=_[0],u[2]+=_[1]),$e.call(n,_[0],_[1]);break;case"scale":_=B(m)[O](e),n.scale(+_[0]||1,+_[1]||+_[0]||1,isNaN(Y(_[2]))?null:+_[2],isNaN(Y(_[3]))?null:+_[3]);break;case Lt:var q=B(m).match(Me);if(q){F=Q("pattern");var U=Q("image");F.id=Ge(),Q(F,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),Q(U,{x:0,y:0}),U.setAttributeNS(n.paper.xlink,"href",q[1]),F[S](U);var it=v.createElement("img");it.style.cssText="position:absolute;left:-9999em;top-9999em",it.onload=function(){Q(F,{width:this.offsetWidth,height:this.offsetHeight}),Q(U,{width:this.offsetWidth,height:this.offsetHeight}),v.body.removeChild(this),n.paper.safari()},v.body[S](it),it.src=q[1],n.paper.defs[S](F),l.style.fill="url(#"+F.id+")",Q(l,{fill:"url(#"+F.id+")"}),n.pattern=F,n.pattern&&gi(n);break}var Z=t.getRGB(m);if(!Z.error)delete s.gradient,delete c.gradient,!t.is(c.opacity,"undefined")&&t.is(s.opacity,"undefined")&&Q(l,{opacity:c.opacity}),!t.is(c["fill-opacity"],"undefined")&&t.is(s["fill-opacity"],"undefined")&&Q(l,{"fill-opacity":c["fill-opacity"]});else if(({circle:1,ellipse:1}[f](n.type)||B(m).charAt()!="r")&&_e(l,m,n.paper)){c.gradient=m,c.fill="none";break}Z[f]("opacity")&&Q(l,{"fill-opacity":Z.opacity>1?Z.opacity/100:Z.opacity});case"stroke":Z=t.getRGB(m),i(l,g,Z.hex),g=="stroke"&&Z[f]("opacity")&&Q(l,{"stroke-opacity":Z.opacity>1?Z.opacity/100:Z.opacity});break;case"gradient":({circle:1,ellipse:1}[f](n.type)||B(m).charAt()!="r")&&_e(l,m,n.paper);break;case"opacity":c.gradient&&!c[f]("stroke-opacity")&&Q(l,{"stroke-opacity":m>1?m/100:m});case"fill-opacity":if(c.gradient){var mt=v.getElementById(l.getAttribute(Lt)[vt](/^url\(#|\)$/g,k));if(mt){var ut=mt.getElementsByTagName("stop");i(ut[ut[I]-1],"stop-opacity",m)}break}default:g=="font-size"&&(m=et(m,10)+"px");var yt=g[vt](/(\-.)/g,function(at){return xt.call(at.substring(1))});l.style[yt]=m,i(l,g,m);break}}Fn(n,s),u?n.rotate(u.join(V)):Y(d)&&n.rotate(d,!0)},gs=1.2,Fn=function(n,s){if(!(n.type!="text"||!(s[f]("text")||s[f]("font")||s[f]("font-size")||s[f]("x")||s[f]("y")))){var r=n.attrs,l=n.node,c=l.firstChild?et(v.defaultView.getComputedStyle(l.firstChild,k).getPropertyValue("font-size"),10):10;if(s[f]("text")){for(r.text=s.text;l.firstChild;)l.removeChild(l.firstChild);for(var d=B(s.text)[O](`
`),p=0,u=d[I];p<u;p++)if(d[p]){var g=Q("tspan");p&&Q(g,{dy:c*gs,x:r.x}),g[S](v.createTextNode(d[p])),l[S](g)}}else for(d=l.getElementsByTagName("tspan"),p=0,u=d[I];p<u;p++)p&&Q(d[p],{dy:c*gs,x:r.x});Q(l,{y:r.y});var m=n.getBBox(),T=r.y-(m.y+m.height/2);T&&t.is(T,"finite")&&Q(l,{y:r.y+T})}},gt=function(n,s){this[0]=n,this.id=t._oid++,this.node=n,n.raphael=this,this.paper=s,this.attrs=this.attrs||{},this.transformations=[],this._={tx:0,ty:0,rt:{deg:0,cx:0,cy:0},sx:1,sy:1},!s.bottom&&(s.bottom=this),this.prev=s.top,s.top&&(s.top.next=this),s.top=this,this.next=null},ft=gt[h];gt[h].rotate=function(n,s,r){if(this.removed)return this;if(n==null)return this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][J](V):this._.rt.deg;var l=this.getBBox();return n=B(n)[O](e),n[I]-1&&(s=Y(n[1]),r=Y(n[2])),n=Y(n[0]),s!=null&&s!==!1?this._.rt.deg=n:this._.rt.deg+=n,r==null&&(s=null),this._.rt.cx=s,this._.rt.cy=r,s=s??l.x+l.width/2,r=r??l.y+l.height/2,this._.rt.deg?(this.transformations[0]=t.format("rotate({0} {1} {2})",this._.rt.deg,s,r),this.clip&&Q(this.clip,{transform:t.format("rotate({0} {1} {2})",-this._.rt.deg,s,r)})):(this.transformations[0]=k,this.clip&&Q(this.clip,{transform:k})),Q(this.node,{transform:this.transformations[J](V)}),this},gt[h].hide=function(){return!this.removed&&(this.node.style.display="none"),this},gt[h].show=function(){return!this.removed&&(this.node.style.display=""),this},gt[h].remove=function(){if(!this.removed){ce(this,this.paper),this.node.parentNode.removeChild(this.node);for(var n in this)delete this[n];this.removed=!0}},gt[h].getBBox=function(){if(this.removed)return this;if(this.type=="path")return He(this.attrs.path);if(this.node.style.display=="none"){this.show();var n=!0}var s={};try{s=this.node.getBBox()}catch{}finally{s=s||{}}if(this.type=="text"){s={x:s.x,y:1/0,width:0,height:0};for(var r=0,l=this.node.getNumberOfChars();r<l;r++){var c=this.node.getExtentOfChar(r);c.y<s.y&&(s.y=c.y),c.y+c.height-s.y>s.height&&(s.height=c.y+c.height-s.y),c.x+c.width-s.x>s.width&&(s.width=c.x+c.width-s.x)}}return n&&this.hide(),s},gt[h].attr=function(n,s){if(this.removed)return this;if(n==null){var r={};for(var l in this.attrs)this.attrs[f](l)&&(r[l]=this.attrs[l]);return this._.rt.deg&&(r.rotation=this.rotate()),(this._.sx!=1||this._.sy!=1)&&(r.scale=this.scale()),r.gradient&&r.fill=="none"&&(r.fill=r.gradient)&&delete r.gradient,r}if(s==null&&t.is(n,W))return n=="translation"?$e.call(this):n=="rotation"?this.rotate():n=="scale"?this.scale():n==Lt&&this.attrs.fill=="none"&&this.attrs.gradient?this.attrs.gradient:this.attrs[n];if(s==null&&t.is(n,pt)){for(var c={},d=0,p=n.length;d<p;d++)c[n[d]]=this.attr(n[d]);return c}if(s!=null){var u={};u[n]=s}else n!=null&&t.is(n,"object")&&(u=n);for(var g in this.paper.customAttributes)if(this.paper.customAttributes[f](g)&&u[f](g)&&t.is(this.paper.customAttributes[g],"function")){var m=this.paper.customAttributes[g].apply(this,[][C](u[g]));this.attrs[g]=u[g];for(var T in m)m[f](T)&&(u[T]=m[T])}return Kt(this,u),this},gt[h].toFront=function(){if(this.removed)return this;this.node.parentNode[S](this.node);var n=this.paper;return n.top!=this&&cs(this,n),this},gt[h].toBack=function(){return this.removed?this:(this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),hs(this,this.paper),this.paper),this)},gt[h].insertAfter=function(n){if(this.removed)return this;var s=n.node||n[n.length-1].node;return s.nextSibling?s.parentNode.insertBefore(this.node,s.nextSibling):s.parentNode[S](this.node),us(this,n,this.paper),this},gt[h].insertBefore=function(n){if(this.removed)return this;var s=n.node||n[0].node;return s.parentNode.insertBefore(this.node,s),fs(this,n,this.paper),this},gt[h].blur=function(n){var s=this;if(+n!=0){var r=Q("filter"),l=Q("feGaussianBlur");s.attrs.blur=n,r.id=Ge(),Q(l,{stdDeviation:+n||1.5}),r.appendChild(l),s.paper.defs.appendChild(r),s._blur=r,Q(s.node,{filter:"url(#"+r.id+")"})}else s._blur&&(s._blur.parentNode.removeChild(s._blur),delete s._blur,delete s.attrs.blur),s.node.removeAttribute("filter")};var ms=function(n,s,r,l){var c=Q("circle");n.canvas&&n.canvas[S](c);var d=new gt(c,n);return d.attrs={cx:s,cy:r,r:l,fill:"none",stroke:"#000"},d.type="circle",Q(c,d.attrs),d},vs=function(n,s,r,l,c,d){var p=Q("rect");n.canvas&&n.canvas[S](p);var u=new gt(p,n);return u.attrs={x:s,y:r,width:l,height:c,r:d||0,rx:d||0,ry:d||0,fill:"none",stroke:"#000"},u.type="rect",Q(p,u.attrs),u},bs=function(n,s,r,l,c){var d=Q("ellipse");n.canvas&&n.canvas[S](d);var p=new gt(d,n);return p.attrs={cx:s,cy:r,rx:l,ry:c,fill:"none",stroke:"#000"},p.type="ellipse",Q(d,p.attrs),p},ys=function(n,s,r,l,c,d){var p=Q("image");Q(p,{x:r,y:l,width:c,height:d,preserveAspectRatio:"none"}),p.setAttributeNS(n.xlink,"href",s),n.canvas&&n.canvas[S](p);var u=new gt(p,n);return u.attrs={x:r,y:l,width:c,height:d,src:s},u.type="image",u},xs=function(n,s,r,l){var c=Q("text");Q(c,{x:s,y:r,"text-anchor":"middle"}),n.canvas&&n.canvas[S](c);var d=new gt(c,n);return d.attrs={x:s,y:r,"text-anchor":"middle",text:l,font:Mt.font,stroke:"none",fill:"#000"},d.type="text",Kt(d,d.attrs),d},ws=function(n,s){return this.width=n||this.width,this.height=s||this.height,i(this.canvas,"width",this.width),i(this.canvas,"height",this.height),this},mi=function(){var n=ls[E](0,arguments),s=n&&n.container,r=n.x,l=n.y,c=n.width,d=n.height;if(!s)throw new Error("SVG container not found.");var p=Q("svg");return r=r||0,l=l||0,c=c||512,d=d||342,Q(p,{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:c,height:d}),s==1?(p.style.cssText="position:absolute;left:"+r+"px;top:"+l+"px",v.body[S](p)):s.firstChild?s.insertBefore(p,s.firstChild):s[S](p),s=new M,s.width=c,s.height=d,s.canvas=p,pi.call(s,s,t.fn),s.clear(),s};w.clear=function(){for(var n=this.canvas;n.firstChild;)n.removeChild(n.firstChild);this.bottom=this.top=null,(this.desc=Q("desc"))[S](v.createTextNode("Created with Raphaël")),n[S](this.desc),n[S](this.defs=Q("defs"))},w.remove=function(){this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var n in this)this[n]=ds(n)}}if(t.vml){let n=function(s,r,l,c,d){return d?t.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",s+d,r,l-d*2,d,-d,c-d*2,d*2-l,d*2-c):t.format("M{0},{1}l{2},0,0,{3},{4},0z",s,r,l,c,-l)};var Ms={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},Bn=/([clmz]),?([^clmz]*)/gi,Vn=/ progid:\S+Blur\([^\)]+\)/g,On=/-?[^,\s-]+/g,ke=1e3+V+1e3,he=10,Ce={path:1,rect:1},Gn=function(s){var r=/[ahqstv]/ig,l=Te;if(B(s).match(r)&&(l=qe),r=/[clmz]/g,l==Te&&!B(s).match(r)){var c=B(s)[vt](Bn,function(N,F,R){var A=[],_=ot.call(F)=="m",q=Ms[F];return R[vt](On,function(U){_&&A[I]==2&&(q+=A+Ms[F=="m"?"l":"L"],A=[]),A[K](G(U*he))}),q+A});return c}var d=l(s),p,u;c=[];for(var g=0,m=d[I];g<m;g++){p=d[g],u=ot.call(d[g][0]),u=="z"&&(u="x");for(var T=1,D=p[I];T<D;T++)u+=G(p[T]*he)+(T!=D-1?",":k);c[K](u)}return c[J](V)};t[wt]=function(){return`Your browser doesn’t support SVG. Falling down to VML.
You are running Raphaël `+this.version},ps=function(s,r){var l=_t("group");l.style.cssText="position:absolute;left:0;top:0;width:"+r.width+"px;height:"+r.height+"px",l.coordsize=r.coordsize,l.coordorigin=r.coordorigin;var c=_t("shape"),d=c.style;d.width=r.width+"px",d.height=r.height+"px",c.coordsize=ke,c.coordorigin=r.coordorigin,l[S](c);var p=new gt(c,l,r),u={fill:"none",stroke:"#000"};return s&&(u.path=s),p.type="path",p.path=[],p.Path=k,Kt(p,u),r.canvas[S](l),p},Kt=function(s,r){s.attrs=s.attrs||{};var l=s.node,c=s.attrs,d=l.style,p,u=(r.x!=c.x||r.y!=c.y||r.width!=c.width||r.height!=c.height||r.r!=c.r)&&s.type=="rect",g=s;for(var m in r)r[f](m)&&(c[m]=r[m]);if(u&&(c.path=n(c.x,c.y,c.width,c.height,c.r),s.X=c.x,s.Y=c.y,s.W=c.width,s.H=c.height),r.href&&(l.href=r.href),r.title&&(l.title=r.title),r.target&&(l.target=r.target),r.cursor&&(d.cursor=r.cursor),"blur"in r&&s.blur(r.blur),(r.path&&s.type=="path"||u)&&(l.path=Gn(c.path)),r.rotation!=null&&s.rotate(r.rotation,!0),r.translation&&(p=B(r.translation)[O](e),$e.call(s,p[0],p[1]),s._.rt.cx!=null&&(s._.rt.cx+=+p[0],s._.rt.cy+=+p[1],s.setBox(s.attrs,p[0],p[1]))),r.scale&&(p=B(r.scale)[O](e),s.scale(+p[0]||1,+p[1]||+p[0]||1,+p[2]||null,+p[3]||null)),"clip-rect"in r){var T=B(r["clip-rect"])[O](e);if(T[I]==4){T[2]=+T[2]+ +T[0],T[3]=+T[3]+ +T[1];var D=l.clipRect||v.createElement("div"),N=D.style,F=l.parentNode;N.clip=t.format("rect({1}px {2}px {3}px {0}px)",T),l.clipRect||(N.position="absolute",N.top=0,N.left=0,N.width=s.paper.width+"px",N.height=s.paper.height+"px",F.parentNode.insertBefore(D,F),D[S](F),l.clipRect=D)}r["clip-rect"]||l.clipRect&&(l.clipRect.style.clip=k)}if(s.type=="image"&&r.src&&(l.src=r.src),s.type=="image"&&r.opacity&&(l.filterOpacity=dt+".Alpha(opacity="+r.opacity*100+")",d.filter=(l.filterMatrix||k)+(l.filterOpacity||k)),r.font&&(d.font=r.font),r["font-family"]&&(d.fontFamily='"'+r["font-family"][O](",")[0][vt](/^['"]+|['"]+$/g,k)+'"'),r["font-size"]&&(d.fontSize=r["font-size"]),r["font-weight"]&&(d.fontWeight=r["font-weight"]),r["font-style"]&&(d.fontStyle=r["font-style"]),r.opacity!=null||r["stroke-width"]!=null||r.fill!=null||r.stroke!=null||r["stroke-width"]!=null||r["stroke-opacity"]!=null||r["fill-opacity"]!=null||r["stroke-dasharray"]!=null||r["stroke-miterlimit"]!=null||r["stroke-linejoin"]!=null||r["stroke-linecap"]!=null){l=s.shape||l;var R=l.getElementsByTagName(Lt)&&l.getElementsByTagName(Lt)[0],A=!1;if(!R&&(A=R=_t(Lt)),"fill-opacity"in r||"opacity"in r){var _=((+c["fill-opacity"]+1||2)-1)*((+c.opacity+1||2)-1)*((+t.getRGB(r.fill).o+1||2)-1);_=st(z(_,0),1),R.opacity=_}if(r.fill&&(R.on=!0),(R.on==null||r.fill=="none")&&(R.on=!1),R.on&&r.fill){var q=r.fill.match(Me);q?(R.src=q[1],R.type="tile"):(R.color=t.getRGB(r.fill).hex,R.src=k,R.type="solid",t.getRGB(r.fill).error&&(g.type in{circle:1,ellipse:1}||B(r.fill).charAt()!="r")&&_e(g,r.fill)&&(c.fill="none",c.gradient=r.fill))}A&&l[S](R);var U=l.getElementsByTagName("stroke")&&l.getElementsByTagName("stroke")[0],it=!1;!U&&(it=U=_t("stroke")),(r.stroke&&r.stroke!="none"||r["stroke-width"]||r["stroke-opacity"]!=null||r["stroke-dasharray"]||r["stroke-miterlimit"]||r["stroke-linejoin"]||r["stroke-linecap"])&&(U.on=!0),(r.stroke=="none"||U.on==null||r.stroke==0||r["stroke-width"]==0)&&(U.on=!1);var Z=t.getRGB(r.stroke);U.on&&r.stroke&&(U.color=Z.hex),_=((+c["stroke-opacity"]+1||2)-1)*((+c.opacity+1||2)-1)*((+Z.o+1||2)-1);var mt=(Y(r["stroke-width"])||1)*.75;if(_=st(z(_,0),1),r["stroke-width"]==null&&(mt=c["stroke-width"]),r["stroke-width"]&&(U.weight=mt),mt&&mt<1&&(_*=mt)&&(U.weight=1),U.opacity=_,r["stroke-linejoin"]&&(U.joinstyle=r["stroke-linejoin"]||"miter"),U.miterlimit=r["stroke-miterlimit"]||8,r["stroke-linecap"]&&(U.endcap=r["stroke-linecap"]=="butt"?"flat":r["stroke-linecap"]=="square"?"square":"round"),r["stroke-dasharray"]){var ut={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};U.dashstyle=ut[f](r["stroke-dasharray"])?ut[r["stroke-dasharray"]]:k}it&&l[S](U)}if(g.type=="text")switch(d=g.paper.span.style,c.font&&(d.font=c.font),c["font-family"]&&(d.fontFamily=c["font-family"]),c["font-size"]&&(d.fontSize=c["font-size"]),c["font-weight"]&&(d.fontWeight=c["font-weight"]),c["font-style"]&&(d.fontStyle=c["font-style"]),g.node.string&&(g.paper.span.innerHTML=B(g.node.string)[vt](/</g,"&#60;")[vt](/&/g,"&#38;")[vt](/\n/g,"<br>")),g.W=c.w=g.paper.span.offsetWidth,g.H=c.h=g.paper.span.offsetHeight,g.X=c.x,g.Y=c.y+G(g.H/2),c["text-anchor"]){case"start":g.node.style["v-text-align"]="left",g.bbx=G(g.W/2);break;case"end":g.node.style["v-text-align"]="right",g.bbx=-G(g.W/2);break;default:g.node.style["v-text-align"]="center";break}},_e=function(s,r){s.attrs=s.attrs||{},s.attrs;var l,c="linear",d=".5 .5";if(s.attrs.gradient=r,r=B(r)[vt](ss,function(D,N,F){return c="radial",N&&F&&(N=Y(N),F=Y(F),$(N-.5,2)+$(F-.5,2)>.25&&(F=X.sqrt(.25-$(N-.5,2))*((F>.5)*2-1)+.5),d=N+V+F),k}),r=r[O](/\s*\-\s*/),c=="linear"){var p=r.shift();if(p=-Y(p),isNaN(p))return null}var u=as(r);if(!u)return null;if(s=s.shape||s.node,l=s.getElementsByTagName(Lt)[0]||_t(Lt),!l.parentNode&&s.appendChild(l),u[I]){l.on=!0,l.method="none",l.color=u[0].color,l.color2=u[u[I]-1].color;for(var g=[],m=0,T=u[I];m<T;m++)u[m].offset&&g[K](u[m].offset+V+u[m].color);l.colors&&(l.colors.value=g[I]?g[J]():"0% "+l.color),c=="radial"?(l.type="gradientradial",l.focus="100%",l.focussize=d,l.focusposition=d):(l.type="gradient",l.angle=(270-p)%360)}return 1},gt=function(s,r,l){this[0]=s,this.id=t._oid++,this.node=s,s.raphael=this,this.X=0,this.Y=0,this.attrs={},this.Group=r,this.paper=l,this._={tx:0,ty:0,rt:{deg:0},sx:1,sy:1},!l.bottom&&(l.bottom=this),this.prev=l.top,l.top&&(l.top.next=this),l.top=this,this.next=null},ft=gt[h],ft.rotate=function(s,r,l){return this.removed?this:s==null?this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][J](V):this._.rt.deg:(s=B(s)[O](e),s[I]-1&&(r=Y(s[1]),l=Y(s[2])),s=Y(s[0]),r!=null?this._.rt.deg=s:this._.rt.deg+=s,l==null&&(r=null),this._.rt.cx=r,this._.rt.cy=l,this.setBox(this.attrs,r,l),this.Group.style.rotation=this._.rt.deg,this)},ft.setBox=function(s,r,l){if(this.removed)return this;var c=this.Group.style,d=this.shape&&this.shape.style||this.node.style;s=s||{};for(var p in s)s[f](p)&&(this.attrs[p]=s[p]);r=r||this._.rt.cx,l=l||this._.rt.cy;var u=this.attrs,g,m,T,D;switch(this.type){case"circle":g=u.cx-u.r,m=u.cy-u.r,T=D=u.r*2;break;case"ellipse":g=u.cx-u.rx,m=u.cy-u.ry,T=u.rx*2,D=u.ry*2;break;case"image":g=+u.x,m=+u.y,T=u.width||0,D=u.height||0;break;case"text":this.textpath.v=["m",G(u.x),", ",G(u.y-2),"l",G(u.x)+1,", ",G(u.y-2)][J](k),g=u.x-G(this.W/2),m=u.y-this.H/2,T=this.W,D=this.H;break;case"rect":case"path":if(!this.attrs.path)g=0,m=0,T=this.paper.width,D=this.paper.height;else{var N=He(this.attrs.path);g=N.x,m=N.y,T=N.width,D=N.height}break;default:g=0,m=0,T=this.paper.width,D=this.paper.height;break}r=r??g+T/2,l=l??m+D/2;var F=r-this.paper.width/2,R=l-this.paper.height/2,A;c.left!=(A=F+"px")&&(c.left=A),c.top!=(A=R+"px")&&(c.top=A),this.X=Ce[f](this.type)?-F:g,this.Y=Ce[f](this.type)?-R:m,this.W=T,this.H=D,Ce[f](this.type)?(d.left!=(A=-F*he+"px")&&(d.left=A),d.top!=(A=-R*he+"px")&&(d.top=A)):this.type=="text"?(d.left!=(A=-F+"px")&&(d.left=A),d.top!=(A=-R+"px")&&(d.top=A)):(c.width!=(A=this.paper.width+"px")&&(c.width=A),c.height!=(A=this.paper.height+"px")&&(c.height=A),d.left!=(A=g-F+"px")&&(d.left=A),d.top!=(A=m-R+"px")&&(d.top=A),d.width!=(A=T+"px")&&(d.width=A),d.height!=(A=D+"px")&&(d.height=A))},ft.hide=function(){return!this.removed&&(this.Group.style.display="none"),this},ft.show=function(){return!this.removed&&(this.Group.style.display="block"),this},ft.getBBox=function(){return this.removed?this:Ce[f](this.type)?He(this.attrs.path):{x:this.X+(this.bbx||0),y:this.Y,width:this.W,height:this.H}},ft.remove=function(){if(!this.removed){ce(this,this.paper),this.node.parentNode.removeChild(this.node),this.Group.parentNode.removeChild(this.Group),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var s in this)delete this[s];this.removed=!0}},ft.attr=function(s,r){if(this.removed)return this;if(s==null){var l={};for(var c in this.attrs)this.attrs[f](c)&&(l[c]=this.attrs[c]);return this._.rt.deg&&(l.rotation=this.rotate()),(this._.sx!=1||this._.sy!=1)&&(l.scale=this.scale()),l.gradient&&l.fill=="none"&&(l.fill=l.gradient)&&delete l.gradient,l}if(r==null&&t.is(s,"string"))return s=="translation"?$e.call(this):s=="rotation"?this.rotate():s=="scale"?this.scale():s==Lt&&this.attrs.fill=="none"&&this.attrs.gradient?this.attrs.gradient:this.attrs[s];if(this.attrs&&r==null&&t.is(s,pt)){var d,p={};for(c=0,d=s[I];c<d;c++)p[s[c]]=this.attr(s[c]);return p}var u;if(r!=null&&(u={},u[s]=r),r==null&&t.is(s,"object")&&(u=s),u){for(var g in this.paper.customAttributes)if(this.paper.customAttributes[f](g)&&u[f](g)&&t.is(this.paper.customAttributes[g],"function")){var m=this.paper.customAttributes[g].apply(this,[][C](u[g]));this.attrs[g]=u[g];for(var T in m)m[f](T)&&(u[T]=m[T])}u.text&&this.type=="text"&&(this.node.string=u.text),Kt(this,u),u.gradient&&({circle:1,ellipse:1}[f](this.type)||B(u.gradient).charAt()!="r")&&_e(this,u.gradient),(!Ce[f](this.type)||this._.rt.deg)&&this.setBox(this.attrs)}return this},ft.toFront=function(){return!this.removed&&this.Group.parentNode[S](this.Group),this.paper.top!=this&&cs(this,this.paper),this},ft.toBack=function(){return this.removed?this:(this.Group.parentNode.firstChild!=this.Group&&(this.Group.parentNode.insertBefore(this.Group,this.Group.parentNode.firstChild),hs(this,this.paper)),this)},ft.insertAfter=function(s){return this.removed?this:(s.constructor==It&&(s=s[s.length-1]),s.Group.nextSibling?s.Group.parentNode.insertBefore(this.Group,s.Group.nextSibling):s.Group.parentNode[S](this.Group),us(this,s,this.paper),this)},ft.insertBefore=function(s){return this.removed?this:(s.constructor==It&&(s=s[0]),s.Group.parentNode.insertBefore(this.Group,s.Group),fs(this,s,this.paper),this)},ft.blur=function(s){var r=this.node.runtimeStyle,l=r.filter;l=l.replace(Vn,k),+s!=0?(this.attrs.blur=s,r.filter=l+V+dt+".Blur(pixelradius="+(+s||1.5)+")",r.margin=t.format("-{0}px 0 0 -{0}px",G(+s||1.5))):(r.filter=l,r.margin=0,delete this.attrs.blur)},ms=function(s,r,l,c){var d=_t("group"),p=_t("oval");p.style,d.style.cssText="position:absolute;left:0;top:0;width:"+s.width+"px;height:"+s.height+"px",d.coordsize=ke,d.coordorigin=s.coordorigin,d[S](p);var u=new gt(p,d,s);return u.type="circle",Kt(u,{stroke:"#000",fill:"none"}),u.attrs.cx=r,u.attrs.cy=l,u.attrs.r=c,u.setBox({x:r-c,y:l-c,width:c*2,height:c*2}),s.canvas[S](d),u},vs=function(s,r,l,c,d,p){var u=n(r,l,c,d,p),g=s.path(u),m=g.attrs;return g.X=m.x=r,g.Y=m.y=l,g.W=m.width=c,g.H=m.height=d,m.r=p,m.path=u,g.type="rect",g},bs=function(s,r,l,c,d){var p=_t("group"),u=_t("oval");u.style,p.style.cssText="position:absolute;left:0;top:0;width:"+s.width+"px;height:"+s.height+"px",p.coordsize=ke,p.coordorigin=s.coordorigin,p[S](u);var g=new gt(u,p,s);return g.type="ellipse",Kt(g,{stroke:"#000"}),g.attrs.cx=r,g.attrs.cy=l,g.attrs.rx=c,g.attrs.ry=d,g.setBox({x:r-c,y:l-d,width:c*2,height:d*2}),s.canvas[S](p),g},ys=function(s,r,l,c,d,p){var u=_t("group"),g=_t("image");u.style.cssText="position:absolute;left:0;top:0;width:"+s.width+"px;height:"+s.height+"px",u.coordsize=ke,u.coordorigin=s.coordorigin,g.src=r,u[S](g);var m=new gt(g,u,s);return m.type="image",m.attrs.src=r,m.attrs.x=l,m.attrs.y=c,m.attrs.w=d,m.attrs.h=p,m.setBox({x:l,y:c,width:d,height:p}),s.canvas[S](u),m},xs=function(s,r,l,c){var d=_t("group"),p=_t("shape"),u=p.style,g=_t("path");g.style;var m=_t("textpath");d.style.cssText="position:absolute;left:0;top:0;width:"+s.width+"px;height:"+s.height+"px",d.coordsize=ke,d.coordorigin=s.coordorigin,g.v=t.format("m{0},{1}l{2},{1}",G(r*10),G(l*10),G(r*10)+1),g.textpathok=!0,u.width=s.width,u.height=s.height,m.string=B(c),m.on=!0,p[S](m),p[S](g),d[S](p);var T=new gt(m,d,s);return T.shape=p,T.textpath=g,T.type="text",T.attrs.text=c,T.attrs.x=r,T.attrs.y=l,T.attrs.w=1,T.attrs.h=1,Kt(T,{font:Mt.font,stroke:"none",fill:"#000"}),T.setBox(),s.canvas[S](d),T},ws=function(s,r){var l=this.canvas.style;return s==+s&&(s+="px"),r==+r&&(r+="px"),l.width=s,l.height=r,l.clip="rect(0 "+s+" "+r+" 0)",this};var _t;v.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!v.namespaces.rvml&&v.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),_t=function(s){return v.createElement("<rvml:"+s+' class="rvml">')}}catch{_t=function(r){return v.createElement("<"+r+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}mi=function(){var s=ls[E](0,arguments),r=s.container,l=s.height,c=s.width,d=s.x,p=s.y;if(!r)throw new Error("VML container not found.");var u=new M,g=u.canvas=v.createElement("div"),m=g.style;return d=d||0,p=p||0,c=c||512,l=l||342,c==+c&&(c+="px"),l==+l&&(l+="px"),u.width=1e3,u.height=1e3,u.coordsize=he*1e3+V+he*1e3,u.coordorigin="0 0",u.span=v.createElement("span"),u.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",g[S](u.span),m.cssText=t.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",c,l),r==1?(v.body[S](g),m.left=d+"px",m.top=p+"px",m.position="absolute"):r.firstChild?r.insertBefore(g,r.firstChild):r[S](g),pi.call(u,u,t.fn),u},w.clear=function(){this.canvas.innerHTML=k,this.span=v.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas[S](this.span),this.bottom=this.top=null},w.remove=function(){this.canvas.parentNode.removeChild(this.canvas);for(var s in this)this[s]=ds(s);return!0}}var Ss=navigator.userAgent.match(/Version\/(.*?)\s/);navigator.vendor=="Apple Computer, Inc."&&(Ss&&Ss[1]<4||navigator.platform.slice(0,2)=="iP")?w.safari=function(){var n=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});x.setTimeout(function(){n.remove()})}:w.safari=function(){};for(var zn=function(){this.returnValue=!1},Hn=function(){return this.originalEvent.preventDefault()},Yn=function(){this.cancelBubble=!0},Xn=function(){return this.originalEvent.stopPropagation()},Un=function(){if(v.addEventListener)return function(n,s,r,l){var c=L&&tt[s]?tt[s]:s,d=function(p){if(L&&tt[f](s)){for(var u=0,g=p.targetTouches&&p.targetTouches.length;u<g;u++)if(p.targetTouches[u].target==n){var m=p;p=p.targetTouches[u],p.originalEvent=m,p.preventDefault=Hn,p.stopPropagation=Xn;break}}return r.call(l,p)};return n.addEventListener(c,d,!1),function(){return n.removeEventListener(c,d,!1),!0}};if(v.attachEvent)return function(n,s,r,l){var c=function(p){return p=p||x.event,p.preventDefault=p.preventDefault||zn,p.stopPropagation=p.stopPropagation||Yn,r.call(l,p)};n.attachEvent("on"+s,c);var d=function(){return n.detachEvent("on"+s,c),!0};return d}}(),Bt=[],vi=function(n){for(var s=n.clientX,r=n.clientY,l=v.documentElement.scrollTop||v.body.scrollTop,c=v.documentElement.scrollLeft||v.body.scrollLeft,d,p=Bt.length;p--;){if(d=Bt[p],L){for(var u=n.touches.length,g;u--;)if(g=n.touches[u],g.identifier==d.el._drag.id){s=g.clientX,r=g.clientY,(n.originalEvent?n.originalEvent:n).preventDefault();break}}else n.preventDefault();s+=c,r+=l,d.move&&d.move.call(d.move_scope||d.el,s-d.el._drag.x,r-d.el._drag.y,s,r,n)}},bi=function(n){t.unmousemove(vi).unmouseup(bi);for(var s=Bt.length,r;s--;)r=Bt[s],r.el._drag={},r.end&&r.end.call(r.end_scope||r.start_scope||r.move_scope||r.el,n);Bt=[]},Ts=j[I];Ts--;)(function(n){t[n]=gt[h][n]=function(s,r){return t.is(s,"function")&&(this.events=this.events||[],this.events.push({name:n,f:s,unbind:Un(this.shape||this.node||v,n,s,r||this)})),this},t["un"+n]=gt[h]["un"+n]=function(s){for(var r=this.events,l=r[I];l--;)if(r[l].name==n&&r[l].f==s)return r[l].unbind(),r.splice(l,1),!r.length&&delete this.events,this;return this}})(j[Ts]);ft.hover=function(n,s,r,l){return this.mouseover(n,r).mouseout(s,l||r)},ft.unhover=function(n,s){return this.unmouseover(n).unmouseout(s)},ft.drag=function(n,s,r,l,c,d){return this._drag={},this.mousedown(function(p){(p.originalEvent||p).preventDefault();var u=v.documentElement.scrollTop||v.body.scrollTop,g=v.documentElement.scrollLeft||v.body.scrollLeft;this._drag.x=p.clientX+g,this._drag.y=p.clientY+u,this._drag.id=p.identifier,s&&s.call(c||l||this,p.clientX+g,p.clientY+u,p),!Bt.length&&t.mousemove(vi).mouseup(bi),Bt.push({el:this,move:n,end:r,move_scope:l,start_scope:c,end_scope:d})}),this},ft.undrag=function(n,s,r){for(var l=Bt.length;l--;)Bt[l].el==this&&Bt[l].move==n&&Bt[l].end==r&&Bt.splice(l++,1);!Bt.length&&t.unmousemove(vi).unmouseup(bi)},w.circle=function(n,s,r){return ms(this,n||0,s||0,r||0)},w.rect=function(n,s,r,l,c){return vs(this,n||0,s||0,r||0,l||0,c||0)},w.ellipse=function(n,s,r,l){return bs(this,n||0,s||0,r||0,l||0)},w.path=function(n){return n&&!t.is(n,W)&&!t.is(n[0],pt)&&(n+=k),ps(t.format[E](t,arguments),this)},w.image=function(n,s,r,l,c){return ys(this,n||"about:blank",s||0,r||0,l||0,c||0)},w.text=function(n,s,r){return xs(this,n||0,s||0,B(r))},w.set=function(n){return arguments[I]>1&&(n=Array[h].splice.call(arguments,0,arguments[I])),new It(n)},w.setSize=ws,w.top=w.bottom=null,w.raphael=t;function _s(){return this.x+V+this.y}ft.resetScale=function(){if(this.removed)return this;this._.sx=1,this._.sy=1,this.attrs.scale="1 1"},ft.scale=function(n,s,r,l){if(this.removed)return this;if(n==null&&s==null)return{x:this._.sx,y:this._.sy,toString:_s};s=s||n,!+s&&(s=n);var c,d,p=this.attrs;if(n!=0){var u=this.getBBox(),g=u.x+u.width/2,m=u.y+u.height/2,T=nt(n/this._.sx),D=nt(s/this._.sy);r=+r||r==0?r:g,l=+l||l==0?l:m;var N=this._.sx>0,F=this._.sy>0,R=~~(n/nt(n)),A=~~(s/nt(s)),_=T*R,q=D*A,U=this.node.style,it=r+nt(g-r)*_*(g>r==N?1:-1),Z=l+nt(m-l)*q*(m>l==F?1:-1),mt=n*R>s*A?D:T;switch(this.type){case"rect":case"image":var ut=p.width*T,yt=p.height*D;this.attr({height:yt,r:p.r*mt,width:ut,x:it-ut/2,y:Z-yt/2});break;case"circle":case"ellipse":this.attr({rx:p.rx*T,ry:p.ry*D,r:p.r*mt,cx:it,cy:Z});break;case"text":this.attr({x:it,y:Z});break;case"path":for(var at=di(p.path),St=!0,Dt=N?_:T,Yt=F?q:D,Zt=0,Qt=at[I];Zt<Qt;Zt++){var At=at[Zt],ue=xt.call(At[0]);if(!(ue=="M"&&St))if(St=!1,ue=="A")At[at[Zt][I]-2]*=Dt,At[at[Zt][I]-1]*=Yt,At[1]*=T,At[2]*=D,At[5]=+(R+A?!!+At[5]:!+At[5]);else if(ue=="H")for(var Nt=1,te=At[I];Nt<te;Nt++)At[Nt]*=Dt;else if(ue=="V")for(Nt=1,te=At[I];Nt<te;Nt++)At[Nt]*=Yt;else for(Nt=1,te=At[I];Nt<te;Nt++)At[Nt]*=Nt%2?Dt:Yt}var oe=He(at);c=it-oe.x-oe.width/2,d=Z-oe.y-oe.height/2,at[0][1]+=c,at[0][2]+=d,this.attr({path:at});break}this.type in{text:1,image:1}&&(R!=1||A!=1)?this.transformations?(this.transformations[2]="scale("[C](R,",",A,")"),i(this.node,"transform",this.transformations[J](V)),c=R==-1?-p.x-(ut||0):p.x,d=A==-1?-p.y-(yt||0):p.y,this.attr({x:c,y:d}),p.fx=R-1,p.fy=A-1):(this.node.filterMatrix=dt+".Matrix(M11="[C](R,", M12=0, M21=0, M22=",A,", Dx=0, Dy=0, sizingmethod='auto expand', filtertype='bilinear')"),U.filter=(this.node.filterMatrix||k)+(this.node.filterOpacity||k)):this.transformations?(this.transformations[2]=k,i(this.node,"transform",this.transformations[J](V)),p.fx=0,p.fy=0):(this.node.filterMatrix=k,U.filter=(this.node.filterMatrix||k)+(this.node.filterOpacity||k)),p.scale=[n,s,r,l][J](V),this._.sx=n,this._.sy=s}return this},ft.clone=function(){if(this.removed)return null;var n=this.attr();return delete n.scale,delete n.translation,this.paper[this.type]().attr(n)};var yi={},Ze=function(n,s,r,l,c,d,p,u,g){if(n===r&&s===l&&c===p&&d==u){var m=p-n,T=u-s,D=Math.sqrt(m*m+T*T);if(g==null)return D;var N=g/D;return{start:{x:n,y:s},m:{x:n,y:s},n:{x:p,y:u},end:{x:p,y:u},x:n+N*m,y:s+N*T,alpha:90-X.atan(m/T)*180/lt}}var F=0,R=100,A=[n,s,r,l,c,d,p,u].join(),_=yi[A],q,U;if(!_&&(yi[A]=_={data:[]}),_.timer&&clearTimeout(_.timer),_.timer=setTimeout(function(){delete yi[A]},2e3),g!=null){var it=Ze(n,s,r,l,c,d,p,u);R=~~it*10}for(var Z=0;Z<R+1;Z++){if(_.data[g]>Z?U=_.data[Z*R]:(U=t.findDotsAtSegment(n,s,r,l,c,d,p,u,Z/R),_.data[Z]=U),Z&&(F+=$($(q.x-U.x,2)+$(q.y-U.y,2),.5)),g!=null&&F>=g)return U;q=U}if(g==null)return F},xi=function(n,s){return function(r,l,c){r=qe(r);for(var d,p,u,g,m="",T={},D,N=0,F=0,R=r.length;F<R;F++){if(u=r[F],u[0]=="M")d=+u[1],p=+u[2];else{if(g=Ze(d,p,u[1],u[2],u[3],u[4],u[5],u[6]),N+g>l){if(s&&!T.start){if(D=Ze(d,p,u[1],u[2],u[3],u[4],u[5],u[6],l-N),m+=["C",D.start.x,D.start.y,D.m.x,D.m.y,D.x,D.y],c)return m;T.start=m,m=["M",D.x,D.y+"C",D.n.x,D.n.y,D.end.x,D.end.y,u[5],u[6]][J](),N+=g,d=+u[5],p=+u[6];continue}if(!n&&!s)return D=Ze(d,p,u[1],u[2],u[3],u[4],u[5],u[6],l-N),{x:D.x,y:D.y,alpha:D.alpha}}N+=g,d=+u[5],p=+u[6]}m+=u}return T.end=m,D=n?N:s?T:t.findDotsAtSegment(d,p,u[1],u[2],u[3],u[4],u[5],u[6],1),D.alpha&&(D={x:D.x,y:D.y,alpha:D.alpha}),D}},ks=xi(1),We=xi(),wi=xi(0,1);ft.getTotalLength=function(){if(this.type=="path")return this.node.getTotalLength?this.node.getTotalLength():ks(this.attrs.path)},ft.getPointAtLength=function(n){if(this.type=="path")return We(this.attrs.path,n)},ft.getSubpath=function(n,s){if(this.type=="path"){if(nt(this.getTotalLength()-s)<"1e-6")return wi(this.attrs.path,n).end;var r=wi(this.attrs.path,s,1);return n?wi(r,n).end:r}},t.easing_formulas={linear:function(n){return n},"<":function(n){return $(n,3)},">":function(n){return $(n-1,3)+1},"<>":function(n){return n=n*2,n<1?$(n,3)/2:(n-=2,($(n,3)+2)/2)},backIn:function(n){var s=1.70158;return n*n*((s+1)*n-s)},backOut:function(n){n=n-1;var s=1.70158;return n*n*((s+1)*n+s)+1},elastic:function(n){if(n==0||n==1)return n;var s=.3,r=s/4;return $(2,-10*n)*X.sin((n-r)*(2*lt)/s)+1},bounce:function(n){var s=7.5625,r=2.75,l;return n<1/r?l=s*n*n:n<2/r?(n-=1.5/r,l=s*n*n+.75):n<2.5/r?(n-=2.25/r,l=s*n*n+.9375):(n-=2.625/r,l=s*n*n+.984375),l}};var Vt=[],Cs=function(){for(var n=+new Date,s=0;s<Vt[I];s++){var r=Vt[s];if(!(r.stop||r.el.removed)){var l=n-r.start,c=r.ms,d=r.easing,p=r.from,u=r.diff,g=r.to,m=r.t,T=r.el,D={},N;if(l<c){var F=d(l/c);for(var R in p)if(p[f](R)){switch(Ct[R]){case"along":N=F*c*u[R],g.back&&(N=g.len-N);var A=We(g[R],N);T.translate(u.sx-u.x||0,u.sy-u.y||0),u.x=A.x,u.y=A.y,T.translate(A.x-u.sx,A.y-u.sy),g.rot&&T.rotate(u.r+A.alpha,A.x,A.y);break;case rt:N=+p[R]+F*c*u[R];break;case"colour":N="rgb("+[Mi(G(p[R].r+F*c*u[R].r)),Mi(G(p[R].g+F*c*u[R].g)),Mi(G(p[R].b+F*c*u[R].b))][J](",")+")";break;case"path":N=[];for(var _=0,q=p[R][I];_<q;_++){N[_]=[p[R][_][0]];for(var U=1,it=p[R][_][I];U<it;U++)N[_][U]=+p[R][_][U]+F*c*u[R][_][U];N[_]=N[_][J](V)}N=N[J](V);break;case"csv":switch(R){case"translation":var Z=F*c*u[R][0]-m.x,mt=F*c*u[R][1]-m.y;m.x+=Z,m.y+=mt,N=Z+V+mt;break;case"rotation":N=+p[R][0]+F*c*u[R][0],p[R][1]&&(N+=","+p[R][1]+","+p[R][2]);break;case"scale":N=[+p[R][0]+F*c*u[R][0],+p[R][1]+F*c*u[R][1],2 in g[R]?g[R][2]:k,3 in g[R]?g[R][3]:k][J](V);break;case"clip-rect":for(N=[],_=4;_--;)N[_]=+p[R][_]+F*c*u[R][_];break}break;default:var ut=[].concat(p[R]);for(N=[],_=T.paper.customAttributes[R].length;_--;)N[_]=+ut[_]+F*c*u[R][_];break}D[R]=N}T.attr(D),T._run&&T._run.call(T)}else g.along&&(A=We(g.along,g.len*!g.back),T.translate(u.sx-(u.x||0)+A.x-u.sx,u.sy-(u.y||0)+A.y-u.sy),g.rot&&T.rotate(u.r+A.alpha,A.x,A.y)),(m.x||m.y)&&T.translate(-m.x,-m.y),g.scale&&(g.scale+=k),T.attr(g),Vt.splice(s--,1)}}t.svg&&T&&T.paper&&T.paper.safari(),Vt[I]&&setTimeout(Cs)},qn=function(n,s,r,l,c){var d=r-l;s.timeouts.push(setTimeout(function(){t.is(c,"function")&&c.call(s),s.animate(n,d,n.easing)},l))},Mi=function(n){return z(st(n,255),0)},$e=function(n,s){if(n==null)return{x:this._.tx,y:this._.ty,toString:_s};switch(this._.tx+=+n,this._.ty+=+s,this.type){case"circle":case"ellipse":this.attr({cx:+n+this.attrs.cx,cy:+s+this.attrs.cy});break;case"rect":case"image":case"text":this.attr({x:+n+this.attrs.x,y:+s+this.attrs.y});break;case"path":var r=di(this.attrs.path);r[0][1]+=+n,r[0][2]+=+s,this.attr({path:r});break}return this};ft.animateWith=function(n,s,r,l,c){for(var d=0,p=Vt.length;d<p;d++)Vt[d].el.id==n.id&&(s.start=Vt[d].start);return this.animate(s,r,l,c)},ft.animateAlong=As(),ft.animateAlongBack=As(1);function As(n){return function(s,r,l,c){var d={back:n};return t.is(l,"function")?c=l:d.rot=l,s&&s.constructor==gt&&(s=s.attrs.path),s&&(d.along=s),this.animate(d,r,c)}}function Zn(n,s,r,l,c,d){var p=3*s,u=3*(l-s)-p,g=1-p-u,m=3*r,T=3*(c-r)-m,D=1-m-T;function N(A){return((g*A+u)*A+p)*A}function F(A,_){var q=R(A,_);return((D*q+T)*q+m)*q}function R(A,_){var q,U,it,Z,mt,ut;for(it=A,ut=0;ut<8;ut++){if(Z=N(it)-A,nt(Z)<_)return it;if(mt=(3*g*it+2*u)*it+p,nt(mt)<1e-6)break;it=it-Z/mt}if(q=0,U=1,it=A,it<q)return q;if(it>U)return U;for(;q<U;){if(Z=N(it),nt(Z-A)<_)return it;A>Z?q=it:U=it,it=(U-q)/2+q}return it}return F(n,1/(200*d))}ft.onAnimation=function(n){return this._run=n||0,this},ft.animate=function(n,s,r,l){var c=this;if(c.timeouts=c.timeouts||[],(t.is(r,"function")||!r)&&(l=r||null),c.removed)return l&&l.call(c),c;var d={},p={},u=!1,g={};for(var m in n)if(n[f](m)&&(Ct[f](m)||c.paper.customAttributes[f](m)))switch(u=!0,d[m]=c.attr(m),d[m]==null&&(d[m]=Mt[m]),p[m]=n[m],Ct[m]){case"along":var T=ks(n[m]),D=We(n[m],T*!!n.back),N=c.getBBox();g[m]=T/s,g.tx=N.x,g.ty=N.y,g.sx=D.x,g.sy=D.y,p.rot=n.rot,p.back=n.back,p.len=T,n.rot&&(g.r=Y(c.rotate())||0);break;case rt:g[m]=(p[m]-d[m])/s;break;case"colour":d[m]=t.getRGB(d[m]);var F=t.getRGB(p[m]);g[m]={r:(F.r-d[m].r)/s,g:(F.g-d[m].g)/s,b:(F.b-d[m].b)/s};break;case"path":var R=qe(d[m],p[m]);d[m]=R[0];var A=R[1];g[m]=[];for(var _=0,q=d[m][I];_<q;_++){g[m][_]=[0];for(var U=1,it=d[m][_][I];U<it;U++)g[m][_][U]=(A[_][U]-d[m][_][U])/s}break;case"csv":var Z=B(n[m])[O](e),mt=B(d[m])[O](e);switch(m){case"translation":d[m]=[0,0],g[m]=[Z[0]/s,Z[1]/s];break;case"rotation":d[m]=mt[1]==Z[1]&&mt[2]==Z[2]?mt:[0,Z[1],Z[2]],g[m]=[(Z[0]-d[m][0])/s,0,0];break;case"scale":n[m]=Z,d[m]=B(d[m])[O](e),g[m]=[(Z[0]-d[m][0])/s,(Z[1]-d[m][1])/s,0,0];break;case"clip-rect":for(d[m]=B(d[m])[O](e),g[m]=[],_=4;_--;)g[m][_]=(Z[_]-d[m][_])/s;break}p[m]=Z;break;default:for(Z=[].concat(n[m]),mt=[].concat(d[m]),g[m]=[],_=c.paper.customAttributes[m][I];_--;)g[m][_]=((Z[_]||0)-(mt[_]||0))/s;break}if(u){var St=t.easing_formulas[r];if(!St)if(St=B(r).match(ae),St&&St[I]==5){var Dt=St;St=function(Yt){return Zn(Yt,+Dt[1],+Dt[2],+Dt[3],+Dt[4],s)}}else St=function(Yt){return Yt};Vt.push({start:n.start||+new Date,ms:s,easing:St,from:d,diff:g,to:p,el:c,t:{x:0,y:0}}),t.is(l,"function")&&(c._ac=setTimeout(function(){l.call(c)},s)),Vt[I]==1&&setTimeout(Cs)}else{var ut=[],yt;for(var at in n)n[f](at)&&Se.test(at)&&(m={value:n[at]},at=="from"&&(at=0),at=="to"&&(at=100),m.key=et(at,10),ut.push(m));for(ut.sort(In),ut[0].key&&ut.unshift({key:0,value:c.attrs}),_=0,q=ut[I];_<q;_++)qn(ut[_].value,c,s/100*ut[_].key,s/100*(ut[_-1]&&ut[_-1].key||0),ut[_-1]&&ut[_-1].value.callback);yt=ut[ut[I]-1].value.callback,yt&&c.timeouts.push(setTimeout(function(){yt.call(c)},s))}return this},ft.stop=function(){for(var n=0;n<Vt.length;n++)Vt[n].el.id==this.id&&Vt.splice(n--,1);for(n=0,ii=this.timeouts&&this.timeouts.length;n<ii;n++)clearTimeout(this.timeouts[n]);return this.timeouts=[],clearTimeout(this._ac),delete this._ac,this},ft.translate=function(n,s){return this.attr({translation:n+" "+s})},ft[wt]=function(){return"Raphaël’s object"},t.ae=Vt;var It=function(n){if(this.items=[],this[I]=0,this.type="set",n)for(var s=0,r=n[I];s<r;s++)n[s]&&(n[s].constructor==gt||n[s].constructor==It)&&(this[this.items[I]]=this.items[this.items[I]]=n[s],this[I]++)};It[h][K]=function(){for(var n,s,r=0,l=arguments[I];r<l;r++)n=arguments[r],n&&(n.constructor==gt||n.constructor==It)&&(s=this.items[I],this[s]=this.items[s]=n,this[I]++);return this},It[h].pop=function(){return delete this[this[I]--],this.items.pop()};for(var Si in ft)ft[f](Si)&&(It[h][Si]=function(n){return function(){for(var s=0,r=this.items[I];s<r;s++)this.items[s][n][E](this.items[s],arguments);return this}}(Si));return It[h].attr=function(n,s){if(n&&t.is(n,pt)&&t.is(n[0],"object"))for(var r=0,l=n[I];r<l;r++)this.items[r].attr(n[r]);else for(var c=0,d=this.items[I];c<d;c++)this.items[c].attr(n,s);return this},It[h].animate=function(n,s,r,l){(t.is(r,"function")||!r)&&(l=r||null);var c=this.items[I],d=c,p,u=this,g;for(l&&(g=function(){!--c&&l.call(u)}),r=t.is(r,W)?r:g,p=this.items[--d].animate(n,s,r,g);d--;)this.items[d]&&!this.items[d].removed&&this.items[d].animateWith(p,n,s,r,g);return this},It[h].insertAfter=function(n){for(var s=this.items[I];s--;)this.items[s].insertAfter(n);return this},It[h].getBBox=function(){for(var n=[],s=[],r=[],l=[],c=this.items[I];c--;){var d=this.items[c].getBBox();n[K](d.x),s[K](d.y),r[K](d.x+d.width),l[K](d.y+d.height)}return n=st[E](0,n),s=st[E](0,s),{x:n,y:s,width:z[E](0,r)-n,height:z[E](0,l)-s}},It[h].clone=function(n){n=new It;for(var s=0,r=this.items[I];s<r;s++)n[K](this.items[s].clone());return n},t.registerFont=function(n){if(!n.face)return n;this.fonts=this.fonts||{};var s={w:n.w,face:{},glyphs:{}},r=n.face["font-family"];for(var l in n.face)n.face[f](l)&&(s.face[l]=n.face[l]);if(this.fonts[r]?this.fonts[r][K](s):this.fonts[r]=[s],!n.svg){s.face["units-per-em"]=et(n.face["units-per-em"],10);for(var c in n.glyphs)if(n.glyphs[f](c)){var d=n.glyphs[c];if(s.glyphs[c]={w:d.w,k:{},d:d.d&&"M"+d.d[vt](/[mlcxtrv]/g,function(u){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[u]||"M"})+"z"},d.k)for(var p in d.k)d[f](p)&&(s.glyphs[c].k[p]=d.k[p])}}return n},w.getFont=function(n,s,r,l){if(l=l||"normal",r=r||"normal",s=+s||{normal:400,bold:700,lighter:300,bolder:800}[s]||400,!!t.fonts){var c=t.fonts[n];if(!c){var d=new RegExp("(^|\\s)"+n[vt](/[^\w\d\s+!~.:_-]/g,k)+"(\\s|$)","i");for(var p in t.fonts)if(t.fonts[f](p)&&d.test(p)){c=t.fonts[p];break}}var u;if(c)for(var g=0,m=c[I];g<m&&(u=c[g],!(u.face["font-weight"]==s&&(u.face["font-style"]==r||!u.face["font-style"])&&u.face["font-stretch"]==l));g++);return u}},w.print=function(n,s,r,l,c,d,p){d=d||"middle",p=z(st(p||0,1),-1);var u=this.set(),g=B(r)[O](k),m=0,T;if(t.is(l,r)&&(l=this.getFont(l)),l){T=(c||16)/l.face["units-per-em"];for(var D=l.face.bbox.split(e),N=+D[0],F=+D[1]+(d=="baseline"?D[3]-D[1]+ +l.face.descent:(D[3]-D[1])/2),R=0,A=g[I];R<A;R++){var _=R&&l.glyphs[g[R-1]]||{},q=l.glyphs[g[R]];m+=R?(_.w||l.w)+(_.k&&_.k[g[R]]||0)+l.w*p:0,q&&q.d&&u[K](this.path(q.d).attr({fill:"#000",stroke:"none",translation:[m,0]}))}u.scale(T,T,N,F).translate(n-N,s-F)}return u},t.format=function(n,s){var r=t.is(s,pt)?[0][C](s):arguments;return n&&t.is(n,W)&&r[I]-1&&(n=n[vt](a,function(l,c){return r[++c]==null?k:r[c]})),n||k},t.ninja=function(){return y.was?x.Raphael=y.is:Raphael=void 0,t},t.el=ft,t.st=It[h],t}(),H={BLUE:"#6495ED",ORANGE:"#FFA500",PINK:"#FF00AF",GREEN:"#28AE7B",PURPLE:"#9D38BD",RED:"#DF0030",GRAY:"gray",BLACK:"black",LIGHT_BLUE:"#9AB8ED",LIGHT_ORANGE:"#EDD19B",LIGHT_PINK:"#ED9BD3",LIGHT_GREEN:"#9BEDCE",LIGHT_PURPLE:"#DA9BED",LIGHT_RED:"#ED9AAC",LIGHT_GRAY:"#ED9B9B",LIGHT_BLACK:"#ED9B9B",GRAY10:"#D6D6D6",GRAY20:"#CDCDCD",GRAY30:"#B3B3B3",GRAY40:"#9A9A9A",GRAY50:"#808080",GRAY60:"#666666",GRAY70:"#4D4D4D",GRAY80:"#333333",GRAY90:"#1A1A1A",BLUE_A:"#CCFAFF",BLUE_B:"#80F6FF",BLUE_C:"#63D9EA",BLUE_D:"#11ACCD",BLUE_E:"#0C7F99",TEAL_A:"#94FFF5",TEAL_B:"#26EDD5",TEAL_C:"#01D1C1",TEAL_D:"#01A995",TEAL_E:"#208170",GREEN_A:"#B6FFB0",GREEN_B:"#8AF281",GREEN_C:"#74CF70",GREEN_D:"#1FAB54",GREEN_E:"#0D923F",GOLD_A:"#FFD0A9",GOLD_B:"#FFBB71",GOLD_C:"#FF9C39",GOLD_D:"#E07D10",GOLD_E:"#A75A05",RED_A:"#FCA9A9",RED_B:"#FF8482",RED_C:"#F9685D",RED_D:"#E84D39",RED_E:"#BC2612",MAROON_A:"#FFBDE0",MAROON_B:"#FF92C6",MAROON_C:"#ED5FA6",MAROON_D:"#CA337C",MAROON_E:"#9E034E",PURPLE_A:"#DDD7FF",PURPLE_B:"#C6B9FC",PURPLE_C:"#AA87FF",PURPLE_D:"#7854AB",PURPLE_E:"#543B78",MINT_A:"#F5F9E8",MINT_B:"#EDF2DF",MINT_C:"#E0E5CC",GRAY_A:"#F6F7F7",GRAY_B:"#F0F1F2",GRAY_C:"#E3E5E6",GRAY_D:"#D6D8DA",GRAY_E:"#BABEC2",GRAY_F:"#888D93",GRAY_G:"#626569",GRAY_H:"#3B3E40",GRAY_I:"#21242C",KA_BLUE:"#314453",KA_GREEN:"#71B307",_BACKGROUND:"#FDFDFD",INTERACTING:"#71B307",INTERACTIVE:"#71B307",DYNAMIC:"#6495ED"};class ko{constructor(t,e,o){this.scaleVector=a=>{if(typeof a=="number")return this.scaleVector([a,a]);const h=a[0],f=a[1];return[h*this.xScale,f*this.yScale]},this.scalePoint=a=>{if(typeof a=="number")return this.scalePoint([a,a]);const h=a[0],f=a[1];return[(h-this.bounds.xMin)*this.xScale,(this.bounds.yMax-f)*this.yScale]},this.unscalePoint=a=>{if(typeof a=="number")return this.unscalePoint([a,a]);const h=a[0],f=a[1];return[h/this.xScale+this.bounds.xMin,this.bounds.yMax-f/this.yScale]},this.unscaleVector=a=>typeof a=="number"?this.unscaleVector([a,a]):[a[0]/this.xScale,a[1]/this.yScale],this.setScale=a=>{typeof a=="number"&&(a=[a,a]),this.xScale=a[0],this.yScale=a[1],this.raphael.setSize(...this.canvasDimensions())},this.canvasDimensions=()=>[this.bounds.width()*this.xScale,this.bounds.height()*this.yScale],this.pixelsPerUnitX=()=>this.xScale,this.pixelsPerUnitY=()=>this.yScale,this.raphael=t,this.bounds=o,this.xScale=e[0],this.yScale=e[1],this.setScale(e)}}class Co{constructor(t,e){this.xMin=t[0],this.xMax=t[1],this.yMin=e[0],this.yMax=e[1]}width(){return this.xMax-this.xMin}height(){return this.yMax-this.yMin}}function un(i,t,e){return rn.render(zt(ro,{throwIfNested:!1,children:i}),t,e)}function Ao(i,t){const e=P(i).find("."+t);return e.length===0?P("<span>").addClass(t).appendTo(P(i)):e}const fn={processMath:async function(i,t,e,o){const a=P(i);if(a.attr("data-math-formula")==null||e){const h=Ao(a,"tex-holder");t==null&&a.attr("data-math-formula")&&(t=a.attr("data-math-formula")),t=t!=null?t+"":"",t=Ut.cleanMath(t),a.attr("data-math-formula",t);const{TeX:f}=await ye();un(ri.createElement(f,{children:t,onRender:o}),h[0])}}},{processMath:Po}=fn;function Fi(i,t){return typeof i=="number"&&(i=[i,i]),t=t*Math.PI/180,[i[0]*Math.cos(t),i[1]*Math.sin(t)]}var ve,be,nn;let Bi=(nn=class{constructor(t){Ti(this,ve,void 0);Ti(this,be,void 0);this.isMobile=!1,this.currentStyle={"stroke-width":2,fill:"none"},this.label=(e,o,a,h,f)=>{const v=typeof h=="object"?h:f,x=typeof h=="boolean"?h:!0;return this.withStyle(v,()=>{const y=P("<span>").addClass("graphie-label"),M=this.currentStyle["label-distance"];y.css({position:"absolute",padding:(M??7)+"px",color:"black"}).data("labelDirection",a).appendTo(this.el),y.setPosition=S=>{const E=this.scalePoint(S);y.css({left:E[0],top:E[1]})},y.setPosition(e);const w=y[0];return y.processMath=function(S,E){Po(w,S,E,function(){const C=w.scrollWidth,L=w.scrollHeight;zs(w,[C,L])})},y.processText=function(S){y.html(S);const E=w.scrollWidth,C=w.scrollHeight;zs(w,[E,C])},x?y.processMath(o,!1):y.processText(o),y})},this.svgPath=(e,o)=>e.map((a,h)=>{if(a===!0)return"z";const f=o?a:this.scalePoint(a);return(h===0?"M":"L")+Ut.bound(f[0])+" "+Ut.bound(f[1])}).join(""),this.svgParabolaPath=(e,o,a)=>{const h=function(V){return(e*V+o)*V+a};if(e===0){const V=[[this.bounds().xMin,h(this.bounds().xMin)],[this.bounds().xMax,h(this.bounds().xMax)]];return this.svgPath(V)}const f=-o/(2*e),v=Math.max(Math.abs(f-this.bounds().xMin),Math.abs(f-this.bounds().xMax)),x=f+v,y=[f,h(f)],M=[x,h(x)],w=[y[0],y[1]-(M[1]-y[1])],S=Math.abs(y[0]-M[0]),E=[y[0]-S,M[1]],C=[y[0]+S,M[1]],k=[E,w,C].map(this.scalePoint).flat().map(Ut.bound);return"M"+k[0]+","+k[1]+" Q"+k[2]+","+k[3]+" "+k[4]+","+k[5]},this.svgSinusoidPath=(e,o,a,h)=>{const f=Math.abs(Math.PI/(2*o)),v=function(k){return e*Math.sin(o*k-a)+h},x=function(k){return e*o*Math.cos(a-o*k)},y=(k,V)=>{const B=k+f*V,O=B+f,j=[B,B*2/3+O*1/3,B*1/3+O*2/3,O],tt=[v(B),v(B)+x(B)*(O-B)/3,v(O)-x(O)*(O-B)/3,v(O)];return Ne(j,tt).map(this.scalePoint)},M=this.bounds().width(),w=Math.ceil(M/f)+1;let S=a/o;const E=S-this.bounds().xMin;S-=f*Math.ceil(E/f);let C=y(S,0),L="M"+C[0][0]+","+C[0][1]+" C"+C[1][0]+","+C[1][1]+" "+C[2][0]+","+C[2][1]+" "+C[3][0]+","+C[3][1];for(let k=1;k<w;k++)C=y(S,k),L+=" C"+C[1][0]+","+C[1][1]+" "+C[2][0]+","+C[2][1]+" "+C[3][0]+","+C[3][1];return L},this.scalePoint=e=>this.drawingTransform().scalePoint(e),this.scaleVector=e=>this.drawingTransform().scaleVector(e),this.unscalePoint=e=>this.drawingTransform().unscalePoint(e),this.unscaleVector=e=>this.drawingTransform().unscaleVector(e),this.el=t,P(t).css("position","relative"),this.raphael=jt(t),P(t).children("div").css("position","absolute")}init(t){let e=t.scale||[40,40];if(e=typeof e=="number"?[e,e]:e,t.range==null)throw new $t("range should be specified in graph init",Ft.Internal);_i(this,ve,new Co(...t.range)),_i(this,be,new ko(this.raphael,e,this.bounds()));const[o,a]=this.drawingTransform().canvasDimensions();return P(this.el).css({width:o,height:a}),this.range=t.range,this.scale=e,this.dimensions=[o,a],this.xpixels=o,this.ypixels=a,this.isMobile=t.isMobile??!1,this}graphInit(t){t=t||{};for(const[z,st]of oo(t))!z.match(/.*Opacity$/)&&z!=="range"&&typeof st=="number"&&(t[z]=[st,st]),(z==="range"||z==="gridRange")&&(t[z]=Pi(t[z]));const e=Pi(t.range||[[-10,10],[-10,10]]),o=Pi(t.gridRange||e),a=t.scale||[20,20],h=t.grid!=null?t.grid:!0,f=t.gridOpacity||.1,v=Lo(t.gridStep||[1,1]),x=t.axes!=null?t.axes:!0,y=t.axisArrows||"",M=t.axisOpacity||1,w=t.axisCenter||[Math.min(Math.max(e[0][0],0),e[0][1]),Math.min(Math.max(e[1][0],0),e[1][1])],S=t.axisLabels!=null?t.axisLabels:!1,E=t.ticks!=null?t.ticks:!0,C=t.tickStep||[2,2],L=t.tickLen||[5,5],k=t.tickOpacity||1,V=t.labels||t.labelStep||!1,B=t.labelStep||[1,1],O=t.labelOpacity||1;let j=t.unityLabels||!1;const tt=t.labelFormat||function(z){return z};let J=t.xLabelFormat||tt,I=t.yLabelFormat||tt;const ot=[[e[0][0]-(e[0][0]>0?1:0),e[0][1]+(e[0][1]<0?1:0)],[e[1][0]-(e[1][0]>0?1:0),e[1][1]+(e[1][1]<0?1:0)]];Array.isArray(j)||(j=[j,j]);const X=function(z){return function(st){return(z(st)+"").replace(/-(\d)/g,"\\llap{-}$1")}};if(J=X(J),I=X(I),this.init({range:ot,scale:a,isMobile:t.isMobile}),h&&this.grid(o[0],o[1],{stroke:t.isMobile?H.GRAY_C:"#000000",opacity:t.isMobile?1:f,step:v,strokeWidth:t.isMobile?1:2}),x){if(y==="<->"||y===!0){const z=this;this.style({stroke:t.isMobile?H.GRAY_G:"#000000",opacity:t.isMobile?1:M,strokeWidth:t.isMobile?1:2,arrows:"->"},function(){e[1][0]<0&&e[1][1]>0&&(z.path([w,[o[0][0],w[1]]]),z.path([w,[o[0][1],w[1]]])),e[0][0]<0&&e[0][1]>0&&(z.path([w,[w[0],o[1][0]]]),z.path([w,[w[0],o[1][1]]]))})}else if(y==="->"||y===""){const z=this;this.style({stroke:"#000000",opacity:M,strokeWidth:2,arrows:y},function(){z.path([[o[0][0],w[1]],[o[0][1],w[1]]]),z.path([[w[0],o[1][0]],[w[0],o[1][1]]])})}S&&S.length===2&&(this.label([o[0][1],w[1]],S[0],"right"),this.label([w[0],o[1][1]],S[1],"above"))}if(E){const z=t.isMobile,st=this;this.style({stroke:t.isMobile?H.GRAY_G:"#000000",opacity:t.isMobile?1:k,strokeWidth:1},()=>{let nt=v[0]*C[0],$=L[0]/a[1],lt=o[0][0],rt=o[0][1];if(e[1][0]<0&&e[1][1]>0){for(let W=nt+w[0];W<=rt;W+=nt)(W<rt||!y)&&st.line([W,-$+w[1]],[W,z?0:$+w[1]]);for(let W=-nt+w[0];W>=lt;W-=nt)(W>lt||!y)&&st.line([W,-$+w[1]],[W,z?0:$+w[1]])}if(nt=v[1]*C[1],$=L[1]/a[0],lt=o[1][0],rt=o[1][1],e[0][0]<0&&e[0][1]>0){for(let W=nt+w[1];W<=rt;W+=nt)(W<rt||!y)&&this.line([-$+w[0],W],[z?0:$+w[0],W]);for(let W=-nt+w[1];W>=lt;W-=nt)(W>lt||!y)&&this.line([-$+w[0],W],[z?0:$+w[0],W])}})}if(V){const z=this;this.style({stroke:t.isMobile?H.GRAY_G:"#000000",opacity:t.isMobile?1:O},function(){let st=v[0]*C[0]*B[0],nt=o[0][0],$=o[0][1];const lt=w[0]<0?"above":"below",rt=w[0]<0?"right":"left",W=w[0]===0&&w[1]!==0,pt=w[0]!==0&&w[1]===0,wt=w[0]!==0||w[1]!==0,Lt=j[0]||wt,re=j[1]||wt;for(let K=(W?0:st)+w[0];K<=$;K+=st)(K<$||!y)&&z.label([K,w[1]],J(K),lt);for(let K=-st*(Lt?1:2)+w[0];K>=nt;K-=st)(K>nt||!y)&&z.label([K,w[1]],J(K),lt);st=v[1]*C[1]*B[1],nt=o[1][0],$=o[1][1];for(let K=(pt?0:st)+w[1];K<=$;K+=st)(K<$||!y)&&z.label([w[0],K],I(K),rt);for(let K=-st*(re?1:2)+w[1];K>=nt;K-=st)(K>nt||!y)&&z.label([w[0],K],I(K),rt)})}}drawingTransform(){if(Ae(this,be)==null)throw new Error("Can't get drawingTransform of an uninitialized Graphie");return Ae(this,be)}bounds(){if(Ae(this,ve)==null)throw new Error("Can't get bounds of an uninitialized Graphie");return Ae(this,ve)}style(t,e){const o=this.processAttributes(t);if(typeof e=="function"){const a=this.currentStyle;this.currentStyle={...this.currentStyle,...o};const h=e.call(this);return this.currentStyle=a,h}Object.assign(this.currentStyle,o)}grid(t,e,o){return this.withStyle(o,()=>{const a=this.currentStyle.step||[1,1],h=this.raphael.set();let f=a[0]*Math.ceil(t[0]/a[0]);for(;f<=t[1];f+=a[0])h.push(this.line([f,e[0]],[f,e[1]]));let v=a[1]*Math.ceil(e[0]/a[1]);for(;v<=e[1];v+=a[1])h.push(this.line([t[0],v],[t[1],v]));return h})}arc(t,e,o,a,h,f){return this.withStyle(f,()=>{o=(o%360+360)%360,a=(a%360+360)%360;const v=this.scalePoint(t),x=this.scaleVector(e),y=Fi(e,o),M=Fi(e,a),w=L=>so(L,6),S=this.scalePoint([w(t[0]+y[0]),w(t[1]+y[1])]),E=this.scalePoint([w(t[0]+M[0]),w(t[1]+M[1])]),C=((a-o)%360+360)%360>180;return this.raphael.path("M"+S.join(" ")+"A"+x.join(" ")+" 0 "+(C?1:0)+" 0 "+E.join(" ")+(h?"L"+v.join(" ")+"z":""))})}circle(t,e,o){return this.withStyle(o,()=>this.raphael.ellipse(...this.scalePoint(t),...this.scaleVector([e,e])))}rect(t,e,o,a,h){return this.withStyle(h,()=>{const f=this.scalePoint([t,e+a]),v=this.scaleVector([o,a]),x=this.raphael.rect(...f.concat(v));return this.isMobile&&(x.node.style.shapeRendering="crispEdges"),x})}ellipse(t,e,o){return this.withStyle(o,()=>this.raphael.ellipse(...this.scalePoint(t).concat(this.scaleVector(e))))}fixedEllipse(t,e,o,a,h){return this.withStyle(h,()=>{const f=this.scalePoint(t),v=this.scaleVector(e),x=2*v[0]*o+a,y=2*v[1]*o+a,M=f[0]-x/2,w=f[1]-y/2,S=document.createElement("div");P(S).css({position:"absolute",width:x+"px",height:y+"px",left:M+"px",top:w+"px"});const C=jt(S,x,y).ellipse(x/2,y/2,v[0],v[1]);return{wrapper:S,visibleShape:C}})}unstyledPath(t){const e=this.raphael.path(this.svgPath(t));return e.graphiePath=t,e}path(t,e){return this.withStyle(e,()=>this.unstyledPath(t))}fixedPath(t,e,o){t=t.map(this.scalePoint),e=e?this.scalePoint(e):null,o=o||this.svgPath;const a=t.map(O=>O[0]),h=t.map(O=>O[1]),f=Math.min(...a),v=Math.max(...a),x=Math.min(...h),y=Math.max(...h),M=[4,4],w=[f,x];t=t.map(function(O){return ct(ht(O,w),Pt(M,.5))});const S=v-f+M[0],E=y-x+M[1],C=w[0]-M[0]/2,L=w[1]-M[1]/2,k=document.createElement("div");P(k).css({position:"absolute",width:S+"px",height:E+"px",left:C+"px",top:L+"px",transformOrigin:e?S/2+e[0]+"px "+(E/2+e[1])+"px":null});const B=jt(k,S,E).path(o(t));return{wrapper:k,visibleShape:B}}scaledPath(t,e){return this.withStyle(e,()=>{const o=this.raphael.path(this.svgPath(t,!0));return o.graphiePath=t,o})}line(t,e,o){return this.withStyle(o,()=>{const a=this.unstyledPath([t,e]);return this.isMobile&&(a.node.style.shapeRendering="crispEdges"),a})}parabola(t,e,o,a){return this.withStyle(a,()=>this.raphael.path(this.svgParabolaPath(t,e,o)))}fixedLine(t,e,o){const a=[o,o];t=this.scalePoint(t),e=this.scalePoint(e);const h=[Math.min(t[0],e[0]),Math.min(t[1],e[1])];t=ct(ht(t,h),Pt(a,.5)),e=ct(ht(e,h),Pt(a,.5));const f=h[0]-a[0]/2,v=h[1]-a[1]/2,x=Math.abs(t[0]-e[0])+a[0],y=Math.abs(t[1]-e[1])+a[1],M=document.createElement("div");P(M).css({position:"absolute",width:x+"px",height:y+"px",left:f+"px",top:v+"px",transformOrigin:t[0]+"px "+t[1]+"px"});const w=jt(M,x,y),S="M"+t[0]+" "+t[1]+" L"+e[0]+" "+e[1],E=w.path(S);return E.graphiePath=[t,e],{wrapper:M,visibleShape:E}}sinusoid(t,e,o,a,h){return this.withStyle(h,()=>this.raphael.path(this.svgSinusoidPath(t,e,o,a)))}plotParametric(t,e,o){return this.withStyle(o,()=>{const a=S=>Math.abs(S[1])>5e5?[S[0],Math.min(Math.max(S[1],-5e5),5e5)]:S,h=S=>a(t(S)),f=e[0],v=e[1];let x=(v-f)/(this.currentStyle["plot-points"]||800);x===0&&(x=1);const y=this.raphael.set();let M=[],w=h(f)[1];for(let S=f;S<=v;S+=x){const E=h(S),C=E[1];C>0!=w>0&&Math.abs(C-w)>2*this.drawingTransform().pixelsPerUnitY()||isNaN(C)?(y.push(this.unstyledPath(M)),M=[]):M.push(E),w=C}return y.push(this.unstyledPath(M)),y})}plot(t,e,o){return this.withStyle(o,()=>{const a=e[0],h=e[1];this.currentStyle["plot-points"]||(this.currentStyle["plot-points"]=2*(h-a)*this.drawingTransform().pixelsPerUnitX());const f=v=>[v,t(v)];return this.plotParametric(f,e)})}withStyle(t,e){const o=this.currentStyle;this.currentStyle={...this.currentStyle,...this.processAttributes(t)};const a=this.postprocessDrawingResult(e());return this.currentStyle=o,a}postprocessDrawingResult(t){const e=t.constructor.prototype;return e===jt.el||e===jt.st?(t.attr(this.currentStyle),this.currentStyle.arrows&&(t=this.addArrowheads(t))):t instanceof P&&t.css({...this.currentStyle,...Io}),t}addArrowheads(t){const e=t.constructor.prototype;if(e===jt.el){if(t.type==="path"&&typeof t.arrowheadsDrawn>"u"){const a=.6+.4*t.attr("stroke-width"),h=t.getTotalLength(),f=this.raphael.set(),v=this.raphael.path(this.isMobile?"M-4,4 C-4,4 -0.25,0 -0.25,0 C-0.25,0 -4,-4 -4,-4":"M-3 4 C-2.75 2.5 0 0.25 0.75 0C0 -0.25 -2.75 -2.5 -3 -4"),x=t.getPointAtLength(h-.4),y=t.getPointAtLength(h-.75*a),M=Math.atan2(x.y-y.y,x.x-y.x)*180/Math.PI,w=t.attr();delete w.path;let S=t.getSubpath(0,h-.75*a);return S=this.raphael.path(S).attr(w),S.arrowheadsDrawn=!0,t.remove(),v.rotate(M,this.isMobile?1e-5:.75,0).scale(a,a,.75,0).translate(y.x,y.y).attr(w).attr({"stroke-linejoin":"round","stroke-linecap":"round"}),v.arrowheadsDrawn=!0,f.push(S),f.push(v),f}}else if(e===jt.st)for(let o=0,a=t.items.length;o<a;o++)this.addArrowheads(t.items[o]);return t}processAttributes(t){const e={scale:a=>{this.drawingTransform().setScale(a)},clipRect:a=>{const h=a[0],f=a[1];return h[1]+=f[1],{"clip-rect":this.scalePoint(h).concat(this.scaleVector(f)).join(" ")}},strokeWidth:function(a){return{"stroke-width":parseFloat(a)}},rx:a=>({rx:this.scaleVector([a,0])[0]}),ry:a=>({ry:this.scaleVector([0,a])[1]}),r:a=>{const h=this.scaleVector([a,a]);return{rx:h[0],ry:h[1]}}},o={};return Object.entries(t||{}).forEach(function([a,h]){const f=e[a];if(typeof f=="function")Object.assign(o,f(h));else{const v=String(a).replace(/([A-Z]+)([A-Z][a-z])/g,"$1-$2").replace(/([a-z\d])([A-Z])/g,"$1-$2").toLowerCase();o[v]=h}}),o}addMouseLayer(t){var h;const e={allowScratchpad:!1,setDrawingAreaAvailable:function(){},...t},o=2;if(this.mouselayer=jt(this.el,this.xpixels,this.ypixels),P(this.mouselayer.canvas).css("z-index",o),e.onClick||e.onMouseDown||e.onMouseMove||e.onMouseOver||e.onMouseOut){const f=this.mouselayer.rect(0,0,this.xpixels,this.ypixels).attr({fill:"#000",opacity:0});let v=!1;if(P(this.mouselayer.canvas).on("vmousedown",x=>{if(x.target===f[0]){if(e.onMouseDown&&e.onMouseDown(this.getMouseCoord(x)),v=!0,e.onMouseMove){const y=e.onMouseMove;P(document).bind("vmousemove.mouseLayer",M=>{v&&(M.preventDefault(),y(this.getMouseCoord(M)))})}P(document).bind("vmouseup.mouseLayer",y=>{P(document).unbind(".mouseLayer"),v&&e.onClick&&e.onClick(this.getMouseCoord(y)),v=!1})}}),e.onMouseOver){const x=e.onMouseOver;P(this.mouselayer.canvas).on("vmouseover",y=>{x(this.getMouseCoord(y))})}if(e.onMouseOut){const x=e.onMouseOut;P(this.mouselayer.canvas).on("vmouseout",y=>{x(this.getMouseCoord(y))})}}e.allowScratchpad||(h=e.setDrawingAreaAvailable)==null||h.call(e,!1),this._mouselayerWrapper=document.createElement("div"),P(this._mouselayerWrapper).css({position:"absolute",left:0,top:0,zIndex:o}),this._visiblelayerWrapper=document.createElement("div"),P(this._visiblelayerWrapper).css({position:"absolute",left:0,top:0});const a=this.el;a.appendChild(this._visiblelayerWrapper),a.appendChild(this._mouselayerWrapper),this.addToMouseLayerWrapper=f=>{var v;(v=this._mouselayerWrapper)==null||v.appendChild(f)},this.addToVisibleLayerWrapper=f=>{var v;(v=this._visiblelayerWrapper)==null||v.appendChild(f)}}addToMouseLayerWrapper(t){throw new Error("addToMouseLayerWrapper is not ready. Call addMouseLayer() first.")}addToVisibleLayerWrapper(t){throw new Error("addToVisibleLayerWrapper is not ready. Call addMouseLayer() first.")}getMousePx(t){const e=P(this.el).offset(),o=t.pageX-e.left,a=t.pageY-e.top;return[o,a]}getMouseCoord(t){return this.unscalePoint(this.getMousePx(t))}},ve=new WeakMap,be=new WeakMap,nn);const Eo={center:[-.5,-.5],above:[-.5,-1],"above right":[0,-1],right:[0,-.5],"below right":[0,0],below:[-.5,0],"below left":[-1,0],left:[-1,-.5],"above left":[-1,-1]};function Pi(i){function t(h){return typeof h=="number"?[-h,h]:h}function e(h){return Array.isArray(h)?h:[h,h]}if(i==null)return i;const[o,a]=e(i);return[t(o),t(a)]}function Lo(i){return Array.isArray(i)?i:[i,i]}const Io={"stroke-width":null},zs=function(i,t){const e=P(i),o=e.data("labelDirection");let[a,h]=t;if(a===0&&h===0&&([a,h]=[1,1],De.log("Label size was 0x0 in graphie.js; using 1x1 instead")),e.css("visibility",""),typeof o=="number"){const f=Math.cos(o),v=Math.sin(o),x=Math.min(a/2/Math.abs(f),h/2/Math.abs(v));e.css({marginLeft:-a/2+f*x,marginTop:-h/2-v*x})}else{const f=Eo[o||"center"];e.css({marginLeft:Math.round(a*f[0]),marginTop:Math.round(h*f[1])})}},bt={Graphie:Bi,createGraphie:function(i){return new Bi(i)},unscaledSvgPath:function(i){return i[0]===!0?"":i.map(function(t,e){return t===!0?"z":(e===0?"M":"L")+t[0]+" "+t[1]}).join("")},getDistance:function(i,t){return ln(i,t)},findAngle:function(i,t,e){if(e===void 0){const o=i[0]-t[0],a=i[1]-t[1];return!o&&!a?0:(180+Math.atan2(-a,-o)*180/Math.PI+360)%360}return bt.findAngle(i,e)-bt.findAngle(t,e)},graphs:{}};(function(i,t,e,o){if(typeof i>"u")return;var a="virtualMouseBindings",h="virtualTouchID",f="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),v="clientX clientY pageX pageY screenX screenY".split(" "),x=i.event.mouseHooks?i.event.mouseHooks.props:[],y=i.event.props.concat(x),M={},w=0,S=0,E=0,C=!1,L=[],k=!1,V=!1,B="addEventListener"in e,O=i(e),j=1,tt=0;i.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500};function J(G){for(;G&&typeof G.originalEvent<"u";)G=G.originalEvent;return G}function I(G,Y){var et=G.type,dt,xt,Mt,Ct,vt,Se,ne,le,Ve;if(G=i.Event(G),G.type=Y,dt=G.originalEvent,xt=i.event.props,et.search(/mouse/)>-1&&(xt=y),dt)for(ne=xt.length,Ct;ne;)Ct=xt[--ne],G[Ct]=dt[Ct];if(et.search(/mouse(down|up)|click/)>-1&&!G.which&&(G.which=1),et.search(/^touch/)!==-1&&(Mt=J(dt),et=Mt.touches,vt=Mt.changedTouches,Se=et&&et.length?et[0]:vt&&vt.length?vt[0]:o,Se))for(le=0,Ve=v.length;le<Ve;le++)Ct=v[le],G[Ct]=Se[Ct];return G}function ot(G){for(var Y={},et,dt;G;){et=i.data(G,a);for(dt in et)et[dt]&&(Y[dt]=Y.hasVirtualBinding=!0);G=G.parentNode}return Y}function X(G,Y){for(var et;G;){if(et=i.data(G,a),et&&(!Y||et[Y]))return G;G=G.parentNode}return null}function z(){V=!1}function st(){V=!0}function nt(){tt=0,L.length=0,k=!1,st()}function $(){z()}function lt(){rt(),w=setTimeout(function(){w=0,nt()},i.vmouse.resetTimerDuration)}function rt(){w&&(clearTimeout(w),w=0)}function W(G,Y,et){var dt;return(et&&et[G]||!et&&X(Y.target,G))&&(dt=I(Y,G),i(Y.target).trigger(dt)),dt}function pt(G){var Y=i.data(G.target,h);if(!k&&(!tt||tt!==Y)){var et=W("v"+G.type,G);et&&(et.isDefaultPrevented()&&G.preventDefault(),et.isPropagationStopped()&&G.stopPropagation(),et.isImmediatePropagationStopped()&&G.stopImmediatePropagation())}}function wt(G){var Y=J(G).touches,et,dt;if(Y&&Y.length===1&&(et=G.target,dt=ot(et),dt.hasVirtualBinding)){tt=j++,i.data(et,h,tt),rt(),$(),C=!1;var xt=J(G).touches[0];S=xt.pageX,E=xt.pageY,W("vmouseover",G,dt),W("vmousedown",G,dt)}}function Lt(G){V||(C||W("vmousecancel",G,ot(G.target)),C=!0,lt())}function re(G){if(!V){var Y=J(G).touches[0],et=xt,dt=i.vmouse.moveDistanceThreshold,xt=xt||Math.abs(Y.pageX-S)>dt||Math.abs(Y.pageY-E)>dt,Mt=ot(G.target);xt&&!et&&W("vmousecancel",G,Mt),W("vmousemove",G,Mt),lt()}}function K(G){if(!V){st();var Y=ot(G.target),et;if(W("vmouseup",G,Y),!C){var dt=W("vclick",G,Y);dt&&dt.isDefaultPrevented()&&(et=J(G).changedTouches[0],L.push({touchID:tt,x:et.clientX,y:et.clientY}),k=!0)}W("vmouseout",G,Y),C=!1,lt()}}function Me(G){var Y=i.data(G,a),et;if(Y){for(et in Y)if(Y[et])return!0}return!1}function Be(){}function ui(G){var Y=G.substr(1);return{setup:function(et,dt){Me(this)||i.data(this,a,{});var xt=i.data(this,a);xt[G]=!0,M[G]=(M[G]||0)+1,M[G]===1&&O.bind(Y,pt),i(this).bind(Y,Be),B&&(M.touchstart=(M.touchstart||0)+1,M.touchstart===1&&O.bind("touchstart",wt).bind("touchend",K).bind("touchmove",re).bind("scroll",Lt))},teardown:function(et,dt){--M[G],M[G]||O.unbind(Y,pt),B&&(--M.touchstart,M.touchstart||O.unbind("touchstart",wt).unbind("touchmove",re).unbind("touchend",K).unbind("scroll",Lt));var xt=i(this),Mt=i.data(this,a);Mt&&(Mt[G]=!1),xt.unbind(Y,Be),Me(this)||xt.removeData(a)}}}for(var ae=0;ae<f.length;ae++)i.event.special[f[ae]]=ui(f[ae]);B&&e.addEventListener("click",function(G){var Y=L.length,et=G.target,dt,xt,Mt,Ct,vt;if(Y)for(dt=G.clientX,xt=G.clientY,threshold=i.vmouse.clickDistanceThreshold,Mt=et;Mt;){for(Ct=0;Ct<Y;Ct++)if(vt=L[Ct],Mt===et&&Math.abs(vt.x-dt)<threshold&&Math.abs(vt.y-xt)<threshold||i.data(Mt,h)===vt.touchID){G.preventDefault(),G.stopPropagation();return}Mt=Mt.parentNode}},!0)})(P,window,document);const Qe=function(i,t,e){const o=i.range[0][1]-i.range[0][0],a=i.range[1][1]-i.range[1][0],h=o+a,f=i.unscaleVector(pe(1,e)),v=Pt(Di(f),h),x=ct(t,v),y=Xt(f)[1];return i.constrainToBoundsOnAngle(x,4,y*Math.PI/180)};class ji{constructor(t,e){this.graphie=t,this.initialPoint=e}transform(t){const e=Tt.getPrefixedTransform();this.wrapper.style[e]=t}toFront(){const t=this.wrapper.parentNode;t&&t.appendChild(this.wrapper)}toBack(){const t=this.wrapper.parentNode;t!=null&&t.firstChild!==this.wrapper&&t.insertBefore(this.wrapper,t.firstChild)}remove(){this.visibleShape.remove(),P(this.wrapper).remove()}getMouseTarget(){return this.visibleShape[0]}moveTo(t){const e=ht(this.graphie.scalePoint(t),this.graphie.scalePoint(this.initialPoint)),o=Tt.getCanUse3dTransform(),a="translateX("+e[0]+"px) translateY("+e[1]+"px)"+(o?" translateZ(0)":"");this.transform(a)}hide(){this.visibleShape.hide()}show(){this.visibleShape.show()}attr(...t){this.visibleShape.attr(...t)}animate(...t){this.visibleShape.animate(...t)}}const Ro={center:null,createPath:null,mouselayer:!1};class Do extends ji{constructor(t,e,o){const a=t.scalePoint(b.head(e));super(t,a),o=b.extend({},Ro,o);const h=t.fixedPath(e,o.center,o.createPath);this.wrapper=h.wrapper,this.visibleShape=h.visibleShape,o.mouselayer?(this.wrapper.style.touchAction="none",this.graphie.addToMouseLayerWrapper(this.wrapper)):this.graphie.addToVisibleLayerWrapper(this.wrapper)}}const ge=class ge extends Do{constructor(t,e){const o=[.75,0],h=[[-3,4],[-2.75,2.5],[0,.25],o,[0,-.25],[-2.75,-2.5],[-3,-4]].map(f=>{const v=ht(f,o),x=Pt(v,ge.scale);return ct(o,x)}).map(t.unscalePoint);super(t,h,{center:t.unscalePoint(o),createPath:No}),this.center=o,this.attr(b.extend({"stroke-linejoin":"round","stroke-linecap":"round","stroke-dasharray":""},e))}toCoordAtAngle(t,e){const o=this.graphie.scalePoint(Qe(this.graphie,t,e));this.transform("translateX("+(o[0]+ge.scale*this.center[0])+"px) translateY("+(o[1]+ge.scale*this.center[1])+"px) translateZ(0) rotate("+(360-Ut.bound(e))+"deg)")}};ge.scale=1.4;let ie=ge;const No=function(i){let t="M"+i[0][0]+" "+i[0][1];for(let e=1;e<i.length;e+=3)t+="C"+i[e][0]+" "+i[e][1]+" "+i[e+1][0]+" "+i[e+1][1]+" "+i[e+2][0]+" "+i[e+2][1];return t},Fo={maxScale:1,mouselayer:!1,shadow:!1,disableMouseEventsOnWrapper:!1};class ai extends ji{constructor(t,e,o,a){super(t,e),a=b.extend({},Fo,a);const h=t.fixedEllipse(e,o,a.maxScale,a.padding);if(this.visibleShape=h.visibleShape,this.wrapper=h.wrapper,this.graphie=t,this.initialPoint=e,a.interactiveKindForTesting&&this.wrapper.setAttribute("data-interactive-kind-for-testing",a.interactiveKindForTesting),a.mouselayer?(this.wrapper.style.touchAction="none",this.graphie.addToMouseLayerWrapper(this.wrapper)):this.graphie.addToVisibleLayerWrapper(this.wrapper),a.shadow){const f="drop-shadow(0px 0px 5px rgba(0, 0, 0, 0.5))",v=this.wrapper;v.style.filter=f,this.moveTo=function(x){const y=ht(this.graphie.scalePoint(x),this.graphie.scalePoint(this.initialPoint)),M=Tt.getCanUse3dTransform(),w="translateX("+Math.round(y[0])+"px) translateY("+Math.round(y[1])+"px)"+(M?" translateZ(0)":"");this.transform(w)}}a.disableMouseEventsOnWrapper&&(this.wrapper.style.pointerEvents="none",this.visibleShape.node.style.pointerEvents="auto")}}const Bo={thickness:2,mouselayer:!1};class li extends ji{constructor(t,e,o,a){const h=[t.range[0][0],0],f=[t.range[0][1],0],v=t.scalePoint(h);super(t,v),a=b.extend({},Bo,a);const x=t.fixedLine(h,f,a.thickness);this.wrapper=x.wrapper,this.visibleShape=x.visibleShape,a.interactiveKindForTesting&&this.wrapper.setAttribute("data-interactive-kind-for-testing",a.interactiveKindForTesting),this.visibleShape.attr(a.normalStyle),this.initialPoint=v,this.initialLength=ln(t.scalePoint(h),t.scalePoint(f)),a.mouselayer?(this.wrapper.style.touchAction="none",this.graphie.addToMouseLayerWrapper(this.wrapper)):this.graphie.addToVisibleLayerWrapper(this.wrapper),this.moveTo(e,o)}getMouseTarget(){return this.wrapper}moveTo(t,e){const o=this.graphie.scalePoint(t),a=this.graphie.scalePoint(e),h=Xt(ht(a,o)),f=h[0],v=Ut.bound(h[1]),x=ht(o,this.initialPoint),y=Ut.bound(f/this.initialLength),M=Tt.getCanUse3dTransform(),w="translateX("+x[0]+"px) translateY("+x[1]+"px) "+(M?" translateZ(0)":"")+"rotate("+v+"deg) scaleX("+y+") scaleY(1)";this.transform(w)}}const{eq:hi,deepEq:Vo}=kt;function dn(i){return hi(i,0)?0:i>0?1:-1}function Ji(i,t,e){return(t[0]-i[0])*(e[1]-i[1])-(e[0]-i[0])*(t[1]-i[1])}function ta(i,t,e){return hi(Ji(i,t,e),0)}function Oo(i,t,e){return e[0]<=Math.max(i[0],t[0])&&e[0]>=Math.min(i[0],t[0])&&e[1]<=Math.max(i[1],t[1])&&e[1]>=Math.min(i[1],t[1])}function Go(i,t){const e=[[i[0],i[1],t[0]],[i[0],i[1],t[1]],[t[0],t[1],i[0]],[t[0],t[1],i[1]]],o=b.map(e,function(a){return dn(Ji(...a))});if(o[0]!==o[1]&&o[2]!==o[3])return!0;for(let a=0;a<4;a++)if(o[a]===0&&Oo(...e[a]))return!0;return!1}function ea(i){for(let t=0;t<i.length;t++)for(let e=t+1;e<i.length;e++){if(Zi(i[t],i[e]))return!0;const o=(t+1)%i.length,a=(e+1)%i.length;if(o===e||a===t)continue;const h=[i[t],i[o]],f=[i[e],i[a]];if(Go(h,f))return!0}return!1}function Vi(i,t){return b.map(b.zip(i,t),function(e){return e[0]-e[1]})}function Oi(i){return[-i[0],-i[1]]}function zo(i){const t=b.zip(i,i.slice(1).concat(i.slice(0,1))),e=b.map(t,function(o){const a=o[0],h=o[1];return(h[0]-a[0])*(h[1]+a[1])});return no(e)>0}function Gi(i){return Math.sqrt(b.reduce(i,function(t,e){return t+Math.pow(e,2)},0))}function Ho(i,t){return b.reduce(b.zip(i,t),function(e,o){return e+o[0]*o[1]},0)}function Hs(i){return b.zip(i,me(i)).map(function(e){return Gi(Vi(...e))})}function Ys(i){const t=b.zip(me(i,-1),i,me(i,1)),e=b.map(t,function(a){const h=Vi(a[1],a[0]),f=Vi(a[2],a[1]),v=Math.acos(Ho(h,f)/(Gi(h)*Gi(f)));return dn(Ji(...a))>0?v:-v}),o=b.reduce(e,function(a,h){return a+h},0);return b.map(e,function(a){return o>0?Math.PI-a:Math.PI+a})}function ia(i,t,e){if(i.length!==t.length)return!1;const o=i.length,a=Ys(i),h=Ys(t),f=Hs(i),v=Hs(t);for(let x=0;x<2*o;x++){let y=h.slice(),M=v.slice();if(x>=o&&(y.reverse(),M.reverse(),M=me(M,1)),y=me(y,x),M=me(M,x),Vo(a,y)){const w=b.zip(f,M),S=b.map(w,function(L){return L[0]/L[1]}),E=b.all(S,function(L){return hi(S[0],L)}),C=b.all(w,function(L){return on(L[0],L[1],e)});if(E&&C)return!0}}return!1}function sa(i,t,e){return Math.acos((i*i+t*t-e*e)/(2*i*t))*180/Math.PI}function na([i,t,e,o]){i<0&&(i*=-1,t*=-1,e*=-1);const a=2*Math.PI;for(t<0&&(t*=-1,e*=-1,e+=a/2);e>0;)e-=a;for(;e<0;)e+=a;return[i,t,e,o]}function me(i,t){return t=typeof t>"u"?1:t%i.length,i.slice(t).concat(i.slice(0,t))}function oa(i,t){if(hi(i[0],t[0]))return"x = "+i[0].toFixed(3);const e=(t[1]-i[1])/(t[0]-i[0]),o=i[1]-e*i[0];return"y = "+e.toFixed(3)+"x + "+o.toFixed(3)}function ra(i,t){const e=i[0][0],o=i[0][1],a=i[1][0],h=i[1][1],f=t[0][0],v=t[0][1],x=t[1][0],y=t[1][1],M=(e-a)*(v-y)-(o-h)*(f-x);if(Math.abs(M)<1e-9)return"Lines are parallel";const w=((e*h-o*a)*(f-x)-(e-a)*(f*y-v*x))/M,S=((e*h-o*a)*(v-y)-(o-h)*(f*y-v*x))/M;return"Intersection: ("+w.toFixed(3)+", "+S.toFixed(3)+")"}function Xs(i){const t=70.2941120352484,e=.5687298702748785*20;return(t-e)*Math.exp(-.037587715462826674*i)+e}function Le(i,t){return[i*Math.cos(t),i*Math.sin(t)*-1]}function Pe(i,t){const e=t*Math.PI/180;return Le(i,e)}let Ot=!1;const Yo={bogusShape:{animate:function(){},attr:function(){},remove:function(){}}};b.extend(bt.Graphie.prototype,{labelAngle:function(i){const t=this;b.defaults(i,{point1:[0,0],vertex:[0,0],point3:[0,0],label:null,numArcs:1,showRightAngleMarker:!0,pushOut:0,clockwise:!1,style:{}});let e=i.text===void 0?"":i.text;const o=i.vertex,a=t.scalePoint(o);let h,f;i.clockwise?(h=i.point1,f=i.point3):(h=i.point3,f=i.point1);const v=bt.findAngle(h,o),x=bt.findAngle(f,o),y=(x+360-v)%360,M=(v+y/2)%360;let S=5*i.pushOut+Xs(y);const E=[];if(Math.abs(y-90)<1e-9&&i.showRightAngleMarker){const C=ct(a,Pe(S,v)),L=ct(a,Pe(S,x));S*=Math.SQRT2;const k=ct(a,Pe(S,M));b.each([C,L],function(V){E.push(t.scaledPath([V,k],i.style))})}else b.times(i.numArcs,function(C){E.push(t.arc(o,t.unscaleVector(S),v,x,i.style)),S+=3});if(e){const C=e.match(/\$deg(\d)?/);if(C){const B=C[1]||1;e=e.replace(C[0],Ut.toFixedApprox(y,B)+"^{\\circ}")}const L=Pe(S+15,M),k=ct(a,L),V=t.unscalePoint(k);i.label?(i.label.setPosition(V),i.label.processMath(e,!0)):t.label(V,e,"center",i.style)}return E},labelSide:function(i){const t=this;b.defaults(i,{point1:[0,0],point2:[0,0],label:null,text:"",numTicks:0,numArrows:0,clockwise:!1,style:{}});let e,o;i.clockwise?(e=i.point1,o=i.point2):(e=i.point2,o=i.point1);const a=[(e[0]+o[0])/2,(e[1]+o[1])/2],h=t.scalePoint(a),f=Math.atan2(o[1]-e[1],o[0]-e[0]),v=f+Math.PI/2,x=[];let y=0;if(i.numTicks){const w=i.numTicks,S=5,E=5,C=b.extend({},i.style,{strokeWidth:2});b.times(w,function(L){const k=S*(L-(w-1)/2),V=Le(k,f),B=Le(E,v),O=[ct(h,V,B),ct(h,V,Oi(B))];x.push(t.scaledPath(O,C))}),y+=S*(w-1)+15}if(i.numArrows){const w=i.numArrows,S=[e,o].sort(function(k,V){return k[1]===V[1]?k[0]-V[0]:k[1]-V[1]})[0],E=t.scalePoint(S),C=b.extend({},i.style,{arrows:"->",strokeWidth:2}),L=5;b.times(w,function(k){const V=y+L*k;let B=Le(V,f);S!==e&&(B=Oi(B));const O=ct(h,B);x.push(t.scaledPath([E,O],C))})}let M=i.text;if(M){const w=M.match(/\$len(\d)?/);if(w){const k=bt.getDistance(e,o),V=w[1]||1;M=M.replace(w[0],Ut.toFixedApprox(k,V))}const E=Le(20,v),C=ct(h,E),L=t.unscalePoint(C);i.label?(i.label.setPosition(L),i.label.processMath(M,!0)):t.label(L,M,"center",i.style)}return x},labelVertex:function(i){const t=this;if(b.defaults(i,{point1:null,vertex:[0,0],point3:null,label:null,text:"",clockwise:!1,style:{}}),!i.text)return;const e=i.vertex,o=t.scalePoint(e);let a,h;i.clockwise?(a=i.point1,h=i.point3):(a=i.point3,h=i.point1);let f=135,v;if(a&&h){const S=bt.findAngle(a,e);f=(bt.findAngle(h,e)+360-S)%360,v=(S+f/2+180)%360}else a?v=bt.findAngle(e,a)+90:h?v=bt.findAngle(h,e)+90:v=135;const x=10+Xs(360-f),y=Pe(x,v),M=ct(o,y),w=t.unscalePoint(M);i.label?(i.label.setPosition(w),i.label.processMath(i.text,!0)):t.label(w,i.text,"center",i.style)},addMovablePoint:function(i){const t=P.extend(!0,{graph:this,coord:[0,0],snapX:0,snapY:0,pointSize:4,highlight:!1,dragging:!1,visible:!0,bounded:!0,constraints:{fixed:!1,constrainX:!1,constrainY:!1,fixedAngle:{},fixedDistance:{}},lineStarts:[],lineEnds:[],polygonVertices:[],normalStyle:{},highlightStyle:{fill:H.INTERACTING,stroke:H.INTERACTING},labelStyle:{color:H.INTERACTIVE},vertexLabel:"",mouseTarget:null},i),e=t.constraints.fixed?H.DYNAMIC:H.INTERACTIVE;t.normalStyle=b.extend({},{fill:e,stroke:e},i.normalStyle),i.coordX!==void 0&&(t.coord[0]=i.coordX),i.coordY!==void 0&&(t.coord[1]=i.coordY);const o=t.graph,a=function(f){t.visible&&t.bounded&&!t.constraints.fixed&&(f=o.constrainToBounds(f,10));let v=f[0],x=f[1];if(t.snapX!==0&&(v=Math.round(v/t.snapX)*t.snapX),t.snapY!==0&&(x=Math.round(x/t.snapY)*t.snapY),t.constraints.fixedDistance.snapPoints){const M=o.scalePoint(f);let w=M[0],S=M[1];const E=2*Math.PI/t.constraints.fixedDistance.snapPoints,C=t.constraints.fixedDistance.dist,L=t.constraints.fixedDistance.point,k=(L[0]-o.range[0][0])*o.scale[0],V=(-L[1]+o.range[1][1])*o.scale[1];let B=w-k,O=-S+V,j=Math.atan(O/B);B<0&&(j+=Math.PI),j=Math.round(j/E)*E,B=C*Math.cos(j),O=C*Math.sin(j),w=B+k,S=-O+V,v=Ut.roundTo(5,w/o.scale[0]+o.range[0][0]),x=Ut.roundTo(5,o.range[1][1]-S/o.scale[1])}return t.applyConstraint([v,x])};t.applyConstraint=function(f,v,x){let y=f.slice();const M={};if(x?P.extend(M,{fixed:!1,constrainX:!1,constrainY:!1,fixedAngle:{},fixedDistance:{}},v):P.extend(M,this.constraints,v),M.constrainX)y=[this.coord[0],f[1]];else if(M.constrainY)y=[f[0],this.coord[1]];else if(typeof M.fixedAngle.angle=="number"&&typeof M.fixedDistance.dist=="number"){const w=M.fixedAngle.vertex.coord||M.fixedAngle.vertex,S=M.fixedAngle.ref.coord||M.fixedAngle.ref,E=M.fixedDistance.point.coord||M.fixedDistance.point,C=(M.fixedAngle.angle+bt.findAngle(S,w))*Math.PI/180,L=M.fixedDistance.dist;y[0]=L*Math.cos(C)+E[0],y[1]=L*Math.sin(C)+E[1]}else if(typeof M.fixedAngle.angle=="number"){const w=M.fixedAngle.vertex.coord||M.fixedAngle.vertex,S=M.fixedAngle.ref.coord||M.fixedAngle.ref,E=(M.fixedAngle.angle+bt.findAngle(S,w))*Math.PI/180,C=bt.findAngle(f,w)*Math.PI/180;let k=bt.getDistance(f,w)*Math.cos(E-C);k=k<1?1:k,y[0]=k*Math.cos(E)+w[0],y[1]=k*Math.sin(E)+w[1]}else if(typeof M.fixedDistance.dist=="number"){const w=M.fixedDistance.point.coord||M.fixedDistance.point;let S=bt.findAngle(f,w);const E=M.fixedDistance.dist;S=S*Math.PI/180,y[0]=E*Math.cos(S)+w[0],y[1]=E*Math.sin(S)+w[1]}else M.fixed&&(y=t.coord);return y},t.coord=a(t.coord);const h=2;if(t.visible&&o.style(t.normalStyle,function(){const f=[t.pointSize/o.scale[0],t.pointSize/o.scale[1]],v={maxScale:h,padding:2};t.visibleShape=new ai(o,t.coord,f,v),t.visibleShape.attr(b.omit(t.normalStyle,"scale")),t.visibleShape.toFront()}),t.normalStyle.scale=1,t.highlightStyle.scale=h,t.vertexLabel&&(t.labeledVertex=this.label([0,0],"","center",t.labelStyle)),t.drawLabel=function(){t.vertexLabel&&t.graph.labelVertex({vertex:t.coord,label:t.labeledVertex,text:t.vertexLabel,style:t.labelStyle})},t.drawLabel(),t.grab=function(f){f=f||[0,0],P(document).bind("vmousemove.point vmouseup.point",function(v){v.preventDefault(),t.dragging=!0,Ot=!0;let x=ct(o.getMouseCoord(v),f);x=a(x);let y=x[0],M=x[1],w,S;if(v.type==="vmousemove"){let E=!0;if(b.isFunction(t.onMove)){const C=t.onMove(y,M);C===!1&&(E=!1),b.isArray(C)&&(y=C[0],M=C[1])}if(w=(y-o.range[0][0])*o.scale[0],S=(-M+o.range[1][1])*o.scale[1],E){const C=o.unscalePoint([w,S]);t.visibleShape.moveTo(C),t.mouseTarget.moveTo(C),t.coord=[y,M],t.updateLineEnds(),P(t).trigger("move")}t.drawLabel()}else if(v.type==="vmouseup"){if(P(document).unbind(".point"),t.dragging=!1,Ot=!1,b.isFunction(t.onMoveEnd)){const E=t.onMoveEnd(y,M);if(b.isArray(E)){y=E[0],M=E[1],w=(y-o.range[0][0])*o.scale[0],S=(-M+o.range[1][1])*o.scale[1];const C=o.unscalePoint([w,S]);t.visibleShape.moveTo(C),t.mouseTarget.moveTo(C),t.coord=[y,M]}}t.highlight||(t.visibleShape.animate(t.normalStyle,50),t.onUnhighlight&&t.onUnhighlight())}})},t.visible&&!t.constraints.fixed){if(!t.mouseTarget){const v=o.unscaleVector(16),x={mouselayer:!0,padding:0,disableMouseEventsOnWrapper:!0,interactiveKindForTesting:"movable-point"};t.mouseTarget=new ai(o,t.coord,v,x),t.mouseTarget.attr({fill:"#000",opacity:0})}const f=P(t.mouseTarget.getMouseTarget());f.css("cursor","move"),f.bind("vmousedown vmouseover vmouseout",function(v){if(v.type==="vmouseover")t.highlight=!0,Ot||(t.visibleShape.animate(t.highlightStyle,50),t.onHighlight&&t.onHighlight());else if(v.type==="vmouseout")t.highlight=!1,!t.dragging&&!Ot&&(t.visibleShape.animate(t.normalStyle,50),t.onUnhighlight&&t.onUnhighlight());else if(v.type==="vmousedown"&&(v.which===1||v.which===0)){v.preventDefault();const x=t.coord,y=o.getMouseCoord(v),w=!("ontouchstart"in window)?[0,0]:ht(x,y);t.grab(w)}})}return t.moveTo=function(f,v,x){const M=bt.getDistance(this.graph.scalePoint([f,v]),this.graph.scalePoint(this.coord))*5,w=x&&function(S){t.coord=S,t.updateLineEnds()};this.visibleShape.animateTo([f,v],M,w),this.mouseTarget.animateTo([f,v],M,w),this.coord=[f,v],b.isFunction(this.onMove)&&this.onMove(f,v)},t.updateLineEnds=function(){P(this.lineStarts).each(function(){this.coordA=t.coord,this.transform()}),P(this.lineEnds).each(function(){this.coordZ=t.coord,this.transform()}),P(this.polygonVertices).each(function(){this.transform()})},t.setCoord=function(f){this.visible&&(this.visibleShape.moveTo(f),this.mouseTarget!=null&&this.mouseTarget.moveTo(f)),this.coord=f.slice()},t.setCoordConstrained=function(f){this.setCoord(a(f))},t.toBack=function(){this.visible&&(this.mouseTarget!=null&&this.mouseTarget.toBack(),this.visibleShape.toBack())},t.toFront=function(){this.visible&&(this.mouseTarget!=null&&this.mouseTarget.toFront(),this.visibleShape.toFront())},t.remove=function(){this.visibleShape&&this.visibleShape.remove(),this.mouseTarget&&this.mouseTarget.remove(),this.labeledVertex&&this.labeledVertex.remove()},t},addMovableLineSegment:function(i){const t=P.extend({graph:this,coordA:[0,0],coordZ:[1,1],snapX:0,snapY:0,fixed:!1,ticks:0,normalStyle:{},highlightStyle:{stroke:H.INTERACTING,"stroke-width":6},labelStyle:{stroke:H.INTERACTIVE,color:H.INTERACTIVE},highlight:!1,dragging:!1,tick:[],extendLine:!1,extendRay:!1,constraints:{fixed:!1,constrainX:!1,constrainY:!1},sideLabel:"",vertexLabels:[],numArrows:0,numTicks:0,movePointsWithLine:!1},i),e=t.fixed?H.DYNAMIC:H.INTERACTIVE;t.normalStyle=b.extend({},{"stroke-width":2,stroke:e},i.normalStyle),t.arrowStyle=b.extend({},t.normalStyle,{color:t.normalStyle.stroke}),i.pointA!==void 0?(t.coordA=i.pointA.coord,t.pointA.lineStarts.push(t)):i.coordA!==void 0&&(t.coordA=i.coordA.slice()),i.pointZ!==void 0?(t.coordZ=i.pointZ.coord,t.pointZ.lineEnds.push(t)):i.coordA!==void 0&&(t.coordA=t.coordA.slice());const o=t.graph;o.style(t.normalStyle);for(let h=0;h<t.ticks;++h)t.tick[h]=Yo.bogusShape;let a=bt.unscaledSvgPath([[0,0],[1,0]]);for(let h=0;h<t.ticks;++h){const f=.5-(t.ticks-1+h*2)/o.scale[0];a+=bt.unscaledSvgPath([[f,-7],[f,7]])}if(i={thickness:Math.max(t.normalStyle["stroke-width"],t.highlightStyle["stroke-width"])},t.visibleLine=new li(o,[0,0],[1,0],i),t.visibleLine.attr(t.normalStyle),!t.fixed){const h={thickness:30,mouselayer:!0,interactiveKindForTesting:"movable-line"};t.mouseTarget=new li(o,[0,0],[1,0],h),t.mouseTarget.attr({fill:"#000",opacity:0})}if(t.transform=function(h){h&&(typeof this.pointA=="object"&&(this.coordA=this.pointA.coord),typeof this.pointZ=="object"&&(this.coordZ=this.pointZ.coord));const f=function(L){const k=L.graph.scalePoint(L.coordA),V=L.graph.scalePoint(L.coordZ);return Xt(ht(V,k))[1]},v=function(L,k,V){L=t.graph;const B=L.range[0][1]-L.range[0][0],O=L.range[1][1]-L.range[1][0],j=B+O,tt=L.unscaleVector(pe(1,V)),J=Pt(Di(tt),j),I=ct(k,J),ot=Xt(tt)[1];return L.constrainToBoundsOnAngle(I,4,ot*Math.PI/180)},x=f(this);let y=this.coordA,M=this.coordZ;this.extendLine?(y=v(o,y,360-x),M=v(o,M,(540-x)%360)):this.extendRay&&(M=v(o,y,360-x));const w=[this.visibleLine];this.fixed||w.push(this.mouseTarget),b.each(w,function(L){L.moveTo(y,M)}),this._arrows==null&&(this._arrows=[],this.extendLine?(this._arrows.push(new ie(o,this.normalStyle)),this._arrows.push(new ie(o,this.normalStyle))):this.extendRay&&this._arrows.push(new ie(o,this.normalStyle)));const S=[this.coordA,this.coordZ],E=[360-x,(540-x)%360];b.each(this._arrows,function(L,k){L.toCoordAtAngle(S[k],E[k])}),b.invoke(this.temp,"remove"),this.temp=[];const C=this.coordA[0]<this.coordZ[0]||this.coordA[0]===this.coordZ[0]&&this.coordA[1]>this.coordZ[1];this.sideLabel&&this.temp.push(this.graph.labelSide({point1:this.coordA,point2:this.coordZ,label:this.labeledSide,text:this.sideLabel,numArrows:this.numArrows,numTicks:this.numTicks,clockwise:C,style:this.labelStyle})),this.vertexLabels.length&&(this.graph.labelVertex({vertex:this.coordA,point3:this.coordZ,label:this.labeledVertices[0],text:this.vertexLabels[0],clockwise:C,style:this.labelStyle}),this.graph.labelVertex({point1:this.coordA,vertex:this.coordZ,label:this.labeledVertices[1],text:this.vertexLabels[1],clockwise:C,style:this.labelStyle})),this.temp=b.flatten(this.temp)},t.toBack=function(){t.fixed||t.mouseTarget.toBack(),t.visibleLine.toBack()},t.toFront=function(){t.fixed||t.mouseTarget.toFront(),t.visibleLine.toFront()},t.remove=function(){t.fixed||t.mouseTarget.remove(),t.visibleLine.remove(),t.labeledSide&&t.labeledSide.remove(),t.labeledVertices&&b.invoke(t.labeledVertices,"remove"),t._arrows&&b.invoke(t._arrows,"remove"),t.temp.length&&b.invoke(t.temp,"remove")},t.hide=function(){t.visibleLine.hide(),t.temp.length&&b.invoke(t.temp,"hide"),t._arrows&&b.invoke(t._arrows,"hide")},t.show=function(){t.visibleLine.show(),t.temp.length&&b.invoke(t.temp,"show"),t._arrows&&b.invoke(t._arrows,"show")},t.sideLabel&&(t.labeledSide=this.label([0,0],"","center",t.labelStyle)),t.vertexLabels.length&&(t.labeledVertices=b.map(t.vertexLabels,function(h){return this.label([0,0],"","center",t.labelStyle)},this)),!t.fixed&&!t.constraints.fixed){const h=P(t.mouseTarget.getMouseTarget());h.css("cursor","move"),h.bind("vmousedown vmouseover vmouseout",function(f){if(f.type==="vmouseover")Ot||(t.highlight=!0,t.visibleLine.animate(t.highlightStyle,50),t.arrowStyle=b.extend({},t.arrowStyle,{color:t.highlightStyle.stroke,stroke:t.highlightStyle.stroke}),t.transform());else if(f.type==="vmouseout")t.highlight=!1,t.dragging||(t.visibleLine.animate(t.normalStyle,50),t.arrowStyle=b.extend({},t.arrowStyle,{color:t.normalStyle.stroke,stroke:t.normalStyle.stroke}),t.transform());else if(f.type==="vmousedown"&&(f.which===1||f.which===0)){f.preventDefault();let v=(f.pageX-P(o.raphael.canvas.parentNode).offset().left)/o.scale[0]+o.range[0][0],x=o.range[1][1]-(f.pageY-P(o.raphael.canvas.parentNode).offset().top)/o.scale[1];t.snapX>0&&(v=Math.round(v/t.snapX)*t.snapX),t.snapY>0&&(x=Math.round(x/t.snapY)*t.snapY);const y=[t.coordA[0]-v,t.coordA[1]-x],M=[t.coordZ[0]-v,t.coordZ[1]-x],w=-Math.min(o.scaleVector(y)[0],o.scaleVector(M)[0]),S=Math.max(o.scaleVector(y)[0],o.scaleVector(M)[0]),E=Math.max(o.scaleVector(y)[1],o.scaleVector(M)[1]),C=-Math.min(o.scaleVector(y)[1],o.scaleVector(M)[1]);P(document).bind("vmousemove.lineSegment vmouseup.lineSegment",function(L){L.preventDefault(),t.dragging=!0,Ot=!0;let k=L.pageX-P(o.raphael.canvas.parentNode).offset().left,V=L.pageY-P(o.raphael.canvas.parentNode).offset().top;k=Math.max(w+10,Math.min(o.xpixels-10-S,k)),V=Math.max(E+10,Math.min(o.ypixels-10-C,V));let B=k/o.scale[0]+o.range[0][0],O=o.range[1][1]-V/o.scale[1];if(t.snapX>0&&(B=Math.round(B/t.snapX)*t.snapX),t.snapY>0&&(O=Math.round(O/t.snapY)*t.snapY),L.type==="vmousemove"){t.constraints.constrainX&&(B=t.coordA[0]-y[0]),t.constraints.constrainY&&(O=t.coordA[1]-y[1]);const j=B+y[0]-t.coordA[0],tt=O+y[1]-t.coordA[1];t.coordA=[B+y[0],O+y[1]],t.coordZ=[B+M[0],O+M[1]],t.transform(),t.movePointsWithLine&&(typeof t.pointA=="object"&&t.pointA.setCoord([t.pointA.coord[0]+j,t.pointA.coord[1]+tt]),typeof t.pointZ=="object"&&t.pointZ.setCoord([t.pointZ.coord[0]+j,t.pointZ.coord[1]+tt])),b.isFunction(t.onMove)&&t.onMove(j,tt)}else L.type==="vmouseup"&&(P(document).unbind(".lineSegment"),t.dragging=!1,Ot=!1,t.highlight||(t.visibleLine.animate(t.normalStyle,50),t.arrowStyle=b.extend({},t.arrowStyle,{color:t.normalStyle.stroke,stroke:t.normalStyle.stroke}),t.transform()),b.isFunction(t.onMoveEnd)&&t.onMoveEnd());P(t).trigger("move")})}})}return t.pointA!==void 0&&t.pointA.toFront(),t.pointZ!==void 0&&t.pointZ.toFront(),t.transform(),t},addMovablePolygon:function(i){const t=this,e=P.extend({snapX:0,snapY:0,fixed:!1,constrainToGraph:!0,normalStyle:{},highlightStyle:{stroke:H.INTERACTING,"stroke-width":2,fill:H.INTERACTING,"fill-opacity":.05},pointHighlightStyle:{fill:H.INTERACTING,stroke:H.INTERACTING},labelStyle:{stroke:H.DYNAMIC,"stroke-width":1,color:H.DYNAMIC},angleLabels:[],showRightAngleMarkers:[],sideLabels:[],vertexLabels:[],numArcs:[],numArrows:[],numTicks:[],updateOnPointMove:!0,closed:!0},b.omit(i,"points")),o=e.fixed?H.DYNAMIC:H.INTERACTIVE;e.normalStyle=b.extend({"stroke-width":2,"fill-opacity":0,fill:o,stroke:o},i.normalStyle),e.points=i.points;const a=function(h){return!b.isArray(h)};if(e.update=function(){const h=e.points.length;e.coords=b.map(e.points,function(x,y){return a(x)?x.coord:x}),e.left=b.min(b.pluck(e.coords,0)),e.right=b.max(b.pluck(e.coords,0)),e.top=b.max(b.pluck(e.coords,1)),e.bottom=b.min(b.pluck(e.coords,1));let f=b.map(e.coords,function(x){return t.scalePoint(x)});e.closed?f.push(!0):f=f.concat(b.clone(f).reverse()),e.path=bt.unscaledSvgPath(f),b.invoke(e.temp,"remove"),e.temp=[];const v=zo(e.coords);(e.angleLabels.length||e.showRightAngleMarkers.length)&&b.each(e.labeledAngles,function(x,y){e.temp.push(t.labelAngle({point1:e.coords[(y-1+h)%h],vertex:e.coords[y],point3:e.coords[(y+1)%h],label:x,text:e.angleLabels[y],showRightAngleMarker:e.showRightAngleMarkers[y],numArcs:e.numArcs[y],clockwise:v,style:e.labelStyle}))}),e.sideLabels.length&&b.each(e.labeledSides,function(x,y){e.temp.push(t.labelSide({point1:e.coords[y],point2:e.coords[(y+1)%h],label:x,text:e.sideLabels[y],numArrows:e.numArrows[y],numTicks:e.numTicks[y],clockwise:v,style:e.labelStyle}))}),e.vertexLabels.length&&b.each(e.labeledVertices,function(x,y){t.labelVertex({point1:e.coords[(y-1+h)%h],vertex:e.coords[y],point3:e.coords[(y+1)%h],label:x,text:e.vertexLabels[y],clockwise:v,style:e.labelStyle})}),e.temp=b.flatten(e.temp)},e.transform=function(){e.update(),e.visibleShape.attr({path:e.path}),e.fixed||e.mouseTarget.attr({path:e.path})},e.remove=function(){e.visibleShape.remove(),e.fixed||e.mouseTarget.remove(),e.labeledAngles&&b.invoke(e.labeledAngles,"remove"),e.labeledSides&&b.invoke(e.labeledSides,"remove"),e.labeledVertices&&b.invoke(e.labeledVertices,"remove"),e.temp.length&&b.invoke(e.temp,"remove")},e.toBack=function(){e.fixed||e.mouseTarget.toBack(),e.visibleShape.toBack()},e.toFront=function(){e.fixed||e.mouseTarget.toFront(),e.visibleShape.toFront()},e.updateOnPointMove&&b.each(b.filter(e.points,a),function(h){h.polygonVertices.push(e)}),e.coords=new Array(e.points.length),e.angleLabels.length){const h=Math.max(e.angleLabels.length,e.showRightAngleMarkers.length);e.labeledAngles=b.times(h,function(){return this.label([0,0],"","center",e.labelStyle)},this)}return e.sideLabels.length&&(e.labeledSides=b.map(e.sideLabels,function(h){return this.label([0,0],"","center",e.labelStyle)},this)),e.vertexLabels.length&&(e.labeledVertices=b.map(e.vertexLabels,function(h){return this.label([0,0],"","center",e.labelStyle)},this)),e.update(),e.visibleShape=t.raphael.path(e.path),e.visibleShape.attr(e.normalStyle),e.fixed||(e.mouseTarget=t.mouselayer.path(e.path),e.mouseTarget.attr({fill:"#000",opacity:0,cursor:"move"}),P(e.mouseTarget[0]).bind("vmousedown vmouseover vmouseout",function(h){if(h.type==="vmouseover")(!Ot||e.dragging)&&(e.highlight=!0,e.visibleShape.animate(e.highlightStyle,50),b.each(b.filter(e.points,a),function(f){f.visibleShape.animate(e.pointHighlightStyle,50)}));else if(h.type==="vmouseout"){if(e.highlight=!1,!e.dragging){e.visibleShape.animate(e.normalStyle,50);const f=b.filter(e.points,a);b.any(b.pluck(f,"dragging"))||b.each(f,function(v){v.visibleShape.animate(v.normalStyle,50)})}}else if(h.type==="vmousedown"&&(h.which===1||h.which===0)){h.preventDefault(),b.each(b.filter(e.points,a),function(L){L.dragging=!0});let f=(h.pageX-P(t.raphael.canvas.parentNode).offset().left)/t.scale[0]+t.range[0][0],v=t.range[1][1]-(h.pageY-P(t.raphael.canvas.parentNode).offset().top)/t.scale[1];e.snapX>0&&(f=Math.round(f/e.snapX)*e.snapX),e.snapY>0&&(v=Math.round(v/e.snapY)*e.snapY);let x=f,y=v;const M=e.coords.slice(),w=(f-e.left)*t.scale[0],S=(e.right-f)*t.scale[0],E=(e.top-v)*t.scale[1],C=(v-e.bottom)*t.scale[1];P(document).bind("vmousemove.polygon vmouseup.polygon",function(L){L.preventDefault(),e.dragging=!0,Ot=!0;let k=L.pageX-P(t.raphael.canvas.parentNode).offset().left,V=L.pageY-P(t.raphael.canvas.parentNode).offset().top;e.constrainToGraph&&(k=Math.max(w+10,Math.min(t.xpixels-10-S,k)),V=Math.max(E+10,Math.min(t.ypixels-10-C,V)));let B=k/t.scale[0]+t.range[0][0],O=t.range[1][1]-V/t.scale[1];if(e.snapX>0&&(B=Math.round(B/e.snapX)*e.snapX),e.snapY>0&&(O=Math.round(O/e.snapY)*e.snapY),L.type==="vmousemove"){let j=B-f,tt=O-v,J=!0;if(b.isFunction(e.onMove)){const ot=e.onMove(j,tt);ot===!1?J=!1:b.isArray(ot)&&(j=ot[0],tt=ot[1],B=f+j,O=v+tt)}const I=function(ot){return[M[ot][0]+j,M[ot][1]+tt]};J&&(b.each(e.points,function(ot,X){a(ot)?ot.setCoord(I(X)):e.points[X]=I(X)}),e.transform(),P(e).trigger("move"),x=B,y=O)}else if(L.type==="vmouseup"){P(document).unbind(".polygon");const j=b.filter(e.points,a);b.each(j,function(tt){tt.dragging=!1}),e.dragging=!1,Ot=!1,e.highlight||(e.visibleShape.animate(e.normalStyle,50),b.each(j,function(tt){tt.visibleShape.animate(tt.normalStyle,50)})),b.isFunction(e.onMoveEnd)&&e.onMoveEnd(x-f,y-v)}})}})),b.invoke(b.filter(e.points,a),"toFront"),e},constrainToBounds:function(i,t){const e=this.unscalePoint([t,this.ypixels-t]),o=this.unscalePoint([this.xpixels-t,t]),a=Math.max(e[0],Math.min(o[0],i[0])),h=Math.max(e[1],Math.min(o[1],i[1]));return[a,h]},constrainToBoundsOnAngle:function(i,t,e){const o=this.unscalePoint([t,this.ypixels-t]),a=this.unscalePoint([this.xpixels-t,t]);let h=i.slice();return h[0]<o[0]?h=[o[0],h[1]+(o[0]-h[0])*Math.tan(e)]:h[0]>a[0]&&(h=[a[0],h[1]-(h[0]-a[0])*Math.tan(e)]),h[1]<o[1]?h=[h[0]+(o[1]-h[1])/Math.tan(e),o[1]]:h[1]>a[1]&&(h=[h[0]-(h[1]-a[1])/Math.tan(e),a[1]]),h},addMovableAngle:function(i){return new pn(this,i)},addCircleGraph:function(i){const t=this,e=P.extend({center:[0,0],radius:2,snapX:.5,snapY:.5,snapRadius:.5,minRadius:1,centerConstraints:{},centerNormalStyle:{},centerHighlightStyle:{stroke:H.INTERACTING,fill:H.INTERACTING},circleNormalStyle:{stroke:H.INTERACTIVE,"fill-opacity":0},circleHighlightStyle:{stroke:H.INTERACTING,fill:H.INTERACTING,"fill-opacity":.05}},i),o=e.centerConstraints.fixed?H.DYNAMIC:H.INTERACTIVE,a=i?i.centerNormalStyle:null;e.centerNormalStyle=b.extend({},{fill:o,stroke:o},a),e.centerPoint=t.addMovablePoint({graph:t,coord:e.center,normalStyle:e.centerNormalStyle,snapX:e.snapX,snapY:e.snapY,constraints:e.centerConstraints}),e.circ=t.circle(e.center,e.radius,e.circleNormalStyle),e.perim=t.mouselayer.circle(t.scalePoint(e.center)[0],t.scalePoint(e.center)[1],t.scaleVector(e.radius)[0]).attr({"stroke-width":20,opacity:.002}),e.centerConstraints.fixed||P(e.centerPoint.mouseTarget.getMouseTarget()).on("vmouseover vmouseout",function(f){e.centerPoint.highlight||e.centerPoint.dragging?e.circ.animate(e.circleHighlightStyle,50):e.circ.animate(e.circleNormalStyle,50)}),e.toFront=function(){e.circ.toFront(),e.perim.toFront(),e.centerPoint.visibleShape.toFront(),e.centerConstraints.fixed||e.centerPoint.mouseTarget.toFront()},e.centerPoint.onMove=function(f,v){e.toFront(),e.circ.attr({cx:t.scalePoint(f)[0],cy:t.scalePoint(v)[1]}),e.perim.attr({cx:t.scalePoint(f)[0],cy:t.scalePoint(v)[1]}),e.onMove&&e.onMove(f,v)},P(e.centerPoint).on("move",function(){e.center=this.coord,P(e).trigger("move")}),e.setCenter=function(f,v){e.centerPoint.setCoord([f,v]),e.centerPoint.onMove(f,v),e.center=[f,v]},e.setRadius=function(f){e.radius=f,e.perim.attr({r:t.scaleVector(f)[0]}),e.circ.attr({rx:t.scaleVector(f)[0],ry:t.scaleVector(f)[1]})},e.remove=function(){e.centerPoint.remove(),e.circ.remove(),e.perim.remove()};const h=[[Math.PI*-1,Math.PI*-.875,"ew-resize"],[Math.PI*-.875,Math.PI*-.625,"nesw-resize"],[Math.PI*-.625,Math.PI*-.375,"ns-resize"],[Math.PI*-.375,Math.PI*-.125,"nwse-resize"],[Math.PI*-.125,Math.PI*.125,"ew-resize"],[Math.PI*.125,Math.PI*.375,"nesw-resize"],[Math.PI*.375,Math.PI*.625,"ns-resize"],[Math.PI*.625,Math.PI*.875,"nwse-resize"],[Math.PI*.875,Math.PI*1,"ew-resize"]];return P(e.perim.node).on("vmousemove",f=>{let[v,x]=this.getMouseCoord(f);v-=e.center[0],x-=e.center[1];const y=Math.atan2(x,v);h.forEach(function(M){const[w,S,E]=M;y>=w&&y<S&&P(e.perim.node).css("cursor",E)})}),P(e.perim.node).css("cursor","nesw-resize"),e.perim.node.addEventListener("touchstart",function(f){f.preventDefault()},{passive:!1}),P(e.perim.node).on("vmouseover vmouseout vmousedown",function(f){if(f.type==="vmouseover")e.highlight=!0,Ot||(e.circ.animate(e.circleHighlightStyle,50),e.centerPoint.visibleShape.animate(e.centerHighlightStyle,50));else if(f.type==="vmouseout")e.highlight=!1,!e.dragging&&!e.centerPoint.dragging&&(e.circ.animate(e.circleNormalStyle,50),e.centerPoint.visibleShape.animate(e.centerNormalStyle,50));else if(f.type==="vmousedown"&&(f.which===1||f.which===0)){f.preventDefault(),e.toFront();const v=e.radius;P(document).on("vmousemove vmouseup",function(x){if(x.preventDefault(),e.dragging=!0,Ot=!0,x.type==="vmousemove"){const y=t.constrainToBounds(t.getMouseCoord(x),10);let M=bt.getDistance(e.centerPoint.coord,y);M=Math.max(e.minRadius,Math.round(M/e.snapRadius)*e.snapRadius);const w=e.radius;let S=!0;if(e.onResize){const E=e.onResize(M,w);b.isNumber(E)?M=E:E===!1&&(S=!1)}S&&(e.setRadius(M),P(e).trigger("move"))}else x.type==="vmouseup"&&(P(document).off("vmousemove vmouseup"),e.dragging=!1,Ot=!1,e.onResizeEnd&&e.onResizeEnd(e.radius,v))})}}),e},addRotateHandle:function(){const i=function(t,e,o,a,h,f,v){const x=function(w,S){const E=o+S,C=pe(E,f+w),L=ct(e,C),k=t.scalePoint(L);return k[0]+","+k[1]},y=t.scaleVector(o-a),M=t.scaleVector(o+a);return t.raphael.path(" M"+x(h,-a)+" L"+x(h,-3*a)+" L"+x(2*h,0)+" L"+x(h,3*a)+" L"+x(h,a)+" A"+M[0]+","+M[1]+",0,0,1,"+x(-h,a)+" L"+x(-h,3*a)+" L"+x(-2*h,0)+" L"+x(-h,-3*a)+" L"+x(-h,-a)+" A"+y[0]+","+y[1]+",0,0,0,"+x(h,-a)+" Z").attr({stroke:null,fill:v?H.INTERACTING:H.INTERACTIVE})};return function(t){const e=this;let o=t.center;const a=t.radius,h=t.lengthAngle||30,f=t.hideArrow||!1,v=t.mouseTarget,x=b.uniqueId("rotateHandle");b.isArray(o)&&(o={coord:o});const y=e.addMovablePoint({coord:Vs(o.coord,pe(a,t.angleDeg||0)),constraints:{fixedDistance:{dist:a,point:o}},mouseTarget:v});o.toFront();let M=o.coord,w=y.coord,S=w,E=!1,C=!1,L;const k=function(O){if(f)return;const j=ht(O,o.coord),J=Xt(j)[1];L&&L.remove(),L=i(e,o.coord,t.radius,E||C?t.hoverWidth/2:t.width/2,h,J,E||C)};P(o).on("move."+x,function(){const O=ht(o.coord,M);y.setCoord(ct(y.coord,O)),k(y.coord),M=o.coord,y.constraints.fixedDistance.point=o,w=y.coord}),y.onMove=function(O,j){E||(S=w,E=!0);let tt=[O,j];if(t.onMove){const J=Xt(ht(w,o.coord)),I=Xt(ht(tt,o.coord)),ot=J[1],X=I[1];let z=t.onMove(X,ot);z!=null&&z!==!0&&(z===!1&&(z=ot),tt=ct(o.coord,pe(J[0],z)))}return k(tt),w=tt,tt},y.onMoveEnd=function(){if(E=!1,k(y.coord),t.onMoveEnd){const O=Xt(ht(S,o.coord)),j=Xt(ht(y.coord,o.coord));t.onMoveEnd(j[1],O[1])}},y.visibleShape.remove(),v||y.mouseTarget.attr({scale:2});const V=P(y.mouseTarget.getMouseTarget());V.bind("vmouseover",function(O){C=!0,k(y.coord)}),V.bind("vmouseout",function(O){C=!1,k(y.coord)}),k(y.coord);const B=y.remove;return y.remove=function(){B.call(y),L&&L.remove(),P(o).off("move."+x)},y.update=function(){k(y.coord)},y}}(),addReflectButton:function(){const i=function(t,e,o,a,h,f,v){Zi(o[0],o[1])&&(o=[o[0],Vs(o[0],[1,1])]);const x=Di(ht(o[1],o[0])),y=Pt(x,a/2),M=Pt(x,h),w=Je(M,90),S=Je(M,-90),E=uo(y),C=Je(y,90),L=Je(y,-90),k=de(e,w),V=de(e,S),B=de(e,w,y,C),O=de(e,w,E,C),j=de(e,S,y,L),tt=de(e,S,E,L),J=t.path([k,B,O,!0],f),I=t.path([V,j,tt,!0],v);return{remove:function(){J.remove(),I.remove()}}};return function(t){const e=this,o=t.line,a=e.addMovablePoint({constraints:t.constraints,coord:Os([o.pointA.coord,o.pointZ.coord]),snapX:e.snap[0],snapY:e.snap[1],onMove:function(k,V){return!1},onMoveEnd:function(k,V){t.onMoveEnd&&t.onMoveEnd.call(this,k,V)}});let h=!1,f=!1,v;const x=function(){return h},y=b.map([0,1],function(k){const V=k?t.highlightStyle:t.normalStyle;return b.map([0,1],function(B){return b.defaults({"fill-opacity":B},V)})}),M=function(k){return f&&(k=!k),y[+x()][+k]},w=function(k,V){v&&v.remove(),v=i(e,k,V,x()?t.size*1.5:t.size,x()?t.size*.125:.25,M(0),M(1))},S=function(k,V){k=k||o.pointA.coord,V=V||o.pointZ.coord;const B=Os([k,V]);a.setCoord(B),w(B,[k,V])};P(o).on("move",b.bind(S,a,null,null));const E=P(a.mouseTarget.getMouseTarget());E.on("vclick",function(){t.onClick()!==!1&&(f=!f,w(a.coord,[o.pointA.coord,o.pointZ.coord]))}),o.pointA.toFront(),o.pointZ.toFront(),a.visibleShape.remove();const C=e.scaleVector(t.size)[0]/20;a.mouseTarget.attr({scale:1.5*C}),E.css("cursor","pointer"),E.bind("vmouseover",function(k){h=!0,w(a.coord,[o.pointA.coord,o.pointZ.coord])}),E.bind("vmouseout",function(k){h=!1,w(a.coord,[o.pointA.coord,o.pointZ.coord])});const L=a.remove;return a.remove=function(){v.remove(),L.call(a)},a.update=S,a.isFlipped=function(){return f},S(),a}}(),protractor:function(i){return new Xo(this,i)},ruler:function(i){return new Uo(this,i||{})},addPoints:ct});function Xo(i,t){this.set=i.raphael.set(),this.cx=t[0],this.cy=t[1];const e=this,o=i.unscaleVector(180.5)[0],a=i.scalePoint([this.cx-o,this.cy+o-i.unscaleVector(10.5)[1]]),h=i.mouselayer.image("https://ka-perseus-graphie.s3.amazonaws.com/e9d032f2ab8b95979f674fbfa67056442ba1ff6a.png",a[0],a[1],360,180);this.set.push(h),h.node.addEventListener("touchstart",function(C){C.preventDefault()},{passive:!1});const f=function(C,L){const k=i.scaleVector(o);k[0]-=16,k[1]-=16;const V=i.scalePoint(t),B=Math.sin((C+90)*Math.PI/180)*(k[0]+L)+V[0],O=Math.cos((C+90)*Math.PI/180)*(k[1]+L)+V[1];return B+","+O},v=i.raphael.path(" M"+f(180,6)+" L"+f(180,2)+" L"+f(183,10)+" L"+f(180,18)+" L"+f(180,14)+" A"+(i.scaleVector(o)[0]+10)+","+(i.scaleVector(o)[1]+10)+",0,0,1,"+f(170,14)+" L"+f(170,18)+" L"+f(167,10)+" L"+f(170,2)+" L"+f(170,6)+" A"+(i.scaleVector(o)[0]+10)+","+(i.scaleVector(o)[1]+10)+",0,0,0,"+f(180,6)+" Z").attr({stroke:null,fill:H.INTERACTIVE});this.set.push(v),this.centerPoint=i.addMovablePoint({coord:t,visible:!1}),this.rotateHandle=i.addMovablePoint({bounded:!1,coord:[Math.sin(275*Math.PI/180)*o+this.cx,Math.cos(275*Math.PI/180)*o+this.cy],onMove:function(C,L){const k=Math.atan2(e.centerPoint.coord[1]-L,e.centerPoint.coord[0]-C)*180/Math.PI;e.rotate(-k-5,!0)}}),this.rotateHandle.constraints.fixedDistance.dist=o,this.rotateHandle.constraints.fixedDistance.point=this.centerPoint,this.rotateHandle.visibleShape.remove(),this.rotateHandle.mouseTarget.attr({scale:2});let x=!1,y=!1;const M=function(){return y||x},S=P(this.rotateHandle.mouseTarget.getMouseTarget());S.bind("vmousedown",function(C){x=!0,S.css("cursor","-webkit-grabbing"),S.css("cursor","grabbing"),v.animate({scale:1.5,fill:H.INTERACTING},50),P(document).bind("vmouseup.rotateHandle",function(L){x=!1,S.css("cursor","-webkit-grab"),S.css("cursor","grab"),M()||v.animate({scale:1,fill:H.INTERACTIVE},50),P(document).unbind("vmouseup.rotateHandle")})}),S.bind("vmouseover",function(C){y=!0,v.animate({scale:1.5,fill:H.INTERACTING},50)}),S.bind("vmouseout",function(C){y=!1,M()||v.animate({scale:1,fill:H.INTERACTIVE},50)});const E=P.map(this.set,function(C){return C.node});return this.makeTranslatable=function(){P(E).css("cursor","move"),S.css("cursor","-webkit-grab"),S.css("cursor","grab"),P(E).bind("vmousedown",function(L){L.preventDefault();let k=L.pageX-P(i.raphael.canvas.parentNode).offset().left,V=L.pageY-P(i.raphael.canvas.parentNode).offset().top;P(document).bind("vmousemove.protractor",function(B){let O=B.pageX-P(i.raphael.canvas.parentNode).offset().left,j=B.pageY-P(i.raphael.canvas.parentNode).offset().top;O=Math.max(10,Math.min(i.xpixels-10,O)),j=Math.max(10,Math.min(i.ypixels-10,j));const tt=O-k,J=j-V;P.each(e.set.items,function(){this.translate(tt,J)}),e.centerPoint.setCoord([e.centerPoint.coord[0]+tt/i.scale[0],e.centerPoint.coord[1]-J/i.scale[1]]),e.rotateHandle.setCoord([e.rotateHandle.coord[0]+tt/i.scale[0],e.rotateHandle.coord[1]-J/i.scale[1]]),k=O,V=j}),P(document).one("vmouseup",function(B){P(document).unbind("vmousemove.protractor")})})},this.rotation=0,this.rotate=function(C,L){const k=i.scalePoint(this.centerPoint.coord);return L&&(this.rotation=0),this.set.rotate(this.rotation+C,k[0],k[1]),this.rotation=this.rotation+C,this},this.moveTo=function(L,k){const V=i.scalePoint(e.centerPoint.coord),B=i.scalePoint([L,k]),O=bt.getDistance(V,B)*2;P({x:V[0],y:V[1]}).animate({x:B[0],y:B[1]},{duration:O,step:function(j,tt){let J=0,I=0;tt.prop==="x"?J=j-i.scalePoint(e.centerPoint.coord)[0]:tt.prop==="y"&&(I=j-i.scalePoint(e.centerPoint.coord)[1]),P.each(e.set.items,function(){this.translate(J,I)}),e.centerPoint.setCoord([e.centerPoint.coord[0]+J/i.scale[0],e.centerPoint.coord[1]-I/i.scale[1]]),e.rotateHandle.setCoord([e.rotateHandle.coord[0]+J/i.scale[0],e.rotateHandle.coord[1]-I/i.scale[1]])}})},this.rotateTo=function(L){Math.abs(this.rotation-L)>180&&(this.rotation+=360);const k=Math.abs(this.rotation-L)*5;P({0:this.rotation}).animate({0:L},{duration:k,step:function(V,B){e.rotate(V,!0),e.rotateHandle.setCoord([Math.sin((V+275)*Math.PI/180)*o+e.centerPoint.coord[0],Math.cos((V+275)*Math.PI/180)*o+e.centerPoint.coord[1]])}})},this.remove=function(){this.set.remove()},this.makeTranslatable(),this}function Uo(i,t){b.defaults(t,{center:[0,0],pixelsPerUnit:40,ticksPerUnit:10,units:10,label:"",style:{fill:null,stroke:H.GRAY}});const e=b.extend({},t.style,{strokeWidth:1}),o=b.extend({},t.style,{strokeWidth:2}),a=t.units*t.pixelsPerUnit,h=50,f=i.unscalePoint(ht(i.scalePoint(t.center),Pt([a,-h],.5))),v=t.pixelsPerUnit/i.scale[0],x=h/i.scale[0],y=ct(f,[t.units*v,x]),M=1;let w;if(t.ticksPerUnit===10)w={10:M,5:M*.55,1:M*.35};else{const X=[1,.6,.45,.3];w={};for(let z=t.ticksPerUnit;z>=1;z/=2)w[z]=M*(X.shift()||.2)}const S=b.keys(w).sort(function(X,z){return z-X});function E(X){for(let z=0;z<S.length;z++){const st=S[z];if(X%st===0)return w[st]}return 0}const C=f[0],L=f[1],k=y[0],V=y[1],B=t.units*t.ticksPerUnit+1,O=i.raphael.set(),j=1/i.scale[0];O.push(i.line([C-j,L],[k+j,L],o)),O.push(i.line([C-j,V],[k+j,V],o)),b.times(B,function(X){const z=X/t.ticksPerUnit,st=C+z*v,nt=E(X)*x,$=X===0||X===B-1?o:e;if(O.push(i.line([st,L],[st,L+nt],$)),z%1===0){const lt=i.scalePoint([st,V]);let rt,W;z===0?(rt=t.label,W={mm:13,cm:11,m:8,km:11,in:8,ft:8,yd:10,mi:10}[rt]||3*rt.toString().length):(rt=z,W=-3*(z.toString().length+1));const pt=i.raphael.text(lt[0]+W,lt[1]+10,rt);pt.attr({"font-family":"KaTeX_Main","font-size":"12px",color:"#444"}),O.push(pt)}});const tt=i.mouselayer.path(i.svgPath([f,[C,V],y,[k,L],!0]));tt.attr({fill:"#000",opacity:0,stroke:"#000","stroke-width":2}),O.push(tt),tt.node.addEventListener("touchstart",function(X){X.preventDefault()},{passive:!1});const J=P.map(O,function(X){return X.node});P(J).css("cursor","move"),P(J).bind("vmousedown",function(X){X.preventDefault();let z=X.pageX-P(i.raphael.canvas.parentNode).offset().left,st=X.pageY-P(i.raphael.canvas.parentNode).offset().top;P(document).bind("vmousemove.ruler",function(nt){let $=nt.pageX-P(i.raphael.canvas.parentNode).offset().left,lt=nt.pageY-P(i.raphael.canvas.parentNode).offset().top;$=Math.max(10,Math.min(i.xpixels-10,$)),lt=Math.max(10,Math.min(i.ypixels-10,lt));const rt=$-z,W=lt-st;O.translate(rt,W),I.setCoord([I.coord[0]+rt/i.scale[0],I.coord[1]-W/i.scale[1]]),ot.setCoord([ot.coord[0]+rt/i.scale[0],ot.coord[1]-W/i.scale[1]]),z=$,st=lt}),P(document).one("vmouseup",function(nt){P(document).unbind("vmousemove.ruler")})});const I=i.addMovablePoint({coord:f,normalStyle:{fill:H.INTERACTIVE,"fill-opacity":0,stroke:H.INTERACTIVE},highlightStyle:{fill:H.INTERACTING,"fill-opacity":.1,stroke:H.INTERACTING},pointSize:6,onMove:function(X,z){const st=ot.coord[1]-z,nt=ot.coord[0]-X,$=Math.atan2(st,nt)*180/Math.PI,lt=Pt(ct([X,z],ot.coord),.5),rt=i.scalePoint(lt),W=Pt(ct(I.coord,ot.coord),.5),pt=i.scalePoint(W),wt=ht(rt,pt);O.rotate(-$,pt[0],pt[1]),O.translate(wt[0],wt[1])}}),ot=i.addMovablePoint({coord:[k,L],normalStyle:{fill:H.INTERACTIVE,"fill-opacity":0,stroke:H.INTERACTIVE},highlightStyle:{fill:H.INTERACTING,"fill-opacity":.1,stroke:H.INTERACTING},pointSize:6,onMove:function(X,z){const st=z-I.coord[1],nt=X-I.coord[0],$=Math.atan2(st,nt)*180/Math.PI,lt=Pt(ct([X,z],I.coord),.5),rt=i.scalePoint(lt),W=Pt(ct(I.coord,ot.coord),.5),pt=i.scalePoint(W),wt=ht(rt,pt);O.rotate(-$,pt[0],pt[1]),O.translate(wt[0],wt[1])}});return I.constraints.fixedDistance.dist=a/i.scale[0],I.constraints.fixedDistance.point=ot,ot.constraints.fixedDistance.dist=a/i.scale[0],ot.constraints.fixedDistance.point=I,this.remove=function(){O.remove(),I.remove(),ot.remove()},this}function pn(i,t){if(this.graphie=i,b.extend(this,t),b.defaults(this,{normalStyle:{stroke:H.INTERACTIVE,"stroke-width":2,fill:H.INTERACTIVE},highlightStyle:{stroke:H.INTERACTING,"stroke-width":2,fill:H.INTERACTING},labelStyle:{stroke:H.DYNAMIC,"stroke-width":1,color:H.DYNAMIC},angleStyle:{stroke:H.DYNAMIC,"stroke-width":1,color:H.DYNAMIC},allowReflex:!0}),!this.points||this.points.length!==3)throw new $t("MovableAngle requires 3 points",Ft.InvalidInput);this.points=b.map(t.points,function(e){return b.isArray(e)?i.addMovablePoint({coord:e,visible:!1,constraints:{fixed:!0},normalStyle:this.normalStyle}):e},this),this.coords=b.pluck(this.points,"coord"),this.reflex==null&&(this.allowReflex?this.reflex=this._getClockwiseAngle(this.coords)>180:this.reflex=!1),this.rays=b.map([0,2],function(e){return i.addMovableLineSegment({pointA:this.points[1],pointZ:this.points[e],fixed:!0,extendRay:!0})},this),this.temp=[],this.labeledAngle=i.label([0,0],"","center",this.labelStyle),this.fixed||(this.addMoveHandlers(),this.addHighlightHandlers()),this.update()}b.extend(pn.prototype,{points:[],snapDegrees:0,snapOffsetDeg:0,angleLabel:"",numArcs:1,pushOut:0,fixed:!1,addMoveHandlers:function(){const i=this.graphie;function t(h,f){return bt.getDistance(i.scalePoint(h),i.scalePoint(f))<30}const e=this.points;e[1].onMove=function(h,f){const v=e[1].coord,x=[h,f],y=ct(x,Oi(v));let M=!0;const w={};return b.each([0,2],function(S){const E=e[S].coord;let C=ct(E,y),L=bt.findAngle(x,C);L*=Math.PI/180,C=i.constrainToBoundsOnAngle(C,10,L),w[S]=C,t(x,C)&&(M=!1)}),M&&b.each(w,function(S,E){e[E].setCoord(S)}),M};const o=this.snapDegrees,a=this.snapOffsetDeg;b.each([0,2],function(h){e[h].onMove=function(f,v){const x=[f,v],y=e[1].coord;if(t(y,x))return!1;if(o){let M=bt.findAngle(x,y);M=Math.round((M-a)/o)*o+a;const w=bt.getDistance(x,y);return ct(y,Fi(w,M))}return!0}}),P(e).on("move",(function(){this.update(),P(this).trigger("move")}).bind(this))},addHighlightHandlers:function(){const i=this.points[1];i.onHighlight=(function(){b.each(this.points,function(t){t.visibleShape.animate(this.highlightStyle,50)},this),b.each(this.rays,function(t){t.visibleLine.animate(this.highlightStyle,50),t.arrowStyle=b.extend({},t.arrowStyle,{color:this.highlightStyle.stroke,stroke:this.highlightStyle.stroke})},this),this.angleStyle=b.extend({},this.angleStyle,{color:this.highlightStyle.stroke,stroke:this.highlightStyle.stroke}),this.update()}).bind(this),i.onUnhighlight=(function(){b.each(this.points,function(t){t.visibleShape.animate(this.normalStyle,50)},this),b.each(this.rays,function(t){t.visibleLine.animate(t.normalStyle,50),t.arrowStyle=b.extend({},t.arrowStyle,{color:t.normalStyle.stroke,stroke:t.normalStyle.stroke})},this),this.angleStyle=b.extend({},this.angleStyle,{color:H.DYNAMIC,stroke:H.DYNAMIC}),this.update()}).bind(this)},_getClockwiseAngle:function(i){return bt.findAngle(i[2],i[0],i[1])+360%360},isReflex:function(){return this.reflex},isClockwise:function(){return this._getClockwiseAngle(this.coords)>180===this.reflex},getClockwiseCoords:function(){return this.isClockwise()?b.clone(this.coords):b.clone(this.coords).reverse()},update:function(i){const t=this.coords;this.coords=b.pluck(this.points,"coord"),b.invoke(this.points,"updateLineEnds");const e=this._getClockwiseAngle(t),o=this._getClockwiseAngle(this.coords),a=e>180,h=o>180;this.allowReflex&&(i==null&&(i=a!==h&&Math.abs(o-e)<180),i&&(this.reflex=!this.reflex)),b.invoke(this.temp,"remove"),this.temp=this.graphie.labelAngle({point1:this.coords[0],vertex:this.coords[1],point3:this.coords[2],label:this.labeledAngle,text:this.angleLabel,numArcs:this.numArcs,pushOut:this.pushOut,clockwise:this.reflex===h,style:this.angleStyle})},remove:function(){b.invoke(this.rays,"remove"),b.invoke(this.temp,"remove"),this.labeledAngle.remove()}});const Us=kt.nestedMap,qo=kt.deepEq;function Qi(i){b.extend(this,i)}const Ei=function(){throw new $t("Abstract method! Must be implemented by Graphie Movable"+this.constructor.displayName,Ft.NotAllowed)};b.extend(Qi.prototype,{movableProps:[],add:Ei,modify:Ei,remove:Ei,toFront:function(){},componentDidMount:function(){}});const Zo=function(i,t){return b.extend({},i,{children:b.filter(b.flatten(t),b.identity)})},gn=function(i){const t=function(e){if(!(this instanceof t))throw new $t("Use createElement or JSX with graphie movables",Ft.NotAllowed);return this.props=Zo(e,e.children||[]),this};return i.displayName=i.displayName||b.uniqueId("GraphieClass"),t.displayName=i.displayName,t.prototype=new Qi(i),t.prototype.constructor=t,t},Wo=function(i){return gn({displayName:i.name||b.uniqueId("GraphieSimpleClass"),movableProps:["children"],add:function(t){this._elements=i(t,this.props),this._prevProps=this.props},modify:function(t){if(!qo(this.props,this._prevProps))return this.remove(),this.add(t),this._prevProps=this.props,"reordered"},remove:function(){Us(this._elements,t=>{t&&t.remove()}),this._elements=null,this._prevProps=null},toFront:function(){Us(this._elements,t=>{b.isFunction(t.toFront)&&t.toFront()})}})},Rt={GraphieMovable:Qi,createClass:gn,createSimpleClass:Wo},$o=Tt.normalizeOptions,Ko=Tt.assert,jo={cursor:null},Jo={added:!1,isHovering:!1,isMouseOver:!1,isDragging:!1,mouseTarget:null};class Li{constructor(t,e){this._listenerMap={},this.graphie=t,this.state={id:b.uniqueId("movable")},this.modify({...Jo,...e})}modify(t){this.update({...this._createDefaultState(),...t})}_createDefaultState(){return{id:this.state.id,add:[],modify:[],draw:[],remove:[],onMoveStart:[],onMove:[],onMoveEnd:[],onClick:[],...jo}}update(t){const e=this.graphie,o=this.cloneState(),a=Object.assign(this.state,$o(t));if(a.mouseTarget&&!o.mouseTarget){let h;a.mouseTarget.getMouseTarget?h=P(a.mouseTarget.getMouseTarget()):h=P(a.mouseTarget[0]),!("ontouchstart"in window)&&(h.on("vmouseover",()=>{a.isMouseOver=!0,e.isDragging||(a.isHovering=!0),this.state.added&&this.draw()}),h.on("vmouseout",()=>{a.isMouseOver=!1,a.isDragging||(a.isHovering=!1),this.state.added&&this.draw()})),h[0].addEventListener("touchstart",function(v){v.preventDefault()},{passive:!1}),h.on("vmousedown",v=>{if(v.which!==0&&v.which!==1)return;v.preventDefault();const x=e.getMouseCoord(v);this.grab(x)})}if(a.mouseTarget&&a.cursor!==void 0){let h;a.mouseTarget.getMouseTarget?h=P(a.mouseTarget.getMouseTarget()):h=P(a.mouseTarget[0]),h.css("cursor",a.cursor||"")}a.added||(this._fireEvent(a.modify,this.cloneState(),{}),a.added=!0,this.prevState=this.cloneState()),this._fireEvent(a.modify,this.cloneState(),this.prevState)}cloneState(){return{...this.state}}_fireEvent(t,...e){if(t!=null)for(const o of t)o.call(this,...e)}draw(){const t=this.cloneState();this._fireEvent(this.state.draw,t,this.prevState),this.prevState=t}grab(t){Ko(Jt(t));const e=this.graphie,o=this.state;o.isHovering=!0,o.isDragging=!0,e.isDragging=!0;const a=t;let h=a;this._fireEvent(o.onMoveStart,a,a);const f=x=>{x.preventDefault();const y=e.getMouseCoord(x);this._fireEvent(o.onMove,y,h),this.draw(),h=y},v=()=>{P(document).unbind("vmousemove",f),P(document).unbind("vmouseup",v),o.isHovering&&this._fireEvent(o.onClick,h,a),o.isHovering=this.state.isMouseOver,o.isDragging=!1,e.isDragging=!1,this._fireEvent(o.onMoveEnd,h,a),this.draw()};P(document).bind("vmousemove",f),P(document).bind("vmouseup",v)}_applyConstraints(t,e,o){let a=!1;return(this.state.constraints??[]).reduce((h,f)=>{if(h===!1)return!1;if(a)return h;const v=f.call(this,h,e,{onSkipRemaining:()=>{a=!0},...o});if(v===!1)return!1;if(Jt(v,2))return v;if(v===!0||v==null)return h;throw new $t("Constraint returned invalid result: "+v,Ft.Internal)},t)}toBack(){this.state.mouseTarget&&this.state.mouseTarget.toBack()}toFront(){this.state.mouseTarget&&this.state.mouseTarget.toFront()}listen(t,e,o){this._listenerMap=this._listenerMap||{};const a=qs(t,e),h=this._listenerMap[a]=this._listenerMap[a]||this.state[t].length;this.state[t][h]=o}unlisten(t,e){this._listenerMap=this._listenerMap||{};const o=qs(t,e),a=this._listenerMap[o];a!==void 0&&(this.state[t].splice(a,1),delete this._listenerMap[o],b.keys(this._listenerMap).forEach(f=>{Qo(f)===t&&this._listenerMap[f]>a&&this._listenerMap[f]--}))}remove(){this.state.added=!1,this._fireEvent(this.state.remove),this.state.mouseTarget&&(P(this.state.mouseTarget).off(),this.state.mouseTarget.remove(),this.state.mouseTarget=null)}cursor(){return this.state.cursor}added(){return this.state.added}isHovering(){return this.state.isHovering}isMouseOver(){return this.state.isMouseOver}isDragging(){return this.state.isDragging}mouseTarget(){return this.state.mouseTarget}}function qs(i,t){return i+":"+t}function Qo(i){return i.split(":")[0]}const Zs=function(i){const t=i.graphie.scalePoint(i.coord(0)),e=i.graphie.scalePoint(i.coord(1));return Xt(ht(e,t))[1]},ti={draw:function(){this.draw()},pointsToFront:function(i){b.invoke(i.points,"toFront")}};ti.standard=[ti.draw,ti.pointsToFront];const zi={draw:function(){this.draw()}};zi.standard=[zi.draw];const Ie={basic:function(i){const t=this.graphie;let e=this.coord(0),o=this.coord(1);if(!this.state.visibleShape){const f={thickness:10};this.state.visibleShape=new li(t,e,o,f),this.state.visibleShape.attr(this.normalStyle()),this.state.visibleShape.toFront(),this.mouseTarget()&&this.mouseTarget().toFront()}const a=Zs(this);i.extendLine?(e=Qe(t,e,360-a),o=Qe(t,o,(540-a)%360)):i.extendRay&&(o=Qe(t,o,360-a));const h=[this.state.visibleShape];this.mouseTarget()&&h.push(this.mouseTarget()),b.each(h,function(f){f.moveTo(e,o)})},arrows:function(i){this._arrows==null&&(this._arrows=[],i.extendLine?(this._arrows.push(new ie(this.graphie,this.normalStyle())),this._arrows.push(new ie(this.graphie,this.normalStyle()))):i.extendRay&&this._arrows.push(new ie(this.graphie,this.normalStyle())));const t=Zs(this),e=[360-t,(540-t)%360];b.each(this._arrows,function(o,a){o.toCoordAtAngle(this.coord(a),e[a])},this)},highlight:function(i,t){i.isHovering&&!t.isHovering?i.visibleShape.animate(i.highlightStyle,50):!i.isHovering&&t.isHovering&&i.visibleShape.animate(i.normalStyle,50)}};Ie.standard=[Ie.basic,Ie.arrows,Ie.highlight];const ei={basic:function(){this.state.visibleShape&&this.state.visibleShape.remove()},arrows:function(){this._arrows!=null&&b.invoke(this._arrows,"remove"),this._arrows=null}};ei.standard=[ei.basic,ei.arrows];const mn={fixed:function(){return function(){return!1}},snap:function(i){return function(t,e){if(i===null)return!0;let o=ht(t,e);return i=i||this.graphie.snap,o=Wi(o,i),ct(e,o)}},bound:function(i,t,e){return e===void 0&&(i===void 0?e=10:e=0),function(o,a){const h=this.graphie,f=ht(o,a);i=i||h.range,t===void 0&&(t=h.snap);let v=h.unscalePoint([e,h.ypixels-e]),x=h.unscalePoint([h.xpixels-e,e]);t&&(v=Ki(v,t),x=$i(x,t));const y=b.map(this.coords(),function(w,S){const E=ht(x,w);return[ht(v,w),E]}),M=b.reduce(y,function(w,S){const E=S[0],C=S[1],L=Math.max(E[0],Math.min(C[0],w[0])),k=Math.max(E[1],Math.min(C[1],w[1]));return[L,k]},f);return ct(a,M)}}};mn.standard=null;const vn={updatePoints:function(i,t){const e=ht(i,t);b.each(this.state.points,function(o){o.setCoord(ct(o.coord(),e))})}};vn.standard=null;const bn={add:ti,modify:zi,draw:Ie,remove:ei,onMoveStart:{standard:null},constraints:mn,onMove:vn,onMoveEnd:{standard:null}},tr=function(i,t){return b.object(b.map(i,function(e,o){return[o,e[t]]}))},er=function(i,t){const e={};return b.each(b.keys(i),function(o){e[o]=t(i[o],o)}),e},ir=function(i,t){const e={};return b.each(i,function(o){e[o]=t(o)}),e},ts={pluck:tr,mapObject:er,mapObjectFromArray:ir},Ws=Tt.assert,$s=Tt.normalizeOptions,yn={points:null,static:!1,cursor:"move",normalStyle:null,highlightStyle:null,extendLine:!1,extendRay:!1},xn={visibleShape:null,mouseTarget:null},xe=function(i,t,e){Ws(i!=null),Ws(e!=null),b.extend(this,{graphie:i,movable:t,state:{id:b.uniqueId("movableLine")}}),this.modify(b.extend({},xn,e))};b.extend(xe,bn);Tt.createGettersFor(xe,b.extend({},yn,xn));Tt.addMovableHelperMethodsTo(xe);b.extend(xe.prototype,{cloneState:function(){return b.extend(this.movable.cloneState(),{coords:this.coords()},this.state)},_createDefaultState:function(){return b.extend({id:this.state.id},$s(ts.pluck(bn,"standard")),yn)},modify:function(i){this.update(b.extend(this._createDefaultState(),i))},update:function(i){const t=this,e=this.graphie,o=t.state=b.extend(t.state,$s(i)),a=o.static?H.DYNAMIC:H.INTERACTIVE;if(o.normalStyle=b.extend({stroke:a,"stroke-width":2},o.normalStyle),o.highlightStyle=b.extend({stroke:H.INTERACTING,"stroke-width":3},o.highlightStyle),!o.static&&!o.mouseTarget){const h={thickness:30,mouselayer:!0,interactiveKindForTesting:"movable-line"};o.mouseTarget=new li(e,this.coord(0),this.coord(1),h),o.mouseTarget.attr({fill:"#000",opacity:0})}o.static&&o.mouseTarget&&(o.mouseTarget.remove(),o.mouseTarget=null),t.movable.modify(b.extend({},o,{mouseTarget:o.mouseTarget,add:null,modify:null,draw:t.draw.bind(t),remove:null,onMoveStart:function(){t._initialRefCoord=t.coord(0),t._prevRefCoord=t._initialRefCoord,t._totalDelta=[0,0],t._fireEvent(t.state.onMoveStart,t.coord(0),t.coord(0))},onMove:function(h,f){const v=ht(h,f);t._totalDelta=ct(t._totalDelta,v);let x=ct(t._initialRefCoord,t._totalDelta);x=t._applyConstraints(x,t._prevRefCoord),x!==!1&&(t._fireEvent(t.state.onMove,x,t._prevRefCoord),t._prevRefCoord=x)},onMoveEnd:function(){t._fireEvent(t.state.onMoveEnd,t._prevRefCoord,t._initialRefCoord)}})),o.added||(t.prevState={},t._fireEvent(o.add,t.cloneState(),t.prevState),o.added=!0,b.invoke(o.points,"listen","onMove",o.id,t.draw.bind(t)),t.prevState=t.cloneState()),t._fireEvent(o.modify,t.cloneState(),t.prevState)},coords:function(){return b.invoke(this.state.points,"coord")},point:function(i){return this.state.points[i]},coord:function(i){return this.point(i).coord()},remove:function(){this.state.added=!1,this._fireEvent(this.state.remove),this.points&&b.invoke(this.points,"unlisten","onMove",this.state.id),this.movable&&this.movable.remove()},toBack:function(){this.movable.toBack(),this.state.visibleShape&&this.state.visibleShape.toBack()},toFront:function(){this.state.visibleShape&&this.state.visibleShape.toFront(),this.movable.toFront()},isHovering:function(){return this.movable.isHovering()},isDragging:function(){return this.movable.isDragging()},mouseTarget:function(){return this.movable.mouseTarget()}});const Hi={constrain:function(){this.constrain()}};Hi.standard=[Hi.constrain];const Yi={draw:function(){this.draw()}};Yi.standard=[Yi.draw];const si={basic:function(i,t){const e=this.graphie;if(!this.state.visibleShape){const o=[this.pointSize()/e.scale[0],this.pointSize()/e.scale[1]],a={maxScale:Math.max(this.highlightStyle().scale,this.normalStyle().scale),padding:10,shadow:i.shadow};this.state.visibleShape=new ai(e,this.coord(),o,a),this.state.visibleShape.attr(b.omit(this.normalStyle(),"scale")),this.state.visibleShape.toFront(),this.mouseTarget()&&this.mouseTarget().toFront()}i.normalStyle!==t.normalStyle&&!b.isEqual(i.normalStyle,t.normalStyle)&&this.state.visibleShape.attr(this.normalStyle()),this.state.visibleShape.moveTo(this.coord()),this.mouseTarget()&&this.mouseTarget().moveTo(this.coord())},highlight:function(i,t){i.isHovering&&!t.isHovering?i.visibleShape.animate(this.highlightStyle(),50):!i.isHovering&&t.isHovering&&i.visibleShape.animate(this.normalStyle(),50)}};si.standard=[si.basic,si.highlight];const Xi={basic:function(){this.state.visibleShape&&(this.state.visibleShape.remove(),this.state.visibleShape=null)}};Xi.standard=Xi.basic;const wn={fixed:function(){return function(){return!1}},snap:function(i){return function(t){return i===null?!0:Wi(t,i||this.graphie.snap)}},bound:function(i,t,e){const o=e===void 0?i===void 0?10:0:e;return function(a,h,f){const v=this.graphie;i=i||v.range,t===void 0&&(t=v.snap);let x=v.unscalePoint([o,v.ypixels-o]),y=v.unscalePoint([v.xpixels-o,o]);if(t&&(x=Ki(x,t),y=$i(y,t)),f&&f.onOutOfBounds)return(a[0]>y[0]||a[0]<x[0]||a[1]>y[1]||a[1]<x[1])&&(f.onSkipRemaining(),f.onOutOfBounds()),a;const M=Math.max(x[0],Math.min(y[0],a[0])),w=Math.max(x[1],Math.min(y[1],a[1]));return[M,w]}}};wn.standard=null;const Wt={add:Hi,modify:Yi,draw:si,remove:Xi,onMoveStart:{standard:null},constraints:wn,onMove:{standard:null},onMoveEnd:{standard:null},onClick:{standard:null}},Ii=Tt.assert,Ks=Tt.normalizeOptions,{processMath:sr}=fn,nr={coord:[0,0],pointSize:4,static:!1,cursor:"move",normalStyle:null,highlightStyle:null,shadow:!1,tooltip:!1},or={added:!1,hasMoved:!1,visibleShape:null,outOfBounds:!1,mouseTarget:null,touchOffset:null},js=[];var Gt;let Js=(Gt=class{constructor(t,e,o){this._listenerMap={},this.graphie=t,this.movable=e,this.state={id:b.uniqueId("movablePoint")},this.modify({...or,...o})}modify(t){this.update(b.extend(this._createDefaultState(),t))}_createDefaultState(){return{id:this.state.id,...Ks(ts.pluck(Wt,"standard")),...nr}}cloneState(){return{...this.movable.cloneState(),...this.state}}update(t){const e=this,o=e.graphie,a=b.extend(e.state,Ks(t));Ii(Jt(a.coord));const h=a.static?H.DYNAMIC:H.INTERACTIVE;if(a.normalStyle=b.extend({fill:h,stroke:h,scale:1},a.normalStyle),a.highlightStyle=b.extend({fill:H.INTERACTING,stroke:H.INTERACTING,scale:2},a.highlightStyle),!a.static&&!a.mouseTarget){const x=e.state.coord,y=o.unscaleVector(24),M={mouselayer:!0,padding:0,interactiveKindForTesting:"movable-point"};a.mouseTarget=new ai(o,x,y,M),a.mouseTarget.attr({fill:"#000",opacity:0})}const f=()=>{this._showTooltip(x=>{un(zt("span",{style:{fontSize:"2em"},children:zt(ao,{...lo,style:{position:"static",color:H.INTERACTIVE,marginLeft:9,marginRight:9}})}),x)})};let v=a.coord;e.movable.modify(b.extend({},a,{add:null,modify:null,draw:e.draw.bind(e),remove:null,onMoveStart:x=>{if(a.hasMoved=!1,v=a.coord,a.touchOffset==null){const M=!("ontouchstart"in window);a.touchOffset=M?[0,0]:ht(v,x)}const y=a.visibleShape.wrapper;if(a.shadow){const M="none";y.style.filter=M}if(a.showHairlines&&a.showHairlines(a.coord),js.forEach(M=>M()),a.tooltip&&(a.xOnlyTooltip?this._showTooltip(`${a.coord[0]}`):this._showTooltip(`(${a.coord[0]}, ${a.coord[1]})`),a.shadow)){const M=y.getElementsByClassName("tooltip-content")[0],w="drop-shadow(0px 0px 5px rgba(0, 0, 0, 0.5))";M.style.filter=w}e._fireEvent(a.onMoveStart,v,v),e.draw()},onMove:(x,y)=>{const M=ct(x,a.touchOffset);e.moveTo(M),a.showHairlines&&(this.state.outOfBounds?a.hideHairlines():a.showHairlines(a.coord)),a.tooltip&&(this.state.outOfBounds||(a.xOnlyTooltip?this._showTooltip(`${a.coord[0]}`):this._showTooltip(`(${a.coord[0]}, ${a.coord[1]})`))),a.onRemove&&this.state.outOfBounds&&f()},onMoveEnd:()=>{e.isHovering()&&!a.hasMoved&&e._fireEvent(a.onClick,a.coord,v);const x=a.visibleShape.wrapper;if(a.shadow){const y="drop-shadow(0px 0px 5px rgba(0, 0, 0, 0.5))";x.style.filter=y}if(a.hideHairlines&&a.hideHairlines(),a.hasMoved)this._hideTooltip();else if(a.onRemove){f();const y=x.getElementsByClassName("tooltip-content")[0];y.style.filter="none",this._tooltip.firstChild.addEventListener("touchstart",M=>{M.stopPropagation()},!0),this._tooltip.firstChild.addEventListener("touchend",M=>{a.onRemove(),M.stopPropagation()},!0)}else a.tooltip&&this._hideTooltip();a.outOfBounds&&a.onRemove(),e._fireEvent(a.onMoveEnd,a.coord,v),a.hasMoved=!1,a.touchOffset=null,e.draw()}})),a.added||(e.prevState={},e._fireEvent(a.add,e.cloneState(),e.prevState),a.added=!0,e.prevState=e.cloneState()),e._fireEvent(a.modify,e.cloneState(),e.prevState)}draw(){const t=this.cloneState();this._fireEvent(this.state.draw,t,this.prevState),this.prevState=t}constrain(){const t=this._applyConstraints(this.coord(),this.coord());return Jt(t)&&this.setCoord(t),t!==!1}_fireEvent(t,...e){for(const o of t)o.call(this,...e)}_applyConstraints(t,e,o){let a=!1;return this.state.constraints.reduce((h,f)=>{if(h===!1)return!1;if(a)return h;const v=f.call(this,h,e,{onSkipRemaining:()=>{a=!0},...o});if(v===!1)return!1;if(Jt(v,2))return v;if(v===!0||v==null)return h;throw new $t("Constraint returned invalid result: "+v,Ft.Internal)},t)}_showTooltip(t){this._tooltip||(this._tooltip=document.createElement("div"),this._tooltip.className="tooltip-content",this.state.visibleShape.wrapper.className="tooltip",this.state.visibleShape.wrapper.appendChild(this._tooltip),js.push(()=>{this.state.added&&this._hideTooltip()})),this._tooltip.firstChild&&this._tooltip.removeChild(this._tooltip.firstChild),this.state.visibleShape.wrapper.className="tooltip visible",this._tooltip.appendChild(document.createElement("span")),typeof t=="string"?sr(this._tooltip.firstChild,t,!1):typeof t=="function"?t(this._tooltip.firstChild):this._tooltip.firstChild.appendChild(t)}_hideTooltip(){this._tooltip&&(this.state.visibleShape.wrapper.className="tooltip")}coord(){return this.state.coord}setCoord(t){Ii(Jt(t,2)),this.state.coord=b.clone(t),this.draw()}setCoordConstrained(t){Ii(Jt(t,2));const e=this._applyConstraints(t,this.coord());e!==!1&&(this.state.coord=b.clone(e),this.draw())}listen(t,e,o){this._listenerMap=this._listenerMap||{};const a=Qs(t,e),h=this._listenerMap[a]=this._listenerMap[a]||this.state[t].length;this.state[t][h]=o}unlisten(t,e){this._listenerMap=this._listenerMap||{};const o=Qs(t,e),a=this._listenerMap[o];if(a!==void 0){this.state[t].splice(a,1),delete this._listenerMap[o];const h=b.keys(this._listenerMap);b.each(h,f=>{rr(f)===t&&this._listenerMap[f]>a&&this._listenerMap[f]--},this)}}grab(t){this.state.touchOffset=[0,0],this.movable.grab(t),this.moveTo(t)}moveTo(t){const e=this.state;this.state.outOfBounds=!1;const o=this._applyConstraints(t,e.coord,e.onRemove?{onOutOfBounds:()=>{this.state.outOfBounds=!0},onSkipRemaining:()=>{}}:{onSkipRemaining:()=>{}});if(o!==!1&&(Jt(o)&&(t=o),!Zi(t,e.coord))){const a=e.coord;e.coord=t,e.hasMoved=!0,this._fireEvent(e.onMove,e.coord,a),this.draw()}}remove(){this.state.added=!1,this._fireEvent(this.state.remove),this.movable&&this.movable.remove(),this.state.mouseTarget=null}pointSize(){return this.state.pointSize}static(){return this.state.static}cursor(){return this.state.cursor}normalStyle(){return this.state.normalStyle}highlightStyle(){return this.state.highlightStyle}shadow(){return this.state.shadow}tooltip(){return this.state.tooltip}added(){return this.state.added}hasMoved(){return this.state.hasMoved}visibleShape(){return this.state.visibleShape}outOfBounds(){return this.state.outOfBounds}mouseTarget(){return this.state.mouseTarget}touchOffset(){return this.state.touchOffset}isHovering(){return this.movable.isHovering()}isDragging(){return this.movable.isDragging()}toBack(){this.movable.toBack(),this.state.visibleShape&&this.state.visibleShape.toBack()}toFront(){this.state.visibleShape&&this.state.visibleShape.toFront(),this.movable.toFront()}},Gt.add=Wt.add,Gt.modify=Wt.modify,Gt.draw=Wt.draw,Gt.remove=Wt.remove,Gt.onMoveStart=Wt.onMoveStart,Gt.constraints=Wt.constraints,Gt.onMove=Wt.onMove,Gt.onMoveEnd=Wt.onMoveEnd,Gt.onClick=Wt.onClick,Gt);function Qs(i,t){return i+":"+t}function rr(i){return i.split(":")[0]}function ar(i){return b.reduce(i,function(t,e){return t+e},0)}function lr(i){const t=b.zip(i,i.slice(1).concat(i.slice(0,1))),e=b.map(t,function(o){const a=o[0],h=o[1];return(h[0]-a[0])*(h[1]+a[1])});return ar(e)>0}const ni={constrain:function(){this.constrain()},pointsToFront:function(i){b.invoke(i.points,"toFront")}};ni.standard=[ni.constrain,ni.pointsToFront];const Ui={draw:function(){this.draw()}};Ui.standard=[Ui.draw];const Re={basic:function(i,t){const e=this.graphie,o=this.path(i);this.state.visibleShape||(this.state.visibleShape=e.raphael.path(o),this.state.visibleShape.attr(this.normalStyle())),i.normalStyle!==t.normalStyle&&!b.isEqual(i.normalStyle,t.normalStyle)&&this.state.visibleShape.attr(this.normalStyle()),this.state.visibleShape.attr({path:o}),this.mouseTarget()&&this.mouseTarget().attr({path:o})},labels:function(i,t){const e=this.graphie,o=this,a=b.invoke(i.points,"coord"),h=lr(a),f=a.length;o.state._labelCache!=null&&b.invoke(o.state._labelCache,"remove"),o.state._labelCache=[],(i.angleLabels.length||i.showRightAngleMarkers.length)&&(o.state._labeledAngles==null&&(o.state._labeledAngles=b.times(Math.max(i.angleLabels.length,i.showRightAngleMarkers.length),function(){return e.label([0,0],"","center",i.labelStyle)})),b.each(o.state._labeledAngles,function(v,x){o.state._labelCache.push(e.labelAngle({point1:a[(x-1+f)%f],vertex:a[x],point3:a[(x+1)%f],label:v,text:i.angleLabels[x],showRightAngleMarker:i.showRightAngleMarkers[x],numArcs:i.numArcs[x],clockwise:h,style:i.labelStyle}))})),i.sideLabels.length&&(o.state._labeledSides==null&&(o.state._labeledSides=b.map(i.sideLabels,function(v){return e.label([0,0],"","center",i.labelStyle)})),b.each(o.state._labeledSides,function(v,x){o.state._labelCache.push(e.labelSide({point1:a[x],point2:a[(x+1)%f],label:v,text:i.sideLabels[x],numArrows:i.numArrows[x],numTicks:i.numTicks[x],clockwise:h,style:i.labelStyle}))})),i.vertexLabels.length&&(o.state._labeledVertices==null&&(o.state._labeledVertices=b.map(i.vertexLabels,function(v){return e.label([0,0],"","center",i.labelStyle)})),b.each(o.state._labeledVertices,function(v,x){o.state._labelCache.push(e.labelVertex({point1:a[(x-1+f)%f],vertex:a[x],point3:a[(x+1)%f],label:v,text:i.vertexLabels[x],clockwise:h,style:i.labelStyle}))})),o.state._labelCache=b.flatten(o.state._labelCache)},highlight:function(i,t){i.isHovering&&!t.isHovering?i.visibleShape.animate(this.highlightStyle(),50):!i.isHovering&&t.isHovering&&i.visibleShape.animate(this.normalStyle(),50)}};Re.standard=[Re.basic,Re.labels,Re.highlight];const oi={basic:function(){this.state.visibleShape&&this.state.visibleShape.remove()},labels:function(){const i=[this.state._labeledSides,this.state._labeledVertices,this.state._labeledAngles,this.state._labelCache];b.each(i,function(t){t!=null&&t.length&&b.invoke(t,"remove")})}};oi.standard=[oi.basic,oi.labels];const Mn={fixed:function(){return function(){return!1}},snap:function(i){return function(t){return i===null?!0:(i=i||this.graphie.snap,Wi(t,i))}},bound:function(i,t,e){return e===void 0&&(i===void 0?e=10:e=0),function(o,a){const h=this.graphie,f=ht(o,a);i=i||h.range,t===void 0&&(t=h.snap);let v=h.unscalePoint([e,h.ypixels-e]),x=h.unscalePoint([h.xpixels-e,e]);t&&(v=Ki(v,t),x=$i(x,t));const y=b.map(this.coords(),function(w,S){const E=ht(x,w);return[ht(v,w),E]}),M=b.reduce(y,function(w,S){const E=S[0],C=S[1],L=Math.max(E[0],Math.min(C[0],w[0])),k=Math.max(E[1],Math.min(C[1],w[1]));return[L,k]},f);return ct(a,M)}}};Mn.standard=null;const Sn={updatePoints:function(i,t){const e=ht(i,t);b.each(this.state.points,function(o){o.setCoord(ct(o.coord(),e))})}};Sn.standard=null;const Tn={add:ni,modify:Ui,draw:Re,remove:oi,onMoveStart:{standard:null},constraints:Mn,onMove:Sn,onMoveEnd:{standard:null},onClick:{standard:null}},tn=Tt.assert,en=Tt.normalizeOptions,_n={points:null,angleLabels:[],showRightAngleMarkers:[],sideLabels:[],vertexLabels:[],numArcs:[],numArrows:[],numTicks:[],closed:!0,static:!1,cursor:"move",normalStyle:null,highlightStyle:null,labelStyle:null},kn={added:!1,hasMoved:!1,visibleShape:null,mouseTarget:null},we=function(i,t,e){tn(i!=null),tn(e!=null),b.extend(this,{graphie:i,movable:t,state:{id:b.uniqueId("movablePolygon")}}),this.modify(b.extend({},kn,e))};b.extend(we,Tn);Tt.createGettersFor(we,b.extend({},_n,kn));Tt.addMovableHelperMethodsTo(we);b.extend(we.prototype,{cloneState:function(){return b.extend(this.movable.cloneState(),this.state)},_createDefaultState:function(){return b.extend({id:this.state.id},en(ts.pluck(Tn,"standard")),_n)},modify:function(i){this.update(b.extend(this._createDefaultState(),i))},update:function(i){const t=this,e=t.graphie,o=b.extend(t.state,en(i)),a=o.static?H.DYNAMIC:H.INTERACTIVE;o.normalStyle=b.extend({},o.normalStyle,{"stroke-width":2,"fill-opacity":0,fill:a,stroke:a},i.normalStyle),o.highlightStyle=b.extend({},{stroke:H.INTERACTING,"stroke-width":2,fill:H.INTERACTING,"fill-opacity":.05},o.highlightStyle),o.labelStyle=b.extend({},{stroke:H.DYNAMIC,"stroke-width":1,color:H.DYNAMIC},o.labelStyle),o.static||o.mouseTarget||(o.mouseTarget=e.mouselayer.path(this.path()),o.mouseTarget.attr({fill:"#000",opacity:0,cursor:"move"})),t.movable.modify(b.extend({},o,{modify:null,draw:t.draw.bind(t),remove:null,onMoveStart:function(){t._initialRefCoord=t.coord(0),t._prevRefCoord=t._initialRefCoord,t._totalDelta=[0,0],t._fireEvent(t.state.onMoveStart,t.coord(0),t.coord(0))},onMove:function(h,f){const v=ht(h,f);t._totalDelta=ct(t._totalDelta,v);let x=ct(t._initialRefCoord,t._totalDelta);x=t._applyConstraints(x,t._prevRefCoord),x!==!1&&(t._fireEvent(t.state.onMove,x,t._prevRefCoord),t._prevRefCoord=x)},onMoveEnd:function(){t._fireEvent(t.state.onMoveEnd,t._prevRefCoord,t._initialRefCoord)}})),b.invoke(o.points,"listen","onMove",o.id,t.draw.bind(t)),o.added||(t.prevState={},t._fireEvent(o.add,t.cloneState(),t.prevState),o.added=!0,t.prevState=t.cloneState()),t._fireEvent(o.modify,t.cloneState(),t.prevState)},path:function(i){const t=this.graphie;i=i||this.state;let e=b.map(i.points,function(o){return t.scalePoint(o.coord())});return i.closed?e.push(!0):e=e.concat(b.clone(e).reverse()),bt.unscaledSvgPath(e)},coords:function(){return b.invoke(this.state.points,"coord")},point:function(i){return this.state.points[i]},coord:function(i){return this.point(i).coord()},remove:function(){this.state.added=!1,this._fireEvent(this.state.remove),this.state.points&&b.invoke(this.state.points,"unlisten","onMove",this.state.id),this.movable&&this.movable.remove(),this.state.mouseTarget=null},constrain:function(){if(this.points==null||this.points.length===0)return;const i=this.coord(0),t=this._applyConstraints(i,i);t!==!1&&this._fireEvent(this.state.onMove,t,i)},normalStyle:function(){return b.clone(this.state.normalStyle)},highlightStyle:function(){return b.clone(this.state.highlightStyle)},toBack:function(){this.movable.toBack(),this.state.visibleShape&&this.state.visibleShape.toBack()},toFront:function(){this.state.visibleShape&&this.state.visibleShape.toFront(),this.movable.toFront()},isHovering:function(){return this.movable.isHovering()},isDragging:function(){return this.movable.isDragging()},mouseTarget:function(){return this.movable.mouseTarget()}});const Fe={MovablePoint:Js,addMovablePoint:function(i,t){const e=new Li(i,{});return new Js(i,e,t)},MovableLine:xe,addMovableLine:function(i,t){const e=new Li(i,{});return new xe(i,e,t)},MovablePolygon:we,addMovablePolygon:function(i,t){const e=new Li(i,{});return new we(i,e,t)},addMaybeMobileMovablePoint:function(i,t){const e=i.props.apiOptions.isMobile,o=e?{stroke:"#ffffff","stroke-width":3,fill:H.INTERACTIVE}:{stroke:H.INTERACTIVE,fill:H.INTERACTIVE},a=Object.assign(o,t.normalStyle),h=Object.assign(e?{...o,"stroke-width":0,scale:.75}:{},t.highlightStyle),f=Object.assign({normalStyle:a,highlightStyle:h,shadow:e,tooltip:e&&i.props.showTooltips,showHairlines:i.showHairlines,hideHairlines:i.hideHairlines},e?{pointSize:7}:{});return Fe.addMovablePoint(i.graphie,Object.assign(t,f))}},Cn=Rt.createClass({displayName:"MovablePoint",movableProps:["children"],_getProps:function(){if(this.props.isMobile){const i=this.props.isMobile,t=i?{stroke:"#ffffff","stroke-width":3,fill:H.INTERACTIVE}:{stroke:H.INTERACTIVE,fill:H.INTERACTIVE},e=i?Object.assign(t,this.props.mobileStyleOverride||{}):Object.assign(t,this.props.normalStyle),o=i?{...t,"stroke-width":0,scale:.75}:this.props.highlightStyle,a=Object.assign({normalStyle:e,highlightStyle:o,shadow:i,tooltip:i&&this.props.showTooltips},i?{pointSize:7}:{});return Object.assign(this.props,a)}return this.props},add:function(i){this.point=Fe.addMovablePoint(i,this._getProps())},modify:function(){this.point.modify(this._getProps())},remove:function(){this.point.remove()},toFront:function(){this.point.toFront()},grab:function(i){this.point.grab(i)}});b.extend(Cn,Fe.MovablePoint);const An=Rt.createClass({displayName:"MovableLine",movableProps:["children"],add:function(i){const t=b.pluck(this.props.children,"point"),e=b.extend({},this.props,{points:t});this.line=Fe.addMovableLine(i,e)},modify:function(){const i=b.pluck(this.props.children,"point"),t=b.extend({},this.props,{points:i});this.line.modify(t)},remove:function(){this.line.remove()},toFront:function(){this.line.toFront()}});b.extend(An,Fe.MovableLine);const cr=Rt.createSimpleClass((i,t)=>{let e=t.coord;t.unscaled&&(e=i.unscalePoint(e));let o=null;return ye().JIPT.useJIPT?(o=i.label(e,t.text,t.direction,!1,t.style),ye().graphieMovablesJiptLabels.addLabel(o,t.tex)):o=i.label(e,t.text,t.direction,t.tex,t.style),o}),hr=Rt.createClass({displayName:"Line",movableProps:["children"],add:function(i){const t=this.props;this.graphie=i,this.line=this.graphie.line(t.start,t.end,t.style)},modify:function(){const i=this.props,t=this.graphie.svgPath([i.start,i.end]);this.line.attr(b.extend({},i.style,{path:t}))},remove:function(){this.line.remove()},toFront:function(){this.line.toFront()}}),ur=Rt.createClass({displayName:"Parabola",movableProps:["children"],add:function(i){const t=this.props;this.graphie=i,this.parabola=this.graphie.parabola(t.a,t.b,t.c,t.style)},modify:function(){const i=this.props,t=this.graphie.svgParabolaPath(i.a,i.b,i.c);this.parabola.attr(b.extend({},i.style,{path:t}))},remove:function(){this.parabola.remove()},toFront:function(){this.parabola.toFront()}}),fr=Rt.createClass({displayName:"Sinusoid",movableProps:["children"],add:function(i){const t=this.props;this.graphie=i,this.sinusoid=this.graphie.sinusoid(t.a,t.b,t.c,t.d,t.style)},modify:function(){const i=this.props,t=this.graphie.svgSinusoidPath(i.a,i.b,i.c,i.d);this.sinusoid.attr(b.extend({},i.style,{path:t}))},remove:function(){this.sinusoid.remove()},toFront:function(){this.sinusoid.toFront()}}),dr=Rt.createSimpleClass((i,t)=>i.plot(t.fn,t.range,t.style)),pr=Rt.createSimpleClass((i,t)=>i.plotParametric(t.fn,t.range,t.style)),gr=Rt.createSimpleClass((i,t)=>i.ellipse(t.coord,i.unscaleVector([4,4]),{fill:t.color||H.BLACK,stroke:t.color||H.BLACK})),mr=Rt.createClass({displayName:"Path",movableProps:["children"],add:function(i){const t=this.props;this.graphie=i,this.path=this.graphie.path(t.coords,t.style)},modify:function(){const i=this.props,t=this.graphie.svgPath(i.coords);this.path.attr({path:t})},remove:function(){this.path.remove()},toFront:function(){this.path.toFront()}}),vr=Rt.createSimpleClass((i,t)=>{let e=t.center,o=t.radius;return t.unscaled&&(e=i.unscalePoint(e),o=i.unscaleVector(o)),i.arc(e,o,t.startAngle,t.endAngle,t.sector,t.style)}),br=Rt.createSimpleClass((i,t)=>i.circle(t.center,t.radius,t.style)),yr=Rt.createSimpleClass((i,t)=>i.rect(t.x,t.y,t.width,t.height,t.style)),xr={Arc:vr,Circle:br,Label:cr,Line:hr,MovableLine:An,MovablePoint:Cn,Parabola:ur,Path:mr,Plot:dr,PlotParametric:pr,Point:gr,Sinusoid:fr,Rect:yr},wr=Rt.GraphieMovable,Mr=bt.createGraphie,{deepEq:Ri,nestedMap:Sr}=kt,{assert:Tr}=Tt,es=class es extends ri.Component{constructor(){super(...arguments),this.graphieDivRef=ri.createRef(),this._graphie=new Bi(document.createElement("div")),this._movables={},this.movables={},this.getGraphie=()=>this._graphie,this._range=()=>{const t=e=>e[0]>=e[1]?[-10,10]:e;return[t(this.props.range[0]),t(this.props.range[1])]},this._box=()=>{const t=e=>e>0?e:340;return[t(this.props.box[0]),t(this.props.box[1])]},this._scale=()=>{const t=this._box(),e=this._range();return t.map((o,a)=>{const h=e[a][1]-e[a][0];return o/h})},this._setupGraphie=()=>{this._removeMovables();const t=rn.findDOMNode(this.graphieDivRef.current);if(t==null||t instanceof Text)throw new Error("No graphie container div found");t.innerHTML="";const e=this._graphie=Mr(t);e.init({range:this._range(),scale:this._scale(),isMobile:this.props.isMobile}),this.props.addMouseLayer&&e.addMouseLayer({onClick:this.props.onClick,onMouseDown:this.props.onMouseDown,onMouseMove:this.props.onMouseMove,setDrawingAreaAvailable:this.props.setDrawingAreaAvailable}),e.snap=this.props.options.snapStep||[1,1],this.props.responsive&&(P(t).css({width:"100%",height:"100%"}),e.raphael.setSize("100%","100%")),this.props.setup(e,b.extend({range:this._range(),scale:this._scale()},this.props.options))},this._removeMovables=()=>{b.invoke(this._movables,"remove"),this._movables={}},this._renderMovables=(t,e)=>{const o=e.graphie,a=e.oldMovables,h=e.newMovables,f=x=>{b.each(x.movableProps,y=>{x.props[y]=this._renderMovables(x.props[y],e)})};let v=!1;return Sr(t,x=>{if(!x)return e.nextKey++,x;const y=new x.type(x.props);Tr(y instanceof wr,"All children of a Graphie component must be Graphie movables");const M=x.key,w=M??"_no_id_"+e.nextKey;e.nextKey++;const S=x.ref;f(y);const E=a[w];return E?y.constructor===E.constructor?(E.props=y.props,E.modify(o)==="reordered"&&(v=!0),h[w]=E):(M==null&&De.error("Replacing a <Graphie> child with a child of a different type. Please add keys to your <Graphie> children",Ft.Internal),E.remove(),y.add(o),v=!0,h[w]=y):(y.add(o),v=!0,h[w]=y),v&&h[w].toFront(),S&&(this.movables[S]=h[w]),h[w]})},this._updateMovables=()=>{const t=this._graphie,e=this._movables,o={};this._movables=o,this.movables={},this._renderMovables(this.props.children,{nextKey:1,graphie:t,oldMovables:e,newMovables:o}),b.each(e,(a,h)=>{o[h]||a.remove()})}}componentDidMount(){this._setupGraphie(),this._updateMovables()}shouldComponentUpdate(t){return!b.isEqual(this.props,t)}componentDidUpdate(t){this.props.setup!==t.setup&&De.error("<Graphie> was given a new setup function. This is a bad idea; please refactor your code to give the same setup function reference to <Graphie> on every render.",Ft.Internal),(!Ri(this.props.options,t.options)||!Ri(this.props.box,t.box)||!Ri(this.props.range,t.range))&&this._setupGraphie(),this._updateMovables()}render(){return zt("div",{className:"graphie-container",children:zt("div",{className:"graphie",ref:this.graphieDivRef})})}};es.defaultProps={range:[[-10,10],[-10,10]],options:{},responsive:!1,addMouseLayer:!0};let se=es;b.extend(se,Rt);b.extend(se,xr);try{se.displayName="Graphie",se.__docgenInfo={description:"",displayName:"Graphie",props:{addMouseLayer:{defaultValue:{value:"true"},description:"",name:"addMouseLayer",required:!1,type:{name:"boolean"}},box:{defaultValue:null,description:"",name:"box",required:!0,type:{name:"Size"}},range:{defaultValue:{value:`[
            [-10, 10],
            [-10, 10],
        ]`},description:"",name:"range",required:!1,type:{name:"[Coord, Coord]"}},ranges:{defaultValue:null,description:"",name:"ranges",required:!1,type:{name:"[Interval, Interval]"}},gridStep:{defaultValue:null,description:"",name:"gridStep",required:!1,type:{name:"[number, number]"}},step:{defaultValue:null,description:"",name:"step",required:!1,type:{name:"[number, number]"}},scale:{defaultValue:null,description:"",name:"scale",required:!1,type:{name:"[number, number]"}},isMobile:{defaultValue:null,description:"",name:"isMobile",required:!1,type:{name:"boolean"}},responsive:{defaultValue:{value:"false"},description:"",name:"responsive",required:!1,type:{name:"boolean"}},options:{defaultValue:{value:"{}"},description:"",name:"options",required:!1,type:{name:"any"}},setDrawingAreaAvailable:{defaultValue:null,description:"",name:"setDrawingAreaAvailable",required:!1,type:{name:"((boolean: any) => void)"}},setup:{defaultValue:null,description:"",name:"setup",required:!0,type:{name:"(graphie: any, options: { range: [Coord, Coord]; scale: [number, number]; }) => void"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"((at: Coord) => void)"}},onMouseDown:{defaultValue:null,description:"",name:"onMouseDown",required:!1,type:{name:"((at: Coord) => void)"}},onMouseMove:{defaultValue:null,description:"",name:"onMouseMove",required:!1,type:{name:"((at: Coord) => void)"}}}}}catch{}const _r=700,Ee={},kr=function(i,t){t={callbackName:"callback",success:P.noop,error:P.noop,...t};const e=document.createElement("script");e.setAttribute("async",""),e.setAttribute("src",i);function o(){document.head&&document.head.removeChild(e),delete window[t.callbackName]}window[t.callbackName]=function(...a){o(),t.success.apply(null,a)},e.addEventListener("error",function(...a){o(),t.error.apply(null,a)}),document.head&&document.head.appendChild(e)},Cr=/^file\+graphie:/,Ar=/\/([^/]+)$/;function Pr(i){return/\.(jpg|jpeg)$/i.test(i)}function Pn(){const{JIPT:i,kaLocale:t}=ye();return i.useJIPT?"en-pt":t}function sn(){return Pn()!=="en"}const Er=/\/(?=[^/]+$)/;function Lr(i){if(Cr.test(i))return kt.getDataUrl(i);const[t,e]=kt.getBaseUrl(i).split(Er);return`${t}/${Pn()}/${e}-data.json`}function Ir(i){const t=i.match(Ar);if(t==null)throw new $t("not a valid URL",Ft.InvalidInput);return t&&t[1]}function Rr(i){return zt("span",{style:{top:0,left:0,width:"100%",height:"100%",position:"absolute",minWidth:"20px",display:"flex",justifyContent:"center",alignContent:"center"},children:zt(jn,{size:"medium"})})}const is=class is extends ri.Component{constructor(t){super(t),this.onDataLoaded=(e,o)=>{if(this._isMounted&&e.labels&&e.range){const a=e.labels.reduce((h,f)=>({...h,[f.content]:!1}),{});this.setState({dataLoaded:!0,labelDataIsLocalized:o,labelsRendered:a,labels:e.labels,range:e.range})}},this.onImageLoad=()=>{this.sizeProvided()?this.setState({imageLoaded:!0}):kt.getImageSize(this.props.src,(e,o)=>{this._isMounted&&this.setState({imageLoaded:!0,imageDimensions:[e,o]})})},this.setupGraphie=(e,o)=>{b.map(o.labels,a=>{const{JIPT:h}=ye();if(h.useJIPT&&this.state.labelDataIsLocalized){const f=e.label(a.coordinates,a.content,a.alignment,!1);ye().svgImageJiptLabels.addLabel(f,a.typesetAsMath)}else if(a.coordinates){const f=e.label(a.coordinates,a.content,a.alignment,a.typesetAsMath,{"font-size":100*this.props.scale+"%"}),v=f[0].style;let x=this._tryGetPixels(v.top),y=this._tryGetPixels(v.left);if(x===null||y===null){const S=f.position();x=S.top,y=S.left}const M=(this.props.height||0)*this.props.scale,w=(this.props.width||0)*this.props.scale;f.css({top:x/M*100+"%",left:y/w*100+"%"}),b.each(a.style,(S,E)=>{f.css(E,S)})}this.setState({labelsRendered:{...this.state.labelsRendered,[a.content]:!0}})})},this._handleZoomClick=e=>{(P(e.target).width()<this.props.width||this.props.zoomToFullSizeOnMobile)&&wo.handleZoomClick(e,this.props.zoomToFullSizeOnMobile),this.props.trackInteraction&&this.props.trackInteraction()},this.handleUpdate=e=>{this.props.onUpdate(),!kt.isLabeledSVG(this.props.src)&&e==="loaded"&&this.setState({imageLoaded:!0})},t.setAssetStatus(t.src,!1),this._isMounted=!1,this.state={imageLoaded:!1,imageDimensions:null,dataLoaded:!1,labelDataIsLocalized:!1,labels:[],labelsRendered:{},range:[[0,0],[0,0]]}}componentDidMount(){this._isMounted=!0,kt.isLabeledSVG(this.props.src)&&this.loadResources()}UNSAFE_componentWillReceiveProps(t){this.props.src!==t.src&&this.setState({imageLoaded:!1,dataLoaded:!1})}shouldComponentUpdate(t,e){if(!b.isEqual(this.props,t))return!0;const o=this.isLoadedInState(this.state),a=this.isLoadedInState(e);return o!==a}componentDidUpdate(t,e){const o=this.isLoadedInState(e),a=this.isLoadedInState(this.state);kt.isLabeledSVG(this.props.src)&&!a&&this.loadResources(),!o&&a&&this.props.setAssetStatus(this.props.src,!0)}componentWillUnmount(){this._isMounted=!1}isLoadedInState(t){return kt.isLabeledSVG(this.props.src)?t.imageLoaded&&t.dataLoaded:t.imageLoaded}loadResources(){const t=Ir(this.props.src);if(Ee[t])if(Ee[t].loaded){const{data:e,localized:o}=Ee[t];this.onDataLoaded(e,o)}else Ee[t].dataCallbacks.push(this.onDataLoaded);else{const e={loaded:!1,dataCallbacks:[this.onDataLoaded],data:null,localized:sn()};Ee[t]=e;const o=(a,h)=>{kr(a,{callbackName:"svgData"+t,success:f=>{e.data=f,e.loaded=!0,b.each(e.dataCallbacks,v=>{v(e.data,e.localized)})},error:h})};sn()?o(Lr(this.props.src),(a,h,f)=>{e.localized=!1,o(kt.getDataUrl(this.props.src),(v,x,y)=>{De.error("Data load failed for svg-image",Ft.Service,{cause:y,loggedMetadata:{dataUrl:kt.getDataUrl(this.props.src),status:x}})})}):o(kt.getDataUrl(this.props.src),(a,h,f)=>{De.error("Data load failed for svg-image",Ft.Service,{cause:f,loggedMetadata:{dataUrl:kt.getDataUrl(this.props.src),status:h}})})}}sizeProvided(){return this.props.width!=null&&this.props.height!=null}_tryGetPixels(t){return t=t||"",t.endsWith("px")&&parseFloat(t)||null}render(){const t=this.props.src,e={alt:this.props.alt,title:this.props.title},o=this.props.width&&this.props.width*this.props.scale,a=this.props.height&&this.props.height*this.props.scale,h={width:o,height:a},f=this.props.responsive&&!!(o&&a);let v;this.props.extraGraphie&&this.props.extraGraphie.labels.length&&(v=zt(se,{box:this.props.extraGraphie.box,range:this.props.extraGraphie.range,options:{labels:this.props.extraGraphie.labels},responsive:!0,addMouseLayer:!1,setup:this.setupGraphie}));const x=this.props.preloader===void 0?Rr:this.props.preloader,y=x?()=>x(h):null;if(!kt.isLabeledSVG(t)){if(f){const S=Jn({zoomable:(o||0)>_r,"svg-image":!0});return e.onClick=this._handleZoomClick,ki(Bs,{className:S,width:o,height:a,constrainHeight:this.props.constrainHeight,allowFullBleed:this.props.allowFullBleed&&Pr(t),children:[zt(je,{src:t,imgProps:e,preloader:y,onUpdate:this.handleUpdate}),v]})}return e.style=h,zt(je,{src:t,preloader:y,imgProps:e,onUpdate:this.handleUpdate})}const M=kt.getSvgUrl(t);let w;if(this.isLoadedInState(this.state)){let S;if(this.sizeProvided())S=[o,a];else if(this.state.imageDimensions)S=[this.state.imageDimensions[0]*this.props.scale,this.state.imageDimensions[1]*this.props.scale];else throw new $t("svg-image has no dimensions",Ft.InvalidInput,{metadata:{src:this.props.src}});w=zt(se,{ref:"graphie",box:S,scale:[40*this.props.scale,40*this.props.scale],range:this.state.range,options:b.pick(this.state,"labels"),responsive:f,addMouseLayer:!1,setup:this.setupGraphie})}return f?ki(Bs,{className:"svg-image",width:o,height:a,constrainHeight:this.props.constrainHeight,children:[zt(je,{src:M,onLoad:this.onImageLoad,onUpdate:this.handleUpdate,preloader:y,imgProps:e}),w,v]}):(e.style=h,ki("div",{className:"unresponsive-svg-image",style:h,children:[zt(je,{src:M,onLoad:this.onImageLoad,onUpdate:this.handleUpdate,preloader:y,imgProps:e}),w]}))}};is.defaultProps={constrainHeight:!1,onUpdate:()=>{},responsive:!0,src:"",scale:1,zoomToFullSizeOnMobile:!1,setAssetStatus:(t,e)=>{}};let ci=is;try{ci.displayName="SvgImage",ci.__docgenInfo={description:"",displayName:"SvgImage",props:{allowFullBleed:{defaultValue:null,description:"",name:"allowFullBleed",required:!1,type:{name:"boolean"}},alt:{defaultValue:null,description:"",name:"alt",required:!0,type:{name:"string"}},constrainHeight:{defaultValue:{value:"false"},description:"",name:"constrainHeight",required:!1,type:{name:"boolean"}},extraGraphie:{defaultValue:null,description:"",name:"extraGraphie",required:!1,type:{name:"{ box: Size; range: [Coord, Coord]; labels: readonly any[]; }"}},height:{defaultValue:null,description:"",name:"height",required:!1,type:{name:"number"}},onUpdate:{defaultValue:{value:"() => {}"},description:"",name:"onUpdate",required:!1,type:{name:"() => void"}},overrideAriaHidden:{defaultValue:null,description:"",name:"overrideAriaHidden",required:!1,type:{name:"boolean"}},preloader:{defaultValue:null,description:"",name:"preloader",required:!1,type:{name:"((dimensions: Dimensions) => ReactNode)"}},responsive:{defaultValue:{value:"true"},description:"",name:"responsive",required:!1,type:{name:"boolean"}},scale:{defaultValue:{value:"1"},description:"",name:"scale",required:!1,type:{name:"number"}},src:{defaultValue:{value:""},description:"",name:"src",required:!1,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}},trackInteraction:{defaultValue:null,description:"",name:"trackInteraction",required:!1,type:{name:"(() => void)"}},width:{defaultValue:null,description:"",name:"width",required:!1,type:{name:"number"}},zoomToFullSizeOnMobile:{defaultValue:{value:"false"},description:"",name:"zoomToFullSizeOnMobile",required:!1,type:{name:"boolean"}},setAssetStatus:{defaultValue:{value:"(src: string, status: boolean) => {}"},description:"",name:"setAssetStatus",required:!1,type:{name:"(assetKey: string, loaded: boolean) => void"}}}}}catch{}export{Tt as A,bt as G,Fe as I,H as K,ci as S,li as W,se as a,Zi as b,ct as c,Jr as d,fo as e,zo as f,Gi as g,Oi as h,Ys as i,dn as j,Ji as k,sa as l,jr as m,oa as n,ts as o,ea as p,ra as q,Wi as r,ht as s,ta as t,ia as u,Vi as v,me as w,Go as x,Fi as y,na as z};
