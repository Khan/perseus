var cn=Object.defineProperty;var ln=(r,n,e)=>n in r?cn(r,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[n]=e;var G=(r,n,e)=>(ln(r,typeof n!="symbol"?n+"":n,e),e);import{_ as l}from"./index-default-BcKQpA1a.js";function Nt(r,n){return typeof r=="number"&&typeof n=="number"?Math.abs(r-n)<1e-9:r===n}function Ve(r,n){if(Array.isArray(r)&&Array.isArray(n)){if(r.length!==n.length)return!1;for(let e=0;e<r.length;e++)if(!Ve(r[e],n[e]))return!1;return!0}return Array.isArray(r)||Array.isArray(n)?!1:typeof r=="function"&&typeof n=="function"?Nt(r,n):typeof r=="function"||typeof n=="function"?!1:typeof r=="object"&&typeof n=="object"&&r&&n?r===n||l.all(r,function(e,t){return Ve(n[t],e)})&&l.all(n,function(e,t){return Ve(r[t],e)}):typeof r=="object"&&r||typeof n=="object"&&n?!1:Nt(r,n)}function _t(r){return JSON.parse(JSON.stringify(r))}const bt={PLOT:"PLOT",PARABOLA:"PARABOLA",SINUSOID:"SINUSOID"};function Ot(r){let n=r[0],e=r[1],t=r[2];const s=r[3];n<0&&(n*=-1,e*=-1,t*=-1);const i=2*Math.PI;for(e<0&&(e*=-1,t*=-1,t+=i/2);t>0;)t-=i;for(;t<0;)t+=i;return[n,e,t,s]}function Ct(r){let n=r[0],e=r[1],t=r[2];const s=r[3];n<0&&(n*=-1,e*=-1,t*=-1);const i=Math.PI;for(e<0&&(e*=-1,t*=-1,t+=i/2);t>0;)t-=i;for(;t<0;)t+=i;return[n,e,t,s]}const Le={areEqual:function(r,n){return Ve(r,n)},movable:bt.PLOT,getPropsForCoeffs:function(r){return{fn:l.partial(this.getFunctionForCoeffs,r)}}},un=l.extend({},Le,{url:"https://ka-perseus-graphie.s3.amazonaws.com/67aaf581e6d9ef9038c10558a1f70ac21c11c9f8.png",defaultCoords:[[.25,.75],[.75,.75]],getCoefficients:function(r){const n=r[0],e=r[1],t=e[0]-n[0],s=e[1]-n[1];if(t===0)return;const i=s/t,a=e[1]-i*e[0];return[i,a]},getFunctionForCoeffs:function(r,n){const e=r[0],t=r[1];return e*n+t},getEquationString:function(r){const n=this.getCoefficients(r),e=n[0],t=n[1];return"y = "+e.toFixed(3)+"x + "+t.toFixed(3)}}),hn=l.extend({},Le,{url:"https://ka-perseus-graphie.s3.amazonaws.com/e23d36e6fc29ee37174e92c9daba2a66677128ab.png",defaultCoords:[[.5,.5],[.75,.75]],movable:bt.PARABOLA,getCoefficients:function(r){const n=r[0],e=r[1],t=n[0],s=n[1],i=(e[1]-s)/((e[0]-t)*(e[0]-t)),a=-2*t*i,c=i*t*t+s;return[i,a,c]},getFunctionForCoeffs:function(r,n){const e=r[0],t=r[1],s=r[2];return(e*n+t)*n+s},getPropsForCoeffs:function(r){return{a:r[0],b:r[1],c:r[2]}},getEquationString:function(r){const n=this.getCoefficients(r),e=n[0],t=n[1],s=n[2];return"y = "+e.toFixed(3)+"x^2 + "+t.toFixed(3)+"x + "+s.toFixed(3)}}),fn=l.extend({},Le,{url:"https://ka-perseus-graphie.s3.amazonaws.com/3d68e7718498475f53b206c2ab285626baf8857e.png",defaultCoords:[[.5,.5],[.6,.6]],movable:bt.SINUSOID,getCoefficients:function(r){const n=r[0],e=r[1],t=e[1]-n[1],s=Math.PI/(2*(e[0]-n[0])),i=n[0]*s,a=n[1];return[t,s,i,a]},getFunctionForCoeffs:function(r,n){const e=r[0],t=r[1],s=r[2],i=r[3];return e*Math.sin(t*n-s)+i},getPropsForCoeffs:function(r){return{a:r[0],b:r[1],c:r[2],d:r[3]}},getEquationString:function(r){const n=this.getCoefficients(r),e=n[0],t=n[1],s=n[2],i=n[3];return"y = "+e.toFixed(3)+" sin("+t.toFixed(3)+"x - "+s.toFixed(3)+") + "+i.toFixed(3)},areEqual:function(r,n){return Ve(Ot(r),Ot(n))}}),pn=l.extend({},Le,{url:"https://ka-perseus-graphie.s3.amazonaws.com/7db80d23c35214f98659fe1cf0765811c1bbfbba.png",defaultCoords:[[.5,.5],[.75,.75]],getCoefficients:function(r){const n=r[0],e=r[1],t=e[1]-n[1],s=Math.PI/(4*(e[0]-n[0])),i=n[0]*s,a=n[1];return[t,s,i,a]},getFunctionForCoeffs:function(r,n){const e=r[0],t=r[1],s=r[2],i=r[3];return e*Math.tan(t*n-s)+i},getEquationString:function(r){const n=this.getCoefficients(r),e=n[0],t=n[1],s=n[2],i=n[3];return"y = "+e.toFixed(3)+" sin("+t.toFixed(3)+"x - "+s.toFixed(3)+") + "+i.toFixed(3)},areEqual:function(r,n){return Ve(Ct(r),Ct(n))}}),Bt=l.extend({},Le,{url:"https://ka-perseus-graphie.s3.amazonaws.com/9cbfad55525e3ce755a31a631b074670a5dad611.png",defaultCoords:[[.5,.55],[.75,.75]],defaultAsymptote:[[0,.5],[1,.5]],extraCoordConstraint:function(r,n,e,t,s){const i=t[0][1];return l.all(e,a=>a[1]!==i)},extraAsymptoteConstraint:function(r,n,e,t,s){const i=r[1];if(l.all(e,u=>u[1]>i)||l.all(e,u=>u[1]<i))return[n[0],i];const c=n[1];if(l.all(e,u=>u[1]>c)){const u=l.min(l.map(e,p=>p[1]));return[n[0],u-s.snapStep[1]]}const b=l.max(l.map(e,u=>u[1]));return[n[0],b+s.snapStep[1]]},allowReflectOverAsymptote:!0,getCoefficients:function(r,n){const e=r[0],t=r[1],s=n[0][1],i=Math.log((e[1]-s)/(t[1]-s))/(e[0]-t[0]);return[(e[1]-s)/Math.exp(i*e[0]),i,s]},getFunctionForCoeffs:function(r,n){const e=r[0],t=r[1],s=r[2];return e*Math.exp(t*n)+s},getEquationString:function(r,n){if(!n)return null;const e=this.getCoefficients(r,n),t=e[0],s=e[1],i=e[2];return"y = "+t.toFixed(3)+"e^("+s.toFixed(3)+"x) + "+i.toFixed(3)}}),dn=l.extend({},Le,{url:"https://ka-perseus-graphie.s3.amazonaws.com/f6491e99d34af34d924bfe0231728ad912068dc3.png",defaultCoords:[[.55,.5],[.75,.75]],defaultAsymptote:[[.5,0],[.5,1]],extraCoordConstraint:function(r,n,e,t,s){const i=t[0][0];return l.all(e,a=>a[0]!==i)&&e[0][1]!==e[1][1]},extraAsymptoteConstraint:function(r,n,e,t,s){const i=r[0];if(l.all(e,u=>u[0]>i)||l.all(e,u=>u[0]<i))return[i,n[1]];const c=n[0];return l.all(e,u=>u[0]>c)?[l.min(l.map(e,p=>p[0]))-s.snapStep[0],n[1]]:[l.max(l.map(e,u=>u[0]))+s.snapStep[0],n[1]]},allowReflectOverAsymptote:!0,getCoefficients:function(r,n){const e=s=>[s[1],s[0]],t=Bt.getCoefficients(l.map(r,e),l.map(n,e));if(t){const s=-t[2]/t[0],i=1/t[0];return[1/t[1],i,s]}},getFunctionForCoeffs:function(r,n,e){const t=r[0],s=r[1],i=r[2];return t*Math.log(s*n+i)},getEquationString:function(r,n){if(!n)return null;const e=this.getCoefficients(r,n),t=e[0],s=e[1],i=e[2];return"y = ln("+t.toFixed(3)+"x + "+s.toFixed(3)+") + "+i.toFixed(3)}}),gn=l.extend({},Le,{url:"https://ka-perseus-graphie.s3.amazonaws.com/8256a630175a0cb1d11de223d6de0266daf98721.png",defaultCoords:[[.5,.5],[.75,.75]],getCoefficients:function(r){const n=r[0],e=r[1],t=e[0]-n[0],s=e[1]-n[1];if(t===0)return;let i=Math.abs(s/t);e[1]<n[1]&&(i*=-1);const a=n[0],c=n[1];return[i,a,c]},getFunctionForCoeffs:function(r,n){const e=r[0],t=r[1],s=r[2];return e*Math.abs(n-t)+s},getEquationString:function(r){const n=this.getCoefficients(r),e=n[0],t=n[1],s=n[2];return"y = "+e.toFixed(3)+"| x - "+t.toFixed(3)+"| + "+s.toFixed(3)}}),Vt={linear:un,quadratic:hn,sinusoid:fn,tangent:pn,exponential:Bt,logarithm:dn,absolute_value:gn},Rs=l.keys(Vt);function qs(r){return Vt[r]}const mn={content:"",images:{},widgets:{}};function yn(r={}){return _t({...mn,...r})}const vn={question:yn(),answerArea:{calculator:!1,chi2Table:!1,periodicTable:!1,tTable:!1,zTable:!1,financialCalculatorMonthlyPayment:!1,financialCalculatorTotalAmount:!1,financialCalculatorTimeToPayOff:!1,periodicTableWithKey:!1},hints:[]};function Gs(r={}){return _t({...vn,...r})}function Wt(r){return{type:"success",value:r}}function xt(r){return{type:"failure",detail:r}}function pe(r){return r.type==="failure"}function nt(r){return r.type==="success"}function bn(r,n=e=>e){const e=[],t=[];for(const s of r)s.type==="success"?e.push(s.value):t.push(s.detail);return t.length>0?xt(t.reduce(n)):Wt(e)}const Ce=(r,n)=>n.success(r);function M(r){return(n,e)=>{if(!Array.isArray(n))return e.failure("array",n);const t=n.map((s,i)=>r(s,e.forSubtree(i)));return bn(t,xn)}}function xn(r,n){return[...r,...n]}function S(r,n){return typeof r=="boolean"?n.success(r):n.failure("boolean",r)}function T(r){return(n,e)=>n!==r?e.failure(String(JSON.stringify(r)),n):e.success(r)}function $(...r){return(n,e)=>{if(typeof n=="string"){const s=r.indexOf(n);if(s>-1)return e.success(r[s])}const t=r.map(s=>JSON.stringify(s));return e.failure(t,n)}}const wn=Object.prototype.constructor.toString(),kn=Function.prototype.toString;function je(r){if(r==null)return!1;const n=Object.getPrototypeOf(r);return n==null?!0:typeof n.constructor=="function"&&kn.call(n.constructor)===wn}function U(r){return(n,e)=>n===null?e.success(n):r(n,e)}const k=(r,n)=>typeof r=="number"?n.success(r):n.failure("number",r);function Ut(r){return m(r)}function m(r){return(n,e)=>{if(!je(n))return e.failure("object",n);const t={...n},s=[];for(const[i,a]of Object.entries(r)){const c=a(n[i],e.forSubtree(i));nt(c)?(c.value!==void 0||i in n)&&(t[i]=c.value):s.push(...c.detail)}return s.length>0?xt(s):e.success(t)}}function o(r){return(n,e)=>n===void 0?e.success(n):r(n,e)}function J(r,n){return(e,t)=>{if(!Array.isArray(e))return t.failure("array",e);if(e.length!==2)return t.failure("array of length 2",e);const[s,i]=e,a=r(s,t.forSubtree(0));if(pe(a))return a;const c=n(i,t.forSubtree(1));return pe(c)?c:t.success([a.value,c.value])}}function de(r){return new wt(r)}class wt{constructor(n){this.parser=n}then(n){return new wt(Tn(this.parser,n))}}function Tn(r,n){return(e,t)=>{const s=r(e,t);return pe(s)?s:n(s.value,t)}}function zt(r,n){return(e,t)=>{if(!je(e))return t.failure("object",e);const s={},i=[];for(const[a,c]of Object.entries(e)){const d=t.forSubtree(a),b=r(a,d);pe(b)&&i.push(...b.detail);const u=n(c,d);pe(u)&&i.push(...u.detail),nt(b)&&nt(u)&&(s[b.value]=u.value)}return i.length>0?xt(i):t.success(s)}}const h=(r,n)=>typeof r=="string"?n.success(r):n.failure("string",r);function rt(r,n,e){return(t,s)=>{if(!Array.isArray(t))return s.failure("array",t);if(t.length!==3)return s.failure("array of length 3",t);const i=r(t[0],s.forSubtree(0));if(pe(i))return i;const a=n(t[1],s.forSubtree(1));if(pe(a))return a;const c=e(t[2],s.forSubtree(2));return pe(c)?c:s.success([i.value,a.value,c.value])}}function ue(r){return new kt(r)}class kt{constructor(n){this.parser=n}or(n){return new kt(Sn(this.parser,n))}}function Sn(r,n){return(e,t)=>{const s=r(e,t);return nt(s)?s:n(e,t)}}function O(r,n){return(e,t)=>e==null?Wt(n(e)):r(e,t)}const Pn=m({width:k,height:k}),En=O(zt(h,Pn),()=>({}));function j(r,n){return Ut({type:r,static:o(S),graded:o(S),alignment:o(h),options:n,key:o(U(k)),version:o(m({major:k,minor:k}))})}function $e(r,n,e){return Ut({type:n,static:o(S),graded:o(S),alignment:o(h),options:e,key:o(U(k)),version:r})}const An=j(T("categorizer"),m({items:M(h),categories:M(h),randomizeItems:O(S,()=>!1),static:O(S,()=>!1),values:M(O(k,()=>0)),highlightLint:o(S),linterContext:o(m({contentType:h,paths:M(h),stack:M(h)}))})),In=j(T("cs-program"),m({programID:h,programType:Ce,settings:M(m({name:h,value:h})),showEditor:S,showButtons:S,height:k,static:O(S,()=>!1)})),Mn=j(T("definition"),m({togglePrompt:h,definition:h,static:O(S,()=>!1)})),Nn=j(T("dropdown"),m({placeholder:O(h,()=>""),ariaLabel:o(h),visibleLabel:o(h),static:O(S,()=>!1),choices:M(m({content:h,correct:S}))})),On=j(T("explanation"),m({showPrompt:h,hidePrompt:h,explanation:h,widgets:O((r,n)=>lt(r,n),()=>({})),static:O(S,()=>!1)})),jt=["PLUS","MINUS","NEGATIVE","TIMES","DIVIDE","DECIMAL","PERIOD","PERCENT","CDOT","EQUAL","NEQ","GT","LT","GEQ","LEQ","FRAC_INCLUSIVE","FRAC_EXCLUSIVE","FRAC","EXP","EXP_2","EXP_3","SQRT","CUBE_ROOT","RADICAL","LEFT_PAREN","RIGHT_PAREN","LN","LOG","LOG_N","SIN","COS","TAN","PI","THETA","UP","RIGHT","DOWN","LEFT","BACKSPACE","DISMISS","JUMP_OUT_PARENTHESES","JUMP_OUT_EXPONENT","JUMP_OUT_BASE","JUMP_INTO_NUMERATOR","JUMP_OUT_NUMERATOR","JUMP_OUT_DENOMINATOR","NUM_0","NUM_1","NUM_2","NUM_3","NUM_4","NUM_5","NUM_6","NUM_7","NUM_8","NUM_9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],$t=(r,n)=>{let e="v";e="";const t=`${e}${n}`;if(typeof globalThis<"u"){globalThis.__perseus_debug__=globalThis.__perseus_debug__??{};const s=globalThis.__perseus_debug__[r];if(s){if(s!==t){const i=Array.isArray(s)?s:[s];i.push(t),globalThis.__perseus_debug__[r]=i,console.warn(`Multiple versions of ${r} loaded on this page: ${i.sort().join(", ")}`)}}else globalThis.__perseus_debug__[r]=t}else console.warn(`globalThis not found found (${t})`)},Cn="@khanacademy/kas",Fn="__lib_version__";$t(Cn,Fn);(function(){var r=function(b,u,p,v){for(p=p||{},v=b.length;v--;p[b[v]]=u);return p},n=[1,11],e=[1,9],t=[8,17],s=[6,11],i=[6,11,13,17],a={trace:function(){},yy:{},symbols_:{error:2,unitvalue:3,magnitude:4,unit:5,EOF:6,float:7,POW:8,int:9,multatoms:10,DIV:11,expatom:12,MUL:13,atom:14,"^":15,nat:16,ATOM:17,FLOAT:18,NAT:19,NEG:20,$accept:0,$end:1},terminals_:{2:"error",6:"EOF",8:"POW",11:"DIV",13:"MUL",15:"^",17:"ATOM",18:"FLOAT",19:"NAT",20:"NEG"},productions_:[0,[3,3],[3,2],[4,3],[4,1],[5,3],[5,1],[10,3],[10,2],[10,1],[12,3],[12,1],[14,1],[7,1],[7,1],[16,1],[9,2],[9,1]],performAction:function(u,p,v,f,g,y,R){var P=y.length-1;switch(g){case 1:return{type:"unitMagnitude",magnitude:y[P-2],unit:y[P-1]};case 2:return{type:"unitStandalone",unit:y[P-1]};case 3:this.$=y[P-2]+"e"+y[P];break;case 4:case 13:case 14:case 15:case 17:this.$=y[P];break;case 5:this.$={num:y[P-2],denom:y[P]};break;case 6:this.$={num:y[P],denom:null};break;case 7:this.$=[y[P-2]].concat(y[P]);break;case 8:this.$=[y[P-1]].concat(y[P]);break;case 9:this.$=[y[P]];break;case 10:this.$={name:y[P-2],pow:y[P]};break;case 11:this.$={name:y[P],pow:1};break;case 12:this.$=u;break;case 16:this.$="-"+y[P];break}},table:[{3:1,4:2,5:3,7:4,10:5,12:8,14:10,16:7,17:n,18:[1,6],19:e},{1:[3]},{5:12,10:5,12:8,14:10,17:n},{6:[1,13]},{8:[1,14],17:[2,4]},{6:[2,6],11:[1,15]},r(t,[2,13]),r(t,[2,14]),r(s,[2,9],{12:8,14:10,10:17,13:[1,16],17:n}),r([6,8,11,13,17],[2,15]),r(i,[2,11],{15:[1,18]}),r([6,11,13,15,17],[2,12]),{6:[1,19]},{1:[2,2]},{9:20,19:[1,22],20:[1,21]},{10:23,12:8,14:10,17:n},{10:24,12:8,14:10,17:n},r(s,[2,8]),{16:25,19:e},{1:[2,1]},{17:[2,3]},{19:[1,26]},{17:[2,17]},{6:[2,5]},r(s,[2,7]),r(i,[2,10]),{17:[2,16]}],defaultActions:{13:[2,2],19:[2,1],20:[2,3],22:[2,17],23:[2,5],26:[2,16]},parseError:function(u,p){if(p.recoverable)this.trace(u);else throw new Error(u)},parse:function(u){var p=this,v=[0],f=[null],g=[],y=this.table,R="",P=0,Q=0,H=2,le=1,Ae=g.slice.call(arguments,1),Z=Object.create(this.lexer),ne={yy:{}};for(var ge in this.yy)Object.prototype.hasOwnProperty.call(this.yy,ge)&&(ne.yy[ge]=this.yy[ge]);Z.setInput(u,ne.yy),ne.yy.lexer=Z,ne.yy.parser=this,typeof Z.yylloc>"u"&&(Z.yylloc={});var te=Z.yylloc;g.push(te);var He=Z.options&&Z.options.ranges;typeof ne.yy.parseError=="function"?this.parseError=ne.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function ut(){var ve;return ve=Z.lex()||le,typeof ve!="number"&&(ve=p.symbols_[ve]||ve),ve}for(var re,oe,A,L,E={},C,B,F,ke;;){if(oe=v[v.length-1],this.defaultActions[oe]?A=this.defaultActions[oe]:((re===null||typeof re>"u")&&(re=ut()),A=y[oe]&&y[oe][re]),typeof A>"u"||!A.length||!A[0]){var q="";ke=[];for(C in y[oe])this.terminals_[C]&&C>H&&ke.push("'"+this.terminals_[C]+"'");Z.showPosition?q="Parse error on line "+(P+1)+`:
`+Z.showPosition()+`
Expecting `+ke.join(", ")+", got '"+(this.terminals_[re]||re)+"'":q="Parse error on line "+(P+1)+": Unexpected "+(re==le?"end of input":"'"+(this.terminals_[re]||re)+"'"),this.parseError(q,{text:Z.match,token:this.terminals_[re]||re,line:Z.yylineno,loc:te,expected:ke})}if(A[0]instanceof Array&&A.length>1)throw new Error("Parse Error: multiple actions possible at state: "+oe+", token: "+re);switch(A[0]){case 1:v.push(re),f.push(Z.yytext),g.push(Z.yylloc),v.push(A[1]),re=null,Q=Z.yyleng,R=Z.yytext,P=Z.yylineno,te=Z.yylloc;break;case 2:if(B=this.productions_[A[1]][1],E.$=f[f.length-B],E._$={first_line:g[g.length-(B||1)].first_line,last_line:g[g.length-1].last_line,first_column:g[g.length-(B||1)].first_column,last_column:g[g.length-1].last_column},He&&(E._$.range=[g[g.length-(B||1)].range[0],g[g.length-1].range[1]]),L=this.performAction.apply(E,[R,Q,P,ne.yy,A[1],f,g].concat(Ae)),typeof L<"u")return L;B&&(v=v.slice(0,-1*B*2),f=f.slice(0,-1*B),g=g.slice(0,-1*B)),v.push(this.productions_[A[1]][0]),f.push(E.$),g.push(E._$),F=y[v[v.length-2]][v[v.length-1]],v.push(F);break;case 3:return!0}}return!0}},c=function(){var b={EOF:1,parseError:function(p,v){if(this.yy.parser)this.yy.parser.parseError(p,v);else throw new Error(p)},setInput:function(u,p){return this.yy=p||this.yy||{},this._input=u,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var u=this._input[0];this.yytext+=u,this.yyleng++,this.offset++,this.match+=u,this.matched+=u;var p=u.match(/(?:\r\n?|\n).*/g);return p?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),u},unput:function(u){var p=u.length,v=u.split(/(?:\r\n?|\n)/g);this._input=u+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-p),this.offset-=p;var f=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),v.length-1&&(this.yylineno-=v.length-1);var g=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:v?(v.length===f.length?this.yylloc.first_column:0)+f[f.length-v.length].length-v[0].length:this.yylloc.first_column-p},this.options.ranges&&(this.yylloc.range=[g[0],g[0]+this.yyleng-p]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(u){this.unput(this.match.slice(u))},pastInput:function(){var u=this.matched.substr(0,this.matched.length-this.match.length);return(u.length>20?"...":"")+u.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var u=this.match;return u.length<20&&(u+=this._input.substr(0,20-u.length)),(u.substr(0,20)+(u.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var u=this.pastInput(),p=new Array(u.length+1).join("-");return u+this.upcomingInput()+`
`+p+"^"},test_match:function(u,p){var v,f,g;if(this.options.backtrack_lexer&&(g={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(g.yylloc.range=this.yylloc.range.slice(0))),f=u[0].match(/(?:\r\n?|\n).*/g),f&&(this.yylineno+=f.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:f?f[f.length-1].length-f[f.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+u[0].length},this.yytext+=u[0],this.match+=u[0],this.matches=u,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(u[0].length),this.matched+=u[0],v=this.performAction.call(this,this.yy,this,p,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),v)return v;if(this._backtrack){for(var y in g)this[y]=g[y];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var u,p,v,f;this._more||(this.yytext="",this.match="");for(var g=this._currentRules(),y=0;y<g.length;y++)if(v=this._input.match(this.rules[g[y]]),v&&(!p||v[0].length>p[0].length)){if(p=v,f=y,this.options.backtrack_lexer){if(u=this.test_match(v,g[y]),u!==!1)return u;if(this._backtrack){p=!1;continue}else return!1}else if(!this.options.flex)break}return p?(u=this.test_match(p,g[f]),u!==!1?u:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var p=this.next();return p||this.lex()},begin:function(p){this.conditionStack.push(p)},popState:function(){var p=this.conditionStack.length-1;return p>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(p){return p=this.conditionStack.length-1-Math.abs(p||0),p>=0?this.conditionStack[p]:"INITIAL"},pushState:function(p){this.begin(p)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(p,v,f,g){switch(f){case 0:return 11;case 1:return"(";case 2:return")";case 3:return 8;case 4:return 15;case 5:return 13;case 6:return 18;case 7:return 19;case 8:return 20;case 9:return 17;case 10:return 17;case 11:return 17;case 12:break;case 13:return 6}},rules:[/^(?:\/)/,/^(?:\()/,/^(?:\))/,/^(?:(\*|x|\u00d7|\u2219|\u22c5|\u00b7)\s*10\s*\^)/,/^(?:\^)/,/^(?:\*)/,/^(?:[0-9]+\.[0-9]+)/,/^(?:[0-9]+)/,/^(?:-)/,/^(?:\u00b0( ?)[cCfF])/,/^(?:fl\.? oz\.?)/,/^(?:[\u00b5]?([A-Za-z-]+|[\u2103\u2109\u212b]))/,/^(?:\s+)/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};return b}();a.lexer=c;function d(){this.yy={}}return d.prototype=a,a.Parser=d,new d})();var We=function(){var r=function(oe,A,L,E){for(L=L||{},E=oe.length;E--;L[oe[E]]=A);return L},n=[1,7],e=[1,17],t=[1,13],s=[1,14],i=[1,15],a=[1,32],c=[1,22],d=[1,23],b=[1,24],u=[1,25],p=[1,26],v=[1,33],f=[1,27],g=[1,28],y=[1,29],R=[1,30],P=[1,20],Q=[1,36],H=[1,37],le=[5,6,8,10,33,35,41,43,45],Ae=[1,39],Z=[1,40],ne=[5,6,8,10,12,14,16,19,21,22,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],ge=[10,16,19,21,22,28,29,30,31,32,34,37,39,42,43,44,46],te=[5,6,8,10,12,14,16,18,19,21,22,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],He={trace:function(){},yy:{},symbols_:{error:2,equation:3,expression:4,SIGN:5,EOF:6,additive:7,"+":8,multiplicative:9,"-":10,triglog:11,"*":12,negative:13,"/":14,trig:15,TRIG:16,trigfunc:17,"^":18,TRIGINV:19,logbase:20,ln:21,log:22,_:23,subscriptable:24,power:25,primitive:26,variable:27,VAR:28,CONST:29,INT:30,FLOAT:31,"{":32,"}":33,"(":34,")":35,function:36,FUNC:37,invocation:38,sqrt:39,"[":40,"]":41,abs:42,"|":43,"LEFT|":44,"RIGHT|":45,FRAC:46,$accept:0,$end:1},terminals_:{2:"error",5:"SIGN",6:"EOF",8:"+",10:"-",12:"*",14:"/",16:"TRIG",18:"^",19:"TRIGINV",21:"ln",22:"log",23:"_",28:"VAR",29:"CONST",30:"INT",31:"FLOAT",32:"{",33:"}",34:"(",35:")",37:"FUNC",39:"sqrt",40:"[",41:"]",42:"abs",43:"|",44:"LEFT|",45:"RIGHT|",46:"FRAC"},productions_:[0,[3,4],[3,2],[3,1],[4,1],[7,3],[7,3],[7,1],[9,2],[9,3],[9,3],[9,1],[13,2],[13,1],[15,1],[17,1],[17,3],[17,1],[20,1],[20,1],[20,3],[11,2],[11,2],[11,1],[25,3],[25,1],[27,1],[24,3],[24,1],[24,1],[24,1],[24,1],[24,3],[24,3],[36,1],[38,4],[38,4],[38,7],[38,4],[38,3],[38,3],[38,4],[26,1],[26,1],[26,7]],performAction:function(A,L,E,C,B,F,ke){var q=F.length-1;switch(B){case 1:return new C.Eq(F[q-3],F[q-2],F[q-1]);case 2:return F[q-1];case 3:return new C.Add([]);case 4:case 7:case 11:case 13:case 15:case 20:case 23:case 25:case 42:case 43:this.$=F[q];break;case 5:this.$=C.Add.createOrAppend(F[q-2],F[q]);break;case 6:this.$=C.Add.createOrAppend(F[q-2],C.Mul.handleNegative(F[q],"subtract"));break;case 8:this.$=C.Mul.fold(C.Mul.createOrAppend(F[q-1],F[q]));break;case 9:this.$=C.Mul.fold(C.Mul.createOrAppend(F[q-2],F[q]));break;case 10:this.$=C.Mul.fold(C.Mul.handleDivide(F[q-2],F[q]));break;case 12:this.$=C.Mul.handleNegative(F[q]);break;case 14:case 17:this.$=[A];break;case 16:this.$=F[q-2].concat(F[q]);break;case 18:this.$=C.Log.natural();break;case 19:this.$=C.Log.common();break;case 21:this.$=C.Trig.create(F[q-1],F[q]);break;case 22:this.$=C.Log.create(F[q-1],F[q]);break;case 24:this.$=new C.Pow(F[q-2],F[q]);break;case 26:case 34:this.$=A;break;case 27:this.$=new C.Var(F[q-2],F[q]);break;case 28:this.$=new C.Var(F[q]);break;case 29:this.$=new C.Const(A.toLowerCase());break;case 30:this.$=C.Int.create(Number(A));break;case 31:this.$=C.Float.create(Number(A));break;case 32:this.$=F[q-1].completeParse();break;case 33:this.$=F[q-1].completeParse().addHint("parens");break;case 35:case 36:this.$=C.Pow.sqrt(F[q-1]);break;case 37:this.$=new C.Pow.nthroot(F[q-1],F[q-4]);break;case 38:case 39:case 40:this.$=new C.Abs(F[q-1]);break;case 41:this.$=new C.Func(F[q-3],F[q-1]);break;case 44:this.$=C.Mul.handleDivide(F[q-4],F[q-1]);break}},table:[{3:1,4:2,6:[1,3],7:4,9:5,10:n,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:b,32:u,34:p,36:31,37:v,38:19,39:f,42:g,43:y,44:R,46:P},{1:[3]},{5:[1,34],6:[1,35]},{1:[2,3]},r([5,6],[2,4],{8:Q,10:H}),r(le,[2,7],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:Ae,14:Z,16:e,19:t,21:s,22:i,28:a,29:c,30:d,31:b,32:u,34:p,37:v,39:f,42:g,44:R,46:P}),r(ne,[2,11]),{10:n,11:8,13:41,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:b,32:u,34:p,36:31,37:v,38:19,39:f,42:g,43:y,44:R,46:P},r(ne,[2,13]),{10:n,11:8,13:42,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:b,32:u,34:p,36:31,37:v,38:19,39:f,42:g,43:y,44:R,46:P},{10:n,11:8,13:43,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:b,32:u,34:p,36:31,37:v,38:19,39:f,42:g,43:y,44:R,46:P},r(ne,[2,23]),r(ge,[2,15],{18:[1,44]}),r(ge,[2,17]),r(ge,[2,18]),r(ge,[2,19],{23:[1,45]}),r(ne,[2,25],{18:[1,46]}),r([10,16,18,19,21,22,28,29,30,31,32,34,37,39,42,43,44,46],[2,14]),r(te,[2,42]),r(te,[2,43]),{32:[1,47]},r(te,[2,28],{23:[1,48]}),r(te,[2,29]),r(te,[2,30]),r(te,[2,31]),{7:49,9:5,10:n,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:b,32:u,34:p,36:31,37:v,38:19,39:f,42:g,43:y,44:R,46:P},{7:50,9:5,10:n,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:b,32:u,34:p,36:31,37:v,38:19,39:f,42:g,43:y,44:R,46:P},{32:[1,52],34:[1,51],40:[1,53]},{34:[1,54]},{7:55,9:5,10:n,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:b,32:u,34:p,36:31,37:v,38:19,39:f,42:g,43:y,44:R,46:P},{7:56,9:5,10:n,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:b,32:u,34:p,36:31,37:v,38:19,39:f,42:g,43:y,44:R,46:P},{34:[1,57]},r([5,6,8,10,12,14,16,18,19,21,22,23,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],[2,26]),{34:[2,34]},{4:58,7:4,9:5,10:n,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:b,32:u,34:p,36:31,37:v,38:19,39:f,42:g,43:y,44:R,46:P},{1:[2,2]},{9:59,10:n,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:b,32:u,34:p,36:31,37:v,38:19,39:f,42:g,43:y,44:R,46:P},{9:60,10:n,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:b,32:u,34:p,36:31,37:v,38:19,39:f,42:g,43:y,44:R,46:P},r(ne,[2,8]),{10:n,11:8,13:61,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:b,32:u,34:p,36:31,37:v,38:19,39:f,42:g,43:y,44:R,46:P},{10:n,11:8,13:62,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:b,32:u,34:p,36:31,37:v,38:19,39:f,42:g,43:y,44:R,46:P},r(ne,[2,12]),r(ne,[2,21]),r(ne,[2,22]),{10:n,11:8,13:63,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:b,32:u,34:p,36:31,37:v,38:19,39:f,42:g,43:y,44:R,46:P},{24:64,27:21,28:a,29:c,30:d,31:b,32:u,34:p},{10:n,11:8,13:65,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:b,32:u,34:p,36:31,37:v,38:19,39:f,42:g,43:y,44:R,46:P},{7:66,9:5,10:n,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:b,32:u,34:p,36:31,37:v,38:19,39:f,42:g,43:y,44:R,46:P},{24:67,27:21,28:a,29:c,30:d,31:b,32:u,34:p},{8:Q,10:H,33:[1,68]},{8:Q,10:H,35:[1,69]},{7:70,9:5,10:n,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:b,32:u,34:p,36:31,37:v,38:19,39:f,42:g,43:y,44:R,46:P},{7:71,9:5,10:n,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:b,32:u,34:p,36:31,37:v,38:19,39:f,42:g,43:y,44:R,46:P},{7:72,9:5,10:n,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:b,32:u,34:p,36:31,37:v,38:19,39:f,42:g,43:y,44:R,46:P},{7:73,9:5,10:n,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:b,32:u,34:p,36:31,37:v,38:19,39:f,42:g,43:y,44:R,46:P},{8:Q,10:H,43:[1,74]},{8:Q,10:H,45:[1,75]},{7:76,9:5,10:n,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:b,32:u,34:p,36:31,37:v,38:19,39:f,42:g,43:y,44:R,46:P},{6:[1,77]},r(le,[2,5],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:Ae,14:Z,16:e,19:t,21:s,22:i,28:a,29:c,30:d,31:b,32:u,34:p,37:v,39:f,42:g,44:R,46:P}),r(le,[2,6],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:Ae,14:Z,16:e,19:t,21:s,22:i,28:a,29:c,30:d,31:b,32:u,34:p,37:v,39:f,42:g,44:R,46:P}),r(ne,[2,9]),r(ne,[2,10]),r(ge,[2,16]),r(ge,[2,20]),r(ne,[2,24]),{8:Q,10:H,33:[1,78]},r(te,[2,27]),r(te,[2,32]),r(te,[2,33]),{8:Q,10:H,35:[1,79]},{8:Q,10:H,33:[1,80]},{8:Q,10:H,41:[1,81]},{8:Q,10:H,35:[1,82]},r(te,[2,39]),r(te,[2,40]),{8:Q,10:H,35:[1,83]},{1:[2,1]},{32:[1,84]},r(te,[2,35]),r(te,[2,36]),{32:[1,85]},r(te,[2,38]),r(te,[2,41]),{7:86,9:5,10:n,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:b,32:u,34:p,36:31,37:v,38:19,39:f,42:g,43:y,44:R,46:P},{7:87,9:5,10:n,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:b,32:u,34:p,36:31,37:v,38:19,39:f,42:g,43:y,44:R,46:P},{8:Q,10:H,33:[1,88]},{8:Q,10:H,33:[1,89]},r(te,[2,44]),r(te,[2,37])],defaultActions:{3:[2,3],33:[2,34],35:[2,2],77:[2,1]},parseError:function(A,L){if(L.recoverable)this.trace(A);else throw new Error(A)},parse:function(A){var L=this,E=[0],C=[null],B=[],F=this.table,ke="",q=0,ve=0,rn=2,It=1,sn=B.slice.call(arguments,1),se=Object.create(this.lexer),Ie={yy:{}};for(var ht in this.yy)Object.prototype.hasOwnProperty.call(this.yy,ht)&&(Ie.yy[ht]=this.yy[ht]);se.setInput(A,Ie.yy),Ie.yy.lexer=se,Ie.yy.parser=this,typeof se.yylloc>"u"&&(se.yylloc={});var ft=se.yylloc;B.push(ft);var an=se.options&&se.options.ranges;typeof Ie.yy.parseError=="function"?this.parseError=Ie.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function on(){var Ge;return Ge=se.lex()||It,typeof Ge!="number"&&(Ge=L.symbols_[Ge]||Ge),Ge}for(var he,Me,fe,pt,qe={},Je,be,Mt,Qe;;){if(Me=E[E.length-1],this.defaultActions[Me]?fe=this.defaultActions[Me]:((he===null||typeof he>"u")&&(he=on()),fe=F[Me]&&F[Me][he]),typeof fe>"u"||!fe.length||!fe[0]){var dt="";Qe=[];for(Je in F[Me])this.terminals_[Je]&&Je>rn&&Qe.push("'"+this.terminals_[Je]+"'");se.showPosition?dt="Parse error on line "+(q+1)+`:
`+se.showPosition()+`
Expecting `+Qe.join(", ")+", got '"+(this.terminals_[he]||he)+"'":dt="Parse error on line "+(q+1)+": Unexpected "+(he==It?"end of input":"'"+(this.terminals_[he]||he)+"'"),this.parseError(dt,{text:se.match,token:this.terminals_[he]||he,line:se.yylineno,loc:ft,expected:Qe})}if(fe[0]instanceof Array&&fe.length>1)throw new Error("Parse Error: multiple actions possible at state: "+Me+", token: "+he);switch(fe[0]){case 1:E.push(he),C.push(se.yytext),B.push(se.yylloc),E.push(fe[1]),he=null,ve=se.yyleng,ke=se.yytext,q=se.yylineno,ft=se.yylloc;break;case 2:if(be=this.productions_[fe[1]][1],qe.$=C[C.length-be],qe._$={first_line:B[B.length-(be||1)].first_line,last_line:B[B.length-1].last_line,first_column:B[B.length-(be||1)].first_column,last_column:B[B.length-1].last_column},an&&(qe._$.range=[B[B.length-(be||1)].range[0],B[B.length-1].range[1]]),pt=this.performAction.apply(qe,[ke,ve,q,Ie.yy,fe[1],C,B].concat(sn)),typeof pt<"u")return pt;be&&(E=E.slice(0,-1*be*2),C=C.slice(0,-1*be),B=B.slice(0,-1*be)),E.push(this.productions_[fe[1]][0]),C.push(qe.$),B.push(qe._$),Mt=F[E[E.length-2]][E[E.length-1]],E.push(Mt);break;case 3:return!0}}return!0}},ut=function(){var oe={EOF:1,parseError:function(L,E){if(this.yy.parser)this.yy.parser.parseError(L,E);else throw new Error(L)},setInput:function(A,L){return this.yy=L||this.yy||{},this._input=A,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var A=this._input[0];this.yytext+=A,this.yyleng++,this.offset++,this.match+=A,this.matched+=A;var L=A.match(/(?:\r\n?|\n).*/g);return L?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),A},unput:function(A){var L=A.length,E=A.split(/(?:\r\n?|\n)/g);this._input=A+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-L),this.offset-=L;var C=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),E.length-1&&(this.yylineno-=E.length-1);var B=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:E?(E.length===C.length?this.yylloc.first_column:0)+C[C.length-E.length].length-E[0].length:this.yylloc.first_column-L},this.options.ranges&&(this.yylloc.range=[B[0],B[0]+this.yyleng-L]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(A){this.unput(this.match.slice(A))},pastInput:function(){var A=this.matched.substr(0,this.matched.length-this.match.length);return(A.length>20?"...":"")+A.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var A=this.match;return A.length<20&&(A+=this._input.substr(0,20-A.length)),(A.substr(0,20)+(A.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var A=this.pastInput(),L=new Array(A.length+1).join("-");return A+this.upcomingInput()+`
`+L+"^"},test_match:function(A,L){var E,C,B;if(this.options.backtrack_lexer&&(B={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(B.yylloc.range=this.yylloc.range.slice(0))),C=A[0].match(/(?:\r\n?|\n).*/g),C&&(this.yylineno+=C.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:C?C[C.length-1].length-C[C.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+A[0].length},this.yytext+=A[0],this.match+=A[0],this.matches=A,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(A[0].length),this.matched+=A[0],E=this.performAction.call(this,this.yy,this,L,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),E)return E;if(this._backtrack){for(var F in B)this[F]=B[F];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var A,L,E,C;this._more||(this.yytext="",this.match="");for(var B=this._currentRules(),F=0;F<B.length;F++)if(E=this._input.match(this.rules[B[F]]),E&&(!L||E[0].length>L[0].length)){if(L=E,C=F,this.options.backtrack_lexer){if(A=this.test_match(E,B[F]),A!==!1)return A;if(this._backtrack){L=!1;continue}else return!1}else if(!this.options.flex)break}return L?(A=this.test_match(L,B[C]),A!==!1?A:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var L=this.next();return L||this.lex()},begin:function(L){this.conditionStack.push(L)},popState:function(){var L=this.conditionStack.length-1;return L>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(L){return L=this.conditionStack.length-1-Math.abs(L||0),L>=0?this.conditionStack[L]:"INITIAL"},pushState:function(L){this.begin(L)},stateStackSize:function(){return this.conditionStack.length},options:{flex:!0},performAction:function(L,E,C,B){switch(C){case 0:break;case 1:break;case 2:break;case 3:return"INT";case 4:return"FLOAT";case 5:return"^";case 6:return"*";case 7:return"*";case 8:return"*";case 9:return"*";case 10:return"/";case 11:return"/";case 12:return"-";case 13:return"-";case 14:return"+";case 15:return"^";case 16:return"(";case 17:return")";case 18:return"(";case 19:return")";case 20:return"[";case 21:return"]";case 22:return"{";case 23:return"}";case 24:return"{";case 25:return"}";case 26:return"_";case 27:return"|";case 28:return"LEFT|";case 29:return"RIGHT|";case 30:return"!";case 31:return"SIGN";case 32:return E.yytext="<=","SIGN";case 33:return E.yytext=">=","SIGN";case 34:return E.yytext="<=","SIGN";case 35:return E.yytext=">=","SIGN";case 36:return E.yytext="<>","SIGN";case 37:return E.yytext="<>","SIGN";case 38:return E.yytext="<>","SIGN";case 39:return E.yytext="<>","SIGN";case 40:return E.yytext="<=","SIGN";case 41:return E.yytext=">=","SIGN";case 42:return"FRAC";case 43:return"FRAC";case 44:return"sqrt";case 45:return"abs";case 46:return"ln";case 47:return"log";case 48:return"TRIG";case 49:return"TRIG";case 50:return"TRIG";case 51:return"TRIG";case 52:return E.yytext="sin","TRIG";case 53:return E.yytext="cos","TRIG";case 54:return E.yytext="tan","TRIG";case 55:return E.yytext="csc","TRIG";case 56:return E.yytext="sec","TRIG";case 57:return E.yytext="cot","TRIG";case 58:return E.yytext="arcsin","TRIG";case 59:return E.yytext="arccos","TRIG";case 60:return E.yytext="arctan","TRIG";case 61:return E.yytext="arccsc","TRIG";case 62:return E.yytext="arcsec","TRIG";case 63:return E.yytext="arccot","TRIG";case 64:return"TRIGINV";case 65:return"TRIGINV";case 66:return E.yytext="sinh","TRIG";case 67:return E.yytext="cosh","TRIG";case 68:return E.yytext="tanh","TRIG";case 69:return E.yytext="csch","TRIG";case 70:return E.yytext="sech","TRIG";case 71:return E.yytext="tanh","TRIG";case 72:return"CONST";case 73:return E.yytext="pi","CONST";case 74:return E.yytext="pi","CONST";case 75:return"VAR";case 76:return E.yytext="theta","VAR";case 77:return E.yytext="theta","VAR";case 78:return"VAR";case 79:return E.yytext="phi","VAR";case 80:return E.yytext="phi","VAR";case 81:return L.symbolLexer(E.yytext);case 82:return"EOF";case 83:return"INVALID";case 84:console.log(E.yytext);break}},rules:[/^(?:\s+)/,/^(?:\\space)/,/^(?:\\ )/,/^(?:[0-9]+\.?)/,/^(?:([0-9]+)?\.[0-9]+)/,/^(?:\*\*)/,/^(?:\*)/,/^(?:\\cdot|·)/,/^(?:\\times|×)/,/^(?:\\ast)/,/^(?:\/)/,/^(?:\\div|÷)/,/^(?:-)/,/^(?:−)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:\\left\()/,/^(?:\\right\))/,/^(?:\[)/,/^(?:\])/,/^(?:\{)/,/^(?:\})/,/^(?:\\left\{)/,/^(?:\\right\})/,/^(?:_)/,/^(?:\|)/,/^(?:\\left\|)/,/^(?:\\right\|)/,/^(?:\!)/,/^(?:<=|>=|<>|<|>|=)/,/^(?:\\le)/,/^(?:\\ge)/,/^(?:\\leq)/,/^(?:\\geq)/,/^(?:=\/=)/,/^(?:\\ne)/,/^(?:\\neq)/,/^(?:≠)/,/^(?:≤)/,/^(?:≥)/,/^(?:\\frac)/,/^(?:\\dfrac)/,/^(?:sqrt|\\sqrt)/,/^(?:abs|\\abs)/,/^(?:ln|\\ln)/,/^(?:log|\\log)/,/^(?:sin|cos|tan)/,/^(?:csc|sec|cot)/,/^(?:sinh|cosh|tanh)/,/^(?:csch|sech|coth)/,/^(?:\\sin)/,/^(?:\\cos)/,/^(?:\\tan)/,/^(?:\\csc)/,/^(?:\\sec)/,/^(?:\\cot)/,/^(?:\\arcsin)/,/^(?:\\arccos)/,/^(?:\\arctan)/,/^(?:\\arccsc)/,/^(?:\\arcsec)/,/^(?:\\arccot)/,/^(?:arcsin|arccos|arctan)/,/^(?:arccsc|arcsec|arccot)/,/^(?:\\sinh)/,/^(?:\\cosh)/,/^(?:\\tanh)/,/^(?:\\csch)/,/^(?:\\sech)/,/^(?:\\coth)/,/^(?:pi)/,/^(?:π)/,/^(?:\\pi)/,/^(?:theta)/,/^(?:θ)/,/^(?:\\theta)/,/^(?:phi)/,/^(?:φ)/,/^(?:\\phi)/,/^(?:[a-zA-Z])/,/^(?:$)/,/^(?:.)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84],inclusive:!0}}};return oe}();He.lexer=ut;function re(){this.yy={}}return re.prototype=He,He.Parser=re,new re}();const Ft=function(r){return r!==r},Ln=function(r,n){var e=n-r;return Math.random()*e+r};var Lt=12,Dn=9;function Ue(r,n){const e=[],t=[];return l.forEach(r,(s,i,a)=>{n(s,i,a)?e.push(s):t.push(s)}),[e,t]}function Rn(r){return r instanceof me}const tt=function(r){return r instanceof ee};function qn(r){return r instanceof W}function gt(r){return r instanceof w?r.terms:[r]}class me{constructor(){G(this,"hints");this.hints={parens:!1}}construct(n){const e=this.func,t=new e(...n);if(typeof t>"u")throw new Error("constructor function returning undefined");return t}recurse(n,...e){var t=this.args().map(function(s){return l.isString(s)||l.isNumber(s)?s:s==null?void 0:s[n].apply(s,e)});return this.construct(t)}eval(n={},e){throw new Error("Abstract method - must override for expr: "+this.print())}codegen(){throw new Error("Abstract method - must override for expr: "+this.print())}compile(){var n=this.codegen();try{return new Function("vars","return "+n+";")}catch{throw new Error("Function did not compile: "+n)}}asTex(n){n=n||{},l.defaults(n,{display:!0,dynamic:!0,times:!1});let e=this.tex();return n.display&&(e="\\displaystyle "+e),n.dynamic&&(e=e.replace(/\(/g,"\\left("),e=e.replace(/\)/g,"\\right)")),n.times&&(e=e.replace(/\\cdot/g,"\\times")),e}name(){return this.func.name}repr(){return this.name()+"("+this.args().map(function(n){return l.isString(n)||l.isNumber(n)?n:n==null?void 0:n.repr()}).join(",")+")"}strip(){return this.recurse("strip")}normalize(){return this.recurse("normalize")}expand(){return this.recurse("expand")}factor(n){return this.recurse("factor",n)}collect(n){return this.recurse("collect",n)}equals(n){return this.normalize().print()===n.normalize().print()}simplify(n){n={once:!1,...n};var e=this.factor(n),t=e.collect(n);e.equals(t)&&(t=this.collect(n));var s=t.expand(),i=s.collect(n);s.equals(i)&&(i=t.collect(n));var a=i;return n.once||this.equals(a)?a:a.simplify(n)}isSimplified(){return this.equals(this.simplify())}exprArgs(){return this.args().filter(Rn)}getVars(n){return l.uniq(l.flatten(l.invoke(this.exprArgs(),"getVars",n))).sort()}getConsts(){return l.uniq(l.flatten(l.invoke(this.exprArgs(),"getConsts"))).sort()}getUnits(){return l.flatten(l.invoke(this.exprArgs(),"getUnits"))}is(n){return this instanceof n}has(n){return this instanceof n?!0:l.any(this.exprArgs(),function(e){return e.has(n)})}raiseToThe(n,e){return new V(this,n)}isSubtract(){return!1}isDivide(){return!1}isRoot(){return!1}needsExplicitMul(){return this.exprArgs()[0].needsExplicitMul()}sameVars(n){var e=this.getVars(),t=n.getVars(),s=function(d,b){return!l.difference(d,b).length},i=function(d){return l.uniq(l.invoke(d,"toLowerCase")).sort()},a=s(e,t),c=s(i(e),i(t));return{equal:a,equalIgnoringCase:c}}compare(n){if(n instanceof ze)return!1;var e=l.union(this.getVars(!0),n.getVars(!0)),t=function(g,y){return Math.abs(g)<1||Math.abs(y)<1?Math.abs(g-y):Math.abs(1-g/y)},s=function(g,y){var R=t(g,y);return g===y||Ft(g)&&Ft(y)||R<Math.pow(10,-9)};if(!l.union(this.getVars(!1),n.getVars(!1)).length&&!this.has(ce)&&!n.has(ce))return s(this.eval(),n.eval());var a=this.collect(),c=n.collect(),d=this.getUnits(),b=n.getUnits();if(!l.isEqual(d,b))return!1;for(var u=0;u<Lt;u++){var p={},v=Math.pow(10,1+Math.floor(3*u/Lt)),f=u%2===0;l.each(e,function(y){p[y]=f?Ln(-v,v):l.random(-v,v)});let g;if(a.has(Se)||c.has(Se)||a.has(ce)||c.has(ce)){const y=a.partialEval(p),R=c.partialEval(p);g=y.simplify().equals(R.simplify())}else{const y=a.eval(p),R=c.eval(p);g=s(y,R)}if(!g)return!1}return!0}partialEval(n){return this instanceof ce?this:this.has(Se)?this instanceof Se?new Se(this.symbol,this.arg.partialEval(n)):this.recurse("partialEval",n):new ie(+this.eval(n).toFixed(Dn)).collect()}sameForm(n){return this.strip().equals(n.strip())}findGCD(n){return this.equals(n)?n:X}getDenominator(){return X}asMul(){return new w(X,this)}isPositive(){throw new Error("Abstract method - must override for expr: "+this.print())}isNegative(){return!1}asPositiveFactor(){return this.isPositive()?this:X}addHint(n){if(!n)return this;var e=this.construct(this.args());return e.hints=l.clone(this.hints),e.hints[n]=!0,e}completeParse(){return this.recurse("completeParse")}abs(){throw new Error("Abstract method - must override for expr: "+this.print())}negate(){return new w(we,this)}}class st extends me{constructor(...e){super();G(this,"terms");e.length===1?this.terms=e[0]:this.terms=e}args(){return this.terms}normalize(){var e=l.sortBy(l.invoke(this.terms,"normalize"),t=>t.print());return new this.func(e)}expand(){return this.recurse("expand").flatten()}partition(){var[e,t]=Ue(this.terms,s=>s instanceof _);return[new this.func(e),new this.func(t)]}flatten(){var e=this,t=l.reject(this.terms,c=>c.equals(e.identity));if(t.length===0)return e.identity;if(t.length===1)return t[0];const[s,i]=Ue(t,c=>c instanceof e.func);var a=i.concat(l.flatten(l.pluck(s,"terms"),!0));return new e.func(a)}isPositive(){var e=l.invoke(this.terms,"collect");return l.all(l.invoke(e,"isPositive"))}replace(e,t){const s=e instanceof me?l.indexOf(this.terms,e):e;var i=[];Array.isArray(t)?i=t:t&&(i=[t]);var a=this.terms.slice(0,s).concat(i).concat(this.terms.slice(s+1));return new this.func(a)}remove(e){return this.replace(e)}getDenominator(){return new w(l.invoke(this.terms,"getDenominator")).flatten()}}class ee extends st{constructor(){super(...arguments);G(this,"identity",Ye);G(this,"func",ee)}eval(e={},t){return l.reduce(this.terms,(s,i)=>s+i.eval(e,t),0)}codegen(){return l.map(this.terms,e=>"("+e.codegen()+")").join(" + ")||"0"}print(){return l.invoke(this.terms,"print").join("+")}tex(){let e="";return l.each(this.terms,t=>{!e||t.isSubtract()?e+=t.tex():e+="+"+t.tex()}),e}collect(e){var t=l.invoke(this.terms,"collect",e),s=[];l.each(t,c=>{if(c instanceof w){var d=c.partition();s.push([d[1].flatten(),d[0].reduce(e)])}else c instanceof _?s.push([X,c]):s.push([c,X])});var i=l.groupBy(s,c=>c[0].normalize().print()),a=l.compact(l.map(i,c=>{var d=c[0][0],b=new ee(l.zip.apply(l,c)[1]),u=b.reduce(e);return new w(u,d).collect(e)}));return new ee(a).flatten()}factor(e={keepNegative:!1}){const t=this.terms.map(d=>d.collect());let s;t[0]instanceof w?s=t[0].terms:s=[t[0]],l.each(l.rest(this.terms),d=>{s=l.map(s,b=>d.findGCD(b))}),!e.keepNegative&&this.isNegative()&&s.push(we);const i=new w(s).flatten().collect(),a=t.map(d=>w.handleDivide(d,i).simplify()),c=new ee(a).flatten();return w.createOrAppend(i,c).flatten()}reduce(e){return l.reduce(this.terms,(t,s)=>t.add(s,e),this.identity)}needsExplicitMul(){return!1}isNegative(){var e=l.invoke(this.terms,"collect");return l.all(l.invoke(e,"isNegative"))}negate(){return new ee(l.invoke(this.terms,"negate"))}static createOrAppend(e,t){return e instanceof ee?new ee(e.terms.concat(t)):new ee(e,t)}}class w extends st{constructor(){super(...arguments);G(this,"identity",X);G(this,"func",w)}eval(e={},t){return l.reduce(this.terms,(s,i)=>s*i.eval(e,t),1)}codegen(){return l.map(this.terms,e=>"("+e.codegen()+")").join(" * ")||"0"}print(){return l.map(this.terms,e=>e instanceof ee?"("+e.print()+")":e.print()).join("*")}getUnits(){var e=l(this.terms).chain().map(t=>t.getUnits()).flatten().value();return e.sort((t,s)=>t.unit.localeCompare(s.unit)),e}tex(){for(var e=" \\cdot ",t=l.groupBy(this.terms,y=>y.isDivide()?"inverse":y instanceof _?"number":"other"),s=t.inverse||[],i=t.number||[],a=t.other||[],c="",d,b=0;b<i.length;b++){var u=i[b]instanceof W&&!(i[b]instanceof N);if(u&&a.length>0&&s.length>0){var p=i.slice();p.splice(b,1);var v=p.concat(s).concat(a);return i[b].tex()+new w(v).tex()}}if(i=l.compact(l.map(i,y=>{var R=!y.hints.fraction||s.length>0;if(y instanceof W&&!(y instanceof N)&&R){s.push(new V(new N(y.d),Pe));var P=new N(y.n);return P.hints=y.hints,l.any(y.hints)?P:null}else return y})),i.length===0&&a.length===1)d=a[0].tex();else{var f="";l.each(i,y=>{y.hints.subtract&&y.hints.entered?(c+="-",f+=(f?e:"")+y.abs().tex()):y instanceof N&&y.n===-1&&(y.hints.negate||y.hints.subtract)?c+="-":f+=(f?e:"")+y.tex()}),l.each(a,y=>{y.needsExplicitMul()?f+=(f?e:"")+y.tex():y instanceof ee?f+="("+y.tex()+")":f+=y.tex()}),d=f||"1"}if(s.length){var g=new w(l.invoke(s,"asDivide")).flatten().tex();return c+"\\frac{"+d+"}{"+g+"}"}else return c+d}strip(){var e=l.map(this.terms,t=>t instanceof _?t.abs():t.strip());return new w(e).flatten()}expand(){const e=function(u){return u instanceof V&&u.exp.isNegative()},t=function(u){return e(u)&&tt(u.base)},s=this.recurse("expand").flatten(),i=gt(s),a=l.any(i,tt),c=l.any(i,t);if(!(a||c))return s;let[d,b]=Ue(i,e);if(a){const[u,p]=Ue(b,tt),v=l.reduce(u,function(g,y){return l.reduce(g,function(R,P){return R.concat(l.map(y.terms,Q=>P.concat(Q)))},[])},[[]]),f=l.map(v,function(g){return new w(p.concat(g)).flatten()});b=[new ee(f)]}if(c){const u=new w(l.invoke(d,"getDenominator")).flatten();d=[new V(u.expand(),Pe)]}return new w(b.concat(d)).flatten()}factor(e){var t=this.recurse("factor",e).flatten();if(!(t instanceof w))return t;var[s,i]=Ue(t.terms,d=>d instanceof W);const a=l.reduce(s,(d,b)=>({n:d.n*b.n,d:d.d*b.d}),{n:1,d:1}),c=a.d===1?new N(a.n):new W(a.n,a.d);return new w(i.concat(c)).flatten()}collect(e){var t=this.recurse("collect",e).partition(),s=t[0].reduce(e);if(s.eval()===0)return Ye;const i=t[1].flatten();if(!(i instanceof w))return new w(s,i).flatten();const a=i.terms;var c=[];l.each(a,P=>{P instanceof V?c.push([P.base,P.exp]):c.push([P,X])});var d=l.groupBy(c,P=>P[0].normalize().print()),b=l.compact(l.map(d,P=>{var Q=P[0][0],H=new ee(l.zip.apply(l,P)[1]),le=H.collect(e);return le instanceof _&&le.eval()===0?null:[Q,le]}));const u=l.groupBy(b,P=>P[0]instanceof z&&P[0].isBasic()?"trig":P[0]instanceof ae?"log":"expr");let p=u.trig||[],v=u.log||[];const f=u.expr||[];if(p.length>1){var g=l.groupBy(p,P=>P[0].arg.normalize().print());p=[],l.each(g,P=>{const Q=P[0][0].arg;let H={sin:Ye,cos:Ye};l.each(P,le=>{H[le[0].type]=le[1]}),w.handleNegative(H.sin).collect(e).equals(H.cos)&&(H.cos.isNegative()?H={tan:H.sin}:H={cot:H.cos}),l.each(H,(le,Ae)=>{p.push([new z(Ae,Q),le])})})}if(v.length>1){var y=l.groupBy(v,P=>P[0].base.normalize().print());v=[],l.each(y,P=>{P.length===2&&w.handleNegative(P[0][1]).collect(e).equals(P[1][1])?P[0][1].isNegative()?v.push([new ae(P[0][0].power,P[1][0].power),P[1][1]]):v.push([new ae(P[1][0].power,P[0][0].power),P[0][1]]):v=v.concat(P)})}var R=l.map([...p,...v,...f],P=>new V(P[0],P[1]).collect(e));return new w([s].concat(R)).flatten()}isSubtract(){return l.any(this.terms,e=>e instanceof _&&!!e.hints.subtract)}factorIn(e){var t=this.partition(),s=t[0].terms,i=s.length&&l.all(s,c=>c.n>0);if(i){var a=s[0].negate();return a.hints=s[0].hints,this.replace(s[0],a.addHint(e))}else return new w([_.negativeOne(e)].concat(this.terms))}factorOut(){var e=!1,t=l.compact(l.map(this.terms,s=>!e&&s instanceof _&&s.hints.divide?(e=!0,s.n!==-1?s.negate():null):s));return t.length===1?t[0]:new w(t)}reduce(e){return l.reduce(this.terms,(t,s)=>t.mul(s,e),this.identity)}findGCD(e){return new w(l.invoke(this.terms,"findGCD",e)).flatten()}asMul(){return this}asPositiveFactor(){if(this.isPositive())return this;{const e=gt(this.collect()).map(t=>t.asPositiveFactor());return new w(e).flatten()}}isNegative(){const e=gt(this.collect()).map(t=>t.isNegative());return l.any(e)}fold(){return w.fold(this)}negate(){var e=s=>s instanceof _;const t=l.find(this.terms,e);return t?this.replace(t,t.negate()):new w([we].concat(this.terms))}static handleNegative(e,t){if(e instanceof _&&e.n>0){var s=e.negate();return s.hints=e.hints,s.addHint(t)}else return e instanceof w?e.factorIn(t):new w(_.negativeOne(t),e)}static handleDivide(e,t){if(t instanceof w){var s=w.handleDivide(e,t.terms[0]),i=new w(l.rest(t.terms)).flatten();return w.handleDivide(s,i)}var a=f=>f instanceof N,c=f=>f instanceof W;if(a(t)&&e instanceof w&&l.any(e.terms,a)){var d=e.terms.slice().reverse(),b=d.find(c);if(!a(b))return new w(e.terms.concat([new W(1,t.n).addHint("fraction")]));var u=new W(b.n,t.n);return u.hints=b.hints,b===d[0]&&(u=u.addHint("fraction")),b.n<0&&t.n<0?(u.d=-u.d,e.replace(b,[we,u])):e.replace(b,u)}var p=(f,g)=>{if(g instanceof N){if(f instanceof N)return f.n<0&&g.n<0?[we,new W(f.n,-g.n).addHint("fraction")]:[new W(f.n,g.n).addHint("fraction")];var y=new W(1,g.eval());return g.eval()<0?[f,y.addHint("negate")]:[f,y]}else{var R;if(g instanceof z&&g.exp){var P=g.exp;g.exp=void 0,g=new V(g,P)}return g instanceof V?R=new V(g.base,w.handleNegative(g.exp,"divide")):R=new V(g,Pe),f instanceof N&&f.n===1?[R]:[f,R]}};if(e instanceof w){var v=p(l.last(e.terms),t);return new w(l.initial(e.terms).concat(v))}else{var v=p(e,t);return new w(v).flatten()}}static fold(e){if(e instanceof w){var t=l.find(l.initial(e.terms),f=>(f instanceof z||f instanceof ae)&&!!f.hints.open);if(t){const f=l.last(e.terms);if(t.hints.parens||f.hints.parens||f.has(z)||f.has(ae))t.hints.open=!1;else{const g=t instanceof z?z.create([t.type,t.exp],w.createOrAppend(t.arg,f).fold()):ae.create(t.base,w.createOrAppend(t.power,f).fold()),y=l.indexOf(e.terms,t);return y===0?g:new w(e.terms.slice(0,y).concat(g)).fold()}}var s=e.partition(),i=s[0].terms,a=f=>f.n>0,c=f=>f.n===-1&&!!f.hints.negate,d=function(f){return a(f)||c(f)};const p=i.find(a),v=i.find(c);if(i.length>1&&v&&p&&l.every(i,d)){var b=l.indexOf(e.terms,v),u=l.indexOf(e.terms,p);if(b<u)return e.replace(u,e.terms[u].negate()).remove(b)}}return e}static createOrAppend(e,t){return e instanceof w?new w(e.terms.concat(t)):new w(e,t)}}const K=class K extends me{constructor(e,t){super();G(this,"base");G(this,"exp");G(this,"func",K);this.base=e,this.exp=t}args(){return[this.base,this.exp]}eval(e={},t){var s=this.base.eval(e,t),i=this.exp.eval(e,t);if(s<0){var a=this.exp.simplify();if(a instanceof ie){var c=a.n,d=(c-+c.toFixed()).toString().length-2,b=Math.pow(10,d),u=new W(c*b,b);a=u.simplify()}if(a instanceof W){var p=Math.abs(a.d)%2===1;if(p){var v=Math.abs(a.n)%2===1,f=v?-1:1;return f*Math.pow(-1*s,i)}}}return Math.pow(s,i)}getUnits(){return this.base.getUnits().map(e=>({unit:e.unit,pow:e.pow*this.exp.n}))}codegen(){return"Math.pow("+this.base.codegen()+", "+this.exp.codegen()+")"}print(){var e=this.base.print();return(this.base instanceof st||this.base instanceof K)&&(e="("+e+")"),e+"^("+this.exp.print()+")"}tex(){if(this.isDivide())return"\\frac{1}{"+this.asDivide().tex()+"}";if(this.isRoot()&&qn(this.exp)){if(this.exp.n!==1)throw new Error("Node marked with hint 'root' does not have exponent of form 1/x.");return this.exp.d===2?"\\sqrt{"+this.base.tex()+"}":"\\sqrt["+this.exp.d+"]{"+this.base.tex()+"}"}else if(this.base instanceof z&&!this.base.isInverse()&&this.exp instanceof _&&this.exp.isSimple()&&this.exp.eval()>=0){var e=this.base.texSplit();return e[0]+"^{"+this.exp.tex()+"}"+e[1]}else{var t=this.base.tex();return this.base instanceof st||this.base instanceof K||this.base instanceof _&&!this.base.isSimple()?t="("+t+")":(this.base instanceof z||this.base instanceof ae)&&(t="["+t+"]"),t+"^{"+this.exp.tex()+"}"}}needsExplicitMul(){return this.isRoot()?!1:this.base.needsExplicitMul()}expand(){var e=this.recurse("expand");if(e.base instanceof w){var t=l.map(e.base.terms,d=>new K(d,e.exp));return new w(t).expand()}else if(e.base instanceof ee&&e.exp instanceof N&&e.exp.abs().eval()>1){var s=e.exp.eval()>0,i=e.exp.abs().eval(),a=function(v){return s?v:new K(v,Pe)};const d={1:e.base};for(var c=2;c<=i;c*=2){const v=new w(d[c/2],d[c/2]);d[c]=v.expand().collect()}if(i in d)return a(d[i]);let b=l.map(i.toString(2).split(""),function(v,f,g){return Number(v)*Math.pow(2,g.length-f-1)});b=l.without(b,0);const u=[];for(const v of b)v in d&&u.push(d[v]);const p=new w(u).expand().collect();return a(p)}else if(e.exp instanceof ee){const d=l.map(e.exp.terms,b=>new K(e.base,b).expand());return new w(d).expand()}else return e}factor(){var e=this.recurse("factor");if(e.base instanceof w){var t=l.map(e.base.terms,s=>s instanceof N&&e.exp.equals(Pe)?new W(1,s.n):new K(s,e.exp));return new w(t)}else return e}collect(e){if(this.base instanceof K){const i=this.base.base,a=w.createOrAppend(this.base.exp,this.exp);return new K(i,a).collect(e)}const t=this.recurse("collect",e),s=function(i){return i instanceof ae&&i.base.equals(t.base)};if(t.exp instanceof _&&t.exp.eval()===0)return X;if(t.exp instanceof _&&t.exp.eval()===1)return t.base;if(s(t.exp))return t.exp.power;if(t.exp instanceof w&&l.any(t.exp.terms,s)){const i=t.exp.terms.find(s),a=i.power,c=t.exp.remove(i).flatten();return new K(a,c).collect(e)}else if(t.base instanceof _&&t.exp instanceof _){if(e&&e.preciseFloats){const i=t.exp.asRational(),a=t.base.getDecimalPlaces();if(new K(t.base,new W(1,i.d)).collect().getDecimalPlaces()>a){const b=new K(t.base,new N(i.n)).collect();return new K(b,new W(1,i.d))}}return t.base.raiseToThe(t.exp,e)}else return t}isDivide(){var e=function(t){return t instanceof _&&!!t.hints.divide};return e(this.exp)||this.exp instanceof w&&l.any(this.exp.terms,e)}asDivide(){if(this.exp instanceof _){if(this.exp.eval()===-1)return this.base;var e=this.exp.negate();return e.hints=l.clone(this.exp.hints),e.hints.divide=!1,new K(this.base,e)}else{if(this.exp instanceof w)return new K(this.base,this.exp.factorOut());throw new Error("called asDivide() on an Expr that wasn't a Num or Mul")}}isRoot(){return this.exp instanceof W&&!!this.exp.hints.root}isSquaredTrig(){return this.base instanceof z&&!this.base.isInverse()&&this.exp instanceof _&&this.exp.eval()===2}getDenominator(){if(this.exp instanceof _&&this.exp.eval()===-1)return w.createOrAppend(this.base,this.base.getDenominator()).flatten();if(this.exp.isNegative()){var e=new K(this.base,w.handleNegative(this.exp).collect());return w.createOrAppend(e,e.collect().getDenominator()).flatten()}else return this.base instanceof _?new K(this.base.getDenominator(),this.exp).collect():X}findGCD(e){const[t,s]=e instanceof K?[e.base,e.exp]:[e,X];if(this.base.equals(t)){if(this.exp.equals(s))return this;if(this.exp instanceof _&&s instanceof _)return new K(this.base,_.min(this.exp,s)).collect();if(this.exp instanceof _||s instanceof _)return X;var i=this.exp.asMul().partition(),a=s.asMul().partition();if(i[1].equals(a[1])){var c=_.min(i[0].reduce(),a[0].reduce()),d=new w(c,i[1].flatten()).flatten();return new K(t,d).collect()}}return X}isPositive(){if(this.base.isPositive())return!0;var e=this.exp.simplify();return e instanceof N&&e.eval()%2===0}asPositiveFactor(){if(this.isPositive())return this;var e=this.exp.simplify();if(e instanceof N){var t=e.eval();if(t>2)return new K(this.base,new N(t-1));if(t<-2)return new K(this.base,new N(t+1))}return X}static sqrt(e){return new K(e,_n)}};G(K,"nthroot",function(e,t){var s=w.fold(w.handleDivide(new N(1),t));return new K(e,s.addHint("root"))});let V=K;class ae extends me{constructor(e,t){super();G(this,"base");G(this,"power");G(this,"func",ae);this.base=e,this.power=t,this.hints={...this.hints,open:!1}}args(){return[this.base,this.power]}eval(e={},t){return Math.log(this.power.eval(e,t))/Math.log(this.base.eval(e,t))}codegen(){return"(Math.log("+this.power.codegen()+") / Math.log("+this.base.codegen()+"))"}print(){var e="("+this.power.print()+")";return this.isNatural()?"ln"+e:"log_("+this.base.print()+") "+e}tex(){var e="("+this.power.tex()+")";return this.isNatural()?"\\ln"+e:"\\log_{"+this.base.tex()+"}"+e}collect(e){var t=this.recurse("collect",e);return t.power instanceof _&&t.power.eval()===1?Ye:t.base.equals(t.power)?X:t.power instanceof V&&t.power.base.equals(t.base)?t.power.exp:t}expand(){var e=this.recurse("expand");if(e.power instanceof w){var t=l.map(e.power.terms,s=>new ae(e.base,s).expand());return new ee(t)}else return e.power instanceof V?new w(e.power.exp,new ae(e.base,e.power.base).expand()).flatten():e.isNatural()?e:w.handleDivide(new ae(Oe.e,e.power),new ae(Oe.e,e.base))}isPositive(){var e=this.collect();return e instanceof ae&&e.base instanceof _&&e.power instanceof _?this.eval()>0:!1}needsExplicitMul(){return!1}isNatural(){return this.base.equals(Oe.e)}static natural(){return Oe.e}static common(){return Bn}static create(e,t){var s=new ae(e,t);return t.hints.parens||(s=s.addHint("open")),s}}class z extends me{constructor(e,t){super();G(this,"type");G(this,"arg");G(this,"exp");G(this,"func",z);G(this,"functions",{sin:{eval:Math.sin,codegen:"Math.sin((",tex:"\\sin",expand:()=>this},cos:{eval:Math.cos,codegen:"Math.cos((",tex:"\\cos",expand:()=>this},tan:{eval:Math.tan,codegen:"Math.tan((",tex:"\\tan",expand:()=>w.handleDivide(z.sin(this.arg),z.cos(this.arg))},csc:{eval:e=>1/Math.sin(e),codegen:"(1/Math.sin(",tex:"\\csc",expand:()=>w.handleDivide(X,z.sin(this.arg))},sec:{eval:e=>1/Math.cos(e),codegen:"(1/Math.cos(",tex:"\\sec",expand:()=>w.handleDivide(X,z.cos(this.arg))},cot:{eval:e=>1/Math.tan(e),codegen:"(1/Math.tan(",tex:"\\cot",expand:()=>w.handleDivide(z.cos(this.arg),z.sin(this.arg))},arcsin:{eval:Math.asin,codegen:"Math.asin((",tex:"\\arcsin"},arccos:{eval:Math.acos,codegen:"Math.acos((",tex:"\\arccos"},arctan:{eval:Math.atan,codegen:"Math.atan((",tex:"\\arctan"},arccsc:{eval:e=>Math.asin(1/e),codegen:"Math.asin(1/(",tex:"\\operatorname{arccsc}"},arcsec:{eval:e=>Math.acos(1/e),codegen:"Math.acos(1/(",tex:"\\operatorname{arcsec}"},arccot:{eval:e=>Math.atan(1/e),codegen:"Math.atan(1/(",tex:"\\operatorname{arccot}"},sinh:{eval:e=>(Math.exp(e)-Math.exp(-e))/2,codegen:e=>"((Math.exp("+e+") - Math.exp(-("+e+"))) / 2)",tex:"\\sinh",expand:()=>this},cosh:{eval:e=>(Math.exp(e)+Math.exp(-e))/2,codegen:e=>"((Math.exp("+e+") + Math.exp(-("+e+"))) / 2)",tex:"\\cosh",expand:()=>this},tanh:{eval:e=>(Math.exp(e)-Math.exp(-e))/(Math.exp(e)+Math.exp(-e)),codegen:e=>"((Math.exp("+e+") - Math.exp(-("+e+"))) / (Math.exp("+e+") + Math.exp(-("+e+"))))",tex:"\\tanh",expand:()=>w.handleDivide(z.sinh(this.arg),z.cosh(this.arg))},csch:{eval:e=>2/(Math.exp(e)-Math.exp(-e)),codegen:e=>"(2 / (Math.exp("+e+") - Math.exp(-("+e+"))))",tex:"\\csch",expand:()=>w.handleDivide(X,z.sinh(this.arg))},sech:{eval:e=>2/(Math.exp(e)+Math.exp(-e)),codegen:e=>"(2 / (Math.exp("+e+") + Math.exp(-("+e+"))))",tex:"\\sech",expand:()=>w.handleDivide(X,z.cosh(this.arg))},coth:{eval:e=>(Math.exp(e)+Math.exp(-e))/(Math.exp(e)-Math.exp(-e)),codegen:e=>"((Math.exp("+e+") + Math.exp(-("+e+"))) / (Math.exp("+e+") - Math.exp(-("+e+"))))",tex:"\\coth",expand:()=>w.handleDivide(z.cosh(this.arg),z.sinh(this.arg))}});this.type=e,this.arg=t,this.hints={...this.hints,open:!1}}args(){return[this.type,this.arg]}isEven(){return l.contains(["cos","sec"],this.type)}isInverse(){return this.type.indexOf("arc")===0}isBasic(){return l.contains(["sin","cos"],this.type)}eval(e={},t){var s=this.functions[this.type].eval,i=this.arg.eval(e,t);return s(i)}codegen(){var e=this.functions[this.type].codegen;if(typeof e=="function")return e(this.arg.codegen());if(typeof e=="string")return e+this.arg.codegen()+"))";throw new Error("codegen not implemented for "+this.type)}print(){return this.type+"("+this.arg.print()+")"}tex(){var e=this.functions[this.type].tex,t="("+this.arg.tex()+")";return e+t}texSplit(){var e=this.functions[this.type].tex,t="("+this.arg.tex()+")";return[e,t]}isPositive(){var e=this.collect();return e instanceof z&&e.arg instanceof _?this.eval()>0:!1}completeParse(){if(this.exp){var e=new V(this,this.exp);return this.exp=void 0,e}else return this}needsExplicitMul(){return!1}expand(){var e=this.recurse("expand");if(e.isInverse())return e;var t=e.functions[e.type].expand;return l.bind(t,e)()}collect(e){var t=this.recurse("collect",e);if(!t.isInverse()&&t.arg.isNegative()){const s=t.arg instanceof _?t.arg.abs():w.handleDivide(t.arg,we).collect(e);return t.isEven()?new z(t.type,s):new w(we,new z(t.type,s))}else return t}static create(e,t){var s=e[0],i=e[1];i&&i.equals(we)&&(s="arc"+s,i=void 0);var a=new z(s,t);return t.hints.parens||(a=a.addHint("open")),i&&(a.exp=i),a}static sin(e){return new z("sin",e)}static cos(e){return new z("cos",e)}static sinh(e){return new z("sinh",e)}static cosh(e){return new z("cosh",e)}}class Ke extends me{constructor(e){super();G(this,"arg");G(this,"func",Ke);this.arg=e}args(){return[this.arg]}eval(e={},t){return Math.abs(this.arg.eval(e,t))}codegen(){return"Math.abs("+this.arg.codegen()+")"}print(){return"abs("+this.arg.print()+")"}tex(){return"\\left|"+this.arg.tex()+"\\right|"}collect(e){var t=this.recurse("collect",e);if(t.arg.isPositive())return t.arg;if(t.arg instanceof _)return t.arg.abs();if(t.arg instanceof w){var s=l.groupBy(t.arg.terms,a=>a.isPositive()?"positive":a instanceof _?"number":"other"),i=s.positive.concat(l.invoke(s.number,"abs"));return s.other.length&&i.push(new Ke(new w(s.other).flatten())),new w(i).flatten()}else return t}expand(){var e=this.recurse("expand");if(e.arg instanceof w){var t=l.map(e.arg.terms,s=>new Ke(s));return new w(t)}else return e}isPositive(){return!0}}class ze extends me{constructor(e,t,s){super();G(this,"left");G(this,"type");G(this,"right");G(this,"func",ze);G(this,"signs",{"=":" = ","<":" < ",">":" > ","<>":" \\ne ","<=":" \\le ",">=":" \\ge "});this.left=e,this.type=t,this.right=s}args(){return[this.left,this.type,this.right]}needsExplicitMul(){return!1}print(){return this.left.print()+this.type+this.right.print()}tex(){return this.left.tex()+this.signs[this.type]+this.right.tex()}normalize(){var e=this.recurse("normalize");return l.contains([">",">="],e.type)?new ze(e.right,e.type.replace(">","<"),e.left):e}asExpr(e=!1){var t=b=>b instanceof _&&b.isSimple()&&b.eval()===0;let s=[];this.left instanceof ee?s=l.clone(this.left.terms):t(this.left)||(s=[this.left]),this.right instanceof ee?s=s.concat(this.right.negate().terms):t(this.right)||s.push(this.right.negate());var i=!this.isEquality();s=l.invoke(s,"collect",{preciseFloats:!0});for(var a=0;a<s.length;a++){var c=s[a].getDenominator();i&&!c.isPositive()&&(c=c.asPositiveFactor()),c.equals(X)||(s=l.map(s,b=>w.createOrAppend(b,c).simplify({once:!0,preciseFloats:!0})))}var d=new ee(s).flatten();return e?d:this.divideThrough(d)}divideThrough(e){const t=!this.isEquality(),s=e.simplify({once:!0}),i=s.factor({keepNegative:t});if(!(i instanceof w))return e;const a=i.terms,c=f=>!!f.getVars().length,d=f=>f.equals(X),[b,u]=Ue(a,tt);if(b.length&&this.isEquality())return new w(b).flatten();let p=u;b.length||(p=l.reject(p,c)),t&&(p=l.invoke(p,"asPositiveFactor")),p=l.reject(p,d),p=l.map(p,f=>new V(f,Pe));const v=new w(a.concat(p)).collect();return v.equals(i)?s:v}isEquality(){return l.contains(["=","<>"],this.type)}compare(e){if(!(e instanceof ze))return!1;var t=this.normalize(),s=e.normalize();if(t.type!==s.type)return!1;var i=t.divideThrough(t.asExpr(!0).collect()),a=s.divideThrough(s.asExpr(!0).collect());return t.isEquality()?i.compare(a)||i.compare(w.handleNegative(a)):i.compare(a)}sameForm(e){var t=this.normalize(),s=e.normalize(),i=t.left.sameForm(s.left)&&t.right.sameForm(s.right);return t.isEquality()?i||t.left.sameForm(s.right)&&t.right.sameForm(s.left):i}isSimplified(){var e=this.asExpr(!0),t=this.divideThrough(e).simplify();return e.equals(t)&&this.left.isSimplified()&&this.right.isSimplified()}solveLinearEquationForVariable(e){var t=this.asExpr();if(!(t instanceof ee)||t.terms.length!==2)throw new Error("Can only handle linear equations of the form a + bx (= 0)");var s=d=>d.has(it)&&l.contains(d.getVars(),e.symbol);const i=s(t.terms[0]),a=i?w.handleNegative(t.terms[1]):w.handleNegative(t.terms[0]),c=i?w.handleDivide(t.terms[0],e):w.handleDivide(t.terms[1],e);return w.handleDivide(a,c).simplify()}}class Fe extends me{needsExplicitMul(){return!1}findGCD(n){return n instanceof Fe||n instanceof _?this.equals(n)?this:X:n.findGCD(this)}}class Se extends Fe{constructor(e,t){super();G(this,"symbol");G(this,"arg");G(this,"func",Se);this.symbol=e,this.arg=t}args(){return[this.symbol,this.arg]}print(){return this.symbol+"("+this.arg.print()+")"}tex(){return this.symbol+"("+this.arg.tex()+")"}eval(e={},t){var s=this.arg,i=e[this.symbol],a=l.extend(l.clone(e),{x:s.eval(e,t)}),c=Tt(i,t);return c.parsed?c.expr.eval(a,t):c}codegen(){return'vars["'+this.symbol+'"]('+this.arg.codegen()+")"}getUnits(){return this.arg.getUnits()}getVars(e){return e?this.arg.getVars():l.union(this.arg.getVars(),[this.symbol]).sort()}getConsts(){return this.arg.getConsts()}}class it extends Fe{constructor(e,t){super();G(this,"symbol");G(this,"subscript");G(this,"func",it);this.symbol=e,this.subscript=t}args(){return[this.symbol,this.subscript]}exprArgs(){return[]}recurse(){return this}print(){var e="";return this.subscript&&(e="_("+this.subscript.print()+")"),this.symbol+e}prettyPrint(){var e=this.subscript;return e&&(e instanceof _||e instanceof Fe)?this.symbol+"_"+e.print():this.print()}tex(){var e="";this.subscript&&(e="_{"+this.subscript.tex()+"}");var t=this.symbol.length>1?"\\":"";return t+this.symbol+e}repr(){return"Var("+this.print()+")"}eval(e={},t){return e[this.prettyPrint()]}codegen(){return'vars["'+this.prettyPrint()+'"]'}getVars(){return[this.prettyPrint()]}isPositive(){return!1}}const Ne=class Ne extends Fe{constructor(e){super();G(this,"symbol");G(this,"func",Ne);this.symbol=e}args(){return[this.symbol]}recurse(){return this}eval(e={},t){return this.symbol==="pi"?Math.PI:this.symbol==="e"?Math.E:void 0}codegen(){return this.symbol==="pi"?"Math.PI":this.symbol==="e"?"Math.E":void 0}print(){return this.symbol}tex(){return this.symbol==="pi"?"\\pi ":this.symbol==="e"?"e":void 0}isPositive(){return this.eval()>0}abs(){return this.eval()>0?this:w.handleNegative(this)}getConsts(){return[this.print()]}};G(Ne,"e",new Ne("e")),G(Ne,"pi",new Ne("pi"));let Oe=Ne;class _ extends me{constructor(){super();G(this,"n",0);this.hints={...this.hints,negate:!1,subtract:!1,divide:!1,root:!1,fraction:!1,entered:!1}}repr(){return this.print()}strip(){return this.abs()}recurse(){return this}codegen(){return this.print()}isSubtract(){return!!this.hints.subtract}needsExplicitMul(){return!0}isPositive(){return this.eval()>0}isNegative(){return this.eval()<0}asPositiveFactor(){return this.isPositive()?this:this.abs()}getDecimalPlaces(){var e=(""+this.n).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0}static negativeOne(e){return e==="subtract"?Gn:e==="divide"?Pe:we}static findGCD(e,t){var s;if(e=Math.abs(e),t=Math.abs(t),e!==Math.floor(e)||t!==Math.floor(t))return 1;for(;t;)s=e%t,e=t,t=s;return e}static min(...e){return l.min(e,t=>t.eval())}static max(...e){return l.max(e,t=>t.eval())}}class W extends _{constructor(e,t){super();G(this,"n");G(this,"d");G(this,"func",W);var s=e,i=t;i<0&&(s=-s,i=-i),this.n=s,this.d=i}args(){return[this.n,this.d]}eval(){return this.n/this.d}print(){return this.n.toString()+"/"+this.d.toString()}tex(){var e="\\frac{"+Math.abs(this.n).toString()+"}{"+this.d.toString()+"}";return this.n<0?"-"+e:e}add(e,t){return e instanceof W?new W(this.n*e.d+this.d*e.n,this.d*e.d).collect():e.add(this,t)}mul(e,t){return e instanceof W?new W(this.n*e.n,this.d*e.d).collect():e.mul(this,t)}collect(){var e=_.findGCD(this.n,this.d),t=this.n/e,s=this.d/e;return s===1?new N(t):new W(t,s)}negate(){return new W(-this.n,this.d)}abs(){return new W(Math.abs(this.n),this.d)}findGCD(e){if(e instanceof W){var t=_.findGCD(this.n*e.d,e.n*this.d),s=this.d*e.d;return new W(t,s).collect()}else return e instanceof N?new W(_.findGCD(this.n,e.n),this.d):e.findGCD(this)}raiseToThe(e){if(e instanceof N){var t=e.eval()>0,s=e.abs().eval(),i=Math.pow(this.n,s),a=Math.pow(this.d,s);return t?new W(i,a).collect():new W(a,i).collect()}else return new ie(this.eval()).raiseToThe(e)}getDenominator(){return new N(this.d)}isSimple(){return!1}asRational(){return this}}class N extends W{constructor(e){super(e,1);G(this,"func",N)}args(){return[this.n]}print(){return this.n.toString()}tex(){return this.n.toString()}negate(){return new N(-this.n)}abs(){return new N(Math.abs(this.n))}isSimple(){return!0}findGCD(e){return e instanceof N?new N(_.findGCD(this.n,e.n)):e.findGCD(this)}static create(e){return new N(e).addHint("entered")}}class ie extends _{constructor(e){super();G(this,"n");G(this,"func",ie);this.n=e}args(){return[this.n]}eval(){return this.n}print(){return this.n.toString()}tex(){return this.n.toString()}add(e,t){return t&&t.preciseFloats?ie.toDecimalPlaces(this.n+e.eval(),Math.max(this.getDecimalPlaces(),e.getDecimalPlaces())):new ie(this.n+e.eval()).collect()}mul(e,t){return t&&t.preciseFloats?ie.toDecimalPlaces(this.n*e.eval(),this.getDecimalPlaces()+e.getDecimalPlaces()):new ie(this.n*e.eval()).collect()}collect(e){return this}negate(){return new ie(-this.n)}abs(){return new ie(Math.abs(this.n))}findGCD(e){return e instanceof _?new ie(_.findGCD(this.eval(),e.eval())).collect():e.findGCD(this)}raiseToThe(e,t){return t&&t.preciseFloats&&e instanceof N&&e.n>1?ie.toDecimalPlaces(new V(this,e).eval(),this.getDecimalPlaces()*e.n):new ie(new V(this,e).eval()).collect()}asRational(){var e=this.n.toString().split(".");if(e.length===1)return new W(this.n,1);var t=Number(e.join("")),s=Math.pow(10,e[1].length);return new W(t,s).collect()}getDenominator(){return this.asRational().getDenominator()}isSimple(){return!0}static create(e){return new ie(e).addHint("entered")}static toDecimalPlaces(e,t){return new ie(+e.toFixed(Math.min(t,20))).collect()}}const we=new N(-1).addHint("negate"),Gn=new N(-1).addHint("subtract"),Pe=new N(-1).addHint("divide"),_n=new W(1,2).addHint("root"),Ye=new N(0),X=new N(1),Bn=new N(10);var Vn=function(r,n){throw new Error(n.loc.first_column)};We.yy={Add:ee,Mul:w,Pow:V,Log:ae,Trig:z,Eq:ze,Abs:Ke,Func:Se,Const:Oe,Var:it,Int:N,Float:ie,parseError:Vn,constants:["e"],symbolLexer:function(r){return l.contains(We.yy.constants,r)?"CONST":l.contains(We.yy.functions,r)?"FUNC":"VAR"}};const Tt=function(r,n){try{n&&n.functions?We.yy.functions=l.without(n.functions,"i"):We.yy.functions=[],n&&n.decimal_separator&&(r=r.split(n.decimal_separator).join("."));var e=We.parse(r).completeParse();return{parsed:!0,expr:e}}catch(t){return{parsed:!1,error:t.message}}};class ce extends Fe{constructor(e){super();G(this,"symbol");G(this,"func",ce);this.symbol=e}args(){return[this.symbol]}recurse(){return this}eval(e={},t){return 1}getUnits(){return[{unit:this.symbol,pow:1}]}codegen(){return"1"}print(){return this.symbol}tex(){return this.symbol}collect(e){if(l(Wn).has(this.symbol))return this;if(l(Dt).has(this.symbol))return Dt[this.symbol].conversion;throw new Error("could not understand unit: "+this.symbol)}}var Wn={m:new ce("m"),g:new ce("g"),s:new ce("s"),A:new ce("A"),K:new ce("K"),mol:new ce("mol"),cd:new ce("cd")};new V(new N(10),new N(-18)),new V(new N(10),new N(-15)),new V(new N(10),new N(-12)),new V(new N(10),new N(-9)),new V(new N(10),new N(-6)),new V(new N(10),new N(-3)),new V(new N(10),new N(-2)),new V(new N(10),new N(-1)),new N(10),new V(new N(10),new N(2)),new V(new N(10),new N(3)),new V(new N(10),new N(6)),new V(new N(10),new N(9)),new V(new N(10),new N(12)),new V(new N(10),new N(15)),new V(new N(10),new N(18)),new V(new N(10),new N(27));const Y="hasPrefixes",I="hasntPrefixes",x=function(r,n){var e=r.split("|"),t=e[0].trim(),s=e[1].trim(),i=X;t!==""&&(i=Tt(t).expr);var a=s.split("/"),c=[i];return a[0]&&a[0].split(" ").filter(d=>d!=="").forEach(d=>c.push(new ce(d))),a[1]&&a[1].split(" ").filter(d=>d!=="").forEach(d=>c.push(new V(new ce(d),Pe))),{conversion:new w(c),prefixes:n}};var Dt={Da:x("1.6605388628 x 10^-24 | g",Y),u:x("| Da",I),meter:x("| m",I),meters:x("| m",I),in:x("254 / 10000 | m",I),ft:x("3048  / 10000 | m",I),yd:x("9144  / 10000 | m",I),mi:x("1609344 / 1000 | m",I),ly:x("9.4607 x 10^15 | m",I),nmi:x("1852 | m",I),Å:x("10^-10 | m",I),pc:x("3.0857 x 10^16 | m",I),min:x("60 | s",I),hr:x("3600 | s",I),sec:x("| s",I),day:x("86400 | s",I),wk:x("604800 | s",I),fortnight:x("14 | day",I),shake:x("10^-8 | s",I),olympiad:x("126200000 | s",I),"°C":x("1 | K",I),"°F":x("5/9 | K",I),"°R":x("5/9 | K",I),e:x("1.6021765314 x 10^-19 | C",I),c:x("299792458 | m / s",I),kn:x("514/1000 | m / s",I),kt:x("| kn",I),knot:x("| kn",I),J:x("| N m",Y),BTU:x("1060 | J",I),cal:x("4184 / 1000 | J",Y),eV:x("1.602176514 x 10^-19 | J",Y),erg:x("10^−7 | J",Y),W:x("| J / s",Y),"H-e":x("80 | W",I),N:x("1000 | g m / s s",Y),lb:x("4448221615 / 1000000000 | N",I),dyn:x("10^-5 | N",I),Pa:x("1 | N / m m m",Y),bar:x("10^5 | Pa",Y),"㏔":x("1/1000 | bar",I),"㍴":x("| bar",I),atm:x("101325 | Pa",I),Torr:x("1/760 | atm",I),mmHg:x("| Torr",I),ha:x("10^4 | m m",I),b:x("10^−28 | m m",Y),barn:x("| b",Y),acre:x("4046.87 | m m",I),skilodge:x("10^-31 | m m",I),outhouse:x("10^-34 | m m",I),shed:x("10^-52 | m m",I),L:x("1/1000 | m m m",Y),gal:x("3785/1000 | L",Y),cup:x("1/16 | gal",I),qt:x("1/4 | gal",I),quart:x("| qt",I),p:x("1/8 | gal",I),pt:x("| p",I),pint:x("| p",I),"fl oz":x("1/8 | cup",I),"fl. oz.":x("1/8 | cup",I),tbsp:x("1/16 | cup",I),tsp:x("1/3 | tbsp",I),rev:x("2 pi | rad",I),deg:x("180 pi | rad",I),"°":x("| deg",I),arcminute:x("1/60 | deg",I),arcsec:x("1/3600 | deg",I),Hu:x("1000 | dB",Y),dozen:x("12 |",I),mol:x("6.0221412927 x 10^23 |",Y),"%":x("1/100 |",I),percent:x("| %",I),ppm:x("1/1000000 |",I),V:x("1000 | g m m / s s C",Y),C:x("| A s",Y),ampere:x("| A",I),Ω:x("| V / A",Y),ohm:x("| Ω",I),F:x("| C / V",Y),H:x("| ohm s",Y),T:x("1000 | g / C s",Y),Wb:x("1000 | g m m / C s",Y),lm:x("pi x 10^4 | cd / m m",I),lx:x("| lm / m m",I),nit:x("| cd / m m",I),sb:x("10^4 | cd / m m",I),stilb:x("1 | sb",I),apostilb:x("1 / pi x 10^(-4) | sb",I),blondel:x("| apostilb",I),asb:x("| apostilb",I),la:x("| lm",I),Lb:x("| lm",I),sk:x("10^-7 | lm",I),skot:x("| sk",I),bril:x("10^-11 | lm",I),Hz:x("| / s",Y)};function Un(r){if(r.extraKeys)return r.extraKeys;const n=["PI"];if(r.answerForms==null)return n;const e={},t={};for(const c of r.answerForms){const d=Tt(c.value,r);if(d.parsed){const b=d.expr,u=f=>f==="pi"||f==="theta",p=f=>u(f)?f.toUpperCase():f,v=f=>jt.includes(f);for(const f of b.getVars()){const g=p(f);v(g)&&(e[g]=!0)}for(const f of b.getConsts()){const g=p(f);v(g)&&(t[g]=!0)}}}const s=Object.keys(e).sort(),i=Object.keys(t).sort(),a=[...s,...i];return a.length?a:n}function ye(r){return(n,e)=>e.success(r(n))}const zn=$("basic","basic+div","trig","prealgebra","logarithms","basic relations","advanced relations","scientific"),St=O(M(zn),()=>["basic","trig","prealgebra","logarithms"]);function Ht(r,n){return new Pt(r,n,e=>e,(e,t)=>t.failure("widget options with a known version number",e))}class Pt{constructor(n,e,t,s){G(this,"parser");this.migrateToLatest=t,this.parseOtherVersions=s;const i=de(e).then(ye(this.migrateToLatest)).parser;this.parser=(a,c)=>{if(!je(a))return c.failure("object",a);const d=jn(a,c);return pe(d)?d:d.value.version.major!==n?this.parseOtherVersions(a,c):i(a,c)}}withMigrationFrom(n,e,t){const s=this.parser,i=a=>this.migrateToLatest(t(a));return new Pt(n,e,i,s)}}const jn=m({version:O(m({major:k,minor:k}),()=>({major:0,minor:0}))}),$n=ue(h).or(k).or(T(null)).or(T(void 0)).parser;function Hn(r){return typeof r=="number"||r===null?String(r):r}const Kt=m({value:o(h),form:O(S,()=>!1),simplify:O(S,()=>!1),considered:$("correct","wrong","ungraded"),key:de($n).then(ye(Hn)).parser});function Yt(r){return r.flatMap(n=>{const{value:e}=n;return e!=null?[{...n,value:e}]:[]})}const Kn=m({major:T(2),minor:k}),Yn=$e(Kn,T("expression"),m({answerForms:de(M(Kt)).then(ye(Yt)).parser,functions:M(h),times:S,visibleLabel:o(h),ariaLabel:o(h),buttonSets:St,buttonsVisible:o($("always","never","focused")),extraKeys:o(M($(...jt)))})),Xn=m({major:T(1),minor:k}),Jn=$e(Xn,T("expression"),m({answerForms:de(M(Kt)).then(ye(Yt)).parser,functions:M(h),times:S,visibleLabel:o(h),ariaLabel:o(h),buttonSets:St,buttonsVisible:o($("always","never","focused"))}));function Qn(r){const{options:n}=r;return{...r,version:{major:2,minor:0},options:{times:n.times,buttonSets:n.buttonSets,functions:n.functions,buttonsVisible:n.buttonsVisible,visibleLabel:n.visibleLabel,ariaLabel:n.ariaLabel,answerForms:n.answerForms,extraKeys:Un(n)??[]}}}const Zn=o(m({major:T(0),minor:k})),er=$e(Zn,T("expression"),m({functions:M(h),times:S,visibleLabel:o(h),ariaLabel:o(h),form:S,simplify:S,value:h,buttonSets:St,buttonsVisible:o($("always","never","focused"))}));function tr(r){const{options:n}=r;return{...r,version:{major:1,minor:0},options:{times:n.times,buttonSets:n.buttonSets,functions:n.functions,buttonsVisible:n.buttonsVisible,visibleLabel:n.visibleLabel,ariaLabel:n.ariaLabel,answerForms:[{considered:"correct",form:n.form,simplify:n.simplify,value:n.value}]}}}const nr=Ht(2,Yn).withMigrationFrom(1,Jn,Qn).withMigrationFrom(0,er,tr).parser,rr=j(T("free-response"),m({allowUnlimitedCharacters:S,characterLimit:k,placeholder:h,question:h,scoringCriteria:M(m({text:h}))})),sr=de(T(!1)).then(ye(()=>null)).parser,Xt=m({title:O(h,()=>""),hasHint:o(U(S)),hint:ue(sr).or(T(null)).or(T(void 0)).or((r,n)=>Xe(r,n)).parser,content:h,widgets:(r,n)=>lt(r,n),widgetEnabled:o(U(S)),immutableWidgets:o(U(S)),images:zt(h,m({width:k,height:k}))}),ir=j(T("graded-group"),Xt),ar=j(T("graded-group-set"),m({gradedGroups:M(Xt)}));function at(r){const n=(e,t)=>je(e)?t.forSubtree(r).failure("a valid value",e[r]):t.failure("object",e);return new Et(r,n)}class Et{constructor(n,e){this.discriminantKey=n,this.parser=e}withBranch(n,e){const t=or(this.discriminantKey,n,e,this.parser);return new Et(this.discriminantKey,t)}}function or(r,n,e,t){return(s,i)=>je(s)?s[r]===n?e(s,i):t(s,i):i.failure("object",s)}const Te=J(k,k),xe=J(Te,Te),cr=j(T("grapher"),m({availableTypes:M($("absolute_value","exponential","linear","logarithm","quadratic","sinusoid","tangent")),correct:at("type").withBranch("absolute_value",m({type:T("absolute_value"),coords:U(xe)})).withBranch("exponential",m({type:T("exponential"),asymptote:xe,coords:U(xe)})).withBranch("linear",m({type:T("linear"),coords:U(xe)})).withBranch("logarithm",m({type:T("logarithm"),asymptote:xe,coords:U(xe)})).withBranch("quadratic",m({type:T("quadratic"),coords:U(xe)})).withBranch("sinusoid",m({type:T("sinusoid"),coords:U(xe)})).withBranch("tangent",m({type:T("tangent"),coords:U(xe)})).parser,graph:m({backgroundImage:m({bottom:o(k),height:o(k),left:o(k),scale:o(k),url:o(U(h)),width:o(k)}),box:o(Te),editableSettings:o(M($("graph","snap","image","measure"))),gridStep:o(Te),labels:J(h,h),markings:$("graph","none","grid","axes"),range:J(Te,Te),rulerLabel:T(""),rulerTicks:k,showProtractor:o(S),showRuler:o(S),showTooltips:o(S),snapStep:o(Te),step:Te,valid:o(ue(S).or(h).parser)})})),lr=j(T("group"),(r,n)=>Xe(r,n)),ur=j(T("iframe"),m({url:h,settings:o(M(m({name:h,value:h}))),width:ue(k).or(h).parser,height:ue(k).or(h).parser,allowFullScreen:O(S,()=>!1),allowTopNavigation:o(S),static:O(S,()=>!1)})),Jt=(r,n)=>{if(typeof r=="number")return n.success(r);const e=+r;return r===""||isNaN(e)?n.failure("a number or numeric string",r):n.success(e)};function hr(r){return r===""?0:r}const fr=de(ue(k).or(h).parser).then(ye(hr)).then(Jt).parser,_e=O(o(fr),()=>{}),ot=m({url:o(U(h)),width:_e,height:_e,top:_e,left:_e,bottom:_e,scale:_e}),mt=J(k,k),pr=j(T("image"),m({title:o(h),caption:o(h),alt:o(h),backgroundImage:ot,static:o(S),labels:o(M(m({content:h,alignment:h,coordinates:M(k)}))),range:o(J(mt,mt)),box:o(mt)})),dr=(r,n)=>typeof r=="boolean"?n.success(String(r)):n.failure("boolean",r),gr=j(T("input-number"),m({answerType:o($("number","decimal","integer","rational","improper","mixed","percent","pi")),inexact:o(S),maxError:o(ue(k).or(h).parser),rightAlign:o(S),simplify:$("required","optional","enforced"),size:$("normal","small"),value:ue(k).or(h).or(dr).parser,customKeypad:o(S)})),Be=J(k,k),Ze=O(h,()=>""),Ee=de(o(h)).then(ye(String)).parser,mr=m({type:T("function"),key:Ee,options:m({value:h,funcName:h,rangeMin:h,rangeMax:h,color:h,strokeDasharray:h,strokeWidth:k})}),yr=m({type:T("label"),key:Ee,options:m({label:h,color:h,coordX:h,coordY:h})}),vr=m({type:T("line"),key:Ee,options:m({color:h,startX:h,startY:h,endX:h,endY:h,strokeDasharray:h,strokeWidth:k,arrows:h})}),br=m({type:T("movable-line"),key:Ee,options:m({startX:h,startY:h,startSubscript:k,endX:h,endY:h,endSubscript:k,constraint:h,snap:k,constraintFn:h,constraintXMin:h,constraintXMax:h,constraintYMin:h,constraintYMax:h})}),xr=m({type:T("movable-point"),key:Ee,options:m({startX:h,startY:h,varSubscript:k,constraint:h,snap:k,constraintFn:h,constraintXMin:Ze,constraintXMax:Ze,constraintYMin:Ze,constraintYMax:Ze})}),wr=m({type:T("parametric"),key:Ee,options:m({x:h,y:h,rangeMin:h,rangeMax:h,color:h,strokeDasharray:h,strokeWidth:k})}),kr=m({type:T("point"),key:Ee,options:m({color:h,coordX:h,coordY:h})}),Tr=m({type:T("rectangle"),key:Ee,options:m({color:h,coordX:h,coordY:h,width:h,height:h})}),Sr=j(T("interaction"),m({static:O(S,()=>!1),graph:m({editableSettings:o(M($("canvas","graph"))),box:Be,labels:M(h),range:J(Be,Be),gridStep:Be,markings:$("graph","grid","none","axes"),snapStep:o(Be),valid:o(ue(S).or(h).parser),backgroundImage:o(ot),showProtractor:o(S),showRuler:o(S),rulerLabel:o(h),rulerTicks:o(k),tickStep:Be}),elements:M(at("type").withBranch("function",mr).withBranch("label",yr).withBranch("line",vr).withBranch("movable-line",br).withBranch("movable-point",xr).withBranch("parametric",wr).withBranch("point",kr).withBranch("rectangle",Tr).parser)})),_s=["calculator","chi2Table","financialCalculatorMonthlyPayment","financialCalculatorTotalAmount","financialCalculatorTimeToPayOff","periodicTable","periodicTableWithKey","tTable","zTable"],Bs=["correct","wrong","ungraded"],Pr=["blue","green","grayH","purple","pink","orange","red"],Vs={blue:"#3D7586",green:"#447A53",grayH:"#3B3D45",purple:"#594094",pink:"#B25071",red:"#D92916",orange:"#946700"},Ws={none:0,white:1,translucent:.4,solid:1},Er=["bar","line","pic","histogram","dotplot"],D=J(k,k),Ar=m({type:T("angle"),showAngles:o(S),allowReflexAngles:o(S),angleOffsetDeg:o(k),snapDegrees:o(k),match:o(T("congruent")),coords:o(rt(D,D,D)),startCoords:o(rt(D,D,D))}),Ir=m({type:T("circle"),center:o(D),radius:o(k),startCoords:o(m({center:D,radius:k}))}),Mr=m({type:T("linear"),coords:o(U(J(D,D))),startCoords:o(J(D,D))}),Nr=m({type:T("linear-system"),coords:o(U(M(J(D,D)))),startCoords:o(M(J(D,D)))}),Or=m({type:T("none")}),Cr=m({type:T("point"),numPoints:o(ue(k).or(T("unlimited")).parser),coords:o(U(M(D))),startCoords:o(M(D)),coord:o(D)}),Fr=m({type:T("polygon"),numSides:o(ue(k).or(T("unlimited")).parser),showAngles:o(S),showSides:o(S),snapTo:o($("grid","angles","sides")),match:o($("similar","congruent","approx","exact")),startCoords:o(M(D)),coords:o(U(M(D)))}),Lr=m({type:T("quadratic"),coords:o(U(rt(D,D,D))),startCoords:o(rt(D,D,D))}),Dr=m({type:T("ray"),coords:o(U(J(D,D))),startCoords:o(J(D,D))}),Rr=m({type:T("segment"),numSegments:o(k),coords:o(U(M(J(D,D)))),startCoords:o(M(J(D,D)))}),qr=m({type:T("sinusoid"),coords:o(U(M(D))),startCoords:o(M(D))}),Rt=at("type").withBranch("angle",Ar).withBranch("circle",Ir).withBranch("linear",Mr).withBranch("linear-system",Nr).withBranch("none",Or).withBranch("point",Cr).withBranch("polygon",Fr).withBranch("quadratic",Lr).withBranch("ray",Dr).withBranch("segment",Rr).withBranch("sinusoid",qr).parser,De=$(...Pr),Qt=$("none","white","translucent","solid"),ct=$("solid","dashed"),Re=m({type:T("label"),coord:D,text:h,color:De,size:$("small","medium","large")}),vt=m({type:T("point"),coord:D,color:De,filled:S,labels:O(M(Re),()=>[]),ariaLabel:o(h)}),Gr=m({type:T("line"),kind:$("line","ray","segment"),points:J(vt,vt),color:De,lineStyle:ct,showPoint1:O(S,()=>!1),showPoint2:O(S,()=>!1),labels:O(M(Re),()=>[]),ariaLabel:o(h)}),_r=m({type:T("vector"),points:J(D,D),color:De,labels:O(M(Re),()=>[]),ariaLabel:o(h)}),Br=m({type:T("ellipse"),center:D,radius:D,angle:k,color:De,fillStyle:Qt,strokeStyle:ct,labels:O(M(Re),()=>[]),ariaLabel:o(h)}),Vr=m({type:T("polygon"),points:M(D),color:De,showVertices:S,fillStyle:Qt,strokeStyle:ct,labels:O(M(Re),()=>[]),ariaLabel:o(h)}),Wr=O(J(O(k,()=>-1/0),O(k,()=>1/0)),()=>[-1/0,1/0]),Ur=m({type:T("function"),color:De,strokeStyle:ct,equation:h,directionalAxis:$("x","y"),domain:Wr,labels:O(M(Re),()=>[]),ariaLabel:o(h)}),zr=at("type").withBranch("point",vt).withBranch("line",Gr).withBranch("vector",_r).withBranch("ellipse",Br).withBranch("polygon",Vr).withBranch("function",Ur).withBranch("label",Re).parser,jr=j(T("interactive-graph"),m({step:D,gridStep:o(D),snapStep:o(D),backgroundImage:o(ot),markings:$("graph","grid","none","axes"),labels:o(M(h)),labelLocation:o($("onAxis","alongEdge")),showProtractor:S,showRuler:o(S),showTooltips:o(S),rulerLabel:o(h),rulerTicks:o(k),range:J(D,D),graph:O(Rt,()=>({type:"linear"})),correct:Rt,lockedFigures:O(M(zr),()=>[]),fullGraphAriaLabel:o(h),fullGraphAriaDescription:o(h)})),$r=j(T("label-image"),m({choices:M(h),imageUrl:h,imageAlt:h,imageHeight:k,imageWidth:k,markers:M(m({answers:M(h),label:h,x:k,y:k})),hideChoicesFromInstructions:S,multipleAnswers:S,static:O(S,()=>!1)})),Hr=j(T("matcher"),m({labels:M(h),left:M(h),right:M(h),orderMatters:S,padding:S})),Kr=ue(k).or(h).parser,Yr=de(O(Kr,()=>NaN)).then(Jt).parser,Xr=j(O(T("matrix"),()=>"matrix"),m({prefix:o(h),suffix:o(h),answers:M(M(Yr)),cursorPosition:o(M(k)),matrixBoardSize:M(k),static:o(S)})),Jr=j(T("measurer"),m({image:O(ot,()=>({url:null,top:0,left:0})),showProtractor:S,showRuler:S,rulerLabel:h,rulerTicks:k,rulerPixels:k,rulerLength:k,box:J(k,k)})),Qr=j(T("molecule-renderer"),m({widgetId:h,rotationAngle:o(k),smiles:o(h)})),Zr=de(T("")).then(ye(()=>null)).parser,es=j(T("number-line"),m({range:M(k),labelRange:M(U(ue(k).or(Zr).parser)),labelStyle:h,labelTicks:S,isTickCtrl:o(U(S)),isInequality:O(S,()=>!1),divisionRange:M(k),numDivisions:o(U(k)),snapDivisions:O(k,()=>2),tickStep:o(U(k)),correctRel:O(o($("eq","lt","gt","le","ge")),()=>{}),correctX:U(k),initialX:o(U(k)),showTooltips:o(S),static:O(S,()=>!1)})),qt=$("integer","mixed","improper","proper","decimal","percent","pi"),Gt=de(ue(T(null)).or(T(void 0)).or(S).or(T("required")).or(T("correct")).or(T("enforced")).or(T("optional")).or(T("accepted")).parser).then(ye(ts)).parser;function ts(r){switch(r){case"enforced":case"required":case"optional":return r;default:return"required"}}const ns=j(T("numeric-input"),m({answers:M(m({message:h,value:o(U(k)),status:h,answerForms:O(o(M(qt)),()=>{}),strict:S,maxError:o(U(k)),simplify:Gt})),labelText:o(h),size:h,coefficient:O(S,()=>!1),rightAlign:o(S),static:O(S,()=>!1),answerForms:o(M(m({name:qt,simplify:Gt})))}));function yt(r,n){return Xe(r,n)}const rs=(r,n)=>r==="large"?n.success("auto"):n.success(r),ss=j(T("orderer"),m({options:O(M(yt),()=>[]),correctOptions:M(yt),otherOptions:M(yt),height:de($("normal","auto","large")).then(rs).parser,layout:O($("horizontal","vertical"),()=>"horizontal")})),is=j(T("passage-ref"),m({passageNumber:k,referenceNumber:k,summaryText:o(h)})),as=j(T("passage"),m({footnotes:O(h,()=>""),passageText:h,passageTitle:O(h,()=>""),showLineNumbers:S,static:O(S,()=>!1)})),os=j(T("phet-simulation"),m({url:h,description:h})),cs=j(T("plotter"),m({labels:M(h),categories:M(h),type:$(...Er),maxY:k,scaleY:O(k,()=>1),labelInterval:o(U(k)),snapsPerLine:O(k,()=>2),starting:M(k),correct:M(k),picUrl:o(U(h)),picSize:o(U(k)),picBoxHeight:o(U(k)),plotDimensions:O(M(k),()=>[380,300])})),ls=j(T("python-program"),m({programID:h,height:k})),Us={major:2,minor:0};function Zt(r){const{choices:n,numCorrect:e}=r;return e??n.filter(t=>t.correct).length}const zs={2:r=>({...r,numCorrect:Zt(r)}),1:r=>{const{noneOfTheAbove:n,...e}=r;if(n)throw new Error("radio widget v0 no longer supports auto noneOfTheAbove");return{...e,hasNoneOfTheAbove:!1}}},js={choices:[{},{},{},{}],displayCount:null,randomize:!1,hasNoneOfTheAbove:!1,multipleSelect:!1,countChoices:!1,deselectEnabled:!1},At=O(o((r,n)=>lt(r,n)),()=>{}),us=o(m({major:T(2),minor:k})),hs=$e(us,T("radio"),m({numCorrect:o(k),choices:M(m({content:O(h,()=>""),clue:o(h),correct:o(S),isNoneOfTheAbove:o(S),widgets:At})),hasNoneOfTheAbove:o(S),countChoices:o(S),randomize:o(S),multipleSelect:o(S),deselectEnabled:o(S),onePerLine:o(S),displayCount:o(Ce),noneOfTheAbove:o(T(!1))})),fs=o(m({major:T(1),minor:k})),ps=$e(fs,T("radio"),m({choices:M(m({content:O(h,()=>""),clue:o(h),correct:o(S),isNoneOfTheAbove:o(S),widgets:At})),hasNoneOfTheAbove:o(S),countChoices:o(S),randomize:o(S),multipleSelect:o(S),deselectEnabled:o(S),onePerLine:o(S),displayCount:o(Ce),noneOfTheAbove:o(T(!1))}));function ds(r){const{options:n}=r;return{...r,version:{major:2,minor:0},options:{...n,numCorrect:Zt(n)}}}const gs=o(m({major:T(0),minor:k})),ms=$e(gs,T("radio"),m({choices:M(m({content:O(h,()=>""),clue:o(h),correct:o(S),isNoneOfTheAbove:o(S),widgets:At})),hasNoneOfTheAbove:o(S),countChoices:o(S),randomize:o(S),multipleSelect:o(S),deselectEnabled:o(S),onePerLine:o(S),displayCount:o(Ce),noneOfTheAbove:o(T(!1))}));function ys(r){const{options:n}=r,{noneOfTheAbove:e,...t}=n;return{...r,version:{major:1,minor:0},options:{...t,hasNoneOfTheAbove:!1,noneOfTheAbove:void 0}}}const vs=Ht(2,hs).withMigrationFrom(1,ps,ds).withMigrationFrom(0,ms,ys).parser,bs=j(T("sorter"),m({correct:M(h),padding:S,layout:$("horizontal","vertical")})),xs=j(T("table"),m({headers:M(h),rows:k,columns:k,answers:M(M(h))})),ws=j(T("video"),m({location:h,static:o(S)})),lt=(r,n)=>{if(!je(r))return n.failure("PerseusWidgetsMap",r);const e={};for(const t of Object.keys(r)){const s=ks([t,r[t]],e,n.forSubtree(t));if(pe(s))return s}return n.success(e)},ks=([r,n],e,t)=>{const s=Ss(r.split(" "),t.forSubtree("(widget ID)"));if(pe(s))return s;const[i,a]=s.value;function c(d,b){const u=b(n,t);return pe(u)?u:(e[d]=u.value,t.success(void 0))}switch(i){case"categorizer":return c(`categorizer ${a}`,An);case"cs-program":return c(`cs-program ${a}`,In);case"definition":return c(`definition ${a}`,Mn);case"dropdown":return c(`dropdown ${a}`,Nn);case"explanation":return c(`explanation ${a}`,On);case"expression":return c(`expression ${a}`,nr);case"free-response":return c(`free-response ${a}`,rr);case"grapher":return c(`grapher ${a}`,cr);case"group":return c(`group ${a}`,lr);case"graded-group":return c(`graded-group ${a}`,ir);case"graded-group-set":return c(`graded-group-set ${a}`,ar);case"iframe":return c(`iframe ${a}`,ur);case"image":return c(`image ${a}`,pr);case"input-number":return c(`input-number ${a}`,gr);case"interaction":return c(`interaction ${a}`,Sr);case"interactive-graph":return c(`interactive-graph ${a}`,jr);case"label-image":return c(`label-image ${a}`,$r);case"matcher":return c(`matcher ${a}`,Hr);case"matrix":return c(`matrix ${a}`,Xr);case"measurer":return c(`measurer ${a}`,Jr);case"molecule-renderer":return c(`molecule-renderer ${a}`,Qr);case"number-line":return c(`number-line ${a}`,es);case"numeric-input":return c(`numeric-input ${a}`,ns);case"orderer":return c(`orderer ${a}`,ss);case"passage":return c(`passage ${a}`,as);case"passage-ref":return c(`passage-ref ${a}`,is);case"passage-ref-target":return c(`passage-ref-target ${a}`,Ce);case"phet-simulation":return c(`phet-simulation ${a}`,os);case"plotter":return c(`plotter ${a}`,cs);case"python-program":return c(`python-program ${a}`,ls);case"radio":return c(`radio ${a}`,vs);case"sorter":return c(`sorter ${a}`,bs);case"table":return c(`table ${a}`,xs);case"video":return c(`video ${a}`,ws);case"sequence":return c(`sequence ${a}`,et);case"lights-puzzle":return c(`lights-puzzle ${a}`,et);case"simulator":return c(`simulator ${a}`,et);case"transformer":return c(`transformer ${a}`,et);default:return c(`${i} ${a}`,j(T(i),Ce))}},et=j((r,n)=>n.success("deprecated-standin"),m({})),Ts=(r,n)=>typeof r!="string"||!/^(0|[1-9][0-9]*)$/.test(r)?n.failure("a string representing a non-negative integer",r):n.success(+r),Ss=J(h,Ts),Xe=O(m({content:O(h,()=>""),widgets:O((r,n)=>lt(r,n),()=>({})),images:En,metadata:Ce}),()=>({content:"",widgets:{},images:{}}));ue(Xe).or(M(Xe)).parser;de(O(m({}),()=>({}))).then(ye(Ps)).parser;function Ps(r){return{zTable:!!r.zTable,calculator:!!r.calculator,chi2Table:!!r.chi2Table,financialCalculatorMonthlyPayment:!!r.financialCalculatorMonthlyPayment,financialCalculatorTotalAmount:!!r.financialCalculatorTotalAmount,financialCalculatorTimeToPayOff:!!r.financialCalculatorTimeToPayOff,periodicTable:!!r.periodicTable,periodicTableWithKey:!!r.periodicTableWithKey,tTable:!!r.tTable}}const Es="@khanacademy/perseus-core",As="__lib_version__";$t(Es,As);const en=function(r){let n=r;return function(){let e=n;return e=e+2127912214+(e<<12)&4294967295,e=(e^3345072700^e>>>19)&4294967295,e=e+374761393+(e<<5)&4294967295,e=(e+3550635116^e<<9)&4294967295,e=e+4251993797+(e<<3)&4294967295,e=(e^3042594569^e>>>16)&4294967295,(n=e&268435455)/268435456}};function $s(r,n,e=!1){let t;typeof n=="function"?t=n:t=en(n);function s(i){return e?!l.isEqual(r,i):!0}return Is(r,t,s)}function Is(r,n,e){const s=[...r];if(s.every(i=>l.isEqual(i,s[0])))return s;for(let i=0;i<100;i++)if(Ms(s,n),e(s))return s;throw new Error("constrainedShuffle: constraint not met after 100 attempts")}function Ms(r,n){for(let e=r.length-1;e>0;e--){const t=Ns(0,e,n);[r[t],r[e]]=[r[e],r[t]]}}function Ns(r,n,e){return Math.floor(e()*(n-r+1))+r}const Hs=en(new Date().getTime()&4294967295);function Os(r){const{answers:n,...e}=r;return e}const tn=4,nn=1,Cs=new Array(tn).fill(0).map(()=>new Array(nn).fill("")),Fs={headers:[""],rows:tn,columns:nn,answers:Cs},Ks={name:"table",defaultWidgetOptions:Fs,getPublicWidgetOptions:Os};export{_s as I,Bs as P,Er as a,Zt as b,_t as c,Un as d,$t as e,yn as f,Gs as g,Ws as h,Rs as i,Ve as j,Is as k,Vs as l,js as m,Us as n,Nt as o,Tt as p,qs as q,$s as r,en as s,Ks as t,Hs as u,zs as w};
