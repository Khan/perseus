var S=Object.defineProperty;var D=(s,a,e)=>a in s?S(s,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[a]=e;var h=(s,a,e)=>(D(s,typeof a!="symbol"?a+"":a,e),e);import{r as g,j as t,n as d,aU as R}from"./iframe-Bcg17xLF.js";import"./item-version-Cq6y6B1E.js";import"./article-renderer-CkfdpRoI.js";import"./server-item-renderer-CUMfm4hX.js";import"./hints-renderer-CrMQM1rf.js";import{c as T}from"./components-z5lU3uB1.js";import{c as A,d as y,a as k,e as w,f as N}from"./global-colors-BJx09mFA.js";import{F as M}from"./form-wrapped-text-field-hdvSW8SS.js";function q(s){s.focus({preventScroll:!0})}const{Icon:E}=T,L=s=>{const e=R.findDOMNode(s);e.focus&&q(e)},O=`M10,3.8C10,4,9.9,4.2,9.8,4.3L5.1,8.9L4.3,9.8C4.2,9.9,4,10,3.8,10
 S3.5,9.9,3.4,9.8L2.5,8.9L0.2,6.6C0.1,6.5,0,6.3,0,6.2s0.1-0.3,0.2-0.4
 l0.9-0.9c0.1-0.1,0.3-0.2,0.4-0.2s0.3,0.1,0.4,0.2l1.9,1.9l4.2-4.2c0.1
 -0.1,0.3-0.2,0.4-0.2c0.2,0,0.3,0.1,0.4,0.2l0.9,0.9C9.9,3.5,10,3.7,
 10,3.8z`,j=30;class b extends g.Component{constructor(){super(...arguments);h(this,"node")}handleKeyDown(e){const{onDropdownClose:o}=this.props,r=e.key,n=e.target;r==="ArrowDown"&&n.nextSibling&&(e.preventDefault(),n.nextSibling.focus()),r==="ArrowUp"&&n.previousSibling&&(e.preventDefault(),n.previousSibling.focus()),r==="ArrowUp"&&!n.previousSibling&&o&&(e.preventDefault(),o()),(r==="Escape"||r==="Tab")&&o&&o()}render(){const{selected:e,value:o,onClick:r,children:n,disabled:i,hideFocusState:m,testId:p,ariaLabel:l}=this.props;return t.jsx("button",{ref:u=>this.node=u,value:o,role:"menuitemradio","aria-checked":e,className:d.css(c.notAButton,i&&c.cursorDefault,m&&c.noFocus),onClick:u=>{!i&&r&&r(u)},onKeyDown:u=>this.handleKeyDown(u),"aria-disabled":i,"aria-label":l,"data-testid":p,children:t.jsxs("span",{className:d.css(c.option,e&&c.optionSelected,i&&c.optionDisabled),children:[n,e&&t.jsx("span",{className:d.css(c.check),children:t.jsx(E,{icon:O})})]})})}}class v extends g.Component{constructor(){super(...arguments);h(this,"focusedElement")}componentDidMount(){this.focusedElement&&L(this.focusedElement)}render(){const{children:e,onSelected:o,selectedValues:r,noMargin:n,onDropdownClose:i,hideFocusState:m}=this.props;return t.jsx("div",{style:{top},className:d.css(c.optionGroup,n&&c.optionGroupNoMargin),children:g.Children.map(e,(p,l)=>{const u=r.includes(p.props.value),x=u||l===0?C=>this.focusedElement=C:null;return g.cloneElement(p,{...p.props,key:l,selected:u,onClick:()=>o(p.props.value),ref:x,onDropdownClose:i,hideFocusState:m})})})}}const c=d.StyleSheet.create({optionGroup:{margin:"4px 0"},optionGroupNoMargin:{margin:0},option:{display:"flex",flexDirection:"row",alignItems:"center",paddingLeft:32,paddingRight:32,height:j,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:k,userSelect:"none",":hover":{backgroundColor:y}},optionSelected:{backgroundColor:y,color:"#11ACCD"},optionDisabled:{color:A,":hover":{backgroundColor:"transparent"}},check:{position:"absolute",left:11},notAButton:{backgroundColor:"transparent",border:"none",display:"block",padding:0,margin:0,width:"100%",font:"inherit"},noFocus:{outline:"none"},cursorDefault:{cursor:"default"}});v.__docgenInfo={description:"",methods:[],displayName:"OptionGroup",props:{onSelected:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},children:{required:!1,tsType:{name:"Array",elements:[{name:"ReactReactElement",raw:"React.ReactElement<React.ComponentProps<typeof Option>>",elements:[{name:"ReactComponentProps",raw:"React.ComponentProps<typeof Option>",elements:[{name:"Option"}]}]}],raw:"Array<React.ReactElement<React.ComponentProps<typeof Option>>>"},description:""},selectedValues:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"Array<string>"},description:""},noMargin:{required:!1,tsType:{name:"boolean"},description:""},onDropdownClose:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},hideFocusState:{required:!1,tsType:{name:"boolean"},description:""}}};b.__docgenInfo={description:"",methods:[{name:"handleKeyDown",docblock:null,modifiers:[],params:[{name:"event",optional:!1,type:{name:"any"}}],returns:{type:{name:"void"}}}],displayName:"Option",props:{value:{required:!0,tsType:{name:"string"},description:""},children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},selected:{required:!1,tsType:{name:"boolean"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onDropdownClose:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},hideFocusState:{required:!1,tsType:{name:"boolean"},description:""},testId:{required:!1,tsType:{name:"string"},description:""},ariaLabel:{required:!1,tsType:{name:"string"},description:""}}};class I extends g.Component{constructor(e){super(e);h(this,"_marker");h(this,"handleClick",e=>{const{showDropdown:o}=this.state;this._marker===e.target?this.setState({showDropdown:!o}):o&&this._marker&&!this._marker.contains(e.target)&&(e.stopPropagation(),this.setState({showDropdown:!1}))});h(this,"handleLabelChange",e=>{this.updateMarker({label:e.target.value})});h(this,"handleSelectAnswer",e=>{let{answers:o}=this.props;o.includes(e)?o=o.filter(r=>r!==e):o=[...o,e],this.updateMarker({answers:o})});this.state={showDropdown:!1}}componentDidMount(){document.addEventListener("click",this.handleClick,!0)}UNSAFE_componentWillReceiveProps(e){const{answers:o}=this.props,r=o.filter(n=>e.choices.includes(n));JSON.stringify(o)!==JSON.stringify(r)&&setTimeout(()=>this.updateMarker({answers:r}))}componentWillUnmount(){document.removeEventListener("click",this.handleClick,!0)}openDropdown(){this.setState({showDropdown:!0})}updateMarker(e){const{answers:o,label:r,onChange:n,x:i,y:m}=this.props;n({answers:o,label:r,x:i,y:m,...e})}render(){const{answers:e,choices:o,label:r,onRemove:n,x:i,y:m}=this.props,{showDropdown:p}=this.state;return t.jsx("div",{className:d.css(f.marker,e.length>0&&f.markerWithAnswers,p&&f.markerSelected),ref:l=>this._marker=l,style:{left:`${i}%`,top:`${m}%`},title:"Click to select marker answers or to delete marker. Repositioning marker is not implemented.",children:p&&t.jsx("div",{children:t.jsxs("div",{className:d.css(f.dropdownBody,f.dropdownPositionWithArrow),children:[t.jsx(b,{value:"",onClick:()=>n(),children:"Delete marker"}),t.jsx("hr",{className:d.css(f.dividerHorizontal)}),t.jsx(v,{onSelected:this.handleSelectAnswer,selectedValues:e,children:o.map(l=>t.jsx(b,{value:l,children:l},l))}),t.jsx("div",{className:d.css(f.labelContainer),children:t.jsx(M,{placeholder:"ARIA label (for screen readers)",onChange:this.handleLabelChange,value:r,width:"100%"})})]})})})}}const f=d.StyleSheet.create({marker:{position:"absolute",boxSizing:"content-box",width:16,height:16,marginLeft:-8,marginTop:-8,cursor:"pointer",background:"linear-gradient(to bottom, rgba(33, 36, 44, 0.2), rgba(33, 36, 44, 0.5))",border:"solid 2px #ffffff",borderRadius:16,boxShadow:"0 2px 10px 0 rgba(33, 36, 44, 0.1)"},markerSelected:{width:28,height:28,marginLeft:-12,marginTop:-12,border:"none",borderRadius:28,"::before":{content:"''",display:"block",width:20,height:20,marginLeft:2,marginTop:2,border:"solid 2px #ffffff",borderRadius:20}},markerWithAnswers:{background:"#1865f2"},dropdownPositionWithArrow:{left:46,bottom:-12,"::before":{content:"''",display:"block",position:"absolute",width:0,height:0,left:-16,bottom:8,borderRight:`solid 16px ${w}`,borderTop:"solid 16px transparent",borderBottom:"solid 16px transparent"}},labelContainer:{padding:4},dividerHorizontal:{height:0,margin:0,border:`solid ${N}`,borderWidth:"0 0 1px",boxShadow:"none"},dropdownBody:{position:"absolute",border:"solid 1px rgba(0, 0, 0, 0.1)",zIndex:1e3,color:k,backgroundColor:w,borderRadius:4,maxHeight:320,cursor:"pointer"}});I.__docgenInfo={description:"",methods:[{name:"openDropdown",docblock:null,modifiers:[],params:[],returns:null},{name:"updateMarker",docblock:null,modifiers:[],params:[{name:"props",optional:!1,type:{name:"any"}}],returns:null},{name:"handleClick",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:{name:"MouseEvent",alias:"MouseEvent"}}],returns:null},{name:"handleLabelChange",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:null}],returns:null},{name:"handleSelectAnswer",docblock:null,modifiers:[],params:[{name:"toggleAnswer",optional:!1,type:{name:"string"}}],returns:null}],displayName:"Marker",props:{choices:{required:!0,tsType:{name:"Array",raw:'PerseusLabelImageWidgetOptions["choices"]'},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:`(
    marker: PerseusLabelImageWidgetOptions["markers"][number],
) => void`,signature:{arguments:[{type:{name:"Array[number]",raw:'PerseusLabelImageWidgetOptions["markers"][number]'},name:"marker"}],return:{name:"void"}}},description:""},onRemove:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{I as M};
