import{n as i}from"./no-important-xCWWYXQR.js";import{r as o}from"./index-6oxdNXpR.js";import"./all-widgets-Y4SYDpG-.js";import"./phet-simulation-FTLyxKwk.js";import"./underscore-885MUNGo.js";import"./random-util-wZstT-Qs.js";import"./dependencies-CP7Uh8Kq.js";import"./perseus-api-Y55S7ZPk.js";import"./server-item-renderer-A_MnaDQM.js";import"./article-renderer-pyQ_HofA.js";import"./hints-renderer-5aG6E1Uq.js";import"./renderer-ZibUmNWI.js";import"./base-radio-UE6giogv.js";import{c as v}from"./components-K5MWvf6b.js";import"./i18n-context-g2lQsEMW.js";import"./util-pBxNglIl.js";import"./svg-image-Prev2-2p.js";import"./jquery-5v7aFUvu.js";import"./index-smZ6iCr_.js";import{F as C}from"./index-9gkyvru-.js";import{a as b,c as f,d as S,e as g,f as D}from"./global-colors-VIVU4Od4.js";import{F as E}from"./form-wrapped-text-field-tT65vLnq.js";function x(u){u.focus({preventScroll:!0})}const{Icon:R}=v,T=u=>{const e=C.findDOMNode(u);e.focus&&x(e)},A=`M10,3.8C10,4,9.9,4.2,9.8,4.3L5.1,8.9L4.3,9.8C4.2,9.9,4,10,3.8,10
 S3.5,9.9,3.4,9.8L2.5,8.9L0.2,6.6C0.1,6.5,0,6.3,0,6.2s0.1-0.3,0.2-0.4
 l0.9-0.9c0.1-0.1,0.3-0.2,0.4-0.2s0.3,0.1,0.4,0.2l1.9,1.9l4.2-4.2c0.1
 -0.1,0.3-0.2,0.4-0.2c0.2,0,0.3,0.1,0.4,0.2l0.9,0.9C9.9,3.5,10,3.7,
 10,3.8z`,N=30;class h extends o.Component{handleKeyDown(r){const{onDropdownClose:e}=this.props,t=r.key,n=r.target;t==="ArrowDown"&&n.nextSibling&&(r.preventDefault(),n.nextSibling.focus()),t==="ArrowUp"&&n.previousSibling&&(r.preventDefault(),n.previousSibling.focus()),t==="ArrowUp"&&!n.previousSibling&&e&&(r.preventDefault(),e()),(t==="Escape"||t==="Tab")&&e&&e()}render(){const{selected:r,value:e,onClick:t,children:n,disabled:a,hideFocusState:c,testId:l,ariaLabel:s}=this.props;return o.createElement("button",{ref:p=>this.node=p,value:e,role:"menuitemradio","aria-checked":r,className:i.css(d.notAButton,a&&d.cursorDefault,c&&d.noFocus),onClick:p=>{!a&&t&&t(p)},onKeyDown:p=>this.handleKeyDown(p),"aria-disabled":a,"aria-label":s,"data-testid":l},o.createElement("span",{className:i.css(d.option,r&&d.optionSelected,a&&d.optionDisabled)},n,r&&o.createElement("span",{className:i.css(d.check)},o.createElement(R,{icon:A}))))}}class y extends o.Component{componentDidMount(){this.focusedElement&&T(this.focusedElement)}render(){const{children:r,onSelected:e,selectedValues:t,noMargin:n,onDropdownClose:a,hideFocusState:c}=this.props;return o.createElement("div",{style:{top},className:i.css(d.optionGroup,n&&d.optionGroupNoMargin)},o.Children.map(r,(l,s)=>{const p=t.includes(l.props.value),w=p||s===0?k=>this.focusedElement=k:null;return o.cloneElement(l,{...l.props,key:s,selected:p,onClick:()=>e(l.props.value),ref:w,onDropdownClose:a,hideFocusState:c})}))}}const d=i.StyleSheet.create({optionGroup:{margin:"4px 0"},optionGroupNoMargin:{margin:0},option:{display:"flex",flexDirection:"row",alignItems:"center",paddingLeft:32,paddingRight:32,height:N,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:b,userSelect:"none",":hover":{backgroundColor:f}},optionSelected:{backgroundColor:f,color:"#11ACCD"},optionDisabled:{color:S,":hover":{backgroundColor:"transparent"}},check:{position:"absolute",left:11},notAButton:{backgroundColor:"transparent",border:"none",display:"block",padding:0,margin:0,width:"100%",font:"inherit"},noFocus:{outline:"none"},cursorDefault:{cursor:"default"}});y.__docgenInfo={description:"",methods:[],displayName:"OptionGroup",props:{onSelected:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},children:{required:!1,tsType:{name:"Array",elements:[{name:"ReactReactElement",raw:"React.ReactElement<React.ComponentProps<typeof Option>>",elements:[{name:"ReactComponentProps",raw:"React.ComponentProps<typeof Option>",elements:[{name:"Option"}]}]}],raw:"Array<React.ReactElement<React.ComponentProps<typeof Option>>>"},description:""},selectedValues:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"Array<string>"},description:""},noMargin:{required:!1,tsType:{name:"boolean"},description:""},onDropdownClose:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},hideFocusState:{required:!1,tsType:{name:"boolean"},description:""}}};h.__docgenInfo={description:"",methods:[{name:"handleKeyDown",docblock:null,modifiers:[],params:[{name:"event",optional:!1,type:{name:"any"}}],returns:{type:{name:"void"}}}],displayName:"Option",props:{value:{required:!0,tsType:{name:"string"},description:""},children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},selected:{required:!1,tsType:{name:"boolean"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onDropdownClose:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},hideFocusState:{required:!1,tsType:{name:"boolean"},description:""},testId:{required:!1,tsType:{name:"string"},description:""},ariaLabel:{required:!1,tsType:{name:"string"},description:""}}};class M extends o.Component{constructor(r){super(r),this.handleClick=e=>{const{showDropdown:t}=this.state;this._marker===e.target?this.setState({showDropdown:!t}):t&&this._marker&&!this._marker.contains(e.target)&&(e.stopPropagation(),this.setState({showDropdown:!1}))},this.handleLabelChange=e=>{this.updateMarker({label:e.target.value})},this.handleSelectAnswer=e=>{let{answers:t}=this.props;t.includes(e)?t=t.filter(n=>n!==e):t=[...t,e],this.updateMarker({answers:t})},this.state={showDropdown:!1}}componentDidMount(){document.addEventListener("click",this.handleClick,!0)}UNSAFE_componentWillReceiveProps(r){const{answers:e}=this.props,t=e.filter(n=>r.choices.includes(n));JSON.stringify(e)!==JSON.stringify(t)&&setTimeout(()=>this.updateMarker({answers:t}))}componentWillUnmount(){document.removeEventListener("click",this.handleClick,!0)}openDropdown(){this.setState({showDropdown:!0})}updateMarker(r){const{answers:e,label:t,onChange:n,x:a,y:c}=this.props;n({answers:e,label:t,x:a,y:c,...r})}render(){const{answers:r,choices:e,label:t,onRemove:n,x:a,y:c}=this.props,{showDropdown:l}=this.state;return o.createElement("div",{className:i.css(m.marker,r.length>0&&m.markerWithAnswers,l&&m.markerSelected),ref:s=>this._marker=s,style:{left:`${a}%`,top:`${c}%`},title:"Click to select marker answers or to delete marker. Repositioning marker is not implemented."},l&&o.createElement("div",null,o.createElement("div",{className:i.css(m.dropdownBody,m.dropdownPositionWithArrow)},o.createElement(h,{value:"",onClick:()=>n()},"Delete marker"),o.createElement("hr",{className:i.css(m.dividerHorizontal)}),o.createElement(y,{onSelected:this.handleSelectAnswer,selectedValues:r},e.map(s=>o.createElement(h,{key:s,value:s},s))),o.createElement("div",{className:i.css(m.labelContainer)},o.createElement(E,{placeholder:"ARIA label (for screen readers)",onChange:this.handleLabelChange,value:t,width:"100%"})))))}}const m=i.StyleSheet.create({marker:{position:"absolute",boxSizing:"content-box",width:16,height:16,marginLeft:-8,marginTop:-8,cursor:"pointer",background:"linear-gradient(to bottom, rgba(33, 36, 44, 0.2), rgba(33, 36, 44, 0.5))",border:"solid 2px #ffffff",borderRadius:16,boxShadow:"0 2px 10px 0 rgba(33, 36, 44, 0.1)"},markerSelected:{width:28,height:28,marginLeft:-12,marginTop:-12,border:"none",borderRadius:28,"::before":{content:"''",display:"block",width:20,height:20,marginLeft:2,marginTop:2,border:"solid 2px #ffffff",borderRadius:20}},markerWithAnswers:{background:"#1865f2"},dropdownPositionWithArrow:{left:46,bottom:-12,"::before":{content:"''",display:"block",position:"absolute",width:0,height:0,left:-16,bottom:8,borderRight:`solid 16px ${g}`,borderTop:"solid 16px transparent",borderBottom:"solid 16px transparent"}},labelContainer:{padding:4},dividerHorizontal:{height:0,margin:0,border:`solid ${D}`,borderWidth:"0 0 1px",boxShadow:"none"},dropdownBody:{position:"absolute",border:"solid 1px rgba(0, 0, 0, 0.1)",zIndex:1e3,color:b,backgroundColor:g,borderRadius:4,maxHeight:320,cursor:"pointer"}});M.__docgenInfo={description:"",methods:[{name:"openDropdown",docblock:null,modifiers:[],params:[],returns:null},{name:"updateMarker",docblock:null,modifiers:[],params:[{name:"props",optional:!1,type:{name:"any"}}],returns:null},{name:"handleClick",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:{name:"MouseEvent",alias:"MouseEvent"}}],returns:null},{name:"handleLabelChange",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:null}],returns:null},{name:"handleSelectAnswer",docblock:null,modifiers:[],params:[{name:"toggleAnswer",optional:!1,type:{name:"string"}}],returns:null}],displayName:"Marker",props:{choices:{required:!0,tsType:{name:"ReadonlyArray",raw:'PerseusLabelImageWidgetOptions["choices"]'},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:`(
    marker: PerseusLabelImageWidgetOptions["markers"][number],
) => void`,signature:{arguments:[{type:{name:"ReadonlyArray[number]",raw:'PerseusLabelImageWidgetOptions["markers"][number]'},name:"marker"}],return:{name:"void"}}},description:""},onRemove:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{M};
