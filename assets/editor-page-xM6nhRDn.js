import{c as h,p as d,W as bt,G as wt,m as Ct,M as Tt,n as kt,o as xt,T as It,w as Nt}from"./article-renderer-zhRnwZOg.js";import{_ as i}from"./index-default-4_ZsnO94.js";import{U as G,r as qt}from"./util-TKXSNoh3.js";import{S as St,P as dt,r as Ot,b as Pt,a as At,c as Rt}from"./renderer-y7JKQjFK.js";import{A as Te,C as Vt}from"./perseus-api-cFDIds9P.js";import{g as zt}from"./multi-renderer-ambvVR-o.js";import"./hints-renderer-LoUW7vqd.js";import"./base-radio-g9_PPwpo.js";import"./button-group-KR3umc1e.js";import"./graph-pewJN-kC.js";import{L as ct,b as Lt}from"./svg-image-oYAG2f52.js";import"./hud-CJYktPgf.js";import"./icon-TA3bBVIW.js";import"./info-tip-7k4XWhfR.js";import"./inline-icon-QIU9thzn.js";import"./math-input-b0AfbzvY.js";import"./multi-button-group-AxfQn4Cq.js";import"./number-input-JKQiwz_W.js";import{c as Mt}from"./prop-check-box-f7I2HerX.js";import"./range-input--OPosy8W.js";import"./text-input-Q1V0RBx1.js";import"./text-list-editor-A-LpoxgU.js";import{g as mt}from"./dependencies-9B_Bv_mA.js";import{$ as Dt}from"./jquery-5v7aFUvu.js";import"./version-akiLXZts.js";import"./i18n-context-3gTlIcWM.js";import{C as Ut}from"./categorizer-editor-bnz_q4JE.js";import{a,j as t}from"./jsx-runtime-5BUNAZ9W.js";import{E as Et}from"./perseus-error-l3K_anoI.js";import{c as g}from"./components-_RNVLdhX.js";import{P as o}from"./index-tvtfaFq4.js";import{E as c}from"./editor-jsonify-sH7S5SKq.js";import{r as l}from"./index-4g5l5LRQ.js";import{B as y}from"./blur-input-nr2CGk0J.js";import{D as Wt}from"./definition-editor-fYSY_zjH.js";import{D as Ht}from"./dropdown-editor-sa4r65o_.js";import{E as _t}from"./explanation-editor-V1JcIJyu.js";import{E as $t}from"./expression-editor-hRQBDmpV.js";import{I as gt}from"./icon-paths-AuJwhOz7.js";import{l as F}from"./index-awljIyHI.js";import{E as v}from"./editor-mXQ8mLu1.js";import{G as Bt}from"./graph-settings-6TRpjWqC.js";import{I as jt}from"./image-editor-KQXjJACy.js";import{I as Ft}from"./input-number-editor-E7q2QBWN.js";import{I as Kt}from"./index-ubtZAQGf.js";import{I as Gt}from"./flags-for-api-options-GVzd4S-T.js";import{L as Jt}from"./label-image-editor-s4t3VNS9.js";import{M as Yt}from"./matcher-editor-In_yDg5N.js";import{N as Xt}from"./number-line-editor-9jzByHnH.js";import{N as Zt}from"./numeric-input-editor-wn0ZI9XG.js";import{R as ke}from"./index-jmm5gWkb.js";import{P as Qt}from"./python-program-editor-bRc4aB3u.js";import{R as es}from"./editor-g435vMI7.js";import{S as ts}from"./sorter-editor-Z_1OT78B.js";import{V as ss}from"./viewport-resizer--SZ6YtV9.js";import{D as ft}from"./device-framer-ifv68ggP.js";import{I as ns}from"./item-extras-editor-DLnNyD6U.js";const{InfoTip:Ge,PropCheckBox:Je}=g,Ye=400,Xe=400;var C;let as=(C=class extends l.Component{constructor(){super(...arguments),this.change=(...e)=>h.apply(this,e),this.serialize=()=>c.serialize.call(this)}render(){return a("fieldset",{className:"pair-editor",children:[a("label",{children:["Name:"," ",t(y,{value:this.props.name,onChange:this.change("name")})]}),a("label",{children:[" ","Value:"," ",t(y,{value:this.props.value,onChange:this.change("value")})]})]})}},C.propTypes={...d,name:o.string,value:o.string},C.defaultProps={name:"",value:""},C);var _;let rs=(_=class extends l.Component{constructor(){super(...arguments),this.change=(...e)=>h.apply(this,e),this.handlePairChange=(e,s)=>{const n=this.props.pairs.slice();n[e]=s;const r=n[n.length-1];r.name&&r.value&&n.push({name:"",value:""}),this.change("pairs",n)},this.serialize=()=>c.serialize.call(this)}render(){const e=i.map(this.props.pairs,(s,n)=>t(as,{name:s.name,value:s.value,onChange:this.handlePairChange.bind(this,n)},n));return t("div",{children:e})}},_.propTypes={...d,pairs:o.arrayOf(o.shape({name:o.string,value:o.string})).isRequired},_);const is=/khanacademy\.org\/computer-programming\/[^\/]+\/(\d+)/;function os(u){const e=is.exec(u);return e&&(u=e[1]),u}const x=class x extends l.Component{constructor(){super(...arguments),this.change=(...e)=>h.apply(this,e),this._handleSettingsChange=e=>{this.change({settings:e.pairs})},this._handleProgramIDChange=e=>{e=os(e);const{isDevServer:s,InitialRequestUrl:n}=mt(),p=`${s?n.origin:"https://www.khanacademy.org"}/api/internal/scratchpads/${e}`;Dt.getJSON(p).done(f=>{const m=f.userAuthoredContentType;this.change({width:f.width,height:f.height,programID:e,programType:m})}).fail((f,m,b)=>{ct.error("Error retrieving scratchpad info for program ID ",Et.TransientService,{cause:b,loggedMetadata:{textStatus:m,programID:e}}),this.change({width:Ye,height:Xe,programID:e,programType:null})})},this.serialize=()=>c.serialize.call(this)}render(){return a("div",{children:[a("label",{children:["Url or Program ID:"," ",t(y,{value:this.props.programID,onChange:this._handleProgramIDChange})]}),t("br",{}),t(Je,{label:"Show Editor",showEditor:this.props.showEditor,onChange:this.props.onChange}),t(Ge,{children:'If you show the editor, you should use the "full-width" alignment to make room for the width of the editor.'}),t("br",{}),t(Je,{label:"Show Buttons",showButtons:this.props.showButtons,onChange:this.props.onChange}),t("br",{}),a("label",{children:["Settings:",t(rs,{name:"settings",pairs:this.props.settings,onChange:this._handleSettingsChange}),a(Ge,{children:["Settings that you add here are available to the program as an object returned by ",t("code",{children:"Program.settings()"})]})]})]})}};x.propTypes={...d},x.widgetName="cs-program",x.defaultProps={programID:"",programType:null,settings:[{name:"",value:""}],showEditor:!1,showButtons:!1,width:Ye,height:Xe};let J=x;J.__docgenInfo={description:"This is the main editor for this widget, to specify all the options.",methods:[{name:"change",docblock:null,modifiers:[],params:[{name:"...args",optional:!1,type:null}],returns:null},{name:"_handleSettingsChange",docblock:null,modifiers:[],params:[{name:"settings",optional:!1,type:null}],returns:null},{name:"_handleProgramIDChange",docblock:null,modifiers:[],params:[{name:"programID",optional:!1,type:null}],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:null}],displayName:"CSProgramEditor",props:{programID:{defaultValue:{value:'""',computed:!1},required:!1},programType:{defaultValue:{value:"null",computed:!1},required:!1},settings:{defaultValue:{value:'[{name: "", value: ""}]',computed:!1},required:!1},showEditor:{defaultValue:{value:"false",computed:!1},required:!1},showButtons:{defaultValue:{value:"false",computed:!1},required:!1},width:{defaultValue:{value:"400",computed:!1},required:!1},height:{defaultValue:{value:"400",computed:!1},required:!1}},composes:["@khanacademy/perseus"]};const We=class We extends l.Component{serialize(){return c.serialize.call(this)}render(){return a("div",{children:[t("p",{children:"This widget has been deprecated and removed"}),t("p",{children:"Learners will see a message and they will not be graded on this part. Please replace this widget with a supported one."})]})}};We.widgetName="deprecated-standin";let Y=We;Y.__docgenInfo={description:"",methods:[{name:"serialize",docblock:null,modifiers:[],params:[],returns:{type:{name:"any"}}}],displayName:"DeprecatedStandinEditor",props:{onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(options: any) => void",signature:{arguments:[{type:{name:"any"},name:"options"}],return:{name:"void"}}},description:""}}};const{Graphie:yt}=g,xe=yt.MovablePoint;var T;let ls=(T=class extends l.Component{constructor(){super(...arguments),this.getUserInput=()=>bt.getUserInput.call(this),this.change=(...e)=>h.apply(this,e),this.movePoint=e=>{this.change({coord:e})},this._getGridConfig=e=>i.map(e.step,function(s,n){return G.gridDimensionConfig(s,e.range[n],e.box[n],e.gridStep[n])}),this.setupGraphie=(e,s)=>{const n=this._getGridConfig(s);e.graphInit({range:s.range,scale:i.pluck(n,"scale"),axisArrows:"<->",labelFormat:function(r){return"\\small{"+r+"}"},gridStep:s.gridStep,tickStep:i.pluck(n,"tickStep"),labelStep:1,unityLabels:i.pluck(n,"unityLabel")}),e.label([0,s.range[1][1]],s.labels[1],"above")},this.simpleValidate=e=>T.validate(this.getUserInput(),e)}static validate(e,s){return e.coord==null?{type:"invalid",message:null}:Lt(e.coord,s.correct)?{type:"points",earned:1,total:1,message:null}:{type:"points",earned:0,total:1,message:null}}render(){var e;return t(yt,{ref:"graphie",box:this.props.graph.box,range:this.props.graph.range,options:this.props.graph,setup:this.setupGraphie,setDrawingAreaAvailable:(e=this.props.apiOptions)==null?void 0:e.setDrawingAreaAvailable,children:t(xe,{pointSize:5,coord:this.props.coord||[0,0],constraints:[xe.constraints.snap(),xe.constraints.bound()],onMove:this.movePoint})})}},T.defaultProps={coord:null,graph:{box:[400,400],labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],gridStep:[1,1],valid:!0,backgroundImage:null,markings:"grid",showProtractor:!1}},T);const vt={name:"example-graphie-widget",displayName:"Example Graphie Widget",hidden:!0,widget:ls},ps=vt.widget,I=class I extends l.Component{constructor(){super(...arguments),this.change=(...e)=>h.apply(this,e),this.handleChange=e=>{e.coord&&this.change({correct:e.coord})},this.serialize=()=>c.serialize.call(this)}render(){return t("div",{children:t(ps,{graph:this.props.graph,coord:this.props.correct,onChange:this.handleChange,apiOptions:this.props.apiOptions})})}};I.propTypes={...d},I.widgetName="example-graphie-widget",I.defaultProps={correct:[4,4],graph:{box:[340,340],labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],gridStep:[1,1],valid:!0,backgroundImage:null,markings:"grid",showProtractor:!1}};let X=I;X.__docgenInfo={description:`This is the widget's editor. This is what shows up on the left side
of the screen in the demo page. Only the question writer sees this.`,methods:[{name:"change",docblock:null,modifiers:[],params:[{name:"...args",optional:!1,type:null}],returns:null},{name:"handleChange",docblock:null,modifiers:[],params:[{name:"newProps",optional:!1,type:null}],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:null}],displayName:"ExampleGraphieWidgetEditor",props:{correct:{defaultValue:{value:"[4, 4]",computed:!1},required:!1},graph:{defaultValue:{value:`{
    box: [340, 340],
    labels: ["x", "y"],
    range: [
        [-10, 10],
        [-10, 10],
    ],
    step: [1, 1],
    gridStep: [1, 1],
    valid: true,
    backgroundImage: null,
    markings: "grid",
    showProtractor: false,
}`,computed:!1},required:!1}},composes:["@khanacademy/perseus"]};const N=class N extends l.Component{constructor(){super(...arguments),this.input=l.createRef(),this.handleAnswerChange=e=>{this.change({correct:e.target.value})},this.change=(...e)=>h.apply(this,e),this.focus=()=>{var e;return(e=this.input.current)==null||e.focus(),!0},this.serialize=()=>c.serialize.call(this)}render(){return t("div",{children:a("label",{children:["Correct answer:",t("input",{value:this.props.correct,onChange:this.handleAnswerChange,ref:this.input})]})})}};N.propTypes={...d},N.widgetName="example-widget",N.defaultProps={correct:""};let Z=N;Z.__docgenInfo={description:`This is the widget's editor. This is what shows up on the left side
of the screen in the demo. Only the question writer sees this.`,methods:[{name:"handleAnswerChange",docblock:null,modifiers:[],params:[{name:"event",optional:!1,type:null}],returns:null},{name:"change",docblock:null,modifiers:[],params:[{name:"...args",optional:!1,type:null}],returns:null},{name:"focus",docblock:null,modifiers:[],params:[],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:null}],displayName:"ExampleWidgetEditor",props:{correct:{defaultValue:{value:'""',computed:!1},required:!1}},composes:["@khanacademy/perseus"]};const{InlineIcon:Ze,TextInput:us}=g,{iconPlus:hs,iconTrash:ds}=gt,q=class q extends l.Component{constructor(){super(...arguments),this.editor=l.createRef(),this.hintEditor=l.createRef(),this.change=(...e)=>h.apply(this,e),this.handleAddHint=()=>{const e={content:""};this.props.onChange({hint:e},()=>{var s;(s=this.hintEditor.current)==null||s.focus()})},this.handleRemoveHint=e=>{this.props.onChange({hint:null})},this.getSaveWarnings=()=>{var e;return(e=this.editor.current)==null?void 0:e.getSaveWarnings()},this.serialize=()=>{var e,s;return{title:this.props.title,...(e=this.editor.current)==null?void 0:e.serialize(),hint:(s=this.hintEditor.current)==null?void 0:s.serialize()}}}render(){return a("div",{className:"perseus-group-editor",children:[t("div",{className:"perseus-widget-row",children:a("label",{className:F.css(Ie.title),children:["Title:"," ",t(us,{value:this.props.title,className:F.css(Ie.input),onChange:this.change("title")})]})}),t(v,{ref:this.editor,content:this.props.content,widgets:this.props.widgets,apiOptions:this.props.apiOptions,images:this.props.images,widgetEnabled:!0,immutableWidgets:!1,onChange:this.props.onChange,warnNoPrompt:!0,warnNoWidgets:!0}),!this.props.hint&&a("button",{type:"button",style:{marginTop:10},className:"add-hint simple-button orange",onClick:this.handleAddHint,children:[t(Ze,{...hs})," Add a hint"]}),this.props.hint&&a("div",{className:"perseus-hint-editor",children:[t("div",{className:F.css(Ie.hintsTitle),children:"Hint"}),t(v,{ref:this.hintEditor,content:this.props.hint?this.props.hint.content:"",widgets:this.props.hint?this.props.hint.widgets:{},apiOptions:this.props.apiOptions,images:this.props.hint&&this.props.hint.images,widgetEnabled:!0,immutableWidgets:!1,onChange:e=>{this.change("hint",Object.assign({},this.props.hint,e))}}),a("button",{type:"button",className:"remove-hint simple-button orange",onClick:this.handleRemoveHint,children:[t(Ze,{...ds})," Remove this hint"]})]})]})}};q.propTypes={...d,title:o.string,content:o.string,widgets:o.object,images:o.object,apiOptions:Te.propTypes},q.widgetName="graded-group",q.defaultProps={title:"",content:"",widgets:{},images:{},hint:null};let w=q;const Ie=F.StyleSheet.create({title:{fontSize:18,fontWeight:"bold"},input:{fontSize:18},hintsTitle:{marginTop:10,fontSize:"110%",fontWeight:"bold"}});w.__docgenInfo={description:"",methods:[{name:"change",docblock:null,modifiers:[],params:[{name:"...args",optional:!1,type:null}],returns:null},{name:"handleAddHint",docblock:null,modifiers:[],params:[],returns:null},{name:"handleRemoveHint",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:null}],returns:null},{name:"getSaveWarnings",docblock:null,modifiers:[],params:[],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:null}],displayName:"GradedGroupEditor",props:{title:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1},content:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1},widgets:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"object"},required:!1},images:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"object"},required:!1},hint:{defaultValue:{value:"null",computed:!1},required:!1},apiOptions:{description:"",type:{name:"custom",raw:"ApiOptions.propTypes"},required:!1}},composes:["@khanacademy/perseus"]};const S=class S extends l.Component{constructor(){super(...arguments),this.change=(...e)=>h.apply(this,e),this.getSaveWarnings=()=>[].concat(...this._editors.map(e=>e?e.getSaveWarnings():[])),this.serialize=()=>({gradedGroups:this.props.gradedGroups}),this.renderGroups=()=>this.props.gradedGroups?this.props.gradedGroups.map((e,s)=>t(w,{ref:n=>this._editors[s]=n,...e,apiOptions:this.props.apiOptions,widgetEnabled:!0,immutableWidgets:!1,onChange:n=>this.change("gradedGroups",cs(this.props.gradedGroups,s,{...this.props.gradedGroups[s],...n}))},s)):null,this.addGroup=()=>{const e=this.props.gradedGroups||[];this.change("gradedGroups",e.concat([w.defaultProps]))}}UNSAFE_componentWillMount(){this._editors=[]}render(){return a("div",{className:"perseus-group-editor",children:[this.renderGroups(),t("button",{onClick:this.addGroup,children:"Add group"})]})}};S.propTypes={...d,apiOptions:Te.propTypes,gradedGroups:o.array,onChange:o.func.isRequired},S.widgetName="graded-group-set",S.defaultProps={gradedGroups:[]};let Q=S;const cs=(u,e,s)=>[...u.slice(0,e),s,...u.slice(e+1)];Q.__docgenInfo={description:"",methods:[{name:"change",docblock:null,modifiers:[],params:[{name:"...args",optional:!1,type:null}],returns:null},{name:"getSaveWarnings",docblock:null,modifiers:[],params:[],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:null},{name:"renderGroups",docblock:null,modifiers:[],params:[],returns:null},{name:"addGroup",docblock:null,modifiers:[],params:[],returns:null}],displayName:"GradedGroupSetEditor",props:{gradedGroups:{defaultValue:{value:"[]",computed:!1},description:"",type:{name:"array"},required:!1},apiOptions:{description:"",type:{name:"custom",raw:"ApiOptions.propTypes"},required:!1},onChange:{description:"",type:{name:"func"},required:!0}},composes:["@khanacademy/perseus"]};const{InfoTip:ms,MultiButtonGroup:gs}=g,{containerSizeClass:fs,getInteractiveBoxFromSizeClass:ys}=St,vs=wt.widget,{DEFAULT_GRAPHER_PROPS:Ne,allTypes:bs,chooseType:ws,defaultPlotProps:Cs,getEquationString:Ts,typeToButton:ks}=Ct,O=class O extends l.Component{constructor(){super(...arguments),this.change=(...e)=>h.apply(this,e),this.handleAvailableTypesChange=e=>{let s=this.props.correct;if(!i.contains(e,this.props.correct.type)){const n=this.props.graph,r=ws(e);s=Cs(r,n)}this.props.onChange({availableTypes:e,correct:s})},this.serialize=()=>i.chain(this.props).pick("correct","availableTypes").extend({graph:i.omit(this.props.graph,"box")}).value()}render(){const e=fs.SMALL;let s,n;if(this.props.graph.valid===!0){const r={graph:this.props.graph,plot:this.props.correct,availableTypes:this.props.availableTypes,onChange:(p,f)=>{var b;let m=this.props.correct;m.type===((b=p.plot)==null?void 0:b.type)?m=i.extend({},m,p.plot):m=p.plot,this.props.onChange({correct:m},f)},trackInteraction:function(){}};n=t(vs,{...r,apiOptions:this.props.apiOptions,containerSizeClass:e}),s=Ts(r)}else n=t("div",{className:"perseus-error",children:this.props.graph.valid});return a("div",{children:[a("div",{children:["Correct answer"," ",t(ms,{children:t("p",{children:"Graph the correct answer in the graph below and ensure the equation or point coordinates displayed represent the correct answer."})})," ",": ",s]}),t(Bt,{editableSettings:["graph","snap","image"],box:ys(e),range:this.props.graph.range,labels:this.props.graph.labels,step:this.props.graph.step,gridStep:this.props.graph.gridStep,snapStep:this.props.graph.snapStep,valid:this.props.graph.valid,backgroundImage:this.props.graph.backgroundImage,markings:this.props.graph.markings,rulerLabel:this.props.graph.rulerLabel,rulerTicks:this.props.graph.rulerTicks,showTooltips:this.props.graph.showTooltips,onChange:this.change("graph")}),a("div",{className:"perseus-widget-row",children:[t("label",{children:"Available functions: "}),t(gs,{allowEmpty:!1,values:this.props.availableTypes,buttons:i.map(bs,ks),onChange:this.handleAvailableTypesChange})]}),n]})}};O.propTypes={...d},O.widgetName="grapher",O.defaultProps={correct:Ne.plot,graph:Ne.graph,availableTypes:Ne.availableTypes};let ee=O;ee.__docgenInfo={description:"",methods:[{name:"change",docblock:null,modifiers:[],params:[{name:"...args",optional:!1,type:null}],returns:null},{name:"handleAvailableTypesChange",docblock:null,modifiers:[],params:[{name:"newAvailableTypes",optional:!1,type:{name:"Array",elements:[{name:"any"}],raw:"Array<any>",alias:"Array"}}],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:null}],displayName:"GrapherEditor",props:{correct:{defaultValue:{value:"DEFAULT_GRAPHER_PROPS.plot",computed:!0},required:!1},graph:{defaultValue:{value:"DEFAULT_GRAPHER_PROPS.graph",computed:!0},required:!1},availableTypes:{defaultValue:{value:"DEFAULT_GRAPHER_PROPS.availableTypes",computed:!0},required:!1}},composes:["@khanacademy/perseus"]};const P=class P extends l.Component{constructor(){super(...arguments),this.editor=l.createRef(),this._renderMetadataEditor=()=>{const e=this.props.apiOptions.GroupMetadataEditor;return t(e,{value:this.props.metadata,onChange:this.change("metadata")})},this.change=(...e)=>h.apply(this,e),this.getSaveWarnings=()=>{var e;return(e=this.editor.current)==null?void 0:e.getSaveWarnings()},this.serialize=()=>{var e;return i.extend({},(e=this.editor.current)==null?void 0:e.serialize(),{metadata:this.props.metadata})}}render(){return a("div",{className:"perseus-group-editor",children:[t("div",{children:this._renderMetadataEditor()}),t(v,{ref:this.editor,content:this.props.content,widgets:this.props.widgets,apiOptions:this.props.apiOptions,images:this.props.images,widgetEnabled:!0,immutableWidgets:!1,onChange:this.props.onChange})]})}};P.propTypes={...d,content:o.string,widgets:o.object,images:o.object,metadata:o.any,apiOptions:Te.propTypes},P.widgetName="group",P.defaultProps={content:"",widgets:{},images:{},metadata:void 0};let te=P;te.__docgenInfo={description:"",methods:[{name:"_renderMetadataEditor",docblock:null,modifiers:[],params:[],returns:null},{name:"change",docblock:null,modifiers:[],params:[{name:"...args",optional:!1,type:null}],returns:null},{name:"getSaveWarnings",docblock:null,modifiers:[],params:[],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:null}],displayName:"GroupEditor",props:{content:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1},widgets:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"object"},required:!1},images:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"object"},required:!1},metadata:{defaultValue:{value:"undefined",computed:!0},description:"",type:{name:"any"},required:!1},apiOptions:{description:"",type:{name:"custom",raw:"ApiOptions.propTypes"},required:!1}},composes:["@khanacademy/perseus"]};const{PropCheckBox:Qe}=g,fe=class fe extends l.Component{constructor(){super(...arguments),this.change=(...e)=>h.apply(this,e),this.serialize=()=>c.serialize.call(this)}render(){return a("fieldset",{children:[a("label",{children:["Name:",t(y,{value:this.props.name,onChange:this.change("name")})]}),a("label",{children:["Value:",t(y,{value:this.props.value,onChange:this.change("value")})]})]})}};fe.propTypes={...d,name:o.string,value:o.string},fe.defaultProps={name:"",value:""};let Oe=fe;const He=class He extends l.Component{constructor(){super(...arguments),this.change=(...e)=>h.apply(this,e),this.handlePairChange=(e,s)=>{const n=this.props.pairs.slice();n[e]=s;const r=n[n.length-1];r.name&&r.value&&n.push({name:"",value:""}),this.change("pairs",n)},this.serialize=()=>c.serialize.call(this)}render(){const e=i.map(this.props.pairs,(s,n)=>t(Oe,{name:s.name,value:s.value,onChange:this.handlePairChange.bind(this,n)},n));return t("div",{children:e})}};He.propTypes={...d,pairs:o.arrayOf(o.shape({name:o.string,value:o.string})).isRequired};let Pe=He;const A=class A extends l.Component{constructor(){super(...arguments),this.change=(...e)=>h.apply(this,e),this.handleSettingsChange=e=>{this.change({settings:e.pairs})},this.serialize=()=>c.serialize.call(this)}render(){return a("div",{children:[a("div",{style:{fontWeight:"bold",textAlign:"center"},children:["This widget is deprecated! ",t("br",{}),"Try using the Video or CS Program widgets instead."]}),a("label",{children:["Url or Program ID:",t(y,{value:this.props.url,onChange:this.change("url")})]}),t("br",{}),a("label",{children:["Settings:",t(Pe,{name:"settings",pairs:this.props.settings,onChange:this.handleSettingsChange})]}),t("br",{}),a("label",{children:["Width:",t(y,{value:this.props.width,onChange:this.change("width")})]}),a("label",{children:["Height:",t(y,{value:this.props.height,onChange:this.change("height")})]}),t(Qe,{label:"Allow full screen",allowFullScreen:this.props.allowFullScreen,onChange:this.props.onChange}),t("br",{}),t(Qe,{label:"Allow iframe content to redirect the page",allowTopNavigation:this.props.allowTopNavigation,onChange:this.props.onChange})]})}};A.propTypes={...d},A.widgetName="iframe",A.defaultProps={url:"",settings:[{name:"",value:""}],width:"400",height:"400",allowFullScreen:!1,allowTopNavigation:!1};let se=A;se.__docgenInfo={description:"This is the main editor for this widget, to specify all the options.",methods:[{name:"change",docblock:null,modifiers:[],params:[{name:"...args",optional:!1,type:null}],returns:null},{name:"handleSettingsChange",docblock:null,modifiers:[],params:[{name:"settings",optional:!1,type:null}],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:null}],displayName:"IframeEditor",props:{url:{defaultValue:{value:'""',computed:!1},required:!1},settings:{defaultValue:{value:'[{name: "", value: ""}]',computed:!1},required:!1},width:{defaultValue:{value:'"400"',computed:!1},required:!1},height:{defaultValue:{value:'"400"',computed:!1},required:!1},allowFullScreen:{defaultValue:{value:"false",computed:!1},required:!1},allowTopNavigation:{defaultValue:{value:"false",computed:!1},required:!1}},composes:["@khanacademy/perseus"]};const{RangeInput:xs}=g,Is=Tt.widget,et=6,Ns=function(u){const e=[1,1];return i(u).each((s,n)=>{let r=0;i(s).each((p,f)=>{p!=null&&p.toString().length&&(r=f+1)}),e[1]=Math.max(e[1],r),r>0&&(e[0]=Math.max(e[0],n+1))}),e},R=class R extends l.Component{constructor(){super(...arguments),this.change=(...e)=>h.apply(this,e),this.onMatrixBoardSizeChange=e=>{const s=Ns(this.props.answers);if(e[0]!==null&&e[1]!==null){e=[Math.round(Math.min(Math.max(e[0],1),et)),Math.round(Math.min(Math.max(e[1],1),et))];const n=i(Math.min(e[0],s[0])).times(r=>i(Math.min(e[1],s[1])).times(p=>this.props.answers[r][p]));this.props.onChange({matrixBoardSize:e,answers:n})}},this.serialize=()=>c.serialize.call(this)}render(){const e=i.extend({numericInput:!0,onBlur:()=>{},onFocus:()=>{},trackInteraction:()=>{}},this.props);return a("div",{className:"perseus-matrix-editor",children:[a("div",{className:"perseus-widget-row",children:[" ","Max matrix size:"," ",t(xs,{value:this.props.matrixBoardSize,onChange:this.onMatrixBoardSizeChange,format:this.props.labelStyle,useArrowKeys:!0})]}),t("div",{className:"perseus-widget-row",children:t(Is,{...e})}),a("div",{className:"perseus-widget-row",children:[" ","Matrix prefix:"," ",t(v,{ref:"prefix",apiOptions:this.props.apiOptions,content:this.props.prefix,widgetEnabled:!1,onChange:s=>{this.change({prefix:s.content})}})]}),a("div",{className:"perseus-widget-row",children:[" ","Matrix suffix:"," ",t(v,{ref:"suffix",apiOptions:this.props.apiOptions,content:this.props.suffix,widgetEnabled:!1,onChange:s=>{this.change({suffix:s.content})}})]})]})}};R.propTypes={...d,matrixBoardSize:o.arrayOf(o.number).isRequired,answers:o.arrayOf(o.arrayOf(o.number)),prefix:o.string,suffix:o.string,cursorPosition:o.arrayOf(o.number)},R.widgetName="matrix",R.defaultProps={matrixBoardSize:[3,3],answers:[[]],prefix:"",suffix:"",cursorPosition:[0,0]};let ne=R;ne.__docgenInfo={description:"",methods:[{name:"change",docblock:null,modifiers:[],params:[{name:"...args",optional:!1,type:null}],returns:null},{name:"onMatrixBoardSizeChange",docblock:null,modifiers:[],params:[{name:"range",optional:!1,type:null}],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:null}],displayName:"MatrixEditor",props:{matrixBoardSize:{defaultValue:{value:"[3, 3]",computed:!1},description:"",type:{name:"arrayOf",value:{name:"number"}},required:!1},answers:{defaultValue:{value:"[[]]",computed:!1},description:"",type:{name:"arrayOf",value:{name:"arrayOf",value:{name:"number"}}},required:!1},prefix:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1},suffix:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1},cursorPosition:{defaultValue:{value:"[0, 0]",computed:!1},description:"",type:{name:"arrayOf",value:{name:"number"}},required:!1}},composes:["@khanacademy/perseus"]};const{InfoTip:qs,NumberInput:$,PropCheckBox:tt,RangeInput:Ss}=g,Os={url:null,top:0,left:0},V=class V extends l.Component{constructor(){super(...arguments),this.className="perseus-widget-measurer",this.change=(...e)=>h.apply(this,e),this._changeUrl=e=>{this._changeImage("url",e.target.value)},this._changeTop=e=>{this._changeImage("top",e)},this._changeLeft=e=>{this._changeImage("left",e)},this._changeImage=(e,s)=>{const n=i.clone(this.props.image);n[e]=s,this.change("image",n)},this.renderLabelChoices=e=>i.map(e,function(s){const[n,r]=s;return t("option",{value:r,children:n},r)}),this.serialize=()=>c.serialize.call(this)}render(){const e=i.extend({},Os,this.props.image);return a("div",{className:"perseus-widget-measurer",children:[t("div",{children:"Image displayed under protractor and/or ruler:"}),a("div",{children:["URL:"," ",t("input",{type:"text",className:"perseus-widget-measurer-url",ref:"image-url",defaultValue:e.url,onChange:this._changeUrl}),t(qs,{children:t("p",{children:'Create an image in graphie, or use the "Add image" function to create a background.'})})]}),e.url&&a("div",{className:"perseus-widget-row",children:[a("label",{className:"perseus-widget-left-col",children:["Pixels from top:"," ",t($,{placeholder:0,onChange:this._changeTop,value:e.top,useArrowKeys:!0})]}),a("label",{className:"perseus-widget-right-col",children:["Pixels from left:"," ",t($,{placeholder:0,onChange:this._changeLeft,value:e.left,useArrowKeys:!0})]})]}),a("div",{children:["Containing area [width, height]:"," ",t(Ss,{onChange:this.change("box"),value:this.props.box,useArrowKeys:!0})]}),a("div",{className:"perseus-widget-row",children:[t("div",{className:"perseus-widget-left-col",children:t(tt,{label:"Show ruler",showRuler:this.props.showRuler,onChange:this.props.onChange})}),t("div",{className:"perseus-widget-right-col",children:t(tt,{label:"Show protractor",showProtractor:this.props.showProtractor,onChange:this.props.onChange})})]}),this.props.showRuler&&a("div",{children:[t("div",{children:a("label",{children:[" ","Ruler label:"," ",a("select",{onChange:s=>this.change("rulerLabel",s.target.value),value:this.props.rulerLabel,children:[t("option",{value:"",children:"None"}),t("optgroup",{label:"Metric",children:this.renderLabelChoices([["milimeters","mm"],["centimeters","cm"],["meters","m"],["kilometers","km"]])}),t("optgroup",{label:"Imperial",children:this.renderLabelChoices([["inches","in"],["feet","ft"],["yards","yd"],["miles","mi"]])})]})]})}),t("div",{children:a("label",{children:[" ","Ruler ticks:"," ",t("select",{onChange:s=>this.change("rulerTicks",+s.target.value),value:this.props.rulerTicks,children:i.map([1,2,4,8,10,16],function(s){return t("option",{value:s,children:s},s)})})]})}),t("div",{children:a("label",{children:["Ruler pixels per unit:"," ",t($,{placeholder:40,onChange:this.change("rulerPixels"),value:this.props.rulerPixels,useArrowKeys:!0})]})}),t("div",{children:a("label",{children:["Ruler length in units:"," ",t($,{placeholder:10,onChange:this.change("rulerLength"),value:this.props.rulerLength,useArrowKeys:!0})]})})]})]})}};V.widgetName="measurer",V.propTypes={...d,box:o.arrayOf(o.number),image:o.shape({url:o.string,top:o.number,left:o.number}),showProtractor:o.bool,showRuler:o.bool,rulerLabel:o.string,rulerTicks:o.number,rulerPixels:o.number,rulerLength:o.number},V.defaultProps={box:[480,480],image:{},showProtractor:!0,showRuler:!1,rulerLabel:"",rulerTicks:10,rulerPixels:40,rulerLength:10};let ae=V;ae.__docgenInfo={description:"",methods:[{name:"change",docblock:null,modifiers:[],params:[{name:"...args",optional:!1,type:null}],returns:null},{name:"_changeUrl",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:null}],returns:null},{name:"_changeTop",docblock:null,modifiers:[],params:[{name:"newTop",optional:!1,type:null}],returns:null},{name:"_changeLeft",docblock:null,modifiers:[],params:[{name:"newLeft",optional:!1,type:null}],returns:null},{name:"_changeImage",docblock:null,modifiers:[],params:[{name:"subProp",optional:!1,type:null},{name:"newValue",optional:!1,type:null}],returns:null},{name:"renderLabelChoices",docblock:null,modifiers:[],params:[{name:"choices",optional:!1,type:null}],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:null}],displayName:"MeasurerEditor",props:{box:{defaultValue:{value:"[480, 480]",computed:!1},description:"",type:{name:"arrayOf",value:{name:"number"}},required:!1},image:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"shape",value:{url:{name:"string",required:!1},top:{name:"number",required:!1},left:{name:"number",required:!1}}},required:!1},showProtractor:{defaultValue:{value:"true",computed:!1},description:"",type:{name:"bool"},required:!1},showRuler:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},rulerLabel:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1},rulerTicks:{defaultValue:{value:"10",computed:!1},description:"",type:{name:"number"},required:!1},rulerPixels:{defaultValue:{value:"40",computed:!1},description:"",type:{name:"number"},required:!1},rulerLength:{defaultValue:{value:"10",computed:!1},description:"",type:{name:"number"},required:!1}},composes:["@khanacademy/perseus"]};const{NumberInput:Ps,TextInput:As}=g,ye=class ye extends l.Component{constructor(){super(...arguments),this.change=(...e)=>h.apply(this,e),this.updateMolecule=e=>{this.change({smiles:e})},this.updateRotation=e=>{this.change({rotationAngle:e})},this.serialize=()=>c.serialize.call(this)}render(){return a("div",{children:[t("div",{children:a("label",{children:["SMILES: ",t(As,{onChange:this.updateMolecule,value:this.props.smiles})]})}),t("div",{children:a("label",{children:["Rotation (deg): ",t(Ps,{onChange:this.updateRotation,value:this.props.rotationAngle})]})})]})}};ye.propTypes={...d,rotationAngle:o.number,smiles:o.string},ye.widgetName="molecule-renderer";let re=ye;re.__docgenInfo={description:"",methods:[{name:"change",docblock:null,modifiers:[],params:[{name:"...args",optional:!1,type:null}],returns:null},{name:"updateMolecule",docblock:null,modifiers:[],params:[{name:"newValue",optional:!1,type:null}],returns:null},{name:"updateRotation",docblock:null,modifiers:[],params:[{name:"newValue",optional:!1,type:null}],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:null}],displayName:"MoleculeWidgetEditor",props:{rotationAngle:{description:"",type:{name:"number"},required:!1},smiles:{description:"",type:{name:"string"},required:!1}},composes:["@khanacademy/perseus"]};const{InfoTip:B,TextListEditor:st}=g,qe="normal",nt="auto",Se="horizontal",at="vertical",z=class z extends l.Component{constructor(){super(...arguments),this.onOptionsChange=(e,s,n)=>{const r={};r[e]=i.map(s,function(p){return{content:p}}),this.props.onChange(r,n)},this.onLayoutChange=e=>{this.props.onChange({layout:e.target.value})},this.onHeightChange=e=>{this.props.onChange({height:e.target.value})},this.serialize=()=>({options:i.chain(i.pluck(this.props.correctOptions,"content")).union(i.pluck(this.props.otherOptions,"content")).uniq().reject(function(s){return s===""}).sort().sortBy(function(s){return/\d/.test(s)?0:/^\$?[a-zA-Z]+\$?$/.test(s)?2:1}).map(function(s){return{content:s}}).value(),correctOptions:this.props.correctOptions,otherOptions:this.props.otherOptions,height:this.props.height,layout:this.props.layout})}render(){return a("div",{className:"perseus-widget-orderer",children:[a("div",{children:[" ","Correct answer:"," ",t(B,{children:t("p",{children:"Place the cards in the correct order. The same card can be used more than once in the answer but will only be displayed once at the top of a stack of identical cards."})})]}),t(st,{options:i.pluck(this.props.correctOptions,"content"),onChange:this.onOptionsChange.bind(this,"correctOptions"),layout:this.props.layout}),a("div",{children:[" ","Other cards:"," ",t(B,{children:t("p",{children:"Create cards that are not part of the answer."})})]}),t(st,{options:i.pluck(this.props.otherOptions,"content"),onChange:this.onOptionsChange.bind(this,"otherOptions"),layout:this.props.layout}),a("div",{children:[a("label",{children:[" ","Layout:"," ",a("select",{value:this.props.layout,onChange:this.onLayoutChange,children:[t("option",{value:Se,children:"Horizontal"}),t("option",{value:at,children:"Vertical"})]})]}),t(B,{children:t("p",{children:"Use the horizontal layout for short text and small images. The vertical layout is best for longer text (e.g. proofs)."})})]}),a("div",{children:[a("label",{children:[" ","Height:"," ",a("select",{value:this.props.height,onChange:this.onHeightChange,children:[t("option",{value:qe,children:"Normal"}),t("option",{value:nt,children:"Automatic"})]})]}),t(B,{children:t("p",{children:'Use "Normal" for text, "Automatic" for images.'})})]})]})}};z.propTypes={correctOptions:o.array,otherOptions:o.array,height:o.oneOf([qe,nt]),layout:o.oneOf([Se,at]),onChange:o.func.isRequired},z.widgetName="orderer",z.defaultProps={correctOptions:[{content:"$x$"}],otherOptions:[{content:"$y$"}],height:qe,layout:Se};let ie=z;ie.__docgenInfo={description:"",methods:[{name:"onOptionsChange",docblock:null,modifiers:[],params:[{name:"whichOptions",optional:!1,type:null},{name:"options",optional:!1,type:null},{name:"cb",optional:!1,type:null}],returns:null},{name:"onLayoutChange",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:null}],returns:null},{name:"onHeightChange",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:null}],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:null}],displayName:"OrdererEditor",props:{correctOptions:{defaultValue:{value:'[{content: "$x$"}]',computed:!1},description:"",type:{name:"array"},required:!1},otherOptions:{defaultValue:{value:'[{content: "$y$"}]',computed:!1},description:"",type:{name:"array"},required:!1},height:{defaultValue:{value:'"normal"',computed:!1},description:"",type:{name:"enum",value:[{value:'"normal"',computed:!1},{value:'"auto"',computed:!1}]},required:!1},layout:{defaultValue:{value:'"horizontal"',computed:!1},description:"",type:{name:"enum",value:[{value:'"horizontal"',computed:!1},{value:'"vertical"',computed:!1}]},required:!1},onChange:{description:"",type:{name:"func"},required:!0}}};const{InfoTip:rt,PropCheckBox:Rs}=g,L=class L extends l.Component{constructor(){super(...arguments),this.change=(...e)=>h.apply(this,e),this.serialize=()=>c.serialize.call(this)}render(){const e=t(v,{ref:"passage-editor",apiOptions:this.props.apiOptions,content:this.props.passageText,widgetEnabled:!1,placeholder:"Type passage here...",onChange:n=>{this.change({passageText:n.content})},showWordCount:!0}),s=t(v,{ref:"passage-footnotes-editor",apiOptions:this.props.apiOptions,content:this.props.footnotes,widgetEnabled:!1,placeholder:"Type footnotes here...",onChange:n=>{this.change({footnotes:n.content})}});return a("div",{className:"perseus-widget-passage-editor",children:[t("div",{className:"perseus-widget-row",children:t(Rs,{label:"Show line numbers",labelAlignment:"right",showLineNumbers:this.props.showLineNumbers,onChange:this.props.onChange})}),a("div",{children:["Passage title:",t(rt,{children:t("p",{children:"An optional title that will appear directly above the passage in the same font style. (E.g. Passage 1)"})}),t("div",{children:t("input",{type:"text",defaultValue:this.props.passageTitle,onChange:n=>{this.change({passageTitle:n.target.value})}})})]}),a("div",{children:["Passage Text:",e]}),a("div",{children:["Footnotes:",t(rt,{children:t("p",{children:"To add footnotes, add ^ characters where they belong in the passage. Then, add ^ in the footnotes area to reference the footnotes in the passage."})}),s]})]})}};L.propTypes={...d,passageTitle:o.string,passageText:o.string,footnotes:o.string,showLineNumbers:o.bool},L.widgetName="passage",L.defaultProps={passageTitle:"",passageText:"",footnotes:"",showLineNumbers:!0};let oe=L;oe.__docgenInfo={description:"",methods:[{name:"change",docblock:null,modifiers:[],params:[{name:"...args",optional:!1,type:null}],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:null}],displayName:"PassageEditor",props:{passageTitle:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1},passageText:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1},footnotes:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1},showLineNumbers:{defaultValue:{value:"true",computed:!1},description:"",type:{name:"bool"},required:!1}},composes:["@khanacademy/perseus"]};const{InfoTip:Vs,NumberInput:it,TextInput:zs}=g,M=class M extends l.Component{constructor(){super(...arguments),this.change=(...e)=>h.apply(this,e),this.serialize=()=>c.serialize.call(this)}render(){return a("div",{children:[t("div",{children:a("label",{children:["Passage Number: ",t(it,{value:this.props.passageNumber,onChange:this.change("passageNumber")})]})}),t("div",{children:a("label",{children:["Reference Number: ",t(it,{value:this.props.referenceNumber,onChange:this.change("referenceNumber")})]})}),t("div",{children:a("label",{children:["Summary Text: ",t(zs,{value:this.props.summaryText,onChange:this.change("summaryText")}),a(Vs,{children:[t("p",{children:"Short summary of the referenced section. This will be included in parentheses and quotes automatically."}),t("p",{children:"Ex: The start ... the end"})]})]})})]})}};M.propTypes={...d,passageNumber:o.number,referenceNumber:o.number,summaryText:o.string},M.widgetName="passage-ref",M.defaultProps={passageNumber:1,referenceNumber:1,summaryText:""};let le=M;le.__docgenInfo={description:"",methods:[{name:"change",docblock:null,modifiers:[],params:[{name:"...args",optional:!1,type:null}],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:null}],displayName:"PassageRefEditor",props:{passageNumber:{defaultValue:{value:"1",computed:!1},description:"",type:{name:"number"},required:!1},referenceNumber:{defaultValue:{value:"1",computed:!1},description:"",type:{name:"number"},required:!1},summaryText:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1}},composes:["@khanacademy/perseus"]};const D=class D extends l.Component{constructor(){super(...arguments),this.change=(...e)=>h.apply(this,e),this.handleContentChange=e=>{this.change({content:e.target.value})},this.serialize=()=>c.serialize.call(this)}render(){return a("div",{children:["Content:",t("input",{type:"text",value:this.props.content,onChange:this.handleContentChange})]})}};D.propTypes={...d,content:o.string},D.widgetName="passage-ref-target",D.defaultProps={content:""};let pe=D;pe.__docgenInfo={description:"",methods:[{name:"change",docblock:null,modifiers:[],params:[{name:"...args",optional:!1,type:null}],returns:null},{name:"handleContentChange",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:null}],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:null}],displayName:"PassageRefTargetEditor",props:{content:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1}},composes:["@khanacademy/perseus"]};const{InfoTip:k,NumberInput:ot,RangeInput:Ls,TextListEditor:Ms}=g,Ds=kt.widget,Ae="starting",Re="correct",Us=[Ae,Re];function lt(u,e,s){const n=i.clone(u);n.length=e;for(let r=u.length;r<e;r++)n[r]=s;return n}const j={scaleY:1,maxY:10,snapsPerLine:2},pt=u=>"$"+qt(u,2)+"$",ve=class ve extends l.Component{constructor(){super(...arguments),this.state={editing:this.props.static?Ae:Re,pic:null,loadedUrl:null,minX:null,maxX:null,tickStep:null},this.fetchPic=e=>{if(this.state.loadedUrl!==e){const s=new Image;s.src=e,s.onload=()=>{this.setState({pic:s,loadedUrl:e})}}},this.handleChangeTickStep=e=>{this.setState({tickStep:e})},this.handleChangeRange=e=>{this.setState({minX:e[0],maxX:e[1]})},this.changeLabelInterval=e=>{this.props.onChange({labelInterval:e})},this.handlePlotterChange=e=>{const s={};s[this.state.editing]=e.values,this.props.onChange(s)},this.changeType=e=>{let s;if(e==="histogram"?(s=[pt(0)].concat(this.props.categories),this.props.onChange({type:e,categories:s})):this.props.type==="histogram"?(s=this.props.categories.slice(1),this.props.onChange({type:e,categories:s})):this.props.onChange({type:e}),s){const n=ke.findDOMNode(this.refs.categories);n.value=s.join(", ")}},this.changeLabel=(e,s)=>{const n=i.clone(this.props.labels);n[e]=s.target.value,this.props.onChange({labels:n})},this.changePicUrl=e=>{const s=G.getRealImageUrl(e);this.props.onChange({picUrl:s})},this.changeCategories=e=>{let s=e.length;this.props.type==="histogram"&&s--;const n=this.props.scaleY;this.props.onChange({categories:e,correct:lt(this.props.correct,s,n),starting:lt(this.props.starting,s,n)})},this.changeScale=e=>{const s=this.props.scaleY,n=+e.target.value||j.scaleY,r=function(f){return f*n/s},p=r(this.props.maxY);this.props.onChange({scaleY:n,maxY:p,correct:i.map(this.props.correct,r),starting:i.map(this.props.starting,r)}),ke.findDOMNode(this.refs.maxY).value=p},this.changeMax=e=>{this.props.onChange({maxY:+e.target.value||j.maxY})},this.changeSnaps=e=>{this.props.onChange({snapsPerLine:+e.target.value||j.snapsPerLine})},this.changeEditing=e=>{this.setState({editing:e})},this.setCategoriesFromScale=()=>{const e=this.state.tickStep||1,s=this.state.minX||0,n=this.state.maxX||0,r=Math.floor((n-s)/e)*e;let p;this.props.type==="histogram"||this.props.type==="dotplot"?p=i.range(0,r+e,e):p=i.range(e,r+e,e),p=i.map(p,m=>m+s),p=i.map(p,pt),this.changeCategories(p);const f=ke.findDOMNode(this.refs.categories);f.value=p.join(", ")},this.serialize=()=>{const e=i.pick(this.props,"correct","starting","type","labels","categories","scaleY","maxY","snapsPerLine","labelInterval");return this.props.type==="pic"&&(e.picUrl=this.props.picUrl),e}}UNSAFE_componentWillMount(){this.fetchPic(this.props.picUrl)}UNSAFE_componentWillReceiveProps(e){this.fetchPic(e.picUrl),e.static&&this.setState({editing:"starting"})}render(){const e=i.contains(["line","histogram","dotplot"],this.props.type),s=!i.contains(["pic","dotplot"],this.props.type),n={trackInteraction:()=>{},...this.props};return a("div",{className:"perseus-widget-plotter-editor",children:[a("div",{children:["Chart type:"," ",xt.map(r=>a("label",{children:[t("input",{type:"radio",name:"chart-type",checked:this.props.type===r,onChange:i.partial(this.changeType,r)}),r]},r),this)]}),a("div",{children:["Labels:"," ",["x","y"].map((r,p)=>a("label",{children:[r+":",t("input",{type:"text",onChange:i.partial(this.changeLabel,p),defaultValue:this.props.labels[p]})]},r),this)]}),e&&a("div",{className:"set-from-scale-box",children:[t("span",{className:"categories-title",children:"Set Categories From Scale"}),a("div",{children:[a("label",{children:["Tick Step:"," ",t(ot,{placeholder:1,useArrowKeys:!0,value:this.state.tickStep,onChange:this.handleChangeTickStep})]}),t(k,{children:t("p",{children:"The difference between adjacent ticks."})})]}),t("div",{children:a("label",{children:["Range:"," ",t(Ls,{placeholder:[0,10],useArrowKeys:!0,value:[this.state.minX,this.state.maxX],onChange:this.handleChangeRange})]})}),t("div",{children:a("button",{onClick:this.setCategoriesFromScale,children:["Set Categories"," "]})})]}),a("div",{children:[a("label",{children:["Label Interval:"," ",t(ot,{useArrowKeys:!0,value:this.props.labelInterval,onChange:this.changeLabelInterval})]}),t(k,{children:t("p",{children:'Which ticks to display the labels for. For instance, setting this to "4" will only show every 4th label (plus the last one)'})})]}),this.props.type==="pic"&&a("div",{children:[a("label",{children:["Picture:"," ",t(y,{className:"pic-url",value:this.props.picUrl,onChange:this.changePicUrl}),t(k,{children:t("p",{children:'Use the default picture of Earth, or insert the URL for a different picture using the "Add image" function.'})})]}),this.state.pic&&this.state.pic.width!==this.state.pic.height&&a("p",{className:"warning",children:[t("b",{children:"Warning"}),": You are using a picture which is not square. This means the image will get distorted. You should probably crop it to be square."]})]}),t("div",{children:a("label",{children:["Categories:"," ",t(Ms,{ref:"categories",layout:"horizontal",options:this.props.categories,onChange:this.changeCategories})]})}),t("div",{children:a("label",{children:["Scale (y):"," ",t("input",{type:"text",onChange:this.changeScale,defaultValue:this.props.scaleY})]})}),t("div",{children:a("label",{children:["Max y:"," ",t("input",{type:"text",ref:"maxY",onChange:this.changeMax,defaultValue:this.props.maxY})]})}),s&&a("div",{children:[a("label",{children:["Snaps per line:"," ",t("input",{type:"text",onChange:this.changeSnaps,defaultValue:this.props.snapsPerLine})]}),t(k,{children:t("p",{children:"Creates the specified number of divisions between the horizontal lines. Fewer snaps between lines makes the graph easier for the student to create correctly."})})]}),a("div",{children:["Editing values:"," ",Us.map(r=>a("label",{children:[t("input",{type:"radio",disabled:r===Re&&this.props.static,checked:this.props.static?r===Ae:this.state.editing===r,onChange:p=>this.changeEditing(r)}),r]},r)),a(k,{children:[t("p",{children:"Use this toggle to switch between editing the correct answer (what the student will be graded on) and the starting values (what the student will see plotted when they start the problem). Note: These cannot be the same."}),t("p",{children:"In static mode, the starting values are rendered out to the displayed widget."})]})]}),t(Ds,{...n,starting:this.props[this.state.editing],onChange:this.handlePlotterChange})]})}};ve.widgetName="plotter",ve.defaultProps={...j,correct:[1],starting:[1],type:"bar",labels:["",""],categories:[""],picSize:30,picBoxHeight:36,plotDimensions:[275,200],labelInterval:1,get picUrl(){const e=mt().staticUrl;return e?e("/images/badges/earth-small.png"):null}};let ue=ve;ue.__docgenInfo={description:"",methods:[{name:"fetchPic",docblock:null,modifiers:[],params:[{name:"url",optional:!1,type:null}],returns:null},{name:"handleChangeTickStep",docblock:null,modifiers:[],params:[{name:"value",optional:!1,type:null}],returns:null},{name:"handleChangeRange",docblock:null,modifiers:[],params:[{name:"newValue",optional:!1,type:null}],returns:null},{name:"changeLabelInterval",docblock:null,modifiers:[],params:[{name:"value",optional:!1,type:null}],returns:null},{name:"handlePlotterChange",docblock:null,modifiers:[],params:[{name:"newProps",optional:!1,type:null}],returns:null},{name:"changeType",docblock:null,modifiers:[],params:[{name:"type",optional:!1,type:null}],returns:null},{name:"changeLabel",docblock:null,modifiers:[],params:[{name:"i",optional:!1,type:null},{name:"e",optional:!1,type:null}],returns:null},{name:"changePicUrl",docblock:null,modifiers:[],params:[{name:"value",optional:!1,type:null}],returns:null},{name:"changeCategories",docblock:null,modifiers:[],params:[{name:"categories",optional:!1,type:null}],returns:null},{name:"changeScale",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:null}],returns:null},{name:"changeMax",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:null}],returns:null},{name:"changeSnaps",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:null}],returns:null},{name:"changeEditing",docblock:null,modifiers:[],params:[{name:"editing",optional:!1,type:null}],returns:null},{name:"setCategoriesFromScale",docblock:null,modifiers:[],params:[],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:null}],displayName:"PlotterEditor",props:{type:{required:!1,tsType:{name:'PerseusPlotterWidgetOptions["type"]',raw:'PerseusPlotterWidgetOptions["type"]'},description:"",defaultValue:{value:'"bar"',computed:!1}},labels:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"Array<string>"},description:"",defaultValue:{value:'["", ""]',computed:!1}},categories:{required:!1,tsType:{name:"ReadonlyArray",elements:[{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}]}],raw:"ReadonlyArray<string | number>"},description:"",defaultValue:{value:'[""]',computed:!1}},scaleY:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"1",computed:!1}},maxY:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"10",computed:!1}},snapsPerLine:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"2",computed:!1}},picSize:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"30",computed:!1}},picBoxHeight:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"36",computed:!1}},picUrl:{required:!0,tsType:{name:"string"},description:""},plotDimensions:{required:!1,tsType:{name:"ReadonlyArray",elements:[{name:"number"}],raw:"ReadonlyArray<number>"},description:"",defaultValue:{value:"[275, 200]",computed:!1}},labelInterval:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"1",computed:!1}},starting:{required:!1,tsType:{name:"ReadonlyArray",elements:[{name:"number"}],raw:"ReadonlyArray<number>"},description:"",defaultValue:{value:"[1]",computed:!1}},correct:{required:!1,tsType:{name:"ReadonlyArray",elements:[{name:"number"}],raw:"ReadonlyArray<number>"},description:"",defaultValue:{value:"[1]",computed:!1}},static:{required:!0,tsType:{name:"boolean"},description:""},onChange:{required:!0,tsType:{name:"any"},description:""}}};class Es extends l.Component{constructor(){super(...arguments),this.focus=()=>(this.refs.input.focus(),!0),this.changeValue=e=>{this.props.onChange(e.target.value)}}render(){return t("textarea",{ref:"input",value:this.props.value||"",onChange:this.changeValue})}}const U=class U extends l.Component{constructor(){super(...arguments),this.input=l.createRef(),this.change=(...e)=>h.apply(this,e),this.focus=()=>{var e;return(e=this.input.current)==null||e.focus(),!0},this.serialize=()=>c.serialize.call(this)}render(){return t("div",{children:a("label",{children:[t("div",{children:"Simple markdown contents:"}),t("div",{children:t(Es,{value:this.props.value,onChange:this.change("value"),ref:this.input})})]})})}};U.propTypes={...d},U.widgetName="simple-markdown-tester",U.defaultProps={value:""};let he=U;he.__docgenInfo={description:"",methods:[{name:"change",docblock:null,modifiers:[],params:[{name:"...args",optional:!1,type:null}],returns:null},{name:"focus",docblock:null,modifiers:[],params:[],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:null}],displayName:"SimpleMarkdownTesterEditor",props:{value:{defaultValue:{value:'""',computed:!1},required:!1}},composes:["@khanacademy/perseus"]};const{InfoTip:Ws,NumberInput:ut}=g,Hs=It.widget,E=class E extends l.Component{constructor(){super(...arguments),this.numberOfColumns=l.createRef(),this.focus=()=>{var e;(e=this.numberOfColumns.current)==null||e.focus()},this.onSizeInput=(e,s)=>{let n=+e||0,r=+s||0;n=Math.min(Math.max(1,n),30),r=Math.min(Math.max(1,r),6);const p=this.props.columns,f=this.props.rows,m=this.props.answers;n<=f?m.length=n:i(n-f).times(function(){m.push(G.stringArrayOfSize(p))});function b(Ke){r<=p?Ke.length=r:i(r-p).times(function(){Ke.push("")})}const Fe=this.props.headers;b(Fe),i.each(m,b),this.props.onChange({rows:n,columns:r,answers:m,headers:Fe})},this.serialize=()=>{const e=i.pick(this.props,"headers","rows","columns");return i.extend({},e,{answers:i.map(this.props.answers,i.clone)})}}render(){const e=i.pick(this.props,"headers","answers","onChange","apiOptions");return i.extend(e,{editableHeaders:!0,Editor:v,onFocus:()=>{},onBlur:()=>{},trackInteraction:()=>{}}),a("div",{children:[t("div",{className:"perseus-widget-row",children:a("label",{children:["Number of columns:"," ",t(ut,{ref:this.numberOfColumns,value:this.props.columns,onChange:s=>{s&&this.onSizeInput(this.props.rows,s)},useArrowKeys:!0})]})}),t("div",{className:"perseus-widget-row",children:a("label",{children:["Number of rows:"," ",t(ut,{ref:"numberOfRows",value:this.props.rows,onChange:s=>{s&&this.onSizeInput(s,this.props.columns)},useArrowKeys:!0})]})}),a("div",{children:[" ","Table of answers:"," ",t(Ws,{children:t("p",{children:"The student has to fill out all cells in the table. For partially filled tables create a table using the template, and insert text input boxes as desired."})})]}),t("div",{children:t(Hs,{...e})})]})}};E.propTypes={rows:o.number,columns:o.number,headers:o.arrayOf(o.string),answers:o.arrayOf(o.arrayOf(o.string))},E.widgetName="table",E.defaultProps=function(){const n=i(4).times(function(){return G.stringArrayOfSize(1)});return{headers:[""],rows:4,columns:1,answers:n}}();let de=E;de.__docgenInfo={description:"",methods:[{name:"focus",docblock:null,modifiers:[],params:[],returns:null},{name:"onSizeInput",docblock:null,modifiers:[],params:[{name:"numRawRows",optional:!1,type:null},{name:"numRawColumns",optional:!1,type:null}],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:null}],displayName:"TableEditor",props:{rows:{description:"",type:{name:"number"},required:!1},columns:{description:"",type:{name:"number"},required:!1},headers:{description:"",type:{name:"arrayOf",value:{name:"string"}},required:!1},answers:{description:"",type:{name:"arrayOf",value:{name:"arrayOf",value:{name:"string"}}},required:!1}}};const{InfoTip:_s}=g,$s=/khanacademy\.org\/.*\/v\/(.*)$/;function Bs(u){const e=$s.exec(u);return e?e[1]:u}const W=class W extends l.Component{constructor(){super(...arguments),this._handleUrlChange=e=>{this.props.onChange({location:Bs(e)})},this.change=(...e)=>h.apply(this,e),this.serialize=()=>c.serialize.call(this)}render(){return t("div",{children:a("label",{children:["KA Video Slug:"," ",t(y,{value:this.props.location,style:{width:290},onChange:this._handleUrlChange}),t(_s,{children:"KA video URLs will be converted to just the slug."})]})})}};W.propTypes={...d,location:o.string,onChange:o.func},W.widgetName="video",W.defaultProps={location:""};let ce=W;ce.__docgenInfo={description:"This is the main editor for this widget, to specify all the options.",methods:[{name:"_handleUrlChange",docblock:null,modifiers:[],params:[{name:"url",optional:!1,type:null}],returns:null},{name:"change",docblock:null,modifiers:[],params:[{name:"...args",optional:!1,type:null}],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:null}],displayName:"VideoEditor",props:{location:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1},onChange:{description:"",type:{name:"func"},required:!1}},composes:["@khanacademy/perseus"]};const js=[Ut,J,Wt,Ht,X,Z,_t,$t,w,Q,ee,te,se,jt,Ft,Kt,Gt,Jt,Yt,ne,ae,re,Xt,Zt,ie,oe,le,pe,ue,Qt,he,ts,de,ce,es,Y];class Fs extends l.Component{constructor(){super(...arguments),this.input=l.createRef(),this.focus=()=>{var e;return(e=this.input.current)==null||e.focus(),!0},this.changeValue=e=>{this.props.onChange(e.target.value)}}render(){return t("input",{ref:this.input,value:this.props.value||"",onChange:this.changeValue})}}const be=class be extends l.Component{constructor(){super(...arguments),this.input=l.createRef(),this.change=(...e)=>h.apply(this,e),this.getUserInput=()=>this.props.value,this.focus=()=>{var e;return(e=this.input.current)==null||e.focus(),!0},this.simpleValidate=e=>be.validate(this.getUserInput(),e)}static validate(e,s){return e===""?{type:"invalid",message:"It looks like you haven't answered all of the question yet."}:e===s.correct?{type:"points",earned:1,total:1,message:null}:{type:"points",earned:0,total:1,message:null}}render(){return t(Fs,{ref:this.input,value:this.props.value,onChange:this.change("value")})}};be.defaultProps={value:""};let Ve=be;const Ks={name:"example-widget",displayName:"Example Widget",defaultAlignment:"inline-block",hidden:!0,widget:Ve},Gs=dt.parse,Js=dt.basicOutput,we=class we extends l.Component{constructor(){super(...arguments),this.change=(...e)=>h.apply(this,e),this.toJSON=()=>({}),this.focus=()=>(this.refs.input.focus(),!0),this.simpleValidate=e=>we.validate(this.toJSON(),e)}static validate(e,s){return{type:"points",earned:0,total:0,message:null}}render(){const e=Gs(this.props.value),s=Js(e);return t("div",{children:s})}};we.defaultProps={value:""};let ze=we;const Ys={name:"simple-markdown-tester",displayName:"Simple Markdown Tester",hidden:!0,widget:ze,transform:i.identity},Xs=[vt,Ks,Ys],Zs=[...Nt,...Xs],ha=()=>{Ot(Zs),Pt(js),At(),Rt()},Qs=Mt({displayName:"JsonEditor",getInitialState:function(){return{currentValue:JSON.stringify(this.props.value,null,4),valid:!0}},UNSAFE_componentWillReceiveProps:function(u){(!this.state.valid||!i.isEqual(u.value,JSON.parse(this.state.currentValue)))&&this.setState(this.getInitialState())},render:function(){const u="perseus-json-editor "+(this.state.valid?"valid":"invalid");return t("textarea",{className:u,value:this.state.currentValue,onChange:this.handleChange,onKeyDown:this.handleKeyDown,onBlur:this.handleBlur})},handleKeyDown:function(u){if(u.key==="Tab"){const e=u.target.selectionStart,s=u.target.value,n=s.substring(0,e),r=s.substring(e,s.length);u.target.value=n+"    "+r,u.target.selectionStart=n.length+4,u.target.selectionEnd=n.length+4,u.preventDefault(),this.handleChange(u)}},handleChange:function(u){const e=u.target.value;try{let s=JSON.parse(e);i.isString(s)&&(s=JSON.parse(s)),this.setState({currentValue:e,valid:!0},function(){this.props.onChange(s)})}catch{this.setState({currentValue:e,valid:!1})}},handleBlur:function(u){const e=u.target.value;try{let s=JSON.parse(e);i.isString(s)&&(s=JSON.parse(s)),this.setState({currentValue:JSON.stringify(s,null,4),valid:!0},function(){this.props.onChange(s)})}catch{this.setState({currentValue:JSON.stringify(this.props.value,null,4),valid:!0})}}});let ht=0;const Le={},Me={};window.iframeDataStore={};window.addEventListener("message",u=>{if(typeof u.data=="string"){const e=Le[u.data];e&&e()}else u.data.id&&(u.data.height!==void 0?Me[u.data.id](u.data.height):u.data.lintWarnings&&ct.log("LINTER REPORT",{lintWarnings:JSON.stringify(u.data.lintWarnings)}))});class Ee extends l.Component{constructor(){super(...arguments),this.container=l.createRef()}componentDidMount(){this._isMounted=!0,this.iframeID=ht,ht++,this._prepareFrame(),Le[this.iframeID]=()=>{this.sendNewData(this._lastData)},Me[this.iframeID]=e=>{this._lastHeight=e,this._isMounted&&this.props.seamless&&this.container.current&&(this.container.current.style.height=e+"px")}}shouldComponentUpdate(e){return e.datasetValue!==this.props.datasetValue||e.seamless!==this.props.seamless}componentDidUpdate(e){this.container.current&&(this.props.seamless?this.container.current.style.height=this._lastHeight+"px":this.container.current.style.height="100%"),e.datasetValue!==this.props.datasetValue&&this._prepareFrame()}componentWillUnmount(){Le[this.iframeID]=null,Me[this.iframeID]=null,this._isMounted=!1}_prepareFrame(){var s,n;this._frame&&((s=this.container.current)==null||s.removeChild(this._frame));const e=document.createElement("iframe");e.style.width="100%",e.style.height="100%",e.src=this.props.url,this.props.datasetKey&&(e.dataset[this.props.datasetKey]=this.props.datasetValue),e.dataset.id=String(this.iframeID),this.props.seamless&&(e.dataset.lintGutter="true"),(n=this.container.current)==null||n.appendChild(e),this._frame=e}sendNewData(e){const s=this._frame;this._isMounted&&e&&(s!=null&&s.contentWindow)&&(this._lastData=e,window.iframeDataStore[this.iframeID]=e,s.contentWindow.postMessage(this.iframeID,"*"))}render(){return t("div",{ref:this.container,style:{width:"100%",height:"100%"}})}}Ee.__docgenInfo={description:"",methods:[{name:"_prepareFrame",docblock:null,modifiers:[],params:[],returns:null},{name:"sendNewData",docblock:null,modifiers:[],params:[{name:"data",optional:!1,type:{name:"any"}}],returns:null}],displayName:"IframeContentRenderer",props:{url:{required:!0,tsType:{name:"string"},description:""},datasetKey:{required:!0,tsType:{name:"string"},description:""},datasetValue:{required:!0,tsType:{name:"any"},description:""},seamless:{required:!0,tsType:{name:"boolean"},description:""}}};const{InfoTip:en,InlineIcon:K}=g,{iconCircleArrowDown:tn,iconCircleArrowUp:sn,iconPlus:nn,iconTrash:an}=gt,_e=class _e extends l.Component{constructor(){super(...arguments),this.editor=l.createRef(),this.handleChange=e=>{this.props.onChange({replace:e.target.checked})},this.focus=()=>{var e;(e=this.editor.current)==null||e.focus()},this.getSaveWarnings=()=>{var e;return(e=this.editor.current)==null?void 0:e.getSaveWarnings()},this.serialize=e=>{var s;return(s=this.editor.current)==null?void 0:s.serialize(e)}}render(){return a("div",{className:"perseus-hint-editor "+this.props.className,children:[this.props.showTitle&&t("div",{className:"pod-title",children:"Hint"}),t(v,{ref:this.editor,apiOptions:this.props.apiOptions,widgets:this.props.widgets||void 0,content:this.props.content||void 0,images:this.props.images,replace:this.props.replace,placeholder:"Type your hint here...",imageUploader:this.props.imageUploader,onChange:this.props.onChange},this.props.itemId),a("div",{className:"hint-controls-container clearfix",children:[this.props.showMoveButtons&&a("span",{className:"reorder-hints",children:[t("button",{type:"button",className:this.props.isLast?"hidden":"",onClick:i.partial(this.props.onMove,1),children:t(K,{...tn})})," ",t("button",{type:"button",className:this.props.isFirst?"hidden":"",onClick:i.partial(this.props.onMove,-1),children:t(K,{...sn})})," ",this.props.isLast&&t(en,{children:t("p",{children:"The last hint is automatically bolded."})})]}),t("input",{type:"checkbox",checked:this.props.replace,onChange:this.handleChange}),"Replace previous hint",this.props.showRemoveButton&&a("button",{type:"button",className:"remove-hint simple-button orange",onClick:this.props.onRemove,children:[t(K,{...an}),"Remove this hint"," "]})]})]})}};_e.defaultProps={className:"",content:"",replace:!1,showMoveButtons:!0,showTitle:!0,showRemoveButton:!0};let H=_e;const $e=class $e extends l.Component{constructor(){super(...arguments),this.editor=l.createRef(),this.frame=l.createRef(),this.updatePreview=()=>{var s;const e=this.props.isLast&&!/\*\*/.test(this.props.hint.content);(s=this.frame.current)==null||s.sendNewData({type:"hint",data:{hint:this.props.hint,bold:e,pos:this.props.pos,apiOptions:this.props.apiOptions,linterContext:{contentType:"hint",highlightLint:this.props.highlightLint,paths:this.props.contentPaths}}})},this.getSaveWarnings=()=>{var e;return(e=this.editor.current)==null?void 0:e.getSaveWarnings()},this.serialize=e=>{var s;return(s=this.editor.current)==null?void 0:s.serialize(e)},this.focus=()=>{var e;(e=this.editor.current)==null||e.focus()}}componentDidMount(){this.updatePreview()}componentDidUpdate(){this.updatePreview()}render(){const e=this.props.deviceType==="phone"||this.props.deviceType==="tablet";return a("div",{className:"perseus-combined-hint-editor perseus-editor-row",children:[t("div",{className:"perseus-editor-left-cell",children:t(H,{ref:this.editor,itemId:this.props.itemId,isFirst:this.props.isFirst,isLast:this.props.isLast,widgets:this.props.hint.widgets,content:this.props.hint.content,images:this.props.hint.images,replace:this.props.hint.replace,imageUploader:this.props.imageUploader,onChange:this.props.onChange,onRemove:this.props.onRemove,onMove:this.props.onMove,apiOptions:this.props.apiOptions})}),t("div",{className:"perseus-editor-right-cell",children:t(ft,{deviceType:this.props.deviceType,nochrome:!0,children:t(Ee,{ref:this.frame,datasetKey:"mobile",datasetValue:e,seamless:!0,url:this.props.previewURL})})})]})}};$e.defaultProps={highlightLint:!1};let De=$e;const Ce=class Ce extends l.Component{constructor(){super(...arguments),this.handleHintChange=(e,s,n,r)=>{const p=i(this.props.hints).clone();p[e]=i.extend({},this.serializeHint(e,{keepDeletedWidgets:!0}),s),this.props.onChange({hints:p},n,r)},this.handleHintRemove=e=>{if(!confirm("Are you sure you want to delete this hint?"))return;const s=i(this.props.hints).clone();s.splice(e,1),this.props.onChange({hints:s})},this.handleHintMove=(e,s)=>{const n=i(this.props.hints).clone(),r=n.splice(e,1)[0];n.splice(e+s,0,r),this.props.onChange({hints:n},()=>{this.refs["hintEditor"+(e+s)].focus()})},this.addHint=()=>{const e=i(this.props.hints).clone().concat([{content:""}]);this.props.onChange({hints:e},()=>{const s=e.length-1;this.refs["hintEditor"+s].focus()})},this.getSaveWarnings=()=>i.chain(this.props.hints).map((e,s)=>i.map(this.refs["hintEditor"+s].getSaveWarnings(),n=>"Hint "+(s+1)+": "+n)).flatten(!0).value(),this.serialize=e=>this.props.hints.map((s,n)=>this.serializeHint(n,e)),this.serializeHint=(e,s)=>this.refs["hintEditor"+e].serialize(s)}render(){const{itemId:e,hints:s}=this.props,n=i.map(s,function(r,p){return t(De,{ref:"hintEditor"+p,isFirst:p===0,isLast:p+1===s.length,itemId:e,hint:r,pos:p,imageUploader:this.props.imageUploader,onChange:this.handleHintChange.bind(this,p),onRemove:this.handleHintRemove.bind(this,p),onMove:this.handleHintMove.bind(this,p),deviceType:this.props.deviceType,apiOptions:this.props.apiOptions,highlightLint:this.props.highlightLint,previewURL:this.props.previewURL,contentPaths:[]},"hintEditor"+p)},this);return a("div",{className:"perseus-hints-editor perseus-editor-table",children:[n,t("div",{className:"perseus-editor-row",children:t("div",{className:"add-hint-container perseus-editor-left-cell",children:a("button",{type:"button",className:"add-hint simple-button orange",onClick:this.addHint,children:[t(K,{...nn})," Add a hint"]})})})]})}};Ce.HintEditor=H,Ce.defaultProps={onChange:()=>{},hints:[],highlightLint:!1};let me=Ce;H.__docgenInfo={description:"",methods:[{name:"handleChange",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:{name:"ReactChangeEvent",raw:"React.ChangeEvent<HTMLInputElement>",elements:[{name:"HTMLInputElement"}],alias:"React.ChangeEvent"}}],returns:null},{name:"focus",docblock:null,modifiers:[],params:[],returns:null},{name:"getSaveWarnings",docblock:null,modifiers:[],params:[],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[{name:"options",optional:!1,type:{name:"any"}}],returns:null}],displayName:"HintEditor",props:{itemId:{required:!1,tsType:{name:"string"},description:""},apiOptions:{required:!1,tsType:{name:"APIOptions"},description:""},className:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'""',computed:!1}},imageUploader:{required:!1,tsType:{name:"signature",type:"function",raw:`(
    file: string,
    callback: (url: string) => unknown,
) => unknown`,signature:{arguments:[{type:{name:"string"},name:"file"},{type:{name:"signature",type:"function",raw:"(url: string) => unknown",signature:{arguments:[{type:{name:"string"},name:"url"}],return:{name:"unknown"}}},name:"callback"}],return:{name:"unknown"}}},description:""},showMoveButtons:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},showRemoveButton:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},showTitle:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},content:{required:!1,tsType:{name:"union",raw:"string | null | undefined",elements:[{name:"string"},{name:"null"},{name:"undefined"}]},description:"",defaultValue:{value:'""',computed:!1}},replace:{required:!1,tsType:{name:"union",raw:"boolean | null | undefined",elements:[{name:"boolean"},{name:"null"},{name:"undefined"}]},description:"",defaultValue:{value:"false",computed:!1}},widgets:{required:!1,tsType:{name:"union",raw:"WidgetDict | null | undefined",elements:[{name:"WidgetDict"},{name:"null"},{name:"undefined"}]},description:""},images:{required:!1,tsType:{name:"union",raw:"ImageDict | null | undefined",elements:[{name:"ImageDict"},{name:"null"},{name:"undefined"}]},description:""},isLast:{required:!0,tsType:{name:"boolean"},description:""},isFirst:{required:!0,tsType:{name:"boolean"},description:""},onMove:{required:!0,tsType:{name:"signature",type:"function",raw:"(direction: number) => unknown",signature:{arguments:[{type:{name:"number"},name:"direction"}],return:{name:"unknown"}}},description:""},onRemove:{required:!0,tsType:{name:"signature",type:"function",raw:"() => unknown",signature:{arguments:[],return:{name:"unknown"}}},description:""},onChange:{required:!0,tsType:{name:"ChangeHandler"},description:""},__type:{required:!1,tsType:{name:"literal",value:'"hint"'},description:""}}};me.__docgenInfo={description:"",methods:[{name:"handleHintChange",docblock:null,modifiers:[],params:[{name:"i",optional:!1,type:{name:"number"}},{name:"newProps",optional:!1,type:{name:"signature",type:"object",raw:`{
    apiOptions?: APIOptions;
    deviceType: DeviceType;
    imageUploader?: ImageUploader;
    highlightLint?: boolean;
    hints: ReadonlyArray<Hint>;
    // URL of the route to show on initial load of the preview frames.
    previewURL: string;
    onChange: ChangeHandler;
    // The content ID of the AssessmentItem being edited. It may not be set
    // for non-content library exercise questions.
    itemId?: string;
}`,signature:{properties:[{key:"apiOptions",value:{name:"APIOptions",required:!1}},{key:"deviceType",value:{name:"DeviceType",required:!0}},{key:"imageUploader",value:{name:"signature",type:"function",raw:`(
    file: string,
    callback: (url: string) => unknown,
) => unknown`,signature:{arguments:[{type:{name:"string"},name:"file"},{type:{name:"signature",type:"function",raw:"(url: string) => unknown",signature:{arguments:[{type:{name:"string"},name:"url"}],return:{name:"unknown"}}},name:"callback"}],return:{name:"unknown"}},required:!1}},{key:"highlightLint",value:{name:"boolean",required:!1}},{key:"hints",value:{name:"ReadonlyArray",elements:[{name:"Hint"}],raw:"ReadonlyArray<Hint>",required:!0}},{key:"previewURL",value:{name:"string",required:!0}},{key:"onChange",value:{name:"ChangeHandler",required:!0}},{key:"itemId",value:{name:"string",required:!1}}]},alias:"CombinedHintsEditorProps"}},{name:"cb",optional:!1,type:{name:"signature",type:"function",raw:"() => unknown",signature:{arguments:[],return:{name:"unknown"}}}},{name:"silent",optional:!1,type:{name:"boolean"}}],returns:null},{name:"handleHintRemove",docblock:null,modifiers:[],params:[{name:"i",optional:!1,type:{name:"number"}}],returns:null},{name:"handleHintMove",docblock:null,modifiers:[],params:[{name:"i",optional:!1,type:{name:"number"}},{name:"dir",optional:!1,type:{name:"number"}}],returns:null},{name:"addHint",docblock:null,modifiers:[],params:[],returns:null},{name:"getSaveWarnings",docblock:null,modifiers:[],params:[],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[{name:"options",optional:!1,type:{name:"any"}}],returns:null},{name:"serializeHint",docblock:null,modifiers:[],params:[{name:"index",optional:!1,type:{name:"number"}},{name:"options",optional:!1,type:{name:"any"}}],returns:{type:{name:"string"}}}],displayName:"CombinedHintsEditor",props:{apiOptions:{required:!1,tsType:{name:"APIOptions"},description:""},deviceType:{required:!0,tsType:{name:"DeviceType"},description:""},imageUploader:{required:!1,tsType:{name:"signature",type:"function",raw:`(
    file: string,
    callback: (url: string) => unknown,
) => unknown`,signature:{arguments:[{type:{name:"string"},name:"file"},{type:{name:"signature",type:"function",raw:"(url: string) => unknown",signature:{arguments:[{type:{name:"string"},name:"url"}],return:{name:"unknown"}}},name:"callback"}],return:{name:"unknown"}}},description:""},highlightLint:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},hints:{required:!1,tsType:{name:"ReadonlyArray",elements:[{name:"Hint"}],raw:"ReadonlyArray<Hint>"},description:"",defaultValue:{value:"[]",computed:!1}},previewURL:{required:!0,tsType:{name:"string"},description:""},onChange:{required:!1,tsType:{name:"ChangeHandler"},description:"",defaultValue:{value:"() => {}",computed:!1}},itemId:{required:!1,tsType:{name:"string"},description:""}}};const rn=zt,Be=class Be extends l.Component{constructor(){super(...arguments),this.frame=l.createRef(),this.questionEditor=l.createRef(),this.itemExtrasEditor=l.createRef(),this.updateProps=(e,s,n)=>{const r=i(this.props).pick("question","answerArea");this.props.onChange(i(r).extend(e),s,n)},this.triggerPreviewUpdate=e=>{var s;(s=this.frame.current)==null||s.sendNewData(e)},this.handleEditorChange=(e,s,n)=>{const r=i.extend({},this.props.question,e);this.updateProps({question:r},s,n)},this.handleItemExtrasChange=(e,s,n)=>{const r=i.extend({},this.props.answerArea,e);this.updateProps({answerArea:r},s,n)},this.getSaveWarnings=()=>{var e;return(e=this.questionEditor.current)==null?void 0:e.getSaveWarnings()},this.serialize=e=>{var s,n;return{question:(s=this.questionEditor.current)==null?void 0:s.serialize(e),answerArea:(n=this.itemExtrasEditor.current)==null?void 0:n.serialize(),itemDataVersion:rn}}}render(){const e=this.props.deviceType==="phone"||this.props.deviceType==="tablet";return a("div",{className:"perseus-editor-table",children:[a("div",{className:"perseus-editor-row perseus-question-container",children:[a("div",{className:"perseus-editor-left-cell",children:[t("div",{className:"pod-title",children:"Question"}),t(v,{ref:this.questionEditor,placeholder:"Type your question here...",className:"perseus-question-editor",imageUploader:this.props.imageUploader,onChange:this.handleEditorChange,apiOptions:this.props.apiOptions,showWordCount:!0,...this.props.question},this.props.itemId)]}),t("div",{className:"perseus-editor-right-cell",children:a("div",{id:"problemarea",children:[t(ft,{deviceType:this.props.deviceType,nochrome:!0,children:t(Ee,{ref:this.frame,datasetKey:"mobile",datasetValue:e,seamless:!0,url:this.props.previewURL},this.props.deviceType)}),t("div",{id:"hintsarea",className:"hintsarea",style:{display:"none"}})]})})]}),a("div",{className:"perseus-editor-row perseus-answer-container",children:[a("div",{className:"perseus-editor-left-cell",children:[t("div",{className:"pod-title",children:"Question extras"}),t(ns,{ref:this.itemExtrasEditor,onChange:this.handleItemExtrasChange,...this.props.answerArea})]}),t("div",{className:"perseus-editor-right-cell",children:t("div",{id:"answer_area"})})]})]})}};Be.defaultProps={onChange:()=>{},question:{},answerArea:{}};let ge=Be;ge.__docgenInfo={description:"",methods:[{name:"updateProps",docblock:null,modifiers:[],params:[{name:"newProps",optional:!1,type:null},{name:"cb",optional:!1,type:null},{name:"silent",optional:!1,type:null}],returns:null},{name:"triggerPreviewUpdate",docblock:null,modifiers:[],params:[{name:"newData",optional:!1,type:{name:"any"}}],returns:null},{name:"handleEditorChange",docblock:null,modifiers:[],params:[{name:"newProps",optional:!1,type:null},{name:"cb",optional:!1,type:null},{name:"silent",optional:!1,type:null}],returns:null},{name:"handleItemExtrasChange",docblock:null,modifiers:[],params:[{name:"newProps",optional:!1,type:null},{name:"cb",optional:!1,type:null},{name:"silent",optional:!1,type:null}],returns:null},{name:"getSaveWarnings",docblock:null,modifiers:[],params:[],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[{name:"options",optional:!1,type:{name:"any"}}],returns:null}],displayName:"ItemEditor",props:{apiOptions:{required:!1,tsType:{name:"APIOptions"},description:""},deviceType:{required:!1,tsType:{name:"DeviceType"},description:""},gradeMessage:{required:!1,tsType:{name:"string"},description:""},imageUploader:{required:!1,tsType:{name:"ImageUploader"},description:""},wasAnswered:{required:!1,tsType:{name:"boolean"},description:""},question:{required:!1,tsType:{name:"any"},description:"",defaultValue:{value:"{}",computed:!1}},answerArea:{required:!1,tsType:{name:"any"},description:"",defaultValue:{value:"{}",computed:!1}},previewURL:{required:!0,tsType:{name:"string"},description:""},onChange:{required:!1,tsType:{name:"ChangeHandler"},description:"",defaultValue:{value:"() => {}",computed:!1}},itemId:{required:!1,tsType:{name:"string"},description:""}}};const{HUD:on}=g,je=class je extends l.Component{constructor(e){super(e),this.itemEditor=l.createRef(),this.hintsEditor=l.createRef(),this.toggleJsonMode=()=>{this.setState({json:this.serialize({keepDeletedWidgets:!0})},()=>{this.props.onChange({jsonMode:!this.props.jsonMode})})},this.handleChange=(s,n,r)=>{const p=i(this.props).pick("question","hints","answerArea");i(p).extend(s),this.props.onChange(p,n,r)},this.changeJSON=s=>{this.setState({json:s}),this.props.onChange(s)},this.state={json:i.pick(this.props,"question","answerArea","hints","itemDataVersion"),gradeMessage:"",wasAnswered:!1,highlightLint:!0},this._isMounted=!1}componentDidMount(){this._isMounted=!0,this.updateRenderer()}componentDidUpdate(){setTimeout(()=>{this.updateRenderer()})}componentWillUnmount(){this._isMounted=!1}updateRenderer(){var r,p;const e=!this.props.developerMode||!this.props.jsonMode;if(!this._isMounted||!e)return;const s=this.props.previewDevice==="phone"||this.props.previewDevice==="tablet",n={...this.getApiOptions(),customKeypad:s,isMobile:s};(p=this.itemEditor.current)==null||p.triggerPreviewUpdate({type:"question",data:i({item:this.serialize(),apiOptions:n,initialHintsVisible:0,device:this.props.previewDevice,linterContext:{contentType:"exercise",highlightLint:this.state.highlightLint,paths:this.props.contentPaths||[]},reviewMode:!0,legacyPerseusLint:(r=this.itemEditor.current)==null?void 0:r.getSaveWarnings()}).extend(i(this.props).pick("workAreaSelector","solutionAreaSelector","hintsAreaSelector","problemNum"))})}getApiOptions(){return{...Te.defaults,...this.props.apiOptions}}getSaveWarnings(){var n,r;const e=(n=this.itemEditor.current)==null?void 0:n.getSaveWarnings(),s=(r=this.hintsEditor.current)==null?void 0:r.getSaveWarnings();return e.concat(s)}serialize(e){var s,n;return this.props.jsonMode?this.state.json:i.extend((s=this.itemEditor.current)==null?void 0:s.serialize(e),{hints:(n=this.hintsEditor.current)==null?void 0:n.serialize(e)})}scorePreview(){return this.renderer?this.renderer.scoreInput():null}render(){let e="framework-perseus";const s=this.props.previewDevice==="phone"||this.props.previewDevice==="tablet",n={...this.getApiOptions(),customKeypad:s,isMobile:s};return n.isMobile&&(e+=" "+Vt.MOBILE),a("div",{id:"perseus",className:e,children:[a("div",{style:{marginBottom:10},children:[this.props.developerMode&&a("span",{children:[a("label",{children:[" ","Developer JSON Mode:"," ",t("input",{type:"checkbox",checked:this.props.jsonMode,onChange:this.toggleJsonMode})]})," "]}),!this.props.jsonMode&&t(ss,{deviceType:this.props.previewDevice,onViewportSizeChanged:this.props.onPreviewDeviceChange}),!this.props.jsonMode&&t(on,{message:"Style warnings",enabled:this.state.highlightLint,onClick:()=>{this.setState({highlightLint:!this.state.highlightLint})}})]}),this.props.developerMode&&this.props.jsonMode&&t("div",{children:t(Qs,{multiLine:!0,value:this.state.json,onChange:this.changeJSON})}),(!this.props.developerMode||!this.props.jsonMode)&&t(ge,{ref:this.itemEditor,itemId:this.props.itemId,question:this.props.question,answerArea:this.props.answerArea,imageUploader:this.props.imageUploader,onChange:this.handleChange,wasAnswered:this.state.wasAnswered,gradeMessage:this.state.gradeMessage,deviceType:this.props.previewDevice,apiOptions:n,previewURL:this.props.previewURL}),(!this.props.developerMode||!this.props.jsonMode)&&t(me,{ref:this.hintsEditor,itemId:this.props.itemId,hints:this.props.hints,imageUploader:this.props.imageUploader,onChange:this.handleChange,deviceType:this.props.previewDevice,apiOptions:n,previewURL:this.props.previewURL,highlightLint:this.state.highlightLint})]})}};je.defaultProps={developerMode:!1,jsonMode:!1,onChange:()=>{}};let Ue=je;Ue.__docgenInfo={description:"",methods:[{name:"toggleJsonMode",docblock:null,modifiers:[],params:[],returns:null},{name:"updateRenderer",docblock:null,modifiers:[],params:[],returns:null},{name:"getApiOptions",docblock:null,modifiers:[],params:[],returns:{type:{name:"APIOptionsWithDefaults"}}},{name:"getSaveWarnings",docblock:null,modifiers:[],params:[],returns:{type:{name:"any"}}},{name:"serialize",docblock:null,modifiers:[],params:[{name:"options",optional:!0,type:{name:"signature",type:"object",raw:"{keepDeletedWidgets?: boolean}",signature:{properties:[{key:"keepDeletedWidgets",value:{name:"boolean",required:!1}}]}}}],returns:{type:{name:"union",raw:"any | PerseusItem",elements:[{name:"any"},{name:"PerseusItem"}]}}},{name:"handleChange",docblock:null,modifiers:[],params:[{name:"toChange",optional:!1,type:null},{name:"cb",optional:!1,type:null},{name:"silent",optional:!1,type:null}],returns:null},{name:"changeJSON",docblock:null,modifiers:[],params:[{name:"newJson",optional:!1,type:{name:"PerseusItem",alias:"PerseusItem"}}],returns:null},{name:"scorePreview",docblock:null,modifiers:[],params:[],returns:{type:{name:"union",raw:"KEScore | null | undefined",elements:[{name:"KEScore"},{name:"null"},{name:"undefined"}]}}}],displayName:"EditorPage",props:{apiOptions:{required:!1,tsType:{name:"APIOptions"},description:""},answerArea:{required:!1,tsType:{name:"any"},description:""},contentPaths:{required:!1,tsType:{name:"ReadonlyArray",elements:[{name:"string"}],raw:"ReadonlyArray<string>"},description:""},developerMode:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},frameSource:{required:!0,tsType:{name:"string"},description:""},hints:{required:!1,tsType:{name:"ReadonlyArray",elements:[{name:"Hint"}],raw:"ReadonlyArray<Hint>"},description:""},imageUploader:{required:!1,tsType:{name:"ImageUploader"},description:""},itemDataVersion:{required:!1,tsType:{name:"Version"},description:""},itemId:{required:!0,tsType:{name:"string"},description:""},jsonMode:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},onChange:{required:!1,tsType:{name:"ChangeHandler"},description:"",defaultValue:{value:"() => {}",computed:!1}},onPreviewDeviceChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(arg1: DeviceType) => unknown",signature:{arguments:[{type:{name:"DeviceType"},name:"arg1"}],return:{name:"unknown"}}},description:""},previewDevice:{required:!0,tsType:{name:"DeviceType"},description:""},question:{required:!1,tsType:{name:"any"},description:""},previewURL:{required:!0,tsType:{name:"string"},description:""}}};export{Zs as A,Ue as E,H,Ee as I,Qs as J,js as a,ha as r};
