import{V as c,_ as k,I as N}from"./index-_3CKOwHy.js";import{r as n}from"./index-6oxdNXpR.js";import{m as A,c as R,u as I,a as _,T as H,I as U,x as z}from"./index-ZdJtI3z8.js";import{c as p,b as L,s as d}from"./index-QHkT31Yt.js";import{n as x}from"./no-important-xCWWYXQR.js";import{c as W,b as V}from"./index-4dAUYsag.js";import{r as y}from"./index-9gkyvru-.js";import{w as Y}from"./index-OQMtW1Q1.js";import{M as K}from"./index-o999uk82.js";const F={color:{bg:{inverse:p.darkBlue},text:{inverse:p.white,secondary:p.offBlack64},shadow:{default:p.offBlack16}},border:{radius:L.radius.medium_4,width:L.width.thin,color:p.blue},spacing:{dialog:{small:d.medium_16},panel:{closeButton:d.medium_16,footer:d.xLarge_32},header:{xsmall:d.xSmall_8,small:d.medium_16,medium:d.large_24,large:d.xLarge_32}}},j=A(F,{color:{bg:{inverse:p.eggplant}}}),G={default:F,khanmigo:j},w=R(F);function q(t){const e=n.useContext(H),o=G[e]||F;return n.createElement(w.Provider,{value:o},t.children)}const J=n.forwardRef(function(e,o){const{above:s,below:l,role:r="dialog",style:h,children:f,testId:i,"aria-labelledby":b,"aria-describedby":u}=e,{theme:M}=I(w),m=_(X,M);return n.createElement(c,{style:[m.wrapper,h]},l&&n.createElement(c,{style:m.below},l),n.createElement(c,{role:r,"aria-modal":"true","aria-labelledby":b,"aria-describedby":u,ref:o,style:m.dialog,testId:i},f),s&&n.createElement(c,{style:m.above},s))}),P=n.forwardRef(function(e,o){return n.createElement(q,null,n.createElement(J,k({},e,{ref:o})))}),Q="@media (max-width: 767px)",X=t=>({wrapper:{display:"flex",flexDirection:"row",alignItems:"stretch",width:"100%",height:"100%",position:"relative",[Q]:{padding:t.spacing.dialog.small,flexDirection:"column"}},dialog:{width:"100%",height:"100%",borderRadius:t.border.radius,overflow:"hidden"},above:{pointerEvents:"none",position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:1},below:{pointerEvents:"none",position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:-1}});P.displayName="ModalDialog";function C({children:t}){return n.createElement(c,{style:Z.footer},t)}C.__IS_MODAL_FOOTER__=!0;C.isComponentOf=t=>t&&t.type&&t.type.__IS_MODAL_FOOTER__;const Z=x.StyleSheet.create({footer:{flex:"0 0 auto",boxSizing:"border-box",minHeight:d.xxxLarge_64,paddingLeft:d.medium_16,paddingRight:d.medium_16,paddingTop:d.xSmall_8,paddingBottom:d.xSmall_8,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",boxShadow:`0px -1px 0px ${p.offBlack16}`}});function v(t){const{breadcrumbs:e=void 0,light:o,subtitle:s=void 0,testId:l,title:r,titleId:h}=t;if(s&&e)throw new Error("'subtitle' and 'breadcrumbs' can't be used together");const{theme:f}=I(w),i=_(ee,f);return n.createElement(c,{style:[i.header,!o&&i.dark],testId:l},e&&n.createElement(c,{style:i.breadcrumbs},e),n.createElement(W,{tag:"h2",style:i.title,id:h,testId:l&&`${l}-title`},r),s&&n.createElement(V,{style:o&&i.subtitle,testId:l&&`${l}-subtitle`},s))}const T="@media (max-width: 767px)",ee=t=>({header:{boxShadow:`0px 1px 0px ${t.color.shadow.default}`,display:"flex",flexDirection:"column",minHeight:66,padding:`${t.spacing.header.medium}px ${t.spacing.header.large}px`,position:"relative",width:"100%",[T]:{paddingLeft:t.spacing.header.small,paddingRight:t.spacing.header.small}},dark:{background:t.color.bg.inverse,color:t.color.text.inverse},breadcrumbs:{color:t.color.text.secondary,marginBottom:t.spacing.header.xsmall},title:{paddingRight:t.spacing.header.small,[T]:{paddingRight:t.spacing.header.large}},subtitle:{color:t.color.text.secondary,marginTop:t.spacing.header.xsmall}});v.defaultProps={light:!0};const te='button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])';class oe extends n.Component{constructor(...e){super(...e),this.modalRoot=void 0,this.getModalRoot=o=>{if(!o)return;const s=y.findDOMNode(o);if(!s)throw new Error("Assertion error: modal root should exist after mount");this.modalRoot=s},this.handleFocusMoveToLast=()=>{this.focusElementIn(!1)},this.handleFocusMoveToFirst=()=>{this.focusElementIn(!0)}}tryToFocus(e){if(e instanceof HTMLElement){try{e.focus()}catch{}return document.activeElement===e}}focusElementIn(e){const o=this.modalRoot,s=Array.from(o.querySelectorAll(te)),l=e?0:s.length-1,r=s[l];this.tryToFocus(r)}render(){const{style:e}=this.props;return n.createElement(n.Fragment,null,n.createElement("div",{tabIndex:0,className:"modal-focus-trap-first",onFocus:this.handleFocusMoveToLast,style:{position:"fixed"}}),n.createElement(c,{style:e,ref:this.getModalRoot},this.props.children),n.createElement("div",{tabIndex:0,className:"modal-focus-trap-last",onFocus:this.handleFocusMoveToFirst,style:{position:"fixed"}}))}}const B="data-modal-launcher-portal",ne="a[href], details, input, textarea, select, button";function se(t){return Array.from(t.querySelectorAll(ne))}class le extends n.Component{constructor(...e){super(...e),this._mousePressedOutside=!1,this.handleMouseDown=o=>{this._mousePressedOutside=o.target===o.currentTarget},this.handleMouseUp=o=>{o.target===o.currentTarget&&this._mousePressedOutside&&this.props.onCloseModal(),this._mousePressedOutside=!1}}componentDidMount(){const e=y.findDOMNode(this);if(!e)return;const o=this._getInitialFocusElement(e)||this._getFirstFocusableElement(e)||this._getDialogElement(e);setTimeout(()=>{o.focus()},0)}_getInitialFocusElement(e){const{initialFocusId:o}=this.props;return o?y.findDOMNode(e.querySelector(`#${o}`)):null}_getFirstFocusableElement(e){const o=se(e);return o?o[0]:null}_getDialogElement(e){const o=y.findDOMNode(e.querySelector('[role="dialog"]'));return o.tabIndex=-1,o}render(){const{children:e,testId:o}=this.props,s={[B]:!0};return n.createElement(c,k({style:re.modalPositioner,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,testId:o},s),e)}}const re=x.StyleSheet.create({modalPositioner:{position:"fixed",left:0,top:0,width:"100%",height:"100%",alignItems:"center",justifyContent:"center",overflow:"auto",background:p.offBlack64}}),O=(()=>{if(typeof window>"u")return!1;const t=window.navigator.userAgent;return t.indexOf("iPad")>-1||t.indexOf("iPhone")>-1})();class a extends n.Component{componentDidMount(){if(a.numModalsOpened===0){const e=document.body;if(!e)throw new Error("couldn't find document.body");a.oldOverflow=e.style.overflow,a.oldScrollY=window.scrollY,O&&(a.oldPosition=e.style.position,a.oldWidth=e.style.width,a.oldTop=e.style.top),e.style.overflow="hidden",O&&(e.style.position="fixed",e.style.width="100%",e.style.top=`${-a.oldScrollY}px`)}a.numModalsOpened++}componentWillUnmount(){if(a.numModalsOpened--,a.numModalsOpened===0){const e=document.body;if(!e)throw new Error("couldn't find document.body");e.style.overflow=a.oldOverflow,O&&(e.style.position=a.oldPosition,e.style.width=a.oldWidth,e.style.top=a.oldTop),typeof window<"u"&&window.scrollTo&&window.scrollTo(0,a.oldScrollY)}}render(){return null}}a.oldOverflow=void 0;a.oldPosition=void 0;a.oldScrollY=void 0;a.oldWidth=void 0;a.oldTop=void 0;a.numModalsOpened=0;const ae={closeModal:void 0},S=n.createContext(ae);S.displayName="ModalContext";class D extends n.Component{constructor(...e){super(...e),this.lastElementFocusedOutsideModal=void 0,this.state={opened:!1},this._saveLastElementFocused=()=>{this.lastElementFocusedOutsideModal=document.activeElement},this._openModal=()=>{this._saveLastElementFocused(),this.setState({opened:!0})},this._returnFocus=()=>{const{closedFocusId:o,schedule:s}=this.props,l=this.lastElementFocusedOutsideModal;if(o){const r=y.findDOMNode(document.getElementById(o));if(r){s.animationFrame(()=>{r.focus()});return}}l!=null&&s.animationFrame(()=>{l.focus()})},this.handleCloseModal=()=>{this.setState({opened:!1},()=>{const{onClose:o}=this.props;o==null||o(),this._returnFocus()})}}static getDerivedStateFromProps(e,o){return typeof e.opened=="boolean"&&e.children&&console.warn("'children' and 'opened' can't be used together"),typeof e.opened=="boolean"&&!e.onClose&&console.warn("'onClose' should be used with 'opened'"),typeof e.opened!="boolean"&&!e.children&&console.warn("either 'children' or 'opened' must be set"),{opened:typeof e.opened=="boolean"?e.opened:o.opened}}componentDidUpdate(e){!e.opened&&this.props.opened&&this._saveLastElementFocused()}_renderModal(){return typeof this.props.modal=="function"?this.props.modal({closeModal:this.handleCloseModal}):this.props.modal}render(){const e=this.props.children?this.props.children({openModal:this._openModal}):null,{body:o}=document;return o?n.createElement(S.Provider,{value:{closeModal:this.handleCloseModal}},e,this.state.opened&&y.createPortal(n.createElement(oe,{style:de.container},n.createElement(le,{initialFocusId:this.props.initialFocusId,testId:this.props.testId,onCloseModal:this.props.backdropDismissEnabled?this.handleCloseModal:()=>{}},this._renderModal())),o),this.state.opened&&n.createElement(ie,{onClose:this.handleCloseModal}),this.state.opened&&n.createElement(a,null)):null}}D.defaultProps={backdropDismissEnabled:!0};class ie extends n.Component{constructor(...e){super(...e),this._handleKeyup=o=>{o.key==="Escape"&&(o.preventDefault(),o.stopPropagation(),this.props.onClose())}}componentDidMount(){window.addEventListener("keyup",this._handleKeyup)}componentWillUnmount(){window.removeEventListener("keyup",this._handleKeyup)}render(){return null}}const de=x.StyleSheet.create({container:{zIndex:1080}});Y(D);function E(t){const{scrollOverflow:e,style:o,children:s}=t,{theme:l}=I(w),r=_(ue,l);return n.createElement(c,{style:[r.wrapper,e&&r.scrollOverflow]},n.createElement(c,{style:[r.content,o]},s))}E.__IS_MODAL_CONTENT__=!0;E.isComponentOf=t=>t&&t.type&&t.type.__IS_MODAL_CONTENT__;const ce="@media (max-width: 767px)",ue=t=>({wrapper:{flex:1,display:"block"},scrollOverflow:{overflow:"auto"},content:{flex:1,minHeight:"100%",padding:d.xLarge_32,boxSizing:"border-box",[ce]:{padding:`${d.xLarge_32}px ${d.medium_16}px`}}});E.defaultProps={scrollOverflow:!0};class me extends n.Component{render(){const{light:e,onClick:o,style:s,testId:l}=this.props;return n.createElement(S.Consumer,null,({closeModal:r})=>{if(r&&o)throw new Error("You've specified 'onClose' on a modal when using ModalLauncher.  Please specify 'onClose' on the ModalLauncher instead");return n.createElement(U,{icon:z,"aria-label":"Close modal",onClick:o||r,kind:e?"primary":"tertiary",light:e,style:s,testId:l})})}}function $({closeButtonVisible:t=!0,scrollOverflow:e=!0,light:o=!0,content:s,footer:l,header:r,onClose:h,style:f,testId:i}){const{theme:b}=I(w),u=_(pe,b),m=n.useCallback(()=>{const g=E.isComponentOf(s)?s:n.createElement(E,null,s);return g&&n.cloneElement(g,{scrollOverflow:e,style:[!!l&&u.hasFooter,g.props.style]})},[s,l,e,u.hasFooter])();return n.createElement(c,{style:[u.wrapper,!o&&u.dark,f],testId:i&&`${i}-panel`},t&&n.createElement(me,{light:!o,onClick:h,style:u.closeButton,testId:i&&`${i}-close`}),r,m,!l||C.isComponentOf(l)?l:n.createElement(C,null,l))}$.defaultProps={closeButtonVisible:!0,scrollOverflow:!0,light:!0};const pe=t=>({wrapper:{flex:"1 1 auto",position:"relative",display:"flex",flexDirection:"column",background:"white",boxSizing:"border-box",overflow:"hidden",height:"100%",width:"100%"},closeButton:{position:"absolute",right:t.spacing.panel.closeButton,top:t.spacing.panel.closeButton,zIndex:1,":focus":{outlineWidth:t.border.width,outlineColor:t.border.color,outlineOffset:1,outlineStyle:"solid",borderRadius:t.border.radius}},dark:{background:t.color.bg.inverse,color:t.color.text.inverse},hasFooter:{paddingBottom:t.spacing.panel.footer}});class he extends n.Component{renderHeader(e){const{title:o,breadcrumbs:s=void 0,subtitle:l=void 0,testId:r}=this.props;return s?n.createElement(v,{title:o,breadcrumbs:s,titleId:e,testId:r&&`${r}-header`}):l?n.createElement(v,{title:o,subtitle:l,titleId:e,testId:r&&`${r}-header`}):n.createElement(v,{title:o,titleId:e,testId:r&&`${r}-header`})}render(){const{onClose:e,footer:o,content:s,above:l,below:r,style:h,closeButtonVisible:f,testId:i,titleId:b,role:u,"aria-describedby":M}=this.props;return n.createElement(K,{styleSheets:fe},({styles:m})=>n.createElement(N,{id:b},g=>n.createElement(P,{style:[m.dialog,h],above:l,below:r,testId:i,"aria-labelledby":g,"aria-describedby":M,role:u},n.createElement($,{onClose:e,header:this.renderHeader(g),content:s,footer:o,closeButtonVisible:f,testId:i}))))}}he.defaultProps={closeButtonVisible:!0};const fe={small:x.StyleSheet.create({dialog:{width:"100%",height:"100%",overflow:"hidden"}}),mdOrLarger:x.StyleSheet.create({dialog:{width:"93.75%",maxWidth:576,height:"81.25%",maxHeight:624}})};function ge(t){let e=t&&t.parentElement;for(;e&&!e.hasAttribute(B);)e=e.parentElement;return e}function _e(t){return ge(t)}export{_e as m};
