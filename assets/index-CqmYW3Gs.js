var L=Object.defineProperty;var U=(i,t,e)=>t in i?L(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var l=(i,t,e)=>(U(i,typeof t!="symbol"?t+"":t,e),e);import{e as $}from"./index-BWagKz4k.js";import"./article-editor-QRrbsJOc.js";import"./device-framer-DIhcv6s8.js";import"./viewport-resizer-DnCm4tPd.js";import{j as n}from"./jsx-runtime-BT65X5dW.js";import{P as s}from"./index-CrGd2QqM.js";import{r as h}from"./index-C6mWTJJr.js";import{_ as c}from"./underscore-U-AHniOr.js";import{z as J}from"./util-2bFi3N3g.js";import{w as Q}from"./all-widgets-B_uI1DG3.js";import"./index-CW2s7ekB.js";import"./answer-choices-BqW-lyA6.js";import"./index-DfoJsr3g.js";import"./index-B1Gws05u.js";import"./i18n-context-3AkWzTTj.js";import"./perseus-api-Ty_QvlNi.js";import{s as z,b as B,r as X,a as Y,c as Z}from"./renderer-CDMpjcHH.js";import{c as x}from"./index-D7h-teXI.js";import"./jquery-CkHB0_Mt.js";import"./dependencies-BsVPGK1s.js";import"./zoomable-tex-Dy-nElJT.js";import"./svg-image-ywfOpLF6.js";import"./no-important-DlFk8a1I.js";import"./number-input-Dh208Jd4.js";import"./simple-keypad-input-B68QIuHr.js";import"./text-input-By3UgNXT.js";import"./phet-simulation-CrX_59te.js";import"./sortable-BGfk7U0z.js";import"./fixed-to-responsive-CTsII9Xx.js";import"./math-input-DB2MX6eh.js";import"./video-transcript-link-BsyCgIOs.js";import"./item-version-AzSh3grn.js";import"./article-renderer-BwxYabli.js";import"./server-item-renderer-B5HgCHn9.js";import"./hints-renderer-BFnEHlSw.js";import"./base-radio-CT7cpDvl.js";import"./button-group-B24xCvY2.js";import"./hud-CP_ly967.js";import"./icon-BfyZ3piz.js";import"./index-3tXmpMZ8.js";import"./inline-icon-AJRwMA4Z.js";import"./multi-button-group-U6RQwTwG.js";import"./range-input-DCt_VlY_.js";import"./text-list-editor-HcP7oGoC.js";import"./index-Dd-cahjY.js";import{T as ee}from"./text-diff-DXaS1X9i.js";import{c as te}from"./components-DV9EF346.js";import"./editor-page-BXdEcwlP.js";import"./editor-8eS7FIkn.js";import{A as se}from"./register-all-widgets-and-editors-for-testing-BLAyO-Nl.js";import"./content-preview-C9cGED2I.js";/* empty css                       */const re="@khanacademy/perseus-editor",ne="__lib_version__";$(re,ne);const O="unchanged",V="changed",F="added",I="removed",ie=function(i,t,e){let r;return i===t?r=O:i===void 0?r=F:t===void 0?r=I:r=V,{after:JSON.stringify(t),before:JSON.stringify(i),children:[],key:e,status:r}},oe=function(i,t,e){const r=c.isObject(i)?c(i).keys():[],o=c.isObject(t)?c(t).keys():[],p=c.union(r,o),a=c.map(p,function(u){return W((i||{})[u],(t||{})[u],u)});let d;return i===void 0?d=F:t===void 0?d=I:d=c.any(a,function(m){return m.status!==O})?V:O,{after:"",before:"",children:a,key:e,status:d}},W=function(i,t,e){return typeof i=="object"||typeof t=="object"?oe(i,t,e):ie(i,t,e)},{SvgImage:D}=te,H=function(i){return(i-1)*20},N="before",R="after",ae="unchanged";class P extends h.Component{render(){const t=x(this.props.className,{"diff-row":!0,before:this.props.side===N,after:this.props.side===R});return n.jsx("div",{className:t,children:n.jsxs("div",{style:{paddingLeft:H(this.props.depth)},children:[this.props.showKey&&this.props.propKey+": ",n.jsx("span",{className:"inner-value dark "+this.props.className,children:this.props.value})]})})}}l(P,"propTypes",{className:s.string.isRequired,depth:s.number.isRequired,propKey:s.string.isRequired,showKey:s.bool.isRequired,side:s.oneOf([N,R]).isRequired,value:s.string});class k extends h.Component{render(){const t=this;return n.jsx("div",{onClick:t.props.onClick,style:{clear:"both"},children:c.map([N,R],function(e){return n.jsx("div",{className:"diff-row collapsed "+e,children:n.jsx("div",{style:{paddingLeft:H(t.props.depth)},children:n.jsx("span",{children:" [ show unmodified ] "})})},e)})})}}l(k,"propTypes",{depth:s.number,onClick:s.func.isRequired}),l(k,"defaultProps",{depth:0});const v=class v extends h.Component{constructor(){super(...arguments);l(this,"state",{expanded:this.props.expanded});l(this,"expand",()=>{this.setState({expanded:!0})})}render(){const e=this.props.entry,r=e.status==="removed",o=e.status==="added",p=e.status==="changed",a=e.children.length>0,d=x({removed:r||p&&!a,dark:r,"blank-space":o}),u=x({added:o||p&&!a,dark:o,"blank-space":r});let m;this.state.expanded?m=e.children:m=c(e.children).select(function(y){return y.status!==ae});let g=m.length<e.children.length;e.children.length===m.length+1&&(m=e.children,g=!1);const f=this;return n.jsxs("div",{children:[e.key&&n.jsxs("div",{style:{clear:"both"},children:[n.jsx(P,{side:N,className:d,depth:this.props.depth,propKey:e.key,showKey:!o,value:e.before}),n.jsx(P,{side:R,className:u,depth:this.props.depth,propKey:e.key,showKey:!r,value:e.after})]}),c.map(m,function(y){return n.jsx(v,{depth:f.props.depth+1,entry:y,expanded:f.state.expanded},y.key)}),g&&n.jsx(k,{depth:this.props.depth+1,onClick:this.expand})]})}};l(v,"propTypes",{depth:s.number,entry:s.shape({after:s.string,before:s.string,children:s.arrayOf(s.any),key:s.string}),expanded:s.bool}),l(v,"defaultProps",{depth:0});let A=v;class M extends h.Component{render(){const{before:t,after:e}=this.props,r=t.options&&t.options.backgroundImage?t.options.backgroundImage.url:"",o=e.options&&e.options.backgroundImage?e.options.backgroundImage.url:"";return n.jsxs("div",{children:[n.jsx("div",{className:"diff-row before",children:r&&n.jsx("div",{className:x({image:!0,"image-unchanged":r===o,"image-removed":r!==o}),children:n.jsx(D,{src:r,title:r})})}),n.jsx("div",{className:"diff-row after",children:o&&n.jsx("div",{className:x({image:!0,"image-unchanged":r===o,"image-added":r!==o}),children:n.jsx(D,{src:o,title:o})})})]})}}l(M,"propTypes",{after:s.shape({options:s.objectOf(s.any)}).isRequired,before:s.shape({options:s.objectOf(s.any)}).isRequired});class w extends h.Component{render(){const{after:t,before:e,title:r,type:o}=this.props,p=W(e,t);return n.jsxs("div",{children:[n.jsx("div",{className:"diff-header",children:r}),n.jsx("div",{className:"diff-header",children:r}),n.jsxs("div",{className:"diff-body ui-helper-clearfix",children:[o==="image"&&n.jsx(M,{before:e,after:t}),n.jsx(A,{entry:p})]})]})}}l(w,"propTypes",{after:s.shape({options:s.objectOf(s.any)}),before:s.shape({options:s.objectOf(s.any)}),title:s.string.isRequired,type:s.string}),l(w,"defaultProps",{after:{},before:{},type:""});w.__docgenInfo={description:"",methods:[],displayName:"WidgetDiff",props:{after:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"shape",value:{options:{name:"objectOf",value:{name:"any"},required:!1}}},required:!1},before:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"shape",value:{options:{name:"objectOf",value:{name:"any"},required:!1}}},required:!1},type:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1},title:{description:"",type:{name:"string"},required:!0}}};const _=function(i,t){const{alignment:e,graded:r,options:o,type:p}=i||{},a={options:o};return t&&J(p).length>1&&(a.alignment=e),p==="transformer"&&(a.graded=r),z(p)&&(a.static=(i==null?void 0:i.static)??void 0),a};class j extends h.Component{render(){const{after:t,before:e,showAlignmentOptions:r,showSeparator:o,title:p}=this.props;let a,d;(e.content||t.content)&&(a=n.jsx(ee,{before:e.content,after:t.content,title:p}));const u=Object.keys(e.widgets??{}).filter(g=>e.content.includes(g)),m=Object.keys(t.widgets??{}).filter(g=>t.content.includes(g));return(u.length||m.length)&&(d=c.union(u,m).map(f=>{var y,T,S,E;return n.jsx(w,{before:_((y=e.widgets)==null?void 0:y[f],r),after:_((T=t.widgets)==null?void 0:T[f],r),title:f,type:(((S=e.widgets)==null?void 0:S[f])??{}).type||(((E=t.widgets)==null?void 0:E[f])??{}).type},f)})),n.jsxs("div",{children:[a,d,o&&n.jsx("div",{className:"diff-separator"})]})}}l(j,"defaultProps",{after:{content:"",images:{},widgets:{}},before:{content:"",images:{},widgets:{}},showAlignmentOptions:!1,showSeparator:!1});j.__docgenInfo={description:"",methods:[],displayName:"RendererDiff",props:{after:{required:!1,tsType:{name:"signature",type:"object",raw:`{
    content: string;
    // NOTE: images and widgets may not be set for some items hints,
    // specifically in old revisions, which may only be loaded for diffing.
    widgets: PerseusRenderer["widgets"] | null | undefined;
    images: PerseusRenderer["images"] | null | undefined;
}`,signature:{properties:[{key:"content",value:{name:"string",required:!0}},{key:"widgets",value:{name:"union",raw:'PerseusRenderer["widgets"] | null | undefined',elements:[{name:"signature",raw:'PerseusRenderer["widgets"]'},{name:"null"},{name:"undefined"}],required:!0}},{key:"images",value:{name:"union",raw:'PerseusRenderer["images"] | null | undefined',elements:[{name:"signature",raw:'PerseusRenderer["images"]'},{name:"null"},{name:"undefined"}],required:!0}}]}},description:"",defaultValue:{value:`{
    content: "",
    images: {},
    widgets: {},
}`,computed:!1}},before:{required:!1,tsType:{name:"signature",type:"object",raw:`{
    content: string;
    // NOTE: images and widgets may not be set for some items hints,
    // specifically in old revisions, which may only be loaded for diffing.
    widgets: PerseusRenderer["widgets"] | null | undefined;
    images: PerseusRenderer["images"] | null | undefined;
}`,signature:{properties:[{key:"content",value:{name:"string",required:!0}},{key:"widgets",value:{name:"union",raw:'PerseusRenderer["widgets"] | null | undefined',elements:[{name:"signature",raw:'PerseusRenderer["widgets"]'},{name:"null"},{name:"undefined"}],required:!0}},{key:"images",value:{name:"union",raw:'PerseusRenderer["images"] | null | undefined',elements:[{name:"signature",raw:'PerseusRenderer["images"]'},{name:"null"},{name:"undefined"}],required:!0}}]}},description:"",defaultValue:{value:`{
    content: "",
    images: {},
    widgets: {},
}`,computed:!1}},showAlignmentOptions:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},showSeparator:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},title:{required:!0,tsType:{name:"string"},description:""}}};const q=s.shape({content:s.string,images:s.objectOf(s.any),widgets:s.objectOf(s.any)}),b=class b extends h.Component{constructor(){super(...arguments);l(this,"state",b._stateFromProps(this.props))}UNSAFE_componentWillReceiveProps(e){this.setState(b._stateFromProps(e))}render(){const{before:e,after:r}=this.state,o=Math.max(e.length,r.length),p=c.times(o,a=>n.jsx(j,{before:a<e.length?e[a]:void 0,after:a<r.length?r[a]:void 0,title:`Section ${a+1}`,showAlignmentOptions:!0,showSeparator:a<o-1},a));return n.jsx("div",{className:"framework-perseus",children:p})}};l(b,"propTypes",{after:s.oneOfType([q,s.arrayOf(q)]).isRequired,before:s.oneOfType([q,s.arrayOf(q)]).isRequired}),l(b,"_stateFromProps",e=>{const{before:r,after:o}=e;return{before:Array.isArray(r)?r:[r],after:Array.isArray(o)?o:[o]}});let C=b;C.__docgenInfo={description:"",methods:[{name:"_stateFromProps",docblock:null,modifiers:["static"],params:[{name:"props",optional:!1,type:null}],returns:null}],displayName:"ArticleDiff",props:{after:{description:"",type:{name:"union",value:[{name:"custom",raw:"rendererProps"},{name:"arrayOf",value:{name:"custom",raw:"rendererProps"}}]},required:!0},before:{description:"",type:{name:"union",value:[{name:"custom",raw:"rendererProps"},{name:"arrayOf",value:{name:"custom",raw:"rendererProps"}}]},required:!0}}};const K=s.shape({question:s.shape({}).isRequired,answerArea:s.shape({}).isRequired,hints:s.arrayOf(s.any).isRequired});class G extends h.Component{render(){const{before:t,after:e}=this.props,r=Math.max(t.hints.length,e.hints.length),o=n.jsx(j,{before:t.question,after:e.question,title:"Question",showAlignmentOptions:!1,showSeparator:!0}),p=n.jsx(w,{before:t.answerArea,after:e.answerArea,title:"Question extras"}),a=c.times(r,function(d){return n.jsx(j,{before:d<t.hints.length?t.hints[d]:void 0,after:d<e.hints.length?e.hints[d]:void 0,title:`Hint ${d+1}`,showAlignmentOptions:!1,showSeparator:d<r-1},d)});return n.jsxs("div",{className:"framework-perseus",children:[o,p,a&&n.jsx("div",{className:"diff-separator"}),a]})}}l(G,"propTypes",{after:K.isRequired,before:K.isRequired});G.__docgenInfo={description:"",methods:[],displayName:"ItemDiff",props:{after:{description:"",type:{name:"custom",raw:"itemProps.isRequired"},required:!1},before:{description:"",type:{name:"custom",raw:"itemProps.isRequired"},required:!1}}};B(se);X(Q);Y();Z();
