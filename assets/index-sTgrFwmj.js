import{V as c,_ as L,I as N}from"./index-hw7d7wq0.js";import{r as n}from"./index-6oxdNXpR.js";import{m as A,c as R,u as w,a as M,T as H,w as U,I as z,x as W}from"./index-Y1DiWZsM.js";import{a as m,b as k,s as a}from"./index-zRqVZh6A.js";import{c as G,b as V}from"./index-jek-Xksa.js";import{r as b}from"./index-9gkyvru-.js";import{n as O}from"./no-important-xCWWYXQR.js";import{w as Y}from"./index-OQMtW1Q1.js";import{M as K}from"./index-v_a-r9JG.js";const _={root:{color:{inverse:{background:m.surface.inverse,foreground:m.text.inverse}},border:{radius:k.radius.medium_4,width:k.width.thin}},backdrop:{color:{background:m.surface.overlay}},dialog:{spacing:{padding:a.medium_16}},footer:{color:{border:m.border.primary}},header:{color:{border:m.border.primary,secondary:m.text.secondary},spacing:{paddingBlockMd:a.large_24,paddingInlineMd:a.xLarge_32,paddingInlineSm:a.medium_16,gap:a.xSmall_8,titleGapMd:a.medium_16,titleGapSm:a.xLarge_32}},panel:{color:{border:m.focus.outer},spacing:{gap:a.xLarge_32}},closeButton:{spacing:{gap:a.medium_16}}},j=A(_,{root:{color:{inverse:{background:m.khanmigo.primary}}}}),q={default:_,khanmigo:j},y=R(_);function J(t){const e=n.useContext(H),o=q[e]||_;return n.createElement(y.Provider,{value:o},t.children)}const Q=n.forwardRef(function(e,o){const{above:r,below:s,role:l="dialog",style:h,children:f,testId:i,"aria-labelledby":E,"aria-describedby":u}=e,{theme:v}=w(y),p=M(Z,v);return n.createElement(c,{style:[p.wrapper,h]},s&&n.createElement(c,{style:p.below},s),n.createElement(c,{role:l,"aria-modal":"true","aria-labelledby":E,"aria-describedby":u,ref:o,style:p.dialog,testId:i},f),r&&n.createElement(c,{style:p.above},r))}),P=n.forwardRef(function(e,o){return n.createElement(J,null,n.createElement(Q,L({},e,{ref:o})))}),X="@media (max-width: 767px)",Z=t=>({wrapper:{display:"flex",flexDirection:"row",alignItems:"stretch",width:"100%",height:"100%",position:"relative",[X]:{padding:t.dialog.spacing.padding,flexDirection:"column"}},dialog:{width:"100%",height:"100%",borderRadius:t.root.border.radius,overflow:"hidden"},above:{pointerEvents:"none",position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:1},below:{pointerEvents:"none",position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:-1}});P.displayName="ModalDialog";function I({children:t}){const{theme:e}=w(y),o=M(ee,e);return n.createElement(c,{style:o.footer},t)}I.__IS_MODAL_FOOTER__=!0;I.isComponentOf=t=>t&&t.type&&t.type.__IS_MODAL_FOOTER__;const ee=t=>({footer:{flex:"0 0 auto",boxSizing:"border-box",minHeight:a.xxxLarge_64,paddingLeft:a.medium_16,paddingRight:a.medium_16,paddingTop:a.xSmall_8,paddingBottom:a.xSmall_8,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",boxShadow:`0px -1px 0px ${t.footer.color.border}`}});function C(t){const{breadcrumbs:e=void 0,light:o,subtitle:r=void 0,testId:s,title:l,titleId:h}=t;if(r&&e)throw new Error("'subtitle' and 'breadcrumbs' can't be used together");const{theme:f}=w(y),i=M(te,f);return n.createElement(c,{style:[i.header,!o&&i.dark],testId:s},e&&n.createElement(c,{style:i.breadcrumbs},e),n.createElement(G,{tag:"h2",style:i.title,id:h,testId:s&&`${s}-title`},l),r&&n.createElement(V,{style:o&&i.subtitle,testId:s&&`${s}-subtitle`},r))}const T="@media (max-width: 767px)",te=t=>({header:{boxShadow:`0px 1px 0px ${t.header.color.border}`,display:"flex",flexDirection:"column",minHeight:66,paddingBlock:t.header.spacing.paddingBlockMd,paddingInline:t.header.spacing.paddingInlineMd,position:"relative",width:"100%",[T]:{paddingInline:t.header.spacing.paddingInlineSm}},dark:{background:t.root.color.inverse.background,color:t.root.color.inverse.foreground},breadcrumbs:{color:t.header.color.secondary,marginBottom:t.header.spacing.gap},title:{paddingRight:t.header.spacing.titleGapMd,[T]:{paddingRight:t.header.spacing.titleGapSm}},subtitle:{color:t.header.color.secondary,marginTop:t.header.spacing.gap}});C.defaultProps={light:!0};const oe='button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])';class ne extends n.Component{constructor(...e){super(...e),this.modalRoot=void 0,this.getModalRoot=o=>{if(!o)return;const r=b.findDOMNode(o);if(!r)throw new Error("Assertion error: modal root should exist after mount");this.modalRoot=r},this.handleFocusMoveToLast=()=>{this.focusElementIn(!1)},this.handleFocusMoveToFirst=()=>{this.focusElementIn(!0)}}tryToFocus(e){if(e instanceof HTMLElement){try{e.focus()}catch{}return document.activeElement===e}}focusElementIn(e){const o=this.modalRoot,r=Array.from(o.querySelectorAll(oe)),s=e?0:r.length-1,l=r[s];this.tryToFocus(l)}render(){const{style:e}=this.props;return n.createElement(n.Fragment,null,n.createElement("div",{tabIndex:0,className:"modal-focus-trap-first",onFocus:this.handleFocusMoveToLast,style:{position:"fixed"}}),n.createElement(c,{style:e,ref:this.getModalRoot},this.props.children),n.createElement("div",{tabIndex:0,className:"modal-focus-trap-last",onFocus:this.handleFocusMoveToFirst,style:{position:"fixed"}}))}}const B="data-modal-launcher-portal",re="a[href], details, input, textarea, select, button";function se(t){return Array.from(t.querySelectorAll(re))}class le extends n.Component{constructor(...e){super(...e),this._mousePressedOutside=!1,this.handleMouseDown=o=>{this._mousePressedOutside=o.target===o.currentTarget},this.handleMouseUp=o=>{o.target===o.currentTarget&&this._mousePressedOutside&&this.props.onCloseModal(),this._mousePressedOutside=!1}}componentDidMount(){const e=b.findDOMNode(this);if(!e)return;const o=this._getInitialFocusElement(e)||this._getFirstFocusableElement(e)||this._getDialogElement(e);setTimeout(()=>{o.focus()},0)}_getInitialFocusElement(e){const{initialFocusId:o}=this.props;return o?b.findDOMNode(e.querySelector(`#${o}`)):null}_getFirstFocusableElement(e){const o=se(e);return o?o[0]:null}_getDialogElement(e){const o=b.findDOMNode(e.querySelector('[role="dialog"]'));return o.tabIndex=-1,o}render(){const{children:e,testId:o}=this.props,r={[B]:!0};return n.createElement(c,L({style:this.props.wbThemeStyles.modalPositioner,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,testId:o},r),e)}}const de=t=>({modalPositioner:{position:"fixed",left:0,top:0,width:"100%",height:"100%",alignItems:"center",justifyContent:"center",overflow:"auto",background:t.backdrop.color.background}});var ae=U(de,y)(le);const F=(()=>{if(typeof window>"u")return!1;const t=window.navigator.userAgent;return t.indexOf("iPad")>-1||t.indexOf("iPhone")>-1})();class d extends n.Component{componentDidMount(){if(d.numModalsOpened===0){const e=document.body;if(!e)throw new Error("couldn't find document.body");d.oldOverflow=e.style.overflow,d.oldScrollY=window.scrollY,F&&(d.oldPosition=e.style.position,d.oldWidth=e.style.width,d.oldTop=e.style.top),e.style.overflow="hidden",F&&(e.style.position="fixed",e.style.width="100%",e.style.top=`${-d.oldScrollY}px`)}d.numModalsOpened++}componentWillUnmount(){if(d.numModalsOpened--,d.numModalsOpened===0){const e=document.body;if(!e)throw new Error("couldn't find document.body");e.style.overflow=d.oldOverflow,F&&(e.style.position=d.oldPosition,e.style.width=d.oldWidth,e.style.top=d.oldTop),typeof window<"u"&&window.scrollTo&&window.scrollTo(0,d.oldScrollY)}}render(){return null}}d.oldOverflow=void 0;d.oldPosition=void 0;d.oldScrollY=void 0;d.oldWidth=void 0;d.oldTop=void 0;d.numModalsOpened=0;const ie={closeModal:void 0},S=n.createContext(ie);S.displayName="ModalContext";class D extends n.Component{constructor(...e){super(...e),this.lastElementFocusedOutsideModal=void 0,this.state={opened:!1},this._saveLastElementFocused=()=>{this.lastElementFocusedOutsideModal=document.activeElement},this._openModal=()=>{this._saveLastElementFocused(),this.setState({opened:!0})},this._returnFocus=()=>{const{closedFocusId:o,schedule:r}=this.props,s=this.lastElementFocusedOutsideModal;if(o){const l=b.findDOMNode(document.getElementById(o));if(l){r.animationFrame(()=>{l.focus()});return}}s!=null&&r.animationFrame(()=>{s.focus()})},this.handleCloseModal=()=>{this.setState({opened:!1},()=>{const{onClose:o}=this.props;o==null||o(),this._returnFocus()})}}static getDerivedStateFromProps(e,o){return typeof e.opened=="boolean"&&e.children&&console.warn("'children' and 'opened' can't be used together"),typeof e.opened=="boolean"&&!e.onClose&&console.warn("'onClose' should be used with 'opened'"),typeof e.opened!="boolean"&&!e.children&&console.warn("either 'children' or 'opened' must be set"),{opened:typeof e.opened=="boolean"?e.opened:o.opened}}componentDidUpdate(e){!e.opened&&this.props.opened&&this._saveLastElementFocused()}_renderModal(){return typeof this.props.modal=="function"?this.props.modal({closeModal:this.handleCloseModal}):this.props.modal}render(){const e=this.props.children?this.props.children({openModal:this._openModal}):null,{body:o}=document;return o?n.createElement(S.Provider,{value:{closeModal:this.handleCloseModal}},e,this.state.opened&&b.createPortal(n.createElement(ne,{style:ue.container},n.createElement(ae,{initialFocusId:this.props.initialFocusId,testId:this.props.testId,onCloseModal:this.props.backdropDismissEnabled?this.handleCloseModal:()=>{}},this._renderModal())),o),this.state.opened&&n.createElement(ce,{onClose:this.handleCloseModal}),this.state.opened&&n.createElement(d,null)):null}}D.defaultProps={backdropDismissEnabled:!0};class ce extends n.Component{constructor(...e){super(...e),this._handleKeyup=o=>{o.key==="Escape"&&(o.preventDefault(),o.stopPropagation(),this.props.onClose())}}componentDidMount(){window.addEventListener("keyup",this._handleKeyup)}componentWillUnmount(){window.removeEventListener("keyup",this._handleKeyup)}render(){return null}}const ue=O.StyleSheet.create({container:{zIndex:1080}});Y(D);function x(t){const{scrollOverflow:e,style:o,children:r}=t,{theme:s}=w(y),l=M(me,s);return n.createElement(c,{style:[l.wrapper,e&&l.scrollOverflow]},n.createElement(c,{style:[l.content,o]},r))}x.__IS_MODAL_CONTENT__=!0;x.isComponentOf=t=>t&&t.type&&t.type.__IS_MODAL_CONTENT__;const pe="@media (max-width: 767px)",me=t=>({wrapper:{flex:1,display:"block"},scrollOverflow:{overflow:"auto"},content:{flex:1,minHeight:"100%",padding:a.xLarge_32,boxSizing:"border-box",[pe]:{padding:`${a.xLarge_32}px ${a.medium_16}px`}}});x.defaultProps={scrollOverflow:!0};class he extends n.Component{render(){const{light:e,onClick:o,style:r,testId:s}=this.props;return n.createElement(S.Consumer,null,({closeModal:l})=>{if(l&&o)throw new Error("You've specified 'onClose' on a modal when using ModalLauncher.  Please specify 'onClose' on the ModalLauncher instead");return n.createElement(z,{icon:W,"aria-label":"Close modal",onClick:o||l,kind:e?"primary":"tertiary",light:e,style:r,testId:s})})}}function $({closeButtonVisible:t=!0,scrollOverflow:e=!0,light:o=!0,content:r,footer:s,header:l,onClose:h,style:f,testId:i}){const{theme:E}=w(y),u=M(fe,E),p=n.useCallback(()=>{const g=x.isComponentOf(r)?r:n.createElement(x,null,r);return g&&n.cloneElement(g,{scrollOverflow:e,style:[!!s&&u.hasFooter,g.props.style]})},[r,s,e,u.hasFooter])();return n.createElement(c,{style:[u.wrapper,!o&&u.dark,f],testId:i&&`${i}-panel`},t&&n.createElement(he,{light:!o,onClick:h,style:u.closeButton,testId:i&&`${i}-close`}),l,p,!s||I.isComponentOf(s)?s:n.createElement(I,null,s))}$.defaultProps={closeButtonVisible:!0,scrollOverflow:!0,light:!0};const fe=t=>({wrapper:{flex:"1 1 auto",position:"relative",display:"flex",flexDirection:"column",background:"white",boxSizing:"border-box",overflow:"hidden",height:"100%",width:"100%"},closeButton:{position:"absolute",right:t.closeButton.spacing.gap,top:t.closeButton.spacing.gap,zIndex:1,":focus":{outlineWidth:t.root.border.width,outlineColor:t.panel.color.border,outlineOffset:1,outlineStyle:"solid",borderRadius:t.root.border.radius}},dark:{background:t.root.color.inverse.background,color:t.root.color.inverse.foreground},hasFooter:{paddingBlockEnd:t.panel.spacing.gap}});class ge extends n.Component{renderHeader(e){const{title:o,breadcrumbs:r=void 0,subtitle:s=void 0,testId:l}=this.props;return r?n.createElement(C,{title:o,breadcrumbs:r,titleId:e,testId:l&&`${l}-header`}):s?n.createElement(C,{title:o,subtitle:s,titleId:e,testId:l&&`${l}-header`}):n.createElement(C,{title:o,titleId:e,testId:l&&`${l}-header`})}render(){const{onClose:e,footer:o,content:r,above:s,below:l,style:h,closeButtonVisible:f,testId:i,titleId:E,role:u,"aria-describedby":v}=this.props;return n.createElement(K,{styleSheets:ye},({styles:p})=>n.createElement(N,{id:E},g=>n.createElement(P,{style:[p.dialog,h],above:s,below:l,testId:i,"aria-labelledby":g,"aria-describedby":v,role:u},n.createElement($,{onClose:e,header:this.renderHeader(g),content:r,footer:o,closeButtonVisible:f,testId:i}))))}}ge.defaultProps={closeButtonVisible:!0};const ye={small:O.StyleSheet.create({dialog:{width:"100%",height:"100%",overflow:"hidden"}}),mdOrLarger:O.StyleSheet.create({dialog:{width:"93.75%",maxWidth:576,height:"81.25%",maxHeight:624}})};function be(t){let e=t&&t.parentElement;for(;e&&!e.hasAttribute(B);)e=e.parentElement;return e}function Oe(t){return be(t)}export{Oe as m};
