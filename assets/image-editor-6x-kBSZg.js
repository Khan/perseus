import{a as o,j as a}from"./jsx-runtime-FVsy8kgq.js";import{c as f}from"./article-renderer-kI5bvIE0.js";import{_ as r}from"./jquery-yG1GhClm.js";import{U as p}from"./util-EodL-OyW.js";import"./phet-simulation-9JfdvNpj.js";import"./version-akiLXZts.js";import"./dependencies-8XILypbq.js";import"./perseus-api-mOiZT07d.js";import"./multi-renderer-hspSFWbr.js";import"./hints-renderer-QPN_52ZZ.js";import"./renderer-L23s5OFx.js";import"./base-radio-gjO323Ds.js";import{c as b}from"./components-PCV-cUaU.js";import{c as y}from"./icon-paths-AuJwhOz7.js";import"./index-k-0mNqHS.js";import"./i18n-context-P7VpLqM1.js";import"./svg-image-WHPtcgo-.js";import"./index-IIMKO4_x.js";import{E as w}from"./editor-jsonify-2Th63k9v.js";import{r as C}from"./index-TT1qJ6UJ.js";import{B as v}from"./blur-input-hjJsfoK9.js";import{E as m}from"./editor-xR7VOm5r.js";const{InfoTip:c,InlineIcon:R,RangeInput:k}=b,u=400,h=[0,10],I={url:null,width:0,height:0},x="(ka-.*.s3.amazonaws.com|(fastly|cdn).kastatic.org|khanacademy.org|kasandbox.org)",E=new RegExp("^(https?|web\\+graphie)://[^/]*"+x),T=["center","above","above right","right","below right","below","below left","left","above left"],s=class s extends C.Component{constructor(){super(...arguments),this._isMounted=!1,this.state={backgroundImageError:""}}componentDidMount(){this._isMounted=!0}componentWillUnmount(){this._isMounted=!1}_renderRowForLabel(e,t){return o("tr",{children:[a("td",{children:a(k,{value:e.coordinates,onChange:this.onCoordinateChange.bind(this,t)})}),a("td",{style:{verticalAlign:"bottom",width:"5px"},children:a("input",{type:"text",className:"graph-settings-axis-label",value:e.content,onChange:this.onContentChange.bind(this,t)})}),a("td",{children:a("select",{className:"perseus-widget-dropdown",value:e.alignment,onChange:this.onAlignmentChange.bind(this,t),children:T.map(function(n,l){return a("option",{value:n,children:n},""+l)},this)})}),a("td",{children:a("a",{href:"#",className:"simple-button orange delete-label",title:"Remove this label",onClick:this.removeLabel.bind(this,t),children:a(R,{...y})})})]},t)}change(...e){return f.apply(this,e)}removeLabel(e,t){t.preventDefault();const n=[...this.props.labels];n.splice(e,1),this.props.onChange({labels:n})}onCoordinateChange(e,t){const n=this.props.labels.slice();n[e]=r.extend({},n[e],{coordinates:t}),this.props.onChange({labels:n})}onContentChange(e,t){const n=t.target.value,l=this.props.labels.slice();l[e]=r.extend({},l[e],{content:n}),this.props.onChange({labels:l})}onAlignmentChange(e,t){const n=t.target.value,l=this.props.labels.slice();l[e]=r.extend({},l[e],{alignment:n}),this.props.onChange({labels:l})}setUrl(e,t,n,l){if(!this._isMounted)return;const i=r.clone(this.props.backgroundImage);i.url=e,i.width=t,i.height=n;const g=[i.width,i.height];this.props.onChange({backgroundImage:i,box:g},null,l)}async onUrlChange(e,t){if(!e){this.setUrl(e,0,0,t);return}if(!E.test(e)){this.setState({backgroundImageError:"Images must be from sites hosted by Khan Academy. Please input a Khan Academy-owned address, or use the Add Image tool to rehost an existing image"});return}this.setState({backgroundImageError:""});try{const n=await p.getImageSizeModern(e);this.setUrl(e,n[0],n[1],!0)}catch(n){this.setState({backgroundImageError:`There was an error loading the image URL: ${JSON.stringify(n,null,2)}`})}}onRangeChange(e,t){const n=this.props.range.slice();n[e]=t,this.props.onChange({range:n})}serialize(){return w.serialize.call(this)}render(){const e=this.props.backgroundImage,t=o("div",{className:"image-settings",children:[!p.isLabeledSVG(e.url)&&a("div",{children:o("label",{children:[a("div",{children:"Preview:"}),a("img",{alt:"Editor preview of image",src:e.url,style:{width:"100%"}})]})}),a("div",{children:o("label",{children:[a("div",{children:"Dimensions:"}),o("p",{children:[e.width,"x",e.height]})]})}),a("div",{children:o("label",{children:[o("div",{children:["Alt text:",a(c,{children:"This is important for screenreaders. The content of this alt text will be formatted as markdown (tables, emphasis, etc. are supported)."})]}),a(m,{apiOptions:this.props.apiOptions,content:this.props.alt,onChange:l=>{l.content!=null&&this.change("alt",l.content)},widgetEnabled:!1})]})}),a("div",{children:o("label",{children:[a("div",{children:"Caption:"}),a(m,{apiOptions:this.props.apiOptions,content:this.props.caption,onChange:l=>{l.content!=null&&this.change("caption",l.content)},widgetEnabled:!1})]})})]}),n=a("div",{className:"renderer-widget-error",children:this.state.backgroundImageError});return o("div",{className:"perseus-image-editor",children:[o("label",{children:["Image url:",a(c,{children:"Paste an image or graphie image URL."}),this.state.backgroundImageError&&n,a(v,{value:e.url||"",style:{width:332},onChange:l=>this.onUrlChange(l,!1)})]}),e.url&&t]})}};s.displayName="ImageEditor",s.widgetName="image",s.defaultProps={title:"",range:[h,h],box:[u,u],backgroundImage:I,labels:[],alt:"",caption:""};let d=s;d.__docgenInfo={description:"",methods:[{name:"_renderRowForLabel",docblock:null,modifiers:[],params:[{name:"label",optional:!1,type:null},{name:"i",optional:!1,type:null}],returns:null},{name:"change",docblock:null,modifiers:[],params:[{name:"...args",optional:!1,type:null}],returns:null},{name:"removeLabel",docblock:null,modifiers:[],params:[{name:"labelIndex",optional:!1,type:null},{name:"e",optional:!1,type:null}],returns:null},{name:"onCoordinateChange",docblock:null,modifiers:[],params:[{name:"labelIndex",optional:!1,type:null},{name:"newCoordinates",optional:!1,type:null}],returns:null},{name:"onContentChange",docblock:null,modifiers:[],params:[{name:"labelIndex",optional:!1,type:null},{name:"e",optional:!1,type:null}],returns:null},{name:"onAlignmentChange",docblock:null,modifiers:[],params:[{name:"labelIndex",optional:!1,type:null},{name:"e",optional:!1,type:null}],returns:null},{name:"setUrl",docblock:null,modifiers:[],params:[{name:"url",optional:!1,type:null},{name:"width",optional:!1,type:null},{name:"height",optional:!1,type:null},{name:"silent",optional:!1,type:null}],returns:null},{name:"onUrlChange",docblock:null,modifiers:["async"],params:[{name:"url",optional:!1,type:{name:"union",raw:"string | undefined | null",elements:[{name:"string"},{name:"undefined"},{name:"null"}]}},{name:"silent",optional:!1,type:{name:"boolean"}}],returns:null},{name:"onRangeChange",docblock:null,modifiers:[],params:[{name:"type",optional:!1,type:null},{name:"newRange",optional:!1,type:null}],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:null}],displayName:"ImageEditor",props:{apiOptions:{required:!0,tsType:{name:"APIOptions"},description:""},title:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'""',computed:!1}},range:{required:!1,tsType:{name:"tuple",raw:"[Readonly<Range>, Readonly<Range>]",elements:[{name:"Readonly",elements:[{name:"Range"}],raw:"Readonly<Range>"},{name:"Readonly",elements:[{name:"Range"}],raw:"Readonly<Range>"}]},description:"",defaultValue:{value:"[defaultRange, defaultRange]",computed:!1}},box:{required:!1,tsType:{name:"Size"},description:"",defaultValue:{value:"[defaultBoxSize, defaultBoxSize]",computed:!1}},backgroundImage:{required:!1,tsType:{name:"any"},description:"",defaultValue:{value:`{
    url: null,
    width: 0,
    height: 0,
}`,computed:!1}},labels:{required:!1,tsType:{name:"ReadonlyArray",elements:[{name:"string"}],raw:"ReadonlyArray<string>"},description:"",defaultValue:{value:"[]",computed:!1}},alt:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'""',computed:!1}},caption:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'""',computed:!1}}}};export{d as I};
