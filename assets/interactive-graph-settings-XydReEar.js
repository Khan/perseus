import{j as a,a as r}from"./jsx-runtime-BGVbfQ2Z.js";import"./article-renderer-mo22H8V-.js";import{c as w}from"./unit-tpB2tohZ.js";import"./index-eZ2N530f.js";import"./index-V35CFGao.js";import{r as y}from"./index-qhcEwEpg.js";import"./fixed-to-responsive-X0KGwmEJ.js";import{g as N}from"./dependencies-fnqF3NiV.js";import"./video-transcript-link-7IHhb-72.js";import{_ as s}from"./index-default-4_ZsnO94.js";import"./perseus-api-Ly41NhN4.js";import"./multi-renderer-HjBoxga7.js";import"./hints-renderer-xZw-peBt.js";import"./renderer-AfQXcql0.js";import"./base-radio-9C1NjYiG.js";import{c as R}from"./components-OZE5lx2l.js";import{U as u,K as k}from"./util-G-g1AweO.js";import{i as T}from"./constants-5iWyYZaE.js";import{R as I}from"./index-E09jvG0x.js";const{ButtonGroup:C,InfoTip:G,PropCheckBox:f,RangeInput:d}=R,q={url:null,width:0,height:0};function F(S,l){return Math.floor((S[1]-S[0])/l)}const b=class b extends y.Component{constructor(l){super(l),this._isMounted=!1,this.change=(...e)=>w.apply(this,e),this.changeRulerLabel=e=>{this.change({rulerLabel:e.target.value})},this.changeRulerTicks=e=>{this.change({rulerTicks:+e.target.value})},this.changeBackgroundUrl=e=>{if(e.type==="keypress"&&e.key!=="Enter")return;const t=(o,h,p)=>{const i=s.clone(this.props.backgroundImage);i.url=o,i.width=h,i.height=p,this.setState({backgroundImage:i},this.changeGraph)},n=I.findDOMNode(this.refs["bg-url"]).value;n?u.getImageSize(n,(o,h)=>{this._isMounted&&t(n,o,h)}):t(null,0,0)},this.renderLabelChoices=e=>s.map(e,function(t){return a("option",{value:t[1],children:t[0]})}),this.validRange=e=>s.every(e,function(n){return s.isFinite(n)})?e[0]>=e[1]?"Range must have a higher number on the right":!0:"Range must be a valid number",this.validateStepValue=e=>{const{step:t,range:n,name:o,minTicks:h,maxTicks:p}=e;if(!s.isFinite(t))return o+" must be a valid number";const i=F(n,t);return i<h?o+" is too large, there must be at least "+h+" ticks.":i>p?o+" is too small, there can be at most "+p+" ticks.":!0},this.validSnapStep=(e,t)=>this.validateStepValue({step:e,range:t,name:"Snap step",minTicks:5,maxTicks:60}),this.validGridStep=(e,t)=>this.validateStepValue({step:e,range:t,name:"Grid step",minTicks:3,maxTicks:60}),this.validStep=(e,t)=>this.validateStepValue({step:e,range:t,name:"Step",minTicks:3,maxTicks:20}),this.validBackgroundImageSize=e=>e.url?e.width<=450&&e.height<=450?!0:"Image must be smaller than 450px x 450px.":!0,this.validateGraphSettings=(e,t,n,o,h)=>{const p=this;let i;if(!s.every(e,function(c){return i=p.validRange(c),i===!0})||!s.every(t,function(c,m){return i=p.validStep(c,e[m]),i===!0})||!s.every(n,function(c,m){return i=p.validGridStep(c,e[m]),i===!0})||!s.every(o,function(c,m){return i=p.validSnapStep(c,e[m]),i===!0}))return i;const x=this.validBackgroundImageSize(h);return x!==!0?(i=x,i):!0},this.changeLabel=(e,t)=>{const n=t.target.value,o=this.state.labelsTextbox.slice();o[e]=n,this.setState({labelsTextbox:o},this.changeGraph)},this.changeRange=(e,t)=>{const n=this.state.rangeTextbox.slice();n[e]=t;const o=this.state.stepTextbox.slice(),h=this.state.gridStepTextbox.slice(),p=this.state.snapStepTextbox.slice(),i=u.scaleFromExtent(n[e],this.props.box[e]);if(this.validRange(n[e])===!0){o[e]=u.tickStepFromExtent(n[e],this.props.box[e]);const g=u.gridStepFromTickStep(o[e],i);g&&(h[e]=g),p[e]=h[e]/2}this.setState({stepTextbox:o,gridStepTextbox:h,snapStepTextbox:p,rangeTextbox:n},this.changeGraph)},this.changeStep=e=>{this.setState({stepTextbox:e},this.changeGraph)},this.changeSnapStep=e=>{this.setState({snapStepTextbox:e},this.changeGraph)},this.changeGridStep=e=>{this.setState({gridStepTextbox:e,snapStepTextbox:s.map(e,function(t){return t/2})},this.changeGraph)},this.changeGraph=()=>{const e=this.state.labelsTextbox,t=s.map(this.state.rangeTextbox,function(g){return s.map(g,Number)}),n=s.map(this.state.stepTextbox,Number),o=this.state.gridStepTextbox,h=this.state.snapStepTextbox,p=this.state.backgroundImage,i=this.validateGraphSettings(t,n,o,h,p);i===!0?this.change({valid:!0,labels:e,range:t,step:n,gridStep:o,snapStep:h,backgroundImage:p}):this.change({valid:i})},this.state=b.stateFromProps(l)}static stateFromProps(l){return{labelsTextbox:l.labels,gridStepTextbox:l.gridStep,snapStepTextbox:l.snapStep,stepTextbox:l.step,rangeTextbox:l.range,backgroundImage:s.clone(l.backgroundImage)}}componentDidMount(){this._isMounted=!0,this.changeGraph=s.debounce(this.changeGraph,300)}UNSAFE_componentWillReceiveProps(l){(!s.isEqual(this.props.labels,l.labels)||!s.isEqual(this.props.gridStep,l.gridStep)||!s.isEqual(this.props.snapStep,l.snapStep)||!s.isEqual(this.props.step,l.step)||!s.isEqual(this.props.range,l.range)||!s.isEqual(this.props.backgroundImage,l.backgroundImage))&&this.setState(b.stateFromProps(l))}componentWillUnmount(){this._isMounted=!1}render(){const l=[k.roundTo(2,u.scaleFromExtent(this.props.range[0],this.props.box[0])),k.roundTo(2,u.scaleFromExtent(this.props.range[1],this.props.box[1]))],{TeX:e}=N();return r("div",{children:[s.contains(this.props.editableSettings,"canvas")&&r("div",{className:"graph-settings",children:[r("div",{className:"perseus-widget-row",children:[a("label",{htmlFor:"canvas-size",children:"Canvas size (x,y pixels)"}),a(d,{id:"canvas-size",value:this.props.box,onChange:t=>{this.change({box:t})}})]}),r("div",{className:"perseus-widget-row",children:["Scale (px per div):"," ",a(e,{children:"("+l[0]+", "+l[1]+")"})]})]}),s.contains(this.props.editableSettings,"graph")&&r("div",{className:"graph-settings",children:[r("div",{className:"perseus-widget-row",children:[r("div",{className:"perseus-widget-left-col",children:[a("label",{htmlFor:"labels-x",children:"x Label"}),a("input",{id:"labels-x",type:"text",className:"graph-settings-axis-label",ref:"labels-0",onChange:t=>this.changeLabel(0,t),value:this.state.labelsTextbox[0]||""})]}),r("div",{className:"perseus-widget-right-col",children:[a("label",{htmlFor:"labels-y",children:"y Label"}),a("input",{id:"labels-y",type:"text",className:"graph-settings-axis-label",ref:"labels-1",onChange:t=>this.changeLabel(1,t),value:this.state.labelsTextbox[1]||""})]})]}),r("div",{className:"perseus-widget-row",children:[r("div",{className:"perseus-widget-left-col",children:[a("label",{htmlFor:"range-x",children:"x Range"}),a(d,{id:"range-x",value:this.state.rangeTextbox[0],onChange:t=>this.changeRange(0,t)})]}),r("div",{className:"perseus-widget-right-col",children:[a("label",{htmlFor:"range-y",children:"y Range"}),a(d,{id:"range-y",value:this.state.rangeTextbox[1],onChange:t=>this.changeRange(1,t)})]})]}),r("div",{className:"perseus-widget-row",children:[r("div",{className:"perseus-widget-left-col",children:[a("label",{htmlFor:"tick-step",children:"Tick Step"}),a(d,{id:"tick-step",value:this.state.stepTextbox,onChange:this.changeStep})]}),r("div",{className:"perseus-widget-right-col",children:[a("label",{htmlFor:"grid-step",children:"Grid Step"}),a(d,{id:"grid-step",value:this.state.gridStepTextbox,onChange:this.changeGridStep})]})]}),s.contains(this.props.editableSettings,"snap")&&a("div",{className:"perseus-widget-row",children:r("div",{className:"perseus-widget-left-col",children:[a("label",{htmlFor:"snap-step",children:"Snap Step"}),a(d,{id:"snap-step",value:this.state.snapStepTextbox,onChange:this.changeSnapStep})]})}),r("div",{className:"perseus-widget-row",children:[a("label",{children:"Markings: "}),a(C,{value:this.props.markings,allowEmpty:!1,buttons:[{value:"graph",content:"Graph"},{value:"grid",content:"Grid"},{value:"none",content:"None"}],onChange:this.change("markings")})]}),a("div",{className:"perseus-widget-left-col",children:a(f,{label:"Show tooltips",showTooltips:this.props.showTooltips,onChange:this.change})})]}),s.contains(this.props.editableSettings,"image")&&r("div",{className:"image-settings",children:[a("div",{children:"Background image:"}),r("div",{children:[a("label",{htmlFor:"bg-url",children:"Url:"}),a("input",{id:"bg-url",type:"text",className:"graph-settings-background-url",ref:"bg-url",value:this.state.backgroundImage.url||"",onChange:t=>{const n=s.clone(this.props.backgroundImage);n.url=t.target.value,this.setState({backgroundImage:n})},onKeyPress:this.changeBackgroundUrl,onBlur:this.changeBackgroundUrl}),a(G,{children:a("p",{children:'Create an image in graphie, or use the "Add image" function to create a background.'})})]})]}),s.contains(this.props.editableSettings,"measure")&&r("div",{className:"misc-settings",children:[r("div",{className:"perseus-widget-row",children:[a("div",{className:"perseus-widget-left-col",children:a(f,{label:"Show ruler",showRuler:this.props.showRuler,onChange:this.change})}),a("div",{className:"perseus-widget-right-col",children:a(f,{label:"Show protractor",showProtractor:this.props.showProtractor,onChange:this.change})})]}),this.props.showRuler&&r("div",{children:[a("div",{children:r("label",{children:[" ","Ruler label:"," ",r("select",{onChange:this.changeRulerLabel,value:this.props.rulerLabel,children:[a("option",{value:"",children:"None"}),a("optgroup",{label:"Metric",children:this.renderLabelChoices([["milimeters","mm"],["centimeters","cm"],["meters","m"],["kilometers","km"]])}),a("optgroup",{label:"Imperial",children:this.renderLabelChoices([["inches","in"],["feet","ft"],["yards","yd"],["miles","mi"]])})]})]})}),a("div",{children:r("label",{children:[" ","Ruler ticks:"," ",a("select",{onChange:this.changeRulerTicks,value:this.props.rulerTicks,children:s.map([1,2,4,8,10,16],function(t){return a("option",{value:t,children:t})})})]})})]})]})]})}};b.defaultProps={editableSettings:["graph","snap","image","measure"],box:[T.defaultBoxSizeSmall,T.defaultBoxSizeSmall],labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],gridStep:[1,1],snapStep:[1,1],valid:!0,backgroundImage:q,markings:"graph",showProtractor:!1,showRuler:!1,showTooltips:!1,rulerLabel:"",rulerTicks:10};let v=b;const ee=v;try{v.displayName="InteractiveGraphSettings",v.__docgenInfo={description:"",displayName:"InteractiveGraphSettings",props:{editableSettings:{defaultValue:{value:'["graph", "snap", "image", "measure"]'},description:"",name:"editableSettings",required:!1,type:{name:"readonly EditableSetting[]"}},box:{defaultValue:{value:`[
            interactiveSizes.defaultBoxSizeSmall,
            interactiveSizes.defaultBoxSizeSmall,
        ]`},description:"",name:"box",required:!1,type:{name:"[number, number]"}},labels:{defaultValue:{value:'["x", "y"]'},description:"",name:"labels",required:!1,type:{name:"readonly string[]"}},range:{defaultValue:{value:`[
            [-10, 10],
            [-10, 10],
        ]`},description:"",name:"range",required:!1,type:{name:"[[number, number], [number, number]]"}},step:{defaultValue:{value:"[1, 1]"},description:"",name:"step",required:!1,type:{name:"[number, number]"}},gridStep:{defaultValue:{value:"[1, 1]"},description:"",name:"gridStep",required:!1,type:{name:"[number, number]"}},snapStep:{defaultValue:{value:"[1, 1]"},description:"",name:"snapStep",required:!1,type:{name:"[number, number]"}},valid:{defaultValue:{value:"true"},description:"",name:"valid",required:!1,type:{name:"string | boolean"}},backgroundImage:{defaultValue:{value:`{
    url: null,
    width: 0,
    height: 0,
} as const`},description:"",name:"backgroundImage",required:!1,type:{name:"PerseusImageBackground"}},markings:{defaultValue:{value:"graph"},description:"",name:"markings",required:!1,type:{name:"enum",value:[{value:'"graph"'},{value:'"grid"'},{value:'"none"'}]}},showProtractor:{defaultValue:{value:"false"},description:"",name:"showProtractor",required:!1,type:{name:"boolean"}},showRuler:{defaultValue:{value:"false"},description:"",name:"showRuler",required:!1,type:{name:"boolean"}},showTooltips:{defaultValue:{value:"false"},description:"",name:"showTooltips",required:!1,type:{name:"boolean"}},rulerLabel:{defaultValue:{value:""},description:"",name:"rulerLabel",required:!1,type:{name:"string"}},rulerTicks:{defaultValue:{value:"10"},description:"",name:"rulerTicks",required:!1,type:{name:"number"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(arg1: Partial<Props>) => void"}}}}}catch{}export{ee as I};
