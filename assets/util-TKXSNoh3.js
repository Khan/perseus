import{a as $e}from"./version-akiLXZts.js";import{P as Ie,E as Ee}from"./perseus-error-l3K_anoI.js";import{_ as i}from"./index-default-4_ZsnO94.js";import{$ as Y}from"./jquery-5v7aFUvu.js";const ct="@khanacademy/kas",ut="__lib_version__";$e(ct,ut);(function(){var e=function(y,l,u,p){for(u=u||{},p=y.length;p--;u[y[p]]=l);return u},t=[1,11],n=[1,9],r=[8,17],s=[6,11],o=[6,11,13,17],a={trace:function(){},yy:{},symbols_:{error:2,unitvalue:3,magnitude:4,unit:5,EOF:6,float:7,POW:8,int:9,multatoms:10,DIV:11,expatom:12,MUL:13,atom:14,"^":15,nat:16,ATOM:17,FLOAT:18,NAT:19,NEG:20,$accept:0,$end:1},terminals_:{2:"error",6:"EOF",8:"POW",11:"DIV",13:"MUL",15:"^",17:"ATOM",18:"FLOAT",19:"NAT",20:"NEG"},productions_:[0,[3,3],[3,2],[4,3],[4,1],[5,3],[5,1],[10,3],[10,2],[10,1],[12,3],[12,1],[14,1],[7,1],[7,1],[16,1],[9,2],[9,1]],performAction:function(l,u,p,f,x,v,E){var _=v.length-1;switch(x){case 1:return{type:"unitMagnitude",magnitude:v[_-2],unit:v[_-1]};case 2:return{type:"unitStandalone",unit:v[_-1]};case 3:this.$=v[_-2]+"e"+v[_];break;case 4:case 13:case 14:case 15:case 17:this.$=v[_];break;case 5:this.$={num:v[_-2],denom:v[_]};break;case 6:this.$={num:v[_],denom:null};break;case 7:this.$=[v[_-2]].concat(v[_]);break;case 8:this.$=[v[_-1]].concat(v[_]);break;case 9:this.$=[v[_]];break;case 10:this.$={name:v[_-2],pow:v[_]};break;case 11:this.$={name:v[_],pow:1};break;case 12:this.$=l;break;case 16:this.$="-"+v[_];break}},table:[{3:1,4:2,5:3,7:4,10:5,12:8,14:10,16:7,17:t,18:[1,6],19:n},{1:[3]},{5:12,10:5,12:8,14:10,17:t},{6:[1,13]},{8:[1,14],17:[2,4]},{6:[2,6],11:[1,15]},e(r,[2,13]),e(r,[2,14]),e(s,[2,9],{12:8,14:10,10:17,13:[1,16],17:t}),e([6,8,11,13,17],[2,15]),e(o,[2,11],{15:[1,18]}),e([6,11,13,15,17],[2,12]),{6:[1,19]},{1:[2,2]},{9:20,19:[1,22],20:[1,21]},{10:23,12:8,14:10,17:t},{10:24,12:8,14:10,17:t},e(s,[2,8]),{16:25,19:n},{1:[2,1]},{17:[2,3]},{19:[1,26]},{17:[2,17]},{6:[2,5]},e(s,[2,7]),e(o,[2,10]),{17:[2,16]}],defaultActions:{13:[2,2],19:[2,1],20:[2,3],22:[2,17],23:[2,5],26:[2,16]},parseError:function(l,u){if(u.recoverable)this.trace(l);else throw new Error(l)},parse:function(l){var u=this,p=[0],f=[null],x=[],v=this.table,E="",_=0,z=0,j=2,le=1,ve=x.slice.call(arguments,1),C=Object.create(this.lexer),V={yy:{}};for(var ee in this.yy)Object.prototype.hasOwnProperty.call(this.yy,ee)&&(V.yy[ee]=this.yy[ee]);C.setInput(l,V.yy),V.yy.lexer=C,V.yy.parser=this,typeof C.yylloc>"u"&&(C.yylloc={});var q=C.yylloc;x.push(q);var ye=C.options&&C.options.ranges;typeof V.yy.parseError=="function"?this.parseError=V.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function Se(){var te;return te=C.lex()||le,typeof te!="number"&&(te=u.symbols_[te]||te),te}for(var U,J,b,S,w={},k,T,I,se;;){if(J=p[p.length-1],this.defaultActions[J]?b=this.defaultActions[J]:((U===null||typeof U>"u")&&(U=Se()),b=v[J]&&v[J][U]),typeof b>"u"||!b.length||!b[0]){var N="";se=[];for(k in v[J])this.terminals_[k]&&k>j&&se.push("'"+this.terminals_[k]+"'");C.showPosition?N="Parse error on line "+(_+1)+`:
`+C.showPosition()+`
Expecting `+se.join(", ")+", got '"+(this.terminals_[U]||U)+"'":N="Parse error on line "+(_+1)+": Unexpected "+(U==le?"end of input":"'"+(this.terminals_[U]||U)+"'"),this.parseError(N,{text:C.match,token:this.terminals_[U]||U,line:C.yylineno,loc:q,expected:se})}if(b[0]instanceof Array&&b.length>1)throw new Error("Parse Error: multiple actions possible at state: "+J+", token: "+U);switch(b[0]){case 1:p.push(U),f.push(C.yytext),x.push(C.yylloc),p.push(b[1]),U=null,z=C.yyleng,E=C.yytext,_=C.yylineno,q=C.yylloc;break;case 2:if(T=this.productions_[b[1]][1],w.$=f[f.length-T],w._$={first_line:x[x.length-(T||1)].first_line,last_line:x[x.length-1].last_line,first_column:x[x.length-(T||1)].first_column,last_column:x[x.length-1].last_column},ye&&(w._$.range=[x[x.length-(T||1)].range[0],x[x.length-1].range[1]]),S=this.performAction.apply(w,[E,z,_,V.yy,b[1],f,x].concat(ve)),typeof S<"u")return S;T&&(p=p.slice(0,-1*T*2),f=f.slice(0,-1*T),x=x.slice(0,-1*T)),p.push(this.productions_[b[1]][0]),f.push(w.$),x.push(w._$),I=v[p[p.length-2]][p[p.length-1]],p.push(I);break;case 3:return!0}}return!0}},c=function(){var y={EOF:1,parseError:function(u,p){if(this.yy.parser)this.yy.parser.parseError(u,p);else throw new Error(u)},setInput:function(l,u){return this.yy=u||this.yy||{},this._input=l,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var l=this._input[0];this.yytext+=l,this.yyleng++,this.offset++,this.match+=l,this.matched+=l;var u=l.match(/(?:\r\n?|\n).*/g);return u?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),l},unput:function(l){var u=l.length,p=l.split(/(?:\r\n?|\n)/g);this._input=l+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-u),this.offset-=u;var f=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),p.length-1&&(this.yylineno-=p.length-1);var x=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:p?(p.length===f.length?this.yylloc.first_column:0)+f[f.length-p.length].length-p[0].length:this.yylloc.first_column-u},this.options.ranges&&(this.yylloc.range=[x[0],x[0]+this.yyleng-u]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(l){this.unput(this.match.slice(l))},pastInput:function(){var l=this.matched.substr(0,this.matched.length-this.match.length);return(l.length>20?"...":"")+l.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var l=this.match;return l.length<20&&(l+=this._input.substr(0,20-l.length)),(l.substr(0,20)+(l.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var l=this.pastInput(),u=new Array(l.length+1).join("-");return l+this.upcomingInput()+`
`+u+"^"},test_match:function(l,u){var p,f,x;if(this.options.backtrack_lexer&&(x={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(x.yylloc.range=this.yylloc.range.slice(0))),f=l[0].match(/(?:\r\n?|\n).*/g),f&&(this.yylineno+=f.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:f?f[f.length-1].length-f[f.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+l[0].length},this.yytext+=l[0],this.match+=l[0],this.matches=l,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(l[0].length),this.matched+=l[0],p=this.performAction.call(this,this.yy,this,u,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),p)return p;if(this._backtrack){for(var v in x)this[v]=x[v];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var l,u,p,f;this._more||(this.yytext="",this.match="");for(var x=this._currentRules(),v=0;v<x.length;v++)if(p=this._input.match(this.rules[x[v]]),p&&(!u||p[0].length>u[0].length)){if(u=p,f=v,this.options.backtrack_lexer){if(l=this.test_match(p,x[v]),l!==!1)return l;if(this._backtrack){u=!1;continue}else return!1}else if(!this.options.flex)break}return u?(l=this.test_match(u,x[f]),l!==!1?l:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var u=this.next();return u||this.lex()},begin:function(u){this.conditionStack.push(u)},popState:function(){var u=this.conditionStack.length-1;return u>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(u){return u=this.conditionStack.length-1-Math.abs(u||0),u>=0?this.conditionStack[u]:"INITIAL"},pushState:function(u){this.begin(u)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(u,p,f,x){switch(f){case 0:return 11;case 1:return"(";case 2:return")";case 3:return 8;case 4:return 15;case 5:return 13;case 6:return 18;case 7:return 19;case 8:return 20;case 9:return 17;case 10:return 17;case 11:return 17;case 12:break;case 13:return 6}},rules:[/^(?:\/)/,/^(?:\()/,/^(?:\))/,/^(?:(\*|x|\u00d7|\u2219|\u22c5|\u00b7)\s*10\s*\^)/,/^(?:\^)/,/^(?:\*)/,/^(?:[0-9]+\.[0-9]+)/,/^(?:[0-9]+)/,/^(?:-)/,/^(?:\u00b0( ?)[cCfF])/,/^(?:fl\.? oz\.?)/,/^(?:[\u00b5]?([A-Za-z-]+|[\u2103\u2109\u212b]))/,/^(?:\s+)/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};return y}();a.lexer=c;function h(){this.yy={}}return h.prototype=a,a.Parser=h,new h})();var ge=function(){var e=function(J,b,S,w){for(S=S||{},w=J.length;w--;S[J[w]]=b);return S},t=[1,7],n=[1,17],r=[1,13],s=[1,14],o=[1,15],a=[1,32],c=[1,22],h=[1,23],y=[1,24],l=[1,25],u=[1,26],p=[1,33],f=[1,27],x=[1,28],v=[1,29],E=[1,30],_=[1,20],z=[1,36],j=[1,37],le=[5,6,8,10,33,35,41,43,45],ve=[1,39],C=[1,40],V=[5,6,8,10,12,14,16,19,21,22,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],ee=[10,16,19,21,22,28,29,30,31,32,34,37,39,42,43,44,46],q=[5,6,8,10,12,14,16,18,19,21,22,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],ye={trace:function(){},yy:{},symbols_:{error:2,equation:3,expression:4,SIGN:5,EOF:6,additive:7,"+":8,multiplicative:9,"-":10,triglog:11,"*":12,negative:13,"/":14,trig:15,TRIG:16,trigfunc:17,"^":18,TRIGINV:19,logbase:20,ln:21,log:22,_:23,subscriptable:24,power:25,primitive:26,variable:27,VAR:28,CONST:29,INT:30,FLOAT:31,"{":32,"}":33,"(":34,")":35,function:36,FUNC:37,invocation:38,sqrt:39,"[":40,"]":41,abs:42,"|":43,"LEFT|":44,"RIGHT|":45,FRAC:46,$accept:0,$end:1},terminals_:{2:"error",5:"SIGN",6:"EOF",8:"+",10:"-",12:"*",14:"/",16:"TRIG",18:"^",19:"TRIGINV",21:"ln",22:"log",23:"_",28:"VAR",29:"CONST",30:"INT",31:"FLOAT",32:"{",33:"}",34:"(",35:")",37:"FUNC",39:"sqrt",40:"[",41:"]",42:"abs",43:"|",44:"LEFT|",45:"RIGHT|",46:"FRAC"},productions_:[0,[3,4],[3,2],[3,1],[4,1],[7,3],[7,3],[7,1],[9,2],[9,3],[9,3],[9,1],[13,2],[13,1],[15,1],[17,1],[17,3],[17,1],[20,1],[20,1],[20,3],[11,2],[11,2],[11,1],[25,3],[25,1],[27,1],[24,3],[24,1],[24,1],[24,1],[24,1],[24,3],[24,3],[36,1],[38,4],[38,4],[38,7],[38,4],[38,3],[38,3],[38,4],[26,1],[26,1],[26,7]],performAction:function(b,S,w,k,T,I,se){var N=I.length-1;switch(T){case 1:return new k.Eq(I[N-3],I[N-2],I[N-1]);case 2:return I[N-1];case 3:return new k.Add([]);case 4:case 7:case 11:case 13:case 15:case 20:case 23:case 25:case 42:case 43:this.$=I[N];break;case 5:this.$=k.Add.createOrAppend(I[N-2],I[N]);break;case 6:this.$=k.Add.createOrAppend(I[N-2],k.Mul.handleNegative(I[N],"subtract"));break;case 8:this.$=k.Mul.fold(k.Mul.createOrAppend(I[N-1],I[N]));break;case 9:this.$=k.Mul.fold(k.Mul.createOrAppend(I[N-2],I[N]));break;case 10:this.$=k.Mul.fold(k.Mul.handleDivide(I[N-2],I[N]));break;case 12:this.$=k.Mul.handleNegative(I[N]);break;case 14:case 17:this.$=[b];break;case 16:this.$=I[N-2].concat(I[N]);break;case 18:this.$=k.Log.natural();break;case 19:this.$=k.Log.common();break;case 21:this.$=k.Trig.create(I[N-1],I[N]);break;case 22:this.$=k.Log.create(I[N-1],I[N]);break;case 24:this.$=new k.Pow(I[N-2],I[N]);break;case 26:case 34:this.$=b;break;case 27:this.$=new k.Var(I[N-2],I[N]);break;case 28:this.$=new k.Var(I[N]);break;case 29:this.$=new k.Const(b.toLowerCase());break;case 30:this.$=k.Int.create(Number(b));break;case 31:this.$=k.Float.create(Number(b));break;case 32:this.$=I[N-1].completeParse();break;case 33:this.$=I[N-1].completeParse().addHint("parens");break;case 35:case 36:this.$=k.Pow.sqrt(I[N-1]);break;case 37:this.$=new k.Pow.nthroot(I[N-1],I[N-4]);break;case 38:case 39:case 40:this.$=new k.Abs(I[N-1]);break;case 41:this.$=new k.Func(I[N-3],I[N-1]);break;case 44:this.$=k.Mul.handleDivide(I[N-4],I[N-1]);break}},table:[{3:1,4:2,6:[1,3],7:4,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:s,22:o,24:18,25:11,26:16,27:21,28:a,29:c,30:h,31:y,32:l,34:u,36:31,37:p,38:19,39:f,42:x,43:v,44:E,46:_},{1:[3]},{5:[1,34],6:[1,35]},{1:[2,3]},e([5,6],[2,4],{8:z,10:j}),e(le,[2,7],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:ve,14:C,16:n,19:r,21:s,22:o,28:a,29:c,30:h,31:y,32:l,34:u,37:p,39:f,42:x,44:E,46:_}),e(V,[2,11]),{10:t,11:8,13:41,15:12,16:n,17:9,19:r,20:10,21:s,22:o,24:18,25:11,26:16,27:21,28:a,29:c,30:h,31:y,32:l,34:u,36:31,37:p,38:19,39:f,42:x,43:v,44:E,46:_},e(V,[2,13]),{10:t,11:8,13:42,15:12,16:n,17:9,19:r,20:10,21:s,22:o,24:18,25:11,26:16,27:21,28:a,29:c,30:h,31:y,32:l,34:u,36:31,37:p,38:19,39:f,42:x,43:v,44:E,46:_},{10:t,11:8,13:43,15:12,16:n,17:9,19:r,20:10,21:s,22:o,24:18,25:11,26:16,27:21,28:a,29:c,30:h,31:y,32:l,34:u,36:31,37:p,38:19,39:f,42:x,43:v,44:E,46:_},e(V,[2,23]),e(ee,[2,15],{18:[1,44]}),e(ee,[2,17]),e(ee,[2,18]),e(ee,[2,19],{23:[1,45]}),e(V,[2,25],{18:[1,46]}),e([10,16,18,19,21,22,28,29,30,31,32,34,37,39,42,43,44,46],[2,14]),e(q,[2,42]),e(q,[2,43]),{32:[1,47]},e(q,[2,28],{23:[1,48]}),e(q,[2,29]),e(q,[2,30]),e(q,[2,31]),{7:49,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:s,22:o,24:18,25:11,26:16,27:21,28:a,29:c,30:h,31:y,32:l,34:u,36:31,37:p,38:19,39:f,42:x,43:v,44:E,46:_},{7:50,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:s,22:o,24:18,25:11,26:16,27:21,28:a,29:c,30:h,31:y,32:l,34:u,36:31,37:p,38:19,39:f,42:x,43:v,44:E,46:_},{32:[1,52],34:[1,51],40:[1,53]},{34:[1,54]},{7:55,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:s,22:o,24:18,25:11,26:16,27:21,28:a,29:c,30:h,31:y,32:l,34:u,36:31,37:p,38:19,39:f,42:x,43:v,44:E,46:_},{7:56,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:s,22:o,24:18,25:11,26:16,27:21,28:a,29:c,30:h,31:y,32:l,34:u,36:31,37:p,38:19,39:f,42:x,43:v,44:E,46:_},{34:[1,57]},e([5,6,8,10,12,14,16,18,19,21,22,23,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],[2,26]),{34:[2,34]},{4:58,7:4,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:s,22:o,24:18,25:11,26:16,27:21,28:a,29:c,30:h,31:y,32:l,34:u,36:31,37:p,38:19,39:f,42:x,43:v,44:E,46:_},{1:[2,2]},{9:59,10:t,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:s,22:o,24:18,25:11,26:16,27:21,28:a,29:c,30:h,31:y,32:l,34:u,36:31,37:p,38:19,39:f,42:x,43:v,44:E,46:_},{9:60,10:t,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:s,22:o,24:18,25:11,26:16,27:21,28:a,29:c,30:h,31:y,32:l,34:u,36:31,37:p,38:19,39:f,42:x,43:v,44:E,46:_},e(V,[2,8]),{10:t,11:8,13:61,15:12,16:n,17:9,19:r,20:10,21:s,22:o,24:18,25:11,26:16,27:21,28:a,29:c,30:h,31:y,32:l,34:u,36:31,37:p,38:19,39:f,42:x,43:v,44:E,46:_},{10:t,11:8,13:62,15:12,16:n,17:9,19:r,20:10,21:s,22:o,24:18,25:11,26:16,27:21,28:a,29:c,30:h,31:y,32:l,34:u,36:31,37:p,38:19,39:f,42:x,43:v,44:E,46:_},e(V,[2,12]),e(V,[2,21]),e(V,[2,22]),{10:t,11:8,13:63,15:12,16:n,17:9,19:r,20:10,21:s,22:o,24:18,25:11,26:16,27:21,28:a,29:c,30:h,31:y,32:l,34:u,36:31,37:p,38:19,39:f,42:x,43:v,44:E,46:_},{24:64,27:21,28:a,29:c,30:h,31:y,32:l,34:u},{10:t,11:8,13:65,15:12,16:n,17:9,19:r,20:10,21:s,22:o,24:18,25:11,26:16,27:21,28:a,29:c,30:h,31:y,32:l,34:u,36:31,37:p,38:19,39:f,42:x,43:v,44:E,46:_},{7:66,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:s,22:o,24:18,25:11,26:16,27:21,28:a,29:c,30:h,31:y,32:l,34:u,36:31,37:p,38:19,39:f,42:x,43:v,44:E,46:_},{24:67,27:21,28:a,29:c,30:h,31:y,32:l,34:u},{8:z,10:j,33:[1,68]},{8:z,10:j,35:[1,69]},{7:70,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:s,22:o,24:18,25:11,26:16,27:21,28:a,29:c,30:h,31:y,32:l,34:u,36:31,37:p,38:19,39:f,42:x,43:v,44:E,46:_},{7:71,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:s,22:o,24:18,25:11,26:16,27:21,28:a,29:c,30:h,31:y,32:l,34:u,36:31,37:p,38:19,39:f,42:x,43:v,44:E,46:_},{7:72,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:s,22:o,24:18,25:11,26:16,27:21,28:a,29:c,30:h,31:y,32:l,34:u,36:31,37:p,38:19,39:f,42:x,43:v,44:E,46:_},{7:73,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:s,22:o,24:18,25:11,26:16,27:21,28:a,29:c,30:h,31:y,32:l,34:u,36:31,37:p,38:19,39:f,42:x,43:v,44:E,46:_},{8:z,10:j,43:[1,74]},{8:z,10:j,45:[1,75]},{7:76,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:s,22:o,24:18,25:11,26:16,27:21,28:a,29:c,30:h,31:y,32:l,34:u,36:31,37:p,38:19,39:f,42:x,43:v,44:E,46:_},{6:[1,77]},e(le,[2,5],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:ve,14:C,16:n,19:r,21:s,22:o,28:a,29:c,30:h,31:y,32:l,34:u,37:p,39:f,42:x,44:E,46:_}),e(le,[2,6],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:ve,14:C,16:n,19:r,21:s,22:o,28:a,29:c,30:h,31:y,32:l,34:u,37:p,39:f,42:x,44:E,46:_}),e(V,[2,9]),e(V,[2,10]),e(ee,[2,16]),e(ee,[2,20]),e(V,[2,24]),{8:z,10:j,33:[1,78]},e(q,[2,27]),e(q,[2,32]),e(q,[2,33]),{8:z,10:j,35:[1,79]},{8:z,10:j,33:[1,80]},{8:z,10:j,41:[1,81]},{8:z,10:j,35:[1,82]},e(q,[2,39]),e(q,[2,40]),{8:z,10:j,35:[1,83]},{1:[2,1]},{32:[1,84]},e(q,[2,35]),e(q,[2,36]),{32:[1,85]},e(q,[2,38]),e(q,[2,41]),{7:86,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:s,22:o,24:18,25:11,26:16,27:21,28:a,29:c,30:h,31:y,32:l,34:u,36:31,37:p,38:19,39:f,42:x,43:v,44:E,46:_},{7:87,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:s,22:o,24:18,25:11,26:16,27:21,28:a,29:c,30:h,31:y,32:l,34:u,36:31,37:p,38:19,39:f,42:x,43:v,44:E,46:_},{8:z,10:j,33:[1,88]},{8:z,10:j,33:[1,89]},e(q,[2,44]),e(q,[2,37])],defaultActions:{3:[2,3],33:[2,34],35:[2,2],77:[2,1]},parseError:function(b,S){if(S.recoverable)this.trace(b);else throw new Error(b)},parse:function(b){var S=this,w=[0],k=[null],T=[],I=this.table,se="",N=0,te=0,it=2,Ve=1,st=T.slice.call(arguments,1),H=Object.create(this.lexer),ce={yy:{}};for(var Ne in this.yy)Object.prototype.hasOwnProperty.call(this.yy,Ne)&&(ce.yy[Ne]=this.yy[Ne]);H.setInput(b,ce.yy),ce.yy.lexer=H,ce.yy.parser=this,typeof H.yylloc>"u"&&(H.yylloc={});var Te=H.yylloc;T.push(Te);var at=H.options&&H.options.ranges;typeof ce.yy.parseError=="function"?this.parseError=ce.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function ot(){var he;return he=H.lex()||Ve,typeof he!="number"&&(he=S.symbols_[he]||he),he}for(var $,ue,K,Pe,fe={},Me,ne,Ge,ke;;){if(ue=w[w.length-1],this.defaultActions[ue]?K=this.defaultActions[ue]:(($===null||typeof $>"u")&&($=ot()),K=I[ue]&&I[ue][$]),typeof K>"u"||!K.length||!K[0]){var Ae="";ke=[];for(Me in I[ue])this.terminals_[Me]&&Me>it&&ke.push("'"+this.terminals_[Me]+"'");H.showPosition?Ae="Parse error on line "+(N+1)+`:
`+H.showPosition()+`
Expecting `+ke.join(", ")+", got '"+(this.terminals_[$]||$)+"'":Ae="Parse error on line "+(N+1)+": Unexpected "+($==Ve?"end of input":"'"+(this.terminals_[$]||$)+"'"),this.parseError(Ae,{text:H.match,token:this.terminals_[$]||$,line:H.yylineno,loc:Te,expected:ke})}if(K[0]instanceof Array&&K.length>1)throw new Error("Parse Error: multiple actions possible at state: "+ue+", token: "+$);switch(K[0]){case 1:w.push($),k.push(H.yytext),T.push(H.yylloc),w.push(K[1]),$=null,te=H.yyleng,se=H.yytext,N=H.yylineno,Te=H.yylloc;break;case 2:if(ne=this.productions_[K[1]][1],fe.$=k[k.length-ne],fe._$={first_line:T[T.length-(ne||1)].first_line,last_line:T[T.length-1].last_line,first_column:T[T.length-(ne||1)].first_column,last_column:T[T.length-1].last_column},at&&(fe._$.range=[T[T.length-(ne||1)].range[0],T[T.length-1].range[1]]),Pe=this.performAction.apply(fe,[se,te,N,ce.yy,K[1],k,T].concat(st)),typeof Pe<"u")return Pe;ne&&(w=w.slice(0,-1*ne*2),k=k.slice(0,-1*ne),T=T.slice(0,-1*ne)),w.push(this.productions_[K[1]][0]),k.push(fe.$),T.push(fe._$),Ge=I[w[w.length-2]][w[w.length-1]],w.push(Ge);break;case 3:return!0}}return!0}},Se=function(){var J={EOF:1,parseError:function(S,w){if(this.yy.parser)this.yy.parser.parseError(S,w);else throw new Error(S)},setInput:function(b,S){return this.yy=S||this.yy||{},this._input=b,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var b=this._input[0];this.yytext+=b,this.yyleng++,this.offset++,this.match+=b,this.matched+=b;var S=b.match(/(?:\r\n?|\n).*/g);return S?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),b},unput:function(b){var S=b.length,w=b.split(/(?:\r\n?|\n)/g);this._input=b+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-S),this.offset-=S;var k=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),w.length-1&&(this.yylineno-=w.length-1);var T=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:w?(w.length===k.length?this.yylloc.first_column:0)+k[k.length-w.length].length-w[0].length:this.yylloc.first_column-S},this.options.ranges&&(this.yylloc.range=[T[0],T[0]+this.yyleng-S]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(b){this.unput(this.match.slice(b))},pastInput:function(){var b=this.matched.substr(0,this.matched.length-this.match.length);return(b.length>20?"...":"")+b.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var b=this.match;return b.length<20&&(b+=this._input.substr(0,20-b.length)),(b.substr(0,20)+(b.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var b=this.pastInput(),S=new Array(b.length+1).join("-");return b+this.upcomingInput()+`
`+S+"^"},test_match:function(b,S){var w,k,T;if(this.options.backtrack_lexer&&(T={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(T.yylloc.range=this.yylloc.range.slice(0))),k=b[0].match(/(?:\r\n?|\n).*/g),k&&(this.yylineno+=k.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:k?k[k.length-1].length-k[k.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+b[0].length},this.yytext+=b[0],this.match+=b[0],this.matches=b,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(b[0].length),this.matched+=b[0],w=this.performAction.call(this,this.yy,this,S,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),w)return w;if(this._backtrack){for(var I in T)this[I]=T[I];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var b,S,w,k;this._more||(this.yytext="",this.match="");for(var T=this._currentRules(),I=0;I<T.length;I++)if(w=this._input.match(this.rules[T[I]]),w&&(!S||w[0].length>S[0].length)){if(S=w,k=I,this.options.backtrack_lexer){if(b=this.test_match(w,T[I]),b!==!1)return b;if(this._backtrack){S=!1;continue}else return!1}else if(!this.options.flex)break}return S?(b=this.test_match(S,T[k]),b!==!1?b:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var S=this.next();return S||this.lex()},begin:function(S){this.conditionStack.push(S)},popState:function(){var S=this.conditionStack.length-1;return S>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(S){return S=this.conditionStack.length-1-Math.abs(S||0),S>=0?this.conditionStack[S]:"INITIAL"},pushState:function(S){this.begin(S)},stateStackSize:function(){return this.conditionStack.length},options:{flex:!0},performAction:function(S,w,k,T){switch(k){case 0:break;case 1:break;case 2:break;case 3:return"INT";case 4:return"FLOAT";case 5:return"^";case 6:return"*";case 7:return"*";case 8:return"*";case 9:return"*";case 10:return"/";case 11:return"/";case 12:return"-";case 13:return"-";case 14:return"+";case 15:return"^";case 16:return"(";case 17:return")";case 18:return"(";case 19:return")";case 20:return"[";case 21:return"]";case 22:return"{";case 23:return"}";case 24:return"{";case 25:return"}";case 26:return"_";case 27:return"|";case 28:return"LEFT|";case 29:return"RIGHT|";case 30:return"!";case 31:return"SIGN";case 32:return w.yytext="<=","SIGN";case 33:return w.yytext=">=","SIGN";case 34:return w.yytext="<=","SIGN";case 35:return w.yytext=">=","SIGN";case 36:return w.yytext="<>","SIGN";case 37:return w.yytext="<>","SIGN";case 38:return w.yytext="<>","SIGN";case 39:return w.yytext="<>","SIGN";case 40:return w.yytext="<=","SIGN";case 41:return w.yytext=">=","SIGN";case 42:return"FRAC";case 43:return"FRAC";case 44:return"sqrt";case 45:return"abs";case 46:return"ln";case 47:return"log";case 48:return"TRIG";case 49:return"TRIG";case 50:return"TRIG";case 51:return"TRIG";case 52:return w.yytext="sin","TRIG";case 53:return w.yytext="cos","TRIG";case 54:return w.yytext="tan","TRIG";case 55:return w.yytext="csc","TRIG";case 56:return w.yytext="sec","TRIG";case 57:return w.yytext="cot","TRIG";case 58:return w.yytext="arcsin","TRIG";case 59:return w.yytext="arccos","TRIG";case 60:return w.yytext="arctan","TRIG";case 61:return w.yytext="arccsc","TRIG";case 62:return w.yytext="arcsec","TRIG";case 63:return w.yytext="arccot","TRIG";case 64:return"TRIGINV";case 65:return"TRIGINV";case 66:return w.yytext="sinh","TRIG";case 67:return w.yytext="cosh","TRIG";case 68:return w.yytext="tanh","TRIG";case 69:return w.yytext="csch","TRIG";case 70:return w.yytext="sech","TRIG";case 71:return w.yytext="tanh","TRIG";case 72:return"CONST";case 73:return w.yytext="pi","CONST";case 74:return w.yytext="pi","CONST";case 75:return"VAR";case 76:return w.yytext="theta","VAR";case 77:return w.yytext="theta","VAR";case 78:return"VAR";case 79:return w.yytext="phi","VAR";case 80:return w.yytext="phi","VAR";case 81:return S.symbolLexer(w.yytext);case 82:return"EOF";case 83:return"INVALID";case 84:console.log(w.yytext);break}},rules:[/^(?:\s+)/,/^(?:\\space)/,/^(?:\\ )/,/^(?:[0-9]+\.?)/,/^(?:([0-9]+)?\.[0-9]+)/,/^(?:\*\*)/,/^(?:\*)/,/^(?:\\cdot|·)/,/^(?:\\times|×)/,/^(?:\\ast)/,/^(?:\/)/,/^(?:\\div|÷)/,/^(?:-)/,/^(?:−)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:\\left\()/,/^(?:\\right\))/,/^(?:\[)/,/^(?:\])/,/^(?:\{)/,/^(?:\})/,/^(?:\\left\{)/,/^(?:\\right\})/,/^(?:_)/,/^(?:\|)/,/^(?:\\left\|)/,/^(?:\\right\|)/,/^(?:\!)/,/^(?:<=|>=|<>|<|>|=)/,/^(?:\\le)/,/^(?:\\ge)/,/^(?:\\leq)/,/^(?:\\geq)/,/^(?:=\/=)/,/^(?:\\ne)/,/^(?:\\neq)/,/^(?:≠)/,/^(?:≤)/,/^(?:≥)/,/^(?:\\frac)/,/^(?:\\dfrac)/,/^(?:sqrt|\\sqrt)/,/^(?:abs|\\abs)/,/^(?:ln|\\ln)/,/^(?:log|\\log)/,/^(?:sin|cos|tan)/,/^(?:csc|sec|cot)/,/^(?:sinh|cosh|tanh)/,/^(?:csch|sech|coth)/,/^(?:\\sin)/,/^(?:\\cos)/,/^(?:\\tan)/,/^(?:\\csc)/,/^(?:\\sec)/,/^(?:\\cot)/,/^(?:\\arcsin)/,/^(?:\\arccos)/,/^(?:\\arctan)/,/^(?:\\arccsc)/,/^(?:\\arcsec)/,/^(?:\\arccot)/,/^(?:arcsin|arccos|arctan)/,/^(?:arccsc|arcsec|arccot)/,/^(?:\\sinh)/,/^(?:\\cosh)/,/^(?:\\tanh)/,/^(?:\\csch)/,/^(?:\\sech)/,/^(?:\\coth)/,/^(?:pi)/,/^(?:π)/,/^(?:\\pi)/,/^(?:theta)/,/^(?:θ)/,/^(?:\\theta)/,/^(?:phi)/,/^(?:φ)/,/^(?:\\phi)/,/^(?:[a-zA-Z])/,/^(?:$)/,/^(?:.)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84],inclusive:!0}}};return J}();ye.lexer=Se;function U(){this.yy={}}return U.prototype=ye,ye.Parser=U,new U}(),Z=function(){throw new Error("Abstract method - must override for expr: "+this.print())},Le=function(e){throw new Error(e)},ze=function(e){return e!==e},lt=function(e,t){var n=t-e;return Math.random()*n+e},Ue=12,He=9;function Q(){}i.extend(Q.prototype,{func:Z,args:Z,construct:function(e){var t=new this.func;return this.func.apply(t,e),t},recurse:function(e){var t=Array.prototype.slice.call(arguments,1),n=i.map(this.args(),function(r){return i.isString(r)?r:r[e].apply(r,t)});return this.construct(n)},eval:Z,codegen:Z,compile:function(){var e=this.codegen();try{return new Function("vars","return "+e+";")}catch{throw new Error("Function did not compile: "+e)}},print:Z,tex:Z,asTex:function(e){e=e||{},i.defaults(e,{display:!0,dynamic:!0,times:!1});var t=this.tex();return e.display&&(t="\\displaystyle "+t),e.dynamic&&(t=t.replace(/\(/g,"\\left("),t=t.replace(/\)/g,"\\right)")),e.times&&(t=t.replace(/\\cdot/g,"\\times")),t},name:function(){return this.func.name?this.func.name:this.func.toString().match(/^function\s*([^\s(]+)/)[1]},repr:function(){return this.name()+"("+i.map(this.args(),function(e){return i.isString(e)?e:e.repr()}).join(",")+")"},strip:function(){return this.recurse("strip")},normalize:function(){return this.recurse("normalize")},expand:function(){return this.recurse("expand")},factor:function(e){return this.recurse("factor",e)},collect:function(e){return this.recurse("collect",e)},equals:function(e){return this.normalize().print()===e.normalize().print()},simplify:function(e){e=i.extend({once:!1},e);var t=this.factor(e),n=t.collect(e);t.equals(n)&&(n=this.collect(e));var r=n.expand(e),s=r.collect(e);r.equals(s)&&(s=n.collect(e));var o=s;return e.once||this.equals(o)?o:o.simplify(e)},isSimplified:function(){return this.equals(this.simplify())},exprArgs:function(){return i.filter(this.args(),function(e){return e instanceof Q})},getVars:function(e){return i.uniq(i.flatten(i.invoke(this.exprArgs(),"getVars",e))).sort()},getConsts:function(){return i.uniq(i.flatten(i.invoke(this.exprArgs(),"getConsts"))).sort()},getUnits:function(){return i.flatten(i.invoke(this.exprArgs(),"getUnits"))},is:function(e){return this instanceof e},has:function(e){return this instanceof e?!0:i.any(this.exprArgs(),function(t){return t.has(e)})},raiseToThe:function(e){return new P(this,e)},isSubtract:function(){return!1},isDivide:function(){return!1},isRoot:function(){return!1},needsExplicitMul:function(){return this.args()[0].needsExplicitMul()},sameVars:function(e){var t=this.getVars(),n=e.getVars(),r=function(c,h){return!i.difference(c,h).length},s=function(c){return i.uniq(i.invoke(c,"toLowerCase")).sort()},o=r(t,n),a=r(s(t),s(n));return{equal:o,equalIgnoringCase:a}},compare:function(e){if(e instanceof ae)return!1;var t=i.union(this.getVars(!0),e.getVars(!0)),n=function(v,E){return Math.abs(v)<1||Math.abs(E)<1?Math.abs(v-E):Math.abs(1-v/E)},r=function(v,E){var _=n(v,E);return v===E||ze(v)&&ze(E)||_<Math.pow(10,-He)};if(!t.length&&!this.has(B)&&!e.has(B))return r(this.eval(),e.eval());var s=this.collect(),o=e.collect(),a=this.getUnits(),c=e.getUnits();if(!i.isEqual(a,c))return!1;for(var h=0;h<Ue;h++){var y={},l=Math.pow(10,1+Math.floor(3*h/Ue)),u=h%2===0;i.each(t,function(v){y[v]=u?lt(-l,l):i.random(-l,l)});var p;if(s.has(ie)||o.has(ie)||s.has(B)||o.has(B)){var f=s.partialEval(y),x=o.partialEval(y);p=f.simplify().equals(x.simplify())}else{var f=s.eval(y),x=o.eval(y);p=r(f,x)}if(!p)return!1}return!0},partialEval:function(e){return this instanceof B?this:this.has(ie)?this instanceof ie?new ie(this.symbol,this.arg.partialEval(e)):this.recurse("partialEval",e):new G(this.eval(e).toFixed(He)).collect()},sameForm:function(e){return this.strip().equals(e.strip())},findGCD:function(e){return this.equals(e)?e:d.One},getDenominator:function(){return d.One},asMul:function(){return new m(d.One,this)},isPositive:Z,isNegative:function(){return!1},asPositiveFactor:function(){return this.isPositive()?this:d.One},addHint:function(e){if(!e)return this;var t=this.construct(this.args());return t.hints=i.clone(this.hints),t.hints[e]=!0,t},hints:{parens:!1},asExpr:function(){return this},completeParse:function(){return this.recurse("completeParse")},abs:Z,negate:function(){return new m(d.Neg,this)}});function me(){}me.prototype=new Q;i.extend(me.prototype,{args:function(){return this.terms},normalize:function(){var e=i.sortBy(i.invoke(this.terms,"normalize"),function(t){return t.print()});return new this.func(e)},expand:function(){return this.recurse("expand").flatten()},partition:function(){var e=i.groupBy(this.terms,function(r){return r instanceof d}),t=e[!0]||[],n=e[!1]||[];return[new this.func(t),new this.func(n)]},flatten:function(){var e=this,t=i.reject(this.terms,function(a){return a.equals(e.identity)});if(t.length===0)return e.identity;if(t.length===1)return t[0];var n=i.groupBy(t,function(a){return a instanceof e.func}),r=n[!0]||[],s=n[!1]||[],o=s.concat(i.flatten(i.pluck(r,"terms"),!0));return new e.func(o)},identity:void 0,reduce:Z,isPositive:function(){var e=i.invoke(this.terms,"collect");return i.all(i.invoke(e,"isPositive"))},replace:function(e,t){var n;e instanceof Q?n=i.indexOf(this.terms,e):n=e;var r=[];i.isArray(t)?r=t:t&&(r=[t]);var s=this.terms.slice(0,n).concat(r).concat(this.terms.slice(n+1));return new this.func(s)},remove:function(e){return this.replace(e)},getDenominator:function(){return new m(i.invoke(this.terms,"getDenominator")).flatten()}});function R(){arguments.length===1?this.terms=arguments[0]:this.terms=i.toArray(arguments)}R.prototype=new me;i.extend(R.prototype,{func:R,eval:function(e,t){return i.reduce(this.terms,function(n,r){return n+r.eval(e,t)},0)},codegen:function(){return i.map(this.terms,function(e){return"("+e.codegen()+")"}).join(" + ")||"0"},print:function(){return i.invoke(this.terms,"print").join("+")},tex:function(){var e="";return i.each(this.terms,function(t){!e||t.isSubtract()?e+=t.tex():e+="+"+t.tex()}),e},collect:function(e){var t=i.invoke(this.terms,"collect",e),n=[];i.each(t,function(o){if(o instanceof m){var a=o.partition();n.push([a[1].flatten(),a[0].reduce(e)])}else o instanceof d?n.push([d.One,o]):n.push([o,d.One])});var r=i.groupBy(n,function(o){return o[0].normalize().print()}),s=i.compact(i.map(r,function(o){var a=o[0][0],c=new R(i.zip.apply(i,o)[1]),h=c.reduce(e);return new m(h,a).collect(e)}));return new R(s).flatten()},factor:function(e){e=i.extend({keepNegative:!1},e);var t=i.invoke(this.terms,"collect"),n;t[0]instanceof m?n=t[0].terms:n=[t[0]],i.each(i.rest(this.terms),function(s){n=i.map(n,function(o){return s.findGCD(o)})}),!e.keepNegative&&this.isNegative()&&n.push(d.Neg),n=new m(n).flatten().collect();var r=i.map(t,function(s){return m.handleDivide(s,n).simplify()});return r=new R(r).flatten(),m.createOrAppend(n,r).flatten()},reduce:function(e){return i.reduce(this.terms,function(t,n){return t.add(n,e)},this.identity)},needsExplicitMul:function(){return!1},isNegative:function(){var e=i.invoke(this.terms,"collect");return i.all(i.invoke(e,"isNegative"))},negate:function(){return new R(i.invoke(this.terms,"negate"))}});function m(){arguments.length===1?this.terms=arguments[0]:this.terms=i.toArray(arguments)}m.prototype=new me;i.extend(m.prototype,{func:m,eval:function(e,t){return i.reduce(this.terms,function(n,r){return n*r.eval(e,t)},1)},codegen:function(){return i.map(this.terms,function(e){return"("+e.codegen()+")"}).join(" * ")||"0"},print:function(){return i.map(this.terms,function(e){return e instanceof R?"("+e.print()+")":e.print()}).join("*")},getUnits:function(){var e=i(this.terms).chain().map(function(t){return t.getUnits()}).flatten().value();return e.sort((t,n)=>t.unit.localeCompare(n.unit)),e},tex:function(){for(var e=" \\cdot ",t=i.groupBy(this.terms,function(f){return f.isDivide()?"inverse":f instanceof d?"number":"other"}),n=t.inverse||[],r=t.number||[],s=t.other||[],o="",a,c=0;c<r.length;c++){var h=r[c]instanceof D&&!(r[c]instanceof A);if(h&&s.length>0&&n.length>0){var y=r.slice();y.splice(c,1);var l=y.concat(n).concat(s);return r[c].tex()+new m(l).tex()}}if(r=i.compact(i.map(r,function(f){var x=f instanceof D&&!(f instanceof A),v=!f.hints.fraction||n.length>0;if(x&&v){n.push(new P(new A(f.d),d.Div));var E=new A(f.n);return E.hints=f.hints,i.any(f.hints)?E:null}else return f})),r.length===0&&s.length===1)a=s[0].tex();else{var u="";i.each(r,function(f){f.hints.subtract&&f.hints.entered?(o+="-",u+=(u?e:"")+f.abs().tex()):f instanceof A&&f.n===-1&&(f.hints.negate||f.hints.subtract)?o+="-":u+=(u?e:"")+f.tex()}),i.each(s,function(f){f.needsExplicitMul()?u+=(u?e:"")+f.tex():f instanceof R?u+="("+f.tex()+")":u+=f.tex()}),a=u||"1"}if(n.length){var p=new m(i.invoke(n,"asDivide")).flatten().tex();return o+"\\frac{"+a+"}{"+p+"}"}else return o+a},strip:function(){var e=i.map(this.terms,function(t){return t instanceof d?t.abs():t.strip()});return new m(e).flatten()},expand:function(){var e=function(v){return v instanceof R},t=function(v){return v instanceof P&&v.exp.isNegative()},n=function(v){return t(v)&&e(v.base)},r=this.recurse("expand").flatten(),s=i.any(r.terms,e),o=i.any(r.terms,n);if(!(s||o))return r;var a=i.groupBy(r.terms,t),c=a[!1]||[],h=a[!0]||[];if(s){var y=i.groupBy(c,e),l=y[!0]||[],u=y[!1]||[],p=i.reduce(l,function(v,E){return i.reduce(v,function(_,z){return _.concat(i.map(E.terms,function(j){return z.concat(j)}))},[])},[[]]),f=i.map(p,function(v){return new m(u.concat(v)).flatten()});c=[new R(f)]}if(o){var x=new m(i.invoke(h,"getDenominator")).flatten();h=[new P(x.expand(),d.Div)]}return new m(c.concat(h)).flatten()},factor:function(e){var t=this.recurse("factor",e).flatten();if(!(t instanceof m))return t;var n=i.groupBy(t.terms,function(s){return s instanceof D}),r=i.reduce(n[!0],function(s,o){return{n:s.n*o.n,d:s.d*o.d}},{n:1,d:1});return r.d===1?r=new A(r.n):r=new D(r.n,r.d),new m((n[!1]||[]).concat(r)).flatten()},collect:function(e){var t=this.recurse("collect",e).partition(),n=t[0].reduce(e);if(n.eval()===0)return d.Zero;var r=t[1].flatten();if(!(r instanceof m))return new m(n,r).flatten();r=r.terms;var a=[];i.each(r,function(f){f instanceof P?a.push([f.base,f.exp]):a.push([f,d.One])});var s=i.groupBy(a,function(f){return f[0].normalize().print()}),o=i.compact(i.map(s,function(f){var x=f[0][0],v=new R(i.zip.apply(i,f)[1]),E=v.collect(e);return E instanceof d&&E.eval()===0?null:[x,E]})),a=i.groupBy(o,function(f){return f[0]instanceof O&&f[0].isBasic()?"trig":f[0]instanceof L?"log":"expr"}),c=a.trig||[],h=a.log||[],y=a.expr||[];if(c.length>1){var l=i.groupBy(c,function(f){return f[0].arg.normalize().print()});c=[],i.each(l,function(f){var x=f[0][0].arg,v={sin:d.Zero,cos:d.Zero};i.each(f,function(E){v[E[0].type]=E[1]}),m.handleNegative(v.sin).collect(e).equals(v.cos)&&(v.cos.isNegative()?v={tan:v.sin}:v={cot:v.cos}),i.each(v,function(E,_){c.push([new O(_,x),E])})})}if(h.length>1){var u=i.groupBy(h,function(f){return f[0].base.normalize().print()});h=[],i.each(u,function(f){f.length===2&&m.handleNegative(f[0][1]).collect(e).equals(f[1][1])?f[0][1].isNegative()?h.push([new L(f[0][0].power,f[1][0].power),f[1][1]]):h.push([new L(f[1][0].power,f[0][0].power),f[0][1]]):h=h.concat(f)})}a=c.concat(h).concat(y);var p=i.map(a,function(f){return new P(f[0],f[1]).collect(e)});return new m([n].concat(p)).flatten()},isSubtract:function(){return i.any(this.terms,function(e){return e instanceof d&&e.hints.subtract})},factorIn:function(e){var t=this.partition(),n=t[0].terms,r=n.length&&i.all(n,function(o){return o.n>0});if(r){var s=n[0].negate();return s.hints=n[0].hints,this.replace(n[0],s.addHint(e))}else return new m([d.negativeOne(e)].concat(this.terms))},factorOut:function(){var e=!1,t=i.compact(i.map(this.terms,function(n,r,s){return!e&&n instanceof d&&n.hints.divide?(e=!0,n.n!==-1?n.negate():null):n}));return t.length===1?t[0]:new m(t)},reduce:function(e){return i.reduce(this.terms,function(t,n){return t.mul(n,e)},this.identity)},findGCD:function(e){return new m(i.invoke(this.terms,"findGCD",e)).flatten()},asMul:function(){return this},asPositiveFactor:function(){if(this.isPositive())return this;var e=i.invoke(this.collect().terms,"asPositiveFactor");return new m(e).flatten()},isNegative:function(){return i.any(i.invoke(this.collect().terms,"isNegative"))},fold:function(){return m.fold(this)},negate:function(){var e=function(n){return n instanceof d};if(i.any(this.terms,e)){var t=i.find(this.terms,e);return this.replace(t,t.negate())}else return new m([d.Neg].concat(this.terms))}});i.each([R,m],function(e){i.extend(e,{createOrAppend:function(t,n){return t instanceof e?new e(t.terms.concat(n)):new e(t,n)}})});i.extend(m,{handleNegative:function(e,t){if(e instanceof d&&e.n>0){var n=e.negate();return n.hints=e.hints,n.addHint(t)}else return e instanceof m?e.factorIn(t):new m(d.negativeOne(t),e)},handleDivide:function(e,t){if(t instanceof m){var n=m.handleDivide(e,t.terms[0]),r=new m(i.rest(t.terms)).flatten();return m.handleDivide(n,r)}var s=function(u){return u instanceof A},o=function(u){return u instanceof D};if(s(t)&&e instanceof m&&i.any(e.terms,s)){var a=e.terms.slice().reverse(),c=i.find(a,o);if(!s(c))return new m(e.terms.concat([new D(1,t.n).addHint("fraction")]));var h=new D(c.n,t.n);return h.hints=c.hints,c===a[0]&&(h=h.addHint("fraction")),c.n<0&&t.n<0?(h.d=-h.d,e.replace(c,[d.Neg,h])):e.replace(c,h)}var y=function(u,p){if(p instanceof A){if(u instanceof A)return u.n<0&&p.n<0?[d.Neg,new D(u.n,-p.n).addHint("fraction")]:[new D(u.n,p.n).addHint("fraction")];var f=new D(1,p.eval());return p.eval()<0?[u,f.addHint("negate")]:[u,f]}else{var x;if(p instanceof O&&p.exp){var v=p.exp;p.exp=void 0,p=new P(p,v)}return p instanceof P?x=new P(p.base,m.handleNegative(p.exp,"divide")):x=new P(p,d.Div),u instanceof A&&u.n===1?[x]:[u,x]}};if(e instanceof m){var l=y(i.last(e.terms),t);return new m(i.initial(e.terms).concat(l))}else{var l=y(e,t);return new m(l).flatten()}},fold:function(e){if(e instanceof m){var t=i.find(i.initial(e.terms),function(p){return(p instanceof O||p instanceof L)&&p.hints.open}),n=i.indexOf(e.terms,t);if(t){var r=i.last(e.terms);if(t.hints.parens||r.hints.parens||r.has(O)||r.has(L))t.hints.open=!1;else{var s;return t instanceof O?s=O.create([t.type,t.exp],m.createOrAppend(t.arg,r).fold()):s=L.create(t.base,m.createOrAppend(t.power,r).fold()),n===0?s:new m(e.terms.slice(0,n).concat(s)).fold()}}var o=e.partition(),a=o[0].terms,c=function(p){return p.n>0},h=function(p){return p.n===-1&&p.hints.negate},y=function(p){return c(p)||h(p)};if(a.length>1&&i.some(a,h)&&i.some(a,c)&&i.every(a,y)){var l=i.indexOf(e.terms,i.find(e.terms,h)),u=i.indexOf(e.terms,i.find(e.terms,c));if(l<u)return e.replace(u,e.terms[u].negate()).remove(l)}}return e}});function P(e,t){this.base=e,this.exp=t}P.prototype=new Q;i.extend(P.prototype,{func:P,args:function(){return[this.base,this.exp]},eval:function(e,t){var n=this.base.eval(e,t),r=this.exp.eval(e,t);if(n<0){var s=this.exp.simplify();if(s instanceof G){var o=s.n,a=(o-o.toFixed()).toString().length-2,c=Math.pow(10,a),h=new D(o*c,c);s=h.simplify()}if(s instanceof D){var y=Math.abs(s.d)%2===1;if(y){var l=Math.abs(s.n)%2===1,u=l?-1:1;return u*Math.pow(-1*n,r)}}}return Math.pow(n,r)},getUnits:function(){return this.base.getUnits().map((function(e){return{unit:e.unit,pow:e.pow*this.exp.n}}).bind(this))},codegen:function(){return"Math.pow("+this.base.codegen()+", "+this.exp.codegen()+")"},print:function(){var e=this.base.print();return(this.base instanceof me||this.base instanceof P)&&(e="("+e+")"),e+"^("+this.exp.print()+")"},tex:function(){if(this.isDivide())return"\\frac{1}{"+this.asDivide().tex()+"}";if(this.isRoot())return this.exp.n!==1&&Le("Node marked with hint 'root' does not have exponent of form 1/x."),this.exp.d===2?"\\sqrt{"+this.base.tex()+"}":"\\sqrt["+this.exp.d+"]{"+this.base.tex()+"}";if(this.base instanceof O&&!this.base.isInverse()&&this.exp instanceof d&&this.exp.isSimple()&&this.exp.eval()>=0){var e=this.base.tex({split:!0});return e[0]+"^{"+this.exp.tex()+"}"+e[1]}else{var t=this.base.tex();return this.base instanceof me||this.base instanceof P||this.base instanceof d&&!this.base.isSimple()?t="("+t+")":(this.base instanceof O||this.base instanceof L)&&(t="["+t+"]"),t+"^{"+this.exp.tex()+"}"}},needsExplicitMul:function(){return this.isRoot()?!1:this.base.needsExplicitMul()},expand:function(){var e=this.recurse("expand");if(e.base instanceof m){var t=i.map(e.base.terms,function(y){return new P(y,e.exp)});return new m(t).expand()}else if(e.base instanceof R&&e.exp instanceof A&&e.exp.abs().eval()>1){for(var n=e.exp.eval()>0,r=e.exp.abs().eval(),s=function(y){return n?y:new P(y,d.Div)},o={1:e.base},a=2;a<=r;a*=2){var h=new m(o[a/2],o[a/2]);o[a]=h.expand().collect()}if(i.has(o,r))return s(o[r]);var c=i.map(r.toString(2).split(""),function(y,l,u){return Number(y)*Math.pow(2,u.length-l-1)});c=i.without(c,0);var h=new m(i.pick(o,c)).expand().collect();return s(h)}else if(e.exp instanceof R){var t=i.map(e.exp.terms,function(l){return new P(e.base,l).expand()});return new m(t).expand()}else return e},factor:function(){var e=this.recurse("factor");if(e.base instanceof m){var t=i.map(e.base.terms,function(n){return n instanceof A&&e.exp.equals(d.Div)?new D(1,n.n):new P(n,e.exp)});return new m(t)}else return e},collect:function(e){if(this.base instanceof P){var t=this.base.base,n=m.createOrAppend(this.base.exp,this.exp);return new P(t,n).collect(e)}var r=this.recurse("collect",e),s=function(l){return l instanceof L&&l.base.equals(r.base)};if(r.exp instanceof d&&r.exp.eval()===0)return d.One;if(r.exp instanceof d&&r.exp.eval()===1)return r.base;if(s(r.exp))return r.exp.power;if(r.exp instanceof m&&i.any(r.exp.terms,s)){var o=i.find(r.exp.terms,s),t=o.power,n=r.exp.remove(o).flatten();return new P(t,n).collect(e)}else if(r.base instanceof d&&r.exp instanceof d){if(e&&e.preciseFloats){var n=r.exp.asRational(),a=r.base.getDecimalPlaces(),c=new P(r.base,new D(1,n.d)),h=c.collect().getDecimalPlaces();if(h>a){var y=new P(r.base,new A(n.n)).collect();return new P(y,new D(1,n.d))}}return r.base.raiseToThe(r.exp,e)}else return r},isDivide:function(){var e=function(t){return t instanceof d&&t.hints.divide};return e(this.exp)||this.exp instanceof m&&i.any(this.exp.terms,e)},asDivide:function(){if(this.exp instanceof d){if(this.exp.eval()===-1)return this.base;var e=this.exp.negate();return e.hints=i.clone(this.exp.hints),e.hints.divide=!1,new P(this.base,e)}else{if(this.exp instanceof m)return new P(this.base,this.exp.factorOut());Le("called asDivide() on an Expr that wasn't a Num or Mul")}},isRoot:function(){return this.exp instanceof D&&this.exp.hints.root},isSquaredTrig:function(){return this.base instanceof O&&!this.base.isInverse()&&this.exp instanceof d&&this.exp.eval()===2},getDenominator:function(){if(this.exp instanceof d&&this.exp.eval()===-1)return m.createOrAppend(this.base,this.base.getDenominator()).flatten();if(this.exp.isNegative()){var e=new P(this.base,m.handleNegative(this.exp).collect());return m.createOrAppend(e,e.collect().getDenominator()).flatten()}else return this.base instanceof d?new P(this.base.getDenominator(),this.exp).collect():d.One},findGCD:function(e){var t,n;if(e instanceof P?(t=e.base,n=e.exp):(t=e,n=d.One),this.base.equals(t)){if(this.exp.equals(n))return this;if(this.exp instanceof d&&n instanceof d)return new P(this.base,d.min(this.exp,n)).collect();if(this.exp instanceof d||n instanceof d)return d.One;var r=this.exp.asMul().partition(),s=n.asMul().partition();if(r[1].equals(s[1])){var o=d.min(r[0].reduce(),s[0].reduce()),a=new m(o,r[1].flatten()).flatten();return new P(t,a).collect()}}return d.One},isPositive:function(){if(this.base.isPositive())return!0;var e=this.exp.simplify();return e instanceof A&&e.eval()%2===0},asPositiveFactor:function(){if(this.isPositive())return this;var e=this.exp.simplify();if(e instanceof A){var t=e.eval();if(t>2)return new P(this.base,new A(t-1));if(t<-2)return new P(this.base,new A(t+1))}return d.One}});i.extend(P,{sqrt:function(e){return new P(e,d.Sqrt)},nthroot:function(e,t){var n=m.fold(m.handleDivide(new A(1),t));return new P(e,n.addHint("root"))}});function L(e,t){this.base=e,this.power=t}L.prototype=new Q;i.extend(L.prototype,{func:L,args:function(){return[this.base,this.power]},eval:function(e,t){return Math.log(this.power.eval(e,t))/Math.log(this.base.eval(e,t))},codegen:function(){return"(Math.log("+this.power.codegen()+") / Math.log("+this.base.codegen()+"))"},print:function(){var e="("+this.power.print()+")";return this.isNatural()?"ln"+e:"log_("+this.base.print()+") "+e},tex:function(){var e="("+this.power.tex()+")";return this.isNatural()?"\\ln"+e:"\\log_{"+this.base.tex()+"}"+e},collect:function(e){var t=this.recurse("collect",e);return t.power instanceof d&&t.power.eval()===1?d.Zero:t.base.equals(t.power)?d.One:t.power instanceof P&&t.power.base.equals(t.base)?t.power.exp:t},expand:function(){var e=this.recurse("expand");if(e.power instanceof m){var t=i.map(e.power.terms,function(n){return new L(e.base,n).expand()});return new R(t)}else return e.power instanceof P?new m(e.power.exp,new L(e.base,e.power.base).expand()).flatten():e.isNatural()?e:m.handleDivide(new L(X.e,e.power),new L(X.e,e.base))},hints:i.extend(L.prototype.hints,{open:!1}),isPositive:function(){var e=this.collect();return e.base instanceof d&&e.power instanceof d?this.eval()>0:!1},needsExplicitMul:function(){return!1},isNatural:function(){return this.base.equals(X.e)}});i.extend(L,{natural:function(){return X.e},common:function(){return d.Ten},create:function(e,t){var n=new L(e,t);return t.hints.parens||(n=n.addHint("open")),n}});function O(e,t){this.type=e,this.arg=t}O.prototype=new Q;i.extend(O.prototype,{func:O,args:function(){return[this.type,this.arg]},functions:{sin:{eval:Math.sin,codegen:"Math.sin((",tex:"\\sin",expand:function(){return this}},cos:{eval:Math.cos,codegen:"Math.cos((",tex:"\\cos",expand:function(){return this}},tan:{eval:Math.tan,codegen:"Math.tan((",tex:"\\tan",expand:function(){return m.handleDivide(O.sin(this.arg),O.cos(this.arg))}},csc:{eval:function(e){return 1/Math.sin(e)},codegen:"(1/Math.sin(",tex:"\\csc",expand:function(){return m.handleDivide(d.One,O.sin(this.arg))}},sec:{eval:function(e){return 1/Math.cos(e)},codegen:"(1/Math.cos(",tex:"\\sec",expand:function(){return m.handleDivide(d.One,O.cos(this.arg))}},cot:{eval:function(e){return 1/Math.tan(e)},codegen:"(1/Math.tan(",tex:"\\cot",expand:function(){return m.handleDivide(O.cos(this.arg),O.sin(this.arg))}},arcsin:{eval:Math.asin,codegen:"Math.asin((",tex:"\\arcsin"},arccos:{eval:Math.acos,codegen:"Math.acos((",tex:"\\arccos"},arctan:{eval:Math.atan,codegen:"Math.atan((",tex:"\\arctan"},arccsc:{eval:function(e){return Math.asin(1/e)},codegen:"Math.asin(1/(",tex:"\\operatorname{arccsc}"},arcsec:{eval:function(e){return Math.acos(1/e)},codegen:"Math.acos(1/(",tex:"\\operatorname{arcsec}"},arccot:{eval:function(e){return Math.atan(1/e)},codegen:"Math.atan(1/(",tex:"\\operatorname{arccot}"},sinh:{eval:function(e){return(Math.exp(e)-Math.exp(-e))/2},codegen:function(e){return"((Math.exp("+e+") - Math.exp(-("+e+"))) / 2)"},tex:"\\sinh",expand:function(){return this}},cosh:{eval:function(e){return(Math.exp(e)+Math.exp(-e))/2},codegen:function(e){return"((Math.exp("+e+") + Math.exp(-("+e+"))) / 2)"},tex:"\\cosh",expand:function(){return this}},tanh:{eval:function(e){return(Math.exp(e)-Math.exp(-e))/(Math.exp(e)+Math.exp(-e))},codegen:function(e){return"((Math.exp("+e+") - Math.exp(-("+e+"))) / (Math.exp("+e+") + Math.exp(-("+e+"))))"},tex:"\\tanh",expand:function(){return m.handleDivide(O.sinh(this.arg),O.cosh(this.arg))}},csch:{eval:function(e){return 2/(Math.exp(e)-Math.exp(-e))},codegen:function(e){return"(2 / (Math.exp("+e+") - Math.exp(-("+e+"))))"},tex:"\\csch",expand:function(){return m.handleDivide(d.One,O.sinh(this.arg))}},sech:{eval:function(e){return 2/(Math.exp(e)+Math.exp(-e))},codegen:function(e){return"(2 / (Math.exp("+e+") + Math.exp(-("+e+"))))"},tex:"\\sech",expand:function(){return m.handleDivide(d.One,O.cosh(this.arg))}},coth:{eval:function(e){return(Math.exp(e)+Math.exp(-e))/(Math.exp(e)-Math.exp(-e))},codegen:function(e){return"((Math.exp("+e+") + Math.exp(-("+e+"))) / (Math.exp("+e+") - Math.exp(-("+e+"))))"},tex:"\\coth",expand:function(){return m.handleDivide(O.cosh(this.arg),O.sinh(this.arg))}}},isEven:function(){return i.contains(["cos","sec"],this.type)},isInverse:function(){return this.type.indexOf("arc")===0},isBasic:function(){return i.contains(["sin","cos"],this.type)},eval:function(e,t){var n=this.functions[this.type].eval,r=this.arg.eval(e,t);return n(r)},codegen:function(){var e=this.functions[this.type].codegen;if(typeof e=="function")return e(this.arg.codegen());if(typeof e=="string")return e+this.arg.codegen()+"))";throw new Error("codegen not implemented for "+this.type)},print:function(){return this.type+"("+this.arg.print()+")"},tex:function(e){var t=this.functions[this.type].tex,n="("+this.arg.tex()+")";return e&&e.split?[t,n]:t+n},hints:i.extend(O.prototype.hints,{open:!1}),isPositive:function(){var e=this.collect();return e.arg instanceof d?this.eval()>0:!1},completeParse:function(){if(this.exp){var e=new P(this,this.exp);return this.exp=void 0,e}else return this},needsExplicitMul:function(){return!1},expand:function(){var e=this.recurse("expand");if(e.isInverse())return e;var t=e.functions[e.type].expand;return i.bind(t,e)()},collect:function(e){var t=this.recurse("collect",e);if(!t.isInverse()&&t.arg.isNegative()){var n;return t.arg instanceof d?n=t.arg.abs():n=m.handleDivide(t.arg,d.Neg).collect(e),t.isEven()?new O(t.type,n):new m(d.Neg,new O(t.type,n))}else return t}});i.extend(O,{create:function(e,t){var n=e[0],r=e[1];r&&r.equals(d.Neg)&&(n="arc"+n,r=void 0);var s=new O(n,t);return t.hints.parens||(s=s.addHint("open")),r&&(s.exp=r),s},sin:function(e){return new O("sin",e)},cos:function(e){return new O("cos",e)},sinh:function(e){return new O("sinh",e)},cosh:function(e){return new O("cosh",e)}});function de(e){this.arg=e}de.prototype=new Q;i.extend(de.prototype,{func:de,args:function(){return[this.arg]},eval:function(e,t){return Math.abs(this.arg.eval(e,t))},codegen:function(){return"Math.abs("+this.arg.codegen()+")"},print:function(){return"abs("+this.arg.print()+")"},tex:function(){return"\\left|"+this.arg.tex()+"\\right|"},collect:function(e){var t=this.recurse("collect",e);if(t.arg.isPositive())return t.arg;if(t.arg instanceof d)return t.arg.abs();if(t.arg instanceof m){var n=i.groupBy(t.arg.terms,function(s){return s.isPositive()?"positive":s instanceof d?"number":"other"}),r=n.positive.concat(i.invoke(n.number,"abs"));return n.other.length&&r.push(new de(new m(n.other).flatten())),new m(r).flatten()}else return t},expand:function(){var e=this.recurse("expand");if(e.arg instanceof m){var t=i.map(e.arg.terms,function(n){return new de(n)});return new m(t)}else return e},isPositive:function(){return!0}});function ae(e,t,n){this.left=e,this.type=t,this.right=n}ae.prototype=new Q;i.extend(ae.prototype,{func:ae,args:function(){return[this.left,this.type,this.right]},needsExplicitMul:function(){return!1},print:function(){return this.left.print()+this.type+this.right.print()},signs:{"=":" = ","<":" < ",">":" > ","<>":" \\ne ","<=":" \\le ",">=":" \\ge "},tex:function(){return this.left.tex()+this.signs[this.type]+this.right.tex()},normalize:function(){var e=this.recurse("normalize");return i.contains([">",">="],e.type)?new ae(e.right,e.type.replace(">","<"),e.left):e},asExpr:function(e){var t=function(c){return c instanceof d&&c.isSimple()&&c.eval()===0},n=[];this.left instanceof R?n=i.clone(this.left.terms):t(this.left)||(n=[this.left]),this.right instanceof R?n=n.concat(this.right.negate().terms):t(this.right)||n.push(this.right.negate());var r=!this.isEquality();n=i.invoke(n,"collect",{preciseFloats:!0});for(var s=0;s<n.length;s++){var o=n[s].getDenominator();r&&!o.isPositive()&&(o=o.asPositiveFactor()),o.equals(d.One)||(n=i.map(n,function(c){return m.createOrAppend(c,o).simplify({once:!0,preciseFloats:!0})}))}var a=new R(n).flatten();return e?a:this.divideThrough(a)},divideThrough:function(e){var t=!this.isEquality(),n=e.simplify({once:!0}),r=n.factor({keepNegative:t});if(!(r instanceof m))return e;var s=r.terms,o=function(f){return f instanceof R},a=function(f){return!!f.getVars().length},c=function(f){return f.equals(d.One)},h=i.groupBy(s,o),y=h[!0]||[],l=h[!1]||[];if(y.length&&this.isEquality())return new m(y).flatten();var u=l;y.length||(u=i.reject(u,a)),t&&(u=i.invoke(u,"asPositiveFactor")),u=i.reject(u,c),u=i.map(u,function(f){return new P(f,d.Div)});var p=new m(s.concat(u)).collect();return p.equals(r)?n:p},isEquality:function(){return i.contains(["=","<>"],this.type)},compare:function(e){if(!(e instanceof ae))return!1;var t=this.normalize(),n=e.normalize();if(t.type!==n.type)return!1;var r=t.divideThrough(t.asExpr(!0).collect()),s=n.divideThrough(n.asExpr(!0).collect());return t.isEquality()?r.compare(s)||r.compare(m.handleNegative(s)):r.compare(s)},sameForm:function(e){var t=this.normalize(),n=e.normalize(),r=t.left.sameForm(n.left)&&t.right.sameForm(n.right);return t.isEquality()?r||t.left.sameForm(n.right)&&t.right.sameForm(n.left):r},isSimplified:function(){var e=this.asExpr(!0),t=this.divideThrough(e).simplify();return e.equals(t)&&this.left.isSimplified()&&this.right.isSimplified()}});i.extend(ae.prototype,{solveLinearEquationForVariable:function(e){var t=this.asExpr();if(!t.is(R)||t.terms.length!==2)throw new Error("Can only handle linear equations of the form a + bx (= 0)");var n=function(o){return o.has(we)&&i.contains(o.getVars(),e.symbol)},r,s;return n(t.terms[0])?(r=m.handleNegative(t.terms[1]),s=m.handleDivide(t.terms[0],e)):(r=m.handleNegative(t.terms[0]),s=m.handleDivide(t.terms[1],e)),m.handleDivide(r,s).simplify()}});function oe(){}oe.prototype=new Q;i.extend(oe.prototype,{needsExplicitMul:function(){return!1},findGCD:function(e){return e instanceof oe||e instanceof d?this.equals(e)?this:d.One:e.findGCD(this)}});function ie(e,t){this.symbol=e,this.arg=t}ie.prototype=new oe;i.extend(ie.prototype,{func:ie,args:function(){return[this.symbol,this.arg]},print:function(){return this.symbol+"("+this.arg.print()+")"},tex:function(){return this.symbol+"("+this.arg.tex()+")"},eval:function(e,t){var n=this.arg,r=e[this.symbol],s=i.extend(i.clone(e),{x:n.eval(e,t)}),o=xe(r,t);return o.parsed?o.expr.eval(s,t):o},codegen:function(){return'vars["'+this.symbol+'"]('+this.arg.codegen()+")"},getUnits:function(){return this.arg.getUnits()},getVars:function(e){return e?this.arg.getVars():i.union(this.arg.getVars(),[this.symbol]).sort()},getConsts:function(){return this.arg.getConsts()}});function we(e,t){this.symbol=e,this.subscript=t}we.prototype=new oe;i.extend(we.prototype,{func:we,args:function(){return[this.symbol,this.subscript]},exprArgs:function(){return[]},recurse:function(){return this},print:function(){var e="";return this.subscript&&(e="_("+this.subscript.print()+")"),this.symbol+e},prettyPrint:function(){var e=this.subscript;return e&&(e instanceof d||e instanceof oe)?this.symbol+"_"+e.print():this.print()},tex:function(){var e="";this.subscript&&(e="_{"+this.subscript.tex()+"}");var t=this.symbol.length>1?"\\":"";return t+this.symbol+e},repr:function(){return"Var("+this.print()+")"},eval:function(e,t){return e[this.prettyPrint()]},codegen:function(){return'vars["'+this.prettyPrint()+'"]'},getVars:function(){return[this.prettyPrint()]},isPositive:function(){return!1}});function X(e){this.symbol=e}X.prototype=new oe;i.extend(X.prototype,{func:X,args:function(){return[this.symbol]},recurse:function(){return this},eval:function(e,t){if(this.symbol==="pi")return Math.PI;if(this.symbol==="e")return Math.E},codegen:function(){if(this.symbol==="pi")return"Math.PI";if(this.symbol==="e")return"Math.E"},print:function(){return this.symbol},tex:function(){if(this.symbol==="pi")return"\\pi ";if(this.symbol==="e")return"e"},isPositive:function(){return this.eval()>0},abs:function(){return this.eval()>0?this:m.handleNegative(this)},getConsts:function(){return[this.print()]}});X.e=new X("e");X.pi=new X("pi");function d(){}d.prototype=new Q;i.extend(d.prototype,{repr:function(){return this.print()},strip:function(){return this.abs()},recurse:function(){return this},codegen:function(){return this.print()},add:Z,mul:Z,negate:Z,isSubtract:function(){return this.hints.subtract},abs:Z,needsExplicitMul:function(){return!0},findGCD:Z,isPositive:function(){return this.eval()>0},isNegative:function(){return this.eval()<0},asPositiveFactor:function(){return this.isPositive()?this:this.abs()},hints:i.extend(d.prototype.hints,{negate:!1,subtract:!1,divide:!1,root:!1,fraction:!1,entered:!1}),isSimple:Z,getDecimalPlaces:function(){var e=(""+this.n).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0},asRational:Z});function D(e,t){var n=e,r=t;r<0&&(n=-n,r=-r),this.n=n,this.d=r}D.prototype=new d;i.extend(D.prototype,{func:D,args:function(){return[this.n,this.d]},eval:function(){return this.n/this.d},print:function(){return this.n.toString()+"/"+this.d.toString()},tex:function(){var e="\\frac{"+Math.abs(this.n).toString()+"}{"+this.d.toString()+"}";return this.n<0?"-"+e:e},add:function(e,t){return e instanceof D?new D(this.n*e.d+this.d*e.n,this.d*e.d).collect():e.add(this,t)},mul:function(e,t){return e instanceof D?new D(this.n*e.n,this.d*e.d).collect():e.mul(this,t)},collect:function(){var e=d.findGCD(this.n,this.d),t=this.n/e,n=this.d/e;return n===1?new A(t):new D(t,n)},negate:function(){return new D(-this.n,this.d)},abs:function(){return new D(Math.abs(this.n),this.d)},findGCD:function(e){if(e instanceof D){var t=d.findGCD(this.n*e.d,e.n*this.d),n=this.d*e.d;return new D(t,n).collect()}else return e instanceof A?new D(d.findGCD(this.n,e.n),this.d):e.findGCD(this)},raiseToThe:function(e){if(e instanceof A){var t=e.eval()>0,n=e.abs().eval(),r=Math.pow(this.n,n),s=Math.pow(this.d,n);return t?new D(r,s).collect():new D(s,r).collect()}else return new G(this.eval()).raiseToThe(e)},getDenominator:function(){return new A(this.d)},isSimple:function(){return!1},asRational:function(){return this}});function A(e){this.n=e}A.prototype=new D(0,1);i.extend(A.prototype,{func:A,args:function(){return[this.n]},print:function(){return this.n.toString()},tex:function(){return this.n.toString()},negate:function(){return new A(-this.n)},abs:function(){return new A(Math.abs(this.n))},isSimple:function(){return!0},findGCD:function(e){return e instanceof A?new A(d.findGCD(this.n,e.n)):e.findGCD(this)}});i.extend(A,{create:function(e){return new A(e).addHint("entered")}});function G(e){this.n=e}G.prototype=new d;i.extend(G.prototype,{func:G,args:function(){return[this.n]},eval:function(){return this.n},print:function(){return this.n.toString()},tex:function(){return this.n.toString()},add:function(e,t){return t&&t.preciseFloats?G.toDecimalPlaces(this.n+e.eval(),Math.max(this.getDecimalPlaces(),e.getDecimalPlaces())):new G(this.n+e.eval()).collect()},mul:function(e,t){return t&&t.preciseFloats?G.toDecimalPlaces(this.n*e.eval(),this.getDecimalPlaces()+e.getDecimalPlaces()):new G(this.n*e.eval()).collect()},collect:function(){return this},negate:function(){return new G(-this.n)},abs:function(){return new G(Math.abs(this.n))},findGCD:function(e){return e instanceof d?new G(d.findGCD(this.eval(),e.eval())).collect():e.findGCD(this)},raiseToThe:function(e,t){return t&&t.preciseFloats&&e instanceof A&&e.n>1?G.toDecimalPlaces(new P(this,e).eval(),this.getDecimalPlaces()*e.n):new G(new P(this,e).eval()).collect()},asRational:function(){var e=this.n.toString().split(".");if(e.length===1)return new D(this.n,1);var t=Number(e.join("")),n=Math.pow(10,e[1].length);return new D(t,n).collect()},getDenominator:function(){return this.asRational().getDenominator()},isSimple:function(){return!0}});i.extend(G,{create:function(e){return new G(e).addHint("entered")},toDecimalPlaces:function(e,t){return new G(+e.toFixed(Math.min(t,20))).collect()}});i.extend(d,{negativeOne:function(e){return e==="subtract"?d.Sub:e==="divide"?d.Div:d.Neg},findGCD:function(e,t){var n;if(e=Math.abs(e),t=Math.abs(t),e!==Math.floor(e)||t!==Math.floor(t))return 1;for(;t;)n=e%t,e=t,t=n;return e},min:function(){return i.min(i.toArray(arguments),function(e){return e.eval()})},max:function(){return i.max(i.toArray(arguments),function(e){return e.eval()})}});d.Neg=new A(-1).addHint("negate");d.Sub=new A(-1).addHint("subtract");d.Div=new A(-1).addHint("divide");d.Sqrt=new D(1,2).addHint("root");d.Zero=new A(0);d.One=new A(1);d.Ten=new A(10);R.prototype.identity=d.Zero;m.prototype.identity=d.One;var ft=function(e,t){throw new Error(t.loc.first_column)};ge.yy={Add:R,Mul:m,Pow:P,Log:L,Trig:O,Eq:ae,Abs:de,Func:ie,Const:X,Var:we,Int:A,Float:G,parseError:ft,constants:["e"],symbolLexer:function(e){return i.contains(ge.yy.constants,e)?"CONST":i.contains(ge.yy.functions,e)?"FUNC":"VAR"}};const xe=function(e,t){try{t&&t.functions?ge.yy.functions=i.without(t.functions,"i"):ge.yy.functions=[],t&&t.decimal_separator&&(e=e.split(t.decimal_separator).join("."));var n=ge.parse(e).completeParse();return{parsed:!0,expr:n}}catch(r){return{parsed:!1,error:r.message}}};function B(e){this.symbol=e}B.prototype=new oe;i.extend(B.prototype,{func:B,args:function(){return[this.symbol]},recurse:function(){return this},eval:function(e,t){return 1},getUnits:function(){return[{unit:this.symbol,pow:1}]},codegen:function(){return"1"},print:function(){return this.symbol},tex:function(){return this.symbol},collect:function(e){if(i(ht).has(this.symbol))return this;if(i(je).has(this.symbol))return je[this.symbol].conversion;throw new Error("could not understand unit: "+this.symbol)}});var ht={m:new B("m"),g:new B("g"),s:new B("s"),A:new B("A"),K:new B("K"),mol:new B("mol"),cd:new B("cd")},F={},M={},g=function(e,t){var n=e.split("|"),r=n[0].trim(),s=n[1].trim(),o=d.One;r!==""&&(o=xe(r).expr);var a=s.split("/"),c=[o];return a[0]&&a[0].split(" ").filter(function(h){return h!==""}).map(function(h){c.push(new B(h))}),a[1]&&a[1].split(" ").filter(function(h){return h!==""}).map(function(h){c.push(new P(new B(h),d.Div))}),{conversion:new m(c),prefixes:t}},je={Da:g("1.6605388628 x 10^-24 | g",F),u:g("| Da",M),meter:g("| m",M),meters:g("| m",M),in:g("254 / 10000 | m",M),ft:g("3048  / 10000 | m",M),yd:g("9144  / 10000 | m",M),mi:g("1609344 / 1000 | m",M),ly:g("9.4607 x 10^15 | m",M),nmi:g("1852 | m",M),Å:g("10^-10 | m",M),pc:g("3.0857 x 10^16 | m",M),min:g("60 | s",M),hr:g("3600 | s",M),sec:g("| s",M),day:g("86400 | s",M),wk:g("604800 | s",M),fortnight:g("14 | day",M),shake:g("10^-8 | s",M),olympiad:g("126200000 | s",M),"°C":g("1 | K",M),"°F":g("5/9 | K",M),"°R":g("5/9 | K",M),e:g("1.6021765314 x 10^-19 | C",M),c:g("299792458 | m / s",M),kn:g("514/1000 | m / s",M),kt:g("| kn",M),knot:g("| kn",M),J:g("| N m",F),BTU:g("1060 | J",M),cal:g("4184 / 1000 | J",F),eV:g("1.602176514 x 10^-19 | J",F),erg:g("10^−7 | J",F),W:g("| J / s",F),"H-e":g("80 | W",M),N:g("1000 | g m / s s",F),lb:g("4448221615 / 1000000000 | N",M),dyn:g("10^-5 | N",M),Pa:g("1 | N / m m m",F),bar:g("10^5 | Pa",F),"㏔":g("1/1000 | bar",M),"㍴":g("| bar",M),atm:g("101325 | Pa",M),Torr:g("1/760 | atm",M),mmHg:g("| Torr",M),ha:g("10^4 | m m",M),b:g("10^−28 | m m",F),barn:g("| b",F),acre:g("4046.87 | m m",M),skilodge:g("10^-31 | m m",M),outhouse:g("10^-34 | m m",M),shed:g("10^-52 | m m",M),L:g("1/1000 | m m m",F),gal:g("3785/1000 | L",F),cup:g("1/16 | gal",M),qt:g("1/4 | gal",M),quart:g("| qt",M),p:g("1/8 | gal",M),pt:g("| p",M),pint:g("| p",M),"fl oz":g("1/8 | cup",M),"fl. oz.":g("1/8 | cup",M),tbsp:g("1/16 | cup",M),tsp:g("1/3 | tbsp",M),rev:g("2 pi | rad",M),deg:g("180 pi | rad",M),"°":g("| deg",M),arcminute:g("1/60 | deg",M),arcsec:g("1/3600 | deg",M),Hu:g("1000 | dB",F),dozen:g("12 |",M),mol:g("6.0221412927 x 10^23 |",F),"%":g("1/100 |",M),percent:g("| %",M),ppm:g("1/1000000 |",M),V:g("1000 | g m m / s s C",F),C:g("| A s",F),ampere:g("| A",M),Ω:g("| V / A",F),ohm:g("| Ω",M),F:g("| C / V",F),H:g("| ohm s",F),T:g("1000 | g / C s",F),Wb:g("1000 | g m m / C s",F),lm:g("pi x 10^4 | cd / m m",M),lx:g("| lm / m m",M),nit:g("| cd / m m",M),sb:g("10^4 | cd / m m",M),stilb:g("1 | sb",M),apostilb:g("1 / pi x 10^(-4) | sb",M),blondel:g("| apostilb",M),asb:g("| apostilb",M),la:g("| lm",M),Lb:g("| lm",M),sk:g("10^-7 | lm",M),skot:g("| sk",M),bril:g("10^-11 | lm",M),Hz:g("| / s",F)};d.Zero;d.One;const We=function(e,t,n){var r={form:!1,simplify:!1};n!==void 0?n=i.extend(r,n):n=r;var s=e.sameVars(t);if(!s.equal){var o;return s.equalIgnoringCase?o="Check your variables; one or more are using the wrong case (upper or lower).":o="Check your variables; you may have used the wrong letter for one or more of them.",{equal:!1,wrongVariableCase:s.equalIgnoringCase,wrongVariableNames:!s.equalIgnoringCase,message:o}}return e.compare(t)?n.form&&!e.sameForm(t)?{equal:!1,message:"Your answer is not in the correct form."}:n.simplify&&!e.isSimplified()?{equal:!1,message:"Your answer is not fully expanded and simplified."}:{equal:!0,message:null}:{equal:!1,message:null}},pt="@khanacademy/kmath",dt="__lib_version__";$e(pt,dt);const gt=1e-9,mt=Math.pow(2,-42);function an(e){return i.isNumber(e)&&!i.isNaN(e)}function be(e,t,n){return e==null||t==null?e===t:e===t?!0:(n==null&&(n=gt),Math.abs(e-t)<n)}function on(e,t){return be(e,0,t)?0:Math.abs(e)/e}function vt(e,t){return be(Math.round(e),e,t)}function cn(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}function un(e,t){return Math.round(e/t)*t}function ln(e,t){return Math.floor(e/t)*t}function fn(e,t){return Math.ceil(e/t)*t}function Be(e,t=mt,n=1e3){let r=[1,0],s=[0,1],o=Math.floor(e),a=e-o;for(;s[0]<=n;){if(be(r[0]/s[0],e,t))return[r[0],s[0]];r=[o*r[0]+r[1],r[0]],s=[o*s[0]+s[1],s[0]],o=Math.floor(1/a),a=1/a-o}return[e,1]}const W={cleanMath:function(e){return typeof e=="string"?e.replace(/\+\s*-/g,"- ").replace(/-\s*-/g,"+ ").replace(/\^1/g,""):e},bound:function(e){return e===0?e:e<0?-W.bound(-e):Math.max(1e-6,Math.min(e,1e20))},factorial:function(e){return e<=1?e:e*W.factorial(e-1)},getGCD:function(e,t){if(arguments.length>2){const r=[].slice.call(arguments,1);return W.getGCD(e,W.getGCD(...r))}let n;for(e=Math.abs(e),t=Math.abs(t);t;)n=e%t,e=t,t=n;return e},getLCM:function(e,t){if(arguments.length>2){const n=[].slice.call(arguments,1);return W.getLCM(e,W.getLCM(...n))}return Math.abs(e*t)/W.getGCD(e,t)},primes:[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97],isPrime:function(e){if(e<=1)return!1;if(e<101)return!!Y.grep(W.primes,function(t,n){return Math.abs(t-e)<=.5}).length;if(e<=1||e>2&&e%2===0)return!1;for(let t=3,n=Math.sqrt(e);t<=n;t+=2)if(e%t===0)return!1;return!0},getPrimeFactorization:function(e){if(e===1)return[];if(W.isPrime(e))return[e];const t=Math.sqrt(e);for(let n=2;n<=t;n++)if(e%n===0)return Y.merge(W.getPrimeFactorization(n),W.getPrimeFactorization(e/n))},roundToNearest:function(e,t){return Math.round(t/e)*e},roundTo:function(e,t){const n=Math.pow(10,e).toFixed(5);return Math.round((t*n).toFixed(5))/n},toFixedApprox:function(e,t){const n=e.toFixed(t);return be(+n,e)?n:"\\approx "+n},roundToApprox:function(e,t){const n=W.roundTo(t,e);return be(n,e)?String(n):W.toFixedApprox(e,t)},toFraction:function(e,t){if(t==null&&(t=Math.pow(2,-46)),e<0||e>1){let h=e%1;h+=h<0?1:0;const y=W.toFraction(h,t);return y[0]+=Math.round(e-h)*y[1],y}if(Math.abs(Math.round(Number(e))-e)<=t)return[Math.round(e),1];let n=0,r=1,s=1,o=1,a=1,c=2;for(;;){if(Math.abs(Number(a/c)-e)<=t)return[a,c];a/c<e?(n=a,r=c):(s=a,o=c),a=n+s,c=r+o}},getNumericFormat:function(e){if(e=Y.trim(e),e=e.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1"),e.match(/^[+-]?\d+$/))return"integer";if(e.match(/^[+-]?\d+\s+\d+\s*\/\s*\d+$/))return"mixed";const t=e.match(/^[+-]?(\d+)\s*\/\s*(\d+)$/);return t?parseFloat(t[1])>parseFloat(t[2])?"improper":"proper":e.replace(/[,. ]/g,"").match(/^\d+$/)?"decimal":e.match(/(pi?|\u03c0|t(?:au)?|\u03c4|pau)/)?"pi":null},toNumericString:function(e,t){if(e==null)return"";if(e===0)return"0";if(t==="percent")return e*100+"%";if(t==="pi"){const n=Be(e/Math.PI),r=Math.abs(n[0]),s=n[1];if(vt(r))return(e<0?"-":"")+(r===1?"":r)+"π"+(s===1?"":"/"+s)}if(i(["proper","improper","mixed","fraction"]).contains(t)){const n=Be(e),r=Math.abs(n[0]),s=n[1],o=e<0?"-":"";if(s===1)return o+r;if(t==="mixed"){const a=r%s,c=(r-a)/s;return o+(c?c+" ":"")+a+"/"+s}return o+r+"/"+s}return String(e)}};function hn(e){return e.reduce(yt,0)}function yt(e,t){return e+t}const xt=Math.pow(2,-42),pe={predicate:{defaultForms:"integer, proper, improper, mixed, decimal",createValidatorFunctional:function(e,t,n){t=i.extend({simplify:"required",ratio:!1,forms:pe.predicate.defaultForms},t);let r;i.isArray(t.forms)?r=t.forms:r=t.forms.split(/\s*,\s*/),t.inexact===void 0&&(t.maxError=0),t.maxError=+t.maxError+xt,i.contains(r,"percent")&&(r=i.without(r,"percent"),r.push("percent"));const s=function(a){a=a.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").replace(/(^\s*)|(\s*$)/gi,"");const c=a.match(/^([+-]?\d+)\s*\/\s*([+-]?\d+)$/),h=a.match(/^([+-]?)\\frac\{([+-]?\d+)\}\{([+-]?\d+)\}$/),y=parseInt(a,10);if(c||h){let l,u,p=!0;return c?(l=parseFloat(c[1]),u=parseFloat(c[2])):(l=parseFloat(h[2]),h[1]==="-"&&(l<0&&(p=!1),l=-l),u=parseFloat(h[3])),p=p&&u>0&&(t.ratio||u!==1)&&W.getGCD(l,u)===1,[{value:l/u,exact:p}]}return!isNaN(y)&&""+y===a?[{value:y,exact:!0}]:[]},o={integer:function(a){const c=o.decimal(a),h=o.decimal(a,1);return c[0].value!=null&&c[0].value===h[0].value||c[1].value!=null&&c[1].value===h[1].value?c:[]},proper:function(a){return Y.map(s(a),function(c){return Math.abs(c.value)<1?[c]:[]})},improper:function(a){return Y.map(s(a),function(c){return Math.abs(c.value)>=1?[c]:[]})},pi:function(a){let c,h=[];if(a=a.replace(/\u2212/,"-"),c=a.match(/^([+-]?)\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i))h=[{value:parseFloat(c[1]+"1"),exact:!0}];else if(c=a.match(/^([+-]?\s*\d+\s*(?:\/\s*[+-]?\s*\d+)?)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i))h=s(c[1]);else if(c=a.match(/^([+-]?)\s*(\d+)\s*([+-]?\d+)\s*\/\s*([+-]?\d+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i)){const l=parseFloat(c[1]+"1"),u=parseFloat(c[2]),p=parseFloat(c[3]),f=parseFloat(c[4]),x=p<f&&W.getGCD(p,f)===1;h=[{value:l*(u+p/f),exact:x}]}else if(c=a.match(/^([+-]?\s*\d+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)\s*(?:\/\s*([+-]?\s*\d+))?$/i))h=s(c[1]+"/"+c[3]);else if(c=a.match(/^([+-]?)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)\s*(?:\/\s*([+-]?\d+))?$/i))h=s(c[1]+"1/"+c[3]);else if(a==="0")h=[{value:0,exact:!0}];else if(c=a.match(/^(.+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i))h=o.decimal(c[1]);else{h=i.reduce(pe.predicate.defaultForms.split(/\s*,\s*/),function(p,f){return p.concat(o[f](a))},[]);let l=!1;const u=parseFloat(a);if(!isNaN(u)&&u!==parseInt(a)){const p=Math.PI/12,f=p*Math.round(u/p);Math.abs(u-f)<.01&&(l=!0)}else a.match(/\/\s*7/)&&(l=!0);return l&&i.each(h,function(p){p.piApprox=!0}),h}let y=Math.PI;return a.match(/\\?tau|t|\u03c4/)&&(y=Math.PI*2),a.match(/pau/)&&(y=Math.PI*1.5),Y.each(h,function(l,u){u.value*=y}),h},coefficient:function(a){let c=[];return a=a.replace(/\u2212/,"-"),a===""?c=[{value:1,exact:!0}]:a==="-"&&(c=[{value:-1,exact:!0}]),c},log:function(a){let c,h=[];return a=a.replace(/\u2212/,"-"),a=a.replace(/[ \(\)]/g,""),(c=a.match(/^log\s*(\S+)\s*$/i))?h=o.decimal(c[1]):a==="0"&&(h=[{value:0,exact:!0}]),h},percent:function(a){a=Y.trim(a);let c=!1;a.indexOf("%")===a.length-1&&(a=Y.trim(a.substring(0,a.length-1)),c=!0);const h=o.decimal(a);return Y.each(h,function(y,l){l.exact=c,l.value=l.value/100}),h},mixed:function(a){const c=a.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").match(/^([+-]?)(\d+)\s+(\d+)\s*\/\s*(\d+)$/);if(c){const h=parseFloat(c[1]+"1"),y=parseFloat(c[2]),l=parseFloat(c[3]),u=parseFloat(c[4]),p=l<u&&W.getGCD(l,u)===1;return[{value:h*(y+l/u),exact:p}]}return[]},decimal:function(a,c=1e10){const h=function(l){l=Y.trim(l);const u=l.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").match(/^([+-]?(?:\d{1,3}(?:[, ]?\d{3})*\.?|\d{0,3}(?:[, ]?\d{3})*\.(?:\d{3}[, ]?)*\d{1,3}))$/),p=l.match(/^0[0,]*,/);if(u&&!p){let f=parseFloat(u[1].replace(/[, ]/g,""));return t.inexact===void 0&&(f=Math.round(f*c)/c),f}},y=function(l){return l=l.replace(/([\.,])/g,function(u,p){return p==="."?",":"."}),h(l)};return[{value:h(a),exact:!0},{value:y(a),exact:!0}]}};return function(a){const c=t.fallback!=null?""+t.fallback:"";a=Y.trim(a)||c;const h={empty:a==="",correct:!1,message:null,guess:a};if(Y.each(r,function(y,l){const u=o[l](a);for(let p=0,f=u.length;p<f;p++){const x=u[p].value,v=u[p].exact,E=u[p].piApprox;if(e(x,t.maxError))return v||t.simplify==="optional"?(h.correct=!0,h.message=t.message||null,h.empty=!1):l==="percent"?(h.empty=!0,h.message=n.MISSING_PERCENT_ERROR):(t.simplify!=="enforced"&&(h.empty=!0),h.message=n.NEEDS_TO_BE_SIMPLFIED_ERROR),!1;E&&e(x,Math.abs(x*.001))&&(h.empty=!0,h.message=n.APPROXIMATED_PI_ERROR)}}),h.correct===!1){let y=!1;if(i.each(o,function(l){i.any(l(a),function(p){return p.value!=null&&!i.isNaN(p.value)})&&(y=!0)}),!y)return h.empty=!0,h.message=n.EXTRA_SYMBOLS_ERROR,h}return h}}},number:{convertToPredicate:function(e,t){const n=parseFloat(e);return[function(r,s){return Math.abs(r-n)<s},Y.extend({},t,{type:"predicate"})]},createValidatorFunctional:function(e,t,n){return pe.predicate.createValidatorFunctional(...pe.number.convertToPredicate(e,t),n)}},expression:{parseSolution:function(e,t){let n=xe(e,t);if(n.parsed){if(t.simplified&&!n.expr.isSimplified())throw new Ie("The provided solution ("+e+") isn't fully expanded and simplified.",Ee.InvalidInput);n=n.expr}else throw new Ie("The provided solution ("+e+") didn't parse.",Ee.InvalidInput);return n},createValidatorFunctional:function(e,t,n){return function(r){const s={empty:!1,correct:!1,message:null,guess:r,ungraded:!1};if(!r)return s.empty=!0,s;const o=xe(r,t);if(!o.parsed)return s.empty=!0,s;typeof e=="string"&&(e=pe.expression.parseSolution(e,t));const a=We(o.expr,e,t);if(a.equal)s.correct=!0;else if(a.wrongVariableNames||a.wrongVariableCase)s.ungraded=!0,s.message=a.wrongVariableCase?n.WRONG_CASE_ERROR:n.WRONG_LETTER_ERROR,s.suppressAlmostThere=!0;else if(a.message)s.message=a.message;else{const c=xe(r.replace(/[xX]/g,"*"),t);if(c.parsed){const h=We(c.expr,e,t);h.equal?(s.ungraded=!0,s.message=n.MULTIPLICATION_SIGN_ERROR):h.message&&(s.message=h.message+" Also, I'm a computer. I only understand multiplication if you use an asterisk (*) as the multiplication sign.")}}return s}}}},Ye=/^web\+graphie:/,Ke=/^file\+graphie:/;function De(e){return Xe(e)?Qe(e):e}function Xe(e){return Ye.test(e)||Ke.test(e)}function Fe(e){return e.replace(Ye,"https:").replace(Ke,"file:")}function Qe(e){return Fe(e)+".svg"}function wt(e){return Fe(e)+"-data.json"}async function bt(e){const t=new Image;return new Promise((n,r)=>{t.onload=()=>{n([t.naturalWidth,t.naturalHeight])},t.onerror=r,t.src=De(e)})}let Je=!1;const et=function(e,t,n){return Array.isArray(e)?i.map(e,function(r){return et(r,t)}):t.call(n,e)};function Mt(e,t){return e==null||t==null?e==null==(t==null):e.length===t.length&&e.every((n,r)=>t[r]===n)}const tt=/^\[\[\u2603 (([a-z-]+) ([0-9]+))\]\]/,kt=/^([a-z-]+) ([0-9]+)$/,_t=new RegExp(tt.source+"$"),It="☃",Et={type:"points",earned:0,total:0,message:null},Re=function(e){let t=e;return function(){let n=t;return n=n+2127912214+(n<<12)&4294967295,n=(n^3345072700^n>>>19)&4294967295,n=n+374761393+(n<<5)&4294967295,n=(n+3550635116^n<<9)&4294967295,n=n+4251993797+(n<<3)&4294967295,n=(n^3042594569^n>>>16)&4294967295,(t=n&268435455)/268435456}};function St(e,t,n=!1){const r=i.clone(e);if(!r.length||i.all(r,function(o){return i.isEqual(o,r[0])}))return r;let s;typeof t=="function"?s=t:s=Re(t);do for(let o=r.length;o>0;o--){const a=Math.floor(s()*o),c=r[a];r[a]=r[o-1],r[o-1]=c}while(n&&i.isEqual(e,r));return r}const Nt="x".split(/(.)/g).length?function(e,t){return e.split(t)}:function(e,t){const n=[];let r=t.lastIndex=0,s;for(;s=t.exec(e);){const o=s;n.push(e.slice(r,o.index)),n.push(...o.slice(1)),r=o.index+o[0].length}return n.push(e.slice(r)),n};function Tt(e,t){let n;if(e.type==="points"&&t.type==="points")return e.message&&t.message&&e.message!==t.message?n=null:n=e.message||t.message,{type:"points",earned:e.earned+t.earned,total:e.total+t.total,message:n};if(e.type==="points"&&t.type==="invalid")return t;if(e.type==="invalid"&&t.type==="points")return e;if(e.type==="invalid"&&t.type==="invalid")return e.message&&t.message&&e.message!==t.message?n=null:n=e.message||t.message,{type:"invalid",message:n};throw new Ie("PerseusScore with unknown type encountered",Ee.InvalidInput,{metadata:{scoreA:JSON.stringify(e),scoreB:JSON.stringify(t)}})}function Pt(e){return e.type==="points"&&e.earned>=e.total}function At(e,t,n){if(e.type==="points")return{empty:!1,correct:Pt(e),message:e.message,guess:t,state:n};if(e.type==="invalid")return{empty:!0,correct:!1,message:e.message,suppressAlmostThere:e.suppressAlmostThere,guess:t,state:n};throw new Ie("Invalid score type: "+e.type,Ee.InvalidInput,{metadata:{score:JSON.stringify(e),guess:JSON.stringify(t),state:JSON.stringify(n)}})}function Ot(e,t){let n;return pe.predicate.createValidatorFunctional(function(s){return n=s,!0},{simplify:"optional",inexact:!0,forms:"integer, proper, improper, pi, log, mixed, decimal"},t)(e),n}function Dt(e){return i(e).times(function(){return""})}function Ft(e,t,n,r){const s=Ce(t,n),a=e*s>30;return{scale:s,tickStep:e/r,unityLabel:a}}function Rt(e,t,n){return i(2).times(function(r){const s=Ce(e[r],n);return nt(t[r],s)})}function Ct(e){return[e[0]/2,e[1]/2]}function nt(e,t){const n=e*t,r=e,s=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=Math.floor(r/s);if(n<25)return e;if(n<50)return o===5?e:e/2;if(o===1)return e/2;if(o===2)return e/4;if(o===5)return e/5}function Ce(e,t){const n=e[1]-e[0];return t/n}function qt(e,t){const n=e[1]-e[0];let r;15<n&&n<=20?r=23:n>100||n<5?r=10:r=16;const s=t/500,o=r*s;return qe(n,o)}function qe(e,t){let n=Math.pow(10,Math.floor(Math.log(e/t)/Math.LN10));const r=t/e*n;return r<=.15?n*=10:r<=.35?n*=5:r<=.75&&(n*=2),n}const Ze=(e,t)=>{const n=t[1]-t[0],r=n/e;return r<=10?e:r<=20?e*2:qe(n,10)};function Vt(e,t){return[Ze(e[0],t[0]),Ze(e[1],t[1])]}const Gt={UNSAFE_componentWillMount:function(){const e={};i.each(this.deprecatedProps,function(t,n){i.has(this.props,n)&&i.extend(e,t(this.props))},this),i.isEmpty(e)||(i.extend(this.props,e),setTimeout(this.props.onChange,0,e))}};function Oe(e,t){return typeof e=="number"&&typeof t=="number"?Math.abs(e-t)<1e-9:e===t}function _e(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!_e(e[n],t[n]))return!1;return!0}return Array.isArray(e)||Array.isArray(t)?!1:typeof e=="function"&&typeof t=="function"?Oe(e,t):typeof e=="function"||typeof t=="function"?!1:typeof e=="object"&&typeof t=="object"&&e&&t?e===t||i.all(e,function(n,r){return _e(t[r],n)})&&i.all(t,function(n,r){return _e(e[r],n)}):typeof e=="object"&&e||typeof t=="object"&&t?!1:Oe(e,t)}function Lt(e){e=e||window.location.search.substring(1);const t={},n=/\+/g,r=/([^&=]+)=?([^&]*)/g,s=function(a){return decodeURIComponent(a.replace(n," "))};let o;for(;o=r.exec(e);){const a=o;t[s(a[1])]=s(a[2])}return t}function zt(e,t,n){n=encodeURIComponent(n);const r=new RegExp("([?&])"+t+"=.*?(&|$)","i"),s=e.indexOf("?")!==-1?"&":"?";return e.match(r)?e.replace(r,"$1"+t+"="+n+"$2"):e+s+t+"="+n}function Ut(e){return encodeURIComponent(e).replace(/['()!]/g,window.escape).replace(/\*/g,"%2A")}function Ht(e){if(!e)return!1;switch(e.type){case"measurer":case"protractor":return!0;default:return!1}}function jt(e){return e.type==="invalid"&&(!e.message||e.message.length===0)}const re={pointerDown:!1,currentTouchIdentifier:null};function Wt(){Object.assign(re,{pointerDown:!1,currentTouchIdentifier:null})}function Bt(e){let t;if(re.pointerDown){if(re.currentTouchIdentifier!=null){const r=e.changedTouches?e.changedTouches.length:0;for(let s=0;s<r;s++)e.changedTouches[s].identifier===re.currentTouchIdentifier&&(t=e.changedTouches[s])}else t=e;const n=e.type==="touchend"||e.type==="touchcancel";t&&n&&(re.pointerDown=!1,re.currentTouchIdentifier=null)}else re.pointerDown=!0,e.changedTouches?(t=e.changedTouches[0],re.currentTouchIdentifier=t.identifier):t=e;if(t)return{left:t.pageX,top:t.pageY}}const Jt=()=>{try{const e=Object.defineProperty({},"passive",{get:function(){Je=!0}});window.addEventListener("testPassive",null,e),window.removeEventListener("testPassive",null,e)}catch{}return Je};function Zt(e){e.stopPropagation()}function $t(e,t){const n=new Image;n.onload=function(){var r;n.width===0&&n.height===0?((r=document.body)==null||r.appendChild(n),i.defer(function(){var s;t(n.clientWidth,n.clientHeight),(s=document.body)==null||s.removeChild(n)})):t(n.width,n.height)},n.src=De(e)}function Yt(e){const t=e.value,n=e.selectionStart-1,r=Math.max(t.lastIndexOf(`
`,n),t.lastIndexOf(" ",n))+1;return{string:t.substring(r,n+1),pos:{start:r,end:n}}}function Kt(e,t){e.selectionStart=t,e.selectionEnd=t}const Xt={getWordBeforeCursor:Yt,moveCursor:Kt},Qt=e=>e.startsWith("$")&&e.endsWith("$")?e.slice(1,-1):e,en=Re(new Date().getTime()&4294967295);function rt(e){return Array.isArray(e)?e.map(rt):e}const pn={inputPathsEqual:Mt,nestedMap:et,rWidgetRule:tt,rTypeFromWidgetId:kt,rWidgetParts:_t,snowman:It,noScore:Et,seededRNG:Re,shuffle:St,split:Nt,combineScores:Tt,keScoreFromPerseusScore:At,firstNumericalParse:Ot,stringArrayOfSize:Dt,gridDimensionConfig:Ft,getGridStep:Rt,snapStepFromGridStep:Ct,scaleFromExtent:Ce,tickStepFromExtent:qt,gridStepFromTickStep:nt,tickStepFromNumTicks:qe,constrainedTickStepsFromTickSteps:Vt,DeprecationMixin:Gt,eq:Oe,deepEq:_e,parseQueryString:Lt,updateQueryString:zt,strongEncodeURIComponent:Ut,widgetShouldHighlight:Ht,scoreIsEmpty:jt,touchHandlers:re,resetTouchHandlers:Wt,extractPointerLocation:Bt,supportsPassiveEvents:Jt,captureScratchpadTouchStart:Zt,getImageSize:$t,getImageSizeModern:bt,getRealImageUrl:De,isLabeledSVG:Xe,getBaseUrl:Fe,getSvgUrl:Qe,getDataUrl:wt,textarea:Xt,unescapeMathMode:Qt,random:en,deepClone:rt};export{gt as D,W as K,pn as U,Pt as a,an as b,un as c,fn as d,be as e,ln as f,pe as g,on as h,vt as i,xe as p,cn as r,hn as s,Be as t};
