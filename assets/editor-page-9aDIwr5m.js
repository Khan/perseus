import{W as Ot,G as kt,f as At,M as Vt,h as Rt,p as Mt,T as qt,w as Lt}from"./article-renderer-IypNbsfe.js";import{_ as o}from"./index-default-4_ZsnO94.js";import{U as Ce,r as Ut}from"./util-2H85FoUC.js";import{c,p as u,a as Et}from"./unit-uxf7imOh.js";import{S as zt,P as bt,r as Dt,i as Ft,a as Wt,j as Ht}from"./renderer-qN6twphC.js";import{A as Ae,C as Bt}from"./perseus-api-BF68z3pH.js";import{g as $t}from"./multi-renderer-Su5KW17I.js";import"./hints-renderer-n6WaJYpu.js";import"./base-radio-oIB6BXUd.js";import"./button-group-eBTrRsKy.js";import"./graph-dQsUdvbG.js";import{b as jt}from"./svg-image-8PSZcgZf.js";import"./hud-Q7Km3N9P.js";import"./icon-HbAIhp4d.js";import"./info-tip-_E95qi8X.js";import"./inline-icon-MJBS_-2U.js";import"./math-input-VZoAVMw2.js";import"./multi-button-group-rHU9dGVb.js";import"./number-input-HiFoiqvr.js";import{c as Gt}from"./prop-check-box-Z3f7giBx.js";import"./range-input-FmO-T3Pe.js";import"./text-input-yDsqFbe3.js";import"./text-list-editor-bJphcq85.js";import{g as Ct}from"./dependencies-fnqF3NiV.js";import{$ as Kt}from"./jquery-5v7aFUvu.js";import"./i18n-context-9-s9cJ--.js";import{C as Yt}from"./categorizer-editor-1ZQqj7Pe.js";import{a as r,j as s}from"./jsx-runtime-BGVbfQ2Z.js";import{L as Nt,E as Jt}from"./perseus-error-OpXxk17X.js";import{c as f}from"./components-HqUM7hS5.js";import{P as l}from"./index-tvtfaFq4.js";import{E as m}from"./editor-jsonify-q8hSKygW.js";import{r as h}from"./index-qhcEwEpg.js";import{B as v}from"./blur-input-0MWX_AIX.js";import{D as Xt}from"./definition-editor-0T4pnFxE.js";import{D as Zt}from"./dropdown-editor-1-3qIKbr.js";import{E as Qt}from"./explanation-editor-EOeo26UP.js";import{E as es}from"./expression-editor-Ho-b28ki.js";import{I as Ke}from"./icon-paths-AuJwhOz7.js";import{l as we}from"./index-awljIyHI.js";import{E as w}from"./editor-dBnMYa3x.js";import{G as ts}from"./graph-settings-GboCpI3N.js";import{I as ss}from"./image-editor-t4xVOHnq.js";import{I as is}from"./input-number-editor-6c7pF4fS.js";import{I as rs}from"./interaction-editor-0jlyT8Ga.js";import{I as ns}from"./flags-for-api-options-hKa8DHWg.js";import{L as as}from"./label-image-editor-5RNv4A8W.js";import{M as os}from"./matcher-editor-8CmCdTis.js";import{N as ls}from"./number-line-editor--x9OTohE.js";import{N as ps}from"./numeric-input-editor-YmGr37fZ.js";import{R as Ve}from"./index-E09jvG0x.js";import{P as hs}from"./python-program-editor-tIPpJN7I.js";import{R as cs}from"./editor-bFrC_lAE.js";import{S as ds}from"./sorter-editor-H-0Ajglb.js";import{u as Ee,E as us,M as gs,c as ms,V as fs}from"./compare-VLxlEkSV.js";import{V as ys}from"./viewport-resizer-cfibCHBc.js";import{D as _t}from"./device-framer-axblkSLP.js";import{I as vs}from"./item-extras-editor-UjC6j5aY.js";const{InfoTip:tt,PropCheckBox:st}=f,it=400,rt=400;var N;let ws=(N=class extends h.Component{constructor(){super(...arguments),this.change=(...e)=>c.apply(this,e),this.serialize=()=>m.serialize.call(this)}render(){return r("fieldset",{className:"pair-editor",children:[r("label",{children:["Name:"," ",s(v,{value:this.props.name,onChange:this.change("name")})]}),r("label",{children:[" ","Value:"," ",s(v,{value:this.props.value,onChange:this.change("value")})]})]})}},N.propTypes={...u,name:l.string,value:l.string},N.defaultProps={name:"",value:""},N);var ue;let bs=(ue=class extends h.Component{constructor(){super(...arguments),this.change=(...e)=>c.apply(this,e),this.handlePairChange=(e,t)=>{const i=this.props.pairs.slice();i[e]=t;const n=i[i.length-1];n.name&&n.value&&i.push({name:"",value:""}),this.change("pairs",i)},this.serialize=()=>m.serialize.call(this)}render(){const e=o.map(this.props.pairs,(t,i)=>s(ws,{name:t.name,value:t.value,onChange:this.handlePairChange.bind(this,i)},i));return s("div",{children:e})}},ue.propTypes={...u,pairs:l.arrayOf(l.shape({name:l.string,value:l.string})).isRequired},ue);const Cs=/khanacademy\.org\/computer-programming\/[^\/]+\/(\d+)/;function Ns(a){const e=Cs.exec(a);return e&&(a=e[1]),a}const S=class S extends h.Component{constructor(){super(...arguments),this.change=(...e)=>c.apply(this,e),this._handleSettingsChange=e=>{this.change({settings:e.pairs})},this._handleProgramIDChange=e=>{e=Ns(e);const{isDevServer:t,InitialRequestUrl:i}=Ct(),p=`${t?i.origin:"https://www.khanacademy.org"}/api/internal/scratchpads/${e}`;Kt.getJSON(p).done(d=>{const g=d.userAuthoredContentType;this.change({width:d.width,height:d.height,programID:e,programType:g})}).fail((d,g,y)=>{Nt.error("Error retrieving scratchpad info for program ID ",Jt.TransientService,{cause:y,loggedMetadata:{textStatus:g,programID:e}}),this.change({width:it,height:rt,programID:e,programType:null})})},this.serialize=()=>m.serialize.call(this)}render(){return r("div",{children:[r("label",{children:["Url or Program ID:"," ",s(v,{value:this.props.programID,onChange:this._handleProgramIDChange})]}),s("br",{}),s(st,{label:"Show Editor",showEditor:this.props.showEditor,onChange:this.props.onChange}),s(tt,{children:'If you show the editor, you should use the "full-width" alignment to make room for the width of the editor.'}),s("br",{}),s(st,{label:"Show Buttons",showButtons:this.props.showButtons,onChange:this.props.onChange}),s("br",{}),r("label",{children:["Settings:",s(bs,{name:"settings",pairs:this.props.settings,onChange:this._handleSettingsChange}),r(tt,{children:["Settings that you add here are available to the program as an object returned by ",s("code",{children:"Program.settings()"})]})]})]})}};S.propTypes={...u},S.widgetName="cs-program",S.defaultProps={programID:"",programType:null,settings:[{name:"",value:""}],showEditor:!1,showButtons:!1,width:it,height:rt};let $=S;try{$.displayName="CSProgramEditor",$.__docgenInfo={description:"This is the main editor for this widget, to specify all the options.",displayName:"CSProgramEditor",props:{}}}catch{}const Ye=class Ye extends h.Component{serialize(){return m.serialize.call(this)}render(){return r("div",{children:[s("p",{children:"This widget has been deprecated and removed"}),s("p",{children:"Learners will see a message and they will not be graded on this part. Please replace this widget with a supported one."})]})}};Ye.widgetName="deprecated-standin";let j=Ye;try{j.displayName="DeprecatedStandinEditor",j.__docgenInfo={description:"",displayName:"DeprecatedStandinEditor",props:{onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(options: any) => void"}}}}}catch{}const{Graphie:xt}=f,Re=xt.MovablePoint;var _;let _s=(_=class extends h.Component{constructor(){super(...arguments),this.getUserInput=()=>Ot.getUserInput.call(this),this.change=(...e)=>c.apply(this,e),this.movePoint=e=>{this.change({coord:e})},this._getGridConfig=e=>o.map(e.step,function(t,i){return Ce.gridDimensionConfig(t,e.range[i],e.box[i],e.gridStep[i])}),this.setupGraphie=(e,t)=>{const i=this._getGridConfig(t);e.graphInit({range:t.range,scale:o.pluck(i,"scale"),axisArrows:"<->",labelFormat:function(n){return"\\small{"+n+"}"},gridStep:t.gridStep,tickStep:o.pluck(i,"tickStep"),labelStep:1,unityLabels:o.pluck(i,"unityLabel")}),e.label([0,t.range[1][1]],t.labels[1],"above")},this.simpleValidate=e=>_.validate(this.getUserInput(),e)}static validate(e,t){return e.coord==null?{type:"invalid",message:null}:jt(e.coord,t.correct)?{type:"points",earned:1,total:1,message:null}:{type:"points",earned:0,total:1,message:null}}render(){var e;return s(xt,{ref:"graphie",box:this.props.graph.box,range:this.props.graph.range,options:this.props.graph,setup:this.setupGraphie,setDrawingAreaAvailable:(e=this.props.apiOptions)==null?void 0:e.setDrawingAreaAvailable,children:s(Re,{pointSize:5,coord:this.props.coord||[0,0],constraints:[Re.constraints.snap(),Re.constraints.bound()],onMove:this.movePoint})})}},_.defaultProps={coord:null,graph:{box:[400,400],labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],gridStep:[1,1],valid:!0,backgroundImage:null,markings:"grid",showProtractor:!1}},_);const It={name:"example-graphie-widget",displayName:"Example Graphie Widget",hidden:!0,widget:_s};try{examplegraphiewidget.displayName="examplegraphiewidget",examplegraphiewidget.__docgenInfo={description:`For this widget to work, we must export it.
We also must import this file in src/all-widgets.js`,displayName:"examplegraphiewidget",props:{}}}catch{}const xs=It.widget,P=class P extends h.Component{constructor(){super(...arguments),this.change=(...e)=>c.apply(this,e),this.handleChange=e=>{e.coord&&this.change({correct:e.coord})},this.serialize=()=>m.serialize.call(this)}render(){return s("div",{children:s(xs,{graph:this.props.graph,coord:this.props.correct,onChange:this.handleChange,apiOptions:this.props.apiOptions})})}};P.propTypes={...u},P.widgetName="example-graphie-widget",P.defaultProps={correct:[4,4],graph:{box:[340,340],labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],gridStep:[1,1],valid:!0,backgroundImage:null,markings:"grid",showProtractor:!1}};let G=P;try{G.displayName="ExampleGraphieWidgetEditor",G.__docgenInfo={description:`This is the widget's editor. This is what shows up on the left side
of the screen in the demo page. Only the question writer sees this.`,displayName:"ExampleGraphieWidgetEditor",props:{}}}catch{}const O=class O extends h.Component{constructor(){super(...arguments),this.input=h.createRef(),this.handleAnswerChange=e=>{this.change({correct:e.target.value})},this.change=(...e)=>c.apply(this,e),this.focus=()=>{var e;return(e=this.input.current)==null||e.focus(),!0},this.serialize=()=>m.serialize.call(this)}render(){return s("div",{children:r("label",{children:["Correct answer:",s("input",{value:this.props.correct,onChange:this.handleAnswerChange,ref:this.input})]})})}};O.propTypes={...u},O.widgetName="example-widget",O.defaultProps={correct:""};let K=O;try{K.displayName="ExampleWidgetEditor",K.__docgenInfo={description:`This is the widget's editor. This is what shows up on the left side
of the screen in the demo. Only the question writer sees this.`,displayName:"ExampleWidgetEditor",props:{}}}catch{}const{InlineIcon:nt,TextInput:Is}=f,{iconPlus:Ts,iconTrash:Ss}=Ke,k=class k extends h.Component{constructor(){super(...arguments),this.editor=h.createRef(),this.hintEditor=h.createRef(),this.change=(...e)=>c.apply(this,e),this.handleAddHint=()=>{const e={content:""};this.props.onChange({hint:e},()=>{var t;(t=this.hintEditor.current)==null||t.focus()})},this.handleRemoveHint=e=>{this.props.onChange({hint:null})},this.getSaveWarnings=()=>{var e;return(e=this.editor.current)==null?void 0:e.getSaveWarnings()},this.serialize=()=>{var e,t;return{title:this.props.title,...(e=this.editor.current)==null?void 0:e.serialize(),hint:(t=this.hintEditor.current)==null?void 0:t.serialize()}}}render(){return r("div",{className:"perseus-group-editor",children:[s("div",{className:"perseus-widget-row",children:r("label",{className:we.css(Me.title),children:["Title:"," ",s(Is,{value:this.props.title,className:we.css(Me.input),onChange:this.change("title")})]})}),s(w,{ref:this.editor,content:this.props.content,widgets:this.props.widgets,apiOptions:this.props.apiOptions,images:this.props.images,widgetEnabled:!0,immutableWidgets:!1,onChange:this.props.onChange,warnNoPrompt:!0,warnNoWidgets:!0}),!this.props.hint&&r("button",{type:"button",style:{marginTop:10},className:"add-hint simple-button orange",onClick:this.handleAddHint,children:[s(nt,{...Ts})," Add a hint"]}),this.props.hint&&r("div",{className:"perseus-hint-editor",children:[s("div",{className:we.css(Me.hintsTitle),children:"Hint"}),s(w,{ref:this.hintEditor,content:this.props.hint?this.props.hint.content:"",widgets:this.props.hint?this.props.hint.widgets:{},apiOptions:this.props.apiOptions,images:this.props.hint&&this.props.hint.images,widgetEnabled:!0,immutableWidgets:!1,onChange:e=>{this.change("hint",Object.assign({},this.props.hint,e))}}),r("button",{type:"button",className:"remove-hint simple-button orange",onClick:this.handleRemoveHint,children:[s(nt,{...Ss})," Remove this hint"]})]})]})}};k.propTypes={...u,title:l.string,content:l.string,widgets:l.object,images:l.object,apiOptions:Ae.propTypes},k.widgetName="graded-group",k.defaultProps={title:"",content:"",widgets:{},images:{},hint:null};let b=k;const Me=we.StyleSheet.create({title:{fontSize:18,fontWeight:"bold"},input:{fontSize:18},hintsTitle:{marginTop:10,fontSize:"110%",fontWeight:"bold"}});try{b.displayName="GradedGroupEditor",b.__docgenInfo={description:"",displayName:"GradedGroupEditor",props:{}}}catch{}const A=class A extends h.Component{constructor(){super(...arguments),this.change=(...e)=>c.apply(this,e),this.getSaveWarnings=()=>[].concat(...this._editors.map(e=>e?e.getSaveWarnings():[])),this.serialize=()=>({gradedGroups:this.props.gradedGroups}),this.renderGroups=()=>this.props.gradedGroups?this.props.gradedGroups.map((e,t)=>s(b,{ref:i=>this._editors[t]=i,...e,apiOptions:this.props.apiOptions,widgetEnabled:!0,immutableWidgets:!1,onChange:i=>this.change("gradedGroups",Ps(this.props.gradedGroups,t,{...this.props.gradedGroups[t],...i}))},t)):null,this.addGroup=()=>{const e=this.props.gradedGroups||[];this.change("gradedGroups",e.concat([b.defaultProps]))}}UNSAFE_componentWillMount(){this._editors=[]}render(){return r("div",{className:"perseus-group-editor",children:[this.renderGroups(),s("button",{onClick:this.addGroup,children:"Add group"})]})}};A.propTypes={...u,apiOptions:Ae.propTypes,gradedGroups:l.array,onChange:l.func.isRequired},A.widgetName="graded-group-set",A.defaultProps={gradedGroups:[]};let Y=A;const Ps=(a,e,t)=>[...a.slice(0,e),t,...a.slice(e+1)];try{Y.displayName="GradedGroupSetEditor",Y.__docgenInfo={description:"",displayName:"GradedGroupSetEditor",props:{}}}catch{}const{InfoTip:Os,MultiButtonGroup:ks}=f,{containerSizeClass:As,getInteractiveBoxFromSizeClass:Vs}=zt,Rs=kt.widget,{DEFAULT_GRAPHER_PROPS:qe,allTypes:Ms,chooseType:qs,defaultPlotProps:Ls,getEquationString:Us,typeToButton:Es}=At,V=class V extends h.Component{constructor(){super(...arguments),this.change=(...e)=>c.apply(this,e),this.handleAvailableTypesChange=e=>{let t=this.props.correct;if(!o.contains(e,this.props.correct.type)){const i=this.props.graph,n=qs(e);t=Ls(n,i)}this.props.onChange({availableTypes:e,correct:t})},this.serialize=()=>o.chain(this.props).pick("correct","availableTypes").extend({graph:o.omit(this.props.graph,"box")}).value()}render(){const e=As.SMALL;let t,i;if(this.props.graph.valid===!0){const n={graph:this.props.graph,plot:this.props.correct,availableTypes:this.props.availableTypes,onChange:(p,d)=>{var y;let g=this.props.correct;g.type===((y=p.plot)==null?void 0:y.type)?g=o.extend({},g,p.plot):g=p.plot,this.props.onChange({correct:g},d)},trackInteraction:function(){}};i=s(Rs,{...n,apiOptions:this.props.apiOptions,containerSizeClass:e}),t=Us(n)}else i=s("div",{className:"perseus-error",children:this.props.graph.valid});return r("div",{children:[r("div",{children:["Correct answer"," ",s(Os,{children:s("p",{children:"Graph the correct answer in the graph below and ensure the equation or point coordinates displayed represent the correct answer."})})," ",": ",t]}),s(ts,{editableSettings:["graph","snap","image"],box:Vs(e),range:this.props.graph.range,labels:this.props.graph.labels,step:this.props.graph.step,gridStep:this.props.graph.gridStep,snapStep:this.props.graph.snapStep,valid:this.props.graph.valid,backgroundImage:this.props.graph.backgroundImage,markings:this.props.graph.markings,rulerLabel:this.props.graph.rulerLabel,rulerTicks:this.props.graph.rulerTicks,showTooltips:this.props.graph.showTooltips,onChange:this.change("graph")}),r("div",{className:"perseus-widget-row",children:[s("label",{children:"Available functions: "}),s(ks,{allowEmpty:!1,values:this.props.availableTypes,buttons:o.map(Ms,Es),onChange:this.handleAvailableTypesChange})]}),i]})}};V.propTypes={...u},V.widgetName="grapher",V.defaultProps={correct:qe.plot,graph:qe.graph,availableTypes:qe.availableTypes};let J=V;try{J.displayName="GrapherEditor",J.__docgenInfo={description:"",displayName:"GrapherEditor",props:{}}}catch{}const R=class R extends h.Component{constructor(){super(...arguments),this.editor=h.createRef(),this._renderMetadataEditor=()=>{const e=this.props.apiOptions.GroupMetadataEditor;return s(e,{value:this.props.metadata,onChange:this.change("metadata")})},this.change=(...e)=>c.apply(this,e),this.getSaveWarnings=()=>{var e;return(e=this.editor.current)==null?void 0:e.getSaveWarnings()},this.serialize=()=>{var e;return o.extend({},(e=this.editor.current)==null?void 0:e.serialize(),{metadata:this.props.metadata})}}render(){return r("div",{className:"perseus-group-editor",children:[s("div",{children:this._renderMetadataEditor()}),s(w,{ref:this.editor,content:this.props.content,widgets:this.props.widgets,apiOptions:this.props.apiOptions,images:this.props.images,widgetEnabled:!0,immutableWidgets:!1,onChange:this.props.onChange})]})}};R.propTypes={...u,content:l.string,widgets:l.object,images:l.object,metadata:l.any,apiOptions:Ae.propTypes},R.widgetName="group",R.defaultProps={content:"",widgets:{},images:{},metadata:void 0};let X=R;try{X.displayName="GroupEditor",X.__docgenInfo={description:"",displayName:"GroupEditor",props:{}}}catch{}const{PropCheckBox:at}=f,Ie=class Ie extends h.Component{constructor(){super(...arguments),this.change=(...e)=>c.apply(this,e),this.serialize=()=>m.serialize.call(this)}render(){return r("fieldset",{children:[r("label",{children:["Name:",s(v,{value:this.props.name,onChange:this.change("name")})]}),r("label",{children:["Value:",s(v,{value:this.props.value,onChange:this.change("value")})]})]})}};Ie.propTypes={...u,name:l.string,value:l.string},Ie.defaultProps={name:"",value:""};let ze=Ie;const Je=class Je extends h.Component{constructor(){super(...arguments),this.change=(...e)=>c.apply(this,e),this.handlePairChange=(e,t)=>{const i=this.props.pairs.slice();i[e]=t;const n=i[i.length-1];n.name&&n.value&&i.push({name:"",value:""}),this.change("pairs",i)},this.serialize=()=>m.serialize.call(this)}render(){const e=o.map(this.props.pairs,(t,i)=>s(ze,{name:t.name,value:t.value,onChange:this.handlePairChange.bind(this,i)},i));return s("div",{children:e})}};Je.propTypes={...u,pairs:l.arrayOf(l.shape({name:l.string,value:l.string})).isRequired};let De=Je;const M=class M extends h.Component{constructor(){super(...arguments),this.change=(...e)=>c.apply(this,e),this.handleSettingsChange=e=>{this.change({settings:e.pairs})},this.serialize=()=>m.serialize.call(this)}render(){return r("div",{children:[r("div",{style:{fontWeight:"bold",textAlign:"center"},children:["This widget is deprecated! ",s("br",{}),"Try using the Video or CS Program widgets instead."]}),r("label",{children:["Url or Program ID:",s(v,{value:this.props.url,onChange:this.change("url")})]}),s("br",{}),r("label",{children:["Settings:",s(De,{name:"settings",pairs:this.props.settings,onChange:this.handleSettingsChange})]}),s("br",{}),r("label",{children:["Width:",s(v,{value:this.props.width,onChange:this.change("width")})]}),r("label",{children:["Height:",s(v,{value:this.props.height,onChange:this.change("height")})]}),s(at,{label:"Allow full screen",allowFullScreen:this.props.allowFullScreen,onChange:this.props.onChange}),s("br",{}),s(at,{label:"Allow iframe content to redirect the page",allowTopNavigation:this.props.allowTopNavigation,onChange:this.props.onChange})]})}};M.propTypes={...u},M.widgetName="iframe",M.defaultProps={url:"",settings:[{name:"",value:""}],width:"400",height:"400",allowFullScreen:!1,allowTopNavigation:!1};let Z=M;try{Z.displayName="IframeEditor",Z.__docgenInfo={description:"This is the main editor for this widget, to specify all the options.",displayName:"IframeEditor",props:{}}}catch{}const{RangeInput:zs}=f,Ds=Vt.widget,ot=6,Fs=function(a){const e=[1,1];return o(a).each((t,i)=>{let n=0;o(t).each((p,d)=>{p!=null&&p.toString().length&&(n=d+1)}),e[1]=Math.max(e[1],n),n>0&&(e[0]=Math.max(e[0],i+1))}),e},q=class q extends h.Component{constructor(){super(...arguments),this.change=(...e)=>c.apply(this,e),this.onMatrixBoardSizeChange=e=>{const t=Fs(this.props.answers);if(e[0]!==null&&e[1]!==null){e=[Math.round(Math.min(Math.max(e[0],1),ot)),Math.round(Math.min(Math.max(e[1],1),ot))];const i=o(Math.min(e[0],t[0])).times(n=>o(Math.min(e[1],t[1])).times(p=>this.props.answers[n][p]));this.props.onChange({matrixBoardSize:e,answers:i})}},this.serialize=()=>m.serialize.call(this)}render(){const e=o.extend({numericInput:!0,onBlur:()=>{},onFocus:()=>{},trackInteraction:()=>{}},this.props);return r("div",{className:"perseus-matrix-editor",children:[r("div",{className:"perseus-widget-row",children:[" ","Max matrix size:"," ",s(zs,{value:this.props.matrixBoardSize,onChange:this.onMatrixBoardSizeChange,format:this.props.labelStyle,useArrowKeys:!0})]}),s("div",{className:"perseus-widget-row",children:s(Ds,{...e})}),r("div",{className:"perseus-widget-row",children:[" ","Matrix prefix:"," ",s(w,{ref:"prefix",apiOptions:this.props.apiOptions,content:this.props.prefix,widgetEnabled:!1,onChange:t=>{this.change({prefix:t.content})}})]}),r("div",{className:"perseus-widget-row",children:[" ","Matrix suffix:"," ",s(w,{ref:"suffix",apiOptions:this.props.apiOptions,content:this.props.suffix,widgetEnabled:!1,onChange:t=>{this.change({suffix:t.content})}})]})]})}};q.propTypes={...u,matrixBoardSize:l.arrayOf(l.number).isRequired,answers:l.arrayOf(l.arrayOf(l.number)),prefix:l.string,suffix:l.string,cursorPosition:l.arrayOf(l.number)},q.widgetName="matrix",q.defaultProps={matrixBoardSize:[3,3],answers:[[]],prefix:"",suffix:"",cursorPosition:[0,0]};let Q=q;try{Q.displayName="MatrixEditor",Q.__docgenInfo={description:"",displayName:"MatrixEditor",props:{}}}catch{}const{InfoTip:Ws,NumberInput:me,PropCheckBox:lt,RangeInput:Hs}=f,Bs={url:null,top:0,left:0},L=class L extends h.Component{constructor(){super(...arguments),this.className="perseus-widget-measurer",this.change=(...e)=>c.apply(this,e),this._changeUrl=e=>{this._changeImage("url",e.target.value)},this._changeTop=e=>{this._changeImage("top",e)},this._changeLeft=e=>{this._changeImage("left",e)},this._changeImage=(e,t)=>{const i=o.clone(this.props.image);i[e]=t,this.change("image",i)},this.renderLabelChoices=e=>o.map(e,function(t){const[i,n]=t;return s("option",{value:n,children:i},n)}),this.serialize=()=>m.serialize.call(this)}render(){const e=o.extend({},Bs,this.props.image);return r("div",{className:"perseus-widget-measurer",children:[s("div",{children:"Image displayed under protractor and/or ruler:"}),r("div",{children:["URL:"," ",s("input",{type:"text",className:"perseus-widget-measurer-url",ref:"image-url",defaultValue:e.url,onChange:this._changeUrl}),s(Ws,{children:s("p",{children:'Create an image in graphie, or use the "Add image" function to create a background.'})})]}),e.url&&r("div",{className:"perseus-widget-row",children:[r("label",{className:"perseus-widget-left-col",children:["Pixels from top:"," ",s(me,{placeholder:0,onChange:this._changeTop,value:e.top,useArrowKeys:!0})]}),r("label",{className:"perseus-widget-right-col",children:["Pixels from left:"," ",s(me,{placeholder:0,onChange:this._changeLeft,value:e.left,useArrowKeys:!0})]})]}),r("div",{children:["Containing area [width, height]:"," ",s(Hs,{onChange:this.change("box"),value:this.props.box,useArrowKeys:!0})]}),r("div",{className:"perseus-widget-row",children:[s("div",{className:"perseus-widget-left-col",children:s(lt,{label:"Show ruler",showRuler:this.props.showRuler,onChange:this.props.onChange})}),s("div",{className:"perseus-widget-right-col",children:s(lt,{label:"Show protractor",showProtractor:this.props.showProtractor,onChange:this.props.onChange})})]}),this.props.showRuler&&r("div",{children:[s("div",{children:r("label",{children:[" ","Ruler label:"," ",r("select",{onChange:t=>this.change("rulerLabel",t.target.value),value:this.props.rulerLabel,children:[s("option",{value:"",children:"None"}),s("optgroup",{label:"Metric",children:this.renderLabelChoices([["milimeters","mm"],["centimeters","cm"],["meters","m"],["kilometers","km"]])}),s("optgroup",{label:"Imperial",children:this.renderLabelChoices([["inches","in"],["feet","ft"],["yards","yd"],["miles","mi"]])})]})]})}),s("div",{children:r("label",{children:[" ","Ruler ticks:"," ",s("select",{onChange:t=>this.change("rulerTicks",+t.target.value),value:this.props.rulerTicks,children:o.map([1,2,4,8,10,16],function(t){return s("option",{value:t,children:t},t)})})]})}),s("div",{children:r("label",{children:["Ruler pixels per unit:"," ",s(me,{placeholder:40,onChange:this.change("rulerPixels"),value:this.props.rulerPixels,useArrowKeys:!0})]})}),s("div",{children:r("label",{children:["Ruler length in units:"," ",s(me,{placeholder:10,onChange:this.change("rulerLength"),value:this.props.rulerLength,useArrowKeys:!0})]})})]})]})}};L.widgetName="measurer",L.propTypes={...u,box:l.arrayOf(l.number),image:l.shape({url:l.string,top:l.number,left:l.number}),showProtractor:l.bool,showRuler:l.bool,rulerLabel:l.string,rulerTicks:l.number,rulerPixels:l.number,rulerLength:l.number},L.defaultProps={box:[480,480],image:{},showProtractor:!0,showRuler:!1,rulerLabel:"",rulerTicks:10,rulerPixels:40,rulerLength:10};let ee=L;try{ee.displayName="MeasurerEditor",ee.__docgenInfo={description:"",displayName:"MeasurerEditor",props:{}}}catch{}const{NumberInput:$s,TextInput:js}=f,Te=class Te extends h.Component{constructor(){super(...arguments),this.change=(...e)=>c.apply(this,e),this.updateMolecule=e=>{this.change({smiles:e})},this.updateRotation=e=>{this.change({rotationAngle:e})},this.serialize=()=>m.serialize.call(this)}render(){return r("div",{children:[s("div",{children:r("label",{children:["SMILES: ",s(js,{onChange:this.updateMolecule,value:this.props.smiles})]})}),s("div",{children:r("label",{children:["Rotation (deg): ",s($s,{onChange:this.updateRotation,value:this.props.rotationAngle})]})})]})}};Te.propTypes={...u,rotationAngle:l.number,smiles:l.string},Te.widgetName="molecule-renderer";let te=Te;try{te.displayName="MoleculeWidgetEditor",te.__docgenInfo={description:"",displayName:"MoleculeWidgetEditor",props:{}}}catch{}const{InfoTip:fe,TextListEditor:pt}=f,Le="normal",ht="auto",Ue="horizontal",ct="vertical",U=class U extends h.Component{constructor(){super(...arguments),this.onOptionsChange=(e,t,i)=>{const n={};n[e]=o.map(t,function(p){return{content:p}}),this.props.onChange(n,i)},this.onLayoutChange=e=>{this.props.onChange({layout:e.target.value})},this.onHeightChange=e=>{this.props.onChange({height:e.target.value})},this.serialize=()=>({options:o.chain(o.pluck(this.props.correctOptions,"content")).union(o.pluck(this.props.otherOptions,"content")).uniq().reject(function(t){return t===""}).sort().sortBy(function(t){return/\d/.test(t)?0:/^\$?[a-zA-Z]+\$?$/.test(t)?2:1}).map(function(t){return{content:t}}).value(),correctOptions:this.props.correctOptions,otherOptions:this.props.otherOptions,height:this.props.height,layout:this.props.layout})}render(){return r("div",{className:"perseus-widget-orderer",children:[r("div",{children:[" ","Correct answer:"," ",s(fe,{children:s("p",{children:"Place the cards in the correct order. The same card can be used more than once in the answer but will only be displayed once at the top of a stack of identical cards."})})]}),s(pt,{options:o.pluck(this.props.correctOptions,"content"),onChange:this.onOptionsChange.bind(this,"correctOptions"),layout:this.props.layout}),r("div",{children:[" ","Other cards:"," ",s(fe,{children:s("p",{children:"Create cards that are not part of the answer."})})]}),s(pt,{options:o.pluck(this.props.otherOptions,"content"),onChange:this.onOptionsChange.bind(this,"otherOptions"),layout:this.props.layout}),r("div",{children:[r("label",{children:[" ","Layout:"," ",r("select",{value:this.props.layout,onChange:this.onLayoutChange,children:[s("option",{value:Ue,children:"Horizontal"}),s("option",{value:ct,children:"Vertical"})]})]}),s(fe,{children:s("p",{children:"Use the horizontal layout for short text and small images. The vertical layout is best for longer text (e.g. proofs)."})})]}),r("div",{children:[r("label",{children:[" ","Height:"," ",r("select",{value:this.props.height,onChange:this.onHeightChange,children:[s("option",{value:Le,children:"Normal"}),s("option",{value:ht,children:"Automatic"})]})]}),s(fe,{children:s("p",{children:'Use "Normal" for text, "Automatic" for images.'})})]})]})}};U.propTypes={correctOptions:l.array,otherOptions:l.array,height:l.oneOf([Le,ht]),layout:l.oneOf([Ue,ct]),onChange:l.func.isRequired},U.widgetName="orderer",U.defaultProps={correctOptions:[{content:"$x$"}],otherOptions:[{content:"$y$"}],height:Le,layout:Ue};let se=U;try{se.displayName="OrdererEditor",se.__docgenInfo={description:"",displayName:"OrdererEditor",props:{}}}catch{}const{InfoTip:dt,PropCheckBox:Gs}=f,E=class E extends h.Component{constructor(){super(...arguments),this.change=(...e)=>c.apply(this,e),this.serialize=()=>m.serialize.call(this)}render(){const e=s(w,{ref:"passage-editor",apiOptions:this.props.apiOptions,content:this.props.passageText,widgetEnabled:!1,placeholder:"Type passage here...",onChange:i=>{this.change({passageText:i.content})},showWordCount:!0}),t=s(w,{ref:"passage-footnotes-editor",apiOptions:this.props.apiOptions,content:this.props.footnotes,widgetEnabled:!1,placeholder:"Type footnotes here...",onChange:i=>{this.change({footnotes:i.content})}});return r("div",{className:"perseus-widget-passage-editor",children:[s("div",{className:"perseus-widget-row",children:s(Gs,{label:"Show line numbers",labelAlignment:"right",showLineNumbers:this.props.showLineNumbers,onChange:this.props.onChange})}),r("div",{children:["Passage title:",s(dt,{children:s("p",{children:"An optional title that will appear directly above the passage in the same font style. (E.g. Passage 1)"})}),s("div",{children:s("input",{type:"text",defaultValue:this.props.passageTitle,onChange:i=>{this.change({passageTitle:i.target.value})}})})]}),r("div",{children:["Passage Text:",e]}),r("div",{children:["Footnotes:",s(dt,{children:s("p",{children:"To add footnotes, add ^ characters where they belong in the passage. Then, add ^ in the footnotes area to reference the footnotes in the passage."})}),t]})]})}};E.propTypes={...u,passageTitle:l.string,passageText:l.string,footnotes:l.string,showLineNumbers:l.bool},E.widgetName="passage",E.defaultProps={passageTitle:"",passageText:"",footnotes:"",showLineNumbers:!0};let ie=E;try{ie.displayName="PassageEditor",ie.__docgenInfo={description:"",displayName:"PassageEditor",props:{}}}catch{}const{InfoTip:Ks,NumberInput:ut,TextInput:Ys}=f,z=class z extends h.Component{constructor(){super(...arguments),this.change=(...e)=>c.apply(this,e),this.serialize=()=>m.serialize.call(this)}render(){return r("div",{children:[s("div",{children:r("label",{children:["Passage Number: ",s(ut,{value:this.props.passageNumber,onChange:this.change("passageNumber")})]})}),s("div",{children:r("label",{children:["Reference Number: ",s(ut,{value:this.props.referenceNumber,onChange:this.change("referenceNumber")})]})}),s("div",{children:r("label",{children:["Summary Text: ",s(Ys,{value:this.props.summaryText,onChange:this.change("summaryText")}),r(Ks,{children:[s("p",{children:"Short summary of the referenced section. This will be included in parentheses and quotes automatically."}),s("p",{children:"Ex: The start ... the end"})]})]})})]})}};z.propTypes={...u,passageNumber:l.number,referenceNumber:l.number,summaryText:l.string},z.widgetName="passage-ref",z.defaultProps={passageNumber:1,referenceNumber:1,summaryText:""};let re=z;try{re.displayName="PassageRefEditor",re.__docgenInfo={description:"",displayName:"PassageRefEditor",props:{}}}catch{}const D=class D extends h.Component{constructor(){super(...arguments),this.change=(...e)=>c.apply(this,e),this.handleContentChange=e=>{this.change({content:e.target.value})},this.serialize=()=>m.serialize.call(this)}render(){return r("div",{children:["Content:",s("input",{type:"text",value:this.props.content,onChange:this.handleContentChange})]})}};D.propTypes={...u,content:l.string},D.widgetName="passage-ref-target",D.defaultProps={content:""};let ne=D;try{ne.displayName="PassageRefTargetEditor",ne.__docgenInfo={description:"",displayName:"PassageRefTargetEditor",props:{}}}catch{}const{InfoTip:I,NumberInput:gt,RangeInput:Js,TextListEditor:Xs}=f,Zs=Rt.widget,Fe="starting",We="correct",Qs=[Fe,We];function mt(a,e,t){const i=o.clone(a);i.length=e;for(let n=a.length;n<e;n++)i[n]=t;return i}const ye={scaleY:1,maxY:10,snapsPerLine:2},ft=a=>"$"+Ut(a,2)+"$",Se=class Se extends h.Component{constructor(){super(...arguments),this.state={editing:this.props.static?Fe:We,pic:null,loadedUrl:null,minX:null,maxX:null,tickStep:null},this.fetchPic=e=>{if(this.state.loadedUrl!==e){const t=new Image;t.src=e,t.onload=()=>{this.setState({pic:t,loadedUrl:e})}}},this.handleChangeTickStep=e=>{this.setState({tickStep:e})},this.handleChangeRange=e=>{this.setState({minX:e[0],maxX:e[1]})},this.changeLabelInterval=e=>{this.props.onChange({labelInterval:e})},this.handlePlotterChange=e=>{const t={};t[this.state.editing]=e.values,this.props.onChange(t)},this.changeType=e=>{let t;if(e==="histogram"?(t=[ft(0)].concat(this.props.categories),this.props.onChange({type:e,categories:t})):this.props.type==="histogram"?(t=this.props.categories.slice(1),this.props.onChange({type:e,categories:t})):this.props.onChange({type:e}),t){const i=Ve.findDOMNode(this.refs.categories);i.value=t.join(", ")}},this.changeLabel=(e,t)=>{const i=o.clone(this.props.labels);i[e]=t.target.value,this.props.onChange({labels:i})},this.changePicUrl=e=>{const t=Ce.getRealImageUrl(e);this.props.onChange({picUrl:t})},this.changeCategories=e=>{let t=e.length;this.props.type==="histogram"&&t--;const i=this.props.scaleY;this.props.onChange({categories:e,correct:mt(this.props.correct,t,i),starting:mt(this.props.starting,t,i)})},this.changeScale=e=>{const t=this.props.scaleY,i=+e.target.value||ye.scaleY,n=function(d){return d*i/t},p=n(this.props.maxY);this.props.onChange({scaleY:i,maxY:p,correct:o.map(this.props.correct,n),starting:o.map(this.props.starting,n)}),Ve.findDOMNode(this.refs.maxY).value=p},this.changeMax=e=>{this.props.onChange({maxY:+e.target.value||ye.maxY})},this.changeSnaps=e=>{this.props.onChange({snapsPerLine:+e.target.value||ye.snapsPerLine})},this.changeEditing=e=>{this.setState({editing:e})},this.setCategoriesFromScale=()=>{const e=this.state.tickStep||1,t=this.state.minX||0,i=this.state.maxX||0,n=Math.floor((i-t)/e)*e;let p;this.props.type==="histogram"||this.props.type==="dotplot"?p=o.range(0,n+e,e):p=o.range(e,n+e,e),p=o.map(p,g=>g+t),p=o.map(p,ft),this.changeCategories(p);const d=Ve.findDOMNode(this.refs.categories);d.value=p.join(", ")},this.serialize=()=>{const e=o.pick(this.props,"correct","starting","type","labels","categories","scaleY","maxY","snapsPerLine","labelInterval");return this.props.type==="pic"&&(e.picUrl=this.props.picUrl),e}}UNSAFE_componentWillMount(){this.fetchPic(this.props.picUrl)}UNSAFE_componentWillReceiveProps(e){this.fetchPic(e.picUrl),e.static&&this.setState({editing:"starting"})}render(){const e=o.contains(["line","histogram","dotplot"],this.props.type),t=!o.contains(["pic","dotplot"],this.props.type),i={trackInteraction:()=>{},...this.props};return r("div",{className:"perseus-widget-plotter-editor",children:[r("div",{children:["Chart type:"," ",Mt.map(n=>r("label",{children:[s("input",{type:"radio",name:"chart-type",checked:this.props.type===n,onChange:o.partial(this.changeType,n)}),n]},n),this)]}),r("div",{children:["Labels:"," ",["x","y"].map((n,p)=>r("label",{children:[n+":",s("input",{type:"text",onChange:o.partial(this.changeLabel,p),defaultValue:this.props.labels[p]})]},n),this)]}),e&&r("div",{className:"set-from-scale-box",children:[s("span",{className:"categories-title",children:"Set Categories From Scale"}),r("div",{children:[r("label",{children:["Tick Step:"," ",s(gt,{placeholder:1,useArrowKeys:!0,value:this.state.tickStep,onChange:this.handleChangeTickStep})]}),s(I,{children:s("p",{children:"The difference between adjacent ticks."})})]}),s("div",{children:r("label",{children:["Range:"," ",s(Js,{placeholder:[0,10],useArrowKeys:!0,value:[this.state.minX,this.state.maxX],onChange:this.handleChangeRange})]})}),s("div",{children:r("button",{onClick:this.setCategoriesFromScale,children:["Set Categories"," "]})})]}),r("div",{children:[r("label",{children:["Label Interval:"," ",s(gt,{useArrowKeys:!0,value:this.props.labelInterval,onChange:this.changeLabelInterval})]}),s(I,{children:s("p",{children:'Which ticks to display the labels for. For instance, setting this to "4" will only show every 4th label (plus the last one)'})})]}),this.props.type==="pic"&&r("div",{children:[r("label",{children:["Picture:"," ",s(v,{className:"pic-url",value:this.props.picUrl,onChange:this.changePicUrl}),s(I,{children:s("p",{children:'Use the default picture of Earth, or insert the URL for a different picture using the "Add image" function.'})})]}),this.state.pic&&this.state.pic.width!==this.state.pic.height&&r("p",{className:"warning",children:[s("b",{children:"Warning"}),": You are using a picture which is not square. This means the image will get distorted. You should probably crop it to be square."]})]}),s("div",{children:r("label",{children:["Categories:"," ",s(Xs,{ref:"categories",layout:"horizontal",options:this.props.categories,onChange:this.changeCategories})]})}),s("div",{children:r("label",{children:["Scale (y):"," ",s("input",{type:"text",onChange:this.changeScale,defaultValue:this.props.scaleY})]})}),s("div",{children:r("label",{children:["Max y:"," ",s("input",{type:"text",ref:"maxY",onChange:this.changeMax,defaultValue:this.props.maxY})]})}),t&&r("div",{children:[r("label",{children:["Snaps per line:"," ",s("input",{type:"text",onChange:this.changeSnaps,defaultValue:this.props.snapsPerLine})]}),s(I,{children:s("p",{children:"Creates the specified number of divisions between the horizontal lines. Fewer snaps between lines makes the graph easier for the student to create correctly."})})]}),r("div",{children:["Editing values:"," ",Qs.map(n=>r("label",{children:[s("input",{type:"radio",disabled:n===We&&this.props.static,checked:this.props.static?n===Fe:this.state.editing===n,onChange:p=>this.changeEditing(n)}),n]},n)),r(I,{children:[s("p",{children:"Use this toggle to switch between editing the correct answer (what the student will be graded on) and the starting values (what the student will see plotted when they start the problem). Note: These cannot be the same."}),s("p",{children:"In static mode, the starting values are rendered out to the displayed widget."})]})]}),s(Zs,{...i,starting:this.props[this.state.editing],onChange:this.handlePlotterChange})]})}};Se.widgetName="plotter",Se.defaultProps={...ye,correct:[1],starting:[1],type:"bar",labels:["",""],categories:[""],picSize:30,picBoxHeight:36,plotDimensions:[275,200],labelInterval:1,get picUrl(){const e=Ct().staticUrl;return e?e("/images/badges/earth-small.png"):null}};let ae=Se;try{ae.displayName="PlotterEditor",ae.__docgenInfo={description:"",displayName:"PlotterEditor",props:{type:{defaultValue:{value:"bar"},description:"",name:"type",required:!1,type:{name:"enum",value:[{value:'"line"'},{value:'"bar"'},{value:'"pic"'},{value:'"histogram"'},{value:'"dotplot"'}]}},labels:{defaultValue:{value:'["", ""]'},description:"",name:"labels",required:!1,type:{name:"string[]"}},categories:{defaultValue:{value:'[""]'},description:"",name:"categories",required:!1,type:{name:"readonly (string | number)[]"}},scaleY:{defaultValue:null,description:"",name:"scaleY",required:!0,type:{name:"number"}},maxY:{defaultValue:null,description:"",name:"maxY",required:!0,type:{name:"number"}},snapsPerLine:{defaultValue:null,description:"",name:"snapsPerLine",required:!0,type:{name:"number"}},picSize:{defaultValue:{value:"30"},description:"",name:"picSize",required:!1,type:{name:"number"}},picBoxHeight:{defaultValue:{value:"36"},description:"",name:"picBoxHeight",required:!1,type:{name:"number"}},picUrl:{defaultValue:null,description:"",name:"picUrl",required:!0,type:{name:"string"}},plotDimensions:{defaultValue:{value:"[275, 200]"},description:"",name:"plotDimensions",required:!1,type:{name:"readonly number[]"}},labelInterval:{defaultValue:{value:"1"},description:"",name:"labelInterval",required:!1,type:{name:"number"}},starting:{defaultValue:{value:"[1]"},description:"",name:"starting",required:!1,type:{name:"readonly number[]"}},correct:{defaultValue:{value:"[1]"},description:"",name:"correct",required:!1,type:{name:"readonly number[]"}},static:{defaultValue:null,description:"",name:"static",required:!0,type:{name:"boolean"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"any"}}}}}catch{}class ei extends h.Component{constructor(){super(...arguments),this.focus=()=>(this.refs.input.focus(),!0),this.changeValue=e=>{this.props.onChange(e.target.value)}}render(){return s("textarea",{ref:"input",value:this.props.value||"",onChange:this.changeValue})}}const F=class F extends h.Component{constructor(){super(...arguments),this.input=h.createRef(),this.change=(...e)=>c.apply(this,e),this.focus=()=>{var e;return(e=this.input.current)==null||e.focus(),!0},this.serialize=()=>m.serialize.call(this)}render(){return s("div",{children:r("label",{children:[s("div",{children:"Simple markdown contents:"}),s("div",{children:s(ei,{value:this.props.value,onChange:this.change("value"),ref:this.input})})]})})}};F.propTypes={...u},F.widgetName="simple-markdown-tester",F.defaultProps={value:""};let oe=F;try{oe.displayName="SimpleMarkdownTesterEditor",oe.__docgenInfo={description:"",displayName:"SimpleMarkdownTesterEditor",props:{}}}catch{}const{InfoTip:ti,NumberInput:yt}=f,si=qt.widget,W=class W extends h.Component{constructor(){super(...arguments),this.numberOfColumns=h.createRef(),this.focus=()=>{var e;(e=this.numberOfColumns.current)==null||e.focus()},this.onSizeInput=(e,t)=>{let i=+e||0,n=+t||0;i=Math.min(Math.max(1,i),30),n=Math.min(Math.max(1,n),6);const p=this.props.columns,d=this.props.rows,g=this.props.answers;i<=d?g.length=i:o(i-d).times(function(){g.push(Ce.stringArrayOfSize(p))});function y(x){n<=p?x.length=n:o(n-p).times(function(){x.push("")})}const ge=this.props.headers;y(ge),o.each(g,y),this.props.onChange({rows:i,columns:n,answers:g,headers:ge})},this.serialize=()=>{const e=o.pick(this.props,"headers","rows","columns");return o.extend({},e,{answers:o.map(this.props.answers,o.clone)})}}render(){const e=o.pick(this.props,"headers","answers","onChange","apiOptions");return o.extend(e,{editableHeaders:!0,Editor:w,onFocus:()=>{},onBlur:()=>{},trackInteraction:()=>{}}),r("div",{children:[s("div",{className:"perseus-widget-row",children:r("label",{children:["Number of columns:"," ",s(yt,{ref:this.numberOfColumns,value:this.props.columns,onChange:t=>{t&&this.onSizeInput(this.props.rows,t)},useArrowKeys:!0})]})}),s("div",{className:"perseus-widget-row",children:r("label",{children:["Number of rows:"," ",s(yt,{ref:"numberOfRows",value:this.props.rows,onChange:t=>{t&&this.onSizeInput(t,this.props.columns)},useArrowKeys:!0})]})}),r("div",{children:[" ","Table of answers:"," ",s(ti,{children:s("p",{children:"The student has to fill out all cells in the table. For partially filled tables create a table using the template, and insert text input boxes as desired."})})]}),s("div",{children:s(si,{...e})})]})}};W.propTypes={rows:l.number,columns:l.number,headers:l.arrayOf(l.string),answers:l.arrayOf(l.arrayOf(l.string))},W.widgetName="table",W.defaultProps=function(){const i=o(4).times(function(){return Ce.stringArrayOfSize(1)});return{headers:[""],rows:4,columns:1,answers:i}}();let le=W;try{le.displayName="TableEditor",le.__docgenInfo={description:"",displayName:"TableEditor",props:{}}}catch{}const{InlineIcon:Ne,NumberInput:ii}=f,{iconOk:Tt,iconRemove:St}=Ke,ve="all",T="some",Pt=10,ri=function(a,e){return Et(a,e,-Pt,!1)},vt=function(a){return a.simplify().asMul().partition()[1].flatten().simplify()};class ni extends h.Component{constructor(){super(...arguments),this._checkValidity=({name:e,original:t,sigfigs:i})=>{const n=Ee(e);let p="",d=!0;if(n.parsed&&t){const g=new fs("x"),{unit:y}=n,ge=new us(t,"=",new gs(g,y));try{const x=ge.solveLinearEquationForVariable(g);p=ri(x.eval(),i),d=ms(vt(t),vt(y)).equal}catch{d=!1}}else d=!1;this.setState({valid:d,solvedExample:p})}}UNSAFE_componentWillMount(){this._checkValidity(this.props)}UNSAFE_componentWillReceiveProps(e){this._checkValidity(e)}render(){let e;return this.state.valid?e=r("span",{children:[s("span",{className:"unit-example-okay",children:s(Ne,{...Tt})}),this.state.solvedExample]}):e=s("span",{className:"unit-example-not-okay",children:s(Ne,{...St})}),r("div",{children:[e," ",this.props.name]})}}const H=class H extends h.Component{constructor(e){super(e),this.change=(...t)=>c.apply(this,t),this.handleAcceptingUnitsChange=t=>{const i=t.target.value.split(",").map(n=>n.trim()).filter(n=>n!=="");this.change({acceptingUnits:i})},this.handleSigfigChange=t=>{this.change({sigfigs:t})},this._checkSigfigValidity=t=>t>0&&t<=Pt,this._setAccepting=t=>{this.change({accepting:t})},this._doOriginal=t=>{const i=Ee(t.value);this.parsed=!1,i.parsed&&i.type==="unitMagnitude"&&(this.original=i.expr,this.parsed=!0)},this.onChange=t=>{this.props.onChange({value:t.target.value})},this.getSaveWarnings=()=>{const{value:t,accepting:i,acceptingUnits:n}=this.props,p=[];return Ee(t).parsed||p.push("Answer did not parse"),i===T&&n.length===0&&p.push("There are no accepted units"),p},this.serialize=()=>m.serialize.call(this),this.groupId=o.uniqueId("accepting"),this._doOriginal(e)}UNSAFE_componentWillReceiveProps(e){this._doOriginal(e)}render(){const{acceptingUnits:e=[],accepting:t}=this.props;let i=null;if(t===T){const n=e.map((p,d)=>s(ni,{name:p,original:this.original||null,sigfigs:this.props.sigfigs},d));i=r("div",{children:[s("input",{type:"text",defaultValue:e.join(", "),onChange:this.handleAcceptingUnitsChange})," ","(comma-separated)",n]})}return r("div",{className:"unit-editor",children:[r("div",{children:[s("input",{value:this.props.value,className:"unit-editor-canonical",onChange:this.onChange})," ",this.parsed?s("span",{className:"unit-example-okay",children:s(Ne,{...Tt})}):s("span",{className:"unit-example-not-okay",children:s(Ne,{...St})})]}),r("div",{children:["Significant Figures:"," ",s(ii,{value:this.props.sigfigs,onChange:this.handleSigfigChange,checkValidity:this._checkSigfigValidity,useArrowKeys:!0})]}),r("div",{children:[r("label",{children:[s("input",{type:"radio",name:this.groupId,onChange:()=>this._setAccepting(ve),checked:this.props.accepting===ve})," Any equivalent unit "]}),r("label",{children:[s("input",{type:"radio",name:this.groupId,onChange:()=>this._setAccepting(T),checked:this.props.accepting===T})," Only these units "]})]}),i]})}};H.propTypes={...u,value:l.string,acceptingUnits:l.arrayOf(l.string),accepting:l.oneOf([ve,T]),sigfigs:l.number},H.widgetName="unit-input",H.defaultProps={value:"5x10^5 kg m / s^2",accepting:ve,sigfigs:3};let pe=H;try{pe.displayName="UnitInputEditor",pe.__docgenInfo={description:"",displayName:"UnitInputEditor",props:{}}}catch{}const{InfoTip:ai}=f,oi=/khanacademy\.org\/.*\/v\/(.*)$/;function li(a){const e=oi.exec(a);return e?e[1]:a}const B=class B extends h.Component{constructor(){super(...arguments),this._handleUrlChange=e=>{this.props.onChange({location:li(e)})},this.change=(...e)=>c.apply(this,e),this.serialize=()=>m.serialize.call(this)}render(){return s("div",{children:r("label",{children:["KA Video Slug:"," ",s(v,{value:this.props.location,style:{width:290},onChange:this._handleUrlChange}),s(ai,{children:"KA video URLs will be converted to just the slug."})]})})}};B.propTypes={...u,location:l.string,onChange:l.func},B.widgetName="video",B.defaultProps={location:""};let he=B;try{he.displayName="VideoEditor",he.__docgenInfo={description:"This is the main editor for this widget, to specify all the options.",displayName:"VideoEditor",props:{}}}catch{}const pi=[Yt,$,Xt,Zt,G,K,Qt,es,b,Y,J,X,Z,ss,is,rs,ns,as,os,Q,ee,te,ls,ps,se,ie,re,ne,ae,hs,oe,ds,le,pe,he,cs,j];class hi extends h.Component{constructor(){super(...arguments),this.input=h.createRef(),this.focus=()=>{var e;return(e=this.input.current)==null||e.focus(),!0},this.changeValue=e=>{this.props.onChange(e.target.value)}}render(){return s("input",{ref:this.input,value:this.props.value||"",onChange:this.changeValue})}}const Pe=class Pe extends h.Component{constructor(){super(...arguments),this.input=h.createRef(),this.change=(...e)=>c.apply(this,e),this.getUserInput=()=>this.props.value,this.focus=()=>{var e;return(e=this.input.current)==null||e.focus(),!0},this.simpleValidate=e=>Pe.validate(this.getUserInput(),e)}static validate(e,t){return e===""?{type:"invalid",message:"It looks like you haven't answered all of the question yet."}:e===t.correct?{type:"points",earned:1,total:1,message:null}:{type:"points",earned:0,total:1,message:null}}render(){return s(hi,{ref:this.input,value:this.props.value,onChange:this.change("value")})}};Pe.defaultProps={value:""};let He=Pe;const ci={name:"example-widget",displayName:"Example Widget",defaultAlignment:"inline-block",hidden:!0,widget:He};try{examplewidget.displayName="examplewidget",examplewidget.__docgenInfo={description:"For this widget to work, we must import this file in src/all-widgets.js",displayName:"examplewidget",props:{}}}catch{}const di=bt.parse,ui=bt.basicOutput,Oe=class Oe extends h.Component{constructor(){super(...arguments),this.change=(...e)=>c.apply(this,e),this.toJSON=()=>({}),this.focus=()=>(this.refs.input.focus(),!0),this.simpleValidate=e=>Oe.validate(this.toJSON(),e)}static validate(e,t){return{type:"points",earned:0,total:0,message:null}}render(){const e=di(this.props.value),t=ui(e);return s("div",{children:t})}};Oe.defaultProps={value:""};let Be=Oe;const gi={name:"simple-markdown-tester",displayName:"Simple Markdown Tester",hidden:!0,widget:Be,transform:o.identity};try{simplemarkdowntester.displayName="simplemarkdowntester",simplemarkdowntester.__docgenInfo={description:"For this widget to work, we must import this file in src/all-widgets.js",displayName:"simplemarkdowntester",props:{}}}catch{}const mi=[It,ci,gi],fi=[...Lt,...mi],Or=()=>{Dt(fi),Ft(pi),Wt(),Ht()},yi=Gt({displayName:"JsonEditor",getInitialState:function(){return{currentValue:JSON.stringify(this.props.value,null,4),valid:!0}},UNSAFE_componentWillReceiveProps:function(a){(!this.state.valid||!o.isEqual(a.value,JSON.parse(this.state.currentValue)))&&this.setState(this.getInitialState())},render:function(){const a="perseus-json-editor "+(this.state.valid?"valid":"invalid");return s("textarea",{className:a,value:this.state.currentValue,onChange:this.handleChange,onKeyDown:this.handleKeyDown,onBlur:this.handleBlur})},handleKeyDown:function(a){if(a.key==="Tab"){const e=a.target.selectionStart,t=a.target.value,i=t.substring(0,e),n=t.substring(e,t.length);a.target.value=i+"    "+n,a.target.selectionStart=i.length+4,a.target.selectionEnd=i.length+4,a.preventDefault(),this.handleChange(a)}},handleChange:function(a){const e=a.target.value;try{let t=JSON.parse(e);o.isString(t)&&(t=JSON.parse(t)),this.setState({currentValue:e,valid:!0},function(){this.props.onChange(t)})}catch{this.setState({currentValue:e,valid:!1})}},handleBlur:function(a){const e=a.target.value;try{let t=JSON.parse(e);o.isString(t)&&(t=JSON.parse(t)),this.setState({currentValue:JSON.stringify(t,null,4),valid:!0},function(){this.props.onChange(t)})}catch{this.setState({currentValue:JSON.stringify(this.props.value,null,4),valid:!0})}}});let wt=0;const $e={},je={};window.iframeDataStore={};window.addEventListener("message",a=>{if(typeof a.data=="string"){const e=$e[a.data];e&&e()}else a.data.id&&(a.data.height!==void 0?je[a.data.id](a.data.height):a.data.lintWarnings&&Nt.log("LINTER REPORT",{lintWarnings:JSON.stringify(a.data.lintWarnings)}))});class _e extends h.Component{constructor(){super(...arguments),this.container=h.createRef()}componentDidMount(){this._isMounted=!0,this.iframeID=wt,wt++,this._prepareFrame(),$e[this.iframeID]=()=>{this.sendNewData(this._lastData)},je[this.iframeID]=e=>{this._lastHeight=e,this._isMounted&&this.props.seamless&&this.container.current&&(this.container.current.style.height=e+"px")}}shouldComponentUpdate(e){return e.datasetValue!==this.props.datasetValue||e.seamless!==this.props.seamless}componentDidUpdate(e){this.container.current&&(this.props.seamless?this.container.current.style.height=this._lastHeight+"px":this.container.current.style.height="100%"),e.datasetValue!==this.props.datasetValue&&this._prepareFrame()}componentWillUnmount(){$e[this.iframeID]=null,je[this.iframeID]=null,this._isMounted=!1}_prepareFrame(){var t,i;this._frame&&((t=this.container.current)==null||t.removeChild(this._frame));const e=document.createElement("iframe");e.style.width="100%",e.style.height="100%",e.src=this.props.url,this.props.datasetKey&&(e.dataset[this.props.datasetKey]=this.props.datasetValue),e.dataset.id=String(this.iframeID),this.props.seamless&&(e.dataset.lintGutter="true"),(i=this.container.current)==null||i.appendChild(e),this._frame=e}sendNewData(e){const t=this._frame;this._isMounted&&e&&(t!=null&&t.contentWindow)&&(this._lastData=e,window.iframeDataStore[this.iframeID]=e,t.contentWindow.postMessage(this.iframeID,"*"))}render(){return s("div",{ref:this.container,style:{width:"100%",height:"100%"}})}}try{_e.displayName="IframeContentRenderer",_e.__docgenInfo={description:"",displayName:"IframeContentRenderer",props:{url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}},datasetKey:{defaultValue:null,description:"",name:"datasetKey",required:!0,type:{name:"string"}},datasetValue:{defaultValue:null,description:"",name:"datasetValue",required:!0,type:{name:"any"}},seamless:{defaultValue:null,description:"",name:"seamless",required:!0,type:{name:"boolean"}}}}}catch{}const{InfoTip:vi,InlineIcon:be}=f,{iconCircleArrowDown:wi,iconCircleArrowUp:bi,iconPlus:Ci,iconTrash:Ni}=Ke,Xe=class Xe extends h.Component{constructor(){super(...arguments),this.editor=h.createRef(),this.handleChange=e=>{this.props.onChange({replace:e.target.checked})},this.focus=()=>{var e;(e=this.editor.current)==null||e.focus()},this.getSaveWarnings=()=>{var e;return(e=this.editor.current)==null?void 0:e.getSaveWarnings()},this.serialize=e=>{var t;return(t=this.editor.current)==null?void 0:t.serialize(e)}}render(){return r("div",{className:"perseus-hint-editor "+this.props.className,children:[this.props.showTitle&&s("div",{className:"pod-title",children:"Hint"}),s(w,{ref:this.editor,apiOptions:this.props.apiOptions,widgets:this.props.widgets||void 0,content:this.props.content||void 0,images:this.props.images,replace:this.props.replace,placeholder:"Type your hint here...",imageUploader:this.props.imageUploader,onChange:this.props.onChange},this.props.itemId),r("div",{className:"hint-controls-container clearfix",children:[this.props.showMoveButtons&&r("span",{className:"reorder-hints",children:[s("button",{type:"button",className:this.props.isLast?"hidden":"",onClick:o.partial(this.props.onMove,1),children:s(be,{...wi})})," ",s("button",{type:"button",className:this.props.isFirst?"hidden":"",onClick:o.partial(this.props.onMove,-1),children:s(be,{...bi})})," ",this.props.isLast&&s(vi,{children:s("p",{children:"The last hint is automatically bolded."})})]}),s("input",{type:"checkbox",checked:this.props.replace,onChange:this.handleChange}),"Replace previous hint",this.props.showRemoveButton&&r("button",{type:"button",className:"remove-hint simple-button orange",onClick:this.props.onRemove,children:[s(be,{...Ni}),"Remove this hint"," "]})]})]})}};Xe.defaultProps={className:"",content:"",replace:!1,showMoveButtons:!0,showTitle:!0,showRemoveButton:!0};let C=Xe;const Ze=class Ze extends h.Component{constructor(){super(...arguments),this.editor=h.createRef(),this.frame=h.createRef(),this.updatePreview=()=>{var t;const e=this.props.isLast&&!/\*\*/.test(this.props.hint.content);(t=this.frame.current)==null||t.sendNewData({type:"hint",data:{hint:this.props.hint,bold:e,pos:this.props.pos,apiOptions:this.props.apiOptions,linterContext:{contentType:"hint",highlightLint:this.props.highlightLint,paths:this.props.contentPaths}}})},this.getSaveWarnings=()=>{var e;return(e=this.editor.current)==null?void 0:e.getSaveWarnings()},this.serialize=e=>{var t;return(t=this.editor.current)==null?void 0:t.serialize(e)},this.focus=()=>{var e;(e=this.editor.current)==null||e.focus()}}componentDidMount(){this.updatePreview()}componentDidUpdate(){this.updatePreview()}render(){const e=this.props.deviceType==="phone"||this.props.deviceType==="tablet";return r("div",{className:"perseus-combined-hint-editor perseus-editor-row",children:[s("div",{className:"perseus-editor-left-cell",children:s(C,{ref:this.editor,itemId:this.props.itemId,isFirst:this.props.isFirst,isLast:this.props.isLast,widgets:this.props.hint.widgets,content:this.props.hint.content,images:this.props.hint.images,replace:this.props.hint.replace,imageUploader:this.props.imageUploader,onChange:this.props.onChange,onRemove:this.props.onRemove,onMove:this.props.onMove,apiOptions:this.props.apiOptions})}),s("div",{className:"perseus-editor-right-cell",children:s(_t,{deviceType:this.props.deviceType,nochrome:!0,children:s(_e,{ref:this.frame,datasetKey:"mobile",datasetValue:e,seamless:!0,url:this.props.previewURL})})})]})}};Ze.defaultProps={highlightLint:!1};let Ge=Ze;const ke=class ke extends h.Component{constructor(){super(...arguments),this.handleHintChange=(e,t,i,n)=>{const p=o(this.props.hints).clone();p[e]=o.extend({},this.serializeHint(e,{keepDeletedWidgets:!0}),t),this.props.onChange({hints:p},i,n)},this.handleHintRemove=e=>{if(!confirm("Are you sure you want to delete this hint?"))return;const t=o(this.props.hints).clone();t.splice(e,1),this.props.onChange({hints:t})},this.handleHintMove=(e,t)=>{const i=o(this.props.hints).clone(),n=i.splice(e,1)[0];i.splice(e+t,0,n),this.props.onChange({hints:i},()=>{this.refs["hintEditor"+(e+t)].focus()})},this.addHint=()=>{const e=o(this.props.hints).clone().concat([{content:""}]);this.props.onChange({hints:e},()=>{const t=e.length-1;this.refs["hintEditor"+t].focus()})},this.getSaveWarnings=()=>o.chain(this.props.hints).map((e,t)=>o.map(this.refs["hintEditor"+t].getSaveWarnings(),i=>"Hint "+(t+1)+": "+i)).flatten(!0).value(),this.serialize=e=>this.props.hints.map((t,i)=>this.serializeHint(i,e)),this.serializeHint=(e,t)=>this.refs["hintEditor"+e].serialize(t)}render(){const{itemId:e,hints:t}=this.props,i=o.map(t,function(n,p){return s(Ge,{ref:"hintEditor"+p,isFirst:p===0,isLast:p+1===t.length,itemId:e,hint:n,pos:p,imageUploader:this.props.imageUploader,onChange:this.handleHintChange.bind(this,p),onRemove:this.handleHintRemove.bind(this,p),onMove:this.handleHintMove.bind(this,p),deviceType:this.props.deviceType,apiOptions:this.props.apiOptions,highlightLint:this.props.highlightLint,previewURL:this.props.previewURL,contentPaths:[]},"hintEditor"+p)},this);return r("div",{className:"perseus-hints-editor perseus-editor-table",children:[i,s("div",{className:"perseus-editor-row",children:s("div",{className:"add-hint-container perseus-editor-left-cell",children:r("button",{type:"button",className:"add-hint simple-button orange",onClick:this.addHint,children:[s(be,{...Ci})," Add a hint"]})})})]})}};ke.HintEditor=C,ke.defaultProps={onChange:()=>{},hints:[],highlightLint:!1};let ce=ke;try{C.displayName="HintEditor",C.__docgenInfo={description:"",displayName:"HintEditor",props:{itemId:{defaultValue:null,description:"",name:"itemId",required:!1,type:{name:"string"}},apiOptions:{defaultValue:null,description:"",name:"apiOptions",required:!1,type:{name:"Readonly<{ isArticle?: boolean; onInputError?: ((widgetId: any, value: string, message?: string | null) => unknown) | undefined; onFocusChange?: ((newFocusPath: FocusPath, oldFocusPath: FocusPath, keypadHeight?: number | undefined, focusedElement?: HTMLElement | undefined) => unknown) | undef..."}},className:{defaultValue:{value:""},description:"",name:"className",required:!1,type:{name:"string"}},imageUploader:{defaultValue:null,description:"",name:"imageUploader",required:!1,type:{name:"ImageUploader"}},showMoveButtons:{defaultValue:{value:"true"},description:"",name:"showMoveButtons",required:!1,type:{name:"boolean"}},showRemoveButton:{defaultValue:{value:"true"},description:"",name:"showRemoveButton",required:!1,type:{name:"boolean"}},showTitle:{defaultValue:{value:"true"},description:"",name:"showTitle",required:!1,type:{name:"boolean"}},content:{defaultValue:{value:""},description:"",name:"content",required:!1,type:{name:"string | null"}},replace:{defaultValue:{value:"false"},description:"",name:"replace",required:!1,type:{name:"boolean | null"}},widgets:{defaultValue:null,description:"",name:"widgets",required:!1,type:{name:"WidgetDict | null"}},images:{defaultValue:null,description:"",name:"images",required:!1,type:{name:"ImageDict | null"}},isLast:{defaultValue:null,description:"",name:"isLast",required:!0,type:{name:"boolean"}},isFirst:{defaultValue:null,description:"",name:"isFirst",required:!0,type:{name:"boolean"}},onMove:{defaultValue:null,description:"",name:"onMove",required:!0,type:{name:"(direction: number) => unknown"}},onRemove:{defaultValue:null,description:"",name:"onRemove",required:!0,type:{name:"() => unknown"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"ChangeHandler"}},__type:{defaultValue:null,description:"",name:"__type",required:!1,type:{name:"enum",value:[{value:'"hint"'}]}}}}}catch{}try{ce.displayName="CombinedHintsEditor",ce.__docgenInfo={description:"",displayName:"CombinedHintsEditor",props:{apiOptions:{defaultValue:null,description:"",name:"apiOptions",required:!1,type:{name:"Readonly<{ isArticle?: boolean; onInputError?: ((widgetId: any, value: string, message?: string | null) => unknown) | undefined; onFocusChange?: ((newFocusPath: FocusPath, oldFocusPath: FocusPath, keypadHeight?: number | undefined, focusedElement?: HTMLElement | undefined) => unknown) | undef..."}},deviceType:{defaultValue:null,description:"",name:"deviceType",required:!0,type:{name:"enum",value:[{value:'"phone"'},{value:'"tablet"'},{value:'"desktop"'}]}},imageUploader:{defaultValue:null,description:"",name:"imageUploader",required:!1,type:{name:"ImageUploader"}},highlightLint:{defaultValue:{value:"false"},description:"",name:"highlightLint",required:!1,type:{name:"boolean"}},hints:{defaultValue:{value:"[]"},description:"",name:"hints",required:!1,type:{name:"readonly Hint[]"}},previewURL:{defaultValue:null,description:"",name:"previewURL",required:!0,type:{name:"string"}},onChange:{defaultValue:{value:"() => {}"},description:"",name:"onChange",required:!1,type:{name:"ChangeHandler"}},itemId:{defaultValue:null,description:"",name:"itemId",required:!1,type:{name:"string"}}}}}catch{}const _i=$t,Qe=class Qe extends h.Component{constructor(){super(...arguments),this.frame=h.createRef(),this.questionEditor=h.createRef(),this.itemExtrasEditor=h.createRef(),this.updateProps=(e,t,i)=>{const n=o(this.props).pick("question","answerArea");this.props.onChange(o(n).extend(e),t,i)},this.triggerPreviewUpdate=e=>{var t;(t=this.frame.current)==null||t.sendNewData(e)},this.handleEditorChange=(e,t,i)=>{const n=o.extend({},this.props.question,e);this.updateProps({question:n},t,i)},this.handleItemExtrasChange=(e,t,i)=>{const n=o.extend({},this.props.answerArea,e);this.updateProps({answerArea:n},t,i)},this.getSaveWarnings=()=>{var e;return(e=this.questionEditor.current)==null?void 0:e.getSaveWarnings()},this.serialize=e=>{var t,i;return{question:(t=this.questionEditor.current)==null?void 0:t.serialize(e),answerArea:(i=this.itemExtrasEditor.current)==null?void 0:i.serialize(),itemDataVersion:_i}}}render(){const e=this.props.deviceType==="phone"||this.props.deviceType==="tablet";return r("div",{className:"perseus-editor-table",children:[r("div",{className:"perseus-editor-row perseus-question-container",children:[r("div",{className:"perseus-editor-left-cell",children:[s("div",{className:"pod-title",children:"Question"}),s(w,{ref:this.questionEditor,placeholder:"Type your question here...",className:"perseus-question-editor",imageUploader:this.props.imageUploader,onChange:this.handleEditorChange,apiOptions:this.props.apiOptions,showWordCount:!0,...this.props.question},this.props.itemId)]}),s("div",{className:"perseus-editor-right-cell",children:r("div",{id:"problemarea",children:[s(_t,{deviceType:this.props.deviceType,nochrome:!0,children:s(_e,{ref:this.frame,datasetKey:"mobile",datasetValue:e,seamless:!0,url:this.props.previewURL},this.props.deviceType)}),s("div",{id:"hintsarea",className:"hintsarea",style:{display:"none"}})]})})]}),r("div",{className:"perseus-editor-row perseus-answer-container",children:[r("div",{className:"perseus-editor-left-cell",children:[s("div",{className:"pod-title",children:"Question extras"}),s(vs,{ref:this.itemExtrasEditor,onChange:this.handleItemExtrasChange,...this.props.answerArea})]}),s("div",{className:"perseus-editor-right-cell",children:s("div",{id:"answer_area"})})]})]})}};Qe.defaultProps={onChange:()=>{},question:{},answerArea:{}};let de=Qe;try{de.displayName="ItemEditor",de.__docgenInfo={description:"",displayName:"ItemEditor",props:{apiOptions:{defaultValue:null,description:"",name:"apiOptions",required:!1,type:{name:"Readonly<{ isArticle?: boolean; onInputError?: ((widgetId: any, value: string, message?: string | null) => unknown) | undefined; onFocusChange?: ((newFocusPath: FocusPath, oldFocusPath: FocusPath, keypadHeight?: number | undefined, focusedElement?: HTMLElement | undefined) => unknown) | undef..."}},deviceType:{defaultValue:null,description:"",name:"deviceType",required:!1,type:{name:"enum",value:[{value:'"phone"'},{value:'"tablet"'},{value:'"desktop"'}]}},gradeMessage:{defaultValue:null,description:"",name:"gradeMessage",required:!1,type:{name:"string"}},imageUploader:{defaultValue:null,description:"",name:"imageUploader",required:!1,type:{name:"ImageUploader"}},wasAnswered:{defaultValue:null,description:"",name:"wasAnswered",required:!1,type:{name:"boolean"}},question:{defaultValue:{value:"{}"},description:"",name:"question",required:!1,type:{name:"any"}},answerArea:{defaultValue:{value:"{}"},description:"",name:"answerArea",required:!1,type:{name:"any"}},previewURL:{defaultValue:null,description:"",name:"previewURL",required:!0,type:{name:"string"}},onChange:{defaultValue:{value:"() => {}"},description:"",name:"onChange",required:!1,type:{name:"ChangeHandler"}},itemId:{defaultValue:null,description:"",name:"itemId",required:!1,type:{name:"string"}}}}}catch{}const{HUD:xi}=f,et=class et extends h.Component{constructor(e){super(e),this.itemEditor=h.createRef(),this.hintsEditor=h.createRef(),this.toggleJsonMode=()=>{this.setState({json:this.serialize({keepDeletedWidgets:!0})},()=>{this.props.onChange({jsonMode:!this.props.jsonMode})})},this.handleChange=(t,i,n)=>{const p=o(this.props).pick("question","hints","answerArea");o(p).extend(t),this.props.onChange(p,i,n)},this.changeJSON=t=>{this.setState({json:t}),this.props.onChange(t)},this.state={json:o.pick(this.props,"question","answerArea","hints","itemDataVersion"),gradeMessage:"",wasAnswered:!1,highlightLint:!0},this._isMounted=!1}componentDidMount(){this._isMounted=!0,this.updateRenderer()}componentDidUpdate(){setTimeout(()=>{this.updateRenderer()})}componentWillUnmount(){this._isMounted=!1}updateRenderer(){var n,p;const e=!this.props.developerMode||!this.props.jsonMode;if(!this._isMounted||!e)return;const t=this.props.previewDevice==="phone"||this.props.previewDevice==="tablet",i={...this.getApiOptions(),customKeypad:t,isMobile:t};(p=this.itemEditor.current)==null||p.triggerPreviewUpdate({type:"question",data:o({item:this.serialize(),apiOptions:i,initialHintsVisible:0,device:this.props.previewDevice,linterContext:{contentType:"exercise",highlightLint:this.state.highlightLint,paths:this.props.contentPaths||[]},reviewMode:!0,legacyPerseusLint:(n=this.itemEditor.current)==null?void 0:n.getSaveWarnings()}).extend(o(this.props).pick("workAreaSelector","solutionAreaSelector","hintsAreaSelector","problemNum"))})}getApiOptions(){return{...Ae.defaults,...this.props.apiOptions}}getSaveWarnings(){var i,n;const e=(i=this.itemEditor.current)==null?void 0:i.getSaveWarnings(),t=(n=this.hintsEditor.current)==null?void 0:n.getSaveWarnings();return e.concat(t)}serialize(e){var t,i;return this.props.jsonMode?this.state.json:o.extend((t=this.itemEditor.current)==null?void 0:t.serialize(e),{hints:(i=this.hintsEditor.current)==null?void 0:i.serialize(e)})}scorePreview(){return this.renderer?this.renderer.scoreInput():null}render(){let e="framework-perseus";const t=this.props.previewDevice==="phone"||this.props.previewDevice==="tablet",i={...this.getApiOptions(),customKeypad:t,isMobile:t};return i.isMobile&&(e+=" "+Bt.MOBILE),r("div",{id:"perseus",className:e,children:[r("div",{style:{marginBottom:10},children:[this.props.developerMode&&r("span",{children:[r("label",{children:[" ","Developer JSON Mode:"," ",s("input",{type:"checkbox",checked:this.props.jsonMode,onChange:this.toggleJsonMode})]})," "]}),!this.props.jsonMode&&s(ys,{deviceType:this.props.previewDevice,onViewportSizeChanged:this.props.onPreviewDeviceChange}),!this.props.jsonMode&&s(xi,{message:"Style warnings",enabled:this.state.highlightLint,onClick:()=>{this.setState({highlightLint:!this.state.highlightLint})}})]}),this.props.developerMode&&this.props.jsonMode&&s("div",{children:s(yi,{multiLine:!0,value:this.state.json,onChange:this.changeJSON})}),(!this.props.developerMode||!this.props.jsonMode)&&s(de,{ref:this.itemEditor,itemId:this.props.itemId,question:this.props.question,answerArea:this.props.answerArea,imageUploader:this.props.imageUploader,onChange:this.handleChange,wasAnswered:this.state.wasAnswered,gradeMessage:this.state.gradeMessage,deviceType:this.props.previewDevice,apiOptions:i,previewURL:this.props.previewURL}),(!this.props.developerMode||!this.props.jsonMode)&&s(ce,{ref:this.hintsEditor,itemId:this.props.itemId,hints:this.props.hints,imageUploader:this.props.imageUploader,onChange:this.handleChange,deviceType:this.props.previewDevice,apiOptions:i,previewURL:this.props.previewURL,highlightLint:this.state.highlightLint})]})}};et.defaultProps={developerMode:!1,jsonMode:!1,onChange:()=>{}};let xe=et;try{xe.displayName="EditorPage",xe.__docgenInfo={description:"",displayName:"EditorPage",props:{apiOptions:{defaultValue:null,description:"",name:"apiOptions",required:!1,type:{name:"Readonly<{ isArticle?: boolean; onInputError?: ((widgetId: any, value: string, message?: string | null) => unknown) | undefined; onFocusChange?: ((newFocusPath: FocusPath, oldFocusPath: FocusPath, keypadHeight?: number | undefined, focusedElement?: HTMLElement | undefined) => unknown) | undef..."}},answerArea:{defaultValue:null,description:"",name:"answerArea",required:!1,type:{name:"any"}},contentPaths:{defaultValue:null,description:"",name:"contentPaths",required:!1,type:{name:"readonly string[]"}},developerMode:{defaultValue:{value:"false"},description:"",name:"developerMode",required:!1,type:{name:"boolean"}},frameSource:{defaultValue:null,description:"",name:"frameSource",required:!0,type:{name:"string"}},hints:{defaultValue:null,description:"",name:"hints",required:!1,type:{name:"readonly Hint[]"}},imageUploader:{defaultValue:null,description:"",name:"imageUploader",required:!1,type:{name:"ImageUploader"}},itemDataVersion:{defaultValue:null,description:"",name:"itemDataVersion",required:!1,type:{name:"Version"}},itemId:{defaultValue:null,description:"",name:"itemId",required:!0,type:{name:"string"}},jsonMode:{defaultValue:{value:"false"},description:"",name:"jsonMode",required:!1,type:{name:"boolean"}},onChange:{defaultValue:{value:"() => {}"},description:"",name:"onChange",required:!1,type:{name:"ChangeHandler"}},onPreviewDeviceChange:{defaultValue:null,description:"",name:"onPreviewDeviceChange",required:!0,type:{name:"(arg1: DeviceType) => unknown"}},previewDevice:{defaultValue:null,description:"",name:"previewDevice",required:!0,type:{name:"enum",value:[{value:'"phone"'},{value:'"tablet"'},{value:'"desktop"'}]}},question:{defaultValue:null,description:"",name:"question",required:!1,type:{name:"any"}},previewURL:{defaultValue:null,description:"",name:"previewURL",required:!0,type:{name:"string"}}}}}catch{}export{fi as A,xe as E,C as H,_e as I,yi as J,pi as a,Or as r};
