import{j as a}from"./jsx-runtime-63Ea5SlK.js";import{p as N}from"./util-_iDv4tVD.js";import{c as _,P as T,E as R}from"./article-renderer-h1Forr8s.js";import{_ as b}from"./jquery-yG1GhClm.js";import"./phet-simulation-0S6bHD0q.js";import"./version-akiLXZts.js";import"./dependencies-CP7Uh8Kq.js";import"./perseus-api-1-ethIrW.js";import"./perseus-item-jxaguxE5.js";import"./hints-renderer-yDZe1Iob.js";import"./renderer-ObNKC_M9.js";import"./base-radio-1n03M7NR.js";import{c as z}from"./components-u4x-g7WZ.js";import"./i18n-context-8x3SvuMF.js";import"./svg-image-BompcXcM.js";import{f as O}from"./index-J2t_5nK1.js";import"./index-smZ6iCr_.js";import{B as w}from"./index-d0xJ__lb.js";import{C as u,l as S}from"./index-FuKJM-dF.js";import{S as L}from"./index-bkG41yOS.js";import{s as m,c as k}from"./index-dmcq622U.js";import{H as j,e as q}from"./index-HGk1BWh5.js";import{l as d}from"./index-awljIyHI.js";import{r as x}from"./index-6oxdNXpR.js";import{F as B}from"./index-9gkyvru-.js";var D=function(t){return t===Object(t)},E=function(){for(var t={},e=0;e<arguments.length;e++){var s=arguments[e];if(s)for(var n in s)t[n]=s[n]}return t},f=function(t){return D(t)?Array.isArray(t)?t.slice():E(t):t},g=function(t){if(Array.isArray(t))return Y;if(D(t))return W;if(typeof t=="string")return P},l=function(t){if(t instanceof l)return t;if(!(this instanceof l))return new l(t);var e=g(t);this._wrapped=e.thaw?e.thaw(t):t};l.prototype.freeze=function(){var t=this._wrapped,e=g(t);return e.freeze?e.freeze(t):t};l.prototype.zoom=function(t){return this._zoomStack===void 0&&(this._zoomStack=[]),this._zoomStack.push({zoom:t,wrapped:this._wrapped}),this._wrapped=l(this._wrapped).get(t),this};l.prototype.deZoom=function(){var t=this._zoomStack.pop();return this._wrapped=l(t.wrapped).set(t.zoom,this._wrapped).freeze(),this};l.prototype.get=function(t){for(var e=this._wrapped,s=0;s<t.length;s++)e=g(e).get(e,t[s]);return e};l.prototype.mod=function(t,e){var s=this._wrapped,n=f(s),r=g(s);if(t.length===0)this._wrapped=e(this._wrapped);else if(t.length===1)this._wrapped=r.mod(n,t[0],e);else{var i=t[0],p=t.slice(1);n[i]=l(s[i]).mod(p,e).freeze(),this._wrapped=n}return this};l.prototype.merge=function(t,e){return this._wrapped=l(this._wrapped).mod(t,function(s){return E(s,e)}).freeze(),this};l.prototype.del=function(t){var e=this._wrapped,s=g(e);if(t.length===1)this._wrapped=s.del(e,t[0]);else{var n=t[0],r=t.slice(1),i=f(e);i[n]=l(e[n]).del(r).freeze(),this._wrapped=i}return this};l.prototype.set=function(t,e){return this.mod(t,function(){return e})};const Y={get:function(t,e){return t[e]},set:function(t,e,s){var n=t.splice();return n[e]=s,n},mod:function(t,e,s){var n=t.slice();return n[e]=s(t[e]),n},del:function(t,e){var s=t.slice();return s.splice(e,1),s}},W={get:function(t,e){return t[e]},set:function(t,e,s){var n=f(t);return n[e]=s,n},mod:function(t,e,s){var n=f(t);return n[e]=s(t[e]),n},del:function(t,e){var s=f(t);return delete s[e],s}},P={get:function(t,e){return t[e]},set:function(t,e,s){var n=t.splice();return n[e]=s,n},mod:function(t,e,s){var n=t.splice();return n[e]=s(t[e]),n},del:function(t,e){var s=t.slice();return s.splice(e),s}},A=class A extends x.Component{constructor(e){super(e),this.state={dragging:-1,components:this.props.components},this.onDrop=this.onDrop.bind(this),this.onDragStart=this.onDragStart.bind(this),this.onDragEnter=this.onDragEnter.bind(this)}componentDidMount(){this._setDragEvents()}UNSAFE_componentWillReceiveProps(e){this.setState({components:e.components})}componentDidUpdate(){this._setDragEvents()}onDragStart(e){this.setState({dragging:e})}onDrop(){this.setState({dragging:-1}),this.props.onReorder(this.state.components)}onDragEnter(e){if(this.state.dragging===e)return;const s=this.state.components.slice(),n=s.splice(this.state.dragging,1);s.splice(e,0,n[0]);const r=this.props.verify(s);return r&&this.setState({dragging:e,components:s}),r}_listenEvent(e){e.dataTransfer.setData("hackhackhack","because browsers!")}_cancelEvent(e){e.preventDefault()}_setDragEvents(){this._dragItems=this._dragItems||[];const e=B.findDOMNode(this).querySelectorAll("[draggable=true]"),s=[],n=[];for(let r=0;r<this._dragItems.length;r++){const i=this._dragItems[r];e.indexOf(i)<0&&s.push(i)}for(let r=0;r<e.length;r++){const i=e[r];this._dragItems.indexOf(i)<0&&n.push(i)}for(let r=0;r<n.length;r++){const i=n[r];i.addEventListener("dragstart",this._listenEvent),i.addEventListener("drop",this._cancelEvent)}for(let r=0;r<s.length;r++){const i=s[r];i.removeEventListener("dragstart",this._listenEvent),i.removeEventListener("drop",this._cancelEvent)}}render(){const e=this.state.components.map((s,n)=>a.jsx(U,{index:n,component:s,area:this,draggable:s.props.draggable,dragging:n===this.state.dragging},s.key));return a.jsx("ol",{className:this.props.className,style:this.props.style,children:e})}};A.defaultProps={verify:()=>!0};let v=A;class U extends x.Component{handleDragStart(e){e.nativeEvent.dataTransfer.effectAllowed="move",this.props.area.onDragStart(this.props.index)}handleDrop(){this.props.area.onDrop(this.props.index)}handleDragEnter(e){const s=this.props.area.onDragEnter(this.props.index);e.nativeEvent.dataTransfer.effectAllowed=s?"move":"none"}handleDragOver(e){e.preventDefault()}render(){let e="sortable-disabled";return this.props.dragging?e="sortable-dragging":this.props.draggable&&(e="sortable-enabled"),a.jsx("li",{draggable:this.props.draggable,className:[e,d.css(V.sortableListItem)].join(" "),onDragStart:this.handleDragStart,onDrop:this.handleDrop,onDragEnter:this.handleDragEnter,onDragOver:this.handleDragOver,children:this.props.component})}}const V=d.StyleSheet.create({sortableListItem:{margin:"5px 0"}});v.__docgenInfo={description:`TODO(LEMS-2667): 11/26/24, at the time of writing this comment
it has been identified that this file has been broken long before
the refactoring of createReactClass. Future implementation need
to determine how to fix this functionality or deprecate it.
*
Takes an array of components to sort.
As of 08/05/24, there are two sortable components
(one in perseus and one in perseus-editor).
As far as I can tell, this one is only used in ExpressionEditor.`,methods:[{name:"onDragStart",docblock:null,modifiers:[],params:[{name:"startIndex",optional:!1,type:null}],returns:null},{name:"onDrop",docblock:null,modifiers:[],params:[],returns:null},{name:"onDragEnter",docblock:null,modifiers:[],params:[{name:"enterIndex",optional:!1,type:null}],returns:null},{name:"_listenEvent",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:null}],returns:null},{name:"_cancelEvent",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:null}],returns:null},{name:"_setDragEvents",docblock:null,modifiers:[],params:[],returns:null}],displayName:"SortableArea",props:{className:{required:!1,tsType:{name:"string"},description:""},components:{required:!0,tsType:{name:"Array",elements:[{name:"ReactReactElement",raw:"React.ReactElement"}],raw:"React.ReactElement[]"},description:""},onReorder:{required:!0,tsType:{name:"signature",type:"function",raw:"(i: any[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"any"}],raw:"any[]"},name:"i"}],return:{name:"void"}}},description:""},style:{required:!1,tsType:{name:"any"},description:""},verify:{required:!1,tsType:{name:"signature",type:"function",raw:"(i: any) => boolean",signature:{arguments:[{type:{name:"any"},name:"i"}],return:{name:"boolean"}}},description:"",defaultValue:{value:"() => true",computed:!1}}}};const{InfoTip:h}=z,C=["basic","trig","prealgebra","logarithms","basic relations","advanced relations"],I=({key:t})=>Number.parseInt(t??""),$=t=>{const e=[];t.forEach(s=>{e[I(s)]=!0});for(let s=0;s<e.length;s++)if(!e[s])return s;return e.length},y=class y extends x.Component{constructor(e){super(e),this.change=(...s)=>_.apply(this,s),this.serialize=()=>{const s=["value","form","simplify","considered","key"],n=["answerForms","buttonSets","functions","times","visibleLabel","ariaLabel"],r=this.props.answerForms.map(i=>b(i).pick(s));return l(this.props).set(["answerForms"],r).mod([],i=>b(i).pick(n)).freeze()},this.getSaveWarnings=()=>{const s=[];return this.props.answerForms.length===0?s.push("No answers specified"):(this.props.answerForms.some(r=>r.considered==="correct")||s.push("No correct answer specified"),b(this.props.answerForms).each((r,i)=>{if(this.props.value==="")s.push(`Answer ${i+1} is empty`);else{const p=N(r.value,{functions:this.props.functions});p.parsed?r.simplify&&!p.expr.isSimplified()&&s.push(`${r.value} isn't simplified, but is required" +
                            " to be`):s.push(`Couldn't parse ${r.value}`)}})),s},this._newEmptyAnswerForm=()=>({considered:"correct",form:!1,key:$(this.props.answerForms),simplify:!1,value:""}),this.newAnswer=()=>{const s=this.props.answerForms.slice();s.push(this._newEmptyAnswerForm()),this.change({answerForms:s})},this.handleRemoveForm=s=>{const n=this.props.answerForms.slice();n.splice(s,1),this.change({answerForms:n})},this.handleReorder=s=>{const n=s.map(r=>{const i=b(r.props).pick("considered","form","simplify","value");return i.key=r.key,i});this.change({answerForms:n})},this.handleButtonSet=s=>{const r=C.filter(i=>this.props.buttonSets.includes(i)!==(i===s));this.props.onChange({buttonSets:r})},this.handleToggleDiv=()=>{let s,n;this.props.buttonSets.includes("basic+div")?(s="basic",n="basic+div"):(s="basic+div",n="basic");const r=this.props.buttonSets.filter(i=>i!==n).concat(s);this.change("buttonSets",r)},this.handleTexInsert=s=>{this.refs.expression.insert(s)},this.handleFunctions=s=>{this.setState({functionsInternal:s});const n={};n.functions=s.split(/[ ,]+/).filter(O),this.props.onChange(n)},this.changeExpressionWidget=(s,n)=>{const r={...this.props.answerForms[s],key:`${s}`,value:n.value};this.updateAnswerForm(s,r)},this.state={functionsInternal:this.props.functions.join(" ")}}updateAnswerForm(e,s){const n=l(this.props.answerForms).merge([e],s).freeze();this.change({answerForms:n})}changeSimplify(e,s){const n={...this.props.answerForms[e],key:`${e}`,simplify:s};this.updateAnswerForm(e,n)}changeForm(e,s){const n={...this.props.answerForms[e],form:s,key:`${e}`};this.updateAnswerForm(e,n)}changeConsidered(e,s){const n={...this.props.answerForms[e],key:`${e}`,considered:s};this.updateAnswerForm(e,n)}changeTimes(e){this.change({times:e})}render(){const e=this.props.answerForms.map(r=>{const i=I(r),p={times:this.props.times,functions:this.props.functions,buttonSets:this.props.buttonSets,buttonsVisible:"focused",value:r.value,onChange:c=>this.changeExpressionWidget(i,c),trackInteraction:()=>{},widgetId:this.props.widgetId+"-"+r.key,visibleLabel:this.props.visibleLabel,ariaLabel:this.props.ariaLabel};return a.jsx(M,{draggable:!0,considered:r.considered,expressionProps:p,form:r.form,simplify:r.simplify,onDelete:()=>this.handleRemoveForm(i),onChangeSimplify:c=>this.changeSimplify(i,c),onChangeForm:c=>this.changeForm(i,c),onChangeConsidered:c=>this.changeConsidered(i,c)},r.key)}),s=a.jsx(v,{components:e,onReorder:this.handleReorder}),n=C.map(r=>{const i=r==="basic",p=this.props.buttonSets.includes(r)||i;return a.jsx(u,{label:r,checked:p,disabled:i,onChange:()=>this.handleButtonSet(r)},r)});return n.unshift(a.jsx(u,{label:"show ÷ button",checked:this.props.buttonSets.includes("basic+div"),onChange:this.handleToggleDiv},"show ÷ button")),a.jsxs("div",{children:[a.jsx(j,{children:"Global Options"}),a.jsxs("div",{className:d.css(o.paddedY),children:[a.jsx(S,{label:"Visible label",value:this.props.visibleLabel||"",onChange:this.change("visibleLabel")}),a.jsx(h,{children:a.jsx("p",{children:"Optional visible text; strongly encouraged to help learners using dictation software, but can be omitted if the surrounding content provides enough context."})})]}),a.jsxs("div",{className:d.css(o.paddedY),children:[a.jsx(S,{label:"Aria label",value:this.props.ariaLabel||"",onChange:this.change("ariaLabel")}),a.jsx(h,{children:a.jsxs("p",{children:["Label text that's read by screen readers. Highly recommend adding a label here to ensure your exercise is accessible. For more information on writting accessible labels, please see"," ",a.jsx("a",{href:"https://www.w3.org/WAI/tips/designing/#ensure-that-form-elements-include-clearly-associated-labels",target:"_blank",rel:"noreferrer",children:"this article."})]})})]}),a.jsxs("div",{className:d.css(o.paddedY),children:[a.jsx(S,{label:"Function variables",value:this.state.functionsInternal,onChange:this.handleFunctions}),a.jsx(h,{children:a.jsx("p",{children:'Single-letter variables listed here will be interpreted as functions. This let us know that f(x) means "f of x" and not "f times x".'})})]}),a.jsxs("div",{className:d.css(o.paddedY),children:[a.jsx(u,{label:"Use × instead of ⋅ for multiplication",checked:this.props.times,onChange:r=>{this.changeTimes(r)}}),a.jsx(h,{children:a.jsx("p",{children:"For pre-algebra problems this option displays multiplication as \\times instead of \\cdot in both the rendered output and the acceptable formats examples."})})]}),a.jsxs("div",{className:d.css(o.paddedY),children:[a.jsx(q,{children:"Button Sets"}),n]}),a.jsx(j,{children:"Answers"}),a.jsx("p",{style:{margin:"4px 0"},children:"student responses area matched against these from top to bottom"}),s,a.jsx("div",{children:a.jsx(w,{size:"small",onClick:this.newAnswer,children:"Add new answer"})})]})}};y.widgetName="expression",y.defaultProps={answerForms:[],times:!1,buttonSets:["basic"],functions:["f","g","h"]};let F=y;const H=function(t,e){let s=t.indexOf(e);return s=(s+1)%t.length,t[s]};class M extends x.Component{constructor(){super(...arguments),this.state={deleteFocused:!1},this.change=(...e)=>_.apply(this,e),this.handleImSure=()=>{this.props.onDelete()},this.handleCancelDelete=()=>{this.setState({deleteFocused:!1})},this.handleDelete=()=>{this.setState({deleteFocused:!0})},this.toggleConsidered=()=>{const e=H(T,this.props.considered);this.props.onChangeConsidered(e)}}render(){const e=this.state.deleteFocused?a.jsxs(a.Fragment,{children:[a.jsx(w,{size:"small",onClick:this.handleImSure,color:"destructive",children:"I'm sure!"}),a.jsx(L,{size:m.small_12}),a.jsx(w,{size:"small",onClick:this.handleCancelDelete,light:!0,children:"Cancel"})]}):a.jsx(w,{size:"small",onClick:this.handleDelete,color:"destructive",light:!0,children:"Delete"}),s=d.css(o.answerStatus,this.props.considered==="wrong"&&o.answerStatusWrong,this.props.considered==="correct"&&o.answerStatusCorrect,this.props.considered==="ungraded"&&o.answerStatusUngraded);return a.jsxs("div",{className:d.css(o.answerOption),children:[a.jsx("div",{className:d.css(o.answerHandle)}),a.jsxs("div",{className:d.css(o.answerBody),children:[a.jsxs("div",{children:[a.jsx("button",{onClick:this.toggleConsidered,className:s,children:this.props.considered}),a.jsx("div",{children:a.jsx(R,{...this.props.expressionProps})})]}),a.jsxs("div",{className:d.css(o.paddedY,o.paddedX),children:[a.jsx(u,{label:"Answer expression must have the same form.",checked:this.props.form,onChange:this.props.onChangeForm}),a.jsx(h,{children:a.jsx("p",{children:"The student's answer must be in the same form. Commutativity and excess negative signs are ignored."})})]}),a.jsxs("div",{className:d.css(o.paddedY,o.paddedX),children:[a.jsx(u,{label:"Answer expression must be fully expanded and simplified.",checked:this.props.simplify,onChange:this.props.onChangeSimplify}),a.jsx(h,{children:a.jsx("p",{children:`The student's answer must be fully expanded and simplified. Answering this equation (x^2+2x+1) with this factored equation (x+1)^2 will render this response "Your answer is not fully expanded and simplified."`})})]}),a.jsx("div",{className:d.css(o.buttonRow,o.paddedY),children:e})]})]})}}const o=d.StyleSheet.create({paddedX:{paddingLeft:m.xSmall_8,paddingRight:m.xSmall_8},paddedY:{paddingTop:m.xxSmall_6,paddingBottom:m.xxSmall_6},answerOption:{border:"1px solid #ddd",borderRadius:"3px",display:"flex"},answerHandle:{background:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==) no-repeat 50% 50%",borderRight:"1px solid #ddd",cursor:"move",width:"20px",minWidth:"20px"},answerStatus:{border:"none",userSelect:"none",width:"100px",paddingTop:m.small_12,paddingBottom:m.small_12},answerStatusWrong:{backgroundColor:k.fadedRed16},answerStatusCorrect:{backgroundColor:k.fadedGreen16},answerStatusUngraded:{backgroundColor:k.fadedBlue16},answerBody:{},buttonRow:{display:"flex"}});F.__docgenInfo={description:"",methods:[{name:"change",docblock:null,modifiers:[],params:[{name:"...args",optional:!1,type:null}],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:null},{name:"getSaveWarnings",docblock:null,modifiers:[],params:[],returns:null},{name:"_newEmptyAnswerForm",docblock:null,modifiers:[],params:[],returns:null},{name:"newAnswer",docblock:null,modifiers:[],params:[],returns:null},{name:"handleRemoveForm",docblock:null,modifiers:[],params:[{name:"i",optional:!1,type:null}],returns:null},{name:"updateAnswerForm",docblock:null,modifiers:[],params:[{name:"i",optional:!1,type:{name:"number"}},{name:"props",optional:!1,type:{name:"ReadonlyArray[number]",raw:'PerseusExpressionWidgetOptions["answerForms"][number]',alias:"AnswerForm"}}],returns:null},{name:"handleReorder",docblock:null,modifiers:[],params:[{name:"components",optional:!1,type:null}],returns:null},{name:"handleButtonSet",docblock:null,modifiers:[],params:[{name:"changingName",optional:!1,type:null}],returns:null},{name:"handleToggleDiv",docblock:null,modifiers:[],params:[],returns:null},{name:"handleTexInsert",docblock:null,modifiers:[],params:[{name:"str",optional:!1,type:null}],returns:null},{name:"handleFunctions",docblock:null,modifiers:[],params:[{name:"value",optional:!1,type:null}],returns:null},{name:"changeSimplify",docblock:null,modifiers:[],params:[{name:"key",optional:!1,type:{name:"number"}},{name:"simplify",optional:!1,type:{name:"boolean"}}],returns:null},{name:"changeForm",docblock:null,modifiers:[],params:[{name:"key",optional:!1,type:{name:"number"}},{name:"form",optional:!1,type:{name:"boolean"}}],returns:null},{name:"changeConsidered",docblock:null,modifiers:[],params:[{name:"key",optional:!1,type:{name:"number"}},{name:"considered",optional:!1,type:{name:"unknown[number]",raw:"(typeof PerseusExpressionAnswerFormConsidered)[number]"}}],returns:null},{name:"changeTimes",docblock:null,modifiers:[],params:[{name:"times",optional:!1,type:{name:"boolean"}}],returns:null},{name:"changeExpressionWidget",docblock:null,modifiers:[],params:[{name:"key",optional:!1,type:null},{name:"props",optional:!1,type:null}],returns:null}],displayName:"ExpressionEditor",props:{widgetId:{required:!1,tsType:{name:"any"},description:""},value:{required:!1,tsType:{name:"string"},description:""},answerForms:{defaultValue:{value:"[]",computed:!1},required:!1},times:{defaultValue:{value:"false",computed:!1},required:!1},buttonSets:{defaultValue:{value:'["basic"]',computed:!1},required:!1},functions:{defaultValue:{value:'["f", "g", "h"]',computed:!1},required:!1}}};export{F as E};
