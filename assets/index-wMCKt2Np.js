import{y as Q,z}from"./random-util-9WQRKwFZ.js";import"./article-editor-Jek84Fct.js";import"./device-framer-C3twM9Ra.js";import"./viewport-resizer-gY54rvhr.js";import{P as t}from"./index-o42urCig.js";import{r as s}from"./index-6oxdNXpR.js";import{_ as c}from"./underscore-885MUNGo.js";import{w as B}from"./all-widgets-c03GGHcA.js";import"./phet-simulation-2fci0qCu.js";import{s as X,b as Y,r as Z,a as ee,c as te}from"./renderer-TsApkbFs.js";import"./perseus-api-Y55S7ZPk.js";import"./server-item-renderer-nVlsJ8cl.js";import"./article-renderer-o7ZiMdLE.js";import"./hints-renderer-W_ESOac6.js";import"./base-radio-JSYX41ej.js";import"./button-group-f5V3tSn8.js";import"./svg-image-JxxWp2z_.js";import"./hud-VpTa1tZ-.js";import"./icon-H34hvC3Q.js";import"./index-3j9EmwNK.js";import"./inline-icon-8e4u-lSW.js";import"./math-input-eAT_ndNA.js";import"./multi-button-group-7ejnk4_z.js";import"./number-input-numpZFNM.js";import"./range-input-oo-uLot_.js";import"./text-input-ebI7LPno.js";import"./text-list-editor-9dKImvgD.js";import"./dependencies-CP7Uh8Kq.js";import"./i18n-context-Q5gDzbF3.js";import"./util-ghoLYzZ7.js";import"./jquery-5v7aFUvu.js";import"./index-smZ6iCr_.js";import{T as se}from"./text-diff-T3W6Bt5f.js";import{c as re}from"./components-oONxWwgU.js";import{c as b}from"./index-dnMhQZ-1.js";import"./editor-page-Zn2L9O30.js";import"./editor-LQjaAc63.js";import{A as ne}from"./register-all-widgets-and-editors-for-testing-_WyBchpk.js";import"./content-preview-7bqhqq5I.js";/* empty css                       */const ae="@khanacademy/perseus-editor",ie="__lib_version__";Q(ae,ie);const P="unchanged",L="changed",U="added",W="removed",oe=function(o,e,r){let n;return o===e?n=P:o===void 0?n=U:e===void 0?n=W:n=L,{after:JSON.stringify(e),before:JSON.stringify(o),children:[],key:r,status:n}},de=function(o,e,r){const n=c.isObject(o)?c(o).keys():[],a=c.isObject(e)?c(e).keys():[],i=c.union(n,a),p=c.map(i,function(l){return $((o||{})[l],(e||{})[l],l)});let d;return o===void 0?d=U:e===void 0?d=W:d=c.any(p,function(u){return u.status!==P})?L:P,{after:"",before:"",children:p,key:r,status:d}},$=function(o,e,r){return typeof o=="object"||typeof e=="object"?de(o,e,r):oe(o,e,r)},{SvgImage:D}=re,J=function(o){return(o-1)*20},E="before",q="after",pe="unchanged",j=class j extends s.Component{render(){const e=b(this.props.className,{"diff-row":!0,before:this.props.side===E,after:this.props.side===q});return s.createElement("div",{className:e},s.createElement("div",{style:{paddingLeft:J(this.props.depth)}},this.props.showKey&&this.props.propKey+": ",s.createElement("span",{className:"inner-value dark "+this.props.className},this.props.value)))}};j.propTypes={className:t.string.isRequired,depth:t.number.isRequired,propKey:t.string.isRequired,showKey:t.bool.isRequired,side:t.oneOf([E,q]).isRequired,value:t.string};let k=j;const N=class N extends s.Component{render(){const e=this;return s.createElement("div",{onClick:e.props.onClick,style:{clear:"both"}},c.map([E,q],function(r){return s.createElement("div",{className:"diff-row collapsed "+r,key:r},s.createElement("div",{style:{paddingLeft:J(e.props.depth)}},s.createElement("span",null," [ show unmodified ] ")))}))}};N.propTypes={depth:t.number,onClick:t.func.isRequired},N.defaultProps={depth:0};let R=N;const y=class y extends s.Component{constructor(){super(...arguments),this.state={expanded:this.props.expanded},this.expand=()=>{this.setState({expanded:!0})}}render(){const e=this.props.entry,r=e.status==="removed",n=e.status==="added",a=e.status==="changed",i=e.children.length>0,p=b({removed:r||a&&!i,dark:r,"blank-space":n}),d=b({added:n||a&&!i,dark:n,"blank-space":r});let l;this.state.expanded?l=e.children:l=c(e.children).select(function(m){return m.status!==pe});let u=l.length<e.children.length;e.children.length===l.length+1&&(l=e.children,u=!1);const f=this;return s.createElement("div",null,e.key&&s.createElement("div",{style:{clear:"both"}},s.createElement(k,{side:E,className:p,depth:this.props.depth,propKey:e.key,showKey:!n,value:e.before}),s.createElement(k,{side:q,className:d,depth:this.props.depth,propKey:e.key,showKey:!r,value:e.after})),c.map(l,function(m){return s.createElement(y,{key:m.key,depth:f.props.depth+1,entry:m,expanded:f.state.expanded})}),u&&s.createElement(R,{depth:this.props.depth+1,onClick:this.expand}))}};y.propTypes={depth:t.number,entry:t.shape({after:t.string,before:t.string,children:t.arrayOf(t.any),key:t.string}),expanded:t.bool},y.defaultProps={depth:0};let x=y;const S=class S extends s.Component{render(){const{before:e,after:r}=this.props,n=e.options&&e.options.backgroundImage?e.options.backgroundImage.url:"",a=r.options&&r.options.backgroundImage?r.options.backgroundImage.url:"";return s.createElement("div",null,s.createElement("div",{className:"diff-row before"},n&&s.createElement("div",{className:b({image:!0,"image-unchanged":n===a,"image-removed":n!==a})},s.createElement(D,{src:n,title:n}))),s.createElement("div",{className:"diff-row after"},a&&s.createElement("div",{className:b({image:!0,"image-unchanged":n===a,"image-added":n!==a})},s.createElement(D,{src:a,title:a}))))}};S.propTypes={after:t.shape({options:t.objectOf(t.any)}).isRequired,before:t.shape({options:t.objectOf(t.any)}).isRequired};let A=S;const O=class O extends s.Component{render(){const{after:e,before:r,title:n,type:a}=this.props,i=$(r,e);return s.createElement("div",null,s.createElement("div",{className:"diff-header"},n),s.createElement("div",{className:"diff-header"},n),s.createElement("div",{className:"diff-body ui-helper-clearfix"},a==="image"&&s.createElement(A,{before:r,after:e}),s.createElement(x,{entry:i})))}};O.propTypes={after:t.shape({options:t.objectOf(t.any)}),before:t.shape({options:t.objectOf(t.any)}),title:t.string.isRequired,type:t.string},O.defaultProps={after:{},before:{},type:""};let v=O;v.__docgenInfo={description:"",methods:[],displayName:"WidgetDiff",props:{after:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"shape",value:{options:{name:"objectOf",value:{name:"any"},required:!1}}},required:!1},before:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"shape",value:{options:{name:"objectOf",value:{name:"any"},required:!1}}},required:!1},type:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1},title:{description:"",type:{name:"string"},required:!0}}};const G=function(o,e){const{alignment:r,graded:n,options:a,type:i}=o||{},p={options:a};return e&&z(i).length>1&&(p.alignment=r),i==="transformer"&&(p.graded=n),X(i)&&(p.static=(o==null?void 0:o.static)??void 0),p},K=class K extends s.Component{render(){const{after:e,before:r,showAlignmentOptions:n,showSeparator:a,title:i}=this.props;let p,d;(r.content||e.content)&&(p=s.createElement(se,{before:r.content,after:e.content,title:i}));const l=Object.keys(r.widgets??{}).filter(f=>r.content.includes(f)),u=Object.keys(e.widgets??{}).filter(f=>e.content.includes(f));return(l.length||u.length)&&(d=c.union(l,u).map(m=>{var F,H,M,_;return s.createElement(v,{before:G((F=r.widgets)==null?void 0:F[m],n),after:G((H=e.widgets)==null?void 0:H[m],n),title:m,type:(((M=r.widgets)==null?void 0:M[m])??{}).type||(((_=e.widgets)==null?void 0:_[m])??{}).type,key:m})})),s.createElement("div",null,p,d,a&&s.createElement("div",{className:"diff-separator"}))}};K.defaultProps={after:{content:"",images:{},widgets:{}},before:{content:"",images:{},widgets:{}},showAlignmentOptions:!1,showSeparator:!1};let g=K;g.__docgenInfo={description:"",methods:[],displayName:"RendererDiff",props:{after:{required:!1,tsType:{name:"signature",type:"object",raw:`{
    content: string;
    // NOTE: images and widgets may not be set for some items hints,
    // specifically in old revisions, which may only be loaded for diffing.
    widgets: PerseusRenderer["widgets"] | null | undefined;
    images: PerseusRenderer["images"] | null | undefined;
}`,signature:{properties:[{key:"content",value:{name:"string",required:!0}},{key:"widgets",value:{name:"union",raw:'PerseusRenderer["widgets"] | null | undefined',elements:[{name:"signature",raw:'PerseusRenderer["widgets"]'},{name:"null"},{name:"undefined"}],required:!0}},{key:"images",value:{name:"union",raw:'PerseusRenderer["images"] | null | undefined',elements:[{name:"signature",raw:'PerseusRenderer["images"]'},{name:"null"},{name:"undefined"}],required:!0}}]}},description:"",defaultValue:{value:`{
    content: "",
    images: {},
    widgets: {},
}`,computed:!1}},before:{required:!1,tsType:{name:"signature",type:"object",raw:`{
    content: string;
    // NOTE: images and widgets may not be set for some items hints,
    // specifically in old revisions, which may only be loaded for diffing.
    widgets: PerseusRenderer["widgets"] | null | undefined;
    images: PerseusRenderer["images"] | null | undefined;
}`,signature:{properties:[{key:"content",value:{name:"string",required:!0}},{key:"widgets",value:{name:"union",raw:'PerseusRenderer["widgets"] | null | undefined',elements:[{name:"signature",raw:'PerseusRenderer["widgets"]'},{name:"null"},{name:"undefined"}],required:!0}},{key:"images",value:{name:"union",raw:'PerseusRenderer["images"] | null | undefined',elements:[{name:"signature",raw:'PerseusRenderer["images"]'},{name:"null"},{name:"undefined"}],required:!0}}]}},description:"",defaultValue:{value:`{
    content: "",
    images: {},
    widgets: {},
}`,computed:!1}},showAlignmentOptions:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},showSeparator:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},title:{required:!0,tsType:{name:"string"},description:""}}};const w=t.shape({content:t.string,images:t.objectOf(t.any),widgets:t.objectOf(t.any)}),h=class h extends s.Component{constructor(){super(...arguments),this.state=h._stateFromProps(this.props)}UNSAFE_componentWillReceiveProps(e){this.setState(h._stateFromProps(e))}render(){const{before:e,after:r}=this.state,n=Math.max(e.length,r.length),a=c.times(n,i=>s.createElement(g,{before:i<e.length?e[i]:void 0,after:i<r.length?r[i]:void 0,title:`Section ${i+1}`,showAlignmentOptions:!0,showSeparator:i<n-1,key:i}));return s.createElement("div",{className:"framework-perseus"},a)}};h.propTypes={after:t.oneOfType([w,t.arrayOf(w)]).isRequired,before:t.oneOfType([w,t.arrayOf(w)]).isRequired},h._stateFromProps=e=>{const{before:r,after:n}=e;return{before:Array.isArray(r)?r:[r],after:Array.isArray(n)?n:[n]}};let T=h;T.__docgenInfo={description:"",methods:[{name:"_stateFromProps",docblock:null,modifiers:["static"],params:[{name:"props",optional:!1,type:null}],returns:null}],displayName:"ArticleDiff",props:{after:{description:"",type:{name:"union",value:[{name:"custom",raw:"rendererProps"},{name:"arrayOf",value:{name:"custom",raw:"rendererProps"}}]},required:!0},before:{description:"",type:{name:"union",value:[{name:"custom",raw:"rendererProps"},{name:"arrayOf",value:{name:"custom",raw:"rendererProps"}}]},required:!0}}};const I=t.shape({question:t.shape({}).isRequired,answerArea:t.shape({}).isRequired,hints:t.arrayOf(t.any).isRequired}),V=class V extends s.Component{render(){const{before:e,after:r}=this.props,n=Math.max(e.hints.length,r.hints.length),a=s.createElement(g,{before:e.question,after:r.question,title:"Question",showAlignmentOptions:!1,showSeparator:!0}),i=s.createElement(v,{before:e.answerArea,after:r.answerArea,title:"Question extras"}),p=c.times(n,function(d){return s.createElement(g,{before:d<e.hints.length?e.hints[d]:void 0,after:d<r.hints.length?r.hints[d]:void 0,title:`Hint ${d+1}`,showAlignmentOptions:!1,showSeparator:d<n-1,key:d})});return s.createElement("div",{className:"framework-perseus"},a,i,p&&s.createElement("div",{className:"diff-separator"}),p)}};V.propTypes={after:I.isRequired,before:I.isRequired};let C=V;C.__docgenInfo={description:"",methods:[],displayName:"ItemDiff",props:{after:{description:"",type:{name:"custom",raw:"itemProps.isRequired"},required:!1},before:{description:"",type:{name:"custom",raw:"itemProps.isRequired"},required:!1}}};Y(ne);Z(B);ee();te();
