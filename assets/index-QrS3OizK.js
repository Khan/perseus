import{r as n}from"./index-4g5l5LRQ.js";import{V as c,I as $}from"./index-e4P84RkC.js";import{m as N,c as A,u as _,a as O,T as R}from"./index-skotlSua.js";import{c as g,b as H,s as d}from"./index-lUErx3pE.js";import{l as x}from"./index-awljIyHI.js";import{H as U,a as z}from"./index-1f9rdEBk.js";import{r as y}from"./index-jmm5gWkb.js";import{w as V}from"./index-FsYHUvK_.js";import{x as W}from"./x-6ZxseNgc.js";import{I as Y}from"./index-ApTSwHdG.js";import{M as j}from"./index-wjVcXLkf.js";function C(){return C=Object.assign?Object.assign.bind():function(o){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(o[s]=t[s])}return o},C.apply(this,arguments)}const F={color:{bg:{inverse:g.darkBlue},text:{inverse:g.white,secondary:g.offBlack64},shadow:{default:g.offBlack16}},border:{radius:H.radius.medium_4},spacing:{dialog:{small:d.medium_16},panel:{closeButton:d.medium_16,footer:d.xLarge_32},header:{xsmall:d.xSmall_8,small:d.medium_16,medium:d.large_24,large:d.xLarge_32}}},K=N(F,{color:{bg:{inverse:g.eggplant}}}),G={default:F,khanmigo:K},w=A(F);function q(o){const e=n.useContext(R),t=G[e]||F;return n.createElement(w.Provider,{value:t},o.children)}const J=n.forwardRef(function(e,t){const{above:s,below:l,role:r="dialog",style:p,children:h,testId:i,"aria-labelledby":b,"aria-describedby":u}=e,{theme:M}=_(w),m=O(X,M);return n.createElement(c,{style:[m.wrapper,p]},l&&n.createElement(c,{style:m.below},l),n.createElement(c,{role:r,"aria-modal":"true","aria-labelledby":b,"aria-describedby":u,ref:t,style:m.dialog,testId:i},h),s&&n.createElement(c,{style:m.above},s))}),P=n.forwardRef(function(e,t){return n.createElement(q,null,n.createElement(J,C({},e,{ref:t})))}),Q="@media (max-width: 767px)",X=o=>({wrapper:{display:"flex",flexDirection:"row",alignItems:"stretch",width:"100%",height:"100%",position:"relative",[Q]:{padding:o.spacing.dialog.small,flexDirection:"column"}},dialog:{width:"100%",height:"100%",borderRadius:o.border.radius,overflow:"hidden"},above:{pointerEvents:"none",position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:1},below:{pointerEvents:"none",position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:-1}});P.displayName="ModalDialog";function I({children:o}){return n.createElement(c,{style:Z.footer},o)}I.__IS_MODAL_FOOTER__=!0;I.isComponentOf=o=>o&&o.type&&o.type.__IS_MODAL_FOOTER__;const Z=x.StyleSheet.create({footer:{flex:"0 0 auto",boxSizing:"border-box",minHeight:d.xxxLarge_64,paddingLeft:d.medium_16,paddingRight:d.medium_16,paddingTop:d.xSmall_8,paddingBottom:d.xSmall_8,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",boxShadow:`0px -1px 0px ${g.offBlack16}`}});function v(o){const{breadcrumbs:e=void 0,light:t,subtitle:s=void 0,testId:l,title:r,titleId:p}=o;if(s&&e)throw new Error("'subtitle' and 'breadcrumbs' can't be used together");const{theme:h}=_(w),i=O(ee,h);return n.createElement(c,{style:[i.header,!t&&i.dark],testId:l},e&&n.createElement(c,{style:i.breadcrumbs},e),n.createElement(U,{style:i.title,id:p,testId:l&&`${l}-title`},r),s&&n.createElement(z,{style:t&&i.subtitle,testId:l&&`${l}-subtitle`},s))}const T="@media (max-width: 767px)",ee=o=>({header:{boxShadow:`0px 1px 0px ${o.color.shadow.default}`,display:"flex",flexDirection:"column",minHeight:66,padding:`${o.spacing.header.medium}px ${o.spacing.header.large}px`,position:"relative",width:"100%",[T]:{paddingLeft:o.spacing.header.small,paddingRight:o.spacing.header.small}},dark:{background:o.color.bg.inverse,color:o.color.text.inverse},breadcrumbs:{color:o.color.text.secondary,marginBottom:o.spacing.header.xsmall},title:{paddingRight:o.spacing.header.small,[T]:{paddingRight:o.spacing.header.large}},subtitle:{color:o.color.text.secondary,marginTop:o.spacing.header.xsmall}});v.defaultProps={light:!0};const te='button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])';class oe extends n.Component{constructor(...e){super(...e),this.modalRoot=void 0,this.getModalRoot=t=>{if(!t)return;const s=y.findDOMNode(t);if(!s)throw new Error("Assertion error: modal root should exist after mount");this.modalRoot=s},this.handleFocusMoveToLast=()=>{this.focusElementIn(!1)},this.handleFocusMoveToFirst=()=>{this.focusElementIn(!0)}}tryToFocus(e){if(e instanceof HTMLElement){try{e.focus()}catch{}return document.activeElement===e}}focusElementIn(e){const t=this.modalRoot,s=Array.from(t.querySelectorAll(te)),l=e?0:s.length-1,r=s[l];this.tryToFocus(r)}render(){const{style:e}=this.props;return n.createElement(n.Fragment,null,n.createElement("div",{tabIndex:0,className:"modal-focus-trap-first",onFocus:this.handleFocusMoveToLast,style:{position:"fixed"}}),n.createElement(c,{style:e,ref:this.getModalRoot},this.props.children),n.createElement("div",{tabIndex:0,className:"modal-focus-trap-last",onFocus:this.handleFocusMoveToFirst,style:{position:"fixed"}}))}}const k="data-modal-launcher-portal",ne='a[href], details, input, textarea, select, button:not([aria-label^="Close"])';function se(o){return Array.from(o.querySelectorAll(ne))}class le extends n.Component{constructor(...e){super(...e),this._mousePressedOutside=!1,this.handleMouseDown=t=>{this._mousePressedOutside=t.target===t.currentTarget},this.handleMouseUp=t=>{t.target===t.currentTarget&&this._mousePressedOutside&&this.props.onCloseModal(),this._mousePressedOutside=!1}}componentDidMount(){const e=y.findDOMNode(this);if(!e)return;const t=this._getInitialFocusElement(e)||this._getFirstFocusableElement(e)||this._getDialogElement(e);setTimeout(()=>{t.focus()},0)}_getInitialFocusElement(e){const{initialFocusId:t}=this.props;return t?y.findDOMNode(e.querySelector(`#${t}`)):null}_getFirstFocusableElement(e){const t=se(e);return t?t[0]:null}_getDialogElement(e){const t=y.findDOMNode(e.querySelector('[role="dialog"]'));return t.tabIndex=-1,t}render(){const{children:e,testId:t}=this.props,s={[k]:!0};return n.createElement(c,C({style:re.modalPositioner,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,testId:t},s),e)}}const re=x.StyleSheet.create({modalPositioner:{position:"fixed",left:0,top:0,width:"100%",height:"100%",alignItems:"center",justifyContent:"center",overflow:"auto",background:g.offBlack64}}),S=(()=>{if(typeof window>"u")return!1;const o=window.navigator.userAgent;return o.indexOf("iPad")>-1||o.indexOf("iPhone")>-1})();class a extends n.Component{componentDidMount(){if(a.numModalsOpened===0){const e=document.body;if(!e)throw new Error("couldn't find document.body");a.oldOverflow=e.style.overflow,a.oldScrollY=window.scrollY,S&&(a.oldPosition=e.style.position,a.oldWidth=e.style.width,a.oldTop=e.style.top),e.style.overflow="hidden",S&&(e.style.position="fixed",e.style.width="100%",e.style.top=`${-a.oldScrollY}px`)}a.numModalsOpened++}componentWillUnmount(){if(a.numModalsOpened--,a.numModalsOpened===0){const e=document.body;if(!e)throw new Error("couldn't find document.body");e.style.overflow=a.oldOverflow,S&&(e.style.position=a.oldPosition,e.style.width=a.oldWidth,e.style.top=a.oldTop),typeof window<"u"&&window.scrollTo&&window.scrollTo(0,a.oldScrollY)}}render(){return null}}a.oldOverflow=void 0;a.oldPosition=void 0;a.oldScrollY=void 0;a.oldWidth=void 0;a.oldTop=void 0;a.numModalsOpened=0;const ae={closeModal:void 0},L=n.createContext(ae);L.displayName="ModalContext";class B extends n.Component{constructor(...e){super(...e),this.lastElementFocusedOutsideModal=void 0,this.state={opened:!1},this._saveLastElementFocused=()=>{this.lastElementFocusedOutsideModal=document.activeElement},this._openModal=()=>{this._saveLastElementFocused(),this.setState({opened:!0})},this._returnFocus=()=>{const{closedFocusId:t,schedule:s}=this.props,l=this.lastElementFocusedOutsideModal;if(t){const r=y.findDOMNode(document.getElementById(t));if(r){s.animationFrame(()=>{r.focus()});return}}l!=null&&s.animationFrame(()=>{l.focus()})},this.handleCloseModal=()=>{this.setState({opened:!1},()=>{const{onClose:t}=this.props;t==null||t(),this._returnFocus()})}}static getDerivedStateFromProps(e,t){return typeof e.opened=="boolean"&&e.children&&console.warn("'children' and 'opened' can't be used together"),typeof e.opened=="boolean"&&!e.onClose&&console.warn("'onClose' should be used with 'opened'"),typeof e.opened!="boolean"&&!e.children&&console.warn("either 'children' or 'opened' must be set"),{opened:typeof e.opened=="boolean"?e.opened:t.opened}}componentDidUpdate(e){!e.opened&&this.props.opened&&this._saveLastElementFocused()}_renderModal(){return typeof this.props.modal=="function"?this.props.modal({closeModal:this.handleCloseModal}):this.props.modal}render(){const e=this.props.children?this.props.children({openModal:this._openModal}):null,{body:t}=document;return t?n.createElement(L.Provider,{value:{closeModal:this.handleCloseModal}},e,this.state.opened&&y.createPortal(n.createElement(oe,{style:de.container},n.createElement(le,{initialFocusId:this.props.initialFocusId,testId:this.props.testId,onCloseModal:this.props.backdropDismissEnabled?this.handleCloseModal:()=>{}},this._renderModal())),t),this.state.opened&&n.createElement(ie,{onClose:this.handleCloseModal}),this.state.opened&&n.createElement(a,null)):null}}B.defaultProps={backdropDismissEnabled:!0};class ie extends n.Component{constructor(...e){super(...e),this._handleKeyup=t=>{t.key==="Escape"&&(t.preventDefault(),t.stopPropagation(),this.props.onClose())}}componentDidMount(){window.addEventListener("keyup",this._handleKeyup)}componentWillUnmount(){window.removeEventListener("keyup",this._handleKeyup)}render(){return null}}const de=x.StyleSheet.create({container:{zIndex:1080}});V(B);function E(o){const{scrollOverflow:e,style:t,children:s}=o,{theme:l}=_(w),r=O(ue,l);return n.createElement(c,{style:[r.wrapper,e&&r.scrollOverflow]},n.createElement(c,{style:[r.content,t]},s))}E.__IS_MODAL_CONTENT__=!0;E.isComponentOf=o=>o&&o.type&&o.type.__IS_MODAL_CONTENT__;const ce="@media (max-width: 767px)",ue=o=>({wrapper:{flex:1,display:"block"},scrollOverflow:{overflow:"auto"},content:{flex:1,minHeight:"100%",padding:d.xLarge_32,boxSizing:"border-box",[ce]:{padding:`${d.xLarge_32}px ${d.medium_16}px`}}});E.defaultProps={scrollOverflow:!0};class me extends n.Component{render(){const{light:e,onClick:t,style:s,testId:l}=this.props;return n.createElement(L.Consumer,null,({closeModal:r})=>{if(r&&t)throw new Error("You've specified 'onClose' on a modal when using ModalLauncher.  Please specify 'onClose' on the ModalLauncher instead");return n.createElement(Y,{icon:W,"aria-label":"Close modal",onClick:t||r,kind:e?"primary":"tertiary",light:e,style:s,testId:l})})}}function D({closeButtonVisible:o=!0,scrollOverflow:e=!0,light:t=!0,content:s,footer:l,header:r,onClose:p,style:h,testId:i}){const{theme:b}=_(w),u=O(pe,b),m=n.useCallback(()=>{const f=E.isComponentOf(s)?s:n.createElement(E,null,s);return f&&n.cloneElement(f,{scrollOverflow:e,style:[!!l&&u.hasFooter,f.props.style]})},[s,l,e,u.hasFooter])();return n.createElement(c,{style:[u.wrapper,!t&&u.dark,h],testId:i&&`${i}-panel`},o&&n.createElement(me,{light:!t,onClick:p,style:u.closeButton,testId:i&&`${i}-close`}),r,m,!l||I.isComponentOf(l)?l:n.createElement(I,null,l))}D.defaultProps={closeButtonVisible:!0,scrollOverflow:!0,light:!0};const pe=o=>({wrapper:{flex:"1 1 auto",position:"relative",display:"flex",flexDirection:"column",background:"white",boxSizing:"border-box",overflow:"hidden",height:"100%",width:"100%"},closeButton:{position:"absolute",right:o.spacing.panel.closeButton,top:o.spacing.panel.closeButton,zIndex:1},dark:{background:o.color.bg.inverse,color:o.color.text.inverse},hasFooter:{paddingBottom:o.spacing.panel.footer}});class he extends n.Component{renderHeader(e){const{title:t,breadcrumbs:s=void 0,subtitle:l=void 0,testId:r}=this.props;return s?n.createElement(v,{title:t,breadcrumbs:s,titleId:e,testId:r&&`${r}-header`}):l?n.createElement(v,{title:t,subtitle:l,titleId:e,testId:r&&`${r}-header`}):n.createElement(v,{title:t,titleId:e,testId:r&&`${r}-header`})}render(){const{onClose:e,footer:t,content:s,above:l,below:r,style:p,closeButtonVisible:h,testId:i,titleId:b,role:u,"aria-describedby":M}=this.props;return n.createElement(j,{styleSheets:fe},({styles:m})=>n.createElement($,{id:b,scope:"modal"},f=>n.createElement(P,{style:[m.dialog,p],above:l,below:r,testId:i,"aria-labelledby":f,"aria-describedby":M,role:u},n.createElement(D,{onClose:e,header:this.renderHeader(f),content:s,footer:t,closeButtonVisible:h,testId:i}))))}}he.defaultProps={closeButtonVisible:!0};const fe={small:x.StyleSheet.create({dialog:{width:"100%",height:"100%",overflow:"hidden"}}),mdOrLarger:x.StyleSheet.create({dialog:{width:"93.75%",maxWidth:576,height:"81.25%",maxHeight:624}})};function ge(o){let e=o&&o.parentElement;for(;e&&!e.hasAttribute(k);)e=e.parentElement;return e}function Fe(o){return ge(o)}export{Fe as m};
