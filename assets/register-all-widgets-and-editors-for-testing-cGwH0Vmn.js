import{a as ys}from"./version-akiLXZts.js";import{j as s,a as r}from"./jsx-runtime-BGVbfQ2Z.js";import{W as vs,G as ws,d as Cs,M as bs,f as _s,p as Ns,T as xs,w as Ss}from"./article-renderer--KH_3v4J.js";import{_ as p}from"./index-default-4_ZsnO94.js";import{U as qe,d as Is}from"./util-WvQWLN3r.js";import{l as x,c as m,p as y,a as Ts}from"./unit-uxf7imOh.js";import{L as Qt,P as Pt,E as st}from"./perseus-error-OpXxk17X.js";import{A as P,C as Ps}from"./perseus-api-BF68z3pH.js";import{g as ks,e as As,d as Ms}from"./multi-renderer-NT6zOGLa.js";import"./hints-renderer-jsnGH-_R.js";import{S as Es,P as Zt,j as es,r as ts,a as ss,k as is}from"./renderer-XjSBFQ_v.js";import"./base-radio-Z6KRSDzq.js";import{c as v}from"./components-QK6ckRHM.js";import{I as Ie}from"./icon-paths-AuJwhOz7.js";import{g as rs}from"./dependencies-fnqF3NiV.js";import{$ as Os}from"./jquery-5v7aFUvu.js";import"./i18n-context-9-s9cJ--.js";import{r as c}from"./index-qhcEwEpg.js";import{D as ft}from"./device-framer-hjaos9ur.js";import{c as yt}from"./prop-check-box-G44u0RiB.js";import{S as Pe}from"./section-control-button-ILgPpYGF.js";import{E as b}from"./editor-x3-OPwz0.js";import"./button-group-eBTrRsKy.js";import"./graph-spgxk4r3.js";import{b as Ls}from"./svg-image-PvNqklxy.js";import"./hud-Q7Km3N9P.js";import"./icon-HbAIhp4d.js";import"./info-tip-7OZQMH1X.js";import"./inline-icon-MJBS_-2U.js";import"./math-input-LoGoPcYm.js";import"./multi-button-group-rHU9dGVb.js";import"./number-input-QmtkIb5a.js";import"./range-input-IMzA4hKn.js";import"./text-input-jOclSjX3.js";import"./text-list-editor-bJphcq85.js";import{V as Rs}from"./viewport-resizer-Kfo0kA7x.js";import{P as l}from"./index-tvtfaFq4.js";import{R as it,W as Vs}from"./structured-item-diff-qg8lEyBm.js";import{I as qs}from"./item-extras-editor-xlSw664E.js";import{M as Us}from"./multi-items-UMIT4iGF.js";import{l as d}from"./index-awljIyHI.js";import{R as Re}from"./index-E09jvG0x.js";/* empty css                       */import{C as zs}from"./categorizer-editor-kule4Yhj.js";import{E as w}from"./editor-jsonify-q8hSKygW.js";import{B as S}from"./blur-input-0MWX_AIX.js";import{D as Ds}from"./definition-editor-USFHIZWZ.js";import{D as Fs}from"./dropdown-editor-5_vBWYW3.js";import{E as Hs}from"./explanation-editor-zqkfGHpV.js";import{E as Ws}from"./expression-editor-wdpSS993.js";import{G as js}from"./graph-settings-HQQdnqr3.js";import{I as $s}from"./image-editor-wboc-B7a.js";import{I as Bs}from"./input-number-editor-ywvcE7wf.js";import{I as Gs}from"./interaction-editor-vLyONQh4.js";import{I as Ks}from"./flags-for-api-options-My1vxnSl.js";import{L as Js}from"./label-image-editor-osAo7gyi.js";import{M as Ys}from"./matcher-editor-6eu_DxMR.js";import{N as Xs}from"./number-line-editor-5HViDsij.js";import{N as Qs}from"./numeric-input-editor-pe-O3mF4.js";import{P as Zs}from"./python-program-editor-ZyIFB8_w.js";import{R as ei}from"./editor-3_xEKsBA.js";import{S as ti}from"./sorter-editor-Amdi3AYP.js";import{u as rt,E as si,M as ii,c as ri,V as ni}from"./compare-VLxlEkSV.js";const ai="@khanacademy/perseus-editor",oi="__lib_version__";ys(ai,oi);const vt=yt({displayName:"JsonEditor",getInitialState:function(){return{currentValue:JSON.stringify(this.props.value,null,4),valid:!0}},UNSAFE_componentWillReceiveProps:function(n){(!this.state.valid||!p.isEqual(n.value,JSON.parse(this.state.currentValue)))&&this.setState(this.getInitialState())},render:function(){const n="perseus-json-editor "+(this.state.valid?"valid":"invalid");return s("textarea",{className:n,value:this.state.currentValue,onChange:this.handleChange,onKeyDown:this.handleKeyDown,onBlur:this.handleBlur})},handleKeyDown:function(n){if(n.key==="Tab"){const e=n.target.selectionStart,t=n.target.value,i=t.substring(0,e),a=t.substring(e,t.length);n.target.value=i+"    "+a,n.target.selectionStart=i.length+4,n.target.selectionEnd=i.length+4,n.preventDefault(),this.handleChange(n)}},handleChange:function(n){const e=n.target.value;try{let t=JSON.parse(e);p.isString(t)&&(t=JSON.parse(t)),this.setState({currentValue:e,valid:!0},function(){this.props.onChange(t)})}catch{this.setState({currentValue:e,valid:!1})}},handleBlur:function(n){const e=n.target.value;try{let t=JSON.parse(e);p.isString(t)&&(t=JSON.parse(t)),this.setState({currentValue:JSON.stringify(t,null,4),valid:!0},function(){this.props.onChange(t)})}catch{this.setState({currentValue:JSON.stringify(this.props.value,null,4),valid:!0})}}});let kt=0;const nt={},at={};window.iframeDataStore={};window.addEventListener("message",n=>{if(typeof n.data=="string"){const e=nt[n.data];e&&e()}else n.data.id&&(n.data.height!==void 0?at[n.data.id](n.data.height):n.data.lintWarnings&&Qt.log("LINTER REPORT",{lintWarnings:JSON.stringify(n.data.lintWarnings)}))});class te extends c.Component{constructor(){super(...arguments),this.container=c.createRef()}componentDidMount(){this._isMounted=!0,this.iframeID=kt,kt++,this._prepareFrame(),nt[this.iframeID]=()=>{this.sendNewData(this._lastData)},at[this.iframeID]=e=>{this._lastHeight=e,this._isMounted&&this.props.seamless&&this.container.current&&(this.container.current.style.height=e+"px")}}shouldComponentUpdate(e){return e.datasetValue!==this.props.datasetValue||e.seamless!==this.props.seamless}componentDidUpdate(e){this.container.current&&(this.props.seamless?this.container.current.style.height=this._lastHeight+"px":this.container.current.style.height="100%"),e.datasetValue!==this.props.datasetValue&&this._prepareFrame()}componentWillUnmount(){nt[this.iframeID]=null,at[this.iframeID]=null,this._isMounted=!1}_prepareFrame(){var t,i;this._frame&&((t=this.container.current)==null||t.removeChild(this._frame));const e=document.createElement("iframe");e.style.width="100%",e.style.height="100%",e.src=this.props.url,this.props.datasetKey&&(e.dataset[this.props.datasetKey]=this.props.datasetValue),e.dataset.id=String(this.iframeID),this.props.seamless&&(e.dataset.lintGutter="true"),(i=this.container.current)==null||i.appendChild(e),this._frame=e}sendNewData(e){const t=this._frame;this._isMounted&&e&&(t!=null&&t.contentWindow)&&(this._lastData=e,window.iframeDataStore[this.iframeID]=e,t.contentWindow.postMessage(this.iframeID,"*"))}render(){return s("div",{ref:this.container,style:{width:"100%",height:"100%"}})}}try{te.displayName="IframeContentRenderer",te.__docgenInfo={description:"",displayName:"IframeContentRenderer",props:{url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}},datasetKey:{defaultValue:null,description:"",name:"datasetKey",required:!0,type:{name:"string"}},datasetValue:{defaultValue:null,description:"",name:"datasetValue",required:!0,type:{name:"any"}},seamless:{defaultValue:null,description:"",name:"seamless",required:!0,type:{name:"boolean"}}}}}catch{}const{HUD:li,InlineIcon:pi}=v,{iconCircleArrowDown:hi,iconCircleArrowUp:ci,iconPlus:At,iconTrash:di}=Ie,Ct=class Ct extends c.Component{constructor(){super(...arguments),this.state={highlightLint:!0},this._handleJsonChange=e=>{this.props.onChange({json:e})},this._handleEditorChange=(e,t)=>{const i=p.clone(this._sections());i[e]=p.extend({},i[e],t),this.props.onChange({json:i})}}componentDidMount(){this._updatePreviewFrames()}componentDidUpdate(){this._updatePreviewFrames()}_updatePreviewFrames(){this.props.mode==="preview"?this.refs["frame-all"].sendNewData({type:"article-all",data:this._sections().map((e,t)=>this._apiOptionsForSection(e,t))}):this.props.mode==="edit"&&this._sections().forEach((e,t)=>{this.refs["frame-"+t].sendNewData({type:"article",data:this._apiOptionsForSection(e,t)})})}_apiOptionsForSection(e,t){const i=this.refs[`editor${t}`];return{apiOptions:{...P.defaults,...this.props.apiOptions,showAlignmentOptions:!0,isArticle:!0},json:e,useNewStyles:this.props.useNewStyles,linterContext:{contentType:"article",highlightLint:this.state.highlightLint,paths:this.props.contentPaths},legacyPerseusLint:i?i.getSaveWarnings():[]}}_sections(){return Array.isArray(this.props.json)?this.props.json:[this.props.json]}_renderEditor(){const{imageUploader:e,sectionImageUploadGenerator:t}=this.props,i={...P.defaults,...this.props.apiOptions,showAlignmentOptions:!0,isArticle:!0},a=this._sections();return r("div",{className:"perseus-editor-table",children:[a.map((o,h)=>[r("div",{className:"perseus-editor-row",children:[r("div",{className:"perseus-editor-left-cell",children:[r("div",{className:"pod-title",children:["Section ",h+1,r("div",{style:{display:"inline-block",float:"right"},children:[t(h),s(Pe,{icon:At,onClick:()=>{this._handleAddSectionAfter(h)},title:"Add a new section after this one"}),h+1<a.length&&s(Pe,{icon:hi,onClick:()=>{this._handleMoveSectionLater(h)},title:"Move this section down"}),h>0&&s(Pe,{icon:ci,onClick:()=>{this._handleMoveSectionEarlier(h)},title:"Move this section up"}),s(Pe,{icon:di,onClick:()=>{const g="Are you sure you want to delete section "+(h+1)+"?";confirm(g)&&this._handleRemoveSection(h)},title:"Delete this section"})]})]}),s(b,{...o,apiOptions:i,imageUploader:e,onChange:p.partial(this._handleEditorChange,h),placeholder:"Type your section text here...",ref:"editor"+h})]}),s("div",{className:"editor-preview",children:this._renderIframePreview(h,!0)})]},h)]),this._renderAddSection(),this._renderLinterHUD()]})}_renderAddSection(){return s("div",{className:"perseus-editor-row",children:s("div",{className:"perseus-editor-left-cell",children:r("a",{href:"#",className:"simple-button orange",onClick:()=>{this._handleAddSectionAfter(this._sections().length-1)},children:[s(pi,{...At})," Add a section"]})})})}_renderLinterHUD(){return s(li,{message:"Style warnings",enabled:this.state.highlightLint,onClick:()=>{this.setState({highlightLint:!this.state.highlightLint})}})}_renderIframePreview(e,t){const i=this.props.screen==="phone"||this.props.screen==="tablet";return s(ft,{deviceType:this.props.screen,nochrome:t,children:s(te,{ref:"frame-"+e,datasetKey:"mobile",datasetValue:i,seamless:t,url:this.props.previewURL},this.props.screen)})}_renderPreviewMode(){return s("div",{className:"standalone-preview",children:this._renderIframePreview("all",!1)})}_handleMoveSectionEarlier(e){if(e===0)return;const t=p.clone(this._sections()),i=t[e];t.splice(e,1),t.splice(e-1,0,i),this.props.onChange({json:t})}_handleMoveSectionLater(e){const t=p.clone(this._sections());if(e+1===t.length)return;const i=t[e];t.splice(e,1),t.splice(e+1,0,i),this.props.onChange({json:t})}_handleAddSectionAfter(e){const t=p.clone(this.serialize()),i=e>=0?{widgets:t[e].widgets}:{};t.splice(e+1,0,i),this.props.onChange({json:t})}_handleRemoveSection(e){const t=p.clone(this._sections());t.splice(e,1),this.props.onChange({json:t})}serialize(){if(this.props.mode==="edit")return this._sections().map((e,t)=>this.refs["editor"+t].serialize());if(this.props.mode==="preview"||this.props.mode==="json")return this.props.json;throw new Pt("Could not serialize; mode "+this.props.mode+" not found",st.Internal)}getSaveWarnings(){if(this.props.mode!=="edit")throw new Pt("Can only get save warnings in edit mode.",st.NotAllowed);return this._sections().map((e,t)=>this.refs["editor"+t].getSaveWarnings())}render(){return r("div",{className:"framework-perseus perseus-article-editor",children:[this.props.mode==="edit"&&this._renderEditor(),this.props.mode==="preview"&&this._renderPreviewMode(),this.props.mode==="json"&&r("div",{className:"json-editor",children:[s("div",{className:"json-editor-warning",children:s("span",{children:"Warning: Editing in this mode can lead to broken articles!"})}),s(vt,{multiLine:!0,onChange:this._handleJsonChange,value:this.props.json})]})]})}};Ct.defaultProps={contentPaths:[],json:[{}],mode:"edit",screen:"desktop",sectionImageUploadGenerator:()=>s("span",{}),useNewStyles:!1};let ot=Ct;try{articleeditor.displayName="articleeditor",articleeditor.__docgenInfo={description:"",displayName:"articleeditor",props:{contentPaths:{defaultValue:{value:"[]"},description:"",name:"contentPaths",required:!1,type:{name:"readonly string[]"}},json:{defaultValue:{value:"[{}]"},description:"",name:"json",required:!1,type:{name:"JsonType"}},mode:{defaultValue:{value:"edit"},description:"",name:"mode",required:!1,type:{name:"enum",value:[{value:'"json"'},{value:'"diff"'},{value:'"edit"'},{value:'"preview"'}]}},screen:{defaultValue:{value:"desktop"},description:"",name:"screen",required:!1,type:{name:"enum",value:[{value:'"phone"'},{value:'"tablet"'},{value:'"desktop"'}]}},sectionImageUploadGenerator:{defaultValue:{value:"() => <span />"},description:"",name:"sectionImageUploadGenerator",required:!1,type:{name:"(i: number) => ReactElement<DetailedHTMLProps<HTMLAttributes<HTMLSpanElement>, HTMLSpanElement>, string | JSXElementConstructor<...>>"}},useNewStyles:{defaultValue:{value:"false"},description:"",name:"useNewStyles",required:!1,type:{name:"boolean"}},apiOptions:{defaultValue:null,description:"",name:"apiOptions",required:!1,type:{name:"Readonly<{ isArticle?: boolean; onInputError?: ((widgetId: any, value: string, message?: string | null) => unknown) | undefined; onFocusChange?: ((newFocusPath: FocusPath, oldFocusPath: FocusPath, keypadHeight?: number | undefined, focusedElement?: HTMLElement | undefined) => unknown) | undef..."}},imageUploader:{defaultValue:null,description:"",name:"imageUploader",required:!1,type:{name:"((arg1: string, arg2: (arg1: string) => unknown) => unknown)"}},previewURL:{defaultValue:null,description:"",name:"previewURL",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(values: { [key: string]: any; }, callback?: (() => unknown) | null | undefined, silent?: boolean | undefined) => unknown"}}}}}catch{}const ke=l.shape({content:l.string,images:l.objectOf(l.any),widgets:l.objectOf(l.any)}),E=class E extends c.Component{constructor(){super(...arguments),this.state=E._stateFromProps(this.props)}UNSAFE_componentWillReceiveProps(e){this.setState(E._stateFromProps(e))}render(){const{before:e,after:t}=this.state,i=Math.max(e.length,t.length),a=p.times(i,o=>s(it,{before:o<e.length?e[o]:void 0,after:o<t.length?t[o]:void 0,title:`Section ${o+1}`,showAlignmentOptions:!0,showSeparator:o<i-1},o));return s("div",{className:"framework-perseus",children:a})}};E.propTypes={after:l.oneOfType([ke,l.arrayOf(ke)]).isRequired,before:l.oneOfType([ke,l.arrayOf(ke)]).isRequired},E._stateFromProps=e=>{const{before:t,after:i}=e;return{before:Array.isArray(t)?t:[t],after:Array.isArray(i)?i:[i]}};let Ue=E;try{Ue.displayName="ArticleDiff",Ue.__docgenInfo={description:"",displayName:"ArticleDiff",props:{}}}catch{}const Mt=l.shape({question:l.shape({}).isRequired,answerArea:l.shape({}).isRequired,hints:l.arrayOf(l.any).isRequired}),bt=class bt extends c.Component{render(){const{before:e,after:t}=this.props,i=Math.max(e.hints.length,t.hints.length),a=s(it,{before:e.question,after:t.question,title:"Question",showAlignmentOptions:!1,showSeparator:!0}),o=s(Vs,{before:e.answerArea,after:t.answerArea,title:"Question extras"}),h=p.times(i,function(g){return s(it,{before:g<e.hints.length?e.hints[g]:void 0,after:g<t.hints.length?t.hints[g]:void 0,title:`Hint ${g+1}`,showAlignmentOptions:!1,showSeparator:g<i-1},g)});return r("div",{className:"framework-perseus",children:[a,o,h&&s("div",{className:"diff-separator"}),h]})}};bt.propTypes={after:Mt.isRequired,before:Mt.isRequired};let ze=bt;try{ze.displayName="ItemDiff",ze.__docgenInfo={description:"",displayName:"ItemDiff",props:{}}}catch{}const{InfoTip:ui,InlineIcon:Ve}=v,{iconCircleArrowDown:gi,iconCircleArrowUp:mi,iconPlus:fi,iconTrash:yi}=Ie,_t=class _t extends c.Component{constructor(){super(...arguments),this.editor=c.createRef(),this.handleChange=e=>{this.props.onChange({replace:e.target.checked})},this.focus=()=>{var e;(e=this.editor.current)==null||e.focus()},this.getSaveWarnings=()=>{var e;return(e=this.editor.current)==null?void 0:e.getSaveWarnings()},this.serialize=e=>{var t;return(t=this.editor.current)==null?void 0:t.serialize(e)}}render(){return r("div",{className:"perseus-hint-editor "+this.props.className,children:[this.props.showTitle&&s("div",{className:"pod-title",children:"Hint"}),s(b,{ref:this.editor,apiOptions:this.props.apiOptions,widgets:this.props.widgets||void 0,content:this.props.content||void 0,images:this.props.images,replace:this.props.replace,placeholder:"Type your hint here...",imageUploader:this.props.imageUploader,onChange:this.props.onChange},this.props.itemId),r("div",{className:"hint-controls-container clearfix",children:[this.props.showMoveButtons&&r("span",{className:"reorder-hints",children:[s("button",{type:"button",className:this.props.isLast?"hidden":"",onClick:p.partial(this.props.onMove,1),children:s(Ve,{...gi})})," ",s("button",{type:"button",className:this.props.isFirst?"hidden":"",onClick:p.partial(this.props.onMove,-1),children:s(Ve,{...mi})})," ",this.props.isLast&&s(ui,{children:s("p",{children:"The last hint is automatically bolded."})})]}),s("input",{type:"checkbox",checked:this.props.replace,onChange:this.handleChange}),"Replace previous hint",this.props.showRemoveButton&&r("button",{type:"button",className:"remove-hint simple-button orange",onClick:this.props.onRemove,children:[s(Ve,{...yi}),"Remove this hint"," "]})]})]})}};_t.defaultProps={className:"",content:"",replace:!1,showMoveButtons:!0,showTitle:!0,showRemoveButton:!0};let k=_t;const Nt=class Nt extends c.Component{constructor(){super(...arguments),this.editor=c.createRef(),this.frame=c.createRef(),this.updatePreview=()=>{var t;const e=this.props.isLast&&!/\*\*/.test(this.props.hint.content);(t=this.frame.current)==null||t.sendNewData({type:"hint",data:{hint:this.props.hint,bold:e,pos:this.props.pos,apiOptions:this.props.apiOptions,linterContext:{contentType:"hint",highlightLint:this.props.highlightLint,paths:this.props.contentPaths}}})},this.getSaveWarnings=()=>{var e;return(e=this.editor.current)==null?void 0:e.getSaveWarnings()},this.serialize=e=>{var t;return(t=this.editor.current)==null?void 0:t.serialize(e)},this.focus=()=>{var e;(e=this.editor.current)==null||e.focus()}}componentDidMount(){this.updatePreview()}componentDidUpdate(){this.updatePreview()}render(){const e=this.props.deviceType==="phone"||this.props.deviceType==="tablet";return r("div",{className:"perseus-combined-hint-editor perseus-editor-row",children:[s("div",{className:"perseus-editor-left-cell",children:s(k,{ref:this.editor,itemId:this.props.itemId,isFirst:this.props.isFirst,isLast:this.props.isLast,widgets:this.props.hint.widgets,content:this.props.hint.content,images:this.props.hint.images,replace:this.props.hint.replace,imageUploader:this.props.imageUploader,onChange:this.props.onChange,onRemove:this.props.onRemove,onMove:this.props.onMove,apiOptions:this.props.apiOptions})}),s("div",{className:"perseus-editor-right-cell",children:s(ft,{deviceType:this.props.deviceType,nochrome:!0,children:s(te,{ref:this.frame,datasetKey:"mobile",datasetValue:e,seamless:!0,url:this.props.previewURL})})})]})}};Nt.defaultProps={highlightLint:!1};let lt=Nt;const He=class He extends c.Component{constructor(){super(...arguments),this.handleHintChange=(e,t,i,a)=>{const o=p(this.props.hints).clone();o[e]=p.extend({},this.serializeHint(e,{keepDeletedWidgets:!0}),t),this.props.onChange({hints:o},i,a)},this.handleHintRemove=e=>{if(!confirm("Are you sure you want to delete this hint?"))return;const t=p(this.props.hints).clone();t.splice(e,1),this.props.onChange({hints:t})},this.handleHintMove=(e,t)=>{const i=p(this.props.hints).clone(),a=i.splice(e,1)[0];i.splice(e+t,0,a),this.props.onChange({hints:i},()=>{this.refs["hintEditor"+(e+t)].focus()})},this.addHint=()=>{const e=p(this.props.hints).clone().concat([{content:""}]);this.props.onChange({hints:e},()=>{const t=e.length-1;this.refs["hintEditor"+t].focus()})},this.getSaveWarnings=()=>p.chain(this.props.hints).map((e,t)=>p.map(this.refs["hintEditor"+t].getSaveWarnings(),i=>"Hint "+(t+1)+": "+i)).flatten(!0).value(),this.serialize=e=>this.props.hints.map((t,i)=>this.serializeHint(i,e)),this.serializeHint=(e,t)=>this.refs["hintEditor"+e].serialize(t)}render(){const{itemId:e,hints:t}=this.props,i=p.map(t,function(a,o){return s(lt,{ref:"hintEditor"+o,isFirst:o===0,isLast:o+1===t.length,itemId:e,hint:a,pos:o,imageUploader:this.props.imageUploader,onChange:this.handleHintChange.bind(this,o),onRemove:this.handleHintRemove.bind(this,o),onMove:this.handleHintMove.bind(this,o),deviceType:this.props.deviceType,apiOptions:this.props.apiOptions,highlightLint:this.props.highlightLint,previewURL:this.props.previewURL,contentPaths:[]},"hintEditor"+o)},this);return r("div",{className:"perseus-hints-editor perseus-editor-table",children:[i,s("div",{className:"perseus-editor-row",children:s("div",{className:"add-hint-container perseus-editor-left-cell",children:r("button",{type:"button",className:"add-hint simple-button orange",onClick:this.addHint,children:[s(Ve,{...fi})," Add a hint"]})})})]})}};He.HintEditor=k,He.defaultProps={onChange:()=>{},hints:[],highlightLint:!1};let se=He;try{k.displayName="HintEditor",k.__docgenInfo={description:"",displayName:"HintEditor",props:{itemId:{defaultValue:null,description:"",name:"itemId",required:!1,type:{name:"string"}},apiOptions:{defaultValue:null,description:"",name:"apiOptions",required:!1,type:{name:"Readonly<{ isArticle?: boolean; onInputError?: ((widgetId: any, value: string, message?: string | null) => unknown) | undefined; onFocusChange?: ((newFocusPath: FocusPath, oldFocusPath: FocusPath, keypadHeight?: number | undefined, focusedElement?: HTMLElement | undefined) => unknown) | undef..."}},className:{defaultValue:{value:""},description:"",name:"className",required:!1,type:{name:"string"}},imageUploader:{defaultValue:null,description:"",name:"imageUploader",required:!1,type:{name:"ImageUploader"}},showMoveButtons:{defaultValue:{value:"true"},description:"",name:"showMoveButtons",required:!1,type:{name:"boolean"}},showRemoveButton:{defaultValue:{value:"true"},description:"",name:"showRemoveButton",required:!1,type:{name:"boolean"}},showTitle:{defaultValue:{value:"true"},description:"",name:"showTitle",required:!1,type:{name:"boolean"}},content:{defaultValue:{value:""},description:"",name:"content",required:!1,type:{name:"string | null"}},replace:{defaultValue:{value:"false"},description:"",name:"replace",required:!1,type:{name:"boolean | null"}},widgets:{defaultValue:null,description:"",name:"widgets",required:!1,type:{name:"WidgetDict | null"}},images:{defaultValue:null,description:"",name:"images",required:!1,type:{name:"ImageDict | null"}},isLast:{defaultValue:null,description:"",name:"isLast",required:!0,type:{name:"boolean"}},isFirst:{defaultValue:null,description:"",name:"isFirst",required:!0,type:{name:"boolean"}},onMove:{defaultValue:null,description:"",name:"onMove",required:!0,type:{name:"(direction: number) => unknown"}},onRemove:{defaultValue:null,description:"",name:"onRemove",required:!0,type:{name:"() => unknown"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"ChangeHandler"}},__type:{defaultValue:null,description:"",name:"__type",required:!1,type:{name:"enum",value:[{value:'"hint"'}]}}}}}catch{}try{se.displayName="CombinedHintsEditor",se.__docgenInfo={description:"",displayName:"CombinedHintsEditor",props:{apiOptions:{defaultValue:null,description:"",name:"apiOptions",required:!1,type:{name:"Readonly<{ isArticle?: boolean; onInputError?: ((widgetId: any, value: string, message?: string | null) => unknown) | undefined; onFocusChange?: ((newFocusPath: FocusPath, oldFocusPath: FocusPath, keypadHeight?: number | undefined, focusedElement?: HTMLElement | undefined) => unknown) | undef..."}},deviceType:{defaultValue:null,description:"",name:"deviceType",required:!0,type:{name:"enum",value:[{value:'"phone"'},{value:'"tablet"'},{value:'"desktop"'}]}},imageUploader:{defaultValue:null,description:"",name:"imageUploader",required:!1,type:{name:"ImageUploader"}},highlightLint:{defaultValue:{value:"false"},description:"",name:"highlightLint",required:!1,type:{name:"boolean"}},hints:{defaultValue:{value:"[]"},description:"",name:"hints",required:!1,type:{name:"readonly Hint[]"}},previewURL:{defaultValue:null,description:"",name:"previewURL",required:!0,type:{name:"string"}},onChange:{defaultValue:{value:"() => {}"},description:"",name:"onChange",required:!1,type:{name:"ChangeHandler"}},itemId:{defaultValue:null,description:"",name:"itemId",required:!1,type:{name:"string"}}}}}catch{}const vi=ks,xt=class xt extends c.Component{constructor(){super(...arguments),this.frame=c.createRef(),this.questionEditor=c.createRef(),this.itemExtrasEditor=c.createRef(),this.updateProps=(e,t,i)=>{const a=p(this.props).pick("question","answerArea");this.props.onChange(p(a).extend(e),t,i)},this.triggerPreviewUpdate=e=>{var t;(t=this.frame.current)==null||t.sendNewData(e)},this.handleEditorChange=(e,t,i)=>{const a=p.extend({},this.props.question,e);this.updateProps({question:a},t,i)},this.handleItemExtrasChange=(e,t,i)=>{const a=p.extend({},this.props.answerArea,e);this.updateProps({answerArea:a},t,i)},this.getSaveWarnings=()=>{var e;return(e=this.questionEditor.current)==null?void 0:e.getSaveWarnings()},this.serialize=e=>{var t,i;return{question:(t=this.questionEditor.current)==null?void 0:t.serialize(e),answerArea:(i=this.itemExtrasEditor.current)==null?void 0:i.serialize(),itemDataVersion:vi}}}render(){const e=this.props.deviceType==="phone"||this.props.deviceType==="tablet";return r("div",{className:"perseus-editor-table",children:[r("div",{className:"perseus-editor-row perseus-question-container",children:[r("div",{className:"perseus-editor-left-cell",children:[s("div",{className:"pod-title",children:"Question"}),s(b,{ref:this.questionEditor,placeholder:"Type your question here...",className:"perseus-question-editor",imageUploader:this.props.imageUploader,onChange:this.handleEditorChange,apiOptions:this.props.apiOptions,showWordCount:!0,...this.props.question},this.props.itemId)]}),s("div",{className:"perseus-editor-right-cell",children:r("div",{id:"problemarea",children:[s(ft,{deviceType:this.props.deviceType,nochrome:!0,children:s(te,{ref:this.frame,datasetKey:"mobile",datasetValue:e,seamless:!0,url:this.props.previewURL},this.props.deviceType)}),s("div",{id:"hintsarea",className:"hintsarea",style:{display:"none"}})]})})]}),r("div",{className:"perseus-editor-row perseus-answer-container",children:[r("div",{className:"perseus-editor-left-cell",children:[s("div",{className:"pod-title",children:"Question extras"}),s(qs,{ref:this.itemExtrasEditor,onChange:this.handleItemExtrasChange,...this.props.answerArea})]}),s("div",{className:"perseus-editor-right-cell",children:s("div",{id:"answer_area"})})]})]})}};xt.defaultProps={onChange:()=>{},question:{},answerArea:{}};let ie=xt;try{ie.displayName="ItemEditor",ie.__docgenInfo={description:"",displayName:"ItemEditor",props:{apiOptions:{defaultValue:null,description:"",name:"apiOptions",required:!1,type:{name:"Readonly<{ isArticle?: boolean; onInputError?: ((widgetId: any, value: string, message?: string | null) => unknown) | undefined; onFocusChange?: ((newFocusPath: FocusPath, oldFocusPath: FocusPath, keypadHeight?: number | undefined, focusedElement?: HTMLElement | undefined) => unknown) | undef..."}},deviceType:{defaultValue:null,description:"",name:"deviceType",required:!1,type:{name:"enum",value:[{value:'"phone"'},{value:'"tablet"'},{value:'"desktop"'}]}},gradeMessage:{defaultValue:null,description:"",name:"gradeMessage",required:!1,type:{name:"string"}},imageUploader:{defaultValue:null,description:"",name:"imageUploader",required:!1,type:{name:"ImageUploader"}},wasAnswered:{defaultValue:null,description:"",name:"wasAnswered",required:!1,type:{name:"boolean"}},question:{defaultValue:{value:"{}"},description:"",name:"question",required:!1,type:{name:"any"}},answerArea:{defaultValue:{value:"{}"},description:"",name:"answerArea",required:!1,type:{name:"any"}},previewURL:{defaultValue:null,description:"",name:"previewURL",required:!0,type:{name:"string"}},onChange:{defaultValue:{value:"() => {}"},description:"",name:"onChange",required:!1,type:{name:"ChangeHandler"}},itemId:{defaultValue:null,description:"",name:"itemId",required:!1,type:{name:"string"}}}}}catch{}const{HUD:wi}=v,St=class St extends c.Component{constructor(e){super(e),this.itemEditor=c.createRef(),this.hintsEditor=c.createRef(),this.toggleJsonMode=()=>{this.setState({json:this.serialize({keepDeletedWidgets:!0})},()=>{this.props.onChange({jsonMode:!this.props.jsonMode})})},this.handleChange=(t,i,a)=>{const o=p(this.props).pick("question","hints","answerArea");p(o).extend(t),this.props.onChange(o,i,a)},this.changeJSON=t=>{this.setState({json:t}),this.props.onChange(t)},this.state={json:p.pick(this.props,"question","answerArea","hints","itemDataVersion"),gradeMessage:"",wasAnswered:!1,highlightLint:!0},this._isMounted=!1}componentDidMount(){this._isMounted=!0,this.updateRenderer()}componentDidUpdate(){setTimeout(()=>{this.updateRenderer()})}componentWillUnmount(){this._isMounted=!1}updateRenderer(){var a,o;const e=!this.props.developerMode||!this.props.jsonMode;if(!this._isMounted||!e)return;const t=this.props.previewDevice==="phone"||this.props.previewDevice==="tablet",i={...this.getApiOptions(),customKeypad:t,isMobile:t};(o=this.itemEditor.current)==null||o.triggerPreviewUpdate({type:"question",data:p({item:this.serialize(),apiOptions:i,initialHintsVisible:0,device:this.props.previewDevice,linterContext:{contentType:"exercise",highlightLint:this.state.highlightLint,paths:this.props.contentPaths||[]},reviewMode:!0,legacyPerseusLint:(a=this.itemEditor.current)==null?void 0:a.getSaveWarnings()}).extend(p(this.props).pick("workAreaSelector","solutionAreaSelector","hintsAreaSelector","problemNum"))})}getApiOptions(){return{...P.defaults,...this.props.apiOptions}}getSaveWarnings(){var i,a;const e=(i=this.itemEditor.current)==null?void 0:i.getSaveWarnings(),t=(a=this.hintsEditor.current)==null?void 0:a.getSaveWarnings();return e.concat(t)}serialize(e){var t,i;return this.props.jsonMode?this.state.json:p.extend((t=this.itemEditor.current)==null?void 0:t.serialize(e),{hints:(i=this.hintsEditor.current)==null?void 0:i.serialize(e)})}scorePreview(){return this.renderer?this.renderer.scoreInput():null}render(){let e="framework-perseus";const t=this.props.previewDevice==="phone"||this.props.previewDevice==="tablet",i={...this.getApiOptions(),customKeypad:t,isMobile:t};return i.isMobile&&(e+=" "+Ps.MOBILE),r("div",{id:"perseus",className:e,children:[r("div",{style:{marginBottom:10},children:[this.props.developerMode&&r("span",{children:[r("label",{children:[" ","Developer JSON Mode:"," ",s("input",{type:"checkbox",checked:this.props.jsonMode,onChange:this.toggleJsonMode})]})," "]}),!this.props.jsonMode&&s(Rs,{deviceType:this.props.previewDevice,onViewportSizeChanged:this.props.onPreviewDeviceChange}),!this.props.jsonMode&&s(wi,{message:"Style warnings",enabled:this.state.highlightLint,onClick:()=>{this.setState({highlightLint:!this.state.highlightLint})}})]}),this.props.developerMode&&this.props.jsonMode&&s("div",{children:s(vt,{multiLine:!0,value:this.state.json,onChange:this.changeJSON})}),(!this.props.developerMode||!this.props.jsonMode)&&s(ie,{ref:this.itemEditor,itemId:this.props.itemId,question:this.props.question,answerArea:this.props.answerArea,imageUploader:this.props.imageUploader,onChange:this.handleChange,wasAnswered:this.state.wasAnswered,gradeMessage:this.state.gradeMessage,deviceType:this.props.previewDevice,apiOptions:i,previewURL:this.props.previewURL}),(!this.props.developerMode||!this.props.jsonMode)&&s(se,{ref:this.hintsEditor,itemId:this.props.itemId,hints:this.props.hints,imageUploader:this.props.imageUploader,onChange:this.handleChange,deviceType:this.props.previewDevice,apiOptions:i,previewURL:this.props.previewURL,highlightLint:this.state.highlightLint})]})}};St.defaultProps={developerMode:!1,jsonMode:!1,onChange:()=>{}};let re=St;try{re.displayName="EditorPage",re.__docgenInfo={description:"",displayName:"EditorPage",props:{apiOptions:{defaultValue:null,description:"",name:"apiOptions",required:!1,type:{name:"Readonly<{ isArticle?: boolean; onInputError?: ((widgetId: any, value: string, message?: string | null) => unknown) | undefined; onFocusChange?: ((newFocusPath: FocusPath, oldFocusPath: FocusPath, keypadHeight?: number | undefined, focusedElement?: HTMLElement | undefined) => unknown) | undef..."}},answerArea:{defaultValue:null,description:"",name:"answerArea",required:!1,type:{name:"any"}},contentPaths:{defaultValue:null,description:"",name:"contentPaths",required:!1,type:{name:"readonly string[]"}},developerMode:{defaultValue:{value:"false"},description:"",name:"developerMode",required:!1,type:{name:"boolean"}},frameSource:{defaultValue:null,description:"",name:"frameSource",required:!0,type:{name:"string"}},hints:{defaultValue:null,description:"",name:"hints",required:!1,type:{name:"readonly Hint[]"}},imageUploader:{defaultValue:null,description:"",name:"imageUploader",required:!1,type:{name:"ImageUploader"}},itemDataVersion:{defaultValue:null,description:"",name:"itemDataVersion",required:!1,type:{name:"Version"}},itemId:{defaultValue:null,description:"",name:"itemId",required:!0,type:{name:"string"}},jsonMode:{defaultValue:{value:"false"},description:"",name:"jsonMode",required:!1,type:{name:"boolean"}},onChange:{defaultValue:{value:"() => {}"},description:"",name:"onChange",required:!1,type:{name:"ChangeHandler"}},onPreviewDeviceChange:{defaultValue:null,description:"",name:"onPreviewDeviceChange",required:!0,type:{name:"(arg1: DeviceType) => unknown"}},previewDevice:{defaultValue:null,description:"",name:"previewDevice",required:!0,type:{name:"enum",value:[{value:'"phone"'},{value:'"tablet"'},{value:'"desktop"'}]}},question:{defaultValue:null,description:"",name:"question",required:!1,type:{name:"any"}},previewURL:{defaultValue:null,description:"",name:"previewURL",required:!0,type:{name:"string"}}}}}catch{}const We=class We extends c.Component{render(){const{children:e,color:t,onClick:i,...a}=this.props;return s("div",{className:d.css(Je.baseButton,t==="green"&&Je.green,t==="orange"&&Je.orange),onClick:i,...a,children:e})}};We.propTypes={children:l.node,color:l.oneOf(["orange","green"]),onClick:l.func},We.defaultProps={children:null,color:"green",onClick:()=>{}};let T=We;const Je=d.StyleSheet.create({baseButton:{top:"0",fontSize:"11px",padding:"3px 10px",backgroundRepeat:"repeat-x",borderColor:`
             rgba(0, 0, 0, 0.1)
             rgba(0, 0, 0, 0.1)
             rgba(0, 0, 0, 0.25)
         `,color:"#ffffff",borderRadius:"3px",lineHeight:"15px",cursor:"pointer",transition:"box-shadow ease-in-out 0.15s",appearance:"none",textDecoration:"none",textAlign:"center",":hover":{boxShadow:`0 1px 1px rgba(0, 0, 0, 0.35),
                 inset 0 0 50px 5px rgba(255, 255, 255, 0.2)`}},green:{border:"1px solid #7fab07",backgroundColor:"#80ac07",backgroundImage:"linear-gradient(to bottom, #8aba08, #719807)",":hover":{borderBottomColor:"#547105",backgroundColor:"#719807"}},orange:{border:"1px solid #d45704",backgroundColor:"#d55704",backgroundImage:"linear-gradient(to bottom, #e35d04, #c04f03)",":hover":{borderBottomColor:"#983e03",backgroundColor:"#c04f03"}}});try{T.displayName="SimpleButton",T.__docgenInfo={description:"",displayName:"SimpleButton",props:{}}}catch{}const{InlineIcon:Ye}=v,{iconChevronDown:Et,iconTrash:Ci}=Ie,{MultiRenderer:bi}=Us;class Ae extends c.Component{constructor(){super(...arguments),this._handleSelectMode=e=>{if(this.props.onChange){const t=e.target.value;this.props.onChange(t)}}}render(){return r("label",{children:["Mode:"," ",r("select",{value:this.props.currentMode,onChange:this._handleSelectMode,children:[s("option",{value:"edit",children:"Edit"}),s("option",{value:"preview",children:"Preview"}),s("option",{value:"json",children:"Dev-only JSON"})]})]})}}function ns(n){return n.replace(/[A-Z]/g,e=>" "+e.toLowerCase())}function De(n){return n.charAt(0).toUpperCase()+n.slice(1).toLowerCase()}function as(n){return n.charAt(n.length-1)==="s"?n.slice(0,-1):n}function I(n){return["_multi",...n]}const pt=({depth:n,...e})=>{const i=`h${Math.min(n,5)+1}`;return s(i,{...e})},wt=n=>{const{shape:e,data:t,path:i,actions:a,name:o,controls:h,...g}=n,f=o||ns(i[i.length-1]||""),N=s(Si,{...g,shape:e,data:t,path:i,actions:a}),_=i.join(".");return e.type==="array"?s(Ni,{name:f,controls:h,path:i,shape:e,actions:a,children:N},_):e.type==="object"?s(xi,{name:f,controls:h,path:i,children:N},_):s(_i,{name:f,controls:h,path:i,shape:e,children:N},_)},_i=({name:n,controls:e,children:t,path:i,shape:a})=>{const h=(a.type==="content"||a.type==="hint")&&s("div",{className:d.css(u.containerHeader),children:s(pt,{depth:i.length,className:d.css(u.containerTitle),children:De(n)})});return r("div",{className:d.css(u.container),children:[r("span",{className:d.css(u.row,u.rowHeading),children:[s("div",{className:d.css(u.columnLeft),children:r("div",{className:"pod-title "+d.css(u.containerHeader),children:[s("div",{className:d.css(u.containerTitle),children:De(n)}),e]})}),s("div",{className:d.css(u.columnRight),children:h})]}),t]})},Ni=n=>{const{name:e,controls:t,children:i,path:a,shape:o,actions:h}=n;return r("div",{className:d.css(u.container),children:[t&&s("div",{className:d.css(u.columnLeft,u.containerHeader),children:t}),s("div",{children:i}),s("div",{className:d.css(u.columnLeft),children:r("a",{href:"javascript:void 0",onClick:()=>h.addArrayElement(a,o.elementShape),children:["Add a ",as(e)]})})]})},xi=({name:n,controls:e,children:t,path:i})=>{const a=r("div",{className:d.css(u.containerHeader),children:[s(pt,{depth:i.length,className:d.css(u.containerTitle),children:De(n)}),e]}),o=(n||e)&&s("div",{className:d.css(u.containerHeader,u.previewCollectionHeader),children:s(pt,{depth:i.length,className:d.css(u.containerTitle),children:De(n)})}),h=a&&o;return r("div",{className:d.css(u.container),children:[h&&r("span",{className:d.css(u.row),children:[s("div",{className:d.css(u.columnLeft),children:a}),s("div",{className:d.css(u.columnRight),children:o})]}),s("div",{className:d.css(i.length>0&&u.contentIndent),children:t})]})},Si=n=>{const{shape:e,data:t,...i}=n;return e.type==="content"?s(Ii,{shape:e,data:t,...i}):e.type==="hint"?s(Ti,{shape:e,data:t,...i}):e.type==="tags"?s(Pi,{shape:e,data:t,...i}):e.type==="array"?s(ki,{shape:e,data:t,...i}):e.type==="object"?s(Ai,{shape:e,data:t,...i}):null},os=n=>class extends c.Component{constructor(){super(...arguments),this.state={sticky:!1},this.updateStickiness=()=>{const i=Re.findDOMNode(this).offsetHeight,a=window.innerHeight,o=i>a;o!==this.state.sticky&&this.setState({sticky:o})}}componentDidMount(){this.stickynessTimer=setInterval(this.updateStickiness,1e3),this.updateStickiness()}componentWillUnmount(){clearInterval(this.stickynessTimer)}render(){return s(n,{...this.props,sticky:this.state.sticky})}},Ii=os(n=>{const{data:e,path:t,actions:i,apiOptions:a,renderers:o,sticky:h}=n,g=s("div",{className:"framework-perseus",children:x(o).get(t)});return s("span",{children:r("div",{className:d.css(u.row),children:[s("div",{className:d.css(u.columnLeft),children:s("div",{className:d.css(h&&u.sticky),children:s(b,{...e,onChange:f=>i.mergeValueAtPath(t,f),apiOptions:a})})}),s("div",{className:d.css(u.columnRight),children:s("div",{className:d.css(h&&u.sticky),children:g})})]})})}),Ti=os(n=>{const{data:e,path:t,actions:i,apiOptions:a,renderers:o,sticky:h}=n,g=s("div",{className:"framework-perseus",children:x(o).get(t)});return r("div",{className:d.css(u.row),children:[s("div",{className:d.css(u.columnLeft),children:s("div",{className:d.css(h&&u.sticky),children:s(k,{...e,className:d.css(u.hintEditor),onChange:f=>i.mergeValueAtPath(t,f),apiOptions:a,showTitle:!1,showRemoveButton:!1,showMoveButtons:!1,onRemove:()=>{},onMove:f=>{},isFirst:!0,isLast:!0})})}),s("div",{className:d.css(u.columnRight),children:s("div",{className:d.css(h&&u.sticky),children:g})})]})}),Pi=n=>{const{data:e,path:t,actions:i,apiOptions:a}=n,{GroupMetadataEditor:o}=a;return o==null?null:s("div",{className:d.css(u.columnLeft),children:s("div",{className:d.css(u.tagsEditor),children:s(o,{value:e,onChange:h=>i.setValueAtPath(t,h),showTitle:!1})})})},ki=n=>{const{shape:e,data:t,path:i,actions:a,...o}=n,h=ns(i[i.length-1]),g=as(h),f=e.elementShape.type,N=f==="content"||f==="hint",_=t.map((ms,M)=>{const Te=i.concat(M),fs=[M>0&&s("div",{className:d.css(u.control),children:s(T,{color:"orange",title:"Move up",onClick:()=>a.moveArrayElementUp(Te),children:s("div",{className:d.css(u.verticalFlip),children:s(Ye,{...Et})})})},"moveArrayElementUp"),M<t.length-1&&s("div",{className:d.css(u.control),children:s(T,{color:"orange",title:"Move down",onClick:()=>a.moveArrayElementDown(Te),children:s(Ye,{...Et})})},"moveArrayElementDown"),s("div",{className:d.css(u.control),children:s(T,{color:"orange",title:"Delete",onClick:()=>a.removeArrayElement(Te),children:s(Ye,{...Ci})})},"removeArrayElement")];return s("div",{className:d.css(u.arrayElement,!N&&u.arrayElementAndNotLeaf),children:c.createElement(wt,{...o,key:M,shape:e.elementShape,data:ms,path:Te,actions:a,name:`${g} ${M+1}`,controls:fs})},M)});return s("div",{children:_})},Ai=n=>{const{shape:e,data:t,path:i,...a}=n,o=Object.keys(e.shape).map(h=>s("div",{className:d.css(u.objectElement),children:s(wt,{...a,shape:e.shape[h],data:t[h],path:i.concat(h)})},h));return s("div",{children:o})};class Ot extends c.Component{constructor(){super(...arguments),this._renderLayout=()=>{const{Layout:e,apiOptions:t,item:i}=this.props;return s(e,{ref:a=>this.layout=a,item:i,apiOptions:t})},this._renderJson=()=>r("div",{children:[s(Ae,{currentMode:this.props.editorMode,onChange:e=>this.props.onChange({editorMode:e})}),s(vt,{multiLine:!0,value:this.props.item,onChange:e=>this.props.onChange({item:e})})]}),this._renderPreview=()=>r("div",{children:[s(Ae,{currentMode:this.props.editorMode,onChange:e=>this.props.onChange({editorMode:e})}),this._renderLayout()]}),this.mergeValueAtPath=(e,t)=>{this.props.onChange({item:x(this.props.item).merge(I(e),t).freeze()})},this.setValueAtPath=(e,t)=>{this.props.onChange({item:x(this.props.item).set(I(e),t).freeze()})},this.addArrayElement=(e,t)=>{const i=x(this.props.item).get(I(e)).length,a=e.concat(i),o=As(t);this.props.onChange({item:x(this.props.item).set(I(a),o).freeze()})},this.removeArrayElement=e=>{this.props.onChange({item:x(this.props.item).del(I(e)).freeze()})},this.moveArrayElementDown=e=>{const i=e[e.length-1]+1,a=e.slice(0,-1).concat(i),o=x(this.props.item).get(I(e)),h=x(this.props.item).get(I(a));this.props.onChange({item:x(this.props.item).set(I(e),h).set(I(a),o).freeze()})},this.moveArrayElementUp=e=>{const t=e[e.length-1],i=e.slice(0,-1).concat(t-1);this.moveArrayElementDown(i)},this._renderEdit=()=>{const e={...P.defaults,...this.props.apiOptions},{item:t}=this.props,i=this.props.Layout.shape;return r("div",{className:"perseus-multirenderer-editor",children:[s(Ae,{currentMode:this.props.editorMode,onChange:a=>this.props.onChange({editorMode:a})}),s(bi,{item:t,shape:i,apiOptions:e,dependencies:{analytics:{onAnalyticsEvent:async()=>{}}},children:({renderers:a})=>s(wt,{shape:i,data:Ms(t),path:[],actions:this,apiOptions:e,renderers:a})})]})},this.score=()=>{if(this.layout)return this.layout.score()},this.getSerializedState=()=>{if(this.layout)return this.layout.getSerializedState()},this.restoreSerializedState=e=>{this.layout&&this.layout.restoreSerializedState(e)},this._renderContent=()=>{switch(this.props.editorMode){case"json":return this._renderJson();case"preview":return this._renderPreview();case"edit":return this._renderEdit();default:return s(Ae,{currentMode:this.props.editorMode,onChange:e=>this.props.onChange({editorMode:e})})}}}render(){return s("div",{id:"perseus",children:this._renderContent()})}}const u=d.StyleSheet.create({container:{},editor:{width:"100%"},treePreview:{position:"relative"},verticalFlip:{transform:"scaleY(-1)"},control:{marginLeft:12},containerHeader:{alignItems:"flex-end",display:"flex",flexDirection:"row"},previewCollectionHeader:{marginBottom:16},containerTitle:{flexGrow:1,margin:0},contentIndent:{marginLeft:8},hintEditor:{paddingBottom:0},arrayElement:{marginBottom:16},arrayElementAndNotLeaf:{borderBottom:"1px solid #ccc",":first-child":{borderTop:"1px solid #ccc",paddingTop:16}},objectElement:{marginBottom:16},tagsEditor:{border:"1px solid #ddd",padding:"5px 10px"},row:{display:"flex",position:"relative"},columnLeft:{width:360,marginRight:30,position:"relative"},columnRight:{flex:1,marginLeft:30,position:"relative"},sticky:{position:"sticky",top:33},rowHeading:{position:"sticky",backgroundColor:"white",width:"100%",zIndex:101,top:-1}});try{Ot.displayName="MultiRendererEditor",Ot.__docgenInfo={description:"",displayName:"MultiRendererEditor",props:{Layout:{defaultValue:null,description:"",name:"Layout",required:!0,type:{name:"ComponentType<any> & LayoutStatics"}},apiOptions:{defaultValue:null,description:"",name:"apiOptions",required:!0,type:{name:"Readonly<{ isArticle?: boolean | undefined; onInputError?: ((widgetId: any, value: string, message?: string | null | undefined) => unknown) | undefined; onFocusChange?: ((newFocusPath: FocusPath, oldFocusPath: FocusPath, keypadHeight?: number | undefined, focusedElement?: HTMLElement | undefined) => unknown) | undef..."}},item:{defaultValue:null,description:"",name:"item",required:!0,type:{name:"Item"}},editorMode:{defaultValue:null,description:"",name:"editorMode",required:!0,type:{name:"enum",value:[{value:'"json"'},{value:'"edit"'},{value:'"preview"'}]}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"ChangeHandler"}}}}}catch{}yt({displayName:"StatefulArticleEditor",getInitialState:function(){return p({}).extend(this.props,{mode:"edit",onChange:this.handleChange,ref:"editor",screen:"phone"})},componentDidMount:function(){this._isMounted=!0},UNSAFE_componentWillReceiveProps:function(n){this.setState(p(n).omit("onChange","ref"))},componentWillUnmount:function(){this._isMounted=!1},getSaveWarnings:function(){return this.refs.editor.getSaveWarnings()},serialize:function(){return this.refs.editor.serialize()},handleChange:function(n,e){this._isMounted&&this.setState(n,e)},scorePreview:function(){return this.refs.editor.scorePreview()},render:function(){const{mode:n,screen:e}=this.state;return r("div",{children:[r("div",{style:C.controlBar,children:[r("span",{style:C.controls,children:["Mode:"," ",s("span",{onClick:()=>this.setState({mode:"edit"}),style:n==="edit"?C.controlSelected:C.control,children:"EDIT"})," | ",s("span",{onClick:()=>this.setState({mode:"preview"}),style:n==="preview"?C.controlSelected:C.control,children:"PREVIEW"})," | ",s("span",{onClick:()=>this.setState({mode:"json"}),style:n==="json"?C.controlSelected:C.control,children:"JSON"})]}),r("span",{style:C.controls,children:["Screen:"," ",s("span",{onClick:()=>this.setState({screen:"phone"}),style:e==="phone"?C.controlSelected:C.control,children:"PHONE"})," | ",s("span",{onClick:()=>this.setState({screen:"tablet"}),style:e==="tablet"?C.controlSelected:C.control,children:"TABLET"})," | ",s("span",{onClick:()=>this.setState({screen:"desktop"}),style:e==="desktop"?C.controlSelected:C.control,children:"DESKTOP"})]})]}),s("div",{style:C.editor,children:s(ot,{...this.state})})]})}});const C={controlBar:{marginBottom:25,marginTop:5},controls:{marginRight:10},controlSelected:{cursor:"default",fontWeight:700},control:{cursor:"pointer"},editor:{marginTop:-20}};yt({displayName:"StatefulEditorPage",propTypes:{componentClass:l.func},getDefaultProps:function(){return{componentClass:re}},render:function(){const n=this.props.componentClass;return s(n,{...this.state})},getInitialState:function(){return p({}).extend(p.omit(this.props,"componentClass"),{onChange:this.handleChange,ref:"editor"})},componentDidMount:function(){this._isMounted=!0},componentWillUnmount:function(){this._isMounted=!1},UNSAFE_componentWillReceiveProps:function(n){this.setState(p(n).pick("apiOptions","imageUploader","developerMode","problemNum","previewDevice","frameSource"))},getSaveWarnings:function(){return this.refs.editor.getSaveWarnings()},serialize:function(){return this.refs.editor.serialize()},handleChange:function(n,e){this._isMounted&&this.setState(n,e)},scorePreview:function(){return this.refs.editor.scorePreview()}});const{InfoTip:Lt,PropCheckBox:Rt}=v,Vt=400,qt=400;var O;let Mi=(O=class extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.serialize=()=>w.serialize.call(this)}render(){return r("fieldset",{className:"pair-editor",children:[r("label",{children:["Name:"," ",s(S,{value:this.props.name,onChange:this.change("name")})]}),r("label",{children:[" ","Value:"," ",s(S,{value:this.props.value,onChange:this.change("value")})]})]})}},O.propTypes={...y,name:l.string,value:l.string},O.defaultProps={name:"",value:""},O);var Se;let Ei=(Se=class extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.handlePairChange=(e,t)=>{const i=this.props.pairs.slice();i[e]=t;const a=i[i.length-1];a.name&&a.value&&i.push({name:"",value:""}),this.change("pairs",i)},this.serialize=()=>w.serialize.call(this)}render(){const e=p.map(this.props.pairs,(t,i)=>s(Mi,{name:t.name,value:t.value,onChange:this.handlePairChange.bind(this,i)},i));return s("div",{children:e})}},Se.propTypes={...y,pairs:l.arrayOf(l.shape({name:l.string,value:l.string})).isRequired},Se);const Oi=/khanacademy\.org\/computer-programming\/[^\/]+\/(\d+)/;function Li(n){const e=Oi.exec(n);return e&&(n=e[1]),n}const q=class q extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this._handleSettingsChange=e=>{this.change({settings:e.pairs})},this._handleProgramIDChange=e=>{e=Li(e);const{isDevServer:t,InitialRequestUrl:i}=rs(),o=`${t?i.origin:"https://www.khanacademy.org"}/api/internal/scratchpads/${e}`;Os.getJSON(o).done(h=>{const g=h.userAuthoredContentType;this.change({width:h.width,height:h.height,programID:e,programType:g})}).fail((h,g,f)=>{Qt.error("Error retrieving scratchpad info for program ID ",st.TransientService,{cause:f,loggedMetadata:{textStatus:g,programID:e}}),this.change({width:Vt,height:qt,programID:e,programType:null})})},this.serialize=()=>w.serialize.call(this)}render(){return r("div",{children:[r("label",{children:["Url or Program ID:"," ",s(S,{value:this.props.programID,onChange:this._handleProgramIDChange})]}),s("br",{}),s(Rt,{label:"Show Editor",showEditor:this.props.showEditor,onChange:this.props.onChange}),s(Lt,{children:'If you show the editor, you should use the "full-width" alignment to make room for the width of the editor.'}),s("br",{}),s(Rt,{label:"Show Buttons",showButtons:this.props.showButtons,onChange:this.props.onChange}),s("br",{}),r("label",{children:["Settings:",s(Ei,{name:"settings",pairs:this.props.settings,onChange:this._handleSettingsChange}),r(Lt,{children:["Settings that you add here are available to the program as an object returned by ",s("code",{children:"Program.settings()"})]})]})]})}};q.propTypes={...y},q.widgetName="cs-program",q.defaultProps={programID:"",programType:null,settings:[{name:"",value:""}],showEditor:!1,showButtons:!1,width:Vt,height:qt};let ne=q;try{ne.displayName="CSProgramEditor",ne.__docgenInfo={description:"This is the main editor for this widget, to specify all the options.",displayName:"CSProgramEditor",props:{}}}catch{}const It=class It extends c.Component{serialize(){return w.serialize.call(this)}render(){return r("div",{children:[s("p",{children:"This widget has been deprecated and removed"}),s("p",{children:"Learners will see a message and they will not be graded on this part. Please replace this widget with a supported one."})]})}};It.widgetName="deprecated-standin";let ae=It;try{ae.displayName="DeprecatedStandinEditor",ae.__docgenInfo={description:"",displayName:"DeprecatedStandinEditor",props:{onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(options: any) => void"}}}}}catch{}const{Graphie:ls}=v,Xe=ls.MovablePoint;var L;let Ri=(L=class extends c.Component{constructor(){super(...arguments),this.getUserInput=()=>vs.getUserInput.call(this),this.change=(...e)=>m.apply(this,e),this.movePoint=e=>{this.change({coord:e})},this._getGridConfig=e=>p.map(e.step,function(t,i){return qe.gridDimensionConfig(t,e.range[i],e.box[i],e.gridStep[i])}),this.setupGraphie=(e,t)=>{const i=this._getGridConfig(t);e.graphInit({range:t.range,scale:p.pluck(i,"scale"),axisArrows:"<->",labelFormat:function(a){return"\\small{"+a+"}"},gridStep:t.gridStep,tickStep:p.pluck(i,"tickStep"),labelStep:1,unityLabels:p.pluck(i,"unityLabel")}),e.label([0,t.range[1][1]],t.labels[1],"above")},this.simpleValidate=e=>L.validate(this.getUserInput(),e)}static validate(e,t){return e.coord==null?{type:"invalid",message:null}:Ls(e.coord,t.correct)?{type:"points",earned:1,total:1,message:null}:{type:"points",earned:0,total:1,message:null}}render(){var e;return s(ls,{ref:"graphie",box:this.props.graph.box,range:this.props.graph.range,options:this.props.graph,setup:this.setupGraphie,setDrawingAreaAvailable:(e=this.props.apiOptions)==null?void 0:e.setDrawingAreaAvailable,children:s(Xe,{pointSize:5,coord:this.props.coord||[0,0],constraints:[Xe.constraints.snap(),Xe.constraints.bound()],onMove:this.movePoint})})}},L.defaultProps={coord:null,graph:{box:[400,400],labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],gridStep:[1,1],valid:!0,backgroundImage:null,markings:"grid",showProtractor:!1}},L);const ps={name:"example-graphie-widget",displayName:"Example Graphie Widget",hidden:!0,widget:Ri};try{examplegraphiewidget.displayName="examplegraphiewidget",examplegraphiewidget.__docgenInfo={description:`For this widget to work, we must export it.
We also must import this file in src/all-widgets.js`,displayName:"examplegraphiewidget",props:{}}}catch{}const Vi=ps.widget,U=class U extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.handleChange=e=>{e.coord&&this.change({correct:e.coord})},this.serialize=()=>w.serialize.call(this)}render(){return s("div",{children:s(Vi,{graph:this.props.graph,coord:this.props.correct,onChange:this.handleChange,apiOptions:this.props.apiOptions})})}};U.propTypes={...y},U.widgetName="example-graphie-widget",U.defaultProps={correct:[4,4],graph:{box:[340,340],labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],gridStep:[1,1],valid:!0,backgroundImage:null,markings:"grid",showProtractor:!1}};let oe=U;try{oe.displayName="ExampleGraphieWidgetEditor",oe.__docgenInfo={description:`This is the widget's editor. This is what shows up on the left side
of the screen in the demo page. Only the question writer sees this.`,displayName:"ExampleGraphieWidgetEditor",props:{}}}catch{}const z=class z extends c.Component{constructor(){super(...arguments),this.input=c.createRef(),this.handleAnswerChange=e=>{this.change({correct:e.target.value})},this.change=(...e)=>m.apply(this,e),this.focus=()=>{var e;return(e=this.input.current)==null||e.focus(),!0},this.serialize=()=>w.serialize.call(this)}render(){return s("div",{children:r("label",{children:["Correct answer:",s("input",{value:this.props.correct,onChange:this.handleAnswerChange,ref:this.input})]})})}};z.propTypes={...y},z.widgetName="example-widget",z.defaultProps={correct:""};let le=z;try{le.displayName="ExampleWidgetEditor",le.__docgenInfo={description:`This is the widget's editor. This is what shows up on the left side
of the screen in the demo. Only the question writer sees this.`,displayName:"ExampleWidgetEditor",props:{}}}catch{}const{InlineIcon:Ut,TextInput:qi}=v,{iconPlus:Ui,iconTrash:zi}=Ie,D=class D extends c.Component{constructor(){super(...arguments),this.editor=c.createRef(),this.hintEditor=c.createRef(),this.change=(...e)=>m.apply(this,e),this.handleAddHint=()=>{const e={content:""};this.props.onChange({hint:e},()=>{var t;(t=this.hintEditor.current)==null||t.focus()})},this.handleRemoveHint=e=>{this.props.onChange({hint:null})},this.getSaveWarnings=()=>{var e;return(e=this.editor.current)==null?void 0:e.getSaveWarnings()},this.serialize=()=>{var e,t;return{title:this.props.title,...(e=this.editor.current)==null?void 0:e.serialize(),hint:(t=this.hintEditor.current)==null?void 0:t.serialize()}}}render(){return r("div",{className:"perseus-group-editor",children:[s("div",{className:"perseus-widget-row",children:r("label",{className:d.css(Qe.title),children:["Title:"," ",s(qi,{value:this.props.title,className:d.css(Qe.input),onChange:this.change("title")})]})}),s(b,{ref:this.editor,content:this.props.content,widgets:this.props.widgets,apiOptions:this.props.apiOptions,images:this.props.images,widgetEnabled:!0,immutableWidgets:!1,onChange:this.props.onChange,warnNoPrompt:!0,warnNoWidgets:!0}),!this.props.hint&&r("button",{type:"button",style:{marginTop:10},className:"add-hint simple-button orange",onClick:this.handleAddHint,children:[s(Ut,{...Ui})," Add a hint"]}),this.props.hint&&r("div",{className:"perseus-hint-editor",children:[s("div",{className:d.css(Qe.hintsTitle),children:"Hint"}),s(b,{ref:this.hintEditor,content:this.props.hint?this.props.hint.content:"",widgets:this.props.hint?this.props.hint.widgets:{},apiOptions:this.props.apiOptions,images:this.props.hint&&this.props.hint.images,widgetEnabled:!0,immutableWidgets:!1,onChange:e=>{this.change("hint",Object.assign({},this.props.hint,e))}}),r("button",{type:"button",className:"remove-hint simple-button orange",onClick:this.handleRemoveHint,children:[s(Ut,{...zi})," Remove this hint"]})]})]})}};D.propTypes={...y,title:l.string,content:l.string,widgets:l.object,images:l.object,apiOptions:P.propTypes},D.widgetName="graded-group",D.defaultProps={title:"",content:"",widgets:{},images:{},hint:null};let A=D;const Qe=d.StyleSheet.create({title:{fontSize:18,fontWeight:"bold"},input:{fontSize:18},hintsTitle:{marginTop:10,fontSize:"110%",fontWeight:"bold"}});try{A.displayName="GradedGroupEditor",A.__docgenInfo={description:"",displayName:"GradedGroupEditor",props:{}}}catch{}const F=class F extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.getSaveWarnings=()=>[].concat(...this._editors.map(e=>e?e.getSaveWarnings():[])),this.serialize=()=>({gradedGroups:this.props.gradedGroups}),this.renderGroups=()=>this.props.gradedGroups?this.props.gradedGroups.map((e,t)=>s(A,{ref:i=>this._editors[t]=i,...e,apiOptions:this.props.apiOptions,widgetEnabled:!0,immutableWidgets:!1,onChange:i=>this.change("gradedGroups",Di(this.props.gradedGroups,t,{...this.props.gradedGroups[t],...i}))},t)):null,this.addGroup=()=>{const e=this.props.gradedGroups||[];this.change("gradedGroups",e.concat([A.defaultProps]))}}UNSAFE_componentWillMount(){this._editors=[]}render(){return r("div",{className:"perseus-group-editor",children:[this.renderGroups(),s("button",{onClick:this.addGroup,children:"Add group"})]})}};F.propTypes={...y,apiOptions:P.propTypes,gradedGroups:l.array,onChange:l.func.isRequired},F.widgetName="graded-group-set",F.defaultProps={gradedGroups:[]};let pe=F;const Di=(n,e,t)=>[...n.slice(0,e),t,...n.slice(e+1)];try{pe.displayName="GradedGroupSetEditor",pe.__docgenInfo={description:"",displayName:"GradedGroupSetEditor",props:{}}}catch{}const{InfoTip:Fi,MultiButtonGroup:Hi}=v,{containerSizeClass:Wi,getInteractiveBoxFromSizeClass:ji}=Es,$i=ws.widget,{DEFAULT_GRAPHER_PROPS:Ze,allTypes:Bi,chooseType:Gi,defaultPlotProps:Ki,getEquationString:Ji,typeToButton:Yi}=Cs,H=class H extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.handleAvailableTypesChange=e=>{let t=this.props.correct;if(!p.contains(e,this.props.correct.type)){const i=this.props.graph,a=Gi(e);t=Ki(a,i)}this.props.onChange({availableTypes:e,correct:t})},this.serialize=()=>p.chain(this.props).pick("correct","availableTypes").extend({graph:p.omit(this.props.graph,"box")}).value()}render(){const e=Wi.SMALL;let t,i;if(this.props.graph.valid===!0){const a={graph:this.props.graph,plot:this.props.correct,availableTypes:this.props.availableTypes,onChange:(o,h)=>{var f;let g=this.props.correct;g.type===((f=o.plot)==null?void 0:f.type)?g=p.extend({},g,o.plot):g=o.plot,this.props.onChange({correct:g},h)},trackInteraction:function(){}};i=s($i,{...a,apiOptions:this.props.apiOptions,containerSizeClass:e}),t=Ji(a)}else i=s("div",{className:"perseus-error",children:this.props.graph.valid});return r("div",{children:[r("div",{children:["Correct answer"," ",s(Fi,{children:s("p",{children:"Graph the correct answer in the graph below and ensure the equation or point coordinates displayed represent the correct answer."})})," ",": ",t]}),s(js,{editableSettings:["graph","snap","image"],box:ji(e),range:this.props.graph.range,labels:this.props.graph.labels,step:this.props.graph.step,gridStep:this.props.graph.gridStep,snapStep:this.props.graph.snapStep,valid:this.props.graph.valid,backgroundImage:this.props.graph.backgroundImage,markings:this.props.graph.markings,rulerLabel:this.props.graph.rulerLabel,rulerTicks:this.props.graph.rulerTicks,showTooltips:this.props.graph.showTooltips,onChange:this.change("graph")}),r("div",{className:"perseus-widget-row",children:[s("label",{children:"Available functions: "}),s(Hi,{allowEmpty:!1,values:this.props.availableTypes,buttons:p.map(Bi,Yi),onChange:this.handleAvailableTypesChange})]}),i]})}};H.propTypes={...y},H.widgetName="grapher",H.defaultProps={correct:Ze.plot,graph:Ze.graph,availableTypes:Ze.availableTypes};let he=H;try{he.displayName="GrapherEditor",he.__docgenInfo={description:"",displayName:"GrapherEditor",props:{}}}catch{}const W=class W extends c.Component{constructor(){super(...arguments),this.editor=c.createRef(),this._renderMetadataEditor=()=>{const e=this.props.apiOptions.GroupMetadataEditor;return s(e,{value:this.props.metadata,onChange:this.change("metadata")})},this.change=(...e)=>m.apply(this,e),this.getSaveWarnings=()=>{var e;return(e=this.editor.current)==null?void 0:e.getSaveWarnings()},this.serialize=()=>{var e;return p.extend({},(e=this.editor.current)==null?void 0:e.serialize(),{metadata:this.props.metadata})}}render(){return r("div",{className:"perseus-group-editor",children:[s("div",{children:this._renderMetadataEditor()}),s(b,{ref:this.editor,content:this.props.content,widgets:this.props.widgets,apiOptions:this.props.apiOptions,images:this.props.images,widgetEnabled:!0,immutableWidgets:!1,onChange:this.props.onChange})]})}};W.propTypes={...y,content:l.string,widgets:l.object,images:l.object,metadata:l.any,apiOptions:P.propTypes},W.widgetName="group",W.defaultProps={content:"",widgets:{},images:{},metadata:void 0};let ce=W;try{ce.displayName="GroupEditor",ce.__docgenInfo={description:"",displayName:"GroupEditor",props:{}}}catch{}const{PropCheckBox:zt}=v,je=class je extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.serialize=()=>w.serialize.call(this)}render(){return r("fieldset",{children:[r("label",{children:["Name:",s(S,{value:this.props.name,onChange:this.change("name")})]}),r("label",{children:["Value:",s(S,{value:this.props.value,onChange:this.change("value")})]})]})}};je.propTypes={...y,name:l.string,value:l.string},je.defaultProps={name:"",value:""};let ht=je;const Tt=class Tt extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.handlePairChange=(e,t)=>{const i=this.props.pairs.slice();i[e]=t;const a=i[i.length-1];a.name&&a.value&&i.push({name:"",value:""}),this.change("pairs",i)},this.serialize=()=>w.serialize.call(this)}render(){const e=p.map(this.props.pairs,(t,i)=>s(ht,{name:t.name,value:t.value,onChange:this.handlePairChange.bind(this,i)},i));return s("div",{children:e})}};Tt.propTypes={...y,pairs:l.arrayOf(l.shape({name:l.string,value:l.string})).isRequired};let ct=Tt;const j=class j extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.handleSettingsChange=e=>{this.change({settings:e.pairs})},this.serialize=()=>w.serialize.call(this)}render(){return r("div",{children:[r("div",{style:{fontWeight:"bold",textAlign:"center"},children:["This widget is deprecated! ",s("br",{}),"Try using the Video or CS Program widgets instead."]}),r("label",{children:["Url or Program ID:",s(S,{value:this.props.url,onChange:this.change("url")})]}),s("br",{}),r("label",{children:["Settings:",s(ct,{name:"settings",pairs:this.props.settings,onChange:this.handleSettingsChange})]}),s("br",{}),r("label",{children:["Width:",s(S,{value:this.props.width,onChange:this.change("width")})]}),r("label",{children:["Height:",s(S,{value:this.props.height,onChange:this.change("height")})]}),s(zt,{label:"Allow full screen",allowFullScreen:this.props.allowFullScreen,onChange:this.props.onChange}),s("br",{}),s(zt,{label:"Allow iframe content to redirect the page",allowTopNavigation:this.props.allowTopNavigation,onChange:this.props.onChange})]})}};j.propTypes={...y},j.widgetName="iframe",j.defaultProps={url:"",settings:[{name:"",value:""}],width:"400",height:"400",allowFullScreen:!1,allowTopNavigation:!1};let de=j;try{de.displayName="IframeEditor",de.__docgenInfo={description:"This is the main editor for this widget, to specify all the options.",displayName:"IframeEditor",props:{}}}catch{}const{RangeInput:Xi}=v,Qi=bs.widget,Dt=6,Zi=function(n){const e=[1,1];return p(n).each((t,i)=>{let a=0;p(t).each((o,h)=>{o!=null&&o.toString().length&&(a=h+1)}),e[1]=Math.max(e[1],a),a>0&&(e[0]=Math.max(e[0],i+1))}),e},$=class $ extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.onMatrixBoardSizeChange=e=>{const t=Zi(this.props.answers);if(e[0]!==null&&e[1]!==null){e=[Math.round(Math.min(Math.max(e[0],1),Dt)),Math.round(Math.min(Math.max(e[1],1),Dt))];const i=p(Math.min(e[0],t[0])).times(a=>p(Math.min(e[1],t[1])).times(o=>this.props.answers[a][o]));this.props.onChange({matrixBoardSize:e,answers:i})}},this.serialize=()=>w.serialize.call(this)}render(){const e=p.extend({numericInput:!0,onBlur:()=>{},onFocus:()=>{},trackInteraction:()=>{}},this.props);return r("div",{className:"perseus-matrix-editor",children:[r("div",{className:"perseus-widget-row",children:[" ","Max matrix size:"," ",s(Xi,{value:this.props.matrixBoardSize,onChange:this.onMatrixBoardSizeChange,format:this.props.labelStyle,useArrowKeys:!0})]}),s("div",{className:"perseus-widget-row",children:s(Qi,{...e})}),r("div",{className:"perseus-widget-row",children:[" ","Matrix prefix:"," ",s(b,{ref:"prefix",apiOptions:this.props.apiOptions,content:this.props.prefix,widgetEnabled:!1,onChange:t=>{this.change({prefix:t.content})}})]}),r("div",{className:"perseus-widget-row",children:[" ","Matrix suffix:"," ",s(b,{ref:"suffix",apiOptions:this.props.apiOptions,content:this.props.suffix,widgetEnabled:!1,onChange:t=>{this.change({suffix:t.content})}})]})]})}};$.propTypes={...y,matrixBoardSize:l.arrayOf(l.number).isRequired,answers:l.arrayOf(l.arrayOf(l.number)),prefix:l.string,suffix:l.string,cursorPosition:l.arrayOf(l.number)},$.widgetName="matrix",$.defaultProps={matrixBoardSize:[3,3],answers:[[]],prefix:"",suffix:"",cursorPosition:[0,0]};let ue=$;try{ue.displayName="MatrixEditor",ue.__docgenInfo={description:"",displayName:"MatrixEditor",props:{}}}catch{}const{InfoTip:er,NumberInput:Me,PropCheckBox:Ft,RangeInput:tr}=v,sr={url:null,top:0,left:0},B=class B extends c.Component{constructor(){super(...arguments),this.className="perseus-widget-measurer",this.change=(...e)=>m.apply(this,e),this._changeUrl=e=>{this._changeImage("url",e.target.value)},this._changeTop=e=>{this._changeImage("top",e)},this._changeLeft=e=>{this._changeImage("left",e)},this._changeImage=(e,t)=>{const i=p.clone(this.props.image);i[e]=t,this.change("image",i)},this.renderLabelChoices=e=>p.map(e,function(t){const[i,a]=t;return s("option",{value:a,children:i},a)}),this.serialize=()=>w.serialize.call(this)}render(){const e=p.extend({},sr,this.props.image);return r("div",{className:"perseus-widget-measurer",children:[s("div",{children:"Image displayed under protractor and/or ruler:"}),r("div",{children:["URL:"," ",s("input",{type:"text",className:"perseus-widget-measurer-url",ref:"image-url",defaultValue:e.url,onChange:this._changeUrl}),s(er,{children:s("p",{children:'Create an image in graphie, or use the "Add image" function to create a background.'})})]}),e.url&&r("div",{className:"perseus-widget-row",children:[r("label",{className:"perseus-widget-left-col",children:["Pixels from top:"," ",s(Me,{placeholder:0,onChange:this._changeTop,value:e.top,useArrowKeys:!0})]}),r("label",{className:"perseus-widget-right-col",children:["Pixels from left:"," ",s(Me,{placeholder:0,onChange:this._changeLeft,value:e.left,useArrowKeys:!0})]})]}),r("div",{children:["Containing area [width, height]:"," ",s(tr,{onChange:this.change("box"),value:this.props.box,useArrowKeys:!0})]}),r("div",{className:"perseus-widget-row",children:[s("div",{className:"perseus-widget-left-col",children:s(Ft,{label:"Show ruler",showRuler:this.props.showRuler,onChange:this.props.onChange})}),s("div",{className:"perseus-widget-right-col",children:s(Ft,{label:"Show protractor",showProtractor:this.props.showProtractor,onChange:this.props.onChange})})]}),this.props.showRuler&&r("div",{children:[s("div",{children:r("label",{children:[" ","Ruler label:"," ",r("select",{onChange:t=>this.change("rulerLabel",t.target.value),value:this.props.rulerLabel,children:[s("option",{value:"",children:"None"}),s("optgroup",{label:"Metric",children:this.renderLabelChoices([["milimeters","mm"],["centimeters","cm"],["meters","m"],["kilometers","km"]])}),s("optgroup",{label:"Imperial",children:this.renderLabelChoices([["inches","in"],["feet","ft"],["yards","yd"],["miles","mi"]])})]})]})}),s("div",{children:r("label",{children:[" ","Ruler ticks:"," ",s("select",{onChange:t=>this.change("rulerTicks",+t.target.value),value:this.props.rulerTicks,children:p.map([1,2,4,8,10,16],function(t){return s("option",{value:t,children:t},t)})})]})}),s("div",{children:r("label",{children:["Ruler pixels per unit:"," ",s(Me,{placeholder:40,onChange:this.change("rulerPixels"),value:this.props.rulerPixels,useArrowKeys:!0})]})}),s("div",{children:r("label",{children:["Ruler length in units:"," ",s(Me,{placeholder:10,onChange:this.change("rulerLength"),value:this.props.rulerLength,useArrowKeys:!0})]})})]})]})}};B.widgetName="measurer",B.propTypes={...y,box:l.arrayOf(l.number),image:l.shape({url:l.string,top:l.number,left:l.number}),showProtractor:l.bool,showRuler:l.bool,rulerLabel:l.string,rulerTicks:l.number,rulerPixels:l.number,rulerLength:l.number},B.defaultProps={box:[480,480],image:{},showProtractor:!0,showRuler:!1,rulerLabel:"",rulerTicks:10,rulerPixels:40,rulerLength:10};let ge=B;try{ge.displayName="MeasurerEditor",ge.__docgenInfo={description:"",displayName:"MeasurerEditor",props:{}}}catch{}const{NumberInput:ir,TextInput:rr}=v,$e=class $e extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.updateMolecule=e=>{this.change({smiles:e})},this.updateRotation=e=>{this.change({rotationAngle:e})},this.serialize=()=>w.serialize.call(this)}render(){return r("div",{children:[s("div",{children:r("label",{children:["SMILES:",s(rr,{onChange:this.updateMolecule,value:this.props.smiles})]})}),s("div",{children:r("label",{children:["Rotation (deg):",s(ir,{onChange:this.updateRotation,value:this.props.rotationAngle})]})})]})}};$e.propTypes={...y,rotationAngle:l.number,smiles:l.string},$e.widgetName="molecule-renderer";let me=$e;try{me.displayName="MoleculeWidgetEditor",me.__docgenInfo={description:"",displayName:"MoleculeWidgetEditor",props:{}}}catch{}const{InfoTip:Ee,TextListEditor:Ht}=v,et="normal",Wt="auto",tt="horizontal",jt="vertical",G=class G extends c.Component{constructor(){super(...arguments),this.onOptionsChange=(e,t,i)=>{const a={};a[e]=p.map(t,function(o){return{content:o}}),this.props.onChange(a,i)},this.onLayoutChange=e=>{this.props.onChange({layout:e.target.value})},this.onHeightChange=e=>{this.props.onChange({height:e.target.value})},this.serialize=()=>({options:p.chain(p.pluck(this.props.correctOptions,"content")).union(p.pluck(this.props.otherOptions,"content")).uniq().reject(function(t){return t===""}).sort().sortBy(function(t){return/\d/.test(t)?0:/^\$?[a-zA-Z]+\$?$/.test(t)?2:1}).map(function(t){return{content:t}}).value(),correctOptions:this.props.correctOptions,otherOptions:this.props.otherOptions,height:this.props.height,layout:this.props.layout})}render(){return r("div",{className:"perseus-widget-orderer",children:[r("div",{children:[" ","Correct answer:"," ",s(Ee,{children:s("p",{children:"Place the cards in the correct order. The same card can be used more than once in the answer but will only be displayed once at the top of a stack of identical cards."})})]}),s(Ht,{options:p.pluck(this.props.correctOptions,"content"),onChange:this.onOptionsChange.bind(this,"correctOptions"),layout:this.props.layout}),r("div",{children:[" ","Other cards:"," ",s(Ee,{children:s("p",{children:"Create cards that are not part of the answer."})})]}),s(Ht,{options:p.pluck(this.props.otherOptions,"content"),onChange:this.onOptionsChange.bind(this,"otherOptions"),layout:this.props.layout}),r("div",{children:[r("label",{children:[" ","Layout:"," ",r("select",{value:this.props.layout,onChange:this.onLayoutChange,children:[s("option",{value:tt,children:"Horizontal"}),s("option",{value:jt,children:"Vertical"})]})]}),s(Ee,{children:s("p",{children:"Use the horizontal layout for short text and small images. The vertical layout is best for longer text (e.g. proofs)."})})]}),r("div",{children:[r("label",{children:[" ","Height:"," ",r("select",{value:this.props.height,onChange:this.onHeightChange,children:[s("option",{value:et,children:"Normal"}),s("option",{value:Wt,children:"Automatic"})]})]}),s(Ee,{children:s("p",{children:'Use "Normal" for text, "Automatic" for images.'})})]})]})}};G.propTypes={correctOptions:l.array,otherOptions:l.array,height:l.oneOf([et,Wt]),layout:l.oneOf([tt,jt]),onChange:l.func.isRequired},G.widgetName="orderer",G.defaultProps={correctOptions:[{content:"$x$"}],otherOptions:[{content:"$y$"}],height:et,layout:tt};let fe=G;try{fe.displayName="OrdererEditor",fe.__docgenInfo={description:"",displayName:"OrdererEditor",props:{}}}catch{}const{InfoTip:$t,PropCheckBox:nr}=v,K=class K extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.serialize=()=>w.serialize.call(this)}render(){const e=s(b,{ref:"passage-editor",apiOptions:this.props.apiOptions,content:this.props.passageText,widgetEnabled:!1,placeholder:"Type passage here...",onChange:i=>{this.change({passageText:i.content})},showWordCount:!0}),t=s(b,{ref:"passage-footnotes-editor",apiOptions:this.props.apiOptions,content:this.props.footnotes,widgetEnabled:!1,placeholder:"Type footnotes here...",onChange:i=>{this.change({footnotes:i.content})}});return r("div",{className:"perseus-widget-passage-editor",children:[s("div",{className:"perseus-widget-row",children:s(nr,{label:"Show line numbers",labelAlignment:"right",showLineNumbers:this.props.showLineNumbers,onChange:this.props.onChange})}),r("div",{children:["Passage title:",s($t,{children:s("p",{children:"An optional title that will appear directly above the passage in the same font style. (E.g. Passage 1)"})}),s("div",{children:s("input",{type:"text",defaultValue:this.props.passageTitle,onChange:i=>{this.change({passageTitle:i.target.value})}})})]}),r("div",{children:["Passage Text:",e]}),r("div",{children:["Footnotes:",s($t,{children:s("p",{children:"To add footnotes, add ^ characters where they belong in the passage. Then, add ^ in the footnotes area to reference the footnotes in the passage."})}),t]})]})}};K.propTypes={...y,passageTitle:l.string,passageText:l.string,footnotes:l.string,showLineNumbers:l.bool},K.widgetName="passage",K.defaultProps={passageTitle:"",passageText:"",footnotes:"",showLineNumbers:!0};let ye=K;try{ye.displayName="PassageEditor",ye.__docgenInfo={description:"",displayName:"PassageEditor",props:{}}}catch{}const{InfoTip:ar,NumberInput:Bt,TextInput:or}=v,J=class J extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.serialize=()=>w.serialize.call(this)}render(){return r("div",{children:[s("div",{children:r("label",{children:["Passage Number: ",s(Bt,{value:this.props.passageNumber,onChange:this.change("passageNumber")})]})}),s("div",{children:r("label",{children:["Reference Number: ",s(Bt,{value:this.props.referenceNumber,onChange:this.change("referenceNumber")})]})}),s("div",{children:r("label",{children:["Summary Text: ",s(or,{value:this.props.summaryText,onChange:this.change("summaryText")}),r(ar,{children:[s("p",{children:"Short summary of the referenced section. This will be included in parentheses and quotes automatically."}),s("p",{children:"Ex: The start ... the end"})]})]})})]})}};J.propTypes={...y,passageNumber:l.number,referenceNumber:l.number,summaryText:l.string},J.widgetName="passage-ref",J.defaultProps={passageNumber:1,referenceNumber:1,summaryText:""};let ve=J;try{ve.displayName="PassageRefEditor",ve.__docgenInfo={description:"",displayName:"PassageRefEditor",props:{}}}catch{}const Y=class Y extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.handleContentChange=e=>{this.change({content:e.target.value})},this.serialize=()=>w.serialize.call(this)}render(){return r("div",{children:["Content:",s("input",{type:"text",value:this.props.content,onChange:this.handleContentChange})]})}};Y.propTypes={...y,content:l.string},Y.widgetName="passage-ref-target",Y.defaultProps={content:""};let we=Y;try{we.displayName="PassageRefTargetEditor",we.__docgenInfo={description:"",displayName:"PassageRefTargetEditor",props:{}}}catch{}const{InfoTip:R,NumberInput:Gt,RangeInput:lr,TextListEditor:pr}=v,hr=_s.widget,dt="starting",ut="correct",cr=[dt,ut];function Kt(n,e,t){const i=p.clone(n);i.length=e;for(let a=n.length;a<e;a++)i[a]=t;return i}const Oe={scaleY:1,maxY:10,snapsPerLine:2},Jt=n=>"$"+Is(n,2)+"$",Be=class Be extends c.Component{constructor(){super(...arguments),this.state={editing:this.props.static?dt:ut,pic:null,loadedUrl:null,minX:null,maxX:null,tickStep:null},this.fetchPic=e=>{if(this.state.loadedUrl!==e){const t=new Image;t.src=e,t.onload=()=>{this.setState({pic:t,loadedUrl:e})}}},this.handleChangeTickStep=e=>{this.setState({tickStep:e})},this.handleChangeRange=e=>{this.setState({minX:e[0],maxX:e[1]})},this.changeLabelInterval=e=>{this.props.onChange({labelInterval:e})},this.handlePlotterChange=e=>{const t={};t[this.state.editing]=e.values,this.props.onChange(t)},this.changeType=e=>{let t;if(e==="histogram"?(t=[Jt(0)].concat(this.props.categories),this.props.onChange({type:e,categories:t})):this.props.type==="histogram"?(t=this.props.categories.slice(1),this.props.onChange({type:e,categories:t})):this.props.onChange({type:e}),t){const i=Re.findDOMNode(this.refs.categories);i.value=t.join(", ")}},this.changeLabel=(e,t)=>{const i=p.clone(this.props.labels);i[e]=t.target.value,this.props.onChange({labels:i})},this.changePicUrl=e=>{const t=qe.getRealImageUrl(e);this.props.onChange({picUrl:t})},this.changeCategories=e=>{let t=e.length;this.props.type==="histogram"&&t--;const i=this.props.scaleY;this.props.onChange({categories:e,correct:Kt(this.props.correct,t,i),starting:Kt(this.props.starting,t,i)})},this.changeScale=e=>{const t=this.props.scaleY,i=+e.target.value||Oe.scaleY,a=function(h){return h*i/t},o=a(this.props.maxY);this.props.onChange({scaleY:i,maxY:o,correct:p.map(this.props.correct,a),starting:p.map(this.props.starting,a)}),Re.findDOMNode(this.refs.maxY).value=o},this.changeMax=e=>{this.props.onChange({maxY:+e.target.value||Oe.maxY})},this.changeSnaps=e=>{this.props.onChange({snapsPerLine:+e.target.value||Oe.snapsPerLine})},this.changeEditing=e=>{this.setState({editing:e})},this.setCategoriesFromScale=()=>{const e=this.state.tickStep||1,t=this.state.minX||0,i=this.state.maxX||0,a=Math.floor((i-t)/e)*e;let o;this.props.type==="histogram"||this.props.type==="dotplot"?o=p.range(0,a+e,e):o=p.range(e,a+e,e),o=p.map(o,g=>g+t),o=p.map(o,Jt),this.changeCategories(o);const h=Re.findDOMNode(this.refs.categories);h.value=o.join(", ")},this.serialize=()=>{const e=p.pick(this.props,"correct","starting","type","labels","categories","scaleY","maxY","snapsPerLine","labelInterval");return this.props.type==="pic"&&(e.picUrl=this.props.picUrl),e}}UNSAFE_componentWillMount(){this.fetchPic(this.props.picUrl)}UNSAFE_componentWillReceiveProps(e){this.fetchPic(e.picUrl),e.static&&this.setState({editing:"starting"})}render(){const e=p.contains(["line","histogram","dotplot"],this.props.type),t=!p.contains(["pic","dotplot"],this.props.type),i={trackInteraction:()=>{},...this.props};return r("div",{className:"perseus-widget-plotter-editor",children:[r("div",{children:["Chart type:"," ",Ns.map(a=>r("label",{children:[s("input",{type:"radio",name:"chart-type",checked:this.props.type===a,onChange:p.partial(this.changeType,a)}),a]},a),this)]}),r("div",{children:["Labels:"," ",["x","y"].map((a,o)=>r("label",{children:[a+":",s("input",{type:"text",onChange:p.partial(this.changeLabel,o),defaultValue:this.props.labels[o]})]},a),this)]}),e&&r("div",{className:"set-from-scale-box",children:[s("span",{className:"categories-title",children:"Set Categories From Scale"}),r("div",{children:[r("label",{children:["Tick Step:"," ",s(Gt,{placeholder:1,useArrowKeys:!0,value:this.state.tickStep,onChange:this.handleChangeTickStep})]}),s(R,{children:s("p",{children:"The difference between adjacent ticks."})})]}),s("div",{children:r("label",{children:["Range:"," ",s(lr,{placeholder:[0,10],useArrowKeys:!0,value:[this.state.minX,this.state.maxX],onChange:this.handleChangeRange})]})}),s("div",{children:r("button",{onClick:this.setCategoriesFromScale,children:["Set Categories"," "]})})]}),r("div",{children:[r("label",{children:["Label Interval:"," ",s(Gt,{useArrowKeys:!0,value:this.props.labelInterval,onChange:this.changeLabelInterval})]}),s(R,{children:s("p",{children:'Which ticks to display the labels for. For instance, setting this to "4" will only show every 4th label (plus the last one)'})})]}),this.props.type==="pic"&&r("div",{children:[r("label",{children:["Picture:"," ",s(S,{className:"pic-url",value:this.props.picUrl,onChange:this.changePicUrl}),s(R,{children:s("p",{children:'Use the default picture of Earth, or insert the URL for a different picture using the "Add image" function.'})})]}),this.state.pic&&this.state.pic.width!==this.state.pic.height&&r("p",{className:"warning",children:[s("b",{children:"Warning"}),": You are using a picture which is not square. This means the image will get distorted. You should probably crop it to be square."]})]}),s("div",{children:r("label",{children:["Categories:"," ",s(pr,{ref:"categories",layout:"horizontal",options:this.props.categories,onChange:this.changeCategories})]})}),s("div",{children:r("label",{children:["Scale (y):"," ",s("input",{type:"text",onChange:this.changeScale,defaultValue:this.props.scaleY})]})}),s("div",{children:r("label",{children:["Max y:"," ",s("input",{type:"text",ref:"maxY",onChange:this.changeMax,defaultValue:this.props.maxY})]})}),t&&r("div",{children:[r("label",{children:["Snaps per line:"," ",s("input",{type:"text",onChange:this.changeSnaps,defaultValue:this.props.snapsPerLine})]}),s(R,{children:s("p",{children:"Creates the specified number of divisions between the horizontal lines. Fewer snaps between lines makes the graph easier for the student to create correctly."})})]}),r("div",{children:["Editing values:"," ",cr.map(a=>r("label",{children:[s("input",{type:"radio",disabled:a===ut&&this.props.static,checked:this.props.static?a===dt:this.state.editing===a,onChange:o=>this.changeEditing(a)}),a]},a)),r(R,{children:[s("p",{children:"Use this toggle to switch between editing the correct answer (what the student will be graded on) and the starting values (what the student will see plotted when they start the problem). Note: These cannot be the same."}),s("p",{children:"In static mode, the starting values are rendered out to the displayed widget."})]})]}),s(hr,{...i,starting:this.props[this.state.editing],onChange:this.handlePlotterChange})]})}};Be.widgetName="plotter",Be.defaultProps={...Oe,correct:[1],starting:[1],type:"bar",labels:["",""],categories:[""],picSize:30,picBoxHeight:36,plotDimensions:[275,200],labelInterval:1,get picUrl(){const e=rs().staticUrl;return e?e("/images/badges/earth-small.png"):null}};let Ce=Be;try{Ce.displayName="PlotterEditor",Ce.__docgenInfo={description:"",displayName:"PlotterEditor",props:{type:{defaultValue:{value:"bar"},description:"",name:"type",required:!1,type:{name:"enum",value:[{value:'"line"'},{value:'"bar"'},{value:'"pic"'},{value:'"histogram"'},{value:'"dotplot"'}]}},labels:{defaultValue:{value:'["", ""]'},description:"",name:"labels",required:!1,type:{name:"string[]"}},categories:{defaultValue:{value:'[""]'},description:"",name:"categories",required:!1,type:{name:"readonly (string | number)[]"}},scaleY:{defaultValue:null,description:"",name:"scaleY",required:!0,type:{name:"number"}},maxY:{defaultValue:null,description:"",name:"maxY",required:!0,type:{name:"number"}},snapsPerLine:{defaultValue:null,description:"",name:"snapsPerLine",required:!0,type:{name:"number"}},picSize:{defaultValue:{value:"30"},description:"",name:"picSize",required:!1,type:{name:"number"}},picBoxHeight:{defaultValue:{value:"36"},description:"",name:"picBoxHeight",required:!1,type:{name:"number"}},picUrl:{defaultValue:null,description:"",name:"picUrl",required:!0,type:{name:"string"}},plotDimensions:{defaultValue:{value:"[275, 200]"},description:"",name:"plotDimensions",required:!1,type:{name:"readonly number[]"}},labelInterval:{defaultValue:{value:"1"},description:"",name:"labelInterval",required:!1,type:{name:"number"}},starting:{defaultValue:{value:"[1]"},description:"",name:"starting",required:!1,type:{name:"readonly number[]"}},correct:{defaultValue:{value:"[1]"},description:"",name:"correct",required:!1,type:{name:"readonly number[]"}},static:{defaultValue:null,description:"",name:"static",required:!0,type:{name:"boolean"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"any"}}}}}catch{}class dr extends c.Component{constructor(){super(...arguments),this.focus=()=>(this.refs.input.focus(),!0),this.changeValue=e=>{this.props.onChange(e.target.value)}}render(){return s("textarea",{ref:"input",value:this.props.value||"",onChange:this.changeValue})}}const X=class X extends c.Component{constructor(){super(...arguments),this.input=c.createRef(),this.change=(...e)=>m.apply(this,e),this.focus=()=>{var e;return(e=this.input.current)==null||e.focus(),!0},this.serialize=()=>w.serialize.call(this)}render(){return s("div",{children:r("label",{children:[s("div",{children:"Simple markdown contents:"}),s("div",{children:s(dr,{value:this.props.value,onChange:this.change("value"),ref:this.input})})]})})}};X.propTypes={...y},X.widgetName="simple-markdown-tester",X.defaultProps={value:""};let be=X;try{be.displayName="SimpleMarkdownTesterEditor",be.__docgenInfo={description:"",displayName:"SimpleMarkdownTesterEditor",props:{}}}catch{}const{InfoTip:ur,NumberInput:Yt}=v,gr=xs.widget,Q=class Q extends c.Component{constructor(){super(...arguments),this.numberOfColumns=c.createRef(),this.focus=()=>{var e;(e=this.numberOfColumns.current)==null||e.focus()},this.onSizeInput=(e,t)=>{let i=+e||0,a=+t||0;i=Math.min(Math.max(1,i),30),a=Math.min(Math.max(1,a),6);const o=this.props.columns,h=this.props.rows,g=this.props.answers;i<=h?g.length=i:p(i-h).times(function(){g.push(qe.stringArrayOfSize(o))});function f(_){a<=o?_.length=a:p(a-o).times(function(){_.push("")})}const N=this.props.headers;f(N),p.each(g,f),this.props.onChange({rows:i,columns:a,answers:g,headers:N})},this.serialize=()=>{const e=p.pick(this.props,"headers","rows","columns");return p.extend({},e,{answers:p.map(this.props.answers,p.clone)})}}render(){const e=p.pick(this.props,"headers","answers","onChange","apiOptions");return p.extend(e,{editableHeaders:!0,Editor:b,onFocus:()=>{},onBlur:()=>{},trackInteraction:()=>{}}),r("div",{children:[s("div",{className:"perseus-widget-row",children:r("label",{children:["Number of columns:"," ",s(Yt,{ref:this.numberOfColumns,value:this.props.columns,onChange:t=>{t&&this.onSizeInput(this.props.rows,t)},useArrowKeys:!0})]})}),s("div",{className:"perseus-widget-row",children:r("label",{children:["Number of rows:"," ",s(Yt,{ref:"numberOfRows",value:this.props.rows,onChange:t=>{t&&this.onSizeInput(t,this.props.columns)},useArrowKeys:!0})]})}),r("div",{children:[" ","Table of answers:"," ",s(ur,{children:s("p",{children:"The student has to fill out all cells in the table. For partially filled tables create a table using the template, and insert text input boxes as desired."})})]}),s("div",{children:s(gr,{...e})})]})}};Q.propTypes={rows:l.number,columns:l.number,headers:l.arrayOf(l.string),answers:l.arrayOf(l.arrayOf(l.string))},Q.widgetName="table",Q.defaultProps=function(){const i=p(4).times(function(){return qe.stringArrayOfSize(1)});return{headers:[""],rows:4,columns:1,answers:i}}();let _e=Q;try{_e.displayName="TableEditor",_e.__docgenInfo={description:"",displayName:"TableEditor",props:{}}}catch{}const{InlineIcon:Fe,NumberInput:mr}=v,{iconOk:hs,iconRemove:cs}=Ie,Le="all",V="some",ds=10,fr=function(n,e){return Ts(n,e,-ds,!1)},Xt=function(n){return n.simplify().asMul().partition()[1].flatten().simplify()};class yr extends c.Component{constructor(){super(...arguments),this._checkValidity=({name:e,original:t,sigfigs:i})=>{const a=rt(e);let o="",h=!0;if(a.parsed&&t){const g=new ni("x"),{unit:f}=a,N=new si(t,"=",new ii(g,f));try{const _=N.solveLinearEquationForVariable(g);o=fr(_.eval(),i),h=ri(Xt(t),Xt(f)).equal}catch{h=!1}}else h=!1;this.setState({valid:h,solvedExample:o})}}UNSAFE_componentWillMount(){this._checkValidity(this.props)}UNSAFE_componentWillReceiveProps(e){this._checkValidity(e)}render(){let e;return this.state.valid?e=r("span",{children:[s("span",{className:"unit-example-okay",children:s(Fe,{...hs})}),this.state.solvedExample]}):e=s("span",{className:"unit-example-not-okay",children:s(Fe,{...cs})}),r("div",{children:[e," ",this.props.name]})}}const Z=class Z extends c.Component{constructor(e){super(e),this.change=(...t)=>m.apply(this,t),this.handleAcceptingUnitsChange=t=>{const i=t.target.value.split(",").map(a=>a.trim()).filter(a=>a!=="");this.change({acceptingUnits:i})},this.handleSigfigChange=t=>{this.change({sigfigs:t})},this._checkSigfigValidity=t=>t>0&&t<=ds,this._setAccepting=t=>{this.change({accepting:t})},this._doOriginal=t=>{const i=rt(t.value);this.parsed=!1,i.parsed&&i.type==="unitMagnitude"&&(this.original=i.expr,this.parsed=!0)},this.onChange=t=>{this.props.onChange({value:t.target.value})},this.getSaveWarnings=()=>{const{value:t,accepting:i,acceptingUnits:a}=this.props,o=[];return rt(t).parsed||o.push("Answer did not parse"),i===V&&a.length===0&&o.push("There are no accepted units"),o},this.serialize=()=>w.serialize.call(this),this.groupId=p.uniqueId("accepting"),this._doOriginal(e)}UNSAFE_componentWillReceiveProps(e){this._doOriginal(e)}render(){const{acceptingUnits:e=[],accepting:t}=this.props;let i=null;if(t===V){const a=e.map((o,h)=>s(yr,{name:o,original:this.original||null,sigfigs:this.props.sigfigs},h));i=r("div",{children:[s("input",{type:"text",defaultValue:e.join(", "),onChange:this.handleAcceptingUnitsChange})," ","(comma-separated)",a]})}return r("div",{className:"unit-editor",children:[r("div",{children:[s("input",{value:this.props.value,className:"unit-editor-canonical",onChange:this.onChange})," ",this.parsed?s("span",{className:"unit-example-okay",children:s(Fe,{...hs})}):s("span",{className:"unit-example-not-okay",children:s(Fe,{...cs})})]}),r("div",{children:["Significant Figures:"," ",s(mr,{value:this.props.sigfigs,onChange:this.handleSigfigChange,checkValidity:this._checkSigfigValidity,useArrowKeys:!0})]}),r("div",{children:[r("label",{children:[s("input",{type:"radio",name:this.groupId,onChange:()=>this._setAccepting(Le),checked:this.props.accepting===Le})," Any equivalent unit "]}),r("label",{children:[s("input",{type:"radio",name:this.groupId,onChange:()=>this._setAccepting(V),checked:this.props.accepting===V})," Only these units "]})]}),i]})}};Z.propTypes={...y,value:l.string,acceptingUnits:l.arrayOf(l.string),accepting:l.oneOf([Le,V]),sigfigs:l.number},Z.widgetName="unit-input",Z.defaultProps={value:"5x10^5 kg m / s^2",accepting:Le,sigfigs:3};let Ne=Z;try{Ne.displayName="UnitInputEditor",Ne.__docgenInfo={description:"",displayName:"UnitInputEditor",props:{}}}catch{}const{InfoTip:vr}=v,wr=/khanacademy\.org\/.*\/v\/(.*)$/;function Cr(n){const e=wr.exec(n);return e?e[1]:n}const ee=class ee extends c.Component{constructor(){super(...arguments),this._handleUrlChange=e=>{this.props.onChange({location:Cr(e)})},this.change=(...e)=>m.apply(this,e),this.serialize=()=>w.serialize.call(this)}render(){return s("div",{children:r("label",{children:["KA Video Slug:"," ",s(S,{value:this.props.location,style:{width:290},onChange:this._handleUrlChange}),s(vr,{children:"KA video URLs will be converted to just the slug."})]})})}};ee.propTypes={...y,location:l.string,onChange:l.func},ee.widgetName="video",ee.defaultProps={location:""};let xe=ee;try{xe.displayName="VideoEditor",xe.__docgenInfo={description:"This is the main editor for this widget, to specify all the options.",displayName:"VideoEditor",props:{}}}catch{}const us=[zs,ne,Ds,Fs,oe,le,Hs,Ws,A,pe,he,ce,de,$s,Bs,Gs,Ks,Js,Ys,ue,ge,me,Xs,Qs,fe,ye,ve,we,Ce,Zs,be,ti,_e,Ne,xe,ei,ae];class br extends c.Component{constructor(){super(...arguments),this.input=c.createRef(),this.focus=()=>{var e;return(e=this.input.current)==null||e.focus(),!0},this.changeValue=e=>{this.props.onChange(e.target.value)}}render(){return s("input",{ref:this.input,value:this.props.value||"",onChange:this.changeValue})}}const Ge=class Ge extends c.Component{constructor(){super(...arguments),this.input=c.createRef(),this.change=(...e)=>m.apply(this,e),this.getUserInput=()=>this.props.value,this.focus=()=>{var e;return(e=this.input.current)==null||e.focus(),!0},this.simpleValidate=e=>Ge.validate(this.getUserInput(),e)}static validate(e,t){return e===""?{type:"invalid",message:"It looks like you haven't answered all of the question yet."}:e===t.correct?{type:"points",earned:1,total:1,message:null}:{type:"points",earned:0,total:1,message:null}}render(){return s(br,{ref:this.input,value:this.props.value,onChange:this.change("value")})}};Ge.defaultProps={value:""};let gt=Ge;const _r={name:"example-widget",displayName:"Example Widget",defaultAlignment:"inline-block",hidden:!0,widget:gt};try{examplewidget.displayName="examplewidget",examplewidget.__docgenInfo={description:"For this widget to work, we must import this file in src/all-widgets.js",displayName:"examplewidget",props:{}}}catch{}const Nr=Zt.parse,xr=Zt.basicOutput,Ke=class Ke extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.toJSON=()=>({}),this.focus=()=>(this.refs.input.focus(),!0),this.simpleValidate=e=>Ke.validate(this.toJSON(),e)}static validate(e,t){return{type:"points",earned:0,total:0,message:null}}render(){const e=Nr(this.props.value),t=xr(e);return s("div",{children:t})}};Ke.defaultProps={value:""};let mt=Ke;const Sr={name:"simple-markdown-tester",displayName:"Simple Markdown Tester",hidden:!0,widget:mt,transform:p.identity};try{simplemarkdowntester.displayName="simplemarkdowntester",simplemarkdowntester.__docgenInfo={description:"For this widget to work, we must import this file in src/all-widgets.js",displayName:"simplemarkdowntester",props:{}}}catch{}const Ir=[ps,_r,Sr],gs=[...Ss,...Ir];es(us);ts(gs);ss();is();const Un=()=>{ts(gs),es(us),ss(),is()};export{re as E,Un as r};
