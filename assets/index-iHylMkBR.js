import{t as B,u as z}from"./core-widget-registry-uiKfW1Am.js";import{_ as c}from"./index-default-4_ZsnO94.js";import"./article-editor-ZMd7cj-C.js";import"./device-framer-MUDr0WgQ.js";import"./viewport-resizer-aoxBZI0Q.js";import{j as n}from"./jsx-runtime-63Ea5SlK.js";import{P as s}from"./index-o42urCig.js";import{r as m}from"./index-6oxdNXpR.js";import{w as X}from"./article-renderer-1V26sjLg.js";import"./phet-simulation-CMJUXUZB.js";import{s as Y,b as Z,r as ee,a as se,c as te}from"./renderer-5W1KYZ8O.js";import"./perseus-api-DO0X8arb.js";import"./server-item-renderer-5n1gDC0-.js";import"./hints-renderer-99VOO1xF.js";import"./base-radio-1Hhes3XT.js";import"./button-group-SY8dumRU.js";import"./svg-image-e2j_53PB.js";import"./hud-n-xEkDjs.js";import"./icon-7RFbyLiL.js";import"./index-4SmKKGcF.js";import"./inline-icon-6fh0Wu1y.js";import"./math-input-e7JGlFCJ.js";import"./multi-button-group-3E5hf1eq.js";import"./number-input-pcNA7lkx.js";import"./range-input-qyoPqSPr.js";import"./text-input-yqDH3Bgf.js";import"./text-list-editor-ND6Qift6.js";import"./dependencies-CP7Uh8Kq.js";import"./i18n-context-_hhyRM-i.js";import"./util-gHYooniF.js";import"./jquery-5v7aFUvu.js";import"./index-smZ6iCr_.js";import{T as re}from"./text-diff-OC7Ae0d5.js";import{c as ne}from"./components-3H0VhsK5.js";import{c as v}from"./index-dnMhQZ-1.js";import"./editor-page-3EpHDjRQ.js";import"./editor-nEQ9m1-_.js";import{A as ie}from"./register-all-widgets-and-editors-for-testing-byTd10MF.js";/* empty css                       */const oe="@khanacademy/perseus-editor",ae="__lib_version__";B(oe,ae);const R="unchanged",U="changed",W="added",$="removed",de=function(a,e,t){let r;return a===e?r=R:a===void 0?r=W:e===void 0?r=$:r=U,{after:JSON.stringify(e),before:JSON.stringify(a),children:[],key:t,status:r}},pe=function(a,e,t){const r=c.isObject(a)?c(a).keys():[],i=c.isObject(e)?c(e).keys():[],o=c.union(r,i),p=c.map(o,function(l){return J((a||{})[l],(e||{})[l],l)});let d;return a===void 0?d=W:e===void 0?d=$:d=c.any(p,function(f){return f.status!==R})?U:R,{after:"",before:"",children:p,key:t,status:d}},J=function(a,e,t){return typeof a=="object"||typeof e=="object"?pe(a,e,t):de(a,e,t)},{SvgImage:G}=ne,Q=function(a){return(a-1)*20},j="before",q="after",le="unchanged",S=class S extends m.Component{render(){const e=v(this.props.className,{"diff-row":!0,before:this.props.side===j,after:this.props.side===q});return n.jsx("div",{className:e,children:n.jsxs("div",{style:{paddingLeft:Q(this.props.depth)},children:[this.props.showKey&&this.props.propKey+": ",n.jsx("span",{className:"inner-value dark "+this.props.className,children:this.props.value})]})})}};S.propTypes={className:s.string.isRequired,depth:s.number.isRequired,propKey:s.string.isRequired,showKey:s.bool.isRequired,side:s.oneOf([j,q]).isRequired,value:s.string};let N=S;const O=class O extends m.Component{render(){const e=this;return n.jsx("div",{onClick:e.props.onClick,style:{clear:"both"},children:c.map([j,q],function(t){return n.jsx("div",{className:"diff-row collapsed "+t,children:n.jsx("div",{style:{paddingLeft:Q(e.props.depth)},children:n.jsx("span",{children:" [ show unmodified ] "})})},t)})})}};O.propTypes={depth:s.number,onClick:s.func.isRequired},O.defaultProps={depth:0};let k=O;const b=class b extends m.Component{constructor(){super(...arguments),this.state={expanded:this.props.expanded},this.expand=()=>{this.setState({expanded:!0})}}render(){const e=this.props.entry,t=e.status==="removed",r=e.status==="added",i=e.status==="changed",o=e.children.length>0,p=v({removed:t||i&&!o,dark:t,"blank-space":r}),d=v({added:r||i&&!o,dark:r,"blank-space":t});let l;this.state.expanded?l=e.children:l=c(e.children).select(function(u){return u.status!==le});let f=l.length<e.children.length;e.children.length===l.length+1&&(l=e.children,f=!1);const h=this;return n.jsxs("div",{children:[e.key&&n.jsxs("div",{style:{clear:"both"},children:[n.jsx(N,{side:j,className:p,depth:this.props.depth,propKey:e.key,showKey:!r,value:e.before}),n.jsx(N,{side:q,className:d,depth:this.props.depth,propKey:e.key,showKey:!t,value:e.after})]}),c.map(l,function(u){return n.jsx(b,{depth:h.props.depth+1,entry:u,expanded:h.state.expanded},u.key)}),f&&n.jsx(k,{depth:this.props.depth+1,onClick:this.expand})]})}};b.propTypes={depth:s.number,entry:s.shape({after:s.string,before:s.string,children:s.arrayOf(s.any),key:s.string}),expanded:s.bool},b.defaultProps={depth:0};let A=b;const K=class K extends m.Component{render(){const{before:e,after:t}=this.props,r=e.options&&e.options.backgroundImage?e.options.backgroundImage.url:"",i=t.options&&t.options.backgroundImage?t.options.backgroundImage.url:"";return n.jsxs("div",{children:[n.jsx("div",{className:"diff-row before",children:r&&n.jsx("div",{className:v({image:!0,"image-unchanged":r===i,"image-removed":r!==i}),children:n.jsx(G,{src:r,title:r})})}),n.jsx("div",{className:"diff-row after",children:i&&n.jsx("div",{className:v({image:!0,"image-unchanged":r===i,"image-added":r!==i}),children:n.jsx(G,{src:i,title:i})})})]})}};K.propTypes={after:s.shape({options:s.objectOf(s.any)}).isRequired,before:s.shape({options:s.objectOf(s.any)}).isRequired};let T=K;const P=class P extends m.Component{render(){const{after:e,before:t,title:r,type:i}=this.props,o=J(t,e);return n.jsxs("div",{children:[n.jsx("div",{className:"diff-header",children:r}),n.jsx("div",{className:"diff-header",children:r}),n.jsxs("div",{className:"diff-body ui-helper-clearfix",children:[i==="image"&&n.jsx(T,{before:t,after:e}),n.jsx(A,{entry:o})]})]})}};P.propTypes={after:s.shape({options:s.objectOf(s.any)}),before:s.shape({options:s.objectOf(s.any)}),title:s.string.isRequired,type:s.string},P.defaultProps={after:{},before:{},type:""};let x=P;x.__docgenInfo={description:"",methods:[],displayName:"WidgetDiff",props:{after:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"shape",value:{options:{name:"objectOf",value:{name:"any"},required:!1}}},required:!1},before:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"shape",value:{options:{name:"objectOf",value:{name:"any"},required:!1}}},required:!1},type:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1},title:{description:"",type:{name:"string"},required:!0}}};const I=function(a,e){const{alignment:t,graded:r,options:i,type:o}=a||{},p={options:i};return e&&z(o).length>1&&(p.alignment=t),o==="transformer"&&(p.graded=r),Y(o)&&(p.static=(a==null?void 0:a.static)??void 0),p},V=class V extends m.Component{render(){const{after:e,before:t,showAlignmentOptions:r,showSeparator:i,title:o}=this.props;let p,d;(t.content||e.content)&&(p=n.jsx(re,{before:t.content,after:e.content,title:o}));const l=Object.keys(t.widgets??{}).filter(h=>t.content.includes(h)),f=Object.keys(e.widgets??{}).filter(h=>e.content.includes(h));return(l.length||f.length)&&(d=c.union(l,f).map(u=>{var H,M,_,D;return n.jsx(x,{before:I((H=t.widgets)==null?void 0:H[u],r),after:I((M=e.widgets)==null?void 0:M[u],r),title:u,type:(((_=t.widgets)==null?void 0:_[u])??{}).type||(((D=e.widgets)==null?void 0:D[u])??{}).type},u)})),n.jsxs("div",{children:[p,d,i&&n.jsx("div",{className:"diff-separator"})]})}};V.defaultProps={after:{content:"",images:{},widgets:{}},before:{content:"",images:{},widgets:{}},showAlignmentOptions:!1,showSeparator:!1};let y=V;y.__docgenInfo={description:"",methods:[],displayName:"RendererDiff",props:{after:{required:!1,tsType:{name:"signature",type:"object",raw:`{
    content: string;
    // NOTE: images and widgets may not be set for some items hints,
    // specifically in old revisions, which may only be loaded for diffing.
    widgets: PerseusRenderer["widgets"] | null | undefined;
    images: PerseusRenderer["images"] | null | undefined;
}`,signature:{properties:[{key:"content",value:{name:"string",required:!0}},{key:"widgets",value:{name:"union",raw:'PerseusRenderer["widgets"] | null | undefined',elements:[{name:"signature",raw:'PerseusRenderer["widgets"]'},{name:"null"},{name:"undefined"}],required:!0}},{key:"images",value:{name:"union",raw:'PerseusRenderer["images"] | null | undefined',elements:[{name:"signature",raw:'PerseusRenderer["images"]'},{name:"null"},{name:"undefined"}],required:!0}}]}},description:"",defaultValue:{value:`{
    content: "",
    images: {},
    widgets: {},
}`,computed:!1}},before:{required:!1,tsType:{name:"signature",type:"object",raw:`{
    content: string;
    // NOTE: images and widgets may not be set for some items hints,
    // specifically in old revisions, which may only be loaded for diffing.
    widgets: PerseusRenderer["widgets"] | null | undefined;
    images: PerseusRenderer["images"] | null | undefined;
}`,signature:{properties:[{key:"content",value:{name:"string",required:!0}},{key:"widgets",value:{name:"union",raw:'PerseusRenderer["widgets"] | null | undefined',elements:[{name:"signature",raw:'PerseusRenderer["widgets"]'},{name:"null"},{name:"undefined"}],required:!0}},{key:"images",value:{name:"union",raw:'PerseusRenderer["images"] | null | undefined',elements:[{name:"signature",raw:'PerseusRenderer["images"]'},{name:"null"},{name:"undefined"}],required:!0}}]}},description:"",defaultValue:{value:`{
    content: "",
    images: {},
    widgets: {},
}`,computed:!1}},showAlignmentOptions:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},showSeparator:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},title:{required:!0,tsType:{name:"string"},description:""}}};const w=s.shape({content:s.string,images:s.objectOf(s.any),widgets:s.objectOf(s.any)}),g=class g extends m.Component{constructor(){super(...arguments),this.state=g._stateFromProps(this.props)}UNSAFE_componentWillReceiveProps(e){this.setState(g._stateFromProps(e))}render(){const{before:e,after:t}=this.state,r=Math.max(e.length,t.length),i=c.times(r,o=>n.jsx(y,{before:o<e.length?e[o]:void 0,after:o<t.length?t[o]:void 0,title:`Section ${o+1}`,showAlignmentOptions:!0,showSeparator:o<r-1},o));return n.jsx("div",{className:"framework-perseus",children:i})}};g.propTypes={after:s.oneOfType([w,s.arrayOf(w)]).isRequired,before:s.oneOfType([w,s.arrayOf(w)]).isRequired},g._stateFromProps=e=>{const{before:t,after:r}=e;return{before:Array.isArray(t)?t:[t],after:Array.isArray(r)?r:[r]}};let C=g;C.__docgenInfo={description:"",methods:[{name:"_stateFromProps",docblock:null,modifiers:["static"],params:[{name:"props",optional:!1,type:null}],returns:null}],displayName:"ArticleDiff",props:{after:{description:"",type:{name:"union",value:[{name:"custom",raw:"rendererProps"},{name:"arrayOf",value:{name:"custom",raw:"rendererProps"}}]},required:!0},before:{description:"",type:{name:"union",value:[{name:"custom",raw:"rendererProps"},{name:"arrayOf",value:{name:"custom",raw:"rendererProps"}}]},required:!0}}};const L=s.shape({question:s.shape({}).isRequired,answerArea:s.shape({}).isRequired,hints:s.arrayOf(s.any).isRequired}),F=class F extends m.Component{render(){const{before:e,after:t}=this.props,r=Math.max(e.hints.length,t.hints.length),i=n.jsx(y,{before:e.question,after:t.question,title:"Question",showAlignmentOptions:!1,showSeparator:!0}),o=n.jsx(x,{before:e.answerArea,after:t.answerArea,title:"Question extras"}),p=c.times(r,function(d){return n.jsx(y,{before:d<e.hints.length?e.hints[d]:void 0,after:d<t.hints.length?t.hints[d]:void 0,title:`Hint ${d+1}`,showAlignmentOptions:!1,showSeparator:d<r-1},d)});return n.jsxs("div",{className:"framework-perseus",children:[i,o,p&&n.jsx("div",{className:"diff-separator"}),p]})}};F.propTypes={after:L.isRequired,before:L.isRequired};let E=F;E.__docgenInfo={description:"",methods:[],displayName:"ItemDiff",props:{after:{description:"",type:{name:"custom",raw:"itemProps.isRequired"},required:!1},before:{description:"",type:{name:"custom",raw:"itemProps.isRequired"},required:!1}}};Z(ie);ee(X);se();te();
