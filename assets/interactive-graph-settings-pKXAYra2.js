import{j as t,a as p,F as G}from"./jsx-runtime-BGVbfQ2Z.js";import{B as E}from"./article-renderer-WytaFWjU.js";import{_ as o}from"./index-default-4_ZsnO94.js";import{U as w}from"./util-EDQcR2F7.js";import{c as L}from"./unit-sO4C0-pw.js";import"./dependencies-fnqF3NiV.js";import"./perseus-api-9NPhLZtS.js";import"./multi-renderer-aWTzbvqe.js";import"./hints-renderer--0DzM8gB.js";import"./renderer-ATHLacJe.js";import"./base-radio-jgDAQcNt.js";import{c as z}from"./components-vlL0HFOu.js";import"./jquery-5v7aFUvu.js";import{i as q}from"./constants-I_nlPaPx.js";import"./index-0C4KXdeC.js";import"./i18n-context-9-s9cJ--.js";import{V as S}from"./index-4c2J3ov1.js";import{S as B,O as g}from"./answer-choices-5H3w5lud.js";import{s as c,c as I}from"./index-lUErx3pE.js";import{b as C}from"./index-2Es7CZJJ.js";import{l as _}from"./index-awljIyHI.js";import{r as k}from"./index-qhcEwEpg.js";import{T as U}from"./toggleable-caret-s4JdKAQK.js";const u=b=>{const{children:a,label:e,labelSide:r="left",style:l}=b;return t("label",{className:_.css(R.label),children:p(S,{style:[R.row,l],children:[r==="start"||t(C,{style:R.spaceEnd,children:e}),a,r==="end"&&t(C,{style:R.spaceStart,children:e})]})})},R=_.StyleSheet.create({label:{width:"fit-content"},row:{flexDirection:"row",marginTop:c.xSmall_8,alignItems:"center",width:"fit-content"},spaceStart:{marginInlineStart:c.xSmall_8},spaceEnd:{marginInlineEnd:c.xSmall_8}});try{labeledrow.displayName="labeledrow",labeledrow.__docgenInfo={description:"",displayName:"labeledrow",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},labelSide:{defaultValue:null,description:"",name:"labelSide",required:!1,type:{name:"enum",value:[{value:'"start"'},{value:'"end"'}]}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"any"}}}}}catch{}const{ButtonGroup:F,InfoTip:P,PropCheckBox:N,RangeInput:v}=z,M={url:null,width:0,height:0};function $(b,a){return Math.floor((b[1]-b[0])/a)}function j({title:b,isOpen:a,onToggle:e}){return p(S,{style:{flexDirection:"row",justifyContent:"space-between",backgroundColor:I.offBlack8,padding:c.xSmall_8,marginTop:c.small_12,marginInline:-10,cursor:"pointer"},onClick:()=>e==null?void 0:e(!a),children:[t(C,{children:b}),t(U,{isExpanded:a})]})}const y=class y extends k.Component{constructor(a){super(a),this._isMounted=!1,this.bgUrlRef=k.createRef(),this.labelXRef=k.createRef(),this.labelYRef=k.createRef(),this.change=(...e)=>L.apply(this,e),this.changeRulerLabel=e=>{this.change({rulerLabel:e.target.value})},this.changeRulerTicks=e=>{this.change({rulerTicks:+e.target.value})},this.changeBackgroundUrl=e=>{var i;if(e.type==="keypress"&&e.key!=="Enter")return;const r=(h,n,s)=>{const d={...this.props.backgroundImage};d.url=h,d.width=n,d.height=s,this.setState({backgroundImage:d},this.changeGraph)},l=(i=this.bgUrlRef.current)==null?void 0:i.value;l?w.getImageSize(l,(h,n)=>{this._isMounted&&r(l,h,n)}):r(null,0,0)},this.renderLabelChoices=e=>e.map(r=>t("option",{value:r[1],children:r[0]},r[1])),this.validRange=e=>o.every(e,function(l){return o.isFinite(l)})?e[0]>=e[1]?"Range must have a higher number on the right":!0:"Range must be a valid number",this.validateStepValue=e=>{const{step:r,range:l,name:i,minTicks:h,maxTicks:n}=e,s=$(l,r);return s<h?i+" is too large, there must be at least "+h+" ticks.":s>n?i+" is too small, there can be at most "+n+" ticks.":!0},this.validSnapStep=(e,r)=>this.validateStepValue({step:e,range:r,name:"Snap step",minTicks:5,maxTicks:60}),this.validGridStep=(e,r)=>this.validateStepValue({step:e,range:r,name:"Grid step",minTicks:3,maxTicks:60}),this.validStep=(e,r)=>this.validateStepValue({step:e,range:r,name:"Step",minTicks:3,maxTicks:20}),this.validBackgroundImageSize=e=>e.url?e.width<=450&&e.height<=450?!0:"Image must be smaller than 450px x 450px.":!0,this.validateGraphSettings=(e,r,l,i,h)=>{const n=this;let s;if(!o.every(e,function(f){return s=n.validRange(f),s===!0})||!o.every(r,function(f,x){return s=n.validStep(f,e[x]),s===!0})||!o.every(l,function(f,x){return s=n.validGridStep(f,e[x]),s===!0})||!o.every(i,function(f,x){return s=n.validSnapStep(f,e[x]),s===!0}))return s;const V=this.validBackgroundImageSize(h);return V!==!0?(s=V,s):!0},this.changeLabel=(e,r)=>{const l=r.target.value,i=this.state.labelsTextbox.slice();i[e]=l,this.setState({labelsTextbox:i},this.changeGraph)},this.changeRange=(e,r)=>{const l=this.state.rangeTextbox.slice();l[e]=r;const i=this.state.stepTextbox.slice(),h=this.state.gridStepTextbox.slice(),n=this.state.snapStepTextbox.slice(),s=w.scaleFromExtent(l[e],this.props.box[e]);if(this.validRange(l[e])===!0){i[e]=w.tickStepFromExtent(l[e],this.props.box[e]);const d=w.gridStepFromTickStep(i[e],s);d&&(h[e]=d),n[e]=h[e]/2}this.setState({stepTextbox:i,gridStepTextbox:h,snapStepTextbox:n,rangeTextbox:l},this.changeGraph)},this.changeStep=e=>{this.setState({stepTextbox:e},this.changeGraph)},this.changeSnapStep=e=>{this.setState({snapStepTextbox:e},this.changeGraph)},this.changeGridStep=e=>{this.setState({gridStepTextbox:e,snapStepTextbox:o.map(e,function(r){return r/2})},this.changeGraph)},this.changeGraph=()=>{const e=this.state.labelsTextbox,r=o.map(this.state.rangeTextbox,function(d){return o.map(d,Number)}),l=o.map(this.state.stepTextbox,Number),i=this.state.gridStepTextbox,h=this.state.snapStepTextbox,n=this.state.backgroundImage,s=this.validateGraphSettings(r,l,i,h,n);s===!0?this.change({valid:!0,labels:e,range:r,step:l,gridStep:i,snapStep:h,backgroundImage:n}):this.change({valid:s})},this.state={isExpanded:!0,...y.stateFromProps(a)}}static stateFromProps(a){return{labelsTextbox:a.labels,gridStepTextbox:a.gridStep,snapStepTextbox:a.snapStep,stepTextbox:a.step,rangeTextbox:a.range,backgroundImage:{...a.backgroundImage}}}componentDidMount(){this._isMounted=!0,this.changeGraph=o.debounce(this.changeGraph,300)}UNSAFE_componentWillReceiveProps(a){(!o.isEqual(this.props.labels,a.labels)||!o.isEqual(this.props.gridStep,a.gridStep)||!o.isEqual(this.props.snapStep,a.snapStep)||!o.isEqual(this.props.step,a.step)||!o.isEqual(this.props.range,a.range)||!o.isEqual(this.props.backgroundImage,a.backgroundImage))&&this.setState(y.stateFromProps(a))}componentWillUnmount(){this._isMounted=!1}render(){return p(G,{children:[t(j,{title:"Common Graph Settings",isOpen:this.state.isExpanded,onToggle:()=>this.setState({isExpanded:!this.state.isExpanded})}),this.state.isExpanded&&p(S,{children:[p("div",{className:"graph-settings",children:[p("div",{className:"perseus-widget-row",children:[t("div",{className:"perseus-widget-left-col",children:t(u,{label:"x Label",children:t("input",{type:"text",className:"graph-settings-axis-label",ref:this.labelXRef,onChange:a=>this.changeLabel(0,a),value:this.state.labelsTextbox[0]||""})})}),t("div",{className:"perseus-widget-right-col",children:t(u,{label:"y Label",children:t("input",{type:"text",className:"graph-settings-axis-label",ref:this.labelYRef,onChange:a=>this.changeLabel(1,a),value:this.state.labelsTextbox[1]||""})})})]}),p("div",{className:"perseus-widget-row",children:[t("div",{className:"perseus-widget-left-col",children:t(u,{label:"x Range",children:t(v,{value:this.state.rangeTextbox[0],onChange:a=>this.changeRange(0,a)})})}),t("div",{className:"perseus-widget-right-col",children:t(u,{label:"y Range",children:t(v,{value:this.state.rangeTextbox[1],onChange:a=>this.changeRange(1,a)})})})]}),p("div",{className:"perseus-widget-row",children:[t("div",{className:"perseus-widget-left-col",children:t(u,{label:"Tick Step",children:t(v,{value:this.state.stepTextbox,onChange:this.changeStep})})}),t("div",{className:"perseus-widget-right-col",children:t(u,{label:"Grid Step",children:t(v,{value:this.state.gridStepTextbox,onChange:this.changeGridStep})})})]}),t("div",{className:"perseus-widget-row",children:t("div",{className:"perseus-widget-left-col",children:t(u,{label:"Snap Step",children:t(v,{value:this.state.snapStepTextbox,onChange:this.changeSnapStep})})})}),t("div",{className:"perseus-widget-row",children:t(u,{label:"Markings:",children:t(F,{value:this.props.markings,allowEmpty:!1,buttons:[{value:"graph",content:"Graph"},{value:"grid",content:"Grid"},{value:"none",content:"None"}],onChange:this.change("markings")})})}),t("div",{className:"perseus-widget-left-col",children:t(N,{label:"Show tooltips",showTooltips:this.props.showTooltips,onChange:this.change})})]}),p(u,{label:"Background image URL:",style:m.resetSpaceTop,children:[t("input",{type:"text",className:_.css(m.backgroundUrlInput),ref:this.bgUrlRef,value:this.state.backgroundImage.url||"",onChange:a=>{const e={...this.props.backgroundImage};e.url=a.target.value,this.setState({backgroundImage:e})},onKeyPress:this.changeBackgroundUrl,onBlur:this.changeBackgroundUrl}),t(P,{children:t("p",{children:'Create an image in graphie, or use the "Add image" function to create a background.'})})]}),p(S,{style:m.rulerSection,children:[p(S,{style:m.checkboxRow,children:[t(N,{label:"Show ruler",showRuler:this.props.showRuler,onChange:this.change,style:m.resetSpaceTop}),t(N,{label:"Show protractor",showProtractor:this.props.showProtractor,onChange:this.change,style:m.resetSpaceTop})]}),(this.props.showRuler||this.props.showProtractor)&&t(E,{layout:"floating",text:"The ruler and protractor are not accessible. Please consider an alternate approach.",kind:"warning"}),this.props.showRuler&&p(S,{style:m.spaceTop,children:[t(u,{label:"Ruler label:",style:m.resetSpaceTop,children:p(B,{id:"ruler-label-select",selectedValue:this.props.rulerLabel,onChange:a=>{this.change({rulerLabel:a})},placeholder:"None",style:m.singleSelectShort,children:[t(g,{value:"",label:"None",horizontalRule:"full-width"}),t(g,{value:"mm",label:"Milimeters"}),t(g,{value:"cm",label:"Centimeters"}),t(g,{value:"m",label:"Meters"}),t(g,{value:"km",label:"Kilometers",horizontalRule:"full-width"}),t(g,{value:"in",label:"Inches"}),t(g,{value:"ft",label:"Feet"}),t(g,{value:"yd",label:"Yards"}),t(g,{value:"mi",label:"Miles"})]})}),t(u,{label:"Ruler ticks:",children:t(B,{id:"ruler-ticks-select",selectedValue:`${this.props.rulerTicks}`,onChange:a=>{this.change({rulerTicks:a})},placeholder:"10",style:m.singleSelectShort,children:[1,2,4,8,10,16].map(a=>t(g,{value:`${a}`,label:`${a}`},a))})})]})]})]})]})}};y.defaultProps={box:[q.defaultBoxSizeSmall,q.defaultBoxSizeSmall],labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],gridStep:[1,1],snapStep:[1,1],valid:!0,backgroundImage:M,markings:"graph",showProtractor:!1,showRuler:!1,showTooltips:!1,rulerLabel:"",rulerTicks:10};let T=y;const m=_.StyleSheet.create({resetSpaceTop:{marginTop:0},spaceTop:{marginTop:c.xSmall_8},singleSelectShort:{height:26},backgroundUrlInput:{border:`1px solid ${I.offBlack32}`,borderRadius:c.xxxSmall_4,padding:c.xxxSmall_4},checkboxRow:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:c.xSmall_8},rulerSection:{marginTop:c.xSmall_8,borderTop:`1px solid ${I.offBlack16}`,paddingTop:c.xSmall_8,paddingBottom:c.xSmall_8,borderBottom:`1px solid ${I.offBlack16}`}}),me=T;try{T.displayName="InteractiveGraphSettings",T.__docgenInfo={description:"",displayName:"InteractiveGraphSettings",props:{box:{defaultValue:{value:`[
            interactiveSizes.defaultBoxSizeSmall,
            interactiveSizes.defaultBoxSizeSmall,
        ]`},description:"The size of the graph area in pixels.",name:"box",required:!1,type:{name:"[x: number, y: number]"}},labels:{defaultValue:{value:'["x", "y"]'},description:"The labels for the x and y axes.",name:"labels",required:!1,type:{name:"readonly string[]"}},range:{defaultValue:{value:`[
            [-10, 10],
            [-10, 10],
        ]`},description:"The range of the graph.",name:"range",required:!1,type:{name:"[x: Range, y: Range]"}},step:{defaultValue:{value:"[1, 1]"},description:`How far apart the tick marks on the axes are in the x and y
directions.`,name:"step",required:!1,type:{name:"[x: number, y: number]"}},gridStep:{defaultValue:{value:"[1, 1]"},description:"How far apart the grid lines are in the x and y directions.",name:"gridStep",required:!1,type:{name:"[x: number, y: number]"}},snapStep:{defaultValue:{value:"[1, 1]"},description:"How far apart the snap-to points are in the x and y directions.",name:"snapStep",required:!1,type:{name:"[x: number, y: number]"}},valid:{defaultValue:{value:"true"},description:`An error message to display in the graph area, or true if the
graph is valid.`,name:"valid",required:!1,type:{name:"string | boolean"}},backgroundImage:{defaultValue:{value:`{
    url: null,
    width: 0,
    height: 0,
} as const`},description:"The background image to display in the graph area and its properties.",name:"backgroundImage",required:!1,type:{name:"PerseusImageBackground"}},markings:{defaultValue:{value:"graph"},description:`The type of markings to display on the graph.
- graph: shows the axes and the grid lines
- grid: shows only the grid lines
- none: shows no markings`,name:"markings",required:!1,type:{name:"enum",value:[{value:'"graph"'},{value:'"grid"'},{value:'"none"'}]}},showProtractor:{defaultValue:{value:"false"},description:"Whether to show the protractor on the graph.",name:"showProtractor",required:!1,type:{name:"boolean"}},showRuler:{defaultValue:{value:"false"},description:"Whether to show the ruler on the graph.",name:"showRuler",required:!1,type:{name:"boolean"}},showTooltips:{defaultValue:{value:"false"},description:"Whether to show tooltips on the graph.",name:"showTooltips",required:!1,type:{name:"boolean"}},rulerLabel:{defaultValue:{value:""},description:"The label to display on the ruler, if any.",name:"rulerLabel",required:!1,type:{name:"string"}},rulerTicks:{defaultValue:{value:"10"},description:"The number of ticks to display on the ruler.",name:"rulerTicks",required:!1,type:{name:"number"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(arg1: Partial<Props>) => void"}}}}}catch{}export{me as I,u as L};
