import{j as h}from"./jsx-runtime-63Ea5SlK.js";import"./underscore-H6_Y1mVe.js";import{e as d,U as f,K as c}from"./util-Jthj9rdu.js";import"./version-akiLXZts.js";import{P as y,E as g}from"./perseus-error-l3K_anoI.js";import{_ as a}from"./index-default-4_ZsnO94.js";import{c as v}from"./index-dnMhQZ-1.js";import{P as n}from"./index-o42urCig.js";import{r as i}from"./index-6oxdNXpR.js";import{P as k}from"./i18n-context-JRliD99t.js";const{firstNumericalParse:u,captureScratchpadTouchStart:_}=f,p=c.toNumericString,V=c.getNumericFormat,l=class l extends i.Component{constructor(){super(...arguments),this.inputRef=i.createRef(),this.state={format:this.props.format},this._getInput=()=>{if(!this.inputRef.current)throw new y("Input ref accessed before set",g.Internal);return this.inputRef.current},this.getValue=()=>this.parseInputValue(this._getInput().value),this.getStringValue=()=>this._getInput().toString(),this.parseInputValue=e=>{if(e===""){const s=this.props.placeholder;return a.isFinite(s)?+s:null}const t=u(e,this.context.strings);return a.isFinite(t)?t:this.props.value},this.focus=()=>{this._getInput().focus(),this._handleFocus()},this.blur=()=>{this._getInput().blur(),this._handleBlur()},this.setSelectionRange=(e,t)=>{this._getInput().setSelectionRange(e,t)},this.getSelectionStart=()=>this._getInput().selectionStart,this.getSelectionEnd=()=>this._getInput().selectionEnd,this._checkValidity=e=>{if(e==null)return!0;const t=u(e,this.context.strings),s=this.props.checkValidity;return a.isFinite(t)&&s(t)},this._handleChange=e=>{const t=e.target.value,s=this.parseInputValue(t),r=V(t);this.props.onChange(s),r&&(this.props.onFormatChange(s,r),this.setState({format:r}))},this._handleFocus=()=>{this.props.onFocus&&this.props.onFocus()},this._handleBlur=e=>{e&&e.type==="keypress"&&e.keyCode!==13||(this._setValue(this.props.value,this.state.format),this.props.onBlur&&this.props.onBlur())},this._onKeyDown=e=>{if(this.props.onKeyDown&&this.props.onKeyDown(e),!this.props.useArrowKeys||!a.contains(["ArrowUp","ArrowDown"],e.key))return;let t=this.getValue();t===Math.floor(t)&&(e.key==="ArrowUp"?t=t+1:e.key==="ArrowDown"&&(t=t-1),this._checkValidity(t)&&this.props.onChange(t))},this._setValue=(e,t)=>{this._getInput().value=p(e,t)}}componentDidUpdate(e){d(this.getValue(),this.props.value)||this._setValue(this.props.value,this.state.format)}render(){let e=v({"number-input":!0,"invalid-input":!this._checkValidity(this.props.value),mini:this.props.size==="mini",small:this.props.size==="small",normal:this.props.size==="normal"});this.props.className!=null&&(e=e+" "+this.props.className);const{onFormatChange:t,checkValidity:s,useArrowKeys:r,...m}=this.props;return h.jsx("input",{...m,className:e,type:"text",ref:this.inputRef,onChange:this._handleChange,onFocus:this._handleFocus,onBlur:this._handleBlur,onKeyPress:this._handleBlur,onKeyDown:this._onKeyDown,onTouchStart:_,defaultValue:p(this.props.value,this.state.format),value:void 0})}};l.contextType=k,l.propTypes={value:n.number,format:n.string,placeholder:n.oneOfType([n.string,n.number]),onChange:n.func.isRequired,onFormatChange:n.func,checkValidity:n.func,size:n.oneOf(["mini","small","normal"]),label:n.oneOf(["put your labels outside your inputs!"])},l.defaultProps={value:null,placeholder:null,format:null,onFormatChange:()=>null,checkValidity:()=>!0,useArrowKeys:!1};let o=l;o.__docgenInfo={description:'An input box that accepts only numeric strings\n\nCalls `onChange(value, format)` for valid numbers.\n\nReverts to the current value `onBlur` or on [ENTER],\n  but maintains the format (i.e. 3/2, 1 1/2, 150%)\n\nAccepts empty input and sends it to `onChange` as `null` if no numeric\nplaceholder is set.\n\nIf given a `checkValidity` function, will turn the background/outline red\nwhen invalid.\n\nIf `useArrowKeys` is set to `true`, up/down arrows will increment/decrement\nintegers.\n\nOptionally takes a `size` (`"mini"`, `"small"`,` `"normal"`)',methods:[{name:"_getInput",docblock:null,modifiers:[],params:[],returns:null},{name:"getValue",docblock:null,modifiers:[],params:[],returns:null},{name:"getStringValue",docblock:null,modifiers:[],params:[],returns:null},{name:"parseInputValue",docblock:null,modifiers:[],params:[{name:"value",optional:!1,type:null}],returns:null},{name:"focus",docblock:null,modifiers:[],params:[],returns:null},{name:"blur",docblock:null,modifiers:[],params:[],returns:null},{name:"setSelectionRange",docblock:null,modifiers:[],params:[{name:"selectionStart",optional:!1,type:null},{name:"selectionEnd",optional:!1,type:null}],returns:null},{name:"getSelectionStart",docblock:null,modifiers:[],params:[],returns:null},{name:"getSelectionEnd",docblock:null,modifiers:[],params:[],returns:null},{name:"_checkValidity",docblock:null,modifiers:[],params:[{name:"value",optional:!1,type:null}],returns:null},{name:"_handleChange",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:null}],returns:null},{name:"_handleFocus",docblock:null,modifiers:[],params:[],returns:null},{name:"_handleBlur",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:null}],returns:null},{name:"_onKeyDown",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:null}],returns:null},{name:"_setValue",docblock:null,modifiers:[],params:[{name:"val",optional:!1,type:null},{name:"format",optional:!1,type:null}],returns:null}],displayName:"NumberInput",props:{value:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"number"},required:!1},placeholder:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"union",value:[{name:"string"},{name:"number"}]},required:!1},format:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"string"},required:!1},onFormatChange:{defaultValue:{value:"() => null",computed:!1},description:"",type:{name:"func"},required:!1},checkValidity:{defaultValue:{value:"() => true",computed:!1},description:"",type:{name:"func"},required:!1},useArrowKeys:{defaultValue:{value:"false",computed:!1},required:!1},onChange:{description:"",type:{name:"func"},required:!0},size:{description:"",type:{name:"enum",value:[{value:'"mini"',computed:!1},{value:'"small"',computed:!1},{value:'"normal"',computed:!1}]},required:!1},label:{description:"",type:{name:"enum",value:[{value:'"put your labels outside your inputs!"',computed:!1}]},required:!1}}};export{o as N};
