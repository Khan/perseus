import{_ as F,p as w}from"./underscore-H6_Y1mVe.js";import{$ as h}from"./jquery-5v7aFUvu.js";import"./version-akiLXZts.js";import{P as y,E as A}from"./perseus-error-l3K_anoI.js";import{_ as p}from"./index-default-4_ZsnO94.js";const C=function(e,t,r={}){const s={...{form:!1,simplify:!1},...r},n=e.sameVars(t);if(!n.equal){let i;return n.equalIgnoringCase?i="Check your variables; one or more are using the wrong case (upper or lower).":i="Check your variables; you may have used the wrong letter for one or more of them.",{equal:!1,wrongVariableCase:n.equalIgnoringCase,wrongVariableNames:!n.equalIgnoringCase,message:i}}return e.compare(t)?s.form&&!e.sameForm(t)?{equal:!1,message:"Your answer is not in the correct form."}:s.simplify&&!e.isSimplified()?{equal:!1,message:"Your answer is not fully expanded and simplified."}:{equal:!0,message:null}:{equal:!1,message:null}},Y=1e-9,k=Math.pow(2,-42);function Ge(e){return F.isNumber(e)&&!F.isNaN(e)}function I(e,t,r){return e==null||t==null?e===t:e===t?!0:(r==null&&(r=Y),Math.abs(e-t)<r)}function qe(e,t){return I(e,0,t)?0:Math.abs(e)/e}function H(e,t){return I(Math.round(e),e,t)}function We(e,t){const r=Math.pow(10,t);return Math.round(e*r)/r}function Ue(e,t){return Math.round(e/t)*t}function Ve(e,t){return Math.floor(e/t)*t}function Xe(e,t){return Math.ceil(e/t)*t}function L(e,t=k,r=1e3){let a=[1,0],s=[0,1],n=Math.floor(e),i=e-n;for(;s[0]<=r;){if(I(a[0]/s[0],e,t))return[a[0],s[0]];a=[n*a[0]+a[1],a[0]],s=[n*s[0]+s[1],s[0]],n=Math.floor(1/i),i=1/i-n}return[e,1]}const d={cleanMath:function(e){return typeof e=="string"?e.replace(/\+\s*-/g,"- ").replace(/-\s*-/g,"+ ").replace(/\^1/g,""):e},bound:function(e){return e===0?e:e<0?-d.bound(-e):Math.max(1e-6,Math.min(e,1e20))},factorial:function(e){return e<=1?e:e*d.factorial(e-1)},getGCD:function(e,t){if(arguments.length>2){const a=[].slice.call(arguments,1);return d.getGCD(e,d.getGCD(...a))}let r;for(e=Math.abs(e),t=Math.abs(t);t;)r=e%t,e=t,t=r;return e},getLCM:function(e,t){if(arguments.length>2){const r=[].slice.call(arguments,1);return d.getLCM(e,d.getLCM(...r))}return Math.abs(e*t)/d.getGCD(e,t)},primes:[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97],isPrime:function(e){if(e<=1)return!1;if(e<101)return!!h.grep(d.primes,function(t,r){return Math.abs(t-e)<=.5}).length;if(e<=1||e>2&&e%2===0)return!1;for(let t=3,r=Math.sqrt(e);t<=r;t+=2)if(e%t===0)return!1;return!0},getPrimeFactorization:function(e){if(e===1)return[];if(d.isPrime(e))return[e];const t=Math.sqrt(e);for(let r=2;r<=t;r++)if(e%r===0)return h.merge(d.getPrimeFactorization(r),d.getPrimeFactorization(e/r))},roundToNearest:function(e,t){return Math.round(t/e)*e},roundTo:function(e,t){const r=Math.pow(10,e).toFixed(5);return Math.round((t*r).toFixed(5))/r},toFixedApprox:function(e,t){const r=e.toFixed(t);return I(+r,e)?r:"\\approx "+r},roundToApprox:function(e,t){const r=d.roundTo(t,e);return I(r,e)?String(r):d.toFixedApprox(e,t)},toFraction:function(e,t){if(t==null&&(t=Math.pow(2,-46)),e<0||e>1){let f=e%1;f+=f<0?1:0;const u=d.toFraction(f,t);return u[0]+=Math.round(e-f)*u[1],u}if(Math.abs(Math.round(Number(e))-e)<=t)return[Math.round(e),1];let r=0,a=1,s=1,n=1,i=1,o=2;for(;;){if(Math.abs(Number(i/o)-e)<=t)return[i,o];i/o<e?(r=i,a=o):(s=i,n=o),i=r+s,o=a+n}},getNumericFormat:function(e){if(e=h.trim(e),e=e.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1"),e.match(/^[+-]?\d+$/))return"integer";if(e.match(/^[+-]?\d+\s+\d+\s*\/\s*\d+$/))return"mixed";const t=e.match(/^[+-]?(\d+)\s*\/\s*(\d+)$/);return t?parseFloat(t[1])>parseFloat(t[2])?"improper":"proper":e.replace(/[,. ]/g,"").match(/^\d+$/)?"decimal":e.match(/(pi?|\u03c0|t(?:au)?|\u03c4|pau)/)?"pi":null},toNumericString:function(e,t){if(e==null)return"";if(e===0)return"0";if(t==="percent")return e*100+"%";if(t==="pi"){const r=L(e/Math.PI),a=Math.abs(r[0]),s=r[1];if(H(a))return(e<0?"-":"")+(a===1?"":a)+"π"+(s===1?"":"/"+s)}if(F(["proper","improper","mixed","fraction"]).contains(t)){const r=L(e),a=Math.abs(r[0]),s=r[1],n=e<0?"-":"";if(s===1)return n+a;if(t==="mixed"){const i=a%s,o=(a-i)/s;return n+(o?o+" ":"")+i+"/"+s}return n+a+"/"+s}return String(e)}};function ze(e){return e.reduce(K,0)}function K(e,t){return e+t}const Q="MISSING_PERCENT_ERROR",Z="NEEDS_TO_BE_SIMPLIFIED_ERROR",J="APPROXIMATED_PI_ERROR",x="EXTRA_SYMBOLS_ERROR",ee="WRONG_CASE_ERROR",te="WRONG_LETTER_ERROR",re="MULTIPLICATION_SIGN_ERROR",R={MISSING_PERCENT_ERROR:Q,NEEDS_TO_BE_SIMPLIFIED_ERROR:Z,APPROXIMATED_PI_ERROR:J,EXTRA_SYMBOLS_ERROR:x,WRONG_CASE_ERROR:ee,WRONG_LETTER_ERROR:te,MULTIPLICATION_SIGN_ERROR:re},ne=Math.pow(2,-42),E={predicate:{defaultForms:"integer, proper, improper, mixed, decimal",createValidatorFunctional:function(e,t){t=p.extend({simplify:"required",ratio:!1,forms:E.predicate.defaultForms},t);let r;p.isArray(t.forms)?r=t.forms:r=t.forms.split(/\s*,\s*/),t.inexact===void 0&&(t.maxError=0),t.maxError=+t.maxError+ne,p.contains(r,"percent")&&(r=p.without(r,"percent"),r.push("percent"));const a=function(n){n=n.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").replace(/(^\s*)|(\s*$)/gi,"");const i=n.match(/^([+-]?\d+)\s*\/\s*([+-]?\d+)$/),o=n.match(/^([+-]?)\\frac\{([+-]?\d+)\}\{([+-]?\d+)\}$/),f=parseInt(n,10);if(i||o){let u,l,c=!0;return i?(u=parseFloat(i[1]),l=parseFloat(i[2])):(u=parseFloat(o[2]),o[1]==="-"&&(u<0&&(c=!1),u=-u),l=parseFloat(o[3])),c=c&&l>0&&(t.ratio||l!==1)&&d.getGCD(u,l)===1,[{value:u/l,exact:c}]}return!isNaN(f)&&""+f===n?[{value:f,exact:!0}]:[]},s={integer:function(n){const i=s.decimal(n),o=s.decimal(n,1);return i[0].value!=null&&i[0].value===o[0].value||i[1].value!=null&&i[1].value===o[1].value?i:[]},proper:function(n){return h.map(a(n),function(i){return Math.abs(i.value)<1?[i]:[]})},improper:function(n){return h.map(a(n),function(i){return Math.abs(i.value)>=1?[i]:[]})},pi:function(n){let i,o=[];if(n=n.replace(/\u2212/,"-"),i=n.match(/^([+-]?)\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i))o=[{value:parseFloat(i[1]+"1"),exact:!0}];else if(i=n.match(/^([+-]?\s*\d+\s*(?:\/\s*[+-]?\s*\d+)?)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i))o=a(i[1]);else if(i=n.match(/^([+-]?)\s*(\d+)\s*([+-]?\d+)\s*\/\s*([+-]?\d+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i)){const u=parseFloat(i[1]+"1"),l=parseFloat(i[2]),c=parseFloat(i[3]),m=parseFloat(i[4]),M=c<m&&d.getGCD(c,m)===1;o=[{value:u*(l+c/m),exact:M}]}else if(i=n.match(/^([+-]?\s*\d+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)\s*(?:\/\s*([+-]?\s*\d+))?$/i))o=a(i[1]+"/"+i[3]);else if(i=n.match(/^([+-]?)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)\s*(?:\/\s*([+-]?\d+))?$/i))o=a(i[1]+"1/"+i[3]);else if(n==="0")o=[{value:0,exact:!0}];else if(i=n.match(/^(.+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i))o=s.decimal(i[1]);else{o=p.reduce(E.predicate.defaultForms.split(/\s*,\s*/),function(c,m){return c.concat(s[m](n))},[]);let u=!1;const l=parseFloat(n);if(!isNaN(l)&&l!==parseInt(n)){const c=Math.PI/12,m=c*Math.round(l/c);Math.abs(l-m)<.01&&(u=!0)}else n.match(/\/\s*7/)&&(u=!0);return u&&p.each(o,function(c){c.piApprox=!0}),o}let f=Math.PI;return n.match(/\\?tau|t|\u03c4/)&&(f=Math.PI*2),n.match(/pau/)&&(f=Math.PI*1.5),h.each(o,function(u,l){l.value*=f}),o},coefficient:function(n){let i=[];return n=n.replace(/\u2212/,"-"),n===""?i=[{value:1,exact:!0}]:n==="-"&&(i=[{value:-1,exact:!0}]),i},log:function(n){let i,o=[];return n=n.replace(/\u2212/,"-"),n=n.replace(/[ \(\)]/g,""),(i=n.match(/^log\s*(\S+)\s*$/i))?o=s.decimal(i[1]):n==="0"&&(o=[{value:0,exact:!0}]),o},percent:function(n){n=h.trim(n);let i=!1;n.indexOf("%")===n.length-1&&(n=h.trim(n.substring(0,n.length-1)),i=!0);const o=s.decimal(n);return h.each(o,function(f,u){u.exact=i,u.value=u.value/100}),o},mixed:function(n){const i=n.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").match(/^([+-]?)(\d+)\s+(\d+)\s*\/\s*(\d+)$/);if(i){const o=parseFloat(i[1]+"1"),f=parseFloat(i[2]),u=parseFloat(i[3]),l=parseFloat(i[4]),c=u<l&&d.getGCD(u,l)===1;return[{value:o*(f+u/l),exact:c}]}return[]},decimal:function(n,i=1e10){const o=function(u){u=h.trim(u);const l=u.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").match(/^([+-]?(?:\d{1,3}(?:[, ]?\d{3})*\.?|\d{0,3}(?:[, ]?\d{3})*\.(?:\d{3}[, ]?)*\d{1,3}))$/),c=u.match(/^0[0,]*,/);if(l&&!c){let m=parseFloat(l[1].replace(/[, ]/g,""));return t.inexact===void 0&&(m=Math.round(m*i)/i),m}},f=function(u){return u=u.replace(/([\.,])/g,function(l,c){return c==="."?",":"."}),o(u)};return[{value:o(n),exact:!0},{value:f(n),exact:!0}]}};return function(n){const i=t.fallback!=null?""+t.fallback:"";n=h.trim(n)||i;const o={empty:n==="",correct:!1,message:null,guess:n};if(h.each(r,function(f,u){const l=s[u](n);for(let c=0,m=l.length;c<m;c++){const M=l[c].value,B=l[c].exact,j=l[c].piApprox;if(e(M,t.maxError))return B||t.simplify==="optional"?(o.correct=!0,o.message=t.message||null,o.empty=!1):u==="percent"?(o.empty=!0,o.message=R.MISSING_PERCENT_ERROR):(t.simplify!=="enforced"&&(o.empty=!0),o.message=R.NEEDS_TO_BE_SIMPLIFIED_ERROR),!1;j&&e(M,Math.abs(M*.001))&&(o.empty=!0,o.message=R.APPROXIMATED_PI_ERROR)}}),o.correct===!1){let f=!1;if(p.each(s,function(u){p.any(u(n),function(c){return c.value!=null&&!p.isNaN(c.value)})&&(f=!0)}),!f)return o.empty=!0,o.message=R.EXTRA_SYMBOLS_ERROR,o}return o}}},number:{convertToPredicate:function(e,t){const r=parseFloat(e);return[function(a,s){return Math.abs(a-r)<s},h.extend({},t,{type:"predicate"})]},createValidatorFunctional:function(e,t){return E.predicate.createValidatorFunctional(...E.number.convertToPredicate(e,t))}},expression:{parseSolution:function(e,t){let r=w(e,t);if(r.parsed){if(t.simplified&&!r.expr.isSimplified())throw new y("The provided solution ("+e+") isn't fully expanded and simplified.",A.InvalidInput);r=r.expr}else throw new y("The provided solution ("+e+") didn't parse.",A.InvalidInput);return r},createValidatorFunctional:function(e,t){return function(r){const a={empty:!1,correct:!1,message:null,guess:r,ungraded:!1};if(!r)return a.empty=!0,a;const s=w(r,t);if(!s.parsed)return a.empty=!0,a;typeof e=="string"&&(e=E.expression.parseSolution(e,t));const n=C(s.expr,e,t);if(n.equal)a.correct=!0;else if(n.wrongVariableNames||n.wrongVariableCase)a.ungraded=!0,a.message=n.wrongVariableCase?R.WRONG_CASE_ERROR:R.WRONG_LETTER_ERROR,a.suppressAlmostThere=!0;else if(n.message)a.message=n.message;else{const i=w(r.replace(/[xX]/g,"*"),t);if(i.parsed){const o=C(i.expr,e,t);o.equal?(a.ungraded=!0,a.message=R.MULTIPLICATION_SIGN_ERROR):o.message&&(a.message=o.message+" Also, I'm a computer. I only understand multiplication if you use an asterisk (*) as the multiplication sign.")}}return a}}}},$=/^web\+graphie:/,G=/^file\+graphie:/;function _(e){return q(e)?W(e):e}function q(e){return $.test(e)||G.test(e)}function P(e){return e.replace($,"https:").replace(G,"file:")}function W(e){return P(e)+".svg"}function ae(e){return P(e)+"-data.json"}async function ie(e){const t=new Image;return new Promise((r,a)=>{t.onload=()=>{r([t.naturalWidth,t.naturalHeight])},t.onerror=a,t.src=_(e)})}let b=!1;const U=function(e,t,r){return Array.isArray(e)?p.map(e,function(a){return U(a,t)}):t.call(r,e)};function se(e,t){return e==null||t==null?e==null==(t==null):e.length===t.length&&e.every((r,a)=>t[a]===r)}const V=/^\[\[\u2603 (([a-z-]+) ([0-9]+))\]\]/,oe=/^([a-z-]+) ([0-9]+)$/,ue=new RegExp(V.source+"$"),ce="☃",O=function(e){let t=e;return function(){let r=t;return r=r+2127912214+(r<<12)&4294967295,r=(r^3345072700^r>>>19)&4294967295,r=r+374761393+(r<<5)&4294967295,r=(r+3550635116^r<<9)&4294967295,r=r+4251993797+(r<<3)&4294967295,r=(r^3042594569^r>>>16)&4294967295,(t=r&268435455)/268435456}};function le(e,t,r=!1){const a=p.clone(e);if(!a.length||p.all(a,function(n){return p.isEqual(n,a[0])}))return a;let s;typeof t=="function"?s=t:s=O(t);do for(let n=a.length;n>0;n--){const i=Math.floor(s()*n),o=a[i];a[i]=a[n-1],a[n-1]=o}while(r&&p.isEqual(e,a));return a}const fe="x".split(/(.)/g).length?function(e,t){return e.split(t)}:function(e,t){const r=[];let a=t.lastIndex=0,s;for(;s=t.exec(e);){const n=s;r.push(e.slice(a,n.index)),r.push(...n.slice(1)),a=n.index+n[0].length}return r.push(e.slice(a)),r};function pe(e,t){let r;return E.predicate.createValidatorFunctional(function(s){return r=s,!0},{simplify:"optional",inexact:!0,forms:"integer, proper, improper, pi, log, mixed, decimal"})(e),r}function de(e){return p(e).times(function(){return""})}function me(e,t,r,a){const s=S(t,r),i=e*s>30;return{scale:s,tickStep:e/a,unityLabel:i}}function he(e,t,r){return p(2).times(function(a){const s=S(e[a],r);return X(t[a],s)})}function ge(e){return[e[0]/2,e[1]/2]}function X(e,t){const r=e*t,a=e,s=Math.pow(10,Math.floor(Math.log(a)/Math.LN10)),n=Math.floor(a/s);if(r<25)return e;if(r<50)return n===5?e:e/2;if(n===1)return e/2;if(n===2)return e/4;if(n===5)return e/5}function S(e,t){const r=e[1]-e[0];return t/r}function Re(e,t){const r=e[1]-e[0];let a;15<r&&r<=20?a=23:r>100||r<5?a=10:a=16;const s=t/500,n=a*s;return v(r,n)}function v(e,t){let r=Math.pow(10,Math.floor(Math.log(e/t)/Math.LN10));const a=t/e*r;return a<=.15?r*=10:a<=.35?r*=5:a<=.75&&(r*=2),r}const D=(e,t)=>{const r=t[1]-t[0],a=r/e;return a<=10?e:a<=20?e*2:v(r,10)};function Ee(e,t){return[D(e[0],t[0]),D(e[1],t[1])]}function N(e,t){return typeof e=="number"&&typeof t=="number"?Math.abs(e-t)<1e-9:e===t}function T(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!T(e[r],t[r]))return!1;return!0}return Array.isArray(e)||Array.isArray(t)?!1:typeof e=="function"&&typeof t=="function"?N(e,t):typeof e=="function"||typeof t=="function"?!1:typeof e=="object"&&typeof t=="object"&&e&&t?e===t||p.all(e,function(r,a){return T(t[a],r)})&&p.all(t,function(r,a){return T(e[a],r)}):typeof e=="object"&&e||typeof t=="object"&&t?!1:N(e,t)}function Me(e){e=e||window.location.search.substring(1);const t={},r=/\+/g,a=/([^&=]+)=?([^&]*)/g,s=function(i){return decodeURIComponent(i.replace(r," "))};let n;for(;n=a.exec(e);){const i=n;t[s(i[1])]=s(i[2])}return t}function Ie(e,t,r){r=encodeURIComponent(r);const a=new RegExp("([?&])"+t+"=.*?(&|$)","i"),s=e.indexOf("?")!==-1?"&":"?";return e.match(a)?e.replace(a,"$1"+t+"="+r+"$2"):e+s+t+"="+r}function Te(e){return encodeURIComponent(e).replace(/['()!]/g,window.escape).replace(/\*/g,"%2A")}const g={pointerDown:!1,currentTouchIdentifier:null};function we(){Object.assign(g,{pointerDown:!1,currentTouchIdentifier:null})}function Fe(e){let t;if(g.pointerDown){if(g.currentTouchIdentifier!=null){const a=e.changedTouches?e.changedTouches.length:0;for(let s=0;s<a;s++)e.changedTouches[s].identifier===g.currentTouchIdentifier&&(t=e.changedTouches[s])}else t=e;const r=e.type==="touchend"||e.type==="touchcancel";t&&r&&(g.pointerDown=!1,g.currentTouchIdentifier=null)}else g.pointerDown=!0,e.changedTouches?(t=e.changedTouches[0],g.currentTouchIdentifier=t.identifier):t=e;if(t)return{left:t.pageX,top:t.pageY}}const Ne=()=>{try{const e=Object.defineProperty({},"passive",{get:function(){b=!0}});window.addEventListener("testPassive",null,e),window.removeEventListener("testPassive",null,e)}catch{}return b};function _e(e){e.stopPropagation()}function Pe(e,t){const r=new Image;r.onload=function(){var a;r.width===0&&r.height===0?((a=document.body)==null||a.appendChild(r),p.defer(function(){var s;t(r.clientWidth,r.clientHeight),(s=document.body)==null||s.removeChild(r)})):t(r.width,r.height)},r.src=_(e)}function Oe(e){const t=e.value,r=e.selectionStart-1,a=Math.max(t.lastIndexOf(`
`,r),t.lastIndexOf(" ",r))+1;return{string:t.substring(a,r+1),pos:{start:a,end:r}}}function Se(e,t){e.selectionStart=t,e.selectionEnd=t}const ve={getWordBeforeCursor:Oe,moveCursor:Se},ye=e=>e.startsWith("$")&&e.endsWith("$")?e.slice(1,-1):e,Ae=O(new Date().getTime()&4294967295);function z(e){return Array.isArray(e)?e.map(z):e}const Be={inputPathsEqual:se,nestedMap:U,rWidgetRule:V,rTypeFromWidgetId:oe,rWidgetParts:ue,snowman:ce,seededRNG:O,shuffle:le,split:fe,firstNumericalParse:pe,stringArrayOfSize:de,gridDimensionConfig:me,getGridStep:he,snapStepFromGridStep:ge,scaleFromExtent:S,tickStepFromExtent:Re,gridStepFromTickStep:X,tickStepFromNumTicks:v,constrainedTickStepsFromTickSteps:Ee,eq:N,deepEq:T,parseQueryString:Me,updateQueryString:Ie,strongEncodeURIComponent:Te,touchHandlers:g,resetTouchHandlers:we,extractPointerLocation:Fe,supportsPassiveEvents:Ne,captureScratchpadTouchStart:_e,getImageSize:Pe,getImageSizeModern:ie,getRealImageUrl:_,isLabeledSVG:q,getBaseUrl:P,getSvgUrl:W,getDataUrl:ae,textarea:ve,unescapeMathMode:ye,random:Ae,deepClone:z};export{Y as D,d as K,Be as U,Ge as a,Ue as b,Xe as c,E as d,I as e,Ve as f,qe as g,H as i,We as r,ze as s,L as t};
