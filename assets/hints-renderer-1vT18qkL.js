import{a as y,j as m}from"./jsx-runtime-BGVbfQ2Z.js";import{l as C,R as v,p as _}from"./renderer-Egk7x_Xi.js";import{_ as V}from"./index-V35CFGao.js";import{l as a}from"./index-awljIyHI.js";import{c as N}from"./index-awCzqCwC.js";import{r as I}from"./index-qhcEwEpg.js";import{R as L}from"./index-E09jvG0x.js";import{_ as f}from"./index-default-4_ZsnO94.js";import{l as p,m as W,o as P,k as R,q as A,h as F}from"./constants-I_nlPaPx.js";import{m as d}from"./media-queries-MaBBbpNq.js";import{A as z}from"./perseus-api-Ly41NhN4.js";import{s as M}from"./shared-3pf9YZIg.js";import{U as T}from"./util-HWMzrHku.js";const x=class x extends I.Component{constructor(){super(...arguments),this.getSerializedState=()=>this.refs.renderer.getSerializedState(),this.restoreSerializedState=(e,n)=>{this.refs.renderer.restoreSerializedState(e,n)}}render(){const{apiOptions:e,className:n,hint:t,lastHint:i,lastRendered:s,pos:u,totalHints:h}=this.props,{isMobile:c}=e,l=N("hint",!c&&"perseus-hint-renderer",c&&a.css(q.newHint),c&&s&&a.css(q.lastRenderedNewHint),i&&"last-hint",s&&"last-rendered",n),r={...e,customKeypad:!1};return y("div",{className:l,tabIndex:"-1",children:[!e.isMobile&&m("span",{className:"perseus-sr-only",children:V("Hint #%(pos)s",{pos:u+1})}),!e.isMobile&&h!=null&&u!=null&&m("span",{className:"perseus-hint-label",style:{display:"block",color:e.hintProgressColor},children:`${u+1} / ${h}`}),m(v,{ref:"renderer",widgets:t.widgets,content:t.content||"",images:t.images,apiOptions:r,findExternalWidgets:this.props.findExternalWidgets,linterContext:_(this.props.linterContext,"hint")})]})}};x.defaultProps={linterContext:C};let g=x;const q=a.StyleSheet.create({newHint:{marginBottom:1.5*p,borderLeftColor:W,borderLeftStyle:"solid",borderLeftWidth:P,[d.lgOrSmaller]:{paddingLeft:p},[d.smOrSmaller]:{paddingLeft:0},":focus":{outline:"none"}},lastRenderedNewHint:{marginBottom:0,borderLeftColor:R}});try{g.displayName="HintRenderer",g.__docgenInfo={description:"",displayName:"HintRenderer",props:{apiOptions:{defaultValue:null,description:"",name:"apiOptions",required:!0,type:{name:"Readonly<{ isArticle?: boolean | undefined; onInputError?: ((widgetId: any, value: string, message?: string | null | undefined) => unknown) | undefined; onFocusChange?: ((newFocusPath: FocusPath, oldFocusPath: FocusPath, keypadHeight?: number | undefined, focusedElement?: HTMLElement | undefined) => unknown) | undef..."}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},hint:{defaultValue:null,description:"",name:"hint",required:!0,type:{name:"any"}},lastHint:{defaultValue:null,description:"",name:"lastHint",required:!1,type:{name:"boolean"}},lastRendered:{defaultValue:null,description:"",name:"lastRendered",required:!1,type:{name:"boolean"}},pos:{defaultValue:null,description:"",name:"pos",required:!0,type:{name:"number"}},totalHints:{defaultValue:null,description:"",name:"totalHints",required:!1,type:{name:"number"}},findExternalWidgets:{defaultValue:null,description:"",name:"findExternalWidgets",required:!1,type:{name:"any"}},linterContext:{defaultValue:{value:"PerseusLinter.linterContextDefault"},description:"",name:"linterContext",required:!1,type:{name:"LinterContextProps"}}}}}catch{}const w=class w extends I.Component{constructor(){super(...arguments),this.state={isFinalHelpPage:!1},this._hintsVisible=()=>this.props.hintsVisible==null||this.props.hintsVisible===-1?this.props.hints.length:this.props.hintsVisible,this._cacheImagesInHint=e=>{f.each(e.images,(n,t)=>{const i=new Image;i.src=T.getRealImageUrl(t)})},this._cacheHintImages=()=>{this._hintsVisible()>0?f.each(this.props.hints,this._cacheImagesInHint):this.props.hints.length>0&&this._cacheImagesInHint(this.props.hints[0])},this.getApiOptions=()=>({...z.defaults,...this.props.apiOptions,readOnly:!1}),this.getSerializedState=()=>f.times(this._hintsVisible(),e=>this.refs["hintRenderer"+e].getSerializedState()),this.restoreSerializedState=(e,n)=>{let t=1;const i=()=>{--t,n&&t===0&&n()};f.each(e,(s,u)=>{const h=this.refs["hintRenderer"+u];h&&(++t,h.restoreSerializedState(s,i))}),i()}}componentDidMount(){this._cacheHintImages()}UNSAFE_componentWillReceiveProps(e){e.hintsVisible-this.props.hintsVisible>1&&this.setState({isFinalHelpPage:!0})}componentDidUpdate(e,n){(!f.isEqual(e.hints,this.props.hints)||e.hintsVisible!==this.props.hintsVisible)&&this._cacheHintImages();const t=e.hintsVisible||0,i=this.props.hintsVisible||0;if(t<i&&i<=this.props.hints.length&&i>=0){const s=i-1;L.findDOMNode(this.refs["hintRenderer"+s]).focus()}}render(){const e=this.getApiOptions(),n=this._hintsVisible(),t=[],i=this.state.isFinalHelpPage;this.props.hints.slice(0,n).forEach((l,r)=>{const O=r===this.props.hints.length-1&&!/\*\*/.test(l.content),k=r===n-1,S=m(g,{lastHint:O,lastRendered:k,hint:l,pos:r,totalHints:this.props.hints.length,ref:"hintRenderer"+r,apiOptions:e,findExternalWidgets:this.props.findExternalWidgets,linterContext:_(this.props.linterContext,"hints["+r+"]")},"hintRenderer"+r);i?t.push(S):l.replace&&t.length>0?t[t.length-1]=S:t.push(S)});const{getAnotherHint:s}=e,u=s&&n>0&&n<this.props.hints.length,h=`(${n}/${this.props.hints.length})`,c=N(this.props.className,e.isMobile&&n>0&&a.css(o.mobileHintStylesHintsRenderer));return y("div",{className:c,children:[e.isMobile&&n>0&&m("div",{className:a.css(o.mobileHintStylesHintTitle,M.responsiveLabel),children:V("Hints")}),t,u&&y("button",{rel:"button",className:a.css(o.linkButton,o.getAnotherHintButton,e.isMobile&&o.mobileHintStylesGetAnotherHintButton),onClick:l=>{l.preventDefault(),l.stopPropagation(),s&&s()},children:[m("span",{className:a.css(o.plusText,e.isMobile&&o.mobileHintStylesPlusText),children:"+"}),y("span",{className:a.css(o.getAnotherHintText),children:[V("Get another hint")," ",h]})]})]})}};w.defaultProps={linterContext:C};let b=w;const H=p+P,o=a.StyleSheet.create({rendererMargins:{marginTop:p},linkButton:{cursor:"pointer",border:"none",backgroundColor:"transparent",fontSize:"100%",fontFamily:"inherit",fontWeight:"bold",color:R,padding:0,position:"relative"},plusText:{fontSize:20,position:"absolute",top:-3,left:0},getAnotherHintText:{marginLeft:16},mobileHintStylesHintsRenderer:{marginTop:4*p,border:`solid ${A}`,borderWidth:"1px 0 0 0",position:"relative",":before":{content:'""',display:"table",clear:"both"},":after":{content:'""',display:"table",clear:"both"}},mobileHintStylesHintTitle:{fontFamily:"inherit",fontStyle:"normal",fontWeight:"bold",color:F,paddingTop:p,paddingBottom:1.5*p,[d.lgOrSmaller]:{paddingLeft:0},[d.smOrSmaller]:{paddingLeft:H}},getAnotherHintButton:{marginTop:1.5*p},mobileHintStylesGetAnotherHintButton:{[d.lgOrSmaller]:{paddingLeft:0},[d.smOrSmaller]:{paddingLeft:H}},mobileHintStylesPlusText:{[d.lgOrSmaller]:{left:0},[d.smOrSmaller]:{left:H}}});try{b.displayName="HintsRenderer",b.__docgenInfo={description:"",displayName:"HintsRenderer",props:{analytics:{defaultValue:null,description:"",name:"analytics",required:!1,type:{name:"{ onAnalyticsEvent: AnalyticsEventHandlerFn; }"}},apiOptions:{defaultValue:null,description:"",name:"apiOptions",required:!1,type:{name:"Readonly<{ isArticle?: boolean; onInputError?: ((widgetId: any, value: string, message?: string | null) => unknown) | undefined; onFocusChange?: ((newFocusPath: FocusPath, oldFocusPath: FocusPath, keypadHeight?: number | undefined, focusedElement?: HTMLElement | undefined) => unknown) | undef..."}},keypadElement:{defaultValue:null,description:"",name:"keypadElement",required:!1,type:{name:"any"}},problemNum:{defaultValue:null,description:"",name:"problemNum",required:!1,type:{name:"number"}},legacyPerseusLint:{defaultValue:null,description:"",name:"legacyPerseusLint",required:!1,type:{name:"readonly string[]"}},inline:{defaultValue:null,description:"Skip adding paragraph class",name:"inline",required:!1,type:{name:"boolean"}},content:{defaultValue:null,description:"",name:"content",required:!1,type:{name:"string"}},alwaysUpdate:{defaultValue:null,description:"",name:"alwaysUpdate",required:!1,type:{name:"boolean"}},findExternalWidgets:{defaultValue:null,description:"",name:"findExternalWidgets",required:!1,type:{name:"any"}},highlightedWidgets:{defaultValue:null,description:"",name:"highlightedWidgets",required:!1,type:{name:"readonly any[]"}},images:{defaultValue:null,description:"",name:"images",required:!1,type:{name:"{ [key: string]: PerseusImageDetail; }"}},onInteractWithWidget:{defaultValue:null,description:"",name:"onInteractWithWidget",required:!1,type:{name:"((id: string) => void)"}},onRender:{defaultValue:null,description:"",name:"onRender",required:!1,type:{name:"((node?: any) => void)"}},questionCompleted:{defaultValue:null,description:"",name:"questionCompleted",required:!1,type:{name:"boolean"}},reviewMode:{defaultValue:null,description:"",name:"reviewMode",required:!1,type:{name:"boolean | null"}},showSolutions:{defaultValue:null,description:'If set to "all", all rationales or solutions will be shown. If set to\n"selected", soltions will only be shown for selected choices. If set to\n"none", solutions will not be shown-- equivalent to `undefined`.',name:"showSolutions",required:!1,type:{name:"enum",value:[{value:'"none"'},{value:'"all"'},{value:'"selected"'}]}},serializedState:{defaultValue:null,description:"",name:"serializedState",required:!1,type:{name:"any"}},onSerializedStateUpdated:{defaultValue:null,description:`Callback which is called when serialized state changes with the new
serialized state.`,name:"onSerializedStateUpdated",required:!1,type:{name:"((serializedState: { [key: string]: any; }) => unknown)"}},linterContext:{defaultValue:{value:"PerseusLinter.linterContextDefault"},description:`If linterContext.highlightLint is true, then content will be passed to
the linter and any warnings will be highlighted in the rendered output.`,name:"linterContext",required:!1,type:{name:"LinterContextProps"}},widgets:{defaultValue:null,description:"",name:"widgets",required:!1,type:{name:"PerseusWidgetsMap"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},hints:{defaultValue:null,description:"",name:"hints",required:!0,type:{name:"readonly any[]"}},hintsVisible:{defaultValue:null,description:"",name:"hintsVisible",required:!1,type:{name:"number"}}}}}catch{}export{b as H};
