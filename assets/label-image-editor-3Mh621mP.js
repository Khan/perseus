import{j as n}from"./jsx-runtime-63Ea5SlK.js";import"./article-renderer-m2DxR4DL.js";import"./jquery-yG1GhClm.js";import{U as g}from"./util-AYeX86gl.js";import"./phet-simulation-_7qOO4_B.js";import"./version-akiLXZts.js";import"./dependencies-CP7Uh8Kq.js";import"./perseus-api-1-ethIrW.js";import"./perseus-item-wU4gIC8p.js";import"./hints-renderer-b_P2F9w3.js";import"./renderer-IhFUya5i.js";import"./base-radio-DUduhCT2.js";import"./button-group-G5CZaedn.js";import"./graph-4ZDD3NK_.js";import"./svg-image-FcZanvM1.js";import"./hud-ifw9Ofbw.js";import"./icon-7RFbyLiL.js";import"./index-BIPwuHvF.js";import"./inline-icon-6fh0Wu1y.js";import"./math-input-ILg8RrvB.js";import"./multi-button-group-QUVHbBcE.js";import"./number-input-ogh82yD8.js";import"./range-input-w5Z3sPK5.js";import"./text-input-5e4vF1bl.js";import"./text-list-editor-aj1SAzcA.js";import"./index-k-0mNqHS.js";import"./i18n-context-fsWEgybQ.js";import"./index-smZ6iCr_.js";import{E as f}from"./editor-jsonify-Xq2j5Ptn.js";import{l}from"./index-awljIyHI.js";import{r as y}from"./index-6oxdNXpR.js";import{F as k}from"./form-wrapped-text-field-NbyiOLVb.js";import{A as C}from"./answer-choices-JRh0WTJs.js";import{B as w}from"./behavior-TyTo4KVG.js";import{Q as A}from"./question-markers--rzKMwIq.js";import{S as v}from"./select-image-7d_NwVSD.js";const u=class u extends y.Component{constructor(){super(...arguments),this.getSaveWarnings=()=>{const{choices:e,imageAlt:t,imageUrl:s,markers:r}=this.props,a=[];if(e.length<2&&a.push("Question requires at least two answer choices"),s?t||a.push("Question image has no alt text"):a.push("Image is not specified for question"),!r.length)a.push("Question has no markers, to label answers on image");else{let i=0,o=0;for(const m of r)m.answers.length||i++,m.label||o++;i&&a.push(`Question has ${i} markers with no answers selected`),o&&a.push(`Question has ${o} markers with no ARIA label`)}return a},this.handleImageChange=e=>{this.props.onChange({imageUrl:e,imageWidth:0,imageHeight:0}),e&&g.getImageSize(e,(t,s)=>{this.props.onChange({imageUrl:e,imageWidth:t,imageHeight:s})})},this.handleAltChange=e=>{this.props.onChange({imageAlt:e})},this.handleChoicesChange=e=>{this.props.onChange({choices:e})},this.handleMarkersChange=e=>{this.props.onChange({markers:e})},this.handleBehaviorChange=e=>{this.props.onChange(e)}}componentDidUpdate(e){const t={};e.markers.forEach(r=>t[`${r.x}.${r.y}`]=r);const s=this.props.markers.map((r,a)=>t.hasOwnProperty(`${r.x}.${r.y}`)?-1:a).filter(r=>r!==-1);s.length&&this._questionMarkers&&this._questionMarkers.openDropdownForMarkerIndices(s)}serialize(){return f.serialize.call(this)}render(){const{choices:e,imageAlt:t,imageUrl:s,imageWidth:r,imageHeight:a,markers:i,multipleAnswers:o,hideChoicesFromInstructions:m}=this.props,c=s&&r>0&&a>0;return n.jsxs("div",{children:[n.jsx(v,{onChange:this.handleImageChange,url:s}),n.jsx("div",{className:l.css(p.smallSpacer)}),c&&n.jsx(k,{placeholder:"Alt text (for screen readers)",onChange:h=>this.handleAltChange(h.target.value),value:t,width:"100%"}),n.jsx("div",{className:l.css(p.largeSpacer)}),n.jsx(A,{choices:e,imageUrl:c?s:"",imageWidth:r,imageHeight:a,markers:i,onChange:this.handleMarkersChange,ref:h=>this._questionMarkers=h}),n.jsx("div",{className:l.css(p.largeSpacer)}),n.jsx(C,{choices:e,onChange:this.handleChoicesChange}),n.jsx("div",{className:l.css(p.largeSpacer)}),n.jsx(w,{preferredPopoverDirection:"NONE",multipleAnswers:o,hideChoicesFromInstructions:m,onChange:this.handleBehaviorChange})]})}};u.defaultProps={choices:[],imageAlt:"",imageUrl:"",imageWidth:0,imageHeight:0,markers:[],multipleAnswers:!1,hideChoicesFromInstructions:!1},u.widgetName="label-image";let d=u;const p=l.StyleSheet.create({largeSpacer:{height:32},smallSpacer:{height:16}});d.__docgenInfo={description:"",methods:[{name:"getSaveWarnings",docblock:null,modifiers:[],params:[],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:{type:{name:"any"}}},{name:"handleImageChange",docblock:null,modifiers:[],params:[{name:"url",optional:!1,type:{name:"string"}}],returns:null},{name:"handleAltChange",docblock:null,modifiers:[],params:[{name:"alt",optional:!1,type:{name:"string"}}],returns:null},{name:"handleChoicesChange",docblock:null,modifiers:[],params:[{name:"choices",optional:!1,type:{name:"ReadonlyArray",elements:[{name:"string"}],raw:"ReadonlyArray<string>",alias:"ReadonlyArray"}}],returns:null},{name:"handleMarkersChange",docblock:null,modifiers:[],params:[{name:"markers",optional:!1,type:{name:"ReadonlyArray",elements:[{name:"signature",type:"object",raw:`{
    // The list of correct answers expected for the marker.
    answers: ReadonlyArray<string>;
    // The marker title or description.
    label: string;
    // The marker coordinates on the question image as percent of image size.
    x: number;
    y: number;
}`,signature:{properties:[{key:"answers",value:{name:"ReadonlyArray",elements:[{name:"string"}],raw:"ReadonlyArray<string>",required:!0}},{key:"label",value:{name:"string",required:!0}},{key:"x",value:{name:"number",required:!0}},{key:"y",value:{name:"number",required:!0}}]}}],raw:"ReadonlyArray<MarkerType>",alias:"ReadonlyArray"}}],returns:null},{name:"handleBehaviorChange",docblock:null,modifiers:[],params:[{name:"options",optional:!1,type:{name:"any"}}],returns:null}],displayName:"LabelImageEditor",props:{choices:{required:!1,tsType:{name:"ReadonlyArray",elements:[{name:"string"}],raw:"ReadonlyArray<string>"},description:"",defaultValue:{value:"[]",computed:!1}},imageAlt:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'""',computed:!1}},imageUrl:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'""',computed:!1}},imageWidth:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},imageHeight:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},markers:{required:!1,tsType:{name:"ReadonlyArray",elements:[{name:"signature",type:"object",raw:`{
    // The list of correct answers expected for the marker.
    answers: ReadonlyArray<string>;
    // The marker title or description.
    label: string;
    // The marker coordinates on the question image as percent of image size.
    x: number;
    y: number;
}`,signature:{properties:[{key:"answers",value:{name:"ReadonlyArray",elements:[{name:"string"}],raw:"ReadonlyArray<string>",required:!0}},{key:"label",value:{name:"string",required:!0}},{key:"x",value:{name:"number",required:!0}},{key:"y",value:{name:"number",required:!0}}]}}],raw:"ReadonlyArray<MarkerType>"},description:"",defaultValue:{value:"[]",computed:!1}},multipleAnswers:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},hideChoicesFromInstructions:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(options: any) => void",signature:{arguments:[{type:{name:"any"},name:"options"}],return:{name:"void"}}},description:""}}};export{d as L};
