import{a as u,j as s}from"./jsx-runtime-BGVbfQ2Z.js";import"./article-renderer-rRl5DFLq.js";import"./index-default-4_ZsnO94.js";import{U as f}from"./util-hMu2nkBL.js";import"./unit-Tx_erQ0l.js";import"./version-akiLXZts.js";import"./dependencies-fnqF3NiV.js";import"./perseus-api-XkoWPDUZ.js";import"./multi-renderer-EN5GCubG.js";import"./hints-renderer-4Qo-Mdjs.js";import"./renderer-YMwVTw_k.js";import"./base-radio-P1bXxk6A.js";import"./button-group-eBTrRsKy.js";import"./graph-pwSeuXvn.js";import"./svg-image-A17_gkxe.js";import"./hud-Q7Km3N9P.js";import"./icon-HbAIhp4d.js";import"./info-tip-_E95qi8X.js";import"./inline-icon-MJBS_-2U.js";import"./math-input-N24XH-Sd.js";import"./multi-button-group-rHU9dGVb.js";import"./number-input-TyU6YAix.js";import"./prop-check-box-AM0eLeop.js";import"./range-input-iEradMpU.js";import"./text-input-yDsqFbe3.js";import"./text-list-editor-xQBHt64k.js";import"./jquery-5v7aFUvu.js";import"./index-0C4KXdeC.js";import"./i18n-context-9-s9cJ--.js";import{E as C}from"./editor-jsonify-Ehp7kb1_.js";import{l as m}from"./index-awljIyHI.js";import{r as y}from"./index-qhcEwEpg.js";import{F as v}from"./form-wrapped-text-field-OfCv3pEU.js";import{A as w}from"./answer-choices-iqpbM97S.js";import{B as A}from"./behavior-EgUAjRl0.js";import{Q as k}from"./question-markers-vl-9y0CA.js";import{S as q}from"./select-image-Td_ZzhpV.js";const g=class g extends y.Component{constructor(){super(...arguments),this.getSaveWarnings=()=>{const{choices:e,imageAlt:t,imageUrl:r,markers:a}=this.props,i=[];if(e.length<2&&i.push("Question requires at least two answer choices"),r?t||i.push("Question image has no alt text"):i.push("Image is not specified for question"),!a.length)i.push("Question has no markers, to label answers on image");else{let o=0,n=0;for(const l of a)l.answers.length||o++,l.label||n++;o&&i.push(`Question has ${o} markers with no answers selected`),n&&i.push(`Question has ${n} markers with no ARIA label`)}return i},this.handleImageChange=e=>{this.props.onChange({imageUrl:e,imageWidth:0,imageHeight:0}),e&&f.getImageSize(e,(t,r)=>{this.props.onChange({imageWidth:t,imageHeight:r})})},this.handleAltChange=e=>{this.props.onChange({imageAlt:e})},this.handleChoicesChange=e=>{this.props.onChange({choices:e})},this.handleMarkersChange=e=>{this.props.onChange({markers:e})},this.handleBehaviorChange=e=>{this.props.onChange(e)}}componentDidUpdate(e){const t={};e.markers.forEach(a=>t[`${a.x}.${a.y}`]=a);const r=this.props.markers.map((a,i)=>t.hasOwnProperty(`${a.x}.${a.y}`)?-1:i).filter(a=>a!==-1);r.length&&this._questionMarkers&&this._questionMarkers.openDropdownForMarkerIndices(r)}serialize(){return C.serialize.call(this)}render(){const{choices:e,imageAlt:t,imageUrl:r,imageWidth:a,imageHeight:i,markers:o,multipleAnswers:n,hideChoicesFromInstructions:l}=this.props,d=r&&a>0&&i>0;return u("div",{children:[s(q,{onChange:this.handleImageChange,url:r}),s("div",{className:m.css(h.smallSpacer)}),d&&s(v,{placeholder:"Alt text (for screen readers)",onChange:c=>this.handleAltChange(c.target.value),value:t,width:"100%"}),s("div",{className:m.css(h.largeSpacer)}),s(k,{choices:e,imageUrl:d?r:"",imageWidth:a,imageHeight:i,markers:o,onChange:this.handleMarkersChange,ref:c=>this._questionMarkers=c}),s("div",{className:m.css(h.largeSpacer)}),s(w,{choices:e,onChange:this.handleChoicesChange}),s("div",{className:m.css(h.largeSpacer)}),s(A,{preferredPopoverDirection:"NONE",multipleAnswers:n,hideChoicesFromInstructions:l,onChange:this.handleBehaviorChange})]})}};g.defaultProps={choices:[],imageAlt:"",imageUrl:"",imageWidth:0,imageHeight:0,markers:[],multipleAnswers:!1,hideChoicesFromInstructions:!1},g.widgetName="label-image";let p=g;const h=m.StyleSheet.create({largeSpacer:{height:32},smallSpacer:{height:16}});try{p.displayName="LabelImageEditor",p.__docgenInfo={description:"",displayName:"LabelImageEditor",props:{choices:{defaultValue:{value:"[]"},description:"",name:"choices",required:!1,type:{name:"readonly string[]"}},imageAlt:{defaultValue:{value:""},description:"",name:"imageAlt",required:!1,type:{name:"string"}},imageUrl:{defaultValue:{value:""},description:"",name:"imageUrl",required:!1,type:{name:"string"}},imageWidth:{defaultValue:{value:"0"},description:"",name:"imageWidth",required:!1,type:{name:"number"}},imageHeight:{defaultValue:{value:"0"},description:"",name:"imageHeight",required:!1,type:{name:"number"}},markers:{defaultValue:{value:"[]"},description:"",name:"markers",required:!1,type:{name:"readonly MarkerType[]"}},multipleAnswers:{defaultValue:{value:"false"},description:"",name:"multipleAnswers",required:!1,type:{name:"boolean"}},hideChoicesFromInstructions:{defaultValue:{value:"false"},description:"",name:"hideChoicesFromInstructions",required:!1,type:{name:"boolean"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(options: any) => void"}}}}}catch{}export{p as L};
