import{j as c,a as R}from"./jsx-runtime-BGVbfQ2Z.js";import"./article-renderer-Hp1X_WB4.js";import{_ as d}from"./index-default-4_ZsnO94.js";import"./util-WvQWLN3r.js";import"./unit-uxf7imOh.js";import"./dependencies-fnqF3NiV.js";import"./perseus-api-BF68z3pH.js";import"./multi-renderer-2H9WpWd4.js";import"./hints-renderer-pDO1AnlZ.js";import"./renderer-qnasoFCf.js";import"./base-radio-_7magLxg.js";import{c as V}from"./components-hLqIONPr.js";import"./jquery-5v7aFUvu.js";import{P as E}from"./index-tvtfaFq4.js";import"./i18n-context-9-s9cJ--.js";import{c as _}from"./index-dnMhQZ-1.js";import{r as G}from"./index-qhcEwEpg.js";function A(t){return{newPos:t.newPos,components:t.components.slice(0)}}function U(t){for(var e=[],n=0;n<t.length;n++)t[n]&&e.push(t[n]);return e}function Y(t){var e=t;return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/"/g,"&quot;"),e}var C=function(t){this.ignoreWhitespace=t};C.prototype={diff:function(t,e){if(e===t)return[{value:e}];if(!e)return[{value:t,removed:!0}];if(!t)return[{value:e,added:!0}];e=this.tokenize(e),t=this.tokenize(t);var n=e.length,r=t.length,a=n+r,i=[{newPos:-1,components:[]}],s=this.extractCommon(i[0],e,t,0);if(i[0].newPos+1>=n&&s+1>=r)return i[0].components;for(var u=1;u<=a;u++)for(var o=-1*u;o<=u;o+=2){var f,p=i[o-1],l=i[o+1];s=(l?l.newPos:0)-o,p&&(i[o-1]=void 0);var m=p&&p.newPos+1<n,v=l&&0<=s&&s<r;if(!m&&!v){i[o]=void 0;continue}!m||v&&p.newPos<l.newPos?(f=A(l),this.pushComponent(f.components,t[s],void 0,!0)):(f=A(p),f.newPos++,this.pushComponent(f.components,e[f.newPos],!0,void 0));var s=this.extractCommon(f,e,t,o);if(f.newPos+1>=n&&s+1>=r)return f.components;i[o]=f}},pushComponent:function(t,e,n,r){var a=t[t.length-1];a&&a.added===n&&a.removed===r?t[t.length-1]={value:this.join(a.value,e),added:n,removed:r}:t.push({value:e,added:n,removed:r})},extractCommon:function(t,e,n,r){for(var a=e.length,i=n.length,s=t.newPos,u=s-r;s+1<a&&u+1<i&&this.equals(e[s+1],n[u+1]);)s++,u++,this.pushComponent(t.components,e[s],void 0,void 0);return t.newPos=s,u},equals:function(t,e){var n=/\S/;return this.ignoreWhitespace&&!n.test(t)&&!n.test(e)?!0:t===e},join:function(t,e){return t+e},tokenize:function(t){return t}};var Z=new C,X=new C(!0),$=new C;X.tokenize=$.tokenize=function(t){return U(t.split(/(\s+|\b)/))};var B=new C(!0);B.tokenize=function(t){return U(t.split(/([{}:;,]|\s+)/))};var q=new C;q.tokenize=function(t){for(var e=[],n=t.split(/^/m),r=0;r<n.length;r++){var a=n[r],i=n[r-1];a==`
`&&i&&i[i.length-1]==="\r"?e[e.length-1]+=`
`:a&&e.push(a)}return e};const J={Diff:C,diffChars:function(t,e){return Z.diff(t,e)},diffWords:function(t,e){return X.diff(t,e)},diffWordsWithSpace:function(t,e){return $.diff(t,e)},diffLines:function(t,e){return q.diff(t,e)},diffCss:function(t,e){return B.diff(t,e)},createPatch:function(t,e,n,r,a){var i=[];i.push("Index: "+t),i.push("==================================================================="),i.push("--- "+t+(typeof r>"u"?"":"	"+r)),i.push("+++ "+t+(typeof a>"u"?"":"	"+a));var s=q.diff(e,n);s[s.length-1].value||s.pop(),s.push({value:"",lines:[]});function u(N){return N.map(function(y){return" "+y})}function o(N,y,D){var I=s[s.length-2],K=y===s.length-2,Q=y===s.length-3&&(D.added!==I.added||D.removed!==I.removed);!/\n$/.test(D.value)&&(K||Q)&&N.push("\\ No newline at end of file")}for(var f=0,p=0,l=[],m=1,v=1,w=0;w<s.length;w++){var g=s[w],h=g.lines||g.value.replace(/\n$/,"").split(`
`);if(g.lines=h,g.added||g.removed){if(!f){var z=s[w-1];f=m,p=v,z&&(l=u(z.lines.slice(-4)),f-=l.length,p-=l.length)}l.push.apply(l,h.map(function(N){return(g.added?"+":"-")+N})),o(l,w,g),g.added?v+=h.length:m+=h.length}else{if(f)if(h.length<=8&&w<s.length-2)l.push.apply(l,u(h));else{var W=Math.min(h.length,4);i.push("@@ -"+f+","+(m-f+W)+" +"+p+","+(v-p+W)+" @@"),i.push.apply(i,l),i.push.apply(i,u(h.slice(0,W))),h.length<=4&&o(i,w,g),f=0,p=0,l=[]}m+=h.length,v+=h.length}}return i.join(`
`)+`
`},applyPatch:function(t,e){for(var n=e.split(`
`),r=[],a=!1,i=!1,s=n[0][0]==="I"?4:0;s<n.length;s++)if(n[s][0]==="@"){var u=n[s].split(/@@ -(\d+),(\d+) \+(\d+),(\d+) @@/);r.unshift({start:u[3],oldlength:u[2],oldlines:[],newlength:u[4],newlines:[]})}else n[s][0]==="+"?r[0].newlines.push(n[s].substr(1)):n[s][0]==="-"?r[0].oldlines.push(n[s].substr(1)):n[s][0]===" "?(r[0].newlines.push(n[s].substr(1)),r[0].oldlines.push(n[s].substr(1))):n[s][0]==="\\"&&(n[s-1][0]==="+"?a=!0:n[s-1][0]==="-"&&(i=!0));for(var o=t.split(`
`),s=r.length-1;s>=0;s--){for(var f=r[s],p=0;p<f.oldlength;p++)if(o[f.start-1+p]!==f.oldlines[p])return!1;Array.prototype.splice.apply(o,[f.start-1,+f.oldlength].concat(f.newlines))}if(a)for(;!o[o.length-1];)o.pop();else i&&o.push("");return o.join(`
`)},convertChangesToXML:function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];r.added?e.push("<ins>"):r.removed&&e.push("<del>"),e.push(Y(r.value)),r.added?e.push("</ins>"):r.removed&&e.push("</del>")}return e.join("")},convertChangesToDMP:function(t){for(var e=[],n,r=0;r<t.length;r++)n=t[r],e.push([n.added?1:n.removed?-1:0,n.value]);return e}},H=function(t){const e=[];let n=[];return d.each(t,r=>{const a=r.value.split(`
`);d.each(a,(i,s)=>{s>0&&(e.push(n),n=[]);const o=d.extend({},r,{value:i});n.push(o)})}),n.length&&e.push(n),e},P=function(t){return t.added?"added":t.removed?"removed":"unchanged"},S=t=>d.map(t.value,e=>({value:e,status:P(t)})),ee=function(t,e){return d.flatten(d.map(t,e),!0)},k=new J.Diff;k.tokenize=t=>d.map(t,e=>[e]);k.join=(t,e)=>t.concat(e);k.equals=d.isEqual;const te=t=>ee(t,S),ne=function(t,e){const n=k.diff(t,e),r=te(n);return{before:d.filter(r,a=>a.status!=="added"),after:d.filter(r,a=>a.status!=="removed")}},{SvgImage:se}=V,b="before",T="after",re=/http.*?\.png|web\+graphie[^)]*/g,M=function(t){return t.match(re)||[]},O=function(t,e,n){return t.added?e:t.removed?n:""},j=class j extends G.Component{render(){return c("div",{children:d.map(this.props.images,(e,n)=>{const r=_({image:!0,"image-unchanged":e.status==="unchanged","image-added":e.status==="added","image-removed":e.status==="removed"});return c("div",{children:c("div",{className:r,children:c(se,{src:e.value,title:e.value})})},n)})})}};j.propTypes={images:E.arrayOf(E.shape({})).isRequired};let F=j;const x=class x extends G.Component{constructor(){super(...arguments),this.state={collapsed:this.props.before===this.props.after},this.handleExpand=()=>{this.setState({collapsed:!1})}}UNSAFE_componentWillReceiveProps(e){this.setState({collapsed:e.before===e.after})}render(){const e=J.diffWords(this.props.before,this.props.after),n=H(e),r=M(this.props.before),a=M(this.props.after),i=ne(r,a),s=d.map(n,o=>{const f={};return f.before=d(o).map(function(p,l){return c("span",{className:O(p,"not-present","removed dark"),children:p.value},l)}),f.after=d(o).map(function(p,l){return c("span",{className:O(p,"added dark","not-present"),children:p.value},l)}),f}),u=_({"diff-row":!0,collapsed:this.state.collapsed});return R("div",{children:[c("div",{className:"diff-header",children:this.props.title}),c("div",{className:"diff-header",children:this.props.title}),c("div",{className:"diff-body ui-helper-clearfix",children:d.map([b,T],(o,f)=>R("div",{className:"diff-row "+o,children:[!this.state.collapsed&&d.map(s,(p,l)=>{const m=p[o].length>1,v=_({"diff-line":!0,added:o===T&&m,removed:o===b&&m});return c("div",{className:v,children:p[o]},l)}),!this.state.collapsed&&c(F,{images:i[o]})]},f))}),d.map([b,T],(o,f)=>c("div",{className:u+" "+o,onClick:this.handleExpand,children:this.state.collapsed&&c("span",{children:R("span",{className:"expand-button",children:[" ","[ show unmodified ]"," "]})})},f))]})}};x.propTypes={after:E.string,before:E.string,title:E.string.isRequired},x.defaultProps={after:"",before:""};let L=x;try{L.displayName="TextDiff",L.__docgenInfo={description:"",displayName:"TextDiff",props:{}}}catch{}export{L as T};
