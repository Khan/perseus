import{r as d}from"./index-C6mWTJJr.js";import{F}from"./index-Xl5L4rvz.js";import"./_commonjsHelpers-BosuxZz1.js";(function(){if(typeof window!="object")return;if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype){"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});return}function s(t){try{return t.defaultView&&t.defaultView.frameElement||null}catch{return null}}var o=function(t){for(var e=t,n=s(e);n;)e=n.ownerDocument,n=s(e);return e}(window.document),u=[],h=null,m=null;function g(t){this.time=t.time,this.target=t.target,this.rootBounds=T(t.rootBounds),this.boundingClientRect=T(t.boundingClientRect),this.intersectionRect=T(t.intersectionRect||v()),this.isIntersecting=!!t.intersectionRect;var e=this.boundingClientRect,n=e.width*e.height,i=this.intersectionRect,r=i.width*i.height;n?this.intersectionRatio=Number((r/n).toFixed(4)):this.intersectionRatio=this.isIntersecting?1:0}function a(t,e){var n=e||{};if(typeof t!="function")throw new Error("callback must be a function");if(n.root&&n.root.nodeType!=1&&n.root.nodeType!=9)throw new Error("root must be a Document or Element");this._checkForIntersections=B(this._checkForIntersections.bind(this),this.THROTTLE_TIMEOUT),this._callback=t,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(n.rootMargin),this.thresholds=this._initThresholds(n.threshold),this.root=n.root||null,this.rootMargin=this._rootMarginValues.map(function(i){return i.value+i.unit}).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}a.prototype.THROTTLE_TIMEOUT=100,a.prototype.POLL_INTERVAL=null,a.prototype.USE_MUTATION_OBSERVER=!0,a._setupCrossOriginUpdater=function(){return h||(h=function(t,e){!t||!e?m=v():m=x(t,e),u.forEach(function(n){n._checkForIntersections()})}),h},a._resetCrossOriginUpdater=function(){h=null,m=null},a.prototype.observe=function(t){var e=this._observationTargets.some(function(n){return n.element==t});if(!e){if(!(t&&t.nodeType==1))throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:t,entry:null}),this._monitorIntersections(t.ownerDocument),this._checkForIntersections()}},a.prototype.unobserve=function(t){this._observationTargets=this._observationTargets.filter(function(e){return e.element!=t}),this._unmonitorIntersections(t.ownerDocument),this._observationTargets.length==0&&this._unregisterInstance()},a.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},a.prototype.takeRecords=function(){var t=this._queuedEntries.slice();return this._queuedEntries=[],t},a.prototype._initThresholds=function(t){var e=t||[0];return Array.isArray(e)||(e=[e]),e.sort().filter(function(n,i,r){if(typeof n!="number"||isNaN(n)||n<0||n>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return n!==r[i-1]})},a.prototype._parseRootMargin=function(t){var e=t||"0px",n=e.split(/\s+/).map(function(i){var r=/^(-?\d*\.?\d+)(px|%)$/.exec(i);if(!r)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(r[1]),unit:r[2]}});return n[1]=n[1]||n[0],n[2]=n[2]||n[0],n[3]=n[3]||n[1],n},a.prototype._monitorIntersections=function(t){var e=t.defaultView;if(e&&this._monitoringDocuments.indexOf(t)==-1){var n=this._checkForIntersections,i=null,r=null;this.POLL_INTERVAL?i=e.setInterval(n,this.POLL_INTERVAL):(O(e,"resize",n,!0),O(t,"scroll",n,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in e&&(r=new e.MutationObserver(n),r.observe(t,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))),this._monitoringDocuments.push(t),this._monitoringUnsubscribes.push(function(){var b=t.defaultView;b&&(i&&b.clearInterval(i),R(b,"resize",n,!0)),R(t,"scroll",n,!0),r&&r.disconnect()});var c=this.root&&(this.root.ownerDocument||this.root)||o;if(t!=c){var l=s(t);l&&this._monitorIntersections(l.ownerDocument)}}},a.prototype._unmonitorIntersections=function(t){var e=this._monitoringDocuments.indexOf(t);if(e!=-1){var n=this.root&&(this.root.ownerDocument||this.root)||o,i=this._observationTargets.some(function(l){var b=l.element.ownerDocument;if(b==t)return!0;for(;b&&b!=n;){var f=s(b);if(b=f&&f.ownerDocument,b==t)return!0}return!1});if(!i){var r=this._monitoringUnsubscribes[e];if(this._monitoringDocuments.splice(e,1),this._monitoringUnsubscribes.splice(e,1),r(),t!=n){var c=s(t);c&&this._unmonitorIntersections(c.ownerDocument)}}}},a.prototype._unmonitorAllIntersections=function(){var t=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var e=0;e<t.length;e++)t[e]()},a.prototype._checkForIntersections=function(){if(!(!this.root&&h&&!m)){var t=this._rootIsInDom(),e=t?this._getRootRect():v();this._observationTargets.forEach(function(n){var i=n.element,r=w(i),c=this._rootContainsTarget(i),l=n.entry,b=t&&c&&this._computeTargetAndRootIntersection(i,r,e),f=null;this._rootContainsTarget(i)?(!h||this.root)&&(f=e):f=v();var p=n.entry=new g({time:P(),target:i,boundingClientRect:r,rootBounds:f,intersectionRect:b});l?t&&c?this._hasCrossedThreshold(l,p)&&this._queuedEntries.push(p):l&&l.isIntersecting&&this._queuedEntries.push(p):this._queuedEntries.push(p)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},a.prototype._computeTargetAndRootIntersection=function(t,e,n){if(window.getComputedStyle(t).display!="none"){for(var i=e,r=_(t),c=!1;!c&&r;){var l=null,b=r.nodeType==1?window.getComputedStyle(r):{};if(b.display=="none")return null;if(r==this.root||r.nodeType==9)if(c=!0,r==this.root||r==o)h&&!this.root?!m||m.width==0&&m.height==0?(r=null,l=null,i=null):l=m:l=n;else{var f=_(r),p=f&&w(f),C=f&&this._computeTargetAndRootIntersection(f,p,n);p&&C?(r=f,l=x(p,C)):(r=null,i=null)}else{var M=r.ownerDocument;r!=M.body&&r!=M.documentElement&&b.overflow!="visible"&&(l=w(r))}if(l&&(i=U(l,i)),!i)break;r=r&&_(r)}return i}},a.prototype._getRootRect=function(){var t;if(this.root&&!D(this.root))t=w(this.root);else{var e=D(this.root)?this.root:o,n=e.documentElement,i=e.body;t={top:0,left:0,right:n.clientWidth||i.clientWidth,width:n.clientWidth||i.clientWidth,bottom:n.clientHeight||i.clientHeight,height:n.clientHeight||i.clientHeight}}return this._expandRectByRootMargin(t)},a.prototype._expandRectByRootMargin=function(t){var e=this._rootMarginValues.map(function(i,r){return i.unit=="px"?i.value:i.value*(r%2?t.width:t.height)/100}),n={top:t.top-e[0],right:t.right+e[1],bottom:t.bottom+e[2],left:t.left-e[3]};return n.width=n.right-n.left,n.height=n.bottom-n.top,n},a.prototype._hasCrossedThreshold=function(t,e){var n=t&&t.isIntersecting?t.intersectionRatio||0:-1,i=e.isIntersecting?e.intersectionRatio||0:-1;if(n!==i)for(var r=0;r<this.thresholds.length;r++){var c=this.thresholds[r];if(c==n||c==i||c<n!=c<i)return!0}},a.prototype._rootIsInDom=function(){return!this.root||V(o,this.root)},a.prototype._rootContainsTarget=function(t){var e=this.root&&(this.root.ownerDocument||this.root)||o;return V(e,t)&&(!this.root||e==t.ownerDocument)},a.prototype._registerInstance=function(){u.indexOf(this)<0&&u.push(this)},a.prototype._unregisterInstance=function(){var t=u.indexOf(this);t!=-1&&u.splice(t,1)};function P(){return window.performance&&performance.now&&performance.now()}function B(t,e){var n=null;return function(){n||(n=setTimeout(function(){t(),n=null},e))}}function O(t,e,n,i){typeof t.addEventListener=="function"?t.addEventListener(e,n,i):typeof t.attachEvent=="function"&&t.attachEvent("on"+e,n)}function R(t,e,n,i){typeof t.removeEventListener=="function"?t.removeEventListener(e,n,i):typeof t.detatchEvent=="function"&&t.detatchEvent("on"+e,n)}function U(t,e){var n=Math.max(t.top,e.top),i=Math.min(t.bottom,e.bottom),r=Math.max(t.left,e.left),c=Math.min(t.right,e.right),l=c-r,b=i-n;return l>=0&&b>=0&&{top:n,bottom:i,left:r,right:c,width:l,height:b}||null}function w(t){var e;try{e=t.getBoundingClientRect()}catch{}return e?(e.width&&e.height||(e={top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.right-e.left,height:e.bottom-e.top}),e):v()}function v(){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}function T(t){return!t||"x"in t?t:{top:t.top,y:t.top,bottom:t.bottom,left:t.left,x:t.left,right:t.right,width:t.width,height:t.height}}function x(t,e){var n=e.top-t.top,i=e.left-t.left;return{top:n,left:i,height:e.height,width:e.width,bottom:n+e.height,right:i+e.width}}function V(t,e){for(var n=e;n;){if(n==t)return!0;n=_(n)}return!1}function _(t){var e=t.parentNode;return t.nodeType==9&&t!=o?s(t):(e&&e.assignedSlot&&(e=e.assignedSlot.parentNode),e&&e.nodeType==11&&e.host?e.host:e)}function D(t){return t&&t.nodeType===9}window.IntersectionObserver=a,window.IntersectionObserverEntry=g})();function q(s,o,u){return new W(s,o,u)}class W{constructor(o,u,h){this._handleIntersection=m=>{for(const g of m)this._onVisibilityChange(g.isIntersecting,g.rootBounds)},this._intersectionObserver=new IntersectionObserver(this._handleIntersection,{root:o,threshold:Number.EPSILON,rootMargin:h}),this._onVisibilityChange=u}setTargetElement(o){this._intersectionObserver.disconnect(),this._intersectionObserver.observe(o)}disconnect(){this._intersectionObserver.disconnect()}}const L=function(s,o){return s.parentNode?L(s.parentNode,o.concat([s])):o},k=function(s,o){return getComputedStyle(s).getPropertyValue(o)},H=function(s){return k(s,"overflow")+k(s,"overflow-y")+k(s,"overflow-x")},j=function(s){return/(auto|scroll)/.test(H(s))},K=function(s){if(!(s instanceof HTMLElement))return;const o=s.parentNode?L(s.parentNode,[]):[];for(let u=0;u<o.length;u+=1){const h=o[u];if(j(h))return h}return document.documentElement};function z(s,o,u){try{const h=K(s);if(!h)return"unknown";const m=h.getBoundingClientRect(),g=s.getBoundingClientRect();return(!u||h===document.body?g.bottom<o.top:g.bottom<m.top)?"hidden-above":"hidden-below"}catch{return"unknown"}}const I=class I extends d.Component{constructor(){super(...arguments),this.handleVisibilityChange=(o,u)=>{const{scrollParentIsNotBody:h,onChange:m}=this.props;if(o)m("visible");else{const g=z(this._node,u,!!h);m(g)}}}componentDidMount(){this._node=F.findDOMNode(this),this.registerVisibilityObserver()}componentWillUnmount(){this.unregisterVisibilityObserver()}registerVisibilityObserver(){const{rootMargin:o}=this.props;this._node&&(this._observer=q(null,this.handleVisibilityChange,o),this._observer.setTargetElement(this._node))}unregisterVisibilityObserver(){this._observer&&this._observer.disconnect()}render(){return this.props.children}};I.defaultProps={onChange:()=>{}};let E=I;E.__docgenInfo={description:"",methods:[{name:"handleVisibilityChange",docblock:null,modifiers:[],params:[{name:"isVisible",optional:!1,type:{name:"boolean"}},{name:"rootBounds",optional:!1,type:{name:"DOMRectReadOnly",alias:"DOMRectReadOnly"}}],returns:null},{name:"registerVisibilityObserver",docblock:null,modifiers:[],params:[],returns:null},{name:"unregisterVisibilityObserver",docblock:null,modifiers:[],params:[],returns:null}],displayName:"VisibilityObserver",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},rootMargin:{required:!1,tsType:{name:"string"},description:""},scrollParentIsNotBody:{required:!1,tsType:{name:"boolean"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(visibility: ScrollVisibility) => void",signature:{arguments:[{type:{name:"union",raw:`| "hidden-above"
| "hidden-below"
| "visible"
| "unknown"`,elements:[{name:"literal",value:'"hidden-above"'},{name:"literal",value:'"hidden-below"'},{name:"literal",value:'"visible"'},{name:"literal",value:'"unknown"'}]},name:"visibility"}],return:{name:"void"}}},description:"",defaultValue:{value:"() => {}",computed:!1}}}};const X={title:"Perseus/Components/Visibility Observer"};class J extends d.Component{constructor(){super(...arguments),this.state={sectionVisibility:"unknown"},this.handleVisibilityChanged=o=>{this.setState({sectionVisibility:o})}}render(){const{sectionVisibility:o}=this.state,u=o==="visible"?"Visible":"Not Visible";return d.createElement("div",null,d.createElement("p",null,"Visibility: ",u),d.createElement("p",null,o==="hidden-above"?"The Section IS UP HERE!!!":"---"),d.createElement("div",{style:{height:150,width:800,overflow:"scroll",backgroundColor:"white",scrollbars:"visible"}},d.createElement("p",null,"Ocicat american shorthair. Egyptian mau himalayan or grimalkin maine coon cheetah lion but himalayan. American bobtail lion kitten. Kitty bombay puma. Savannah scottish fold for tabby but sphynx for bombay kitten ragdoll. Puma russian blue yet singapura birman and kitty russian blue. Egyptian mau cheetah, donskoy for himalayan singapura abyssinian . Singapura himalayan. Malkin abyssinian but balinese but bobcat. Leopard puma, norwegian forest mouser and turkish angora. Lynx bengal tiger. American shorthair. Donskoy ragdoll. Siberian turkish angora cougar and russian blue. Burmese savannah and siamese norwegian forest yet cheetah himalayan lion. Ocelot kitten or munchkin but kitten savannah. Cougar manx or russian blue american shorthair so jaguar but havana brown. Cheetah havana brown manx. Tiger thai american bobtail. Ragdoll bengal yet kitten, bengal grimalkin scottish fold. Abyssinian jaguar. Turkish angora bengal but kitty sphynx."," "),d.createElement(E,{scrollParentIsNotBody:!0,onChange:this.handleVisibilityChanged},d.createElement("p",{style:{backgroundColor:"#eeddee",fontWeight:"bold"}},"American shorthair devonshire rex but cheetah and ragdoll but bombay. Kitty. Tomcat cornish rex donskoy but tom donskoy havana brown. Jaguar sphynx. Cheetah kitty for kitty, but balinese . British shorthair cheetah devonshire rex birman panther. Kitten tabby but siamese, sphynx. Bombay maine coon so lynx and donskoy kitten, but cougar. Sphynx sphynx, so american bobtail or mouser or puma. Mouser munchkin and ragdoll yet mouser cheetah balinese . Egyptian mau siamese mouser, cougar ragdoll. Persian birman tabby. Norwegian forest norwegian forest cornish rex bengal. Panther bombay. Kitty siamese ragdoll and egyptian mau. Tabby. Cheetah havana brown, kitty for havana brown. Cornish rex siberian russian blue so persian but thai burmese. Maine coon puma. Lynx.")),d.createElement("p",null,"Jaguar tom but himalayan birman. Turkish angora balinese grimalkin but birman or kitty or munchkin. American shorthair bobcat. Donskoy cornish rex malkin. Ocicat tabby or siamese, birman. Devonshire rex tomcat yet thai jaguar mouser and donskoy, lynx. Grimalkin bombay."," "),d.createElement("p",null,"Eat grass, throw it back up mice and cats are fats i like to pets them they like to meow back, cough furball into food bowl then scratch owner for a new one purr as loud as possible, be the most annoying cat that you can, and, knock everything off the table, lick the other cats. Furrier and even more furrier hairball cat is love, cat is life so ooh, are those your $250 dollar sandals? lemme use that as my litter box. Lick arm hair love to play with owner's hair tie hunt anything that moves. Destroy couch as revenge when in doubt, wash.")),d.createElement("p",null,o==="hidden-below"?"The Section IS DOWN HERE!!!":"---"))}}const y=s=>d.createElement(J,null);y.__docgenInfo={description:"",methods:[],displayName:"AlertWhenNotVisible"};var N,A,S;y.parameters={...y.parameters,docs:{...(N=y.parameters)==null?void 0:N.docs,source:{originalSource:`(args: StoryArgs): React.ReactElement => {
  return <VisibilityTest />;
}`,...(S=(A=y.parameters)==null?void 0:A.docs)==null?void 0:S.source}}};const Y=["AlertWhenNotVisible"];export{y as AlertWhenNotVisible,Y as __namedExportsOrder,X as default};
