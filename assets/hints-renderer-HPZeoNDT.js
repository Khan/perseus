import{a as y,j as c}from"./jsx-runtime-BGVbfQ2Z.js";import{l as _,R as k,p as N}from"./renderer-FLo8F5rM.js";import{_ as V}from"./index-V35CFGao.js";import{l as a}from"./index-awljIyHI.js";import{c as P}from"./index-awCzqCwC.js";import{r as R}from"./index-qhcEwEpg.js";import{R as L}from"./index-E09jvG0x.js";import{_ as f}from"./index-default-4_ZsnO94.js";import{l as p,m as A,o as w,k as E,q as F,h as v}from"./constants-I_nlPaPx.js";import{m as d}from"./media-queries-MaBBbpNq.js";import{A as M}from"./perseus-api-Ly41NhN4.js";import{s as z}from"./shared-3pf9YZIg.js";import{U as T}from"./util-jqcWD9IE.js";const x=class x extends R.Component{constructor(){super(...arguments),this.getSerializedState=()=>this.refs.renderer.getSerializedState(),this.restoreSerializedState=(e,n)=>{this.refs.renderer.restoreSerializedState(e,n)}}render(){const{apiOptions:e,className:n,hint:t,lastHint:i,lastRendered:s,pos:u,totalHints:m}=this.props,{isMobile:h}=e,r=P("hint",!h&&"perseus-hint-renderer",h&&a.css(C.newHint),h&&s&&a.css(C.lastRenderedNewHint),i&&"last-hint",s&&"last-rendered",n),l={...e,customKeypad:!1};return y("div",{className:r,tabIndex:"-1",children:[!e.isMobile&&c("span",{className:"perseus-sr-only",children:V("Hint #%(pos)s",{pos:u+1})}),!e.isMobile&&m!=null&&u!=null&&c("span",{className:"perseus-hint-label",style:{display:"block",color:e.hintProgressColor},children:`${u+1} / ${m}`}),c(k,{ref:"renderer",widgets:t.widgets,content:t.content||"",images:t.images,apiOptions:l,findExternalWidgets:this.props.findExternalWidgets,linterContext:N(this.props.linterContext,"hint")})]})}};x.defaultProps={linterContext:_};let g=x;const C=a.StyleSheet.create({newHint:{marginBottom:1.5*p,borderLeftColor:A,borderLeftStyle:"solid",borderLeftWidth:w,[d.lgOrSmaller]:{paddingLeft:p},[d.smOrSmaller]:{paddingLeft:0},":focus":{outline:"none"}},lastRenderedNewHint:{marginBottom:0,borderLeftColor:E}});try{g.displayName="HintRenderer",g.__docgenInfo={description:"",displayName:"HintRenderer",props:{apiOptions:{defaultValue:null,description:"",name:"apiOptions",required:!0,type:{name:"Readonly<{ isArticle?: boolean | undefined; onInputError?: ((widgetId: any, value: string, message?: string | null | undefined) => unknown) | undefined; onFocusChange?: ((newFocusPath: FocusPath, oldFocusPath: FocusPath, keypadHeight?: number | undefined, focusedElement?: HTMLElement | undefined) => unknown) | undef..."}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},hint:{defaultValue:null,description:"",name:"hint",required:!0,type:{name:"any"}},lastHint:{defaultValue:null,description:"",name:"lastHint",required:!1,type:{name:"boolean"}},lastRendered:{defaultValue:null,description:"",name:"lastRendered",required:!1,type:{name:"boolean"}},pos:{defaultValue:null,description:"",name:"pos",required:!0,type:{name:"number"}},totalHints:{defaultValue:null,description:"",name:"totalHints",required:!1,type:{name:"number"}},findExternalWidgets:{defaultValue:null,description:"",name:"findExternalWidgets",required:!1,type:{name:"any"}},linterContext:{defaultValue:{value:"PerseusLinter.linterContextDefault"},description:"",name:"linterContext",required:!1,type:{name:"LinterContextProps"}}}}}catch{}const q=class q extends R.Component{constructor(){super(...arguments),this.state={isFinalHelpPage:!1},this._hintsVisible=()=>this.props.hintsVisible==null||this.props.hintsVisible===-1?this.props.hints.length:this.props.hintsVisible,this._cacheImagesInHint=e=>{f.each(e.images,(n,t)=>{const i=new Image;i.src=T.getRealImageUrl(t)})},this._cacheHintImages=()=>{this._hintsVisible()>0?f.each(this.props.hints,this._cacheImagesInHint):this.props.hints.length>0&&this._cacheImagesInHint(this.props.hints[0])},this.getApiOptions=()=>({...M.defaults,...this.props.apiOptions,readOnly:!1}),this.getSerializedState=()=>f.times(this._hintsVisible(),e=>this.refs["hintRenderer"+e].getSerializedState()),this.restoreSerializedState=(e,n)=>{let t=1;const i=()=>{--t,n&&t===0&&n()};f.each(e,(s,u)=>{const m=this.refs["hintRenderer"+u];m&&(++t,m.restoreSerializedState(s,i))}),i()}}componentDidMount(){this._cacheHintImages()}UNSAFE_componentWillReceiveProps(e){e.hintsVisible-this.props.hintsVisible>1&&this.setState({isFinalHelpPage:!0})}componentDidUpdate(e,n){(!f.isEqual(e.hints,this.props.hints)||e.hintsVisible!==this.props.hintsVisible)&&this._cacheHintImages();const t=e.hintsVisible||0,i=this.props.hintsVisible||0;if(t<i&&i<=this.props.hints.length&&i>=0){const s=i-1;L.findDOMNode(this.refs["hintRenderer"+s]).focus()}}render(){const e=this.getApiOptions(),n=this._hintsVisible(),t=[],i=this.state.isFinalHelpPage;this.props.hints.slice(0,n).forEach((r,l)=>{const I=l===this.props.hints.length-1&&!/\*\*/.test(r.content),W=l===n-1,H=c(g,{lastHint:I,lastRendered:W,hint:r,pos:l,totalHints:this.props.hints.length,ref:"hintRenderer"+l,apiOptions:e,findExternalWidgets:this.props.findExternalWidgets,linterContext:N(this.props.linterContext,"hints["+l+"]")},"hintRenderer"+l);i?t.push(H):r.replace&&t.length>0?t[t.length-1]=H:t.push(H)});const{getAnotherHint:s}=e,u=s&&n>0&&n<this.props.hints.length,m=`(${n}/${this.props.hints.length})`,h=P(this.props.className,e.isMobile&&n>0&&a.css(o.mobileHintStylesHintsRenderer));return y("div",{className:h,children:[e.isMobile&&n>0&&c("div",{className:a.css(o.mobileHintStylesHintTitle,z.responsiveLabel),children:V("Hints")}),t,u&&y("button",{rel:"button",className:a.css(o.linkButton,o.getAnotherHintButton,e.isMobile&&o.mobileHintStylesGetAnotherHintButton),onClick:r=>{r.preventDefault(),r.stopPropagation(),s&&s()},children:[c("span",{className:a.css(o.plusText,e.isMobile&&o.mobileHintStylesPlusText),children:"+"}),y("span",{className:a.css(o.getAnotherHintText),children:[V("Get another hint")," ",m]})]})]})}};q.defaultProps={linterContext:_};let b=q;const S=p+w,o=a.StyleSheet.create({rendererMargins:{marginTop:p},linkButton:{cursor:"pointer",border:"none",backgroundColor:"transparent",fontSize:"100%",fontFamily:"inherit",fontWeight:"bold",color:E,padding:0,position:"relative"},plusText:{fontSize:20,position:"absolute",top:-3,left:0},getAnotherHintText:{marginLeft:16},mobileHintStylesHintsRenderer:{marginTop:4*p,border:`solid ${F}`,borderWidth:"1px 0 0 0",position:"relative",":before":{content:'""',display:"table",clear:"both"},":after":{content:'""',display:"table",clear:"both"}},mobileHintStylesHintTitle:{fontFamily:"inherit",fontStyle:"normal",fontWeight:"bold",color:v,paddingTop:p,paddingBottom:1.5*p,[d.lgOrSmaller]:{paddingLeft:0},[d.smOrSmaller]:{paddingLeft:S}},getAnotherHintButton:{marginTop:1.5*p},mobileHintStylesGetAnotherHintButton:{[d.lgOrSmaller]:{paddingLeft:0},[d.smOrSmaller]:{paddingLeft:S}},mobileHintStylesPlusText:{[d.lgOrSmaller]:{left:0},[d.smOrSmaller]:{left:S}}});try{b.displayName="HintsRenderer",b.__docgenInfo={description:"",displayName:"HintsRenderer",props:{inline:{defaultValue:null,description:"",name:"inline",required:!1,type:{name:"boolean"}},apiOptions:{defaultValue:null,description:"",name:"apiOptions",required:!1,type:{name:"Readonly<{ isArticle?: boolean; onInputError?: ((widgetId: any, value: string, message?: string | null) => unknown) | undefined; onFocusChange?: ((newFocusPath: FocusPath, oldFocusPath: FocusPath, keypadHeight?: number | undefined, focusedElement?: HTMLElement | undefined) => unknown) | undef..."}},problemNum:{defaultValue:null,description:"",name:"problemNum",required:!1,type:{name:"number"}},keypadElement:{defaultValue:null,description:"",name:"keypadElement",required:!1,type:{name:"any"}},analytics:{defaultValue:null,description:"",name:"analytics",required:!1,type:{name:"{ onAnalyticsEvent: AnalyticsEventHandlerFn; }"}},legacyPerseusLint:{defaultValue:null,description:"",name:"legacyPerseusLint",required:!1,type:{name:"readonly string[]"}},linterContext:{defaultValue:{value:"PerseusLinter.linterContextDefault"},description:"",name:"linterContext",required:!1,type:{name:"LinterContextProps"}},questionCompleted:{defaultValue:null,description:"",name:"questionCompleted",required:!1,type:{name:"boolean"}},content:{defaultValue:null,description:"",name:"content",required:!1,type:{name:"string"}},reviewMode:{defaultValue:null,description:"",name:"reviewMode",required:!1,type:{name:"boolean | null"}},alwaysUpdate:{defaultValue:null,description:"",name:"alwaysUpdate",required:!1,type:{name:"boolean"}},findExternalWidgets:{defaultValue:null,description:"",name:"findExternalWidgets",required:!1,type:{name:"any"}},highlightedWidgets:{defaultValue:null,description:"",name:"highlightedWidgets",required:!1,type:{name:"readonly any[]"}},images:{defaultValue:null,description:"",name:"images",required:!1,type:{name:"{ [key: string]: PerseusImageDetail; }"}},onInteractWithWidget:{defaultValue:null,description:"",name:"onInteractWithWidget",required:!1,type:{name:"((id: string) => void)"}},onRender:{defaultValue:null,description:"",name:"onRender",required:!1,type:{name:"((node?: any) => void)"}},serializedState:{defaultValue:null,description:"",name:"serializedState",required:!1,type:{name:"any"}},onSerializedStateUpdated:{defaultValue:null,description:"",name:"onSerializedStateUpdated",required:!1,type:{name:"((serializedState: { [key: string]: any; }) => unknown)"}},widgets:{defaultValue:null,description:"",name:"widgets",required:!1,type:{name:"PerseusWidgetsMap"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},hints:{defaultValue:null,description:"",name:"hints",required:!0,type:{name:"readonly any[]"}},hintsVisible:{defaultValue:null,description:"",name:"hintsVisible",required:!1,type:{name:"number"}}}}}catch{}export{b as H};
