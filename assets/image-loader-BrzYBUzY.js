import{j as p}from"./jsx-runtime-BGVbfQ2Z.js";import{r as u}from"./index-qhcEwEpg.js";import{g as h}from"./dependencies-fnqF3NiV.js";const e={PENDING:"pending",LOADING:"loading",LOADED:"loaded",FAILED:"failed"};class n extends u.Component{constructor(r){super(r),this.createLoader=()=>{this.destroyLoader(),this.img=new Image,this.img.onload=this.handleLoad,this.img.onerror=this.handleError,this.img.src=this.props.src},this.destroyLoader=()=>{this.img&&(this.img.onload=null,this.img.onerror=null,this.img=null)},this.handleLoad=t=>{this.destroyLoader(),this.setState({status:e.LOADED}),this.props.onLoad&&this.props.onLoad(t)},this.handleError=t=>{this.destroyLoader(),this.setState({status:e.FAILED}),this.props.onError&&this.props.onError(t)},this.renderImg=()=>{const{src:t,imgProps:o}=this.props;let i=null,a=null;o.onClick!=null&&(i=s=>{(s.keyCode===13||s.keyCode===32)&&o.onClick&&o.onClick(s)},a=s=>{s.keyCode===32&&s.preventDefault()});const l=h().staticUrl;return p("img",{src:l(t),onKeyUp:i,onKeyDown:a,...o})},this.state={status:r.src?e.LOADING:e.PENDING}}componentDidMount(){this.state.status===e.LOADING&&this.createLoader()}UNSAFE_componentWillReceiveProps(r){this.props.src!==r.src&&this.setState({status:r.src?e.LOADING:e.PENDING})}componentDidUpdate(r,t){this.state.status===e.LOADING&&!this.img&&this.createLoader(),t.status!==this.state.status&&this.props.onUpdate(this.state.status)}componentWillUnmount(){this.destroyLoader()}render(){switch(this.state.status){case e.LOADED:return this.renderImg();case e.FAILED:if(this.props.children)return this.props.children;break;default:if(this.props.preloader)return this.props.preloader()}return null}}try{n.displayName="ImageLoader",n.__docgenInfo={description:"",displayName:"ImageLoader",props:{imgProps:{defaultValue:null,description:"",name:"imgProps",required:!0,type:{name:"ImageProps"}},onError:{defaultValue:null,description:"",name:"onError",required:!1,type:{name:"((event: Event) => void)"}},onLoad:{defaultValue:null,description:"",name:"onLoad",required:!1,type:{name:"((event: Event) => void)"}},onUpdate:{defaultValue:null,description:"",name:"onUpdate",required:!0,type:{name:'(status: "pending" | "loading" | "loaded" | "failed") => void'}},preloader:{defaultValue:null,description:"",name:"preloader",required:!0,type:{name:"() => ReactElement<any, string | JSXElementConstructor<any>> | null | undefined"}},src:{defaultValue:null,description:"",name:"src",required:!0,type:{name:"string"}}}}}catch{}export{n as I};
