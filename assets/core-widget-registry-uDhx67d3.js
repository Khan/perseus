var un=Object.defineProperty;var hn=(n,r,e)=>r in n?un(n,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[r]=e;var G=(n,r,e)=>(hn(n,typeof r!="symbol"?r+"":r,e),e);import{_ as l}from"./underscore-U-AHniOr.js";function Ct(n,r){return typeof n=="number"&&typeof r=="number"?Math.abs(n-r)<1e-9:n===r}function ze(n,r){if(Array.isArray(n)&&Array.isArray(r)){if(n.length!==r.length)return!1;for(let e=0;e<n.length;e++)if(!ze(n[e],r[e]))return!1;return!0}return Array.isArray(n)||Array.isArray(r)?!1:typeof n=="function"&&typeof r=="function"?Ct(n,r):typeof n=="function"||typeof r=="function"?!1:typeof n=="object"&&typeof r=="object"&&n&&r?n===r||l.all(n,function(e,t){return ze(r[t],e)})&&l.all(r,function(e,t){return ze(n[t],e)}):typeof n=="object"&&n||typeof r=="object"&&r?!1:Ct(n,r)}const kt={PLOT:"PLOT",PARABOLA:"PARABOLA",SINUSOID:"SINUSOID"};function Ft(n){let r=n[0],e=n[1],t=n[2];const s=n[3];r<0&&(r*=-1,e*=-1,t*=-1);const i=2*Math.PI;for(e<0&&(e*=-1,t*=-1,t+=i/2);t>0;)t-=i;for(;t<0;)t+=i;return[r,e,t,s]}function Dt(n){let r=n[0],e=n[1],t=n[2];const s=n[3];r<0&&(r*=-1,e*=-1,t*=-1);const i=Math.PI;for(e<0&&(e*=-1,t*=-1,t+=i/2);t>0;)t-=i;for(;t<0;)t+=i;return[r,e,t,s]}const De={areEqual:function(n,r){return ze(n,r)},movable:kt.PLOT,getPropsForCoeffs:function(n){return{fn:l.partial(this.getFunctionForCoeffs,n)}}},pn=l.extend({},De,{url:"https://ka-perseus-graphie.s3.amazonaws.com/67aaf581e6d9ef9038c10558a1f70ac21c11c9f8.png",defaultCoords:[[.25,.75],[.75,.75]],getCoefficients:function(n){const r=n[0],e=n[1],t=e[0]-r[0],s=e[1]-r[1];if(t===0)return;const i=s/t,a=e[1]-i*e[0];return[i,a]},getFunctionForCoeffs:function(n,r){const e=n[0],t=n[1];return e*r+t},getEquationString:function(n){const r=this.getCoefficients(n),e=r[0],t=r[1];return"y = "+e.toFixed(3)+"x + "+t.toFixed(3)}}),fn=l.extend({},De,{url:"https://ka-perseus-graphie.s3.amazonaws.com/e23d36e6fc29ee37174e92c9daba2a66677128ab.png",defaultCoords:[[.5,.5],[.75,.75]],movable:kt.PARABOLA,getCoefficients:function(n){const r=n[0],e=n[1],t=r[0],s=r[1],i=(e[1]-s)/((e[0]-t)*(e[0]-t)),a=-2*t*i,c=i*t*t+s;return[i,a,c]},getFunctionForCoeffs:function(n,r){const e=n[0],t=n[1],s=n[2];return(e*r+t)*r+s},getPropsForCoeffs:function(n){return{a:n[0],b:n[1],c:n[2]}},getEquationString:function(n){const r=this.getCoefficients(n),e=r[0],t=r[1],s=r[2];return"y = "+e.toFixed(3)+"x^2 + "+t.toFixed(3)+"x + "+s.toFixed(3)}}),dn=l.extend({},De,{url:"https://ka-perseus-graphie.s3.amazonaws.com/3d68e7718498475f53b206c2ab285626baf8857e.png",defaultCoords:[[.5,.5],[.6,.6]],movable:kt.SINUSOID,getCoefficients:function(n){const r=n[0],e=n[1],t=e[1]-r[1],s=Math.PI/(2*(e[0]-r[0])),i=r[0]*s,a=r[1];return[t,s,i,a]},getFunctionForCoeffs:function(n,r){const e=n[0],t=n[1],s=n[2],i=n[3];return e*Math.sin(t*r-s)+i},getPropsForCoeffs:function(n){return{a:n[0],b:n[1],c:n[2],d:n[3]}},getEquationString:function(n){const r=this.getCoefficients(n),e=r[0],t=r[1],s=r[2],i=r[3];return"y = "+e.toFixed(3)+" sin("+t.toFixed(3)+"x - "+s.toFixed(3)+") + "+i.toFixed(3)},areEqual:function(n,r){return ze(Ft(n),Ft(r))}}),gn=l.extend({},De,{url:"https://ka-perseus-graphie.s3.amazonaws.com/7db80d23c35214f98659fe1cf0765811c1bbfbba.png",defaultCoords:[[.5,.5],[.75,.75]],getCoefficients:function(n){const r=n[0],e=n[1],t=e[1]-r[1],s=Math.PI/(4*(e[0]-r[0])),i=r[0]*s,a=r[1];return[t,s,i,a]},getFunctionForCoeffs:function(n,r){const e=n[0],t=n[1],s=n[2],i=n[3];return e*Math.tan(t*r-s)+i},getEquationString:function(n){const r=this.getCoefficients(n),e=r[0],t=r[1],s=r[2],i=r[3];return"y = "+e.toFixed(3)+" sin("+t.toFixed(3)+"x - "+s.toFixed(3)+") + "+i.toFixed(3)},areEqual:function(n,r){return ze(Dt(n),Dt(r))}}),zt=l.extend({},De,{url:"https://ka-perseus-graphie.s3.amazonaws.com/9cbfad55525e3ce755a31a631b074670a5dad611.png",defaultCoords:[[.5,.55],[.75,.75]],defaultAsymptote:[[0,.5],[1,.5]],extraCoordConstraint:function(n,r,e,t,s){const i=t[0][1];return l.all(e,a=>a[1]!==i)},extraAsymptoteConstraint:function(n,r,e,t,s){const i=n[1];if(l.all(e,u=>u[1]>i)||l.all(e,u=>u[1]<i))return[r[0],i];const c=r[1];if(l.all(e,u=>u[1]>c)){const u=l.min(l.map(e,f=>f[1]));return[r[0],u-s.snapStep[1]]}const v=l.max(l.map(e,u=>u[1]));return[r[0],v+s.snapStep[1]]},allowReflectOverAsymptote:!0,getCoefficients:function(n,r){const e=n[0],t=n[1],s=r[0][1],i=Math.log((e[1]-s)/(t[1]-s))/(e[0]-t[0]);return[(e[1]-s)/Math.exp(i*e[0]),i,s]},getFunctionForCoeffs:function(n,r){const e=n[0],t=n[1],s=n[2];return e*Math.exp(t*r)+s},getEquationString:function(n,r){if(!r)return null;const e=this.getCoefficients(n,r),t=e[0],s=e[1],i=e[2];return"y = "+t.toFixed(3)+"e^("+s.toFixed(3)+"x) + "+i.toFixed(3)}}),mn=l.extend({},De,{url:"https://ka-perseus-graphie.s3.amazonaws.com/f6491e99d34af34d924bfe0231728ad912068dc3.png",defaultCoords:[[.55,.5],[.75,.75]],defaultAsymptote:[[.5,0],[.5,1]],extraCoordConstraint:function(n,r,e,t,s){const i=t[0][0];return l.all(e,a=>a[0]!==i)&&e[0][1]!==e[1][1]},extraAsymptoteConstraint:function(n,r,e,t,s){const i=n[0];if(l.all(e,u=>u[0]>i)||l.all(e,u=>u[0]<i))return[i,r[1]];const c=r[0];return l.all(e,u=>u[0]>c)?[l.min(l.map(e,f=>f[0]))-s.snapStep[0],r[1]]:[l.max(l.map(e,u=>u[0]))+s.snapStep[0],r[1]]},allowReflectOverAsymptote:!0,getCoefficients:function(n,r){const e=s=>[s[1],s[0]],t=zt.getCoefficients(l.map(n,e),l.map(r,e));if(t){const s=-t[2]/t[0],i=1/t[0];return[1/t[1],i,s]}},getFunctionForCoeffs:function(n,r,e){const t=n[0],s=n[1],i=n[2];return t*Math.log(s*r+i)},getEquationString:function(n,r){if(!r)return null;const e=this.getCoefficients(n,r),t=e[0],s=e[1],i=e[2];return"y = ln("+t.toFixed(3)+"x + "+s.toFixed(3)+") + "+i.toFixed(3)}}),yn=l.extend({},De,{url:"https://ka-perseus-graphie.s3.amazonaws.com/8256a630175a0cb1d11de223d6de0266daf98721.png",defaultCoords:[[.5,.5],[.75,.75]],getCoefficients:function(n){const r=n[0],e=n[1],t=e[0]-r[0],s=e[1]-r[1];if(t===0)return;let i=Math.abs(s/t);e[1]<r[1]&&(i*=-1);const a=r[0],c=r[1];return[i,a,c]},getFunctionForCoeffs:function(n,r){const e=n[0],t=n[1],s=n[2];return e*Math.abs(r-t)+s},getEquationString:function(n){const r=this.getCoefficients(n),e=r[0],t=r[1],s=r[2];return"y = "+e.toFixed(3)+"| x - "+t.toFixed(3)+"| + "+s.toFixed(3)}}),Bt={linear:pn,quadratic:fn,sinusoid:dn,tangent:gn,exponential:zt,logarithm:mn,absolute_value:yn},ua=l.keys(Bt);function ha(n){return Bt[n]}function Ut(n){return{type:"success",value:n}}function Ot(n){return{type:"failure",detail:n}}function de(n){return n.type==="failure"}function it(n){return n.type==="success"}function bn(n,r=e=>e){const e=[],t=[];for(const s of n)s.type==="success"?e.push(s.value):t.push(s.detail);return t.length>0?Ot(t.reduce(r)):Ut(e)}const Ce=(n,r)=>r.success(n);function E(n){return(r,e)=>{if(!Array.isArray(r))return e.failure("array",r);const t=r.map((s,i)=>n(s,e.forSubtree(i)));return bn(t,vn)}}function vn(n,r){return[...n,...r]}function P(n,r){return typeof n=="boolean"?r.success(n):r.failure("boolean",n)}function O(n){return(r,e)=>r!==n?e.failure(String(JSON.stringify(n)),r):e.success(n)}function H(...n){return(r,e)=>{if(typeof r=="string"){const s=n.indexOf(r);if(s>-1)return e.success(n[s])}const t=n.map(s=>JSON.stringify(s));return e.failure(t,r)}}function He(n){return n!=null&&Object.getPrototypeOf(n)===Object.prototype}function z(n){return(r,e)=>r===null?e.success(r):n(r,e)}const k=(n,r)=>typeof n=="number"?r.success(n):r.failure("number",n);function m(n){return(r,e)=>{if(!He(r))return e.failure("object",r);const t={...r},s=[];for(const[i,a]of Object.entries(n)){const c=a(r[i],e.forSubtree(i));it(c)?(c.value!==void 0||i in r)&&(t[i]=c.value):s.push(...c.detail)}return s.length>0?Ot(s):e.success(t)}}function o(n){return(r,e)=>r===void 0?e.success(r):n(r,e)}function Q(n,r){return(e,t)=>{if(!Array.isArray(e))return t.failure("array",e);if(e.length!==2)return t.failure("array of length 2",e);const[s,i]=e,a=n(s,t.forSubtree(0));if(de(a))return a;const c=r(i,t.forSubtree(1));return de(c)?c:t.success([a.value,c.value])}}function ge(n){return new Pt(n)}class Pt{constructor(r){this.parser=r}then(r){return new Pt(xn(this.parser,r))}}function xn(n,r){return(e,t)=>{const s=n(e,t);return de(s)?s:r(s.value,t)}}function jt(n,r){return(e,t)=>{if(!He(e))return t.failure("object",e);const s={},i=[];for(const[a,c]of Object.entries(e)){const d=t.forSubtree(a),v=n(a,d);de(v)&&i.push(...v.detail);const u=r(c,d);de(u)&&i.push(...u.detail),it(v)&&it(u)&&(s[v.value]=u.value)}return i.length>0?Ot(i):t.success(s)}}const h=(n,r)=>typeof n=="string"?r.success(n):r.failure("string",n);function at(n,r,e){return(t,s)=>{if(!Array.isArray(t))return s.failure("array",t);if(t.length!==3)return s.failure("array of length 3",t);const i=n(t[0],s.forSubtree(0));if(de(i))return i;const a=r(t[1],s.forSubtree(1));if(de(a))return a;const c=e(t[2],s.forSubtree(2));return de(c)?c:s.success([i.value,a.value,c.value])}}function he(n){return new Tt(n)}class Tt{constructor(r){this.parser=r}or(r){return new Tt(wn(this.parser,r))}}function wn(n,r){return(e,t)=>{const s=n(e,t);return it(s)?s:r(e,t)}}function F(n,r){return(e,t)=>e==null?Ut(r(e)):n(e,t)}const kn=F(jt(h,m({width:k,height:k})),()=>({}));function U(n,r){return m({type:n,static:o(P),graded:o(P),alignment:o(h),options:r,key:o(z(k)),version:o(m({major:k,minor:k}))})}function Ke(n,r,e){return m({type:r,static:o(P),graded:o(P),alignment:o(h),options:e,key:o(z(k)),version:n})}const On=U(O("categorizer"),m({items:E(h),categories:E(h),randomizeItems:F(P,()=>!1),static:F(P,()=>!1),values:E(F(k,()=>0)),highlightLint:o(P),linterContext:o(m({contentType:h,paths:E(h),stack:E(h)}))})),Pn=U(O("cs-program"),m({programID:h,programType:Ce,settings:E(m({name:h,value:h})),showEditor:P,showButtons:P,height:k,static:F(P,()=>!1)})),Tn=U(O("definition"),m({togglePrompt:h,definition:h,static:F(P,()=>!1)})),Sn=U(O("dropdown"),m({placeholder:F(h,()=>""),ariaLabel:o(h),visibleLabel:o(h),static:F(P,()=>!1),choices:E(m({content:h,correct:P}))})),An=U(O("explanation"),m({showPrompt:h,hidePrompt:h,explanation:h,widgets:F((n,r)=>pt(n,r),()=>({})),static:F(P,()=>!1)})),Ht=["PLUS","MINUS","NEGATIVE","TIMES","DIVIDE","DECIMAL","PERIOD","PERCENT","CDOT","EQUAL","NEQ","GT","LT","GEQ","LEQ","FRAC_INCLUSIVE","FRAC_EXCLUSIVE","FRAC","EXP","EXP_2","EXP_3","SQRT","CUBE_ROOT","RADICAL","LEFT_PAREN","RIGHT_PAREN","LN","LOG","LOG_N","SIN","COS","TAN","PI","THETA","UP","RIGHT","DOWN","LEFT","BACKSPACE","DISMISS","JUMP_OUT_PARENTHESES","JUMP_OUT_EXPONENT","JUMP_OUT_BASE","JUMP_INTO_NUMERATOR","JUMP_OUT_NUMERATOR","JUMP_OUT_DENOMINATOR","NUM_0","NUM_1","NUM_2","NUM_3","NUM_4","NUM_5","NUM_6","NUM_7","NUM_8","NUM_9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Kt=(n,r)=>{let e="v";e="";const t=`${e}${r}`;if(typeof globalThis<"u"){globalThis.__perseus_debug__=globalThis.__perseus_debug__??{};const s=globalThis.__perseus_debug__[n];if(s){if(s!==t){const i=Array.isArray(s)?s:[s];i.push(t),globalThis.__perseus_debug__[n]=i,console.warn(`Multiple versions of ${n} loaded on this page: ${i.sort().join(", ")}`)}}else globalThis.__perseus_debug__[n]=t}else console.warn(`globalThis not found found (${t})`)},Wn="@khanacademy/kas",En="__lib_version__";Kt(Wn,En);(function(){var n=function(v,u,f,b){for(f=f||{},b=v.length;b--;f[v[b]]=u);return f},r=[1,11],e=[1,9],t=[8,17],s=[6,11],i=[6,11,13,17],a={trace:function(){},yy:{},symbols_:{error:2,unitvalue:3,magnitude:4,unit:5,EOF:6,float:7,POW:8,int:9,multatoms:10,DIV:11,expatom:12,MUL:13,atom:14,"^":15,nat:16,ATOM:17,FLOAT:18,NAT:19,NEG:20,$accept:0,$end:1},terminals_:{2:"error",6:"EOF",8:"POW",11:"DIV",13:"MUL",15:"^",17:"ATOM",18:"FLOAT",19:"NAT",20:"NEG"},productions_:[0,[3,3],[3,2],[4,3],[4,1],[5,3],[5,1],[10,3],[10,2],[10,1],[12,3],[12,1],[14,1],[7,1],[7,1],[16,1],[9,2],[9,1]],performAction:function(u,f,b,p,g,y,D){var T=y.length-1;switch(g){case 1:return{type:"unitMagnitude",magnitude:y[T-2],unit:y[T-1]};case 2:return{type:"unitStandalone",unit:y[T-1]};case 3:this.$=y[T-2]+"e"+y[T];break;case 4:case 13:case 14:case 15:case 17:this.$=y[T];break;case 5:this.$={num:y[T-2],denom:y[T]};break;case 6:this.$={num:y[T],denom:null};break;case 7:this.$=[y[T-2]].concat(y[T]);break;case 8:this.$=[y[T-1]].concat(y[T]);break;case 9:this.$=[y[T]];break;case 10:this.$={name:y[T-2],pow:y[T]};break;case 11:this.$={name:y[T],pow:1};break;case 12:this.$=u;break;case 16:this.$="-"+y[T];break}},table:[{3:1,4:2,5:3,7:4,10:5,12:8,14:10,16:7,17:r,18:[1,6],19:e},{1:[3]},{5:12,10:5,12:8,14:10,17:r},{6:[1,13]},{8:[1,14],17:[2,4]},{6:[2,6],11:[1,15]},n(t,[2,13]),n(t,[2,14]),n(s,[2,9],{12:8,14:10,10:17,13:[1,16],17:r}),n([6,8,11,13,17],[2,15]),n(i,[2,11],{15:[1,18]}),n([6,11,13,15,17],[2,12]),{6:[1,19]},{1:[2,2]},{9:20,19:[1,22],20:[1,21]},{10:23,12:8,14:10,17:r},{10:24,12:8,14:10,17:r},n(s,[2,8]),{16:25,19:e},{1:[2,1]},{17:[2,3]},{19:[1,26]},{17:[2,17]},{6:[2,5]},n(s,[2,7]),n(i,[2,10]),{17:[2,16]}],defaultActions:{13:[2,2],19:[2,1],20:[2,3],22:[2,17],23:[2,5],26:[2,16]},parseError:function(u,f){if(f.recoverable)this.trace(u);else throw new Error(u)},parse:function(u){var f=this,b=[0],p=[null],g=[],y=this.table,D="",T=0,Z=0,K=2,ue=1,Ee=g.slice.call(arguments,1),ee=Object.create(this.lexer),re={yy:{}};for(var me in this.yy)Object.prototype.hasOwnProperty.call(this.yy,me)&&(re.yy[me]=this.yy[me]);ee.setInput(u,re.yy),re.yy.lexer=ee,re.yy.parser=this,typeof ee.yylloc>"u"&&(ee.yylloc={});var ne=ee.yylloc;g.push(ne);var Xe=ee.options&&ee.options.ranges;typeof re.yy.parseError=="function"?this.parseError=re.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function ft(){var ve;return ve=ee.lex()||ue,typeof ve!="number"&&(ve=f.symbols_[ve]||ve),ve}for(var se,ce,A,C,S={},M,$,L,Oe;;){if(ce=b[b.length-1],this.defaultActions[ce]?A=this.defaultActions[ce]:((se===null||typeof se>"u")&&(se=ft()),A=y[ce]&&y[ce][se]),typeof A>"u"||!A.length||!A[0]){var R="";Oe=[];for(M in y[ce])this.terminals_[M]&&M>K&&Oe.push("'"+this.terminals_[M]+"'");ee.showPosition?R="Parse error on line "+(T+1)+`:
`+ee.showPosition()+`
Expecting `+Oe.join(", ")+", got '"+(this.terminals_[se]||se)+"'":R="Parse error on line "+(T+1)+": Unexpected "+(se==ue?"end of input":"'"+(this.terminals_[se]||se)+"'"),this.parseError(R,{text:ee.match,token:this.terminals_[se]||se,line:ee.yylineno,loc:ne,expected:Oe})}if(A[0]instanceof Array&&A.length>1)throw new Error("Parse Error: multiple actions possible at state: "+ce+", token: "+se);switch(A[0]){case 1:b.push(se),p.push(ee.yytext),g.push(ee.yylloc),b.push(A[1]),se=null,Z=ee.yyleng,D=ee.yytext,T=ee.yylineno,ne=ee.yylloc;break;case 2:if($=this.productions_[A[1]][1],S.$=p[p.length-$],S._$={first_line:g[g.length-($||1)].first_line,last_line:g[g.length-1].last_line,first_column:g[g.length-($||1)].first_column,last_column:g[g.length-1].last_column},Xe&&(S._$.range=[g[g.length-($||1)].range[0],g[g.length-1].range[1]]),C=this.performAction.apply(S,[D,Z,T,re.yy,A[1],p,g].concat(Ee)),typeof C<"u")return C;$&&(b=b.slice(0,-1*$*2),p=p.slice(0,-1*$),g=g.slice(0,-1*$)),b.push(this.productions_[A[1]][0]),p.push(S.$),g.push(S._$),L=y[b[b.length-2]][b[b.length-1]],b.push(L);break;case 3:return!0}}return!0}},c=function(){var v={EOF:1,parseError:function(f,b){if(this.yy.parser)this.yy.parser.parseError(f,b);else throw new Error(f)},setInput:function(u,f){return this.yy=f||this.yy||{},this._input=u,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var u=this._input[0];this.yytext+=u,this.yyleng++,this.offset++,this.match+=u,this.matched+=u;var f=u.match(/(?:\r\n?|\n).*/g);return f?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),u},unput:function(u){var f=u.length,b=u.split(/(?:\r\n?|\n)/g);this._input=u+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-f),this.offset-=f;var p=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),b.length-1&&(this.yylineno-=b.length-1);var g=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:b?(b.length===p.length?this.yylloc.first_column:0)+p[p.length-b.length].length-b[0].length:this.yylloc.first_column-f},this.options.ranges&&(this.yylloc.range=[g[0],g[0]+this.yyleng-f]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(u){this.unput(this.match.slice(u))},pastInput:function(){var u=this.matched.substr(0,this.matched.length-this.match.length);return(u.length>20?"...":"")+u.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var u=this.match;return u.length<20&&(u+=this._input.substr(0,20-u.length)),(u.substr(0,20)+(u.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var u=this.pastInput(),f=new Array(u.length+1).join("-");return u+this.upcomingInput()+`
`+f+"^"},test_match:function(u,f){var b,p,g;if(this.options.backtrack_lexer&&(g={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(g.yylloc.range=this.yylloc.range.slice(0))),p=u[0].match(/(?:\r\n?|\n).*/g),p&&(this.yylineno+=p.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:p?p[p.length-1].length-p[p.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+u[0].length},this.yytext+=u[0],this.match+=u[0],this.matches=u,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(u[0].length),this.matched+=u[0],b=this.performAction.call(this,this.yy,this,f,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),b)return b;if(this._backtrack){for(var y in g)this[y]=g[y];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var u,f,b,p;this._more||(this.yytext="",this.match="");for(var g=this._currentRules(),y=0;y<g.length;y++)if(b=this._input.match(this.rules[g[y]]),b&&(!f||b[0].length>f[0].length)){if(f=b,p=y,this.options.backtrack_lexer){if(u=this.test_match(b,g[y]),u!==!1)return u;if(this._backtrack){f=!1;continue}else return!1}else if(!this.options.flex)break}return f?(u=this.test_match(f,g[p]),u!==!1?u:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var f=this.next();return f||this.lex()},begin:function(f){this.conditionStack.push(f)},popState:function(){var f=this.conditionStack.length-1;return f>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(f){return f=this.conditionStack.length-1-Math.abs(f||0),f>=0?this.conditionStack[f]:"INITIAL"},pushState:function(f){this.begin(f)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(f,b,p,g){switch(p){case 0:return 11;case 1:return"(";case 2:return")";case 3:return 8;case 4:return 15;case 5:return 13;case 6:return 18;case 7:return 19;case 8:return 20;case 9:return 17;case 10:return 17;case 11:return 17;case 12:break;case 13:return 6}},rules:[/^(?:\/)/,/^(?:\()/,/^(?:\))/,/^(?:(\*|x|\u00d7|\u2219|\u22c5|\u00b7)\s*10\s*\^)/,/^(?:\^)/,/^(?:\*)/,/^(?:[0-9]+\.[0-9]+)/,/^(?:[0-9]+)/,/^(?:-)/,/^(?:\u00b0( ?)[cCfF])/,/^(?:fl\.? oz\.?)/,/^(?:[\u00b5]?([A-Za-z-]+|[\u2103\u2109\u212b]))/,/^(?:\s+)/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};return v}();a.lexer=c;function d(){this.yy={}}return d.prototype=a,a.Parser=d,new d})();var Be=function(){var n=function(ce,A,C,S){for(C=C||{},S=ce.length;S--;C[ce[S]]=A);return C},r=[1,7],e=[1,17],t=[1,13],s=[1,14],i=[1,15],a=[1,32],c=[1,22],d=[1,23],v=[1,24],u=[1,25],f=[1,26],b=[1,33],p=[1,27],g=[1,28],y=[1,29],D=[1,30],T=[1,20],Z=[1,36],K=[1,37],ue=[5,6,8,10,33,35,41,43,45],Ee=[1,39],ee=[1,40],re=[5,6,8,10,12,14,16,19,21,22,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],me=[10,16,19,21,22,28,29,30,31,32,34,37,39,42,43,44,46],ne=[5,6,8,10,12,14,16,18,19,21,22,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],Xe={trace:function(){},yy:{},symbols_:{error:2,equation:3,expression:4,SIGN:5,EOF:6,additive:7,"+":8,multiplicative:9,"-":10,triglog:11,"*":12,negative:13,"/":14,trig:15,TRIG:16,trigfunc:17,"^":18,TRIGINV:19,logbase:20,ln:21,log:22,_:23,subscriptable:24,power:25,primitive:26,variable:27,VAR:28,CONST:29,INT:30,FLOAT:31,"{":32,"}":33,"(":34,")":35,function:36,FUNC:37,invocation:38,sqrt:39,"[":40,"]":41,abs:42,"|":43,"LEFT|":44,"RIGHT|":45,FRAC:46,$accept:0,$end:1},terminals_:{2:"error",5:"SIGN",6:"EOF",8:"+",10:"-",12:"*",14:"/",16:"TRIG",18:"^",19:"TRIGINV",21:"ln",22:"log",23:"_",28:"VAR",29:"CONST",30:"INT",31:"FLOAT",32:"{",33:"}",34:"(",35:")",37:"FUNC",39:"sqrt",40:"[",41:"]",42:"abs",43:"|",44:"LEFT|",45:"RIGHT|",46:"FRAC"},productions_:[0,[3,4],[3,2],[3,1],[4,1],[7,3],[7,3],[7,1],[9,2],[9,3],[9,3],[9,1],[13,2],[13,1],[15,1],[17,1],[17,3],[17,1],[20,1],[20,1],[20,3],[11,2],[11,2],[11,1],[25,3],[25,1],[27,1],[24,3],[24,1],[24,1],[24,1],[24,1],[24,3],[24,3],[36,1],[38,4],[38,4],[38,7],[38,4],[38,3],[38,3],[38,4],[26,1],[26,1],[26,7]],performAction:function(A,C,S,M,$,L,Oe){var R=L.length-1;switch($){case 1:return new M.Eq(L[R-3],L[R-2],L[R-1]);case 2:return L[R-1];case 3:return new M.Add([]);case 4:case 7:case 11:case 13:case 15:case 20:case 23:case 25:case 42:case 43:this.$=L[R];break;case 5:this.$=M.Add.createOrAppend(L[R-2],L[R]);break;case 6:this.$=M.Add.createOrAppend(L[R-2],M.Mul.handleNegative(L[R],"subtract"));break;case 8:this.$=M.Mul.fold(M.Mul.createOrAppend(L[R-1],L[R]));break;case 9:this.$=M.Mul.fold(M.Mul.createOrAppend(L[R-2],L[R]));break;case 10:this.$=M.Mul.fold(M.Mul.handleDivide(L[R-2],L[R]));break;case 12:this.$=M.Mul.handleNegative(L[R]);break;case 14:case 17:this.$=[A];break;case 16:this.$=L[R-2].concat(L[R]);break;case 18:this.$=M.Log.natural();break;case 19:this.$=M.Log.common();break;case 21:this.$=M.Trig.create(L[R-1],L[R]);break;case 22:this.$=M.Log.create(L[R-1],L[R]);break;case 24:this.$=new M.Pow(L[R-2],L[R]);break;case 26:case 34:this.$=A;break;case 27:this.$=new M.Var(L[R-2],L[R]);break;case 28:this.$=new M.Var(L[R]);break;case 29:this.$=new M.Const(A.toLowerCase());break;case 30:this.$=M.Int.create(Number(A));break;case 31:this.$=M.Float.create(Number(A));break;case 32:this.$=L[R-1].completeParse();break;case 33:this.$=L[R-1].completeParse().addHint("parens");break;case 35:case 36:this.$=M.Pow.sqrt(L[R-1]);break;case 37:this.$=new M.Pow.nthroot(L[R-1],L[R-4]);break;case 38:case 39:case 40:this.$=new M.Abs(L[R-1]);break;case 41:this.$=new M.Func(L[R-3],L[R-1]);break;case 44:this.$=M.Mul.handleDivide(L[R-4],L[R-1]);break}},table:[{3:1,4:2,6:[1,3],7:4,9:5,10:r,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:v,32:u,34:f,36:31,37:b,38:19,39:p,42:g,43:y,44:D,46:T},{1:[3]},{5:[1,34],6:[1,35]},{1:[2,3]},n([5,6],[2,4],{8:Z,10:K}),n(ue,[2,7],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:Ee,14:ee,16:e,19:t,21:s,22:i,28:a,29:c,30:d,31:v,32:u,34:f,37:b,39:p,42:g,44:D,46:T}),n(re,[2,11]),{10:r,11:8,13:41,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:v,32:u,34:f,36:31,37:b,38:19,39:p,42:g,43:y,44:D,46:T},n(re,[2,13]),{10:r,11:8,13:42,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:v,32:u,34:f,36:31,37:b,38:19,39:p,42:g,43:y,44:D,46:T},{10:r,11:8,13:43,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:v,32:u,34:f,36:31,37:b,38:19,39:p,42:g,43:y,44:D,46:T},n(re,[2,23]),n(me,[2,15],{18:[1,44]}),n(me,[2,17]),n(me,[2,18]),n(me,[2,19],{23:[1,45]}),n(re,[2,25],{18:[1,46]}),n([10,16,18,19,21,22,28,29,30,31,32,34,37,39,42,43,44,46],[2,14]),n(ne,[2,42]),n(ne,[2,43]),{32:[1,47]},n(ne,[2,28],{23:[1,48]}),n(ne,[2,29]),n(ne,[2,30]),n(ne,[2,31]),{7:49,9:5,10:r,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:v,32:u,34:f,36:31,37:b,38:19,39:p,42:g,43:y,44:D,46:T},{7:50,9:5,10:r,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:v,32:u,34:f,36:31,37:b,38:19,39:p,42:g,43:y,44:D,46:T},{32:[1,52],34:[1,51],40:[1,53]},{34:[1,54]},{7:55,9:5,10:r,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:v,32:u,34:f,36:31,37:b,38:19,39:p,42:g,43:y,44:D,46:T},{7:56,9:5,10:r,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:v,32:u,34:f,36:31,37:b,38:19,39:p,42:g,43:y,44:D,46:T},{34:[1,57]},n([5,6,8,10,12,14,16,18,19,21,22,23,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],[2,26]),{34:[2,34]},{4:58,7:4,9:5,10:r,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:v,32:u,34:f,36:31,37:b,38:19,39:p,42:g,43:y,44:D,46:T},{1:[2,2]},{9:59,10:r,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:v,32:u,34:f,36:31,37:b,38:19,39:p,42:g,43:y,44:D,46:T},{9:60,10:r,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:v,32:u,34:f,36:31,37:b,38:19,39:p,42:g,43:y,44:D,46:T},n(re,[2,8]),{10:r,11:8,13:61,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:v,32:u,34:f,36:31,37:b,38:19,39:p,42:g,43:y,44:D,46:T},{10:r,11:8,13:62,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:v,32:u,34:f,36:31,37:b,38:19,39:p,42:g,43:y,44:D,46:T},n(re,[2,12]),n(re,[2,21]),n(re,[2,22]),{10:r,11:8,13:63,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:v,32:u,34:f,36:31,37:b,38:19,39:p,42:g,43:y,44:D,46:T},{24:64,27:21,28:a,29:c,30:d,31:v,32:u,34:f},{10:r,11:8,13:65,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:v,32:u,34:f,36:31,37:b,38:19,39:p,42:g,43:y,44:D,46:T},{7:66,9:5,10:r,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:v,32:u,34:f,36:31,37:b,38:19,39:p,42:g,43:y,44:D,46:T},{24:67,27:21,28:a,29:c,30:d,31:v,32:u,34:f},{8:Z,10:K,33:[1,68]},{8:Z,10:K,35:[1,69]},{7:70,9:5,10:r,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:v,32:u,34:f,36:31,37:b,38:19,39:p,42:g,43:y,44:D,46:T},{7:71,9:5,10:r,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:v,32:u,34:f,36:31,37:b,38:19,39:p,42:g,43:y,44:D,46:T},{7:72,9:5,10:r,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:v,32:u,34:f,36:31,37:b,38:19,39:p,42:g,43:y,44:D,46:T},{7:73,9:5,10:r,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:v,32:u,34:f,36:31,37:b,38:19,39:p,42:g,43:y,44:D,46:T},{8:Z,10:K,43:[1,74]},{8:Z,10:K,45:[1,75]},{7:76,9:5,10:r,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:v,32:u,34:f,36:31,37:b,38:19,39:p,42:g,43:y,44:D,46:T},{6:[1,77]},n(ue,[2,5],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:Ee,14:ee,16:e,19:t,21:s,22:i,28:a,29:c,30:d,31:v,32:u,34:f,37:b,39:p,42:g,44:D,46:T}),n(ue,[2,6],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:Ee,14:ee,16:e,19:t,21:s,22:i,28:a,29:c,30:d,31:v,32:u,34:f,37:b,39:p,42:g,44:D,46:T}),n(re,[2,9]),n(re,[2,10]),n(me,[2,16]),n(me,[2,20]),n(re,[2,24]),{8:Z,10:K,33:[1,78]},n(ne,[2,27]),n(ne,[2,32]),n(ne,[2,33]),{8:Z,10:K,35:[1,79]},{8:Z,10:K,33:[1,80]},{8:Z,10:K,41:[1,81]},{8:Z,10:K,35:[1,82]},n(ne,[2,39]),n(ne,[2,40]),{8:Z,10:K,35:[1,83]},{1:[2,1]},{32:[1,84]},n(ne,[2,35]),n(ne,[2,36]),{32:[1,85]},n(ne,[2,38]),n(ne,[2,41]),{7:86,9:5,10:r,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:v,32:u,34:f,36:31,37:b,38:19,39:p,42:g,43:y,44:D,46:T},{7:87,9:5,10:r,11:8,13:6,15:12,16:e,17:9,19:t,20:10,21:s,22:i,24:18,25:11,26:16,27:21,28:a,29:c,30:d,31:v,32:u,34:f,36:31,37:b,38:19,39:p,42:g,43:y,44:D,46:T},{8:Z,10:K,33:[1,88]},{8:Z,10:K,33:[1,89]},n(ne,[2,44]),n(ne,[2,37])],defaultActions:{3:[2,3],33:[2,34],35:[2,2],77:[2,1]},parseError:function(A,C){if(C.recoverable)this.trace(A);else throw new Error(A)},parse:function(A){var C=this,S=[0],M=[null],$=[],L=this.table,Oe="",R=0,ve=0,an=2,Nt=1,on=$.slice.call(arguments,1),ie=Object.create(this.lexer),Ie={yy:{}};for(var dt in this.yy)Object.prototype.hasOwnProperty.call(this.yy,dt)&&(Ie.yy[dt]=this.yy[dt]);ie.setInput(A,Ie.yy),Ie.yy.lexer=ie,Ie.yy.parser=this,typeof ie.yylloc>"u"&&(ie.yylloc={});var gt=ie.yylloc;$.push(gt);var cn=ie.options&&ie.options.ranges;typeof Ie.yy.parseError=="function"?this.parseError=Ie.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function ln(){var $e;return $e=ie.lex()||Nt,typeof $e!="number"&&($e=C.symbols_[$e]||$e),$e}for(var pe,Me,fe,mt,qe={},et,xe,Lt,tt;;){if(Me=S[S.length-1],this.defaultActions[Me]?fe=this.defaultActions[Me]:((pe===null||typeof pe>"u")&&(pe=ln()),fe=L[Me]&&L[Me][pe]),typeof fe>"u"||!fe.length||!fe[0]){var yt="";tt=[];for(et in L[Me])this.terminals_[et]&&et>an&&tt.push("'"+this.terminals_[et]+"'");ie.showPosition?yt="Parse error on line "+(R+1)+`:
`+ie.showPosition()+`
Expecting `+tt.join(", ")+", got '"+(this.terminals_[pe]||pe)+"'":yt="Parse error on line "+(R+1)+": Unexpected "+(pe==Nt?"end of input":"'"+(this.terminals_[pe]||pe)+"'"),this.parseError(yt,{text:ie.match,token:this.terminals_[pe]||pe,line:ie.yylineno,loc:gt,expected:tt})}if(fe[0]instanceof Array&&fe.length>1)throw new Error("Parse Error: multiple actions possible at state: "+Me+", token: "+pe);switch(fe[0]){case 1:S.push(pe),M.push(ie.yytext),$.push(ie.yylloc),S.push(fe[1]),pe=null,ve=ie.yyleng,Oe=ie.yytext,R=ie.yylineno,gt=ie.yylloc;break;case 2:if(xe=this.productions_[fe[1]][1],qe.$=M[M.length-xe],qe._$={first_line:$[$.length-(xe||1)].first_line,last_line:$[$.length-1].last_line,first_column:$[$.length-(xe||1)].first_column,last_column:$[$.length-1].last_column},cn&&(qe._$.range=[$[$.length-(xe||1)].range[0],$[$.length-1].range[1]]),mt=this.performAction.apply(qe,[Oe,ve,R,Ie.yy,fe[1],M,$].concat(on)),typeof mt<"u")return mt;xe&&(S=S.slice(0,-1*xe*2),M=M.slice(0,-1*xe),$=$.slice(0,-1*xe)),S.push(this.productions_[fe[1]][0]),M.push(qe.$),$.push(qe._$),Lt=L[S[S.length-2]][S[S.length-1]],S.push(Lt);break;case 3:return!0}}return!0}},ft=function(){var ce={EOF:1,parseError:function(C,S){if(this.yy.parser)this.yy.parser.parseError(C,S);else throw new Error(C)},setInput:function(A,C){return this.yy=C||this.yy||{},this._input=A,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var A=this._input[0];this.yytext+=A,this.yyleng++,this.offset++,this.match+=A,this.matched+=A;var C=A.match(/(?:\r\n?|\n).*/g);return C?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),A},unput:function(A){var C=A.length,S=A.split(/(?:\r\n?|\n)/g);this._input=A+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-C),this.offset-=C;var M=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),S.length-1&&(this.yylineno-=S.length-1);var $=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:S?(S.length===M.length?this.yylloc.first_column:0)+M[M.length-S.length].length-S[0].length:this.yylloc.first_column-C},this.options.ranges&&(this.yylloc.range=[$[0],$[0]+this.yyleng-C]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(A){this.unput(this.match.slice(A))},pastInput:function(){var A=this.matched.substr(0,this.matched.length-this.match.length);return(A.length>20?"...":"")+A.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var A=this.match;return A.length<20&&(A+=this._input.substr(0,20-A.length)),(A.substr(0,20)+(A.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var A=this.pastInput(),C=new Array(A.length+1).join("-");return A+this.upcomingInput()+`
`+C+"^"},test_match:function(A,C){var S,M,$;if(this.options.backtrack_lexer&&($={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&($.yylloc.range=this.yylloc.range.slice(0))),M=A[0].match(/(?:\r\n?|\n).*/g),M&&(this.yylineno+=M.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:M?M[M.length-1].length-M[M.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+A[0].length},this.yytext+=A[0],this.match+=A[0],this.matches=A,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(A[0].length),this.matched+=A[0],S=this.performAction.call(this,this.yy,this,C,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),S)return S;if(this._backtrack){for(var L in $)this[L]=$[L];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var A,C,S,M;this._more||(this.yytext="",this.match="");for(var $=this._currentRules(),L=0;L<$.length;L++)if(S=this._input.match(this.rules[$[L]]),S&&(!C||S[0].length>C[0].length)){if(C=S,M=L,this.options.backtrack_lexer){if(A=this.test_match(S,$[L]),A!==!1)return A;if(this._backtrack){C=!1;continue}else return!1}else if(!this.options.flex)break}return C?(A=this.test_match(C,$[M]),A!==!1?A:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var C=this.next();return C||this.lex()},begin:function(C){this.conditionStack.push(C)},popState:function(){var C=this.conditionStack.length-1;return C>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(C){return C=this.conditionStack.length-1-Math.abs(C||0),C>=0?this.conditionStack[C]:"INITIAL"},pushState:function(C){this.begin(C)},stateStackSize:function(){return this.conditionStack.length},options:{flex:!0},performAction:function(C,S,M,$){switch(M){case 0:break;case 1:break;case 2:break;case 3:return"INT";case 4:return"FLOAT";case 5:return"^";case 6:return"*";case 7:return"*";case 8:return"*";case 9:return"*";case 10:return"/";case 11:return"/";case 12:return"-";case 13:return"-";case 14:return"+";case 15:return"^";case 16:return"(";case 17:return")";case 18:return"(";case 19:return")";case 20:return"[";case 21:return"]";case 22:return"{";case 23:return"}";case 24:return"{";case 25:return"}";case 26:return"_";case 27:return"|";case 28:return"LEFT|";case 29:return"RIGHT|";case 30:return"!";case 31:return"SIGN";case 32:return S.yytext="<=","SIGN";case 33:return S.yytext=">=","SIGN";case 34:return S.yytext="<=","SIGN";case 35:return S.yytext=">=","SIGN";case 36:return S.yytext="<>","SIGN";case 37:return S.yytext="<>","SIGN";case 38:return S.yytext="<>","SIGN";case 39:return S.yytext="<>","SIGN";case 40:return S.yytext="<=","SIGN";case 41:return S.yytext=">=","SIGN";case 42:return"FRAC";case 43:return"FRAC";case 44:return"sqrt";case 45:return"abs";case 46:return"ln";case 47:return"log";case 48:return"TRIG";case 49:return"TRIG";case 50:return"TRIG";case 51:return"TRIG";case 52:return S.yytext="sin","TRIG";case 53:return S.yytext="cos","TRIG";case 54:return S.yytext="tan","TRIG";case 55:return S.yytext="csc","TRIG";case 56:return S.yytext="sec","TRIG";case 57:return S.yytext="cot","TRIG";case 58:return S.yytext="arcsin","TRIG";case 59:return S.yytext="arccos","TRIG";case 60:return S.yytext="arctan","TRIG";case 61:return S.yytext="arccsc","TRIG";case 62:return S.yytext="arcsec","TRIG";case 63:return S.yytext="arccot","TRIG";case 64:return"TRIGINV";case 65:return"TRIGINV";case 66:return S.yytext="sinh","TRIG";case 67:return S.yytext="cosh","TRIG";case 68:return S.yytext="tanh","TRIG";case 69:return S.yytext="csch","TRIG";case 70:return S.yytext="sech","TRIG";case 71:return S.yytext="tanh","TRIG";case 72:return"CONST";case 73:return S.yytext="pi","CONST";case 74:return S.yytext="pi","CONST";case 75:return"VAR";case 76:return S.yytext="theta","VAR";case 77:return S.yytext="theta","VAR";case 78:return"VAR";case 79:return S.yytext="phi","VAR";case 80:return S.yytext="phi","VAR";case 81:return C.symbolLexer(S.yytext);case 82:return"EOF";case 83:return"INVALID";case 84:console.log(S.yytext);break}},rules:[/^(?:\s+)/,/^(?:\\space)/,/^(?:\\ )/,/^(?:[0-9]+\.?)/,/^(?:([0-9]+)?\.[0-9]+)/,/^(?:\*\*)/,/^(?:\*)/,/^(?:\\cdot|·)/,/^(?:\\times|×)/,/^(?:\\ast)/,/^(?:\/)/,/^(?:\\div|÷)/,/^(?:-)/,/^(?:−)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:\\left\()/,/^(?:\\right\))/,/^(?:\[)/,/^(?:\])/,/^(?:\{)/,/^(?:\})/,/^(?:\\left\{)/,/^(?:\\right\})/,/^(?:_)/,/^(?:\|)/,/^(?:\\left\|)/,/^(?:\\right\|)/,/^(?:\!)/,/^(?:<=|>=|<>|<|>|=)/,/^(?:\\le)/,/^(?:\\ge)/,/^(?:\\leq)/,/^(?:\\geq)/,/^(?:=\/=)/,/^(?:\\ne)/,/^(?:\\neq)/,/^(?:≠)/,/^(?:≤)/,/^(?:≥)/,/^(?:\\frac)/,/^(?:\\dfrac)/,/^(?:sqrt|\\sqrt)/,/^(?:abs|\\abs)/,/^(?:ln|\\ln)/,/^(?:log|\\log)/,/^(?:sin|cos|tan)/,/^(?:csc|sec|cot)/,/^(?:sinh|cosh|tanh)/,/^(?:csch|sech|coth)/,/^(?:\\sin)/,/^(?:\\cos)/,/^(?:\\tan)/,/^(?:\\csc)/,/^(?:\\sec)/,/^(?:\\cot)/,/^(?:\\arcsin)/,/^(?:\\arccos)/,/^(?:\\arctan)/,/^(?:\\arccsc)/,/^(?:\\arcsec)/,/^(?:\\arccot)/,/^(?:arcsin|arccos|arctan)/,/^(?:arccsc|arcsec|arccot)/,/^(?:\\sinh)/,/^(?:\\cosh)/,/^(?:\\tanh)/,/^(?:\\csch)/,/^(?:\\sech)/,/^(?:\\coth)/,/^(?:pi)/,/^(?:π)/,/^(?:\\pi)/,/^(?:theta)/,/^(?:θ)/,/^(?:\\theta)/,/^(?:phi)/,/^(?:φ)/,/^(?:\\phi)/,/^(?:[a-zA-Z])/,/^(?:$)/,/^(?:.)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84],inclusive:!0}}};return ce}();Xe.lexer=ft;function se(){this.yy={}}return se.prototype=Xe,Xe.Parser=se,new se}();const Rt=function(n){return n!==n},In=function(n,r){var e=r-n;return Math.random()*e+n};var Gt=12,Mn=9;function Ue(n,r){const e=[],t=[];return l.forEach(n,(s,i,a)=>{r(s,i,a)?e.push(s):t.push(s)}),[e,t]}function Nn(n){return n instanceof ye}const st=function(n){return n instanceof te};function Ln(n){return n instanceof V}function bt(n){return n instanceof w?n.terms:[n]}class ye{constructor(){G(this,"hints");this.hints={parens:!1}}construct(r){const e=this.func,t=new e(...r);if(typeof t>"u")throw new Error("constructor function returning undefined");return t}recurse(r,...e){var t=this.args().map(function(s){return l.isString(s)||l.isNumber(s)?s:s==null?void 0:s[r].apply(s,e)});return this.construct(t)}eval(r={},e){throw new Error("Abstract method - must override for expr: "+this.print())}codegen(){throw new Error("Abstract method - must override for expr: "+this.print())}compile(){var r=this.codegen();try{return new Function("vars","return "+r+";")}catch{throw new Error("Function did not compile: "+r)}}asTex(r){r=r||{},l.defaults(r,{display:!0,dynamic:!0,times:!1});let e=this.tex();return r.display&&(e="\\displaystyle "+e),r.dynamic&&(e=e.replace(/\(/g,"\\left("),e=e.replace(/\)/g,"\\right)")),r.times&&(e=e.replace(/\\cdot/g,"\\times")),e}name(){return this.func.name}repr(){return this.name()+"("+this.args().map(function(r){return l.isString(r)||l.isNumber(r)?r:r==null?void 0:r.repr()}).join(",")+")"}strip(){return this.recurse("strip")}normalize(){return this.recurse("normalize")}expand(){return this.recurse("expand")}factor(r){return this.recurse("factor",r)}collect(r){return this.recurse("collect",r)}equals(r){return this.normalize().print()===r.normalize().print()}simplify(r){r={once:!1,...r};var e=this.factor(r),t=e.collect(r);e.equals(t)&&(t=this.collect(r));var s=t.expand(),i=s.collect(r);s.equals(i)&&(i=t.collect(r));var a=i;return r.once||this.equals(a)?a:a.simplify(r)}isSimplified(){return this.equals(this.simplify())}exprArgs(){return this.args().filter(Nn)}getVars(r){return l.uniq(l.flatten(l.invoke(this.exprArgs(),"getVars",r))).sort()}getConsts(){return l.uniq(l.flatten(l.invoke(this.exprArgs(),"getConsts"))).sort()}getUnits(){return l.flatten(l.invoke(this.exprArgs(),"getUnits"))}is(r){return this instanceof r}has(r){return this instanceof r?!0:l.any(this.exprArgs(),function(e){return e.has(r)})}raiseToThe(r,e){return new _(this,r)}isSubtract(){return!1}isDivide(){return!1}isRoot(){return!1}needsExplicitMul(){return this.exprArgs()[0].needsExplicitMul()}sameVars(r){var e=this.getVars(),t=r.getVars(),s=function(d,v){return!l.difference(d,v).length},i=function(d){return l.uniq(l.invoke(d,"toLowerCase")).sort()},a=s(e,t),c=s(i(e),i(t));return{equal:a,equalIgnoringCase:c}}compare(r){if(r instanceof je)return!1;var e=l.union(this.getVars(!0),r.getVars(!0)),t=function(g,y){return Math.abs(g)<1||Math.abs(y)<1?Math.abs(g-y):Math.abs(1-g/y)},s=function(g,y){var D=t(g,y);return g===y||Rt(g)&&Rt(y)||D<Math.pow(10,-9)};if(!l.union(this.getVars(!1),r.getVars(!1)).length&&!this.has(le)&&!r.has(le))return s(this.eval(),r.eval());var a=this.collect(),c=r.collect(),d=this.getUnits(),v=r.getUnits();if(!l.isEqual(d,v))return!1;for(var u=0;u<Gt;u++){var f={},b=Math.pow(10,1+Math.floor(3*u/Gt)),p=u%2===0;l.each(e,function(y){f[y]=p?In(-b,b):l.random(-b,b)});let g;if(a.has(Te)||c.has(Te)||a.has(le)||c.has(le)){const y=a.partialEval(f),D=c.partialEval(f);g=y.simplify().equals(D.simplify())}else{const y=a.eval(f),D=c.eval(f);g=s(y,D)}if(!g)return!1}return!0}partialEval(r){return this instanceof le?this:this.has(Te)?this instanceof Te?new Te(this.symbol,this.arg.partialEval(r)):this.recurse("partialEval",r):new ae(+this.eval(r).toFixed(Mn)).collect()}sameForm(r){return this.strip().equals(r.strip())}findGCD(r){return this.equals(r)?r:J}getDenominator(){return J}asMul(){return new w(J,this)}isPositive(){throw new Error("Abstract method - must override for expr: "+this.print())}isNegative(){return!1}asPositiveFactor(){return this.isPositive()?this:J}addHint(r){if(!r)return this;var e=this.construct(this.args());return e.hints=l.clone(this.hints),e.hints[r]=!0,e}completeParse(){return this.recurse("completeParse")}abs(){throw new Error("Abstract method - must override for expr: "+this.print())}negate(){return new w(ke,this)}}class ot extends ye{constructor(...e){super();G(this,"terms");e.length===1?this.terms=e[0]:this.terms=e}args(){return this.terms}normalize(){var e=l.sortBy(l.invoke(this.terms,"normalize"),t=>t.print());return new this.func(e)}expand(){return this.recurse("expand").flatten()}partition(){var[e,t]=Ue(this.terms,s=>s instanceof q);return[new this.func(e),new this.func(t)]}flatten(){var e=this,t=l.reject(this.terms,c=>c.equals(e.identity));if(t.length===0)return e.identity;if(t.length===1)return t[0];const[s,i]=Ue(t,c=>c instanceof e.func);var a=i.concat(l.flatten(l.pluck(s,"terms"),!0));return new e.func(a)}isPositive(){var e=l.invoke(this.terms,"collect");return l.all(l.invoke(e,"isPositive"))}replace(e,t){const s=e instanceof ye?l.indexOf(this.terms,e):e;var i=[];Array.isArray(t)?i=t:t&&(i=[t]);var a=this.terms.slice(0,s).concat(i).concat(this.terms.slice(s+1));return new this.func(a)}remove(e){return this.replace(e)}getDenominator(){return new w(l.invoke(this.terms,"getDenominator")).flatten()}}class te extends ot{constructor(){super(...arguments);G(this,"identity",Je);G(this,"func",te)}eval(e={},t){return l.reduce(this.terms,(s,i)=>s+i.eval(e,t),0)}codegen(){return l.map(this.terms,e=>"("+e.codegen()+")").join(" + ")||"0"}print(){return l.invoke(this.terms,"print").join("+")}tex(){let e="";return l.each(this.terms,t=>{!e||t.isSubtract()?e+=t.tex():e+="+"+t.tex()}),e}collect(e){var t=l.invoke(this.terms,"collect",e),s=[];l.each(t,c=>{if(c instanceof w){var d=c.partition();s.push([d[1].flatten(),d[0].reduce(e)])}else c instanceof q?s.push([J,c]):s.push([c,J])});var i=l.groupBy(s,c=>c[0].normalize().print()),a=l.compact(l.map(i,c=>{var d=c[0][0],v=new te(l.zip.apply(l,c)[1]),u=v.reduce(e);return new w(u,d).collect(e)}));return new te(a).flatten()}factor(e={keepNegative:!1}){const t=this.terms.map(d=>d.collect());let s;t[0]instanceof w?s=t[0].terms:s=[t[0]],l.each(l.rest(this.terms),d=>{s=l.map(s,v=>d.findGCD(v))}),!e.keepNegative&&this.isNegative()&&s.push(ke);const i=new w(s).flatten().collect(),a=t.map(d=>w.handleDivide(d,i).simplify()),c=new te(a).flatten();return w.createOrAppend(i,c).flatten()}reduce(e){return l.reduce(this.terms,(t,s)=>t.add(s,e),this.identity)}needsExplicitMul(){return!1}isNegative(){var e=l.invoke(this.terms,"collect");return l.all(l.invoke(e,"isNegative"))}negate(){return new te(l.invoke(this.terms,"negate"))}static createOrAppend(e,t){return e instanceof te?new te(e.terms.concat(t)):new te(e,t)}}class w extends ot{constructor(){super(...arguments);G(this,"identity",J);G(this,"func",w)}eval(e={},t){return l.reduce(this.terms,(s,i)=>s*i.eval(e,t),1)}codegen(){return l.map(this.terms,e=>"("+e.codegen()+")").join(" * ")||"0"}print(){return l.map(this.terms,e=>e instanceof te?"("+e.print()+")":e.print()).join("*")}getUnits(){var e=l(this.terms).chain().map(t=>t.getUnits()).flatten().value();return e.sort((t,s)=>t.unit.localeCompare(s.unit)),e}tex(){for(var e=" \\cdot ",t=l.groupBy(this.terms,y=>y.isDivide()?"inverse":y instanceof q?"number":"other"),s=t.inverse||[],i=t.number||[],a=t.other||[],c="",d,v=0;v<i.length;v++){var u=i[v]instanceof V&&!(i[v]instanceof I);if(u&&a.length>0&&s.length>0){var f=i.slice();f.splice(v,1);var b=f.concat(s).concat(a);return i[v].tex()+new w(b).tex()}}if(i=l.compact(l.map(i,y=>{var D=!y.hints.fraction||s.length>0;if(y instanceof V&&!(y instanceof I)&&D){s.push(new _(new I(y.d),Se));var T=new I(y.n);return T.hints=y.hints,l.any(y.hints)?T:null}else return y})),i.length===0&&a.length===1)d=a[0].tex();else{var p="";l.each(i,y=>{y.hints.subtract&&y.hints.entered?(c+="-",p+=(p?e:"")+y.abs().tex()):y instanceof I&&y.n===-1&&(y.hints.negate||y.hints.subtract)?c+="-":p+=(p?e:"")+y.tex()}),l.each(a,y=>{y.needsExplicitMul()?p+=(p?e:"")+y.tex():y instanceof te?p+="("+y.tex()+")":p+=y.tex()}),d=p||"1"}if(s.length){var g=new w(l.invoke(s,"asDivide")).flatten().tex();return c+"\\frac{"+d+"}{"+g+"}"}else return c+d}strip(){var e=l.map(this.terms,t=>t instanceof q?t.abs():t.strip());return new w(e).flatten()}expand(){const e=function(u){return u instanceof _&&u.exp.isNegative()},t=function(u){return e(u)&&st(u.base)},s=this.recurse("expand").flatten(),i=bt(s),a=l.any(i,st),c=l.any(i,t);if(!(a||c))return s;let[d,v]=Ue(i,e);if(a){const[u,f]=Ue(v,st),b=l.reduce(u,function(g,y){return l.reduce(g,function(D,T){return D.concat(l.map(y.terms,Z=>T.concat(Z)))},[])},[[]]),p=l.map(b,function(g){return new w(f.concat(g)).flatten()});v=[new te(p)]}if(c){const u=new w(l.invoke(d,"getDenominator")).flatten();d=[new _(u.expand(),Se)]}return new w(v.concat(d)).flatten()}factor(e){var t=this.recurse("factor",e).flatten();if(!(t instanceof w))return t;var[s,i]=Ue(t.terms,d=>d instanceof V);const a=l.reduce(s,(d,v)=>({n:d.n*v.n,d:d.d*v.d}),{n:1,d:1}),c=a.d===1?new I(a.n):new V(a.n,a.d);return new w(i.concat(c)).flatten()}collect(e){var t=this.recurse("collect",e).partition(),s=t[0].reduce(e);if(s.eval()===0)return Je;const i=t[1].flatten();if(!(i instanceof w))return new w(s,i).flatten();const a=i.terms;var c=[];l.each(a,T=>{T instanceof _?c.push([T.base,T.exp]):c.push([T,J])});var d=l.groupBy(c,T=>T[0].normalize().print()),v=l.compact(l.map(d,T=>{var Z=T[0][0],K=new te(l.zip.apply(l,T)[1]),ue=K.collect(e);return ue instanceof q&&ue.eval()===0?null:[Z,ue]}));const u=l.groupBy(v,T=>T[0]instanceof B&&T[0].isBasic()?"trig":T[0]instanceof oe?"log":"expr");let f=u.trig||[],b=u.log||[];const p=u.expr||[];if(f.length>1){var g=l.groupBy(f,T=>T[0].arg.normalize().print());f=[],l.each(g,T=>{const Z=T[0][0].arg;let K={sin:Je,cos:Je};l.each(T,ue=>{K[ue[0].type]=ue[1]}),w.handleNegative(K.sin).collect(e).equals(K.cos)&&(K.cos.isNegative()?K={tan:K.sin}:K={cot:K.cos}),l.each(K,(ue,Ee)=>{f.push([new B(Ee,Z),ue])})})}if(b.length>1){var y=l.groupBy(b,T=>T[0].base.normalize().print());b=[],l.each(y,T=>{T.length===2&&w.handleNegative(T[0][1]).collect(e).equals(T[1][1])?T[0][1].isNegative()?b.push([new oe(T[0][0].power,T[1][0].power),T[1][1]]):b.push([new oe(T[1][0].power,T[0][0].power),T[0][1]]):b=b.concat(T)})}var D=l.map([...f,...b,...p],T=>new _(T[0],T[1]).collect(e));return new w([s].concat(D)).flatten()}isSubtract(){return l.any(this.terms,e=>e instanceof q&&!!e.hints.subtract)}factorIn(e){var t=this.partition(),s=t[0].terms,i=s.length&&l.all(s,c=>c.n>0);if(i){var a=s[0].negate();return a.hints=s[0].hints,this.replace(s[0],a.addHint(e))}else return new w([q.negativeOne(e)].concat(this.terms))}factorOut(){var e=!1,t=l.compact(l.map(this.terms,s=>!e&&s instanceof q&&s.hints.divide?(e=!0,s.n!==-1?s.negate():null):s));return t.length===1?t[0]:new w(t)}reduce(e){return l.reduce(this.terms,(t,s)=>t.mul(s,e),this.identity)}findGCD(e){return new w(l.invoke(this.terms,"findGCD",e)).flatten()}asMul(){return this}asPositiveFactor(){if(this.isPositive())return this;{const e=bt(this.collect()).map(t=>t.asPositiveFactor());return new w(e).flatten()}}isNegative(){const e=bt(this.collect()).map(t=>t.isNegative());return l.any(e)}fold(){return w.fold(this)}negate(){var e=s=>s instanceof q;const t=l.find(this.terms,e);return t?this.replace(t,t.negate()):new w([ke].concat(this.terms))}static handleNegative(e,t){if(e instanceof q&&e.n>0){var s=e.negate();return s.hints=e.hints,s.addHint(t)}else return e instanceof w?e.factorIn(t):new w(q.negativeOne(t),e)}static handleDivide(e,t){if(t instanceof w){var s=w.handleDivide(e,t.terms[0]),i=new w(l.rest(t.terms)).flatten();return w.handleDivide(s,i)}var a=p=>p instanceof I,c=p=>p instanceof V;if(a(t)&&e instanceof w&&l.any(e.terms,a)){var d=e.terms.slice().reverse(),v=d.find(c);if(!a(v))return new w(e.terms.concat([new V(1,t.n).addHint("fraction")]));var u=new V(v.n,t.n);return u.hints=v.hints,v===d[0]&&(u=u.addHint("fraction")),v.n<0&&t.n<0?(u.d=-u.d,e.replace(v,[ke,u])):e.replace(v,u)}var f=(p,g)=>{if(g instanceof I){if(p instanceof I)return p.n<0&&g.n<0?[ke,new V(p.n,-g.n).addHint("fraction")]:[new V(p.n,g.n).addHint("fraction")];var y=new V(1,g.eval());return g.eval()<0?[p,y.addHint("negate")]:[p,y]}else{var D;if(g instanceof B&&g.exp){var T=g.exp;g.exp=void 0,g=new _(g,T)}return g instanceof _?D=new _(g.base,w.handleNegative(g.exp,"divide")):D=new _(g,Se),p instanceof I&&p.n===1?[D]:[p,D]}};if(e instanceof w){var b=f(l.last(e.terms),t);return new w(l.initial(e.terms).concat(b))}else{var b=f(e,t);return new w(b).flatten()}}static fold(e){if(e instanceof w){var t=l.find(l.initial(e.terms),p=>(p instanceof B||p instanceof oe)&&!!p.hints.open);if(t){const p=l.last(e.terms);if(t.hints.parens||p.hints.parens||p.has(B)||p.has(oe))t.hints.open=!1;else{const g=t instanceof B?B.create([t.type,t.exp],w.createOrAppend(t.arg,p).fold()):oe.create(t.base,w.createOrAppend(t.power,p).fold()),y=l.indexOf(e.terms,t);return y===0?g:new w(e.terms.slice(0,y).concat(g)).fold()}}var s=e.partition(),i=s[0].terms,a=p=>p.n>0,c=p=>p.n===-1&&!!p.hints.negate,d=function(p){return a(p)||c(p)};const f=i.find(a),b=i.find(c);if(i.length>1&&b&&f&&l.every(i,d)){var v=l.indexOf(e.terms,b),u=l.indexOf(e.terms,f);if(v<u)return e.replace(u,e.terms[u].negate()).remove(v)}}return e}static createOrAppend(e,t){return e instanceof w?new w(e.terms.concat(t)):new w(e,t)}}const X=class X extends ye{constructor(e,t){super();G(this,"base");G(this,"exp");G(this,"func",X);this.base=e,this.exp=t}args(){return[this.base,this.exp]}eval(e={},t){var s=this.base.eval(e,t),i=this.exp.eval(e,t);if(s<0){var a=this.exp.simplify();if(a instanceof ae){var c=a.n,d=(c-+c.toFixed()).toString().length-2,v=Math.pow(10,d),u=new V(c*v,v);a=u.simplify()}if(a instanceof V){var f=Math.abs(a.d)%2===1;if(f){var b=Math.abs(a.n)%2===1,p=b?-1:1;return p*Math.pow(-1*s,i)}}}return Math.pow(s,i)}getUnits(){return this.base.getUnits().map(e=>({unit:e.unit,pow:e.pow*this.exp.n}))}codegen(){return"Math.pow("+this.base.codegen()+", "+this.exp.codegen()+")"}print(){var e=this.base.print();return(this.base instanceof ot||this.base instanceof X)&&(e="("+e+")"),e+"^("+this.exp.print()+")"}tex(){if(this.isDivide())return"\\frac{1}{"+this.asDivide().tex()+"}";if(this.isRoot()&&Ln(this.exp)){if(this.exp.n!==1)throw new Error("Node marked with hint 'root' does not have exponent of form 1/x.");return this.exp.d===2?"\\sqrt{"+this.base.tex()+"}":"\\sqrt["+this.exp.d+"]{"+this.base.tex()+"}"}else if(this.base instanceof B&&!this.base.isInverse()&&this.exp instanceof q&&this.exp.isSimple()&&this.exp.eval()>=0){var e=this.base.texSplit();return e[0]+"^{"+this.exp.tex()+"}"+e[1]}else{var t=this.base.tex();return this.base instanceof ot||this.base instanceof X||this.base instanceof q&&!this.base.isSimple()?t="("+t+")":(this.base instanceof B||this.base instanceof oe)&&(t="["+t+"]"),t+"^{"+this.exp.tex()+"}"}}needsExplicitMul(){return this.isRoot()?!1:this.base.needsExplicitMul()}expand(){var e=this.recurse("expand");if(e.base instanceof w){var t=l.map(e.base.terms,d=>new X(d,e.exp));return new w(t).expand()}else if(e.base instanceof te&&e.exp instanceof I&&e.exp.abs().eval()>1){var s=e.exp.eval()>0,i=e.exp.abs().eval(),a=function(b){return s?b:new X(b,Se)};const d={1:e.base};for(var c=2;c<=i;c*=2){const b=new w(d[c/2],d[c/2]);d[c]=b.expand().collect()}if(i in d)return a(d[i]);let v=l.map(i.toString(2).split(""),function(b,p,g){return Number(b)*Math.pow(2,g.length-p-1)});v=l.without(v,0);const u=[];for(const b of v)b in d&&u.push(d[b]);const f=new w(u).expand().collect();return a(f)}else if(e.exp instanceof te){const d=l.map(e.exp.terms,v=>new X(e.base,v).expand());return new w(d).expand()}else return e}factor(){var e=this.recurse("factor");if(e.base instanceof w){var t=l.map(e.base.terms,s=>s instanceof I&&e.exp.equals(Se)?new V(1,s.n):new X(s,e.exp));return new w(t)}else return e}collect(e){if(this.base instanceof X){const i=this.base.base,a=w.createOrAppend(this.base.exp,this.exp);return new X(i,a).collect(e)}const t=this.recurse("collect",e),s=function(i){return i instanceof oe&&i.base.equals(t.base)};if(t.exp instanceof q&&t.exp.eval()===0)return J;if(t.exp instanceof q&&t.exp.eval()===1)return t.base;if(s(t.exp))return t.exp.power;if(t.exp instanceof w&&l.any(t.exp.terms,s)){const i=t.exp.terms.find(s),a=i.power,c=t.exp.remove(i).flatten();return new X(a,c).collect(e)}else if(t.base instanceof q&&t.exp instanceof q){if(e&&e.preciseFloats){const i=t.exp.asRational(),a=t.base.getDecimalPlaces();if(new X(t.base,new V(1,i.d)).collect().getDecimalPlaces()>a){const v=new X(t.base,new I(i.n)).collect();return new X(v,new V(1,i.d))}}return t.base.raiseToThe(t.exp,e)}else return t}isDivide(){var e=function(t){return t instanceof q&&!!t.hints.divide};return e(this.exp)||this.exp instanceof w&&l.any(this.exp.terms,e)}asDivide(){if(this.exp instanceof q){if(this.exp.eval()===-1)return this.base;var e=this.exp.negate();return e.hints=l.clone(this.exp.hints),e.hints.divide=!1,new X(this.base,e)}else{if(this.exp instanceof w)return new X(this.base,this.exp.factorOut());throw new Error("called asDivide() on an Expr that wasn't a Num or Mul")}}isRoot(){return this.exp instanceof V&&!!this.exp.hints.root}isSquaredTrig(){return this.base instanceof B&&!this.base.isInverse()&&this.exp instanceof q&&this.exp.eval()===2}getDenominator(){if(this.exp instanceof q&&this.exp.eval()===-1)return w.createOrAppend(this.base,this.base.getDenominator()).flatten();if(this.exp.isNegative()){var e=new X(this.base,w.handleNegative(this.exp).collect());return w.createOrAppend(e,e.collect().getDenominator()).flatten()}else return this.base instanceof q?new X(this.base.getDenominator(),this.exp).collect():J}findGCD(e){const[t,s]=e instanceof X?[e.base,e.exp]:[e,J];if(this.base.equals(t)){if(this.exp.equals(s))return this;if(this.exp instanceof q&&s instanceof q)return new X(this.base,q.min(this.exp,s)).collect();if(this.exp instanceof q||s instanceof q)return J;var i=this.exp.asMul().partition(),a=s.asMul().partition();if(i[1].equals(a[1])){var c=q.min(i[0].reduce(),a[0].reduce()),d=new w(c,i[1].flatten()).flatten();return new X(t,d).collect()}}return J}isPositive(){if(this.base.isPositive())return!0;var e=this.exp.simplify();return e instanceof I&&e.eval()%2===0}asPositiveFactor(){if(this.isPositive())return this;var e=this.exp.simplify();if(e instanceof I){var t=e.eval();if(t>2)return new X(this.base,new I(t-1));if(t<-2)return new X(this.base,new I(t+1))}return J}static sqrt(e){return new X(e,Fn)}};G(X,"nthroot",function(e,t){var s=w.fold(w.handleDivide(new I(1),t));return new X(e,s.addHint("root"))});let _=X;class oe extends ye{constructor(e,t){super();G(this,"base");G(this,"power");G(this,"func",oe);this.base=e,this.power=t,this.hints={...this.hints,open:!1}}args(){return[this.base,this.power]}eval(e={},t){return Math.log(this.power.eval(e,t))/Math.log(this.base.eval(e,t))}codegen(){return"(Math.log("+this.power.codegen()+") / Math.log("+this.base.codegen()+"))"}print(){var e="("+this.power.print()+")";return this.isNatural()?"ln"+e:"log_("+this.base.print()+") "+e}tex(){var e="("+this.power.tex()+")";return this.isNatural()?"\\ln"+e:"\\log_{"+this.base.tex()+"}"+e}collect(e){var t=this.recurse("collect",e);return t.power instanceof q&&t.power.eval()===1?Je:t.base.equals(t.power)?J:t.power instanceof _&&t.power.base.equals(t.base)?t.power.exp:t}expand(){var e=this.recurse("expand");if(e.power instanceof w){var t=l.map(e.power.terms,s=>new oe(e.base,s).expand());return new te(t)}else return e.power instanceof _?new w(e.power.exp,new oe(e.base,e.power.base).expand()).flatten():e.isNatural()?e:w.handleDivide(new oe(Le.e,e.power),new oe(Le.e,e.base))}isPositive(){var e=this.collect();return e instanceof oe&&e.base instanceof q&&e.power instanceof q?this.eval()>0:!1}needsExplicitMul(){return!1}isNatural(){return this.base.equals(Le.e)}static natural(){return Le.e}static common(){return Dn}static create(e,t){var s=new oe(e,t);return t.hints.parens||(s=s.addHint("open")),s}}class B extends ye{constructor(e,t){super();G(this,"type");G(this,"arg");G(this,"exp");G(this,"func",B);G(this,"functions",{sin:{eval:Math.sin,codegen:"Math.sin((",tex:"\\sin",expand:()=>this},cos:{eval:Math.cos,codegen:"Math.cos((",tex:"\\cos",expand:()=>this},tan:{eval:Math.tan,codegen:"Math.tan((",tex:"\\tan",expand:()=>w.handleDivide(B.sin(this.arg),B.cos(this.arg))},csc:{eval:e=>1/Math.sin(e),codegen:"(1/Math.sin(",tex:"\\csc",expand:()=>w.handleDivide(J,B.sin(this.arg))},sec:{eval:e=>1/Math.cos(e),codegen:"(1/Math.cos(",tex:"\\sec",expand:()=>w.handleDivide(J,B.cos(this.arg))},cot:{eval:e=>1/Math.tan(e),codegen:"(1/Math.tan(",tex:"\\cot",expand:()=>w.handleDivide(B.cos(this.arg),B.sin(this.arg))},arcsin:{eval:Math.asin,codegen:"Math.asin((",tex:"\\arcsin"},arccos:{eval:Math.acos,codegen:"Math.acos((",tex:"\\arccos"},arctan:{eval:Math.atan,codegen:"Math.atan((",tex:"\\arctan"},arccsc:{eval:e=>Math.asin(1/e),codegen:"Math.asin(1/(",tex:"\\operatorname{arccsc}"},arcsec:{eval:e=>Math.acos(1/e),codegen:"Math.acos(1/(",tex:"\\operatorname{arcsec}"},arccot:{eval:e=>Math.atan(1/e),codegen:"Math.atan(1/(",tex:"\\operatorname{arccot}"},sinh:{eval:e=>(Math.exp(e)-Math.exp(-e))/2,codegen:e=>"((Math.exp("+e+") - Math.exp(-("+e+"))) / 2)",tex:"\\sinh",expand:()=>this},cosh:{eval:e=>(Math.exp(e)+Math.exp(-e))/2,codegen:e=>"((Math.exp("+e+") + Math.exp(-("+e+"))) / 2)",tex:"\\cosh",expand:()=>this},tanh:{eval:e=>(Math.exp(e)-Math.exp(-e))/(Math.exp(e)+Math.exp(-e)),codegen:e=>"((Math.exp("+e+") - Math.exp(-("+e+"))) / (Math.exp("+e+") + Math.exp(-("+e+"))))",tex:"\\tanh",expand:()=>w.handleDivide(B.sinh(this.arg),B.cosh(this.arg))},csch:{eval:e=>2/(Math.exp(e)-Math.exp(-e)),codegen:e=>"(2 / (Math.exp("+e+") - Math.exp(-("+e+"))))",tex:"\\csch",expand:()=>w.handleDivide(J,B.sinh(this.arg))},sech:{eval:e=>2/(Math.exp(e)+Math.exp(-e)),codegen:e=>"(2 / (Math.exp("+e+") + Math.exp(-("+e+"))))",tex:"\\sech",expand:()=>w.handleDivide(J,B.cosh(this.arg))},coth:{eval:e=>(Math.exp(e)+Math.exp(-e))/(Math.exp(e)-Math.exp(-e)),codegen:e=>"((Math.exp("+e+") + Math.exp(-("+e+"))) / (Math.exp("+e+") - Math.exp(-("+e+"))))",tex:"\\coth",expand:()=>w.handleDivide(B.cosh(this.arg),B.sinh(this.arg))}});this.type=e,this.arg=t,this.hints={...this.hints,open:!1}}args(){return[this.type,this.arg]}isEven(){return l.contains(["cos","sec"],this.type)}isInverse(){return this.type.indexOf("arc")===0}isBasic(){return l.contains(["sin","cos"],this.type)}eval(e={},t){var s=this.functions[this.type].eval,i=this.arg.eval(e,t);return s(i)}codegen(){var e=this.functions[this.type].codegen;if(typeof e=="function")return e(this.arg.codegen());if(typeof e=="string")return e+this.arg.codegen()+"))";throw new Error("codegen not implemented for "+this.type)}print(){return this.type+"("+this.arg.print()+")"}tex(){var e=this.functions[this.type].tex,t="("+this.arg.tex()+")";return e+t}texSplit(){var e=this.functions[this.type].tex,t="("+this.arg.tex()+")";return[e,t]}isPositive(){var e=this.collect();return e instanceof B&&e.arg instanceof q?this.eval()>0:!1}completeParse(){if(this.exp){var e=new _(this,this.exp);return this.exp=void 0,e}else return this}needsExplicitMul(){return!1}expand(){var e=this.recurse("expand");if(e.isInverse())return e;var t=e.functions[e.type].expand;return l.bind(t,e)()}collect(e){var t=this.recurse("collect",e);if(!t.isInverse()&&t.arg.isNegative()){const s=t.arg instanceof q?t.arg.abs():w.handleDivide(t.arg,ke).collect(e);return t.isEven()?new B(t.type,s):new w(ke,new B(t.type,s))}else return t}static create(e,t){var s=e[0],i=e[1];i&&i.equals(ke)&&(s="arc"+s,i=void 0);var a=new B(s,t);return t.hints.parens||(a=a.addHint("open")),i&&(a.exp=i),a}static sin(e){return new B("sin",e)}static cos(e){return new B("cos",e)}static sinh(e){return new B("sinh",e)}static cosh(e){return new B("cosh",e)}}class Ye extends ye{constructor(e){super();G(this,"arg");G(this,"func",Ye);this.arg=e}args(){return[this.arg]}eval(e={},t){return Math.abs(this.arg.eval(e,t))}codegen(){return"Math.abs("+this.arg.codegen()+")"}print(){return"abs("+this.arg.print()+")"}tex(){return"\\left|"+this.arg.tex()+"\\right|"}collect(e){var t=this.recurse("collect",e);if(t.arg.isPositive())return t.arg;if(t.arg instanceof q)return t.arg.abs();if(t.arg instanceof w){var s=l.groupBy(t.arg.terms,a=>a.isPositive()?"positive":a instanceof q?"number":"other"),i=s.positive.concat(l.invoke(s.number,"abs"));return s.other.length&&i.push(new Ye(new w(s.other).flatten())),new w(i).flatten()}else return t}expand(){var e=this.recurse("expand");if(e.arg instanceof w){var t=l.map(e.arg.terms,s=>new Ye(s));return new w(t)}else return e}isPositive(){return!0}}class je extends ye{constructor(e,t,s){super();G(this,"left");G(this,"type");G(this,"right");G(this,"func",je);G(this,"signs",{"=":" = ","<":" < ",">":" > ","<>":" \\ne ","<=":" \\le ",">=":" \\ge "});this.left=e,this.type=t,this.right=s}args(){return[this.left,this.type,this.right]}needsExplicitMul(){return!1}print(){return this.left.print()+this.type+this.right.print()}tex(){return this.left.tex()+this.signs[this.type]+this.right.tex()}normalize(){var e=this.recurse("normalize");return l.contains([">",">="],e.type)?new je(e.right,e.type.replace(">","<"),e.left):e}asExpr(e=!1){var t=v=>v instanceof q&&v.isSimple()&&v.eval()===0;let s=[];this.left instanceof te?s=l.clone(this.left.terms):t(this.left)||(s=[this.left]),this.right instanceof te?s=s.concat(this.right.negate().terms):t(this.right)||s.push(this.right.negate());var i=!this.isEquality();s=l.invoke(s,"collect",{preciseFloats:!0});for(var a=0;a<s.length;a++){var c=s[a].getDenominator();i&&!c.isPositive()&&(c=c.asPositiveFactor()),c.equals(J)||(s=l.map(s,v=>w.createOrAppend(v,c).simplify({once:!0,preciseFloats:!0})))}var d=new te(s).flatten();return e?d:this.divideThrough(d)}divideThrough(e){const t=!this.isEquality(),s=e.simplify({once:!0}),i=s.factor({keepNegative:t});if(!(i instanceof w))return e;const a=i.terms,c=p=>!!p.getVars().length,d=p=>p.equals(J),[v,u]=Ue(a,st);if(v.length&&this.isEquality())return new w(v).flatten();let f=u;v.length||(f=l.reject(f,c)),t&&(f=l.invoke(f,"asPositiveFactor")),f=l.reject(f,d),f=l.map(f,p=>new _(p,Se));const b=new w(a.concat(f)).collect();return b.equals(i)?s:b}isEquality(){return l.contains(["=","<>"],this.type)}compare(e){if(!(e instanceof je))return!1;var t=this.normalize(),s=e.normalize();if(t.type!==s.type)return!1;var i=t.divideThrough(t.asExpr(!0).collect()),a=s.divideThrough(s.asExpr(!0).collect());return t.isEquality()?i.compare(a)||i.compare(w.handleNegative(a)):i.compare(a)}sameForm(e){var t=this.normalize(),s=e.normalize(),i=t.left.sameForm(s.left)&&t.right.sameForm(s.right);return t.isEquality()?i||t.left.sameForm(s.right)&&t.right.sameForm(s.left):i}isSimplified(){var e=this.asExpr(!0),t=this.divideThrough(e).simplify();return e.equals(t)&&this.left.isSimplified()&&this.right.isSimplified()}solveLinearEquationForVariable(e){var t=this.asExpr();if(!(t instanceof te)||t.terms.length!==2)throw new Error("Can only handle linear equations of the form a + bx (= 0)");var s=d=>d.has(ct)&&l.contains(d.getVars(),e.symbol);const i=s(t.terms[0]),a=i?w.handleNegative(t.terms[1]):w.handleNegative(t.terms[0]),c=i?w.handleDivide(t.terms[0],e):w.handleDivide(t.terms[1],e);return w.handleDivide(a,c).simplify()}}class Fe extends ye{needsExplicitMul(){return!1}findGCD(r){return r instanceof Fe||r instanceof q?this.equals(r)?this:J:r.findGCD(this)}}class Te extends Fe{constructor(e,t){super();G(this,"symbol");G(this,"arg");G(this,"func",Te);this.symbol=e,this.arg=t}args(){return[this.symbol,this.arg]}print(){return this.symbol+"("+this.arg.print()+")"}tex(){return this.symbol+"("+this.arg.tex()+")"}eval(e={},t){var s=this.arg,i=e[this.symbol],a=l.extend(l.clone(e),{x:s.eval(e,t)}),c=St(i,t);return c.parsed?c.expr.eval(a,t):c}codegen(){return'vars["'+this.symbol+'"]('+this.arg.codegen()+")"}getUnits(){return this.arg.getUnits()}getVars(e){return e?this.arg.getVars():l.union(this.arg.getVars(),[this.symbol]).sort()}getConsts(){return this.arg.getConsts()}}class ct extends Fe{constructor(e,t){super();G(this,"symbol");G(this,"subscript");G(this,"func",ct);this.symbol=e,this.subscript=t}args(){return[this.symbol,this.subscript]}exprArgs(){return[]}recurse(){return this}print(){var e="";return this.subscript&&(e="_("+this.subscript.print()+")"),this.symbol+e}prettyPrint(){var e=this.subscript;return e&&(e instanceof q||e instanceof Fe)?this.symbol+"_"+e.print():this.print()}tex(){var e="";this.subscript&&(e="_{"+this.subscript.tex()+"}");var t=this.symbol.length>1?"\\":"";return t+this.symbol+e}repr(){return"Var("+this.print()+")"}eval(e={},t){return e[this.prettyPrint()]}codegen(){return'vars["'+this.prettyPrint()+'"]'}getVars(){return[this.prettyPrint()]}isPositive(){return!1}}const Ne=class Ne extends Fe{constructor(e){super();G(this,"symbol");G(this,"func",Ne);this.symbol=e}args(){return[this.symbol]}recurse(){return this}eval(e={},t){return this.symbol==="pi"?Math.PI:this.symbol==="e"?Math.E:void 0}codegen(){return this.symbol==="pi"?"Math.PI":this.symbol==="e"?"Math.E":void 0}print(){return this.symbol}tex(){return this.symbol==="pi"?"\\pi ":this.symbol==="e"?"e":void 0}isPositive(){return this.eval()>0}abs(){return this.eval()>0?this:w.handleNegative(this)}getConsts(){return[this.print()]}};G(Ne,"e",new Ne("e")),G(Ne,"pi",new Ne("pi"));let Le=Ne;class q extends ye{constructor(){super();G(this,"n",0);this.hints={...this.hints,negate:!1,subtract:!1,divide:!1,root:!1,fraction:!1,entered:!1}}repr(){return this.print()}strip(){return this.abs()}recurse(){return this}codegen(){return this.print()}isSubtract(){return!!this.hints.subtract}needsExplicitMul(){return!0}isPositive(){return this.eval()>0}isNegative(){return this.eval()<0}asPositiveFactor(){return this.isPositive()?this:this.abs()}getDecimalPlaces(){var e=(""+this.n).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0}static negativeOne(e){return e==="subtract"?Cn:e==="divide"?Se:ke}static findGCD(e,t){var s;if(e=Math.abs(e),t=Math.abs(t),e!==Math.floor(e)||t!==Math.floor(t))return 1;for(;t;)s=e%t,e=t,t=s;return e}static min(...e){return l.min(e,t=>t.eval())}static max(...e){return l.max(e,t=>t.eval())}}class V extends q{constructor(e,t){super();G(this,"n");G(this,"d");G(this,"func",V);var s=e,i=t;i<0&&(s=-s,i=-i),this.n=s,this.d=i}args(){return[this.n,this.d]}eval(){return this.n/this.d}print(){return this.n.toString()+"/"+this.d.toString()}tex(){var e="\\frac{"+Math.abs(this.n).toString()+"}{"+this.d.toString()+"}";return this.n<0?"-"+e:e}add(e,t){return e instanceof V?new V(this.n*e.d+this.d*e.n,this.d*e.d).collect():e.add(this,t)}mul(e,t){return e instanceof V?new V(this.n*e.n,this.d*e.d).collect():e.mul(this,t)}collect(){var e=q.findGCD(this.n,this.d),t=this.n/e,s=this.d/e;return s===1?new I(t):new V(t,s)}negate(){return new V(-this.n,this.d)}abs(){return new V(Math.abs(this.n),this.d)}findGCD(e){if(e instanceof V){var t=q.findGCD(this.n*e.d,e.n*this.d),s=this.d*e.d;return new V(t,s).collect()}else return e instanceof I?new V(q.findGCD(this.n,e.n),this.d):e.findGCD(this)}raiseToThe(e){if(e instanceof I){var t=e.eval()>0,s=e.abs().eval(),i=Math.pow(this.n,s),a=Math.pow(this.d,s);return t?new V(i,a).collect():new V(a,i).collect()}else return new ae(this.eval()).raiseToThe(e)}getDenominator(){return new I(this.d)}isSimple(){return!1}asRational(){return this}}class I extends V{constructor(e){super(e,1);G(this,"func",I)}args(){return[this.n]}print(){return this.n.toString()}tex(){return this.n.toString()}negate(){return new I(-this.n)}abs(){return new I(Math.abs(this.n))}isSimple(){return!0}findGCD(e){return e instanceof I?new I(q.findGCD(this.n,e.n)):e.findGCD(this)}static create(e){return new I(e).addHint("entered")}}class ae extends q{constructor(e){super();G(this,"n");G(this,"func",ae);this.n=e}args(){return[this.n]}eval(){return this.n}print(){return this.n.toString()}tex(){return this.n.toString()}add(e,t){return t&&t.preciseFloats?ae.toDecimalPlaces(this.n+e.eval(),Math.max(this.getDecimalPlaces(),e.getDecimalPlaces())):new ae(this.n+e.eval()).collect()}mul(e,t){return t&&t.preciseFloats?ae.toDecimalPlaces(this.n*e.eval(),this.getDecimalPlaces()+e.getDecimalPlaces()):new ae(this.n*e.eval()).collect()}collect(e){return this}negate(){return new ae(-this.n)}abs(){return new ae(Math.abs(this.n))}findGCD(e){return e instanceof q?new ae(q.findGCD(this.eval(),e.eval())).collect():e.findGCD(this)}raiseToThe(e,t){return t&&t.preciseFloats&&e instanceof I&&e.n>1?ae.toDecimalPlaces(new _(this,e).eval(),this.getDecimalPlaces()*e.n):new ae(new _(this,e).eval()).collect()}asRational(){var e=this.n.toString().split(".");if(e.length===1)return new V(this.n,1);var t=Number(e.join("")),s=Math.pow(10,e[1].length);return new V(t,s).collect()}getDenominator(){return this.asRational().getDenominator()}isSimple(){return!0}static create(e){return new ae(e).addHint("entered")}static toDecimalPlaces(e,t){return new ae(+e.toFixed(Math.min(t,20))).collect()}}const ke=new I(-1).addHint("negate"),Cn=new I(-1).addHint("subtract"),Se=new I(-1).addHint("divide"),Fn=new V(1,2).addHint("root"),Je=new I(0),J=new I(1),Dn=new I(10);var Rn=function(n,r){throw new Error(r.loc.first_column)};Be.yy={Add:te,Mul:w,Pow:_,Log:oe,Trig:B,Eq:je,Abs:Ye,Func:Te,Const:Le,Var:ct,Int:I,Float:ae,parseError:Rn,constants:["e"],symbolLexer:function(n){return l.contains(Be.yy.constants,n)?"CONST":l.contains(Be.yy.functions,n)?"FUNC":"VAR"}};const St=function(n,r){try{r&&r.functions?Be.yy.functions=l.without(r.functions,"i"):Be.yy.functions=[],r&&r.decimal_separator&&(n=n.split(r.decimal_separator).join("."));var e=Be.parse(n).completeParse();return{parsed:!0,expr:e}}catch(t){return{parsed:!1,error:t.message}}};class le extends Fe{constructor(e){super();G(this,"symbol");G(this,"func",le);this.symbol=e}args(){return[this.symbol]}recurse(){return this}eval(e={},t){return 1}getUnits(){return[{unit:this.symbol,pow:1}]}codegen(){return"1"}print(){return this.symbol}tex(){return this.symbol}collect(e){if(l(Gn).has(this.symbol))return this;if(l(qt).has(this.symbol))return qt[this.symbol].conversion;throw new Error("could not understand unit: "+this.symbol)}}var Gn={m:new le("m"),g:new le("g"),s:new le("s"),A:new le("A"),K:new le("K"),mol:new le("mol"),cd:new le("cd")};new _(new I(10),new I(-18)),new _(new I(10),new I(-15)),new _(new I(10),new I(-12)),new _(new I(10),new I(-9)),new _(new I(10),new I(-6)),new _(new I(10),new I(-3)),new _(new I(10),new I(-2)),new _(new I(10),new I(-1)),new I(10),new _(new I(10),new I(2)),new _(new I(10),new I(3)),new _(new I(10),new I(6)),new _(new I(10),new I(9)),new _(new I(10),new I(12)),new _(new I(10),new I(15)),new _(new I(10),new I(18)),new _(new I(10),new I(27));const Y="hasPrefixes",W="hasntPrefixes",x=function(n,r){var e=n.split("|"),t=e[0].trim(),s=e[1].trim(),i=J;t!==""&&(i=St(t).expr);var a=s.split("/"),c=[i];return a[0]&&a[0].split(" ").filter(d=>d!=="").forEach(d=>c.push(new le(d))),a[1]&&a[1].split(" ").filter(d=>d!=="").forEach(d=>c.push(new _(new le(d),Se))),{conversion:new w(c),prefixes:r}};var qt={Da:x("1.6605388628 x 10^-24 | g",Y),u:x("| Da",W),meter:x("| m",W),meters:x("| m",W),in:x("254 / 10000 | m",W),ft:x("3048  / 10000 | m",W),yd:x("9144  / 10000 | m",W),mi:x("1609344 / 1000 | m",W),ly:x("9.4607 x 10^15 | m",W),nmi:x("1852 | m",W),Å:x("10^-10 | m",W),pc:x("3.0857 x 10^16 | m",W),min:x("60 | s",W),hr:x("3600 | s",W),sec:x("| s",W),day:x("86400 | s",W),wk:x("604800 | s",W),fortnight:x("14 | day",W),shake:x("10^-8 | s",W),olympiad:x("126200000 | s",W),"°C":x("1 | K",W),"°F":x("5/9 | K",W),"°R":x("5/9 | K",W),e:x("1.6021765314 x 10^-19 | C",W),c:x("299792458 | m / s",W),kn:x("514/1000 | m / s",W),kt:x("| kn",W),knot:x("| kn",W),J:x("| N m",Y),BTU:x("1060 | J",W),cal:x("4184 / 1000 | J",Y),eV:x("1.602176514 x 10^-19 | J",Y),erg:x("10^−7 | J",Y),W:x("| J / s",Y),"H-e":x("80 | W",W),N:x("1000 | g m / s s",Y),lb:x("4448221615 / 1000000000 | N",W),dyn:x("10^-5 | N",W),Pa:x("1 | N / m m m",Y),bar:x("10^5 | Pa",Y),"㏔":x("1/1000 | bar",W),"㍴":x("| bar",W),atm:x("101325 | Pa",W),Torr:x("1/760 | atm",W),mmHg:x("| Torr",W),ha:x("10^4 | m m",W),b:x("10^−28 | m m",Y),barn:x("| b",Y),acre:x("4046.87 | m m",W),skilodge:x("10^-31 | m m",W),outhouse:x("10^-34 | m m",W),shed:x("10^-52 | m m",W),L:x("1/1000 | m m m",Y),gal:x("3785/1000 | L",Y),cup:x("1/16 | gal",W),qt:x("1/4 | gal",W),quart:x("| qt",W),p:x("1/8 | gal",W),pt:x("| p",W),pint:x("| p",W),"fl oz":x("1/8 | cup",W),"fl. oz.":x("1/8 | cup",W),tbsp:x("1/16 | cup",W),tsp:x("1/3 | tbsp",W),rev:x("2 pi | rad",W),deg:x("180 pi | rad",W),"°":x("| deg",W),arcminute:x("1/60 | deg",W),arcsec:x("1/3600 | deg",W),Hu:x("1000 | dB",Y),dozen:x("12 |",W),mol:x("6.0221412927 x 10^23 |",Y),"%":x("1/100 |",W),percent:x("| %",W),ppm:x("1/1000000 |",W),V:x("1000 | g m m / s s C",Y),C:x("| A s",Y),ampere:x("| A",W),Ω:x("| V / A",Y),ohm:x("| Ω",W),F:x("| C / V",Y),H:x("| ohm s",Y),T:x("1000 | g / C s",Y),Wb:x("1000 | g m m / C s",Y),lm:x("pi x 10^4 | cd / m m",W),lx:x("| lm / m m",W),nit:x("| cd / m m",W),sb:x("10^4 | cd / m m",W),stilb:x("1 | sb",W),apostilb:x("1 / pi x 10^(-4) | sb",W),blondel:x("| apostilb",W),asb:x("| apostilb",W),la:x("| lm",W),Lb:x("| lm",W),sk:x("10^-7 | lm",W),skot:x("| sk",W),bril:x("10^-11 | lm",W),Hz:x("| / s",Y)};function Xt(n){if(n.extraKeys)return n.extraKeys;const r=["PI"];if(n.answerForms==null)return r;const e={},t={};for(const c of n.answerForms){const d=St(c.value,n);if(d.parsed){const v=d.expr,u=p=>p==="pi"||p==="theta",f=p=>u(p)?p.toUpperCase():p,b=p=>Ht.includes(p);for(const p of v.getVars()){const g=f(p);b(g)&&(e[g]=!0)}for(const p of v.getConsts()){const g=f(p);b(g)&&(t[g]=!0)}}}const s=Object.keys(e).sort(),i=Object.keys(t).sort(),a=[...s,...i];return a.length?a:r}function be(n){return(r,e)=>e.success(n(r))}const qn=H("basic","basic+div","trig","prealgebra","logarithms","basic relations","advanced relations","scientific"),At=F(E(qn),()=>["basic","trig","prealgebra","logarithms"]);function Yt(n,r){return new Wt(n,r,e=>e,(e,t)=>t.failure("widget options with a known version number",e))}class Wt{constructor(r,e,t,s){G(this,"parser");this.migrateToLatest=t,this.parseOtherVersions=s;const i=ge(e).then(be(this.migrateToLatest)).parser;this.parser=(a,c)=>{if(!He(a))return c.failure("object",a);const d=$n(a,c);return de(d)?d:d.value.version.major!==r?this.parseOtherVersions(a,c):i(a,c)}}withMigrationFrom(r,e,t){const s=this.parser,i=a=>this.migrateToLatest(t(a));return new Wt(r,e,i,s)}}const $n=m({version:F(m({major:k,minor:k}),()=>({major:0,minor:0}))}),_n=he(h).or(k).or(O(null)).or(O(void 0)).parser,Jt=m({value:o(h),form:F(P,()=>!1),simplify:F(P,()=>!1),considered:H("correct","wrong","ungraded"),key:ge(_n).then(be(String)).parser});function Qt(n){const r=[];for(const e of n){const{value:t}=e;t!=null&&r.push({...e,value:t})}return r}const Vn=m({major:O(2),minor:k}),zn=Ke(Vn,O("expression"),m({answerForms:ge(E(Jt)).then(be(Qt)).parser,functions:E(h),times:P,visibleLabel:o(h),ariaLabel:o(h),buttonSets:At,buttonsVisible:o(H("always","never","focused")),extraKeys:E(H(...Ht))})),Bn=m({major:O(1),minor:k}),Un=Ke(Bn,O("expression"),m({answerForms:ge(E(Jt)).then(be(Qt)).parser,functions:E(h),times:P,visibleLabel:o(h),ariaLabel:o(h),buttonSets:At,buttonsVisible:o(H("always","never","focused"))}));function jn(n){const{options:r}=n;return{...n,version:{major:2,minor:0},options:{times:r.times,buttonSets:r.buttonSets,functions:r.functions,buttonsVisible:r.buttonsVisible,visibleLabel:r.visibleLabel,ariaLabel:r.ariaLabel,answerForms:r.answerForms,extraKeys:Xt(r)}}}const Hn=o(m({major:O(0),minor:k})),Kn=Ke(Hn,O("expression"),m({functions:E(h),times:P,visibleLabel:o(h),ariaLabel:o(h),form:P,simplify:P,value:h,buttonSets:At,buttonsVisible:o(H("always","never","focused"))}));function Xn(n){const{options:r}=n;return{...n,version:{major:1,minor:0},options:{times:r.times,buttonSets:r.buttonSets,functions:r.functions,buttonsVisible:r.buttonsVisible,visibleLabel:r.visibleLabel,ariaLabel:r.ariaLabel,answerForms:[{considered:"correct",form:r.form,simplify:r.simplify,value:r.value}]}}}const Yn=Yt(2,zn).withMigrationFrom(1,Un,jn).withMigrationFrom(0,Kn,Xn).parser,Jn=ge(O(!1)).then(be(()=>null)).parser,Zt=m({title:F(h,()=>""),hasHint:o(z(P)),hint:he(Jn).or(O(null)).or(O(void 0)).or((n,r)=>Qe(n,r)).parser,content:h,widgets:(n,r)=>pt(n,r),widgetEnabled:o(z(P)),immutableWidgets:o(z(P)),images:jt(h,m({width:k,height:k}))}),Qn=U(O("graded-group"),Zt),Zn=U(O("graded-group-set"),m({gradedGroups:E(Zt)}));function lt(n){const r=(e,t)=>He(e)?t.forSubtree(n).failure("a valid value",e[n]):t.failure("object",e);return new Et(n,r)}class Et{constructor(r,e){this.discriminantKey=r,this.parser=e}withBranch(r,e){const t=er(this.discriminantKey,r,e,this.parser);return new Et(this.discriminantKey,t)}}function er(n,r,e,t){return(s,i)=>He(s)?s[n]===r?e(s,i):t(s,i):i.failure("object",s)}const Pe=Q(k,k),we=Q(Pe,Pe),tr=U(O("grapher"),m({availableTypes:E(H("absolute_value","exponential","linear","logarithm","quadratic","sinusoid","tangent")),correct:lt("type").withBranch("absolute_value",m({type:O("absolute_value"),coords:z(we)})).withBranch("exponential",m({type:O("exponential"),asymptote:we,coords:z(we)})).withBranch("linear",m({type:O("linear"),coords:z(we)})).withBranch("logarithm",m({type:O("logarithm"),asymptote:we,coords:z(we)})).withBranch("quadratic",m({type:O("quadratic"),coords:z(we)})).withBranch("sinusoid",m({type:O("sinusoid"),coords:z(we)})).withBranch("tangent",m({type:O("tangent"),coords:z(we)})).parser,graph:m({backgroundImage:m({bottom:o(k),height:o(k),left:o(k),scale:o(k),url:o(z(h)),width:o(k)}),box:o(Pe),editableSettings:o(E(H("graph","snap","image","measure"))),gridStep:o(Pe),labels:Q(h,h),markings:H("graph","none","grid"),range:Q(Pe,Pe),rulerLabel:O(""),rulerTicks:k,showProtractor:o(P),showRuler:o(P),showTooltips:o(P),snapStep:o(Pe),step:Pe,valid:o(he(P).or(h).parser)})})),nr=U(O("group"),(n,r)=>Qe(n,r)),rr=U(O("iframe"),m({url:h,settings:o(E(m({name:h,value:h}))),width:he(k).or(h).parser,height:he(k).or(h).parser,allowFullScreen:F(P,()=>!1),allowTopNavigation:o(P),static:F(P,()=>!1)})),en=(n,r)=>{if(typeof n=="number")return r.success(n);const e=+n;return n===""||isNaN(e)?r.failure("a number or numeric string",n):r.success(e)};function sr(n){return n===""?0:n}const ir=ge(he(k).or(h).parser).then(be(sr)).then(en).parser,_e=F(ir,()=>{}),ut=m({url:o(z(h)),width:_e,height:_e,top:_e,left:_e,bottom:_e,scale:_e}),vt=Q(k,k),ar=U(O("image"),m({title:o(h),caption:o(h),alt:o(h),backgroundImage:ut,static:o(P),labels:o(E(m({content:h,alignment:h,coordinates:E(k)}))),range:o(Q(vt,vt)),box:o(vt)})),or=(n,r)=>typeof n=="boolean"?r.success(String(n)):r.failure("boolean",n),cr=U(O("input-number"),m({answerType:o(H("number","decimal","integer","rational","improper","mixed","percent","pi")),inexact:o(P),maxError:o(he(k).or(h).parser),rightAlign:o(P),simplify:H("required","optional","enforced"),size:H("normal","small"),value:he(k).or(h).or(or).parser,customKeypad:o(P)})),Ve=Q(k,k),nt=F(h,()=>""),Ae=ge(o(h)).then(be(String)).parser,lr=m({type:O("function"),key:Ae,options:m({value:h,funcName:h,rangeMin:h,rangeMax:h,color:h,strokeDasharray:h,strokeWidth:k})}),ur=m({type:O("label"),key:Ae,options:m({label:h,color:h,coordX:h,coordY:h})}),hr=m({type:O("line"),key:Ae,options:m({color:h,startX:h,startY:h,endX:h,endY:h,strokeDasharray:h,strokeWidth:k,arrows:h})}),pr=m({type:O("movable-line"),key:Ae,options:m({startX:h,startY:h,startSubscript:k,endX:h,endY:h,endSubscript:k,constraint:h,snap:k,constraintFn:h,constraintXMin:h,constraintXMax:h,constraintYMin:h,constraintYMax:h})}),fr=m({type:O("movable-point"),key:Ae,options:m({startX:h,startY:h,varSubscript:k,constraint:h,snap:k,constraintFn:h,constraintXMin:nt,constraintXMax:nt,constraintYMin:nt,constraintYMax:nt})}),dr=m({type:O("parametric"),key:Ae,options:m({x:h,y:h,rangeMin:h,rangeMax:h,color:h,strokeDasharray:h,strokeWidth:k})}),gr=m({type:O("point"),key:Ae,options:m({color:h,coordX:h,coordY:h})}),mr=m({type:O("rectangle"),key:Ae,options:m({color:h,coordX:h,coordY:h,width:h,height:h})}),yr=U(O("interaction"),m({static:F(P,()=>!1),graph:m({editableSettings:o(E(H("canvas","graph"))),box:Ve,labels:E(h),range:Q(Ve,Ve),gridStep:Ve,markings:H("graph","grid","none"),snapStep:o(Ve),valid:o(he(P).or(h).parser),backgroundImage:o(ut),showProtractor:o(P),showRuler:o(P),rulerLabel:o(h),rulerTicks:o(k),tickStep:Ve}),elements:E(lt("type").withBranch("function",lr).withBranch("label",ur).withBranch("line",hr).withBranch("movable-line",pr).withBranch("movable-point",fr).withBranch("parametric",dr).withBranch("point",gr).withBranch("rectangle",mr).parser)})),pa=["calculator","chi2Table","financialCalculatorMonthlyPayment","financialCalculatorTotalAmount","financialCalculatorTimeToPayOff","periodicTable","periodicTableWithKey","tTable","zTable"],fa=["correct","wrong","ungraded"],br=["blue","green","grayH","purple","pink","orange","red"],da={blue:"#3D7586",green:"#447A53",grayH:"#3B3D45",purple:"#594094",pink:"#B25071",red:"#D92916",orange:"#946700"},ga={none:0,white:1,translucent:.4,solid:1},vr=["bar","line","pic","histogram","dotplot"],N=Q(k,k),xr=m({type:O("angle"),showAngles:o(P),allowReflexAngles:o(P),angleOffsetDeg:o(k),snapDegrees:o(k),match:o(O("congruent")),coords:o(at(N,N,N)),startCoords:o(at(N,N,N))}),wr=m({type:O("circle"),center:o(N),radius:o(k),startCoords:o(m({center:N,radius:k})),coord:o(N)}),kr=m({type:O("linear"),coords:o(z(Q(N,N))),startCoords:o(Q(N,N)),coord:o(N)}),Or=m({type:O("linear-system"),coords:o(z(E(Q(N,N)))),startCoords:o(E(Q(N,N))),coord:o(N)}),Pr=m({type:O("none")}),Tr=m({type:O("point"),numPoints:o(he(k).or(O("unlimited")).parser),coords:o(z(E(N))),startCoords:o(E(N)),coord:o(N)}),Sr=m({type:O("polygon"),numSides:o(he(k).or(O("unlimited")).parser),showAngles:o(P),showSides:o(P),snapTo:o(H("grid","angles","sides")),match:o(H("similar","congruent","approx","exact")),startCoords:o(E(N)),coord:o(N)}),Ar=m({type:O("quadratic"),coords:o(z(at(N,N,N))),startCoords:o(at(N,N,N)),coord:o(N)}),Wr=m({type:O("ray"),coords:o(z(Q(N,N))),startCoords:o(Q(N,N)),coord:o(N)}),Er=m({type:O("segment"),numSegments:o(k),coords:o(z(E(Q(N,N)))),startCoords:o(E(Q(N,N))),coord:o(N)}),Ir=m({type:O("sinusoid"),coords:o(z(E(N))),startCoords:o(E(N)),coord:o(N)}),$t=lt("type").withBranch("angle",xr).withBranch("circle",wr).withBranch("linear",kr).withBranch("linear-system",Or).withBranch("none",Pr).withBranch("point",Tr).withBranch("polygon",Sr).withBranch("quadratic",Ar).withBranch("ray",Wr).withBranch("segment",Er).withBranch("sinusoid",Ir).parser,Re=H(...br),tn=H("none","white","translucent","solid"),ht=H("solid","dashed"),Ge=m({type:O("label"),coord:N,text:h,color:Re,size:H("small","medium","large")}),wt=m({type:O("point"),coord:N,color:Re,filled:P,labels:o(E(Ge)),ariaLabel:o(h)}),Mr=m({type:O("line"),kind:H("line","ray","segment"),points:Q(wt,wt),color:Re,lineStyle:ht,showPoint1:F(P,()=>!1),showPoint2:F(P,()=>!1),labels:o(E(Ge)),ariaLabel:o(h)}),Nr=m({type:O("vector"),points:Q(N,N),color:Re,labels:o(E(Ge)),ariaLabel:o(h)}),Lr=m({type:O("ellipse"),center:N,radius:N,angle:k,color:Re,fillStyle:tn,strokeStyle:ht,labels:o(E(Ge)),ariaLabel:o(h)}),Cr=m({type:O("polygon"),points:E(N),color:Re,showVertices:P,fillStyle:tn,strokeStyle:ht,labels:o(E(Ge)),ariaLabel:o(h)}),Fr=F(Q(F(k,()=>-1/0),F(k,()=>1/0)),()=>[-1/0,1/0]),Dr=m({type:O("function"),color:Re,strokeStyle:ht,equation:h,directionalAxis:H("x","y"),domain:Fr,labels:o(E(Ge)),ariaLabel:o(h)}),Rr=lt("type").withBranch("point",wt).withBranch("line",Mr).withBranch("vector",Nr).withBranch("ellipse",Lr).withBranch("polygon",Cr).withBranch("function",Dr).withBranch("label",Ge).parser,Gr=U(O("interactive-graph"),m({step:N,gridStep:o(N),snapStep:o(N),backgroundImage:o(ut),markings:H("graph","grid","none"),labels:o(E(h)),labelLocation:o(H("onAxis","alongEdge")),showProtractor:P,showRuler:o(P),showTooltips:o(P),rulerLabel:o(h),rulerTicks:o(k),range:Q(N,N),graph:F($t,()=>({type:"linear"})),correct:$t,lockedFigures:o(E(Rr)),fullGraphLabel:o(h),fullGraphAriaDescription:o(h)})),qr=U(O("label-image"),m({choices:E(h),imageUrl:h,imageAlt:h,imageHeight:k,imageWidth:k,markers:E(m({answers:E(h),label:h,x:k,y:k})),hideChoicesFromInstructions:P,multipleAnswers:P,static:F(P,()=>!1)})),$r=U(O("matcher"),m({labels:E(h),left:E(h),right:E(h),orderMatters:P,padding:P})),_r=he(k).or(h).parser,Vr=ge(F(_r,()=>NaN)).then(en).parser,zr=U(F(O("matrix"),()=>"matrix"),m({prefix:o(h),suffix:o(h),answers:E(E(Vr)),cursorPosition:o(E(k)),matrixBoardSize:E(k),static:o(P)})),Br=U(O("measurer"),m({image:F(ut,()=>({url:null,top:0,left:0})),showProtractor:P,showRuler:P,rulerLabel:h,rulerTicks:k,rulerPixels:k,rulerLength:k,box:Q(k,k),static:F(P,()=>!1)})),Ur=U(O("molecule-renderer"),m({widgetId:h,rotationAngle:o(k),smiles:o(h)})),jr=ge(O("")).then(be(()=>null)).parser,Hr=U(O("number-line"),m({range:E(k),labelRange:E(z(he(k).or(jr).parser)),labelStyle:h,labelTicks:P,isTickCtrl:o(z(P)),divisionRange:E(k),numDivisions:o(z(k)),snapDivisions:F(k,()=>2),tickStep:o(z(k)),correctRel:o(z(h)),correctX:z(k),initialX:o(z(k)),showTooltips:o(P),static:F(P,()=>!1)})),_t=H("integer","mixed","improper","proper","decimal","percent","pi"),Vt=ge(he(O(null)).or(O(void 0)).or(P).or(O("required")).or(O("correct")).or(O("enforced")).or(O("optional")).or(O("accepted")).parser).then(be(Kr)).parser;function Kr(n){switch(n){case"enforced":case"required":case"optional":return n;default:return"required"}}const Xr=U(O("numeric-input"),m({answers:E(m({message:h,value:o(z(k)),status:h,answerForms:F(E(_t),()=>{}),strict:P,maxError:o(z(k)),simplify:Vt})),labelText:o(h),size:h,coefficient:F(P,()=>!1),rightAlign:o(P),static:F(P,()=>!1),answerForms:o(E(m({name:_t,simplify:Vt})))}));function xt(n,r){return Qe(n,r)}const Yr=(n,r)=>n==="large"?r.success("auto"):r.success(n),Jr=U(O("orderer"),m({options:F(E(xt),()=>[]),correctOptions:E(xt),otherOptions:E(xt),height:ge(H("normal","auto","large")).then(Yr).parser,layout:F(H("horizontal","vertical"),()=>"horizontal")})),Qr=U(O("passage-ref"),m({passageNumber:k,referenceNumber:k,summaryText:o(h)})),Zr=U(O("passage"),m({footnotes:F(h,()=>""),passageText:h,passageTitle:F(h,()=>""),showLineNumbers:P,static:F(P,()=>!1)})),es=U(O("phet-simulation"),m({url:h,description:h})),ts=U(O("plotter"),m({labels:E(h),categories:E(h),type:H(...vr),maxY:k,scaleY:F(k,()=>1),labelInterval:o(z(k)),snapsPerLine:F(k,()=>2),starting:E(k),correct:E(k),picUrl:o(z(h)),picSize:o(z(k)),picBoxHeight:o(z(k)),plotDimensions:F(E(k),()=>[380,300])})),ns=U(O("python-program"),m({programID:h,height:k})),rs={major:2,minor:0};function nn(n){const{choices:r,numCorrect:e}=n;return e??r.filter(t=>t.correct).length}const ss={2:n=>({...n,numCorrect:nn(n)}),1:n=>{const{noneOfTheAbove:r,...e}=n;if(r)throw new Error("radio widget v0 no longer supports auto noneOfTheAbove");return{...e,hasNoneOfTheAbove:!1}}},is={choices:[{},{},{},{}],displayCount:null,randomize:!1,hasNoneOfTheAbove:!1,multipleSelect:!1,countChoices:!1,deselectEnabled:!1},It=F((n,r)=>pt(n,r),()=>{}),as=o(m({major:O(2),minor:k})),os=Ke(as,O("radio"),m({numCorrect:o(k),choices:E(m({content:F(h,()=>""),clue:o(h),correct:o(P),isNoneOfTheAbove:o(P),widgets:It})),hasNoneOfTheAbove:o(P),countChoices:o(P),randomize:o(P),multipleSelect:o(P),deselectEnabled:o(P),onePerLine:o(P),displayCount:o(Ce),noneOfTheAbove:o(O(!1))})),cs=o(m({major:O(1),minor:k})),ls=Ke(cs,O("radio"),m({choices:E(m({content:F(h,()=>""),clue:o(h),correct:o(P),isNoneOfTheAbove:o(P),widgets:It})),hasNoneOfTheAbove:o(P),countChoices:o(P),randomize:o(P),multipleSelect:o(P),deselectEnabled:o(P),onePerLine:o(P),displayCount:o(Ce),noneOfTheAbove:o(O(!1))}));function us(n){const{options:r}=n;return{...n,version:{major:2,minor:0},options:{...r,numCorrect:nn(r)}}}const hs=o(m({major:O(0),minor:k})),ps=Ke(hs,O("radio"),m({choices:E(m({content:F(h,()=>""),clue:o(h),correct:o(P),isNoneOfTheAbove:o(P),widgets:It})),hasNoneOfTheAbove:o(P),countChoices:o(P),randomize:o(P),multipleSelect:o(P),deselectEnabled:o(P),onePerLine:o(P),displayCount:o(Ce),noneOfTheAbove:o(O(!1))}));function fs(n){const{options:r}=n,{noneOfTheAbove:e,...t}=r;return{...n,version:{major:1,minor:0},options:{...t,hasNoneOfTheAbove:!1}}}const ds=Yt(2,os).withMigrationFrom(1,ls,us).withMigrationFrom(0,ps,fs).parser,gs=U(O("sorter"),m({correct:E(h),padding:P,layout:H("horizontal","vertical")})),ms=U(O("table"),m({headers:E(h),rows:k,columns:k,answers:E(E(h))})),ys=U(O("video"),m({location:h,static:o(P)})),pt=(n,r)=>{if(!He(n))return r.failure("PerseusWidgetsMap",n);const e={};for(const t of Object.keys(n)){const s=bs([t,n[t]],e,r.forSubtree(t));if(de(s))return s}return r.success(e)},bs=([n,r],e,t)=>{const s=xs(n.split(" "),t.forSubtree("(widget ID)"));if(de(s))return s;const[i,a]=s.value;function c(d,v){const u=v(r,t);return de(u)?u:(e[d]=u.value,t.success(void 0))}switch(i){case"categorizer":return c(`categorizer ${a}`,On);case"cs-program":return c(`cs-program ${a}`,Pn);case"definition":return c(`definition ${a}`,Tn);case"dropdown":return c(`dropdown ${a}`,Sn);case"explanation":return c(`explanation ${a}`,An);case"expression":return c(`expression ${a}`,Yn);case"grapher":return c(`grapher ${a}`,tr);case"group":return c(`group ${a}`,nr);case"graded-group":return c(`graded-group ${a}`,Qn);case"graded-group-set":return c(`graded-group-set ${a}`,Zn);case"iframe":return c(`iframe ${a}`,rr);case"image":return c(`image ${a}`,ar);case"input-number":return c(`input-number ${a}`,cr);case"interaction":return c(`interaction ${a}`,yr);case"interactive-graph":return c(`interactive-graph ${a}`,Gr);case"label-image":return c(`label-image ${a}`,qr);case"matcher":return c(`matcher ${a}`,$r);case"matrix":return c(`matrix ${a}`,zr);case"measurer":return c(`measurer ${a}`,Br);case"molecule-renderer":return c(`molecule-renderer ${a}`,Ur);case"number-line":return c(`number-line ${a}`,Hr);case"numeric-input":return c(`numeric-input ${a}`,Xr);case"orderer":return c(`orderer ${a}`,Jr);case"passage":return c(`passage ${a}`,Zr);case"passage-ref":return c(`passage-ref ${a}`,Qr);case"passage-ref-target":return c(`passage-ref-target ${a}`,Ce);case"phet-simulation":return c(`phet-simulation ${a}`,es);case"plotter":return c(`plotter ${a}`,ts);case"python-program":return c(`python-program ${a}`,ns);case"radio":return c(`radio ${a}`,ds);case"sorter":return c(`sorter ${a}`,gs);case"table":return c(`table ${a}`,ms);case"video":return c(`video ${a}`,ys);case"sequence":return c(`sequence ${a}`,rt);case"lights-puzzle":return c(`lights-puzzle ${a}`,rt);case"simulator":return c(`simulator ${a}`,rt);case"transformer":return c(`transformer ${a}`,rt);default:return c(`${i} ${a}`,U(O(i),Ce))}},rt=U((n,r)=>r.success("deprecated-standin"),m({})),vs=(n,r)=>typeof n!="string"||!/^(0|[1-9][0-9]*)$/.test(n)?r.failure("a string representing a non-negative integer",n):r.success(+n),xs=Q(h,vs),Qe=F(m({content:F(h,()=>""),widgets:F((n,r)=>pt(n,r),()=>({})),images:kn,metadata:Ce}),()=>({content:"",widgets:{},images:{}}));he(Qe).or(E(Qe)).parser;ge(F(m({}),()=>({}))).then(be(ws)).parser;function ws(n){return{zTable:!!n.zTable,calculator:!!n.calculator,chi2Table:!!n.chi2Table,financialCalculatorMonthlyPayment:!!n.financialCalculatorMonthlyPayment,financialCalculatorTotalAmount:!!n.financialCalculatorTotalAmount,financialCalculatorTimeToPayOff:!!n.financialCalculatorTimeToPayOff,periodicTable:!!n.periodicTable,periodicTableWithKey:!!n.periodicTableWithKey,tTable:!!n.tTable}}const ks="@khanacademy/perseus-core",Os="__lib_version__";Kt(ks,Os);function Ps(n){return{items:n.items,categories:n.categories,randomizeItems:n.randomizeItems,static:n.static}}const Ts={items:[],categories:[],values:[],randomizeItems:!1},Ss={name:"categorizer",defaultWidgetOptions:Ts,getPublicWidgetOptions:Ps};function As(n){return n}const Ws=400,Es={programID:"",programType:null,settings:[{name:"",value:""}],showEditor:!1,showButtons:!1,height:Ws},Is={name:"cs-program",defaultWidgetOptions:Es,supportedAlignments:["block","full-width"],getPublicWidgetOptions:As},Ms={togglePrompt:"",definition:""},Ns={name:"definition",defaultWidgetOptions:Ms,defaultAlignment:"inline"};function Ls(n){return{choices:n.choices.map(r=>({content:r.content})),placeholder:n.placeholder,static:n.static,visibleLabel:n.visibleLabel,ariaLabel:n.ariaLabel}}const Cs={placeholder:"",choices:[{content:"",correct:!1}]},Fs={name:"definition",defaultWidgetOptions:Cs,defaultAlignment:"inline-block",getPublicWidgetOptions:Ls},Ds={showPrompt:"Explain",hidePrompt:"Hide explanation",explanation:`explanation goes here

more explanation`,widgets:{}},Rs={name:"explanation",defaultWidgetOptions:Ds,defaultAlignment:"inline"},Gs={major:2,minor:0},qs={2:n=>({times:n.times,buttonSets:n.buttonSets,functions:n.functions,buttonsVisible:n.buttonsVisible,visibleLabel:n.visibleLabel,ariaLabel:n.ariaLabel,answerForms:n.answerForms,extraKeys:n.extraKeys||Xt(n)}),1:n=>({times:n.times,buttonSets:n.buttonSets,functions:n.functions,buttonsVisible:n.buttonsVisible,visibleLabel:n.visibleLabel,ariaLabel:n.ariaLabel,extraKeys:n.extraKeys,answerForms:[{considered:"correct",form:n.form,simplify:n.simplify,value:n.value}]})},$s={answerForms:[],times:!1,buttonSets:["basic"],functions:["f","g","h"]};function _s(n){return{buttonSets:n.buttonSets,functions:n.functions,times:n.times,visibleLabel:n.visibleLabel,ariaLabel:n.ariaLabel,buttonsVisible:n.buttonsVisible,extraKeys:n.extraKeys}}const Vs={name:"expression",version:Gs,widgetOptionsUpgrades:qs,defaultWidgetOptions:$s,defaultAlignment:"inline-block",getPublicWidgetOptions:_s},zs={title:"",content:"",widgets:{},images:{},hint:null},Bs={name:"graded-group",defaultWidgetOptions:zs},Us={gradedGroups:[]},js={name:"graded-group-set",defaultWidgetOptions:Us};function Hs(n){const{correct:r,...e}=n;return e}const Ks={graph:{labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],backgroundImage:{url:null},markings:"graph",rulerLabel:"",rulerTicks:10,valid:!0,showTooltips:!1},correct:{type:"linear",coords:null},availableTypes:["linear"]},Xs={name:"grapher",defaultWidgetOptions:Ks,getPublicWidgetOptions:Hs},Ys={content:"",widgets:{},images:{}},Js={name:"group",defaultWidgetOptions:Ys};function Qs(n){return n}const Zs={url:"",settings:[{name:"",value:""}],width:"400",height:"400",allowFullScreen:!1,allowTopNavigation:!1},ei={name:"iframe",defaultWidgetOptions:Zs,getPublicWidgetOptions:Qs},ti={title:"",range:[[0,10],[0,10]],box:[400,400],backgroundImage:{url:null,width:0,height:0},labels:[],alt:"",caption:""},ni={name:"image",defaultWidgetOptions:ti,supportedAlignments:["block","full-width"],defaultAlignment:"block"},ri={value:0,simplify:"required",size:"normal",inexact:!1,maxError:.1,answerType:"number",rightAlign:!1},si={name:"input-number",defaultWidgetOptions:ri,defaultAlignment:"inline-block"},ii={graph:{box:[400,400],labels:["x","y"],range:[[-10,10],[-10,10]],tickStep:[1,1],gridStep:[1,1],markings:"graph"},elements:[]},ai={name:"interaction",defaultWidgetOptions:ii};function oi(n){const{correct:r,...e}=n;return e}const ci={labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],backgroundImage:{url:null},markings:"graph",showTooltips:!1,showProtractor:!1,graph:{type:"linear"},correct:{type:"linear",coords:null}},li={name:"interactive-graph",defaultWidgetOptions:ci,getPublicWidgetOptions:oi};function ui(n){return{...n,markers:n.markers.map(hi)}}function hi(n){const{answers:r,...e}=n;return e}const pi={choices:[],imageAlt:"",imageUrl:"",imageWidth:0,imageHeight:0,markers:[],multipleAnswers:!1,hideChoicesFromInstructions:!1},fi={name:"label-image",defaultWidgetOptions:pi,getPublicWidgetOptions:ui},Mt=function(n){let r=n;return function(){let e=r;return e=e+2127912214+(e<<12)&4294967295,e=(e^3345072700^e>>>19)&4294967295,e=e+374761393+(e<<5)&4294967295,e=(e+3550635116^e<<9)&4294967295,e=e+4251993797+(e<<3)&4294967295,e=(e^3042594569^e>>>16)&4294967295,(r=e&268435455)/268435456}};function Ze(n,r,e=!1){const t=l.clone(n);if(!t.length||l.all(t,function(i){return l.isEqual(i,t[0])}))return t;let s;typeof r=="function"?s=r:s=Mt(r);do for(let i=t.length;i>0;i--){const a=Math.floor(s()*i),c=t[a];t[a]=t[i-1],t[i-1]=c}while(e&&l.isEqual(n,t));return t}const ma=Mt(new Date().getTime()&4294967295),ya=n=>{const r=Mt(n.problemNum);let e;n.orderMatters?e=Ze(n.left,r,!0):e=n.left;const t=Ze(n.right,r,!0);return{left:e,right:t}};function di(n){let r;n.orderMatters?r=Ze(n.left,Math.random,!0):r=n.left;const e=Ze(n.right,Math.random,!0);return{left:r,right:e}}function gi(n){const{left:r,right:e}=di(n);return{...n,left:r,right:e}}const mi={left:["$x$","$y$","$z$"],right:["$1$","$2$","$3$"],labels:["test","label"],orderMatters:!1,padding:!0},yi={name:"matcher",defaultWidgetOptions:mi,getPublicWidgetOptions:gi};function bi(n){const{answers:r,...e}=n;return e}const vi={matrixBoardSize:[3,3],answers:[[]],prefix:"",suffix:"",cursorPosition:[0,0]},xi={name:"matrix",defaultWidgetOptions:vi,getPublicWidgetOptions:bi},wi={major:1,minor:0},ki={1:n=>{const{imageUrl:r,imageTop:e,imageLeft:t,...s}=n;return{...s,image:{url:r,top:e,left:t}}}},Oi={box:[480,480],image:{},showProtractor:!0,showRuler:!1,rulerLabel:"",rulerTicks:10,rulerPixels:40,rulerLength:10},Pi={name:"measurer",version:wi,widgetOptionsUpgrades:ki,defaultWidgetOptions:Oi};function Ti(n){const{correctX:r,correctRel:e,...t}=n;return t}const Si={range:[0,10],labelRange:[null,null],labelStyle:"decimal",labelTicks:!0,divisionRange:[1,12],numDivisions:5,snapDivisions:2,tickStep:null,correctRel:"eq",correctX:null,initialX:null,showTooltips:!1},Ai={name:"number-line",defaultWidgetOptions:Si,getPublicWidgetOptions:Ti};function Wi(n){const{answerForms:r,simplify:e,status:t}=n;return{answerForms:r,simplify:e,status:t}}function Ei(n){const{answers:r,...e}=n;return{...e,answers:r.map(Wi)}}const Ii={answers:[{value:null,status:"correct",message:"",simplify:"required",answerForms:[],strict:!1,maxError:null}],size:"normal",coefficient:!1,labelText:"",rightAlign:!1},Mi={name:"numeric-input",defaultWidgetOptions:Ii,defaultAlignment:"inline-block",getPublicWidgetOptions:Ei};function Ni(n){return{options:n.options,height:n.height,layout:n.layout}}const Li={correctOptions:[{content:"$x$"}],otherOptions:[{content:"$y$"}],height:"normal",layout:"horizontal"},Ci={name:"orderer",defaultWidgetOptions:Li,getPublicWidgetOptions:Ni},Fi={passageTitle:"",passageText:"",footnotes:"",showLineNumbers:!0},Di={name:"passage",defaultWidgetOptions:Fi},Ri={major:0,minor:1},Gi={passageNumber:1,referenceNumber:1,summaryText:""},qi={name:"passageRef",version:Ri,defaultWidgetOptions:Gi,defaultAlignment:"inline"},$i={content:""},_i={name:"passageRefTarget",defaultWidgetOptions:$i,defaultAlignment:"inline"},Vi={url:"",description:""},zi={name:"phet-simulation",defaultWidgetOptions:Vi};function Bi(n){const{correct:r,...e}=n;return e}const Ui={scaleY:1,maxY:10,snapsPerLine:2,correct:[1],starting:[1],type:"bar",labels:["",""],categories:[""],picSize:30,picBoxHeight:36,plotDimensions:[275,200],labelInterval:1,picUrl:null},ji={name:"plotter",defaultWidgetOptions:Ui,getPublicWidgetOptions:Bi},Hi={programID:"",height:400},Ki={name:"python-program",defaultWidgetOptions:Hi};function Xi(n){const{content:r,isNoneOfTheAbove:e,widgets:t}=n;return{content:r,isNoneOfTheAbove:e,widgets:t}}function Yi(n,r,e){return n&&r&&e}function Ji(n){const{numCorrect:r,choices:e,multipleSelect:t,countChoices:s}=n;return{...n,numCorrect:Yi(t,s,r)?r:void 0,choices:e.map(Xi)}}const Qi={name:"radio",version:rs,widgetOptionsUpgrades:ss,defaultWidgetOptions:is,getPublicWidgetOptions:Ji};function Zi(n){const r=Ze(n.correct,Math.random,!0);return{...n,correct:r,isCorrectShuffled:!0}}const ea={correct:["$x$","$y$","$z$"],layout:"horizontal",padding:!0},ta={name:"sorter",defaultWidgetOptions:ea,getPublicWidgetOptions:Zi};function na(n){const{answers:r,...e}=n;return e}const rn=4,sn=1,ra=new Array(rn).fill(0).map(()=>new Array(sn).fill("")),sa={headers:[""],rows:rn,columns:sn,answers:ra},ia={name:"table",defaultWidgetOptions:sa,getPublicWidgetOptions:na},aa={location:""},oa={name:"video",defaultWidgetOptions:aa,supportedAlignments:["block","float-left","float-right","full-width"],defaultAlignment:"block"},We={};function j(n,r){We[n]=r}function ba(n){return!!We[n]}function va(n){const r=We[n];return(r==null?void 0:r.version)||{major:0,minor:0}}const xa=n=>{var r;return((r=We[n])==null?void 0:r.getPublicWidgetOptions)??(e=>e)};function wa(n){const r=We[n];return(r==null?void 0:r.widgetOptionsUpgrades)||{}}function ka(n){const r=We[n];return(r==null?void 0:r.defaultWidgetOptions)||{}}const Oa=n=>{var e;const r=We[n];return(e=r==null?void 0:r.supportedAlignments)!=null&&e[0]?r==null?void 0:r.supportedAlignments:["default"]},Pa=n=>{const r=We[n];return r!=null&&r.defaultAlignment?r.defaultAlignment:"block"};j("categorizer",Ss);j("cs-program",Is);j("definition",Ns);j("dropdown",Fs);j("explanation",Rs);j("expression",Vs);j("graded-group",Bs);j("graded-group-set",js);j("grapher",Xs);j("group",Js);j("iframe",ei);j("image",ni);j("input-number",si);j("interaction",ai);j("interactive-graph",li);j("label-image",fi);j("matcher",yi);j("matrix",xi);j("measurer",Pi);j("number-line",Ai);j("numeric-input",Mi);j("orderer",Ci);j("passage",Di);j("passage-ref",qi);j("passage-ref-target",_i);j("phet-simulation",zi);j("plotter",ji);j("python-program",Ki);j("radio",Qi);j("sorter",ta);j("table",ia);j("video",oa);export{Ze as $,Pa as A,ai as B,li as C,Is as D,Bs as E,js as F,Xs as G,ua as H,pa as I,Js as J,ei as K,xi as L,Pi as M,Ci as N,Di as O,fa as P,qi as Q,_i as R,ia as S,oa as T,ze as U,ba as V,va as W,wa as X,ka as Y,Ct as Z,ha as _,Fs as a,ma as a0,ya as a1,si as b,Ss as c,Ns as d,Rs as e,Mi as f,ji as g,vr as h,ni as i,Ki as j,nn as k,fi as l,yi as m,Ai as n,da as o,zi as p,xa as q,Qi as r,ta as s,Vs as t,Yi as u,Kt as v,Xt as w,St as x,ga as y,Oa as z};
