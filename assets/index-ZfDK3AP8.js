import{_ as k}from"./extends-DDykod_l.js";import{r as n}from"./index-C6mWTJJr.js";import{V as c,I as N}from"./index-CW2s7ekB.js";import{m as A,c as R,u as w,b as M,T as H,w as U,a as z,f as G,I as V,x as W}from"./index-DAJiRA_A.js";import{s as d,a as f,b as Y}from"./index-Ds5N5m2R.js";import{c as K,b as j}from"./index-CFvGmn7i.js";import{r as y}from"./index-B1Gws05u.js";import{n as S}from"./no-important-DlFk8a1I.js";import{w as q}from"./index-3H81sEQ1.js";import{M as J}from"./index-CUPgSPQO.js";const F={root:{color:{inverse:{background:f.surface.inverse,foreground:f.text.inverse}},border:{radius:Y.radius.radius_040}},backdrop:{color:{background:f.surface.overlay}},dialog:{spacing:{padding:d.medium_16}},footer:{color:{border:f.border.primary}},header:{color:{border:f.border.primary,secondary:f.text.secondary},spacing:{paddingBlockMd:d.large_24,paddingInlineMd:d.xLarge_32,paddingInlineSm:d.medium_16,gap:d.xSmall_8,titleGapMd:d.medium_16,titleGapSm:d.xLarge_32}},panel:{spacing:{gap:d.xLarge_32}},closeButton:{spacing:{gap:d.xSmall_8}}},Q=A(F,{root:{color:{inverse:{background:f.khanmigo.primary}}}}),X={default:F,khanmigo:Q},g=R(F);function Z(t){const e=n.useContext(H),o=X[e]||F;return n.createElement(g.Provider,{value:o},t.children)}const ee=n.forwardRef(function(e,o){const{above:s,below:r,role:l="dialog",style:m,children:h,testId:i,"aria-labelledby":b,"aria-describedby":u}=e,{theme:v}=w(g),p=M(oe,v);return n.createElement(c,{style:[p.wrapper,m]},r&&n.createElement(c,{style:p.below},r),n.createElement(c,{role:l,"aria-modal":"true","aria-labelledby":b,"aria-describedby":u,ref:o,style:p.dialog,testId:i},h),s&&n.createElement(c,{style:p.above},s))}),P=n.forwardRef(function(e,o){return n.createElement(Z,null,n.createElement(ee,k({},e,{ref:o})))}),te="@media (max-width: 767px)",oe=t=>({wrapper:{display:"flex",flexDirection:"row",alignItems:"stretch",width:"100%",height:"100%",position:"relative",[te]:{padding:t.dialog.spacing.padding,flexDirection:"column"}},dialog:{width:"100%",height:"100%",borderRadius:t.root.border.radius,overflow:"hidden"},above:{pointerEvents:"none",position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:1},below:{pointerEvents:"none",position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:-1}});P.displayName="ModalDialog";function _({children:t}){const{theme:e}=w(g),o=M(ne,e);return n.createElement(c,{style:o.footer},t)}_.__IS_MODAL_FOOTER__=!0;_.isComponentOf=t=>t&&t.type&&t.type.__IS_MODAL_FOOTER__;const ne=t=>({footer:{flex:"0 0 auto",boxSizing:"border-box",minHeight:d.xxxLarge_64,paddingLeft:d.medium_16,paddingRight:d.medium_16,paddingTop:d.xSmall_8,paddingBottom:d.xSmall_8,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",boxShadow:`0px -1px 0px ${t.footer.color.border}`}});function C(t){const{breadcrumbs:e=void 0,light:o,subtitle:s=void 0,testId:r,title:l,titleId:m}=t;if(s&&e)throw new Error("'subtitle' and 'breadcrumbs' can't be used together");const{theme:h}=w(g),i=M(se,h);return n.createElement(c,{style:[i.header,!o&&i.dark],testId:r},e&&n.createElement(c,{style:i.breadcrumbs},e),n.createElement(K,{tag:"h2",style:i.title,id:m,testId:r&&`${r}-title`},l),s&&n.createElement(j,{style:o&&i.subtitle,testId:r&&`${r}-subtitle`},s))}const L="@media (max-width: 767px)",se=t=>({header:{boxShadow:`0px 1px 0px ${t.header.color.border}`,display:"flex",flexDirection:"column",minHeight:66,paddingBlock:t.header.spacing.paddingBlockMd,paddingInline:t.header.spacing.paddingInlineMd,position:"relative",width:"100%",[L]:{paddingInline:t.header.spacing.paddingInlineSm}},dark:{background:t.root.color.inverse.background,color:t.root.color.inverse.foreground},breadcrumbs:{color:t.header.color.secondary,marginBottom:t.header.spacing.gap},title:{paddingRight:t.header.spacing.titleGapMd,[L]:{paddingRight:t.header.spacing.titleGapSm}},subtitle:{color:t.header.color.secondary,marginTop:t.header.spacing.gap}});C.defaultProps={light:!0};const re='button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])';class le extends n.Component{constructor(...e){super(...e),this.modalRoot=void 0,this.getModalRoot=o=>{if(!o)return;const s=y.findDOMNode(o);if(!s)throw new Error("Assertion error: modal root should exist after mount");this.modalRoot=s},this.handleFocusMoveToLast=()=>{this.focusElementIn(!1)},this.handleFocusMoveToFirst=()=>{this.focusElementIn(!0)}}tryToFocus(e){if(e instanceof HTMLElement){try{e.focus()}catch{}return document.activeElement===e}}focusElementIn(e){const o=this.modalRoot,s=Array.from(o.querySelectorAll(re)),r=e?0:s.length-1,l=s[r];this.tryToFocus(l)}render(){const{style:e}=this.props;return n.createElement(n.Fragment,null,n.createElement("div",{tabIndex:0,className:"modal-focus-trap-first",onFocus:this.handleFocusMoveToLast,style:{position:"fixed"}}),n.createElement(c,{style:e,ref:this.getModalRoot},this.props.children),n.createElement("div",{tabIndex:0,className:"modal-focus-trap-last",onFocus:this.handleFocusMoveToFirst,style:{position:"fixed"}}))}}const B="data-modal-launcher-portal",ae="a[href], details, input, textarea, select, button";function de(t){return Array.from(t.querySelectorAll(ae))}class ie extends n.Component{constructor(...e){super(...e),this._mousePressedOutside=!1,this.handleMouseDown=o=>{this._mousePressedOutside=o.target===o.currentTarget},this.handleMouseUp=o=>{o.target===o.currentTarget&&this._mousePressedOutside&&this.props.onCloseModal(),this._mousePressedOutside=!1}}componentDidMount(){const e=y.findDOMNode(this);if(!e)return;const o=this._getInitialFocusElement(e)||this._getFirstFocusableElement(e)||this._getDialogElement(e);setTimeout(()=>{o.focus()},0)}_getInitialFocusElement(e){const{initialFocusId:o}=this.props;return o?y.findDOMNode(e.querySelector(`#${o}`)):null}_getFirstFocusableElement(e){const o=de(e);return o?o[0]:null}_getDialogElement(e){const o=y.findDOMNode(e.querySelector('[role="dialog"]'));return o.tabIndex=-1,o}render(){const{children:e,testId:o}=this.props,s={[B]:!0};return n.createElement(c,k({style:this.props.wbThemeStyles.modalPositioner,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,testId:o},s),e)}}const ce=t=>({modalPositioner:{position:"fixed",left:0,top:0,width:"100%",height:"100%",alignItems:"center",justifyContent:"center",overflow:"auto",background:t.backdrop.color.background}});var ue=U(ce,g)(ie);const O=(()=>{if(typeof window>"u")return!1;const t=window.navigator.userAgent;return t.indexOf("iPad")>-1||t.indexOf("iPhone")>-1})();class a extends n.Component{componentDidMount(){if(a.numModalsOpened===0){const e=document.body;if(!e)throw new Error("couldn't find document.body");a.oldOverflow=e.style.overflow,a.oldScrollY=window.scrollY,O&&(a.oldPosition=e.style.position,a.oldWidth=e.style.width,a.oldTop=e.style.top),e.style.overflow="hidden",O&&(e.style.position="fixed",e.style.width="100%",e.style.top=`${-a.oldScrollY}px`)}a.numModalsOpened++}componentWillUnmount(){if(a.numModalsOpened--,a.numModalsOpened===0){const e=document.body;if(!e)throw new Error("couldn't find document.body");e.style.overflow=a.oldOverflow,O&&(e.style.position=a.oldPosition,e.style.width=a.oldWidth,e.style.top=a.oldTop),typeof window<"u"&&window.scrollTo&&window.scrollTo(0,a.oldScrollY)}}render(){return null}}a.oldOverflow=void 0;a.oldPosition=void 0;a.oldScrollY=void 0;a.oldWidth=void 0;a.oldTop=void 0;a.numModalsOpened=0;const pe={closeModal:void 0},T=n.createContext(pe);T.displayName="ModalContext";class D extends n.Component{constructor(...e){super(...e),this.lastElementFocusedOutsideModal=void 0,this.state={opened:!1},this._saveLastElementFocused=()=>{this.lastElementFocusedOutsideModal=document.activeElement},this._openModal=()=>{this._saveLastElementFocused(),this.setState({opened:!0})},this._returnFocus=()=>{const{closedFocusId:o,schedule:s}=this.props,r=this.lastElementFocusedOutsideModal;if(o){const l=y.findDOMNode(document.getElementById(o));if(l){s.animationFrame(()=>{l.focus()});return}}r!=null&&s.animationFrame(()=>{r.focus()})},this.handleCloseModal=()=>{this.setState({opened:!1},()=>{const{onClose:o}=this.props;o==null||o(),this._returnFocus()})}}static getDerivedStateFromProps(e,o){return typeof e.opened=="boolean"&&e.children&&console.warn("'children' and 'opened' can't be used together"),typeof e.opened=="boolean"&&!e.onClose&&console.warn("'onClose' should be used with 'opened'"),typeof e.opened!="boolean"&&!e.children&&console.warn("either 'children' or 'opened' must be set"),{opened:typeof e.opened=="boolean"?e.opened:o.opened}}componentDidUpdate(e){!e.opened&&this.props.opened&&this._saveLastElementFocused()}_renderModal(){return typeof this.props.modal=="function"?this.props.modal({closeModal:this.handleCloseModal}):this.props.modal}render(){const e=this.props.children?this.props.children({openModal:this._openModal}):null,{body:o}=document;return o?n.createElement(T.Provider,{value:{closeModal:this.handleCloseModal}},e,this.state.opened&&y.createPortal(n.createElement(le,{style:he.container},n.createElement(ue,{initialFocusId:this.props.initialFocusId,testId:this.props.testId,onCloseModal:this.props.backdropDismissEnabled?this.handleCloseModal:()=>{}},this._renderModal())),o),this.state.opened&&n.createElement(me,{onClose:this.handleCloseModal}),this.state.opened&&n.createElement(a,null)):null}}D.defaultProps={backdropDismissEnabled:!0};class me extends n.Component{constructor(...e){super(...e),this._handleKeyup=o=>{o.key==="Escape"&&(o.preventDefault(),o.stopPropagation(),this.props.onClose())}}componentDidMount(){window.addEventListener("keyup",this._handleKeyup)}componentWillUnmount(){window.removeEventListener("keyup",this._handleKeyup)}render(){return null}}const he=S.StyleSheet.create({container:{zIndex:1080}});q(D);function E(t){const{scrollOverflow:e,style:o,children:s}=t,{theme:r}=w(g),l=M(ge,r);return n.createElement(c,{style:[l.wrapper,e&&l.scrollOverflow]},n.createElement(c,{style:[l.content,o]},s))}E.__IS_MODAL_CONTENT__=!0;E.isComponentOf=t=>t&&t.type&&t.type.__IS_MODAL_CONTENT__;const fe="@media (max-width: 767px)",ge=t=>({wrapper:{flex:1,display:"block"},scrollOverflow:{overflow:"auto"},content:{flex:1,minHeight:"100%",padding:d.xLarge_32,boxSizing:"border-box",[fe]:{padding:`${d.xLarge_32}px ${d.medium_16}px`}}});E.defaultProps={scrollOverflow:!0};class ye extends n.Component{render(){const{onClick:e,style:o,testId:s}=this.props;return n.createElement(T.Consumer,null,({closeModal:r})=>{if(r&&e)throw new Error("You've specified 'onClose' on a modal when using ModalLauncher.  Please specify 'onClose' on the ModalLauncher instead");return n.createElement(V,{icon:W,"aria-label":"Close modal",onClick:e||r,kind:"tertiary",actionType:"neutral",style:o,testId:s})})}}function $({closeButtonVisible:t=!0,scrollOverflow:e=!0,light:o=!0,content:s,footer:r,header:l,onClose:m,style:h,testId:i}){const{theme:b}=w(g),u=M(be,b),p=n.useCallback(()=>{const I=E.isComponentOf(s)?s:n.createElement(E,null,s);return I&&n.cloneElement(I,{scrollOverflow:e,style:[!!r&&u.hasFooter,I.props.style]})},[s,r,e,u.hasFooter])(),x=!o;return n.createElement(c,{style:[u.wrapper,x&&u.dark,h],testId:i&&`${i}-panel`},t&&n.createElement(ye,{onClick:m,style:[u.closeButton,x&&z.inverse],testId:i&&`${i}-close`}),l,p,!r||_.isComponentOf(r)?r:n.createElement(_,null,r))}$.defaultProps={closeButtonVisible:!0,scrollOverflow:!0,light:!0};const be=t=>({wrapper:{flex:"1 1 auto",position:"relative",display:"flex",flexDirection:"column",background:"white",boxSizing:"border-box",overflow:"hidden",height:"100%",width:"100%"},closeButton:{position:"absolute",right:t.closeButton.spacing.gap,top:t.closeButton.spacing.gap,zIndex:1,":focus":k({},G.focus[":focus-visible"])},dark:{background:t.root.color.inverse.background,color:t.root.color.inverse.foreground},hasFooter:{paddingBlockEnd:t.panel.spacing.gap}});class xe extends n.Component{renderHeader(e){const{title:o,breadcrumbs:s=void 0,subtitle:r=void 0,testId:l}=this.props;return s?n.createElement(C,{title:o,breadcrumbs:s,titleId:e,testId:l&&`${l}-header`}):r?n.createElement(C,{title:o,subtitle:r,titleId:e,testId:l&&`${l}-header`}):n.createElement(C,{title:o,titleId:e,testId:l&&`${l}-header`})}render(){const{onClose:e,footer:o,content:s,above:r,below:l,style:m,closeButtonVisible:h,testId:i,titleId:b,role:u,"aria-describedby":v}=this.props;return n.createElement(J,{styleSheets:Ee},({styles:p})=>n.createElement(N,{id:b},x=>n.createElement(P,{style:[p.dialog,m],above:r,below:l,testId:i,"aria-labelledby":x,"aria-describedby":v,role:u},n.createElement($,{onClose:e,header:this.renderHeader(x),content:s,footer:o,closeButtonVisible:h,testId:i}))))}}xe.defaultProps={closeButtonVisible:!0};const Ee={small:S.StyleSheet.create({dialog:{width:"100%",height:"100%",overflow:"hidden"}}),mdOrLarger:S.StyleSheet.create({dialog:{width:"93.75%",maxWidth:576,height:"81.25%",maxHeight:624}})};function we(t){let e=t&&t.parentElement;for(;e&&!e.hasAttribute(B);)e=e.parentElement;return e}function Le(t){return we(t)}export{Le as m};
