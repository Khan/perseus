import{j as n,a as l,F as I}from"./jsx-runtime-FVsy8kgq.js";import{p as _}from"./util-AYeX86gl.js";import{c as D,P as N,E as R}from"./article-renderer-RVZsjyZl.js";import{_ as g}from"./jquery-yG1GhClm.js";import"./phet-simulation-QObOE2Mw.js";import"./version-akiLXZts.js";import"./dependencies-d8cZibFS.js";import"./perseus-api-Nq3s7IMx.js";import{l as k}from"./perseus-item-IANtd9VS.js";import"./hints-renderer-AXmAIlH9.js";import"./renderer-hpnzDmf0.js";import"./base-radio-YLKsZpP4.js";import{c as T}from"./components-qZ3l6Ytr.js";import"./index-k-0mNqHS.js";import"./i18n-context-xqHghGAX.js";import"./svg-image-kf2QuogR.js";import{f as L}from"./index-J2t_5nK1.js";import"./index-xs9l8-Af.js";import{B as f}from"./choice-XJA1Q6b6.js";import{C as u,l as y}from"./index-QCAhLhLD.js";import{S as O}from"./index-qUyqkRvh.js";import{s as c,c as S}from"./index-deFLJwr4.js";import{H as A,d as q}from"./index-h_CiYGGb.js";import{l as o}from"./index-awljIyHI.js";import{r as v}from"./index-TT1qJ6UJ.js";import{R as B}from"./index-7vsPyIck.js";const F=class F extends v.Component{constructor(s){super(s),this.state={dragging:-1,components:this.props.components},this.onDrop=this.onDrop.bind(this),this.onDragStart=this.onDragStart.bind(this),this.onDragEnter=this.onDragEnter.bind(this)}componentDidMount(){this._setDragEvents()}UNSAFE_componentWillReceiveProps(s){this.setState({components:s.components})}componentDidUpdate(){this._setDragEvents()}onDragStart(s){this.setState({dragging:s})}onDrop(){this.setState({dragging:-1}),this.props.onReorder(this.state.components)}onDragEnter(s){if(this.state.dragging===s)return;const e=this.state.components.slice(),r=e.splice(this.state.dragging,1);e.splice(s,0,r[0]);const t=this.props.verify(e);return t&&this.setState({dragging:s,components:e}),t}_listenEvent(s){s.dataTransfer.setData("hackhackhack","because browsers!")}_cancelEvent(s){s.preventDefault()}_setDragEvents(){this._dragItems=this._dragItems||[];const s=B.findDOMNode(this).querySelectorAll("[draggable=true]"),e=[],r=[];for(let t=0;t<this._dragItems.length;t++){const a=this._dragItems[t];s.indexOf(a)<0&&e.push(a)}for(let t=0;t<s.length;t++){const a=s[t];this._dragItems.indexOf(a)<0&&r.push(a)}for(let t=0;t<r.length;t++){const a=r[t];a.addEventListener("dragstart",this._listenEvent),a.addEventListener("drop",this._cancelEvent)}for(let t=0;t<e.length;t++){const a=e[t];a.removeEventListener("dragstart",this._listenEvent),a.removeEventListener("drop",this._cancelEvent)}}render(){const s=this.state.components.map((e,r)=>n(Y,{index:r,component:e,area:this,draggable:e.props.draggable,dragging:r===this.state.dragging},e.key));return n("ol",{className:this.props.className,style:this.props.style,children:s})}};F.defaultProps={verify:()=>!0};let b=F;class Y extends v.Component{handleDragStart(s){s.nativeEvent.dataTransfer.effectAllowed="move",this.props.area.onDragStart(this.props.index)}handleDrop(){this.props.area.onDrop(this.props.index)}handleDragEnter(s){const e=this.props.area.onDragEnter(this.props.index);s.nativeEvent.dataTransfer.effectAllowed=e?"move":"none"}handleDragOver(s){s.preventDefault()}render(){let s="sortable-disabled";return this.props.dragging?s="sortable-dragging":this.props.draggable&&(s="sortable-enabled"),n("li",{draggable:this.props.draggable,className:[s,o.css(W.sortableListItem)].join(" "),onDragStart:this.handleDragStart,onDrop:this.handleDrop,onDragEnter:this.handleDragEnter,onDragOver:this.handleDragOver,children:this.props.component})}}const W=o.StyleSheet.create({sortableListItem:{margin:"5px 0"}});b.__docgenInfo={description:`TODO(LEMS-2667): 11/26/24, at the time of writing this comment
it has been identified that this file has been broken long before
the refactoring of createReactClass. Future implementation need
to determine how to fix this functionality or deprecate it.
*
Takes an array of components to sort.
As of 08/05/24, there are two sortable components
(one in perseus and one in perseus-editor).
As far as I can tell, this one is only used in ExpressionEditor.`,methods:[{name:"onDragStart",docblock:null,modifiers:[],params:[{name:"startIndex",optional:!1,type:null}],returns:null},{name:"onDrop",docblock:null,modifiers:[],params:[],returns:null},{name:"onDragEnter",docblock:null,modifiers:[],params:[{name:"enterIndex",optional:!1,type:null}],returns:null},{name:"_listenEvent",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:null}],returns:null},{name:"_cancelEvent",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:null}],returns:null},{name:"_setDragEvents",docblock:null,modifiers:[],params:[],returns:null}],displayName:"SortableArea",props:{className:{required:!1,tsType:{name:"string"},description:""},components:{required:!0,tsType:{name:"Array",elements:[{name:"ReactReactElement",raw:"React.ReactElement"}],raw:"React.ReactElement[]"},description:""},onReorder:{required:!0,tsType:{name:"signature",type:"function",raw:"(i: any[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"any"}],raw:"any[]"},name:"i"}],return:{name:"void"}}},description:""},style:{required:!1,tsType:{name:"any"},description:""},verify:{required:!1,tsType:{name:"signature",type:"function",raw:"(i: any) => boolean",signature:{arguments:[{type:{name:"any"},name:"i"}],return:{name:"boolean"}}},description:"",defaultValue:{value:"() => true",computed:!1}}}};const{InfoTip:h}=T,C=["basic","trig","prealgebra","logarithms","basic relations","advanced relations"],E=({key:d})=>Number.parseInt(d??""),z=d=>{const s=[];d.forEach(e=>{s[E(e)]=!0});for(let e=0;e<s.length;e++)if(!s[e])return e;return s.length},w=class w extends v.Component{constructor(s){super(s),this.change=(...e)=>D.apply(this,e),this.serialize=()=>{const e=["value","form","simplify","considered","key"],r=["answerForms","buttonSets","functions","times","visibleLabel","ariaLabel"],t=this.props.answerForms.map(a=>g(a).pick(e));return k(this.props).set(["answerForms"],t).mod([],a=>g(a).pick(r)).freeze()},this.getSaveWarnings=()=>{const e=[];return this.props.answerForms.length===0?e.push("No answers specified"):(this.props.answerForms.some(t=>t.considered==="correct")||e.push("No correct answer specified"),g(this.props.answerForms).each((t,a)=>{if(this.props.value==="")e.push(`Answer ${a+1} is empty`);else{const m=_(t.value,{functions:this.props.functions});m.parsed?t.simplify&&!m.expr.isSimplified()&&e.push(`${t.value} isn't simplified, but is required" +
                            " to be`):e.push(`Couldn't parse ${t.value}`)}})),e},this._newEmptyAnswerForm=()=>({considered:"correct",form:!1,key:z(this.props.answerForms),simplify:!1,value:""}),this.newAnswer=()=>{const e=this.props.answerForms.slice();e.push(this._newEmptyAnswerForm()),this.change({answerForms:e})},this.handleRemoveForm=e=>{const r=this.props.answerForms.slice();r.splice(e,1),this.change({answerForms:r})},this.handleReorder=e=>{const r=e.map(t=>{const a=g(t.props).pick("considered","form","simplify","value");return a.key=t.key,a});this.change({answerForms:r})},this.handleButtonSet=e=>{const t=C.filter(a=>this.props.buttonSets.includes(a)!==(a===e));this.props.onChange({buttonSets:t})},this.handleToggleDiv=()=>{let e,r;this.props.buttonSets.includes("basic+div")?(e="basic",r="basic+div"):(e="basic+div",r="basic");const t=this.props.buttonSets.filter(a=>a!==r).concat(e);this.change("buttonSets",t)},this.handleTexInsert=e=>{this.refs.expression.insert(e)},this.handleFunctions=e=>{this.setState({functionsInternal:e});const r={};r.functions=e.split(/[ ,]+/).filter(L),this.props.onChange(r)},this.changeExpressionWidget=(e,r)=>{const t={...this.props.answerForms[e],key:`${e}`,value:r.value};this.updateAnswerForm(e,t)},this.state={functionsInternal:this.props.functions.join(" ")}}updateAnswerForm(s,e){const r=k(this.props.answerForms).merge([s],e).freeze();this.change({answerForms:r})}changeSimplify(s,e){const r={...this.props.answerForms[s],key:`${s}`,simplify:e};this.updateAnswerForm(s,r)}changeForm(s,e){const r={...this.props.answerForms[s],form:e,key:`${s}`};this.updateAnswerForm(s,r)}changeConsidered(s,e){const r={...this.props.answerForms[s],key:`${s}`,considered:e};this.updateAnswerForm(s,r)}changeTimes(s){this.change({times:s})}render(){const s=this.props.answerForms.map(t=>{const a=E(t),m={times:this.props.times,functions:this.props.functions,buttonSets:this.props.buttonSets,buttonsVisible:"focused",value:t.value,onChange:p=>this.changeExpressionWidget(a,p),trackInteraction:()=>{},widgetId:this.props.widgetId+"-"+t.key,visibleLabel:this.props.visibleLabel,ariaLabel:this.props.ariaLabel};return n(U,{draggable:!0,considered:t.considered,expressionProps:m,form:t.form,simplify:t.simplify,onDelete:()=>this.handleRemoveForm(a),onChangeSimplify:p=>this.changeSimplify(a,p),onChangeForm:p=>this.changeForm(a,p),onChangeConsidered:p=>this.changeConsidered(a,p)})}),e=n(b,{components:s,onReorder:this.handleReorder}),r=C.map(t=>{const a=t==="basic",m=this.props.buttonSets.includes(t)||a;return n(u,{label:t,checked:m,disabled:a,onChange:()=>this.handleButtonSet(t)},t)});return r.unshift(n(u,{label:"show ÷ button",checked:this.props.buttonSets.includes("basic+div"),onChange:this.handleToggleDiv},"show ÷ button")),l("div",{children:[n(A,{children:"Global Options"}),l("div",{className:o.css(i.paddedY),children:[n(y,{label:"Visible label",value:this.props.visibleLabel||"",onChange:this.change("visibleLabel")}),n(h,{children:n("p",{children:"Optional visible text; strongly encouraged to help learners using dictation software, but can be omitted if the surrounding content provides enough context."})})]}),l("div",{className:o.css(i.paddedY),children:[n(y,{label:"Aria label",value:this.props.ariaLabel||"",onChange:this.change("ariaLabel")}),n(h,{children:l("p",{children:["Label text that's read by screen readers. Highly recommend adding a label here to ensure your exercise is accessible. For more information on writting accessible labels, please see"," ",n("a",{href:"https://www.w3.org/WAI/tips/designing/#ensure-that-form-elements-include-clearly-associated-labels",target:"_blank",children:"this article."})]})})]}),l("div",{className:o.css(i.paddedY),children:[n(y,{label:"Function variables",value:this.state.functionsInternal,onChange:this.handleFunctions}),n(h,{children:n("p",{children:'Single-letter variables listed here will be interpreted as functions. This let us know that f(x) means "f of x" and not "f times x".'})})]}),l("div",{className:o.css(i.paddedY),children:[n(u,{label:"Use × instead of ⋅ for multiplication",checked:this.props.times,onChange:t=>{this.changeTimes(t)}}),n(h,{children:n("p",{children:"For pre-algebra problems this option displays multiplication as \\times instead of \\cdot in both the rendered output and the acceptable formats examples."})})]}),l("div",{className:o.css(i.paddedY),children:[n(q,{children:"Button Sets"}),r]}),n(A,{children:"Answers"}),n("p",{style:{margin:"4px 0"},children:"student responses area matched against these from top to bottom"}),e,n("div",{children:n(f,{size:"small",onClick:this.newAnswer,children:"Add new answer"})})]})}};w.widgetName="expression",w.defaultProps={answerForms:[],times:!1,buttonSets:["basic"],functions:["f","g","h"]};let x=w;const P=function(d,s){let e=d.indexOf(s);return e=(e+1)%d.length,d[e]};class U extends v.Component{constructor(){super(...arguments),this.state={deleteFocused:!1},this.change=(...s)=>D.apply(this,s),this.handleImSure=()=>{this.props.onDelete()},this.handleCancelDelete=()=>{this.setState({deleteFocused:!1})},this.handleDelete=()=>{this.setState({deleteFocused:!0})},this.toggleConsidered=()=>{const s=P(N,this.props.considered);this.props.onChangeConsidered(s)}}render(){const s=this.state.deleteFocused?l(I,{children:[n(f,{size:"small",onClick:this.handleImSure,color:"destructive",children:"I'm sure!"}),n(O,{size:c.small_12}),n(f,{size:"small",onClick:this.handleCancelDelete,light:!0,children:"Cancel"})]}):n(f,{size:"small",onClick:this.handleDelete,color:"destructive",light:!0,children:"Delete"}),e=o.css(i.answerStatus,this.props.considered==="wrong"&&i.answerStatusWrong,this.props.considered==="correct"&&i.answerStatusCorrect,this.props.considered==="ungraded"&&i.answerStatusUngraded);return l("div",{className:o.css(i.answerOption),children:[n("div",{className:o.css(i.answerHandle)}),l("div",{className:o.css(i.answerBody),children:[l("div",{children:[n("button",{onClick:this.toggleConsidered,className:e,children:this.props.considered}),n("div",{children:n(R,{...this.props.expressionProps})})]}),l("div",{className:o.css(i.paddedY,i.paddedX),children:[n(u,{label:"Answer expression must have the same form.",checked:this.props.form,onChange:this.props.onChangeForm}),n(h,{children:n("p",{children:"The student's answer must be in the same form. Commutativity and excess negative signs are ignored."})})]}),l("div",{className:o.css(i.paddedY,i.paddedX),children:[n(u,{label:"Answer expression must be fully expanded and simplified.",checked:this.props.simplify,onChange:this.props.onChangeSimplify}),n(h,{children:n("p",{children:`The student's answer must be fully expanded and simplified. Answering this equation (x^2+2x+1) with this factored equation (x+1)^2 will render this response "Your answer is not fully expanded and simplified."`})})]}),n("div",{className:o.css(i.buttonRow,i.paddedY),children:s})]})]})}}const i=o.StyleSheet.create({paddedX:{paddingLeft:c.xSmall_8,paddingRight:c.xSmall_8},paddedY:{paddingTop:c.xxSmall_6,paddingBottom:c.xxSmall_6},answerOption:{border:"1px solid #ddd",borderRadius:"3px",display:"flex"},answerHandle:{background:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==) no-repeat 50% 50%",borderRight:"1px solid #ddd",cursor:"move",width:"20px",minWidth:"20px"},answerStatus:{border:"none",userSelect:"none",width:"100px",paddingTop:c.small_12,paddingBottom:c.small_12},answerStatusWrong:{backgroundColor:S.fadedRed16},answerStatusCorrect:{backgroundColor:S.fadedGreen16},answerStatusUngraded:{backgroundColor:S.fadedBlue16},answerBody:{},buttonRow:{display:"flex"}});x.__docgenInfo={description:"",methods:[{name:"change",docblock:null,modifiers:[],params:[{name:"...args",optional:!1,type:null}],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:null},{name:"getSaveWarnings",docblock:null,modifiers:[],params:[],returns:null},{name:"_newEmptyAnswerForm",docblock:null,modifiers:[],params:[],returns:null},{name:"newAnswer",docblock:null,modifiers:[],params:[],returns:null},{name:"handleRemoveForm",docblock:null,modifiers:[],params:[{name:"i",optional:!1,type:null}],returns:null},{name:"updateAnswerForm",docblock:null,modifiers:[],params:[{name:"i",optional:!1,type:{name:"number"}},{name:"props",optional:!1,type:{name:'PerseusExpressionWidgetOptions["answerForms"][number]',raw:'PerseusExpressionWidgetOptions["answerForms"][number]',alias:"AnswerForm"}}],returns:null},{name:"handleReorder",docblock:null,modifiers:[],params:[{name:"components",optional:!1,type:null}],returns:null},{name:"handleButtonSet",docblock:null,modifiers:[],params:[{name:"changingName",optional:!1,type:null}],returns:null},{name:"handleToggleDiv",docblock:null,modifiers:[],params:[],returns:null},{name:"handleTexInsert",docblock:null,modifiers:[],params:[{name:"str",optional:!1,type:null}],returns:null},{name:"handleFunctions",docblock:null,modifiers:[],params:[{name:"value",optional:!1,type:null}],returns:null},{name:"changeSimplify",docblock:null,modifiers:[],params:[{name:"key",optional:!1,type:{name:"number"}},{name:"simplify",optional:!1,type:{name:"boolean"}}],returns:null},{name:"changeForm",docblock:null,modifiers:[],params:[{name:"key",optional:!1,type:{name:"number"}},{name:"form",optional:!1,type:{name:"boolean"}}],returns:null},{name:"changeConsidered",docblock:null,modifiers:[],params:[{name:"key",optional:!1,type:{name:"number"}},{name:"considered",optional:!1,type:{name:"unknown[number]",raw:"(typeof PerseusExpressionAnswerFormConsidered)[number]"}}],returns:null},{name:"changeTimes",docblock:null,modifiers:[],params:[{name:"times",optional:!1,type:{name:"boolean"}}],returns:null},{name:"changeExpressionWidget",docblock:null,modifiers:[],params:[{name:"key",optional:!1,type:null},{name:"props",optional:!1,type:null}],returns:null}],displayName:"ExpressionEditor",props:{widgetId:{required:!1,tsType:{name:"any"},description:""},value:{required:!1,tsType:{name:"string"},description:""},answerForms:{defaultValue:{value:"[]",computed:!1},required:!1},times:{defaultValue:{value:"false",computed:!1},required:!1},buttonSets:{defaultValue:{value:'["basic"]',computed:!1},required:!1},functions:{defaultValue:{value:'["f", "g", "h"]',computed:!1},required:!1}}};export{x as E};
