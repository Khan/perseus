import{_ as p}from"./index-default-4_ZsnO94.js";import{P as F,E}from"./perseus-error-OpXxk17X.js";import{p as T,c as C}from"./compare-VLxlEkSV.js";import{$ as g}from"./jquery-5v7aFUvu.js";import{a as j}from"./version-akiLXZts.js";const H="@khanacademy/kmath",J="__lib_version__";j(H,J);const x=1e-9,K=Math.pow(2,-42);function Ve(e){return p.isNumber(e)&&!p.isNaN(e)}function v(e,t,n){return e==null||t==null?e===t:e===t?!0:(n==null&&(n=x),Math.abs(e-t)<n)}function We(e,t){return v(e,0,t)?0:Math.abs(e)/e}function Q(e,t){return v(Math.round(e),e,t)}function qe(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}function ze(e,t){return Math.round(e/t)*t}function ke(e,t){return Math.floor(e/t)*t}function Xe(e,t){return Math.ceil(e/t)*t}function D(e,t=K,n=1e3){let r=[1,0],a=[0,1],u=Math.floor(e),i=e-u;for(;a[0]<=n;){if(v(r[0]/a[0],e,t))return[r[0],a[0]];r=[u*r[0]+r[1],r[0]],a=[u*a[0]+a[1],a[0]],u=Math.floor(1/i),i=1/i-u}return[e,1]}const m={cleanMath:function(e){return typeof e=="string"?e.replace(/\+\s*-/g,"- ").replace(/-\s*-/g,"+ ").replace(/\^1/g,""):e},bound:function(e){return e===0?e:e<0?-m.bound(-e):Math.max(1e-6,Math.min(e,1e20))},factorial:function(e){return e<=1?e:e*m.factorial(e-1)},getGCD:function(e,t){if(arguments.length>2){const r=[].slice.call(arguments,1);return m.getGCD(e,m.getGCD(...r))}let n;for(e=Math.abs(e),t=Math.abs(t);t;)n=e%t,e=t,t=n;return e},getLCM:function(e,t){if(arguments.length>2){const n=[].slice.call(arguments,1);return m.getLCM(e,m.getLCM(...n))}return Math.abs(e*t)/m.getGCD(e,t)},primes:[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97],isPrime:function(e){if(e<=1)return!1;if(e<101)return!!g.grep(m.primes,function(t,n){return Math.abs(t-e)<=.5}).length;if(e<=1||e>2&&e%2===0)return!1;for(let t=3,n=Math.sqrt(e);t<=n;t+=2)if(e%t===0)return!1;return!0},getPrimeFactorization:function(e){if(e===1)return[];if(m.isPrime(e))return[e];const t=Math.sqrt(e);for(let n=2;n<=t;n++)if(e%n===0)return g.merge(m.getPrimeFactorization(n),m.getPrimeFactorization(e/n))},roundToNearest:function(e,t){return Math.round(t/e)*e},roundTo:function(e,t){const n=Math.pow(10,e).toFixed(5);return Math.round((t*n).toFixed(5))/n},toFixedApprox:function(e,t){const n=e.toFixed(t);return v(+n,e)?n:"\\approx "+n},roundToApprox:function(e,t){const n=m.roundTo(t,e);return v(n,e)?String(n):m.toFixedApprox(e,t)},toFraction:function(e,t){if(t==null&&(t=Math.pow(2,-46)),e<0||e>1){let o=e%1;o+=o<0?1:0;const d=m.toFraction(o,t);return d[0]+=Math.round(e-o)*d[1],d}if(Math.abs(Math.round(Number(e))-e)<=t)return[Math.round(e),1];let n=0,r=1,a=1,u=1,i=1,s=2;for(;;){if(Math.abs(Number(i/s)-e)<=t)return[i,s];i/s<e?(n=i,r=s):(a=i,u=s),i=n+a,s=r+u}},getNumericFormat:function(e){if(e=g.trim(e),e=e.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1"),e.match(/^[+-]?\d+$/))return"integer";if(e.match(/^[+-]?\d+\s+\d+\s*\/\s*\d+$/))return"mixed";const t=e.match(/^[+-]?(\d+)\s*\/\s*(\d+)$/);return t?parseFloat(t[1])>parseFloat(t[2])?"improper":"proper":e.replace(/[,. ]/g,"").match(/^\d+$/)?"decimal":e.match(/(pi?|\u03c0|t(?:au)?|\u03c4|pau)/)?"pi":null},toNumericString:function(e,t){if(e==null)return"";if(e===0)return"0";if(t==="percent")return e*100+"%";if(t==="pi"){const n=D(e/Math.PI),r=Math.abs(n[0]),a=n[1];if(Q(r))return(e<0?"-":"")+(r===1?"":r)+"π"+(a===1?"":"/"+a)}if(p(["proper","improper","mixed","fraction"]).contains(t)){const n=D(e),r=Math.abs(n[0]),a=n[1],u=e<0?"-":"";if(a===1)return u+r;if(t==="mixed"){const i=r%a,s=(r-i)/a;return u+(s?s+" ":"")+i+"/"+a}return u+r+"/"+a}return String(e)}};function je(e){return e.reduce(Y,0)}function Y(e,t){return e+t}const Z=Math.pow(2,-42),y={predicate:{defaultForms:"integer, proper, improper, mixed, decimal",createValidatorFunctional:function(e,t,n){t=p.extend({simplify:"required",ratio:!1,forms:y.predicate.defaultForms},t);let r;p.isArray(t.forms)?r=t.forms:r=t.forms.split(/\s*,\s*/),t.inexact===void 0&&(t.maxError=0),t.maxError=+t.maxError+Z,p.contains(r,"percent")&&(r=p.without(r,"percent"),r.push("percent"));const a=function(i){i=i.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").replace(/(^\s*)|(\s*$)/gi,"");const s=i.match(/^([+-]?\d+)\s*\/\s*([+-]?\d+)$/),o=i.match(/^([+-]?)\\frac\{([+-]?\d+)\}\{([+-]?\d+)\}$/),d=parseInt(i,10);if(s||o){let c,f,l=!0;return s?(c=parseFloat(s[1]),f=parseFloat(s[2])):(c=parseFloat(o[2]),o[1]==="-"&&(c<0&&(l=!1),c=-c),f=parseFloat(o[3])),l=l&&f>0&&(t.ratio||f!==1)&&m.getGCD(c,f)===1,[{value:c/f,exact:l}]}return!isNaN(d)&&""+d===i?[{value:d,exact:!0}]:[]},u={integer:function(i){const s=u.decimal(i),o=u.decimal(i,1);return s[0].value!=null&&s[0].value===o[0].value||s[1].value!=null&&s[1].value===o[1].value?s:[]},proper:function(i){return g.map(a(i),function(s){return Math.abs(s.value)<1?[s]:[]})},improper:function(i){return g.map(a(i),function(s){return Math.abs(s.value)>=1?[s]:[]})},pi:function(i){let s,o=[];if(i=i.replace(/\u2212/,"-"),s=i.match(/^([+-]?)\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i))o=[{value:parseFloat(s[1]+"1"),exact:!0}];else if(s=i.match(/^([+-]?\s*\d+\s*(?:\/\s*[+-]?\s*\d+)?)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i))o=a(s[1]);else if(s=i.match(/^([+-]?)\s*(\d+)\s*([+-]?\d+)\s*\/\s*([+-]?\d+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i)){const c=parseFloat(s[1]+"1"),f=parseFloat(s[2]),l=parseFloat(s[3]),h=parseFloat(s[4]),w=l<h&&m.getGCD(l,h)===1;o=[{value:c*(f+l/h),exact:w}]}else if(s=i.match(/^([+-]?\s*\d+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)\s*(?:\/\s*([+-]?\s*\d+))?$/i))o=a(s[1]+"/"+s[3]);else if(s=i.match(/^([+-]?)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)\s*(?:\/\s*([+-]?\d+))?$/i))o=a(s[1]+"1/"+s[3]);else if(i==="0")o=[{value:0,exact:!0}];else if(s=i.match(/^(.+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i))o=u.decimal(s[1]);else{o=p.reduce(y.predicate.defaultForms.split(/\s*,\s*/),function(l,h){return l.concat(u[h](i))},[]);let c=!1;const f=parseFloat(i);if(!isNaN(f)&&f!==parseInt(i)){const l=Math.PI/12,h=l*Math.round(f/l);Math.abs(f-h)<.01&&(c=!0)}else i.match(/\/\s*7/)&&(c=!0);return c&&p.each(o,function(l){l.piApprox=!0}),o}let d=Math.PI;return i.match(/\\?tau|t|\u03c4/)&&(d=Math.PI*2),i.match(/pau/)&&(d=Math.PI*1.5),g.each(o,function(c,f){f.value*=d}),o},coefficient:function(i){let s=[];return i=i.replace(/\u2212/,"-"),i===""?s=[{value:1,exact:!0}]:i==="-"&&(s=[{value:-1,exact:!0}]),s},log:function(i){let s,o=[];return i=i.replace(/\u2212/,"-"),i=i.replace(/[ \(\)]/g,""),(s=i.match(/^log\s*(\S+)\s*$/i))?o=u.decimal(s[1]):i==="0"&&(o=[{value:0,exact:!0}]),o},percent:function(i){i=g.trim(i);let s=!1;i.indexOf("%")===i.length-1&&(i=g.trim(i.substring(0,i.length-1)),s=!0);const o=u.decimal(i);return g.each(o,function(d,c){c.exact=s,c.value=c.value/100}),o},mixed:function(i){const s=i.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").match(/^([+-]?)(\d+)\s+(\d+)\s*\/\s*(\d+)$/);if(s){const o=parseFloat(s[1]+"1"),d=parseFloat(s[2]),c=parseFloat(s[3]),f=parseFloat(s[4]),l=c<f&&m.getGCD(c,f)===1;return[{value:o*(d+c/f),exact:l}]}return[]},decimal:function(i,s=1e10){const o=function(c){c=g.trim(c);const f=c.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").match(/^([+-]?(?:\d{1,3}(?:[, ]?\d{3})*\.?|\d{0,3}(?:[, ]?\d{3})*\.(?:\d{3}[, ]?)*\d{1,3}))$/),l=c.match(/^0[0,]*,/);if(f&&!l){let h=parseFloat(f[1].replace(/[, ]/g,""));return t.inexact===void 0&&(h=Math.round(h*s)/s),h}},d=function(c){return c=c.replace(/([\.,])/g,function(f,l){return l==="."?",":"."}),o(c)};return[{value:o(i),exact:!0},{value:d(i),exact:!0}]}};return function(i){const s=t.fallback!=null?""+t.fallback:"";i=g.trim(i)||s;const o={empty:i==="",correct:!1,message:null,guess:i};if(g.each(r,function(d,c){const f=u[c](i);for(let l=0,h=f.length;l<h;l++){const w=f[l].value,k=f[l].exact,X=f[l].piApprox;if(e(w,t.maxError))return k||t.simplify==="optional"?(o.correct=!0,o.message=t.message||null,o.empty=!1):c==="percent"?(o.empty=!0,o.message=n.MISSING_PERCENT_ERROR):(t.simplify!=="enforced"&&(o.empty=!0),o.message=n.NEEDS_TO_BE_SIMPLFIED_ERROR),!1;X&&e(w,Math.abs(w*.001))&&(o.empty=!0,o.message=n.APPROXIMATED_PI_ERROR)}}),o.correct===!1){let d=!1;if(p.each(u,function(c){p.any(c(i),function(l){return l.value!=null&&!p.isNaN(l.value)})&&(d=!0)}),!d)return o.empty=!0,o.message=n.EXTRA_SYMBOLS_ERROR,o}return o}}},number:{convertToPredicate:function(e,t){const n=parseFloat(e);return[function(r,a){return Math.abs(r-n)<a},g.extend({},t,{type:"predicate"})]},createValidatorFunctional:function(e,t,n){return y.predicate.createValidatorFunctional(...y.number.convertToPredicate(e,t),n)}},expression:{parseSolution:function(e,t){let n=T(e,t);if(n.parsed){if(t.simplified&&!n.expr.isSimplified())throw new F("The provided solution ("+e+") isn't fully expanded and simplified.",E.InvalidInput);n=n.expr}else throw new F("The provided solution ("+e+") didn't parse.",E.InvalidInput);return n},createValidatorFunctional:function(e,t,n){return function(r){const a={empty:!1,correct:!1,message:null,guess:r,ungraded:!1};if(!r)return a.empty=!0,a;const u=T(r,t);if(!u.parsed)return a.empty=!0,a;typeof e=="string"&&(e=y.expression.parseSolution(e,t));const i=C(u.expr,e,t);if(i.equal)a.correct=!0;else if(i.wrongVariableNames||i.wrongVariableCase)a.ungraded=!0,a.message=i.wrongVariableCase?n.WRONG_CASE_ERROR:n.WRONG_LETTER_ERROR,a.suppressAlmostThere=!0;else if(i.message)a.message=i.message;else{const s=T(r.replace(/[xX]/g,"*"),t);if(s.parsed){const o=C(s.expr,e,t);o.equal?(a.ungraded=!0,a.message=n.MULTIPLICATION_SIGN_ERROR):o.message&&(a.message=o.message+" Also, I'm a computer. I only understand multiplication if you use an asterisk (*) as the multiplication sign.")}}return a}}}},A=/^web\+graphie:/,L=/^file\+graphie:/;function P(e){return G(e)?U(e):e}function G(e){return A.test(e)||L.test(e)}function S(e){return e.replace(A,"https:").replace(L,"file:")}function U(e){return S(e)+".svg"}function B(e){return S(e)+"-data.json"}async function ee(e){const t=new Image;return new Promise((n,r)=>{t.onload=()=>{n([t.naturalWidth,t.naturalHeight])},t.onerror=r,t.src=P(e)})}let $=!1;const V=function(e,t,n){return Array.isArray(e)?p.map(e,function(r){return V(r,t)}):t.call(n,e)};function te(e,t){return e==null||t==null?e==null==(t==null):e.length===t.length&&e.every((n,r)=>t[r]===n)}const W=/^\[\[\u2603 (([a-z-]+) ([0-9]+))\]\]/,ne=/^([a-z-]+) ([0-9]+)$/,re=new RegExp(W.source+"$"),ie="☃",ae={type:"points",earned:0,total:0,message:null},R=function(e){let t=e;return function(){let n=t;return n=n+2127912214+(n<<12)&4294967295,n=(n^3345072700^n>>>19)&4294967295,n=n+374761393+(n<<5)&4294967295,n=(n+3550635116^n<<9)&4294967295,n=n+4251993797+(n<<3)&4294967295,n=(n^3042594569^n>>>16)&4294967295,(t=n&268435455)/268435456}};function se(e,t,n=!1){const r=p.clone(e);if(!r.length||p.all(r,function(u){return p.isEqual(u,r[0])}))return r;let a;typeof t=="function"?a=t:a=R(t);do for(let u=r.length;u>0;u--){const i=Math.floor(a()*u),s=r[i];r[i]=r[u-1],r[u-1]=s}while(n&&p.isEqual(e,r));return r}const oe="x".split(/(.)/g).length?function(e,t){return e.split(t)}:function(e,t){const n=[];let r=t.lastIndex=0,a;for(;a=t.exec(e);){const u=a;n.push(e.slice(r,u.index)),n.push(...u.slice(1)),r=u.index+u[0].length}return n.push(e.slice(r)),n};function ue(e,t){let n;if(e.type==="points"&&t.type==="points")return e.message&&t.message&&e.message!==t.message?n=null:n=e.message||t.message,{type:"points",earned:e.earned+t.earned,total:e.total+t.total,message:n};if(e.type==="points"&&t.type==="invalid")return t;if(e.type==="invalid"&&t.type==="points")return e;if(e.type==="invalid"&&t.type==="invalid")return e.message&&t.message&&e.message!==t.message?n=null:n=e.message||t.message,{type:"invalid",message:n};throw new F("PerseusScore with unknown type encountered",E.InvalidInput,{metadata:{scoreA:JSON.stringify(e),scoreB:JSON.stringify(t)}})}function ce(e){return e.type==="points"&&e.earned>=e.total}function le(e,t,n){if(e.type==="points")return{empty:!1,correct:ce(e),message:e.message,guess:t,state:n};if(e.type==="invalid")return{empty:!0,correct:!1,message:e.message,suppressAlmostThere:e.suppressAlmostThere,guess:t,state:n};throw new F("Invalid score type: "+e.type,E.InvalidInput,{metadata:{score:JSON.stringify(e),guess:JSON.stringify(t),state:JSON.stringify(n)}})}function fe(e,t){let n;return y.predicate.createValidatorFunctional(function(a){return n=a,!0},{simplify:"optional",inexact:!0,forms:"integer, proper, improper, pi, log, mixed, decimal"},t)(e),n}function pe(e){return p(e).times(function(){return""})}function de(e,t,n,r){const a=b(t,n),i=e*a>30;return{scale:a,tickStep:e/r,unityLabel:i}}function me(e,t,n){return p(2).times(function(r){const a=b(e[r],n);return q(t[r],a)})}function he(e){return[e[0]/2,e[1]/2]}function q(e,t){const n=e*t,r=e,a=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),u=Math.floor(r/a);if(n<25)return e;if(n<50)return u===5?e:e/2;if(u===1)return e/2;if(u===2)return e/4;if(u===5)return e/5}function b(e,t){const n=e[1]-e[0];return t/n}function ge(e,t){const n=e[1]-e[0];let r;15<n&&n<=20?r=23:n>100||n<5?r=10:r=16;const a=t/500,u=r*a;return O(n,u)}function O(e,t){let n=Math.pow(10,Math.floor(Math.log(e/t)/Math.LN10));const r=t/e*n;return r<=.15?n*=10:r<=.35?n*=5:r<=.75&&(n*=2),n}const _=(e,t)=>{const n=t[1]-t[0],r=n/e;return r<=10?e:r<=20?e*2:O(n,10)};function Me(e,t){return[_(e[0],t[0]),_(e[1],t[1])]}const ye={UNSAFE_componentWillMount:function(){const e={};p.each(this.deprecatedProps,function(t,n){p.has(this.props,n)&&p.extend(e,t(this.props))},this),p.isEmpty(e)||(p.extend(this.props,e),setTimeout(this.props.onChange,0,e))}};function N(e,t){return typeof e=="number"&&typeof t=="number"?Math.abs(e-t)<1e-9:e===t}function I(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!I(e[n],t[n]))return!1;return!0}return Array.isArray(e)||Array.isArray(t)?!1:typeof e=="function"&&typeof t=="function"?N(e,t):typeof e=="function"||typeof t=="function"?!1:typeof e=="object"&&typeof t=="object"&&e&&t?e===t||p.all(e,function(n,r){return I(t[r],n)})&&p.all(t,function(n,r){return I(e[r],n)}):typeof e=="object"&&e||typeof t=="object"&&t?!1:N(e,t)}function we(e){e=e||window.location.search.substring(1);const t={},n=/\+/g,r=/([^&=]+)=?([^&]*)/g,a=function(i){return decodeURIComponent(i.replace(n," "))};let u;for(;u=r.exec(e);){const i=u;t[a(i[1])]=a(i[2])}return t}function ve(e,t,n){n=encodeURIComponent(n);const r=new RegExp("([?&])"+t+"=.*?(&|$)","i"),a=e.indexOf("?")!==-1?"&":"?";return e.match(r)?e.replace(r,"$1"+t+"="+n+"$2"):e+a+t+"="+n}function Ie(e){return encodeURIComponent(e).replace(/['()!]/g,window.escape).replace(/\*/g,"%2A")}function Fe(e){if(!e)return!1;switch(e.type){case"measurer":case"protractor":return!0;default:return!1}}function Ee(e){return e.type==="invalid"&&(!e.message||e.message.length===0)}const M={pointerDown:!1,currentTouchIdentifier:null};function Te(){Object.assign(M,{pointerDown:!1,currentTouchIdentifier:null})}function Ne(e){let t;if(M.pointerDown){if(M.currentTouchIdentifier!=null){const r=e.changedTouches?e.changedTouches.length:0;for(let a=0;a<r;a++)e.changedTouches[a].identifier===M.currentTouchIdentifier&&(t=e.changedTouches[a])}else t=e;const n=e.type==="touchend"||e.type==="touchcancel";t&&n&&(M.pointerDown=!1,M.currentTouchIdentifier=null)}else M.pointerDown=!0,e.changedTouches?(t=e.changedTouches[0],M.currentTouchIdentifier=t.identifier):t=e;if(t)return{left:t.pageX,top:t.pageY}}const Pe=()=>{try{const e=Object.defineProperty({},"passive",{get:function(){$=!0}});window.addEventListener("testPassive",null,e),window.removeEventListener("testPassive",null,e)}catch{}return $};function Se(e){e.stopPropagation()}function Re(e,t){const n=new Image;n.onload=function(){var r;n.width===0&&n.height===0?((r=document.body)==null||r.appendChild(n),p.defer(function(){var a;t(n.clientWidth,n.clientHeight),(a=document.body)==null||a.removeChild(n)})):t(n.width,n.height)},n.src=P(e)}function be(e){const t=e.value,n=e.selectionStart-1,r=Math.max(t.lastIndexOf(`
`,n),t.lastIndexOf(" ",n))+1;return{string:t.substring(r,n+1),pos:{start:r,end:n}}}function Oe(e,t){e.selectionStart=t,e.selectionEnd=t}const Ce={getWordBeforeCursor:be,moveCursor:Oe},De=e=>e.startsWith("$")&&e.endsWith("$")?e.slice(1,-1):e,$e=R(new Date().getTime()&4294967295);function z(e){return Array.isArray(e)?e.map(z):e}const He={inputPathsEqual:te,nestedMap:V,rWidgetRule:W,rTypeFromWidgetId:ne,rWidgetParts:re,snowman:ie,noScore:ae,seededRNG:R,shuffle:se,split:oe,combineScores:ue,keScoreFromPerseusScore:le,firstNumericalParse:fe,stringArrayOfSize:pe,gridDimensionConfig:de,getGridStep:me,snapStepFromGridStep:he,scaleFromExtent:b,tickStepFromExtent:ge,gridStepFromTickStep:q,tickStepFromNumTicks:O,constrainedTickStepsFromTickSteps:Me,DeprecationMixin:ye,eq:N,deepEq:I,parseQueryString:we,updateQueryString:ve,strongEncodeURIComponent:Ie,widgetShouldHighlight:Fe,scoreIsEmpty:Ee,touchHandlers:M,resetTouchHandlers:Te,extractPointerLocation:Ne,supportsPassiveEvents:Pe,captureScratchpadTouchStart:Se,getImageSize:Re,getImageSizeModern:ee,getRealImageUrl:P,isLabeledSVG:G,getBaseUrl:S,getSvgUrl:U,getDataUrl:B,textarea:Ce,unescapeMathMode:De,random:$e,deepClone:z};export{x as D,m as K,He as U,ce as a,Ve as b,ze as c,Xe as d,v as e,ke as f,y as g,We as h,Q as i,qe as r,je as s,D as t};
