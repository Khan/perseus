var y=Object.defineProperty;var C=(l,n,e)=>n in l?y(l,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[n]=e;var i=(l,n,e)=>(C(l,typeof n!="symbol"?n+"":n,e),e);import{j as t}from"./jsx-runtime-BT65X5dW.js";import"./index-default-BcKQpA1a.js";import"./index-DktHmiAd.js";import{l as k,U as v}from"./util-Cnd0Ukpp.js";import"./all-widgets-DlCGj7Au.js";import"./index-DyG-XbLr.js";import"./answer-choices-CAW9m8Dd.js";import"./index-gdjMQqRz.js";import{r as w}from"./index-C6mWTJJr.js";import"./index-B1Gws05u.js";import"./i18n-context-bNNtSo4z.js";import"./perseus-api-fTM3z0tF.js";import"./renderer-DTCW_hQD.js";import"./free-response-3RgbzuUw.js";import"./index-D7h-teXI.js";import"./jquery-CkHB0_Mt.js";import"./dependencies-BsVPGK1s.js";import"./zoomable-tex-Dy-nElJT.js";import"./svg-image-BmyLAfxC.js";import{n as h}from"./no-important-DlFk8a1I.js";import"./number-input-BoFWJhlc.js";import"./simple-keypad-input-Bl9QRvgR.js";import"./text-input-BdlNOW-6.js";import"./phet-simulation-7JtZXm76.js";import"./sortable-CkMd-CCl.js";import"./fixed-to-responsive-CTsII9Xx.js";import"./math-input-CxF14fD4.js";import"./video-transcript-link-BXfguhTw.js";import"./item-version-Bqt3bFnq.js";import"./article-renderer-DtD8ix-_.js";import"./server-item-renderer-bJ-x7ddr.js";import"./hints-renderer-CV1Czsbv.js";import"./base-radio-DRQ5uYqC.js";import"./button-group-B24xCvY2.js";import"./hud-CP_ly967.js";import"./icon-BfyZ3piz.js";import"./index-DsINhqRJ.js";import"./inline-icon-AJRwMA4Z.js";import"./multi-button-group-U6RQwTwG.js";import"./range-input-Bq0Yp9zp.js";import"./text-list-editor-C2gddtxS.js";import"./index-Dd-cahjY.js";import{E as A}from"./editor-jsonify-DD0QwNnk.js";import{F as x}from"./form-wrapped-text-field-BuQUfMLC.js";import{A as b}from"./answer-choices-BE1gLduP.js";import{B as I}from"./behavior-Bt1RsMja.js";import{Q as q}from"./question-markers-BJ7JZT_s.js";import{S}from"./select-image-DXr5uP0_.js";class c extends w.Component{constructor(){super(...arguments);i(this,"_questionMarkers");i(this,"getSaveWarnings",()=>{const{choices:e,imageAlt:o,imageUrl:s,markers:a}=this.props,r=[];if(e.length<2&&r.push("Question requires at least two answer choices"),s?o||r.push("Question image has no alt text"):r.push("Image is not specified for question"),!a.length)r.push("Question has no markers, to label answers on image");else{let m=0,p=0;for(const d of a)d.answers.length||m++,d.label||p++;m&&r.push(`Question has ${m} markers with no answers selected`),p&&r.push(`Question has ${p} markers with no ARIA label`)}return r});i(this,"handleImageChange",e=>{this.props.onChange({imageUrl:e,imageWidth:0,imageHeight:0}),e&&v.getImageSize(e,(o,s)=>{this.props.onChange({imageUrl:e,imageWidth:o,imageHeight:s})})});i(this,"handleAltChange",e=>{this.props.onChange({imageAlt:e})});i(this,"handleChoicesChange",e=>{this.props.onChange({choices:e})});i(this,"handleMarkersChange",e=>{this.props.onChange({markers:e})});i(this,"handleBehaviorChange",e=>{this.props.onChange(e)})}componentDidUpdate(e){const o={};e.markers.forEach(a=>o[`${a.x}.${a.y}`]=a);const s=this.props.markers.map((a,r)=>o.hasOwnProperty(`${a.x}.${a.y}`)?-1:r).filter(a=>a!==-1);s.length&&this._questionMarkers&&this._questionMarkers.openDropdownForMarkerIndices(s)}serialize(){return A.serialize.call(this)}render(){const{choices:e,imageAlt:o,imageUrl:s,imageWidth:a,imageHeight:r,markers:m,multipleAnswers:p,hideChoicesFromInstructions:d}=this.props,f=s&&a>0&&r>0;return t.jsxs("div",{children:[t.jsx(S,{onChange:this.handleImageChange,url:s}),t.jsx("div",{className:h.css(u.smallSpacer)}),f&&t.jsx(x,{placeholder:"Alt text (for screen readers)",onChange:g=>this.handleAltChange(g.target.value),value:o,width:"100%"}),t.jsx("div",{className:h.css(u.largeSpacer)}),t.jsx(q,{choices:e,imageUrl:f?s:"",imageWidth:a,imageHeight:r,markers:m,onChange:this.handleMarkersChange,ref:g=>this._questionMarkers=g}),t.jsx("div",{className:h.css(u.largeSpacer)}),t.jsx(b,{choices:e,onChange:this.handleChoicesChange}),t.jsx("div",{className:h.css(u.largeSpacer)}),t.jsx(I,{multipleAnswers:p,hideChoicesFromInstructions:d,onChange:this.handleBehaviorChange})]})}}i(c,"defaultProps",k.defaultWidgetOptions),i(c,"widgetName","label-image");const u=h.StyleSheet.create({largeSpacer:{height:32},smallSpacer:{height:16}});c.__docgenInfo={description:"",methods:[{name:"getSaveWarnings",docblock:null,modifiers:[],params:[],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:{type:{name:"any"}}},{name:"handleImageChange",docblock:null,modifiers:[],params:[{name:"url",optional:!1,type:{name:"string"}}],returns:null},{name:"handleAltChange",docblock:null,modifiers:[],params:[{name:"alt",optional:!1,type:{name:"string"}}],returns:null},{name:"handleChoicesChange",docblock:null,modifiers:[],params:[{name:"choices",optional:!1,type:{name:"ReadonlyArray",elements:[{name:"string"}],raw:"ReadonlyArray<string>",alias:"ReadonlyArray"}}],returns:null},{name:"handleMarkersChange",docblock:null,modifiers:[],params:[{name:"markers",optional:!1,type:{name:"Array",raw:'PerseusLabelImageWidgetOptions["markers"]'}}],returns:null},{name:"handleBehaviorChange",docblock:null,modifiers:[],params:[{name:"options",optional:!1,type:{name:"any"}}],returns:null}],displayName:"LabelImageEditor",props:{choices:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:"",defaultValue:{value:"[]",computed:!1}},imageAlt:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'""',computed:!1}},imageUrl:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'""',computed:!1}},imageWidth:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},imageHeight:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},markers:{required:!1,tsType:{name:"Array",raw:'PerseusLabelImageWidgetOptions["markers"]'},description:"",defaultValue:{value:"[]",computed:!1}},multipleAnswers:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},hideChoicesFromInstructions:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(options: any) => void",signature:{arguments:[{type:{name:"any"},name:"options"}],return:{name:"void"}}},description:""}}};export{c as L};
