import{a as F}from"./version-akiLXZts.js";import"./article-editor-y54nHJOl.js";import"./device-framer-eGajQcXC.js";import"./viewport-resizer-NtCpeyhM.js";import{j as t,a as p}from"./jsx-runtime-FVsy8kgq.js";import{P as d}from"./index-0C4KXdeC.js";import{r as y}from"./index-TT1qJ6UJ.js";import{_ as I}from"./jquery-yG1GhClm.js";import{R as S,W as U}from"./structured-item-diff-ymtwX0Jp.js";import{H as J}from"./editor-page-LnmUV-k-.js";import{E as W}from"./editor-zP-Z384Z.js";import{w as $}from"./article-renderer-IXeFV2sm.js";import"./util-AYeX86gl.js";import"./phet-simulation-XVZsZpMv.js";import{b as G,r as Q,a as Y,c as Z}from"./renderer-iggp3GU1.js";import{A as K}from"./perseus-api-Nq3s7IMx.js";import{l as u,g as X,e as ee}from"./perseus-item-r0HxAp0G.js";import"./hints-renderer-mV4P0nzg.js";import"./base-radio-aSIz26Ah.js";import"./button-group-nsoLlHtM.js";import"./graph-A-Orr3_L.js";import"./svg-image-B1YVHqDk.js";import"./hud-4BOtaFc1.js";import"./icon-R5gZamfG.js";import"./index-uzeeKkRr.js";import"./inline-icon-NjJlm7d0.js";import"./math-input-4aOWKB1C.js";import"./multi-button-group-lyC3Gj71.js";import"./number-input-918q6vbb.js";import"./range-input-r59AwuX_.js";import"./text-input-IrI3y5Kr.js";import"./text-list-editor-Jz35fIN1.js";import"./dependencies-d8cZibFS.js";import"./index-k-0mNqHS.js";import"./i18n-context-_nSLXFpk.js";import"./index-xs9l8-Af.js";import{J as te,A as re}from"./register-all-widgets-and-editors-for-testing-Qi6Tgml6.js";import{c as ne}from"./components-NB-NCNDt.js";import{c as H,i as se}from"./icon-paths-5JCXzGsq.js";import{M as oe}from"./multi-items-Zfb3kALo.js";import{l as a}from"./index-awljIyHI.js";import{R as ae}from"./index-7vsPyIck.js";/* empty css                       */const ie="@khanacademy/perseus-editor",le="__lib_version__";F(ie,le);const k=d.shape({content:d.string,images:d.objectOf(d.any),widgets:d.objectOf(d.any)}),v=class v extends y.Component{constructor(){super(...arguments),this.state=v._stateFromProps(this.props)}UNSAFE_componentWillReceiveProps(e){this.setState(v._stateFromProps(e))}render(){const{before:e,after:r}=this.state,n=Math.max(e.length,r.length),o=I.times(n,l=>t(S,{before:l<e.length?e[l]:void 0,after:l<r.length?r[l]:void 0,title:`Section ${l+1}`,showAlignmentOptions:!0,showSeparator:l<n-1},l));return t("div",{className:"framework-perseus",children:o})}};v.propTypes={after:d.oneOfType([k,d.arrayOf(k)]).isRequired,before:d.oneOfType([k,d.arrayOf(k)]).isRequired},v._stateFromProps=e=>{const{before:r,after:n}=e;return{before:Array.isArray(r)?r:[r],after:Array.isArray(n)?n:[n]}};let T=v;T.__docgenInfo={description:"",methods:[{name:"_stateFromProps",docblock:null,modifiers:["static"],params:[{name:"props",optional:!1,type:null}],returns:null}],displayName:"ArticleDiff",props:{after:{description:"",type:{name:"union",value:[{name:"custom",raw:"rendererProps"},{name:"arrayOf",value:{name:"custom",raw:"rendererProps"}}]},required:!0},before:{description:"",type:{name:"union",value:[{name:"custom",raw:"rendererProps"},{name:"arrayOf",value:{name:"custom",raw:"rendererProps"}}]},required:!0}}};const q=d.shape({question:d.shape({}).isRequired,answerArea:d.shape({}).isRequired,hints:d.arrayOf(d.any).isRequired}),O=class O extends y.Component{render(){const{before:e,after:r}=this.props,n=Math.max(e.hints.length,r.hints.length),o=t(S,{before:e.question,after:r.question,title:"Question",showAlignmentOptions:!1,showSeparator:!0}),l=t(U,{before:e.answerArea,after:r.answerArea,title:"Question extras"}),c=I.times(n,function(m){return t(S,{before:m<e.hints.length?e.hints[m]:void 0,after:m<r.hints.length?r.hints[m]:void 0,title:`Hint ${m+1}`,showAlignmentOptions:!1,showSeparator:m<n-1},m)});return p("div",{className:"framework-perseus",children:[o,l,c&&t("div",{className:"diff-separator"}),c]})}};O.propTypes={after:q.isRequired,before:q.isRequired};let M=O;M.__docgenInfo={description:"",methods:[],displayName:"ItemDiff",props:{after:{description:"",type:{name:"custom",raw:"itemProps.isRequired"},required:!1},before:{description:"",type:{name:"custom",raw:"itemProps.isRequired"},required:!1}}};const x=class x extends y.Component{render(){const{children:e,color:r,onClick:n,...o}=this.props;return t("div",{className:a.css(P.baseButton,r==="green"&&P.green,r==="orange"&&P.orange),onClick:n,...o,children:e})}};x.propTypes={children:d.node,color:d.oneOf(["orange","green"]),onClick:d.func},x.defaultProps={children:null,color:"green",onClick:()=>{}};let w=x;const P=a.StyleSheet.create({baseButton:{top:"0",fontSize:"11px",padding:"3px 10px",backgroundRepeat:"repeat-x",borderColor:`
             rgba(0, 0, 0, 0.1)
             rgba(0, 0, 0, 0.1)
             rgba(0, 0, 0, 0.25)
         `,color:"#ffffff",borderRadius:"3px",lineHeight:"15px",cursor:"pointer",transition:"box-shadow ease-in-out 0.15s",appearance:"none",textDecoration:"none",textAlign:"center",":hover":{boxShadow:`0 1px 1px rgba(0, 0, 0, 0.35),
                 inset 0 0 50px 5px rgba(255, 255, 255, 0.2)`}},green:{border:"1px solid #7fab07",backgroundColor:"#80ac07",backgroundImage:"linear-gradient(to bottom, #8aba08, #719807)",":hover":{borderBottomColor:"#547105",backgroundColor:"#719807"}},orange:{border:"1px solid #d45704",backgroundColor:"#d55704",backgroundImage:"linear-gradient(to bottom, #e35d04, #c04f03)",":hover":{borderBottomColor:"#983e03",backgroundColor:"#c04f03"}}});w.__docgenInfo={description:"",methods:[],displayName:"SimpleButton",props:{children:{defaultValue:{value:"null",computed:!1},description:"",type:{name:"node"},required:!1},color:{defaultValue:{value:'"green"',computed:!1},description:"",type:{name:"enum",value:[{value:'"orange"',computed:!1},{value:'"green"',computed:!1}]},required:!1},onClick:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1}}};const{InlineIcon:R}=ne,{MultiRenderer:ce}=oe;class A extends y.Component{constructor(){super(...arguments),this._handleSelectMode=e=>{if(this.props.onChange){const r=e.target.value;this.props.onChange(r)}}}render(){return p("label",{children:["Mode:"," ",p("select",{value:this.props.currentMode,onChange:this._handleSelectMode,children:[t("option",{value:"edit",children:"Edit"}),t("option",{value:"preview",children:"Preview"}),t("option",{value:"json",children:"Dev-only JSON"})]})]})}}function j(i){return i.replace(/[A-Z]/g,e=>" "+e.toLowerCase())}function E(i){return i.charAt(0).toUpperCase()+i.slice(1).toLowerCase()}function D(i){return i.charAt(i.length-1)==="s"?i.slice(0,-1):i}function f(i){return["_multi",...i]}const _=({depth:i,...e})=>{const n=`h${Math.min(i,5)+1}`;return t(n,{...e})},L=i=>{const{shape:e,data:r,path:n,actions:o,name:l,controls:c,...m}=i,h=l||j(n[n.length-1]||""),b=t(he,{...m,shape:e,data:r,path:n,actions:o}),C=n.join(".");return e.type==="array"?t(pe,{name:h,controls:c,path:n,shape:e,actions:o,children:b},C):e.type==="object"?t(me,{name:h,controls:c,path:n,children:b},C):t(de,{name:h,controls:c,path:n,shape:e,children:b},C)},de=({name:i,controls:e,children:r,path:n,shape:o})=>{const c=(o.type==="content"||o.type==="hint")&&t("div",{className:a.css(s.containerHeader),children:t(_,{depth:n.length,className:a.css(s.containerTitle),children:E(i)})});return p("div",{className:a.css(s.container),children:[p("span",{className:a.css(s.row,s.rowHeading),children:[t("div",{className:a.css(s.columnLeft),children:p("div",{className:"pod-title "+a.css(s.containerHeader),children:[t("div",{className:a.css(s.containerTitle),children:E(i)}),e]})}),t("div",{className:a.css(s.columnRight),children:c})]}),r]})},pe=i=>{const{name:e,controls:r,children:n,path:o,shape:l,actions:c}=i;return p("div",{className:a.css(s.container),children:[r&&t("div",{className:a.css(s.columnLeft,s.containerHeader),children:r}),t("div",{children:n}),t("div",{className:a.css(s.columnLeft),children:p("a",{href:"javascript:void 0",onClick:()=>c.addArrayElement(o,l.elementShape),children:["Add a ",D(e)]})})]})},me=({name:i,controls:e,children:r,path:n})=>{const o=p("div",{className:a.css(s.containerHeader),children:[t(_,{depth:n.length,className:a.css(s.containerTitle),children:E(i)}),e]}),l=(i||e)&&t("div",{className:a.css(s.containerHeader,s.previewCollectionHeader),children:t(_,{depth:n.length,className:a.css(s.containerTitle),children:E(i)})}),c=o&&l;return p("div",{className:a.css(s.container),children:[c&&p("span",{className:a.css(s.row),children:[t("div",{className:a.css(s.columnLeft),children:o}),t("div",{className:a.css(s.columnRight),children:l})]}),t("div",{className:a.css(n.length>0&&s.contentIndent),children:r})]})},he=i=>{const{shape:e,data:r,...n}=i;return e.type==="content"?t(ue,{shape:e,data:r,...n}):e.type==="hint"?t(fe,{shape:e,data:r,...n}):e.type==="tags"?t(ye,{shape:e,data:r,...n}):e.type==="array"?t(ge,{shape:e,data:r,...n}):e.type==="object"?t(ve,{shape:e,data:r,...n}):null},V=i=>class extends y.Component{constructor(){super(...arguments),this.state={sticky:!1},this.updateStickiness=()=>{const n=ae.findDOMNode(this).offsetHeight,o=window.innerHeight,l=n>o;l!==this.state.sticky&&this.setState({sticky:l})}}componentDidMount(){this.stickynessTimer=setInterval(this.updateStickiness,1e3),this.updateStickiness()}componentWillUnmount(){clearInterval(this.stickynessTimer)}render(){return t(i,{...this.props,sticky:this.state.sticky})}},ue=V(i=>{const{data:e,path:r,actions:n,apiOptions:o,renderers:l,sticky:c}=i,m=t("div",{className:"framework-perseus",children:u(l).get(r)});return t("span",{children:p("div",{className:a.css(s.row),children:[t("div",{className:a.css(s.columnLeft),children:t("div",{className:a.css(c&&s.sticky),children:t(W,{...e,onChange:h=>n.mergeValueAtPath(r,h),apiOptions:o})})}),t("div",{className:a.css(s.columnRight),children:t("div",{className:a.css(c&&s.sticky),children:m})})]})})}),fe=V(i=>{const{data:e,path:r,actions:n,apiOptions:o,renderers:l,sticky:c}=i,m=t("div",{className:"framework-perseus",children:u(l).get(r)});return p("div",{className:a.css(s.row),children:[t("div",{className:a.css(s.columnLeft),children:t("div",{className:a.css(c&&s.sticky),children:t(J,{...e,className:a.css(s.hintEditor),onChange:h=>n.mergeValueAtPath(r,h),apiOptions:o,showTitle:!1,showRemoveButton:!1,showMoveButtons:!1,onRemove:()=>{},onMove:h=>{},isFirst:!0,isLast:!0})})}),t("div",{className:a.css(s.columnRight),children:t("div",{className:a.css(c&&s.sticky),children:m})})]})}),ye=i=>{const{data:e,path:r,actions:n,apiOptions:o}=i,{GroupMetadataEditor:l}=o;return l==null?null:t("div",{className:a.css(s.columnLeft),children:t("div",{className:a.css(s.tagsEditor),children:t(l,{value:e,onChange:c=>n.setValueAtPath(r,c),showTitle:!1})})})},ge=i=>{const{shape:e,data:r,path:n,actions:o,...l}=i,c=j(n[n.length-1]),m=D(c),h=e.elementShape.type,b=h==="content"||h==="hint",C=r.map((z,g)=>{const N=n.concat(g),B=[g>0&&t("div",{className:a.css(s.control),children:t(w,{color:"orange",title:"Move up",onClick:()=>o.moveArrayElementUp(N),children:t("div",{className:a.css(s.verticalFlip),children:t(R,{...H})})})},"moveArrayElementUp"),g<r.length-1&&t("div",{className:a.css(s.control),children:t(w,{color:"orange",title:"Move down",onClick:()=>o.moveArrayElementDown(N),children:t(R,{...H})})},"moveArrayElementDown"),t("div",{className:a.css(s.control),children:t(w,{color:"orange",title:"Delete",onClick:()=>o.removeArrayElement(N),children:t(R,{...se})})},"removeArrayElement")];return t("div",{className:a.css(s.arrayElement,!b&&s.arrayElementAndNotLeaf),children:y.createElement(L,{...l,key:g,shape:e.elementShape,data:z,path:N,actions:o,name:`${m} ${g+1}`,controls:B})},g)});return t("div",{children:C})},ve=i=>{const{shape:e,data:r,path:n,...o}=i,l=Object.keys(e.shape).map(c=>t("div",{className:a.css(s.objectElement),children:t(L,{...o,shape:e.shape[c],data:r[c],path:n.concat(c)})},c));return t("div",{children:l})};class we extends y.Component{constructor(){super(...arguments),this._renderLayout=()=>{const{Layout:e,apiOptions:r,item:n}=this.props;return t(e,{ref:o=>this.layout=o,item:n,apiOptions:r})},this._renderJson=()=>p("div",{children:[t(A,{currentMode:this.props.editorMode,onChange:e=>this.props.onChange({editorMode:e})}),t(te,{multiLine:!0,value:this.props.item,onChange:e=>this.props.onChange({item:e})})]}),this._renderPreview=()=>p("div",{children:[t(A,{currentMode:this.props.editorMode,onChange:e=>this.props.onChange({editorMode:e})}),this._renderLayout()]}),this.mergeValueAtPath=(e,r)=>{this.props.onChange({item:u(this.props.item).merge(f(e),r).freeze()})},this.setValueAtPath=(e,r)=>{this.props.onChange({item:u(this.props.item).set(f(e),r).freeze()})},this.addArrayElement=(e,r)=>{const n=u(this.props.item).get(f(e)).length,o=e.concat(n),l=X(r);this.props.onChange({item:u(this.props.item).set(f(o),l).freeze()})},this.removeArrayElement=e=>{this.props.onChange({item:u(this.props.item).del(f(e)).freeze()})},this.moveArrayElementDown=e=>{const n=e[e.length-1]+1,o=e.slice(0,-1).concat(n),l=u(this.props.item).get(f(e)),c=u(this.props.item).get(f(o));this.props.onChange({item:u(this.props.item).set(f(e),c).set(f(o),l).freeze()})},this.moveArrayElementUp=e=>{const r=e[e.length-1],n=e.slice(0,-1).concat(r-1);this.moveArrayElementDown(n)},this._renderEdit=()=>{const e={...K.defaults,...this.props.apiOptions},{item:r}=this.props,n=this.props.Layout.shape;return p("div",{className:"perseus-multirenderer-editor",children:[t(A,{currentMode:this.props.editorMode,onChange:o=>this.props.onChange({editorMode:o})}),t(ce,{item:r,shape:n,apiOptions:e,dependencies:{analytics:{onAnalyticsEvent:async()=>{}},useVideo:()=>{}},children:({renderers:o})=>t(L,{shape:n,data:ee(r),path:[],actions:this,apiOptions:e,renderers:o})})]})},this.score=()=>{if(this.layout)return this.layout.score()},this.getSerializedState=()=>{if(this.layout)return this.layout.getSerializedState()},this.restoreSerializedState=e=>{this.layout&&this.layout.restoreSerializedState(e)},this._renderContent=()=>{switch(this.props.editorMode){case"json":return this._renderJson();case"preview":return this._renderPreview();case"edit":return this._renderEdit();default:return t(A,{currentMode:this.props.editorMode,onChange:e=>this.props.onChange({editorMode:e})})}}}render(){return t("div",{id:"perseus",children:this._renderContent()})}}const s=a.StyleSheet.create({container:{},editor:{width:"100%"},treePreview:{position:"relative"},verticalFlip:{transform:"scaleY(-1)"},control:{marginLeft:12},containerHeader:{alignItems:"flex-end",display:"flex",flexDirection:"row"},previewCollectionHeader:{marginBottom:16},containerTitle:{flexGrow:1,margin:0},contentIndent:{marginLeft:8},hintEditor:{paddingBottom:0},arrayElement:{marginBottom:16},arrayElementAndNotLeaf:{borderBottom:"1px solid #ccc",":first-child":{borderTop:"1px solid #ccc",paddingTop:16}},objectElement:{marginBottom:16},tagsEditor:{border:"1px solid #ddd",padding:"5px 10px"},row:{display:"flex",position:"relative"},columnLeft:{width:360,marginRight:30,position:"relative"},columnRight:{flex:1,marginLeft:30,position:"relative"},sticky:{position:"sticky",top:33},rowHeading:{position:"sticky",backgroundColor:"white",width:"100%",zIndex:101,top:-1}});we.__docgenInfo={description:"",methods:[{name:"_renderLayout",docblock:null,modifiers:[],params:[],returns:null},{name:"_renderJson",docblock:null,modifiers:[],params:[],returns:null},{name:"_renderPreview",docblock:null,modifiers:[],params:[],returns:null},{name:"mergeValueAtPath",docblock:null,modifiers:[],params:[{name:"path",optional:!1,type:{name:"ReadonlyArray",elements:[{name:"any"}],raw:"ReadonlyArray<any>",alias:"Path"}},{name:"newValue",optional:!1,type:{name:"unknown"}}],returns:null},{name:"setValueAtPath",docblock:null,modifiers:[],params:[{name:"path",optional:!1,type:{name:"ReadonlyArray",elements:[{name:"any"}],raw:"ReadonlyArray<any>",alias:"Path"}},{name:"newValue",optional:!1,type:{name:"unknown"}}],returns:null},{name:"addArrayElement",docblock:null,modifiers:[],params:[{name:"path",optional:!1,type:{name:"ReadonlyArray",elements:[{name:"any"}],raw:"ReadonlyArray<any>",alias:"Path"}},{name:"shape",optional:!1,type:{name:"Shape",alias:"Shape"}}],returns:null},{name:"removeArrayElement",docblock:null,modifiers:[],params:[{name:"path",optional:!1,type:{name:"ReadonlyArray",elements:[{name:"any"}],raw:"ReadonlyArray<any>",alias:"Path"}}],returns:null},{name:"moveArrayElementDown",docblock:null,modifiers:[],params:[{name:"path",optional:!1,type:{name:"ReadonlyArray",elements:[{name:"any"}],raw:"ReadonlyArray<any>",alias:"Path"}}],returns:null},{name:"moveArrayElementUp",docblock:null,modifiers:[],params:[{name:"path",optional:!1,type:{name:"ReadonlyArray",elements:[{name:"any"}],raw:"ReadonlyArray<any>",alias:"Path"}}],returns:null},{name:"_renderEdit",docblock:null,modifiers:[],params:[],returns:null},{name:"score",docblock:null,modifiers:[],params:[],returns:null},{name:"getSerializedState",docblock:null,modifiers:[],params:[],returns:null},{name:"restoreSerializedState",docblock:null,modifiers:[],params:[{name:"state",optional:!1,type:{name:"any"}}],returns:null},{name:"_renderContent",docblock:null,modifiers:[],params:[],returns:null}],displayName:"MultiRendererEditor",props:{Layout:{required:!0,tsType:{name:"intersection",raw:"React.ComponentType<any> & LayoutStatics",elements:[{name:"ReactComponentType",raw:"React.ComponentType<any>",elements:[{name:"any"}]},{name:"LayoutStatics"}]},description:""},apiOptions:{required:!0,tsType:{name:"APIOptions"},description:""},item:{required:!0,tsType:{name:"Item"},description:""},editorMode:{required:!0,tsType:{name:"EditorMode"},description:""},onChange:{required:!0,tsType:{name:"ChangeHandler"},description:""}}};G(re);Q($);Y();Z();
