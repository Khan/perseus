import{a,j as e}from"./jsx-runtime-5BUNAZ9W.js";import{c as E}from"./article-renderer-GKJYVJTw.js";import{_ as o}from"./jquery-yG1GhClm.js";import{U as F}from"./util-KY8kJaBW.js";import"./version-akiLXZts.js";import"./dependencies-9B_Bv_mA.js";import"./perseus-api-GqFoxb6z.js";import"./multi-renderer-u6abNxtx.js";import"./hints-renderer-iCAhrl75.js";import"./renderer-zs11neBD.js";import"./base-radio-LpW5mNw9.js";import{c as O}from"./components-4f87eP1B.js";import{I as D}from"./icon-paths-AuJwhOz7.js";import{P as I}from"./i18n-context-5R-kLn05.js";import{E as z}from"./editor-jsonify-P13H4HT_.js";import{C as y}from"./index-YQYcT5qz.js";import{r as P}from"./index-4g5l5LRQ.js";import{E as R}from"./editor-E4qHd37s.js";const{ButtonGroup:A,InfoTip:d,InlineIcon:N,MultiButtonGroup:M,NumberInput:v,TextInput:j}=O,{iconGear:U,iconTrash:V}=D,{firstNumericalParse:k}=F,W=[{title:"Integers",value:"integer",content:"6"},{title:"Decimals",value:"decimal",content:"0.75"},{title:"Proper fractions",value:"proper",content:"⅗"},{title:"Improper fractions",value:"improper",content:"⁷⁄₄"},{title:"Mixed numbers",value:"mixed",content:"1¾"},{title:"Numbers with π",value:"pi",content:"π"}],b=T=>({value:null,status:T,message:"",simplify:"required",answerForms:[],strict:!1,maxError:null}),m=class m extends P.Component{constructor(p){super(p),this.change=(...t)=>E.apply(this,t),this.onToggleOptions=t=>{const r=this.state.showOptions.slice();r[t]=!r[t],this.setState({showOptions:r})},this.onTrashAnswer=t=>{if(t>=0&&t<this.props.answers.length){const r=this.props.answers.slice(0);r.splice(t,1),this.props.onChange({answers:r})}},this.onSpace=(t,r,...l)=>{t.key===" "&&(t.preventDefault(),r.apply(this,l))},this.onStatusChange=t=>{const r=["wrong","ungraded","correct"],l=this.props.answers,c=o.indexOf(r,l[t].status),u=r[(c+1)%r.length];this.updateAnswer(t,{status:u,simplify:u==="correct"?"required":"accepted"})},this.updateAnswer=(t,r)=>{if(!o.isObject(r))return o.partial((c,u,w)=>{const h={};h[u]=w,this.updateAnswer(c,h)},t,r);let l=[...this.props.answers];if(t===l.length){const c=b(this.state.lastStatus);l=l.concat(c)}l[t]=o.extend({},l[t],r),this.props.onChange({answers:l})},this.addAnswer=()=>{const t=b(this.state.lastStatus),r=this.props.answers.concat(t);this.props.onChange({answers:r})},this.getSaveWarnings=()=>{const t=[];return o.contains(o.pluck(this.props.answers,"value"),"")&&t.push("One or more answers is empty"),this.props.answers.forEach((r,l)=>{r.strict&&(!r.answerForms||r.answerForms.length===0)&&t.push(`Answer ${l+1} is set to string format matching, but no format was selected`)}),t},this.serialize=()=>z.serialize.call(this),this.state={lastStatus:"wrong",showOptions:o.map(this.props.answers,()=>!1)}}render(){const p=this.props.answers,t=n=>a("div",{className:"perseus-widget-row",children:[e("label",{children:"Unsimplified answers are"}),e(A,{value:p[n].simplify,allowEmpty:!1,buttons:[{value:"required",content:"ungraded"},{value:"optional",content:"accepted"},{value:"enforced",content:"wrong"}],onChange:this.updateAnswer(n,"simplify")||(()=>{})}),a(d,{children:[e("p",{children:'Normally select "ungraded". This will give the user a message saying the answer is correct but not simplified. The user will then have to simplify it and re-enter, but will not be penalized. (5th grade and after)'}),e("p",{children:'Select "accepted" only if the user is not expected to know how to simplify fractions yet. (Anything prior to 5th grade)'}),a("p",{children:['Select "wrong" ',e("em",{children:"only"})," if we are specifically assessing the ability to simplify."]})]})]}),r=n=>a("div",{children:[a("div",{className:"perseus-widget-row",children:[e("label",{children:"Choose the suggested answer formats"}),e(M,{buttons:W,values:p[n].answerForms,onChange:this.updateAnswer(n,"answerForms")||(()=>{})}),a(d,{children:[e("p",{children:'Formats will be autoselected for you based on the given answer; to show no suggested formats and accept all types, simply have a decimal/integer be the answer. Values with π will have format "pi", and values that are fractions will have some subset (mixed will be "mixed" and "proper"; improper/proper will both be "improper" and "proper"). If you would like to specify that it is only a proper fraction (or only a mixed/improper fraction), deselect the other format. Except for specific cases, you should not need to change the autoselected formats.'}),a("p",{children:["To restrict the answer to ",e("em",{children:"only"}),' an improper fraction (i.e. 7/4), select the improper fraction and toggle "strict" to true. This ',e("b",{children:"will not"})," ","accept 1.75 as an answer."," "]}),e("p",{children:"Unless you are testing that specific skill, please do not restrict the answer format."})]})]}),e("div",{className:"perseus-widget-row",children:e(y,{label:"Strictly match only these formats",checked:p[n].strict,onChange:i=>{this.updateAnswer.bind(this,n)({strict:i})}})})]}),l=n=>e("div",{className:"perseus-widget-row",children:a("label",{children:["Max error"," ",e(v,{className:"max-error",value:p[n].maxError,onChange:this.updateAnswer(n,"maxError"),placeholder:"0"})]})}),c=a("div",{className:"perseus-widget-row",children:[e("label",{children:"Width: "}),e(A,{value:this.props.size,allowEmpty:!1,buttons:[{value:"normal",content:"Normal (80px)"},{value:"small",content:"Small (40px)"}],onChange:this.change("size")}),e(d,{children:e("p",{children:'Use size "Normal" for all text boxes, unless there are multiple text boxes in one line and the answer area is too narrow to fit them.'})})]}),u=e("div",{className:"perseus-widget-row",children:e(y,{label:"Right alignment",checked:this.props.rightAlign,onChange:n=>{this.props.onChange({rightAlign:n})}})}),w=a("div",{className:"perseus-widget-row",children:[a("label",{children:["Aria label",e(j,{value:this.props.labelText,onChange:this.change("labelText")})]}),e(d,{children:e("p",{children:"Text to describe this input. This will be shown to users using screenreaders."})})]}),h=e("div",{children:a("div",{className:"perseus-widget-row",children:[e(y,{label:"Coefficient",checked:this.props.coefficient,onChange:n=>{this.props.onChange({coefficient:n})}}),e(d,{children:e("p",{children:"A coefficient style number allows the student to use - for -1 and an empty string to mean 1."})})]})}),C=e("div",{children:e("a",{href:"#",className:"simple-button orange",onClick:n=>{n.preventDefault(),this.addAnswer()},onKeyDown:n=>this.onSpace(n,this.addAnswer),children:e("span",{children:"Add new answer"})})}),q={wrong:"(address the mistake/misconception)",ungraded:"(explain in detail to avoid confusion)",correct:"(reinforce the user's understanding)"};return a("div",{className:"perseus-input-number-editor",children:[e("div",{className:"ui-title",children:"User input"}),e("div",{className:"msg-title",children:"Message shown to user on attempt"}),p.map((n,i)=>{const S=e(R,{apiOptions:this.props.apiOptions,content:n.message||"",placeholder:"Why is this answer "+n.status+"?	"+q[n.status],widgetEnabled:!1,onChange:s=>{"content"in s&&this.updateAnswer(i,{message:s.content})}});return a("div",{className:"perseus-widget-row",children:[a("div",{className:"input-answer-editor-value-container"+(n.maxError?" with-max-error":""),children:[e(v,{value:n.value,className:"numeric-input-value",placeholder:"answer",format:o.last(n.answerForms||[]),onFormatChange:(s,f)=>{let g;f==="pi"?g=["pi"]:f==="mixed"?g=["proper","mixed"]:(f==="proper"||f==="improper")&&(g=["proper","improper"]),this.updateAnswer(i,{value:k(s,this.context.strings),answerForms:g})},onChange:s=>{this.updateAnswer(i,{value:k(s,this.context.strings)})}}),n.strict&&e("div",{className:"is-strict-indicator",title:"strictly equivalent to",children:"≡"}),n.simplify!=="required"&&n.status==="correct"&&e("div",{className:"simplify-indicator "+n.simplify,title:"accepts unsimplified answers",children:"‰"}),n.maxError?a("div",{className:"max-error-container",children:[e("div",{className:"max-error-plusmn",children:"±"}),e(v,{placeholder:0,value:p[i].maxError,format:o.last(n.answerForms||[]),onChange:this.updateAnswer(i,"maxError")})]}):null,e("div",{className:"value-divider"}),e("a",{href:"#",className:"answer-status "+n.status,onClick:s=>{s.preventDefault(),this.onStatusChange(i)},onKeyDown:s=>this.onSpace(s,this.onStatusChange),children:n.status}),e("a",{href:"#",className:"answer-trash","aria-label":"Delete answer",onClick:s=>{s.preventDefault(),this.onTrashAnswer(i)},onKeyDown:s=>this.onSpace(s,this.onTrashAnswer),children:e(N,{...V})}),e("a",{href:"#",className:"options-toggle","aria-label":"Toggle options",onClick:s=>{s.preventDefault(),this.onToggleOptions(i)},onKeyDown:s=>this.onSpace(s,this.onToggleOptions),children:e(N,{...U})})]}),e("div",{className:"input-answer-editor-message",children:S}),this.state.showOptions[i]&&a("div",{className:"options-container",children:[l(i),n.status==="correct"&&t(i),r(i)]})]},i)}),C,c,u,h,w]})}};m.contextType=I,m.widgetName="numeric-input",m.displayName="NumericInputEditor",m.defaultProps={answers:[b("correct")],size:"normal",coefficient:!1,labelText:"",rightAlign:!1};let x=m;x.__docgenInfo={description:"",methods:[{name:"change",docblock:null,modifiers:[],params:[{name:"...args",optional:!1,type:null}],returns:null},{name:"onToggleOptions",docblock:null,modifiers:[],params:[{name:"choiceIndex",optional:!1,type:null}],returns:null},{name:"onTrashAnswer",docblock:null,modifiers:[],params:[{name:"choiceIndex",optional:!1,type:null}],returns:null},{name:"onSpace",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:null},{name:"callback",optional:!1,type:null},{name:"...args",optional:!1,type:null}],returns:null},{name:"onStatusChange",docblock:null,modifiers:[],params:[{name:"choiceIndex",optional:!1,type:null}],returns:null},{name:"updateAnswer",docblock:null,modifiers:[],params:[{name:"choiceIndex",optional:!1,type:null},{name:"update",optional:!1,type:null}],returns:null},{name:"addAnswer",docblock:null,modifiers:[],params:[],returns:null},{name:"getSaveWarnings",docblock:null,modifiers:[],params:[],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:null}],displayName:"NumericInputEditor",props:{answers:{required:!1,tsType:{name:"ReadonlyArray",elements:[{name:"signature",type:"object",raw:`{
    message: string;
    value: number;
    status: string;
    answerForms?: ReadonlyArray<MathFormat>;
    strict: boolean;
    maxError: number | null | undefined;
    simplify: string | null | undefined;
}`,signature:{properties:[{key:"message",value:{name:"string",required:!0}},{key:"value",value:{name:"number",required:!0}},{key:"status",value:{name:"string",required:!0}},{key:"answerForms",value:{name:"ReadonlyArray",elements:[{name:"union",raw:`| "integer"
| "mixed"
| "improper"
| "proper"
| "decimal"
| "percent"
| "pi"`,elements:[{name:"literal",value:'"integer"'},{name:"literal",value:'"mixed"'},{name:"literal",value:'"improper"'},{name:"literal",value:'"proper"'},{name:"literal",value:'"decimal"'},{name:"literal",value:'"percent"'},{name:"literal",value:'"pi"'}]}],raw:"ReadonlyArray<MathFormat>",required:!1}},{key:"strict",value:{name:"boolean",required:!0}},{key:"maxError",value:{name:"union",raw:"number | null | undefined",elements:[{name:"number"},{name:"null"},{name:"undefined"}],required:!0}},{key:"simplify",value:{name:"union",raw:"string | null | undefined",elements:[{name:"string"},{name:"null"},{name:"undefined"}],required:!0}}]}}],raw:"ReadonlyArray<PerseusNumericInputAnswer>"},description:"",defaultValue:{value:'[initAnswer("correct")]',computed:!1}},labelText:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'""',computed:!1}},size:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'"normal"',computed:!1}},coefficient:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},rightAlign:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},static:{required:!1,tsType:{name:"boolean"},description:""},answerForms:{required:!1,tsType:{name:"ReadonlyArray",elements:[{name:"signature",type:"object",raw:`{
    simplify:
        | "required"
        | "correct"
        | "enforced"
        | "optional"
        | null
        | undefined;
    name: MathFormat;
}`,signature:{properties:[{key:"simplify",value:{name:"union",raw:`| "required"
| "correct"
| "enforced"
| "optional"
| null
| undefined`,elements:[{name:"literal",value:'"required"'},{name:"literal",value:'"correct"'},{name:"literal",value:'"enforced"'},{name:"literal",value:'"optional"'},{name:"null"},{name:"undefined"}],required:!0}},{key:"name",value:{name:"union",raw:`| "integer"
| "mixed"
| "improper"
| "proper"
| "decimal"
| "percent"
| "pi"`,elements:[{name:"literal",value:'"integer"'},{name:"literal",value:'"mixed"'},{name:"literal",value:'"improper"'},{name:"literal",value:'"proper"'},{name:"literal",value:'"decimal"'},{name:"literal",value:'"percent"'},{name:"literal",value:'"pi"'}],required:!0}}]}}],raw:"ReadonlyArray<PerseusNumericInputAnswerForm>"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(results: any) => any",signature:{arguments:[{type:{name:"any"},name:"results"}],return:{name:"any"}}},description:""},apiOptions:{required:!1,tsType:{name:"APIOptionsWithDefaults"},description:""}}};export{x as N};
