var G=Object.defineProperty;var J=(i,s,e)=>s in i?G(i,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[s]=e;var l=(i,s,e)=>(J(i,typeof s!="symbol"?s+"":s,e),e);import{D as L,_ as c,r as h,E as t,F as x,j as n,J as Q,Q as $,U as B,W as X,X as Y,Y as Z,Z as z}from"./iframe-FixlUAlH.js";import"./article-editor-MoX13GdD.js";import"./device-framer-CaeBzHwb.js";import"./viewport-resizer-CiapJrkH.js";import"./item-version-ZIBcJGu4.js";import"./article-renderer-CUboaJ7C.js";import"./server-item-renderer-Q94llRYT.js";import"./hints-renderer-DwEQF4ur.js";import{T as ee}from"./text-diff-nMhp62UD.js";import{c as se}from"./components-ON4HqAvU.js";import"./editor-page-B1zDLQIn.js";import"./editor-BmhKPkfE.js";import{A as te}from"./register-all-widgets-and-editors-for-testing-C6lYd7hx.js";import"./content-preview-DHMD8oZ-.js";/* empty css                       */const re="@khanacademy/perseus-editor",ne="__lib_version__";L(re,ne);const O="unchanged",V="changed",F="added",W="removed",ie=function(i,s,e){let r;return i===s?r=O:i===void 0?r=F:s===void 0?r=W:r=V,{after:JSON.stringify(s),before:JSON.stringify(i),children:[],key:e,status:r}},ae=function(i,s,e){const r=c.isObject(i)?c(i).keys():[],a=c.isObject(s)?c(s).keys():[],p=c.union(r,a),o=c.map(p,function(f){return I((i||{})[f],(s||{})[f],f)});let d;return i===void 0?d=F:s===void 0?d=W:d=c.any(o,function(u){return u.status!==O})?V:O,{after:"",before:"",children:o,key:e,status:d}},I=function(i,s,e){return typeof i=="object"||typeof s=="object"?ae(i,s,e):ie(i,s,e)},{SvgImage:D}=se,H=function(i){return(i-1)*20},N="before",R="after",oe="unchanged";class P extends h.Component{render(){const s=x(this.props.className,{"diff-row":!0,before:this.props.side===N,after:this.props.side===R});return n.jsx("div",{className:s,children:n.jsxs("div",{style:{paddingLeft:H(this.props.depth)},children:[this.props.showKey&&this.props.propKey+": ",n.jsx("span",{className:"inner-value dark "+this.props.className,children:this.props.value})]})})}}l(P,"propTypes",{className:t.string.isRequired,depth:t.number.isRequired,propKey:t.string.isRequired,showKey:t.bool.isRequired,side:t.oneOf([N,R]).isRequired,value:t.string});class k extends h.Component{render(){const s=this;return n.jsx("div",{onClick:s.props.onClick,style:{clear:"both"},children:c.map([N,R],function(e){return n.jsx("div",{className:"diff-row collapsed "+e,children:n.jsx("div",{style:{paddingLeft:H(s.props.depth)},children:n.jsx("span",{children:" [ show unmodified ] "})})},e)})})}}l(k,"propTypes",{depth:t.number,onClick:t.func.isRequired}),l(k,"defaultProps",{depth:0});const v=class v extends h.Component{constructor(){super(...arguments);l(this,"state",{expanded:this.props.expanded});l(this,"expand",()=>{this.setState({expanded:!0})})}render(){const e=this.props.entry,r=e.status==="removed",a=e.status==="added",p=e.status==="changed",o=e.children.length>0,d=x({removed:r||p&&!o,dark:r,"blank-space":a}),f=x({added:a||p&&!o,dark:a,"blank-space":r});let u;this.state.expanded?u=e.children:u=c(e.children).select(function(y){return y.status!==oe});let g=u.length<e.children.length;e.children.length===u.length+1&&(u=e.children,g=!1);const m=this;return n.jsxs("div",{children:[e.key&&n.jsxs("div",{style:{clear:"both"},children:[n.jsx(P,{side:N,className:d,depth:this.props.depth,propKey:e.key,showKey:!a,value:e.before}),n.jsx(P,{side:R,className:f,depth:this.props.depth,propKey:e.key,showKey:!r,value:e.after})]}),c.map(u,function(y){return n.jsx(v,{depth:m.props.depth+1,entry:y,expanded:m.state.expanded},y.key)}),g&&n.jsx(k,{depth:this.props.depth+1,onClick:this.expand})]})}};l(v,"propTypes",{depth:t.number,entry:t.shape({after:t.string,before:t.string,children:t.arrayOf(t.any),key:t.string}),expanded:t.bool}),l(v,"defaultProps",{depth:0});let A=v;class M extends h.Component{render(){const{before:s,after:e}=this.props,r=s.options&&s.options.backgroundImage?s.options.backgroundImage.url:"",a=e.options&&e.options.backgroundImage?e.options.backgroundImage.url:"";return n.jsxs("div",{children:[n.jsx("div",{className:"diff-row before",children:r&&n.jsx("div",{className:x({image:!0,"image-unchanged":r===a,"image-removed":r!==a}),children:n.jsx(D,{src:r,title:r})})}),n.jsx("div",{className:"diff-row after",children:a&&n.jsx("div",{className:x({image:!0,"image-unchanged":r===a,"image-added":r!==a}),children:n.jsx(D,{src:a,title:a})})})]})}}l(M,"propTypes",{after:t.shape({options:t.objectOf(t.any)}).isRequired,before:t.shape({options:t.objectOf(t.any)}).isRequired});class w extends h.Component{render(){const{after:s,before:e,title:r,type:a}=this.props,p=I(e,s);return n.jsxs("div",{children:[n.jsx("div",{className:"diff-header",children:r}),n.jsx("div",{className:"diff-header",children:r}),n.jsxs("div",{className:"diff-body ui-helper-clearfix",children:[a==="image"&&n.jsx(M,{before:e,after:s}),n.jsx(A,{entry:p})]})]})}}l(w,"propTypes",{after:t.shape({options:t.objectOf(t.any)}),before:t.shape({options:t.objectOf(t.any)}),title:t.string.isRequired,type:t.string}),l(w,"defaultProps",{after:{},before:{},type:""});w.__docgenInfo={description:"",methods:[],displayName:"WidgetDiff",props:{after:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"shape",value:{options:{name:"objectOf",value:{name:"any"},required:!1}}},required:!1},before:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"shape",value:{options:{name:"objectOf",value:{name:"any"},required:!1}}},required:!1},type:{defaultValue:{value:'""',computed:!1},description:"",type:{name:"string"},required:!1},title:{description:"",type:{name:"string"},required:!0}}};const _=function(i,s){const{alignment:e,graded:r,options:a,type:p}=i||{},o={options:a};return s&&Q(p).length>1&&(o.alignment=e),p==="transformer"&&(o.graded=r),$(p)&&(o.static=(i==null?void 0:i.static)??void 0),o};class j extends h.Component{render(){const{after:s,before:e,showAlignmentOptions:r,showSeparator:a,title:p}=this.props;let o,d;(e.content||s.content)&&(o=n.jsx(ee,{before:e.content,after:s.content,title:p}));const f=Object.keys(e.widgets??{}).filter(g=>e.content.includes(g)),u=Object.keys(s.widgets??{}).filter(g=>s.content.includes(g));return(f.length||u.length)&&(d=c.union(f,u).map(m=>{var y,T,E,S;return n.jsx(w,{before:_((y=e.widgets)==null?void 0:y[m],r),after:_((T=s.widgets)==null?void 0:T[m],r),title:m,type:(((E=e.widgets)==null?void 0:E[m])??{}).type||(((S=s.widgets)==null?void 0:S[m])??{}).type},m)})),n.jsxs("div",{children:[o,d,a&&n.jsx("div",{className:"diff-separator"})]})}}l(j,"defaultProps",{after:{content:"",images:{},widgets:{}},before:{content:"",images:{},widgets:{}},showAlignmentOptions:!1,showSeparator:!1});j.__docgenInfo={description:"",methods:[],displayName:"RendererDiff",props:{after:{required:!1,tsType:{name:"signature",type:"object",raw:`{
    content: string;
    // NOTE: images and widgets may not be set for some items hints,
    // specifically in old revisions, which may only be loaded for diffing.
    widgets: PerseusRenderer["widgets"] | null | undefined;
    images: PerseusRenderer["images"] | null | undefined;
}`,signature:{properties:[{key:"content",value:{name:"string",required:!0}},{key:"widgets",value:{name:"union",raw:'PerseusRenderer["widgets"] | null | undefined',elements:[{name:"signature",raw:'PerseusRenderer["widgets"]'},{name:"null"},{name:"undefined"}],required:!0}},{key:"images",value:{name:"union",raw:'PerseusRenderer["images"] | null | undefined',elements:[{name:"signature",raw:'PerseusRenderer["images"]'},{name:"null"},{name:"undefined"}],required:!0}}]}},description:"",defaultValue:{value:`{
    content: "",
    images: {},
    widgets: {},
}`,computed:!1}},before:{required:!1,tsType:{name:"signature",type:"object",raw:`{
    content: string;
    // NOTE: images and widgets may not be set for some items hints,
    // specifically in old revisions, which may only be loaded for diffing.
    widgets: PerseusRenderer["widgets"] | null | undefined;
    images: PerseusRenderer["images"] | null | undefined;
}`,signature:{properties:[{key:"content",value:{name:"string",required:!0}},{key:"widgets",value:{name:"union",raw:'PerseusRenderer["widgets"] | null | undefined',elements:[{name:"signature",raw:'PerseusRenderer["widgets"]'},{name:"null"},{name:"undefined"}],required:!0}},{key:"images",value:{name:"union",raw:'PerseusRenderer["images"] | null | undefined',elements:[{name:"signature",raw:'PerseusRenderer["images"]'},{name:"null"},{name:"undefined"}],required:!0}}]}},description:"",defaultValue:{value:`{
    content: "",
    images: {},
    widgets: {},
}`,computed:!1}},showAlignmentOptions:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},showSeparator:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},title:{required:!0,tsType:{name:"string"},description:""}}};const q=t.shape({content:t.string,images:t.objectOf(t.any),widgets:t.objectOf(t.any)}),b=class b extends h.Component{constructor(){super(...arguments);l(this,"state",b._stateFromProps(this.props))}UNSAFE_componentWillReceiveProps(e){this.setState(b._stateFromProps(e))}render(){const{before:e,after:r}=this.state,a=Math.max(e.length,r.length),p=c.times(a,o=>n.jsx(j,{before:o<e.length?e[o]:void 0,after:o<r.length?r[o]:void 0,title:`Section ${o+1}`,showAlignmentOptions:!0,showSeparator:o<a-1},o));return n.jsx("div",{className:"framework-perseus",children:p})}};l(b,"propTypes",{after:t.oneOfType([q,t.arrayOf(q)]).isRequired,before:t.oneOfType([q,t.arrayOf(q)]).isRequired}),l(b,"_stateFromProps",e=>{const{before:r,after:a}=e;return{before:Array.isArray(r)?r:[r],after:Array.isArray(a)?a:[a]}});let C=b;C.__docgenInfo={description:"",methods:[{name:"_stateFromProps",docblock:null,modifiers:["static"],params:[{name:"props",optional:!1,type:null}],returns:null}],displayName:"ArticleDiff",props:{after:{description:"",type:{name:"union",value:[{name:"custom",raw:"rendererProps"},{name:"arrayOf",value:{name:"custom",raw:"rendererProps"}}]},required:!0},before:{description:"",type:{name:"union",value:[{name:"custom",raw:"rendererProps"},{name:"arrayOf",value:{name:"custom",raw:"rendererProps"}}]},required:!0}}};const K=t.shape({question:t.shape({}).isRequired,answerArea:t.shape({}).isRequired,hints:t.arrayOf(t.any).isRequired});class U extends h.Component{render(){const{before:s,after:e}=this.props,r=Math.max(s.hints.length,e.hints.length),a=n.jsx(j,{before:s.question,after:e.question,title:"Question",showAlignmentOptions:!1,showSeparator:!0}),p=n.jsx(w,{before:s.answerArea,after:e.answerArea,title:"Question extras"}),o=c.times(r,function(d){return n.jsx(j,{before:d<s.hints.length?s.hints[d]:void 0,after:d<e.hints.length?e.hints[d]:void 0,title:`Hint ${d+1}`,showAlignmentOptions:!1,showSeparator:d<r-1},d)});return n.jsxs("div",{className:"framework-perseus",children:[a,p,o&&n.jsx("div",{className:"diff-separator"}),o]})}}l(U,"propTypes",{after:K.isRequired,before:K.isRequired});U.__docgenInfo={description:"",methods:[],displayName:"ItemDiff",props:{after:{description:"",type:{name:"custom",raw:"itemProps.isRequired"},required:!1},before:{description:"",type:{name:"custom",raw:"itemProps.isRequired"},required:!1}}};B(te);X(Y);Z();z();
