import"./all-widgets-Ca9adxvK.js";import"./phet-simulation-DOXsIrrc.js";import"./underscore-U-AHniOr.js";import{l as g}from"./core-widget-registry-2tCIH_GM.js";import"./dependencies-BsVPGK1s.js";import"./perseus-api-DmwU2RjF.js";import"./server-item-renderer-CQq1KA-1.js";import"./article-renderer-XuVFlMX9.js";import"./hints-renderer-Bgu9Wu6L.js";import"./renderer-Doy-sv_3.js";import"./base-radio-kaSH4GDV.js";import"./button-group-q129tbVV.js";import"./svg-image-fTqFFTIk.js";import"./hud--52rQRjV.js";import"./icon-90vA-eeT.js";import"./index-BMj1EjxY.js";import"./inline-icon-olZqfQoG.js";import"./math-input-BAdTcF3v.js";import"./multi-button-group-CGE8ZIlq.js";import"./number-input-CDxfqmZD.js";import"./range-input-pvBjtf5m.js";import"./text-input-DZHbtyPE.js";import"./text-list-editor-Rb8EP659.js";import"./i18n-context-glBZFVwC.js";import{U as f}from"./util-Cjm22Ttl.js";import"./jquery-CkHB0_Mt.js";import"./index-Dd-cahjY.js";import{E as y}from"./editor-jsonify-DdYWGrQp.js";import{n as l}from"./no-important-DlFk8a1I.js";import{r as s}from"./index-C6mWTJJr.js";import{F as C}from"./form-wrapped-text-field-BiMFbofc.js";import{A as k}from"./answer-choices-DX40uSR3.js";import{B as v}from"./behavior-C2A1F-yU.js";import{Q as w}from"./question-markers-CtsY8h9E.js";import{S as A}from"./select-image-l03vLSzF.js";const h=class h extends s.Component{constructor(){super(...arguments),this.getSaveWarnings=()=>{const{choices:e,imageAlt:n,imageUrl:t,markers:a}=this.props,r=[];if(e.length<2&&r.push("Question requires at least two answer choices"),t?n||r.push("Question image has no alt text"):r.push("Image is not specified for question"),!a.length)r.push("Question has no markers, to label answers on image");else{let i=0,o=0;for(const m of a)m.answers.length||i++,m.label||o++;i&&r.push(`Question has ${i} markers with no answers selected`),o&&r.push(`Question has ${o} markers with no ARIA label`)}return r},this.handleImageChange=e=>{this.props.onChange({imageUrl:e,imageWidth:0,imageHeight:0}),e&&f.getImageSize(e,(n,t)=>{this.props.onChange({imageUrl:e,imageWidth:n,imageHeight:t})})},this.handleAltChange=e=>{this.props.onChange({imageAlt:e})},this.handleChoicesChange=e=>{this.props.onChange({choices:e})},this.handleMarkersChange=e=>{this.props.onChange({markers:e})},this.handleBehaviorChange=e=>{this.props.onChange(e)}}componentDidUpdate(e){const n={};e.markers.forEach(a=>n[`${a.x}.${a.y}`]=a);const t=this.props.markers.map((a,r)=>n.hasOwnProperty(`${a.x}.${a.y}`)?-1:r).filter(a=>a!==-1);t.length&&this._questionMarkers&&this._questionMarkers.openDropdownForMarkerIndices(t)}serialize(){return y.serialize.call(this)}render(){const{choices:e,imageAlt:n,imageUrl:t,imageWidth:a,imageHeight:r,markers:i,multipleAnswers:o,hideChoicesFromInstructions:m}=this.props,u=t&&a>0&&r>0;return s.createElement("div",null,s.createElement(A,{onChange:this.handleImageChange,url:t}),s.createElement("div",{className:l.css(p.smallSpacer)}),u&&s.createElement(C,{placeholder:"Alt text (for screen readers)",onChange:d=>this.handleAltChange(d.target.value),value:n,width:"100%"}),s.createElement("div",{className:l.css(p.largeSpacer)}),s.createElement(w,{choices:e,imageUrl:u?t:"",imageWidth:a,imageHeight:r,markers:i,onChange:this.handleMarkersChange,ref:d=>this._questionMarkers=d}),s.createElement("div",{className:l.css(p.largeSpacer)}),s.createElement(k,{choices:e,onChange:this.handleChoicesChange}),s.createElement("div",{className:l.css(p.largeSpacer)}),s.createElement(v,{preferredPopoverDirection:"NONE",multipleAnswers:o,hideChoicesFromInstructions:m,onChange:this.handleBehaviorChange}))}};h.defaultProps=g.defaultWidgetOptions,h.widgetName="label-image";let c=h;const p=l.StyleSheet.create({largeSpacer:{height:32},smallSpacer:{height:16}});c.__docgenInfo={description:"",methods:[{name:"getSaveWarnings",docblock:null,modifiers:[],params:[],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:{type:{name:"any"}}},{name:"handleImageChange",docblock:null,modifiers:[],params:[{name:"url",optional:!1,type:{name:"string"}}],returns:null},{name:"handleAltChange",docblock:null,modifiers:[],params:[{name:"alt",optional:!1,type:{name:"string"}}],returns:null},{name:"handleChoicesChange",docblock:null,modifiers:[],params:[{name:"choices",optional:!1,type:{name:"ReadonlyArray",elements:[{name:"string"}],raw:"ReadonlyArray<string>",alias:"ReadonlyArray"}}],returns:null},{name:"handleMarkersChange",docblock:null,modifiers:[],params:[{name:"markers",optional:!1,type:{name:"ReadonlyArray",raw:'PerseusLabelImageWidgetOptions["markers"]'}}],returns:null},{name:"handleBehaviorChange",docblock:null,modifiers:[],params:[{name:"options",optional:!1,type:{name:"any"}}],returns:null}],displayName:"LabelImageEditor",props:{choices:{required:!1,tsType:{name:"ReadonlyArray",elements:[{name:"string"}],raw:"ReadonlyArray<string>"},description:"",defaultValue:{value:"[]",computed:!1}},imageAlt:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'""',computed:!1}},imageUrl:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'""',computed:!1}},imageWidth:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},imageHeight:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},markers:{required:!1,tsType:{name:"ReadonlyArray",raw:'PerseusLabelImageWidgetOptions["markers"]'},description:"",defaultValue:{value:"[]",computed:!1}},multipleAnswers:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},hideChoicesFromInstructions:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(options: any) => void",signature:{arguments:[{type:{name:"any"},name:"options"}],return:{name:"void"}}},description:""}}};export{c as L};
