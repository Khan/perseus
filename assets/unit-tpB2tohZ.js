import{a as B,j as F}from"./jsx-runtime-BGVbfQ2Z.js";import{u as y,V as L,E as $,M as G,c as N}from"./compare-VLxlEkSV.js";import{_ as w}from"./index-V35CFGao.js";import{$ as P}from"./jquery-5v7aFUvu.js";import{r as H}from"./index-qhcEwEpg.js";import{R as _}from"./index-E09jvG0x.js";import{_ as g}from"./index-default-4_ZsnO94.js";import{P as W}from"./index-tvtfaFq4.js";import{P as Z,E as J}from"./perseus-error-OpXxk17X.js";import{A as K,C as Q}from"./perseus-api-Ly41NhN4.js";const T=["key","ref","containerSizeClass","widgetId","onChange","problemNum","apiOptions","questionCompleted","findWidgets","onRemove","id","onBlur","onFocus","trackInteraction","keypadElement"],ge=e=>{const t={...e};for(const n of T)n in t&&delete t[n];return t},X=`Usage:
  this.change({propName: 5}, callback);
  this.change("propName", 5, callback);
  this.change("propName")`,D=function(e,t,n){const r=g.omit(e.props,T),l=g.extend(r,t);e.props.onChange(l,n)},U=function(e,t,n,r){if(n===void 0)return g.partial(U,e,t);const l={};l[t]=n,D(e,l,r)},Y=function(e,t,n){if(g.isObject(e)&&n===void 0)return n=t,D(this,e,n);if(typeof e=="string")return U(this,e,t,n);throw new Z("Invalid types sent to this.change(): "+g.toArray(arguments).join()+`
`+X,J.Internal)},me={onChange:W.func.isRequired};var q=function(e){return e===Object(e)},x=function(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];if(n)for(var r in n)e[r]=n[r]}return e},E=function(e){return q(e)?Array.isArray(e)?e.slice():x(e):e},C=function(e){if(Array.isArray(e))return ee;if(q(e))return te;if(typeof e=="string")return ne},f=function(e){if(e instanceof f)return e;if(!(this instanceof f))return new f(e);var t=C(e);this._wrapped=t.thaw?t.thaw(e):e};f.prototype.freeze=function(){var e=this._wrapped,t=C(e);return t.freeze?t.freeze(e):e};f.prototype.zoom=function(e){return this._zoomStack===void 0&&(this._zoomStack=[]),this._zoomStack.push({zoom:e,wrapped:this._wrapped}),this._wrapped=f(this._wrapped).get(e),this};f.prototype.deZoom=function(){var e=this._zoomStack.pop();return this._wrapped=f(e.wrapped).set(e.zoom,this._wrapped).freeze(),this};f.prototype.get=function(e){for(var t=this._wrapped,n=0;n<e.length;n++)t=C(t).get(t,e[n]);return t};f.prototype.mod=function(e,t){var n=this._wrapped,r=E(n),l=C(n);if(e.length===0)this._wrapped=t(this._wrapped);else if(e.length===1)this._wrapped=l.mod(r,e[0],t);else{var s=e[0],i=e.slice(1);r[s]=f(n[s]).mod(i,t).freeze(),this._wrapped=r}return this};f.prototype.merge=function(e,t){return this._wrapped=f(this._wrapped).mod(e,function(n){return x(n,t)}).freeze(),this};f.prototype.del=function(e){var t=this._wrapped,n=C(t);if(e.length===1)this._wrapped=n.del(t,e[0]);else{var r=e[0],l=e.slice(1),s=E(t);s[r]=f(t[r]).del(l).freeze(),this._wrapped=s}return this};f.prototype.set=function(e,t){return this.mod(e,function(){return t})};const ee={get:function(e,t){return e[t]},set:function(e,t,n){var r=e.splice();return r[t]=n,r},mod:function(e,t,n){var r=e.slice();return r[t]=n(e[t]),r},del:function(e,t){var n=e.slice();return n.splice(t,1),n}},te={get:function(e,t){return e[t]},set:function(e,t,n){var r=E(e);return r[t]=n,r},mod:function(e,t,n){var r=E(e);return r[t]=n(e[t]),r},del:function(e,t){var n=E(e);return delete n[t],n}},ne={get:function(e,t){return e[t]},set:function(e,t,n){var r=e.splice();return r[t]=n,r},mod:function(e,t,n){var r=e.splice();return r[t]=n(e[t]),r},del:function(e,t){var n=e.slice();return n.splice(t),n}};class re{constructor(t){this.order=j(t),this.mantissa=R(t),this.positive=V(t),this.sigFigs=this.mantissa.length,this.sigDecs=this.order-this.mantissa.length}}function ve(e,t,n,r){const l=""+e;let s=j(l),i=R(l),o=V(l),a,u,h,m=!1;if(e==0||i==""||i=="0"){i="";for(let c=0;c<t;c++)i+="0";s=t+n,n<0&&-n>=t&&(m=!0)}else{if(u=s-i.length-n,h=t-i.length,a=Math.min(h,u),a<0){let c=S(i,-a);c.length>i.length+a&&(s++,u>h&&(c=S(c,1))),i=c}else if(a>0)for(let c=0;c<a;c++)i+="0";(i==""||i=="0")&&(i="0",o=!0,s=1+n,s!=0&&(m=!0))}const z=r||i.length>20||s>4||s<-2||s-i.length>0&&M(i)>0||m;let p="";if(o||(p+="-"),z)p+=i.charAt(0),i.length>1&&(p+="."+i.substring(1,i.length)),s-1!=0&&(p+=" x 10^"+(s-1));else{let c="",d="",O=!0;if(s>0)if(i.length>s)c=i.substring(0,s),d=i.substring(s,i.length);else{c=i,O=M(i)!=0;for(let v=0;v<s-i.length;v++)c+="0"}else{for(let v=0;v<-s;v++)d+="0";d+=i}p+=(c==""?"0":c)+(O?".":"")+d}return p}function M(e){let t=0;for(let n=e.length-1;n>=0;n--)if(e.charAt(n)=="0")t++;else return t;return t}function V(e){let t=!0,n=!1,r=!1,l="",s="",i=!0;for(let o=0;o<e.length;o++){const a=e.charAt(o);a>="1"&&a<="9"?(s+=l+a,l="",r=!0,t=!1):a=="0"?(n?r&&(s+=l+a,l=""):r&&(l+=a),t=!1):!n&&a=="."?(s+=l,l="",n=!0,t=!1):a=="e"||a=="E"&&o+1<e.length?(parseInt(e.substring(o+1,e.length)),o=e.length):t&&(a=="+"||a=="-")&&a=="-"&&(i=!i)}return s==""?!0:i}function R(e){let t=!1,n=!1,r="",l="",s="";for(let i=0;i<e.length;i++){const o=e.charAt(i);o>="1"&&o<="9"?(s+=r+o,r="",n=!0):o=="0"?t?n?(s+=r+o,r=""):l+=o:n?(l+=o,r+=o):l+=o:!t&&o=="."?(s+=r,r="",t=!0):(o=="e"||o=="E"&&i+1<e.length)&&(parseInt(e.substring(i+1,e.length)),i=e.length)}return s==""?l:s}function j(e){let t=!1,n=!1,r="",l="",s=0,i=0;for(let o=0;o<e.length;o++){const a=e.charAt(o);if(a>="1"&&a<="9")l+=r+a,r="",n=!0,t||(i++,s++);else if(a=="0")t?n?(l+=r+a,r=""):s--:(i++,n&&(s++,r+=a));else if(!t&&a==".")l+=r,r="",t=!0;else if(a=="e"||a=="E"&&o+1<e.length){const u=parseInt(e.substring(o+1,e.length));s+=u,i+=u,o=e.length}}return l==""?i:s}function S(e,t){const n=e.length-t-1;if(n<0)return"";if(n>=e.length-1)return e;const r=e.charAt(n+1),l=e.charAt(n);let s=!1;if(r>"5")s=!0;else if(r=="5"){for(let o=n+2;o<e.length;o++)e.charAt(o)!="0"&&(s=!0);l%2==1&&(s=!0)}let i="";for(let o=n;o>=0;o--){const a=e.charAt(o);if(s){let u;if(a=="9")u="0";else{switch(a){case"0":u="1";break;case"1":u="2";break;case"2":u="3";break;case"3":u="4";break;case"4":u="5";break;case"5":u="6";break;case"6":u="7";break;case"7":u="8";break;case"8":u="9";break}s=!1}i=u+i}else i=a+i}return s&&(i="1"+i),i}const ie="all",I=function(e){return new re(e).sigFigs},A=class A extends H.Component{constructor(){super(...arguments),this._showError=()=>{if(this.props.value==="")return;const t=P(_.findDOMNode(this.refs.error));t.is(":visible")||t.css({top:50,opacity:.1}).show().animate({top:0,opacity:1},300)},this._hideError=()=>{const t=P(_.findDOMNode(this.refs.error));t.is(":visible")&&t.animate({top:50,opacity:.1},300,function(){P(this).hide()})},this.change=(...t)=>Y.apply(this,t),this.handleBlur=()=>{this.props.onBlur([]),clearTimeout(this._errorTimeout),y(this.props.value).parsed||this._showError()},this.handleChange=t=>{this._hideError(),this.props.onChange({value:t.target.value})},this.simpleValidate=(t,n)=>A.validate(this.getUserInput(),t),this.getUserInput=()=>this.props.value,this.getInputPaths=()=>[[]],this.focusInputPath=t=>{const n=_.findDOMNode(this.refs.input);n&&n.focus()},this.handleFocus=()=>{this.props.onFocus([])},this.blurInputPath=t=>{const n=_.findDOMNode(this.refs.input);n&&n.blur()},this.setInputValue=(t,n,r)=>{this.props.onChange({value:n},r)},this.getDOMNodeForPath=()=>_.findDOMNode(this.refs.input),this.getGrammarTypeForPath=t=>"unit"}static validate(t,n){const r=y(n.value).expr,l=y(t);if(!l.parsed)return{type:"invalid",message:w("I couldn't understand those units.")};let s=null;const i=n.sigfigs,o=I(l.coefficient)===i;o||(s=w("Check your significant figures."));let a;try{const p=new L("x"),d=new $(r.simplify(),"=",new G(p,l.expr.simplify())).solveLinearEquationForVariable(p);a=Number(d.eval()).toPrecision(i)===1 .toPrecision(i)}catch{a=!1}a||(s=w("That answer is numerically incorrect."));let u;const h=k(l.expr.simplify()),m=k(r.simplify());return n.accepting===ie?u=N(h,m).equal:u=g(n.acceptingUnits).any(p=>{const c=k(y(p).unit.simplify());return N(c,h).equal}),u||(s=w("Check your units.")),{type:"points",earned:u&&a&&o?1:0,total:1,message:s}}componentDidUpdate(){clearTimeout(this._errorTimeout),y(this.props.value).parsed?this._hideError():this._errorTimeout=setTimeout(this._showError,2e3)}componentWillUnmount(){clearTimeout(this._errorTimeout)}render(){return B("div",{className:"old-unit-input",children:[F("input",{onChange:this.handleChange,ref:"input",className:Q.INTERACTIVE,value:this.props.value,onFocus:this.handleFocus,onBlur:this.handleBlur}),F("div",{ref:"error",className:"error",style:{display:"none"},children:w("I don't understand that")})]})}};A.defaultProps={apiOptions:K.defaults,value:""};let b=A;const k=function(e){return e.simplify().asMul().partition()[1].flatten().simplify()},ye={name:"unit-input",displayName:"Unit input",defaultAlignment:"inline-block",widget:b,transform:e=>f(e).del(["value"]).freeze(),version:{major:0,minor:1},hidden:!0};try{I.displayName="countSigfigs",I.__docgenInfo={description:"",displayName:"countSigfigs",props:{}}}catch{}try{b.displayName="OldUnitInput",b.__docgenInfo={description:"",displayName:"OldUnitInput",props:{apiOptions:{defaultValue:{value:`{
        isArticle: false,
        isMobile: false,
        onInputError: function () {},
        onFocusChange: function () {},
        GroupMetadataEditor: StubTagEditor,
        showAlignmentOptions: false,
        readOnly: false,
        groupAnnotator: function (): null {
            return null;
        },
        baseElements: {
            Link: (
                props: any,
            ): React.ReactElement<React.ComponentProps<"a">> => {
                return <a {...props} />;
            },
        },
        setDrawingAreaAvailable: function () {},
        useDraftEditor: false,
        canScrollPage: false,
        inModal: false,
        crossOutEnabled: false,
        editorChangeDelay: 0,
    } as APIOptionsWithDefaults`},description:"",name:"apiOptions",required:!1,type:{name:"Readonly<{ isArticle?: boolean; onInputError?: ((widgetId: any, value: string, message?: string | null) => unknown) | undefined; onFocusChange?: ((newFocusPath: FocusPath, oldFocusPath: FocusPath, keypadHeight?: number | undefined, focusedElement?: HTMLElement | undefined) => unknown) | undef..."}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"ChangeHandler"}},value:{defaultValue:{value:""},description:"",name:"value",required:!1,type:{name:"string"}},onBlur:{defaultValue:null,description:"",name:"onBlur",required:!0,type:{name:"(arg1: FocusPath) => unknown"}},onFocus:{defaultValue:null,description:"",name:"onFocus",required:!0,type:{name:"(arg1: FocusPath) => unknown"}}}}}catch{}export{b as O,ye as U,ve as a,Y as c,T as d,f as l,me as p,ge as r};
