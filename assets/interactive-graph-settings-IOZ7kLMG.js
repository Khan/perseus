import{j as t,a as i}from"./jsx-runtime-BGVbfQ2Z.js";import"./article-renderer-2adRDJEs.js";import{c as T}from"./unit-tpB2tohZ.js";import"./index-eZ2N530f.js";import"./index-V35CFGao.js";import{r as f}from"./index-qhcEwEpg.js";import"./fixed-to-responsive-X0KGwmEJ.js";import"./dependencies-fnqF3NiV.js";import"./video-transcript-link-ZVuMBlt5.js";import{_ as l}from"./index-default-4_ZsnO94.js";import"./perseus-api-Ly41NhN4.js";import"./multi-renderer-YWTbdcUg.js";import"./hints-renderer-Ce3AIV11.js";import"./renderer-D-YI6qGu.js";import"./base-radio-AagZi9VH.js";import{c as w}from"./components-Jrc4FLty.js";import{U as x}from"./util-G-g1AweO.js";import"./jquery-5v7aFUvu.js";import{i as y}from"./constants-5iWyYZaE.js";const{ButtonGroup:R,InfoTip:N,PropCheckBox:S,RangeInput:g}=w,I={url:null,width:0,height:0};function G(v,a){return Math.floor((v[1]-v[0])/a)}const m=class m extends f.Component{constructor(a){super(a),this._isMounted=!1,this.bgUrlRef=f.createRef(),this.labelXRef=f.createRef(),this.labelYRef=f.createRef(),this.change=(...e)=>T.apply(this,e),this.changeRulerLabel=e=>{this.change({rulerLabel:e.target.value})},this.changeRulerTicks=e=>{this.change({rulerTicks:+e.target.value})},this.changeBackgroundUrl=e=>{var o;if(e.type==="keypress"&&e.key!=="Enter")return;const r=(p,h,s)=>{const c={...this.props.backgroundImage};c.url=p,c.width=h,c.height=s,this.setState({backgroundImage:c},this.changeGraph)},n=(o=this.bgUrlRef.current)==null?void 0:o.value;n?x.getImageSize(n,(p,h)=>{this._isMounted&&r(n,p,h)}):r(null,0,0)},this.renderLabelChoices=e=>e.map(r=>t("option",{value:r[1],children:r[0]},r[1])),this.validRange=e=>l.every(e,function(n){return l.isFinite(n)})?e[0]>=e[1]?"Range must have a higher number on the right":!0:"Range must be a valid number",this.validateStepValue=e=>{const{step:r,range:n,name:o,minTicks:p,maxTicks:h}=e,s=G(n,r);return s<p?o+" is too large, there must be at least "+p+" ticks.":s>h?o+" is too small, there can be at most "+h+" ticks.":!0},this.validSnapStep=(e,r)=>this.validateStepValue({step:e,range:r,name:"Snap step",minTicks:5,maxTicks:60}),this.validGridStep=(e,r)=>this.validateStepValue({step:e,range:r,name:"Grid step",minTicks:3,maxTicks:60}),this.validStep=(e,r)=>this.validateStepValue({step:e,range:r,name:"Step",minTicks:3,maxTicks:20}),this.validBackgroundImageSize=e=>e.url?e.width<=450&&e.height<=450?!0:"Image must be smaller than 450px x 450px.":!0,this.validateGraphSettings=(e,r,n,o,p)=>{const h=this;let s;if(!l.every(e,function(u){return s=h.validRange(u),s===!0})||!l.every(r,function(u,d){return s=h.validStep(u,e[d]),s===!0})||!l.every(n,function(u,d){return s=h.validGridStep(u,e[d]),s===!0})||!l.every(o,function(u,d){return s=h.validSnapStep(u,e[d]),s===!0}))return s;const k=this.validBackgroundImageSize(p);return k!==!0?(s=k,s):!0},this.changeLabel=(e,r)=>{const n=r.target.value,o=this.state.labelsTextbox.slice();o[e]=n,this.setState({labelsTextbox:o},this.changeGraph)},this.changeRange=(e,r)=>{const n=this.state.rangeTextbox.slice();n[e]=r;const o=this.state.stepTextbox.slice(),p=this.state.gridStepTextbox.slice(),h=this.state.snapStepTextbox.slice(),s=x.scaleFromExtent(n[e],this.props.box[e]);if(this.validRange(n[e])===!0){o[e]=x.tickStepFromExtent(n[e],this.props.box[e]);const c=x.gridStepFromTickStep(o[e],s);c&&(p[e]=c),h[e]=p[e]/2}this.setState({stepTextbox:o,gridStepTextbox:p,snapStepTextbox:h,rangeTextbox:n},this.changeGraph)},this.changeStep=e=>{this.setState({stepTextbox:e},this.changeGraph)},this.changeSnapStep=e=>{this.setState({snapStepTextbox:e},this.changeGraph)},this.changeGridStep=e=>{this.setState({gridStepTextbox:e,snapStepTextbox:l.map(e,function(r){return r/2})},this.changeGraph)},this.changeGraph=()=>{const e=this.state.labelsTextbox,r=l.map(this.state.rangeTextbox,function(c){return l.map(c,Number)}),n=l.map(this.state.stepTextbox,Number),o=this.state.gridStepTextbox,p=this.state.snapStepTextbox,h=this.state.backgroundImage,s=this.validateGraphSettings(r,n,o,p,h);s===!0?this.change({valid:!0,labels:e,range:r,step:n,gridStep:o,snapStep:p,backgroundImage:h}):this.change({valid:s})},this.state=m.stateFromProps(a)}static stateFromProps(a){return{labelsTextbox:a.labels,gridStepTextbox:a.gridStep,snapStepTextbox:a.snapStep,stepTextbox:a.step,rangeTextbox:a.range,backgroundImage:{...a.backgroundImage}}}componentDidMount(){this._isMounted=!0,this.changeGraph=l.debounce(this.changeGraph,300)}UNSAFE_componentWillReceiveProps(a){(!l.isEqual(this.props.labels,a.labels)||!l.isEqual(this.props.gridStep,a.gridStep)||!l.isEqual(this.props.snapStep,a.snapStep)||!l.isEqual(this.props.step,a.step)||!l.isEqual(this.props.range,a.range)||!l.isEqual(this.props.backgroundImage,a.backgroundImage))&&this.setState(m.stateFromProps(a))}componentWillUnmount(){this._isMounted=!1}render(){return i("div",{children:[i("div",{className:"graph-settings",children:[i("div",{className:"perseus-widget-row",children:[i("div",{className:"perseus-widget-left-col",children:[t("label",{htmlFor:"labels-x",children:"x Label"}),t("input",{id:"labels-x",type:"text",className:"graph-settings-axis-label",ref:this.labelXRef,onChange:a=>this.changeLabel(0,a),value:this.state.labelsTextbox[0]||""})]}),i("div",{className:"perseus-widget-right-col",children:[t("label",{htmlFor:"labels-y",children:"y Label"}),t("input",{id:"labels-y",type:"text",className:"graph-settings-axis-label",ref:this.labelYRef,onChange:a=>this.changeLabel(1,a),value:this.state.labelsTextbox[1]||""})]})]}),i("div",{className:"perseus-widget-row",children:[i("div",{className:"perseus-widget-left-col",children:[t("label",{htmlFor:"range-x",children:"x Range"}),t(g,{id:"range-x",value:this.state.rangeTextbox[0],onChange:a=>this.changeRange(0,a)})]}),i("div",{className:"perseus-widget-right-col",children:[t("label",{htmlFor:"range-y",children:"y Range"}),t(g,{id:"range-y",value:this.state.rangeTextbox[1],onChange:a=>this.changeRange(1,a)})]})]}),i("div",{className:"perseus-widget-row",children:[i("div",{className:"perseus-widget-left-col",children:[t("label",{htmlFor:"tick-step",children:"Tick Step"}),t(g,{id:"tick-step",value:this.state.stepTextbox,onChange:this.changeStep})]}),i("div",{className:"perseus-widget-right-col",children:[t("label",{htmlFor:"grid-step",children:"Grid Step"}),t(g,{id:"grid-step",value:this.state.gridStepTextbox,onChange:this.changeGridStep})]})]}),t("div",{className:"perseus-widget-row",children:i("div",{className:"perseus-widget-left-col",children:[t("label",{htmlFor:"snap-step",children:"Snap Step"}),t(g,{id:"snap-step",value:this.state.snapStepTextbox,onChange:this.changeSnapStep})]})}),i("div",{className:"perseus-widget-row",children:[t("label",{children:"Markings: "}),t(R,{value:this.props.markings,allowEmpty:!1,buttons:[{value:"graph",content:"Graph"},{value:"grid",content:"Grid"},{value:"none",content:"None"}],onChange:this.change("markings")})]}),t("div",{className:"perseus-widget-left-col",children:t(S,{label:"Show tooltips",showTooltips:this.props.showTooltips,onChange:this.change})})]}),i("div",{className:"image-settings",children:[t("div",{children:"Background image:"}),i("div",{children:[t("label",{htmlFor:"bg-url",children:"Url:"}),t("input",{id:"bg-url",type:"text",className:"graph-settings-background-url",ref:this.bgUrlRef,value:this.state.backgroundImage.url||"",onChange:a=>{const e=l.clone(this.props.backgroundImage);e.url=a.target.value,this.setState({backgroundImage:e})},onKeyPress:this.changeBackgroundUrl,onBlur:this.changeBackgroundUrl}),t(N,{children:t("p",{children:'Create an image in graphie, or use the "Add image" function to create a background.'})})]})]}),i("div",{className:"misc-settings",children:[i("div",{className:"perseus-widget-row",children:[t("div",{className:"perseus-widget-left-col",children:t(S,{label:"Show ruler",showRuler:this.props.showRuler,onChange:this.change})}),t("div",{className:"perseus-widget-right-col",children:t(S,{label:"Show protractor",showProtractor:this.props.showProtractor,onChange:this.change})})]}),this.props.showRuler&&i("div",{children:[t("div",{children:i("label",{children:[" ","Ruler label:"," ",i("select",{onChange:this.changeRulerLabel,value:this.props.rulerLabel,children:[t("option",{value:"",children:"None"}),t("optgroup",{label:"Metric",children:this.renderLabelChoices([["milimeters","mm"],["centimeters","cm"],["meters","m"],["kilometers","km"]])}),t("optgroup",{label:"Imperial",children:this.renderLabelChoices([["inches","in"],["feet","ft"],["yards","yd"],["miles","mi"]])})]})]})}),t("div",{children:i("label",{children:[" ","Ruler ticks:"," ",t("select",{onChange:this.changeRulerTicks,value:this.props.rulerTicks,children:l.map([1,2,4,8,10,16],function(a){return t("option",{value:a,children:a},`ruler-tick-${a}`)})})]})})]})]})]})}};m.defaultProps={box:[y.defaultBoxSizeSmall,y.defaultBoxSizeSmall],labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],gridStep:[1,1],snapStep:[1,1],valid:!0,backgroundImage:I,markings:"graph",showProtractor:!1,showRuler:!1,showTooltips:!1,rulerLabel:"",rulerTicks:10};let b=m;const O=b;try{b.displayName="InteractiveGraphSettings",b.__docgenInfo={description:"",displayName:"InteractiveGraphSettings",props:{box:{defaultValue:{value:`[
            interactiveSizes.defaultBoxSizeSmall,
            interactiveSizes.defaultBoxSizeSmall,
        ]`},description:"The size of the graph area in pixels.",name:"box",required:!1,type:{name:"[x: number, y: number]"}},labels:{defaultValue:{value:'["x", "y"]'},description:"The labels for the x and y axes.",name:"labels",required:!1,type:{name:"readonly string[]"}},range:{defaultValue:{value:`[
            [-10, 10],
            [-10, 10],
        ]`},description:"The range of the graph.",name:"range",required:!1,type:{name:"[x: Range, y: Range]"}},step:{defaultValue:{value:"[1, 1]"},description:`How far apart the tick marks on the axes are in the x and y
directions.`,name:"step",required:!1,type:{name:"[x: number, y: number]"}},gridStep:{defaultValue:{value:"[1, 1]"},description:"How far apart the grid lines are in the x and y directions.",name:"gridStep",required:!1,type:{name:"[x: number, y: number]"}},snapStep:{defaultValue:{value:"[1, 1]"},description:"How far apart the snap-to points are in the x and y directions.",name:"snapStep",required:!1,type:{name:"[x: number, y: number]"}},valid:{defaultValue:{value:"true"},description:`An error message to display in the graph area, or true if the
graph is valid.`,name:"valid",required:!1,type:{name:"string | boolean"}},backgroundImage:{defaultValue:{value:`{
    url: null,
    width: 0,
    height: 0,
} as const`},description:"The background image to display in the graph area and its properties.",name:"backgroundImage",required:!1,type:{name:"PerseusImageBackground"}},markings:{defaultValue:{value:"graph"},description:`The type of markings to display on the graph.
- graph: shows the axes and the grid lines
- grid: shows only the grid lines
- none: shows no markings`,name:"markings",required:!1,type:{name:"enum",value:[{value:'"graph"'},{value:'"grid"'},{value:'"none"'}]}},showProtractor:{defaultValue:{value:"false"},description:"Whether to show the protractor on the graph.",name:"showProtractor",required:!1,type:{name:"boolean"}},showRuler:{defaultValue:{value:"false"},description:"Whether to show the ruler on the graph.",name:"showRuler",required:!1,type:{name:"boolean"}},showTooltips:{defaultValue:{value:"false"},description:"Whether to show tooltips on the graph.",name:"showTooltips",required:!1,type:{name:"boolean"}},rulerLabel:{defaultValue:{value:""},description:"The label to display on the ruler, if any.",name:"rulerLabel",required:!1,type:{name:"string"}},rulerTicks:{defaultValue:{value:"10"},description:"The number of ticks to display on the ruler.",name:"rulerTicks",required:!1,type:{name:"number"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(arg1: Partial<Props>) => void"}}}}}catch{}export{O as I};
