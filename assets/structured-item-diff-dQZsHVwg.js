import{j as p,a as w}from"./jsx-runtime-BGVbfQ2Z.js";import"./article-renderer-rRl5DFLq.js";import{_ as y}from"./index-default-4_ZsnO94.js";import"./util-hMu2nkBL.js";import"./unit-Tx_erQ0l.js";import"./version-akiLXZts.js";import"./dependencies-fnqF3NiV.js";import"./perseus-api-XkoWPDUZ.js";import{c as J,d as U,e as B,s as $}from"./multi-renderer-EN5GCubG.js";import"./hints-renderer-4Qo-Mdjs.js";import{g as ie,s as oe}from"./renderer-YMwVTw_k.js";import"./base-radio-P1bXxk6A.js";import"./button-group-eBTrRsKy.js";import"./graph-pwSeuXvn.js";import"./svg-image-A17_gkxe.js";import"./hud-Q7Km3N9P.js";import"./icon-HbAIhp4d.js";import"./info-tip-_E95qi8X.js";import"./inline-icon-MJBS_-2U.js";import"./math-input-N24XH-Sd.js";import"./multi-button-group-rHU9dGVb.js";import"./number-input-TyU6YAix.js";import"./prop-check-box-AM0eLeop.js";import"./range-input-iEradMpU.js";import"./text-input-yDsqFbe3.js";import"./text-list-editor-xQBHt64k.js";import"./jquery-5v7aFUvu.js";import"./index-0C4KXdeC.js";import"./i18n-context-9-s9cJ--.js";import{r as k}from"./index-qhcEwEpg.js";import{T as ae}from"./text-diff-cOCPP8Dq.js";import{c as pe}from"./components-vGtFGqPh.js";import{c as q}from"./index-dnMhQZ-1.js";import{P as i}from"./index-k-0mNqHS.js";import{T as ce}from"./tags-diff-K-ogAO4i.js";const V="unchanged",Y="changed",Z="added",L="removed",de=function(r,e,t){let s;return r===e?s=V:r===void 0?s=Z:e===void 0?s=L:s=Y,{after:JSON.stringify(e),before:JSON.stringify(r),children:[],key:t,status:s}},le=function(r,e,t){const s=y.isObject(r)?y(r).keys():[],n=y.isObject(e)?y(e).keys():[],a=y.union(s,n),o=y.map(a,function(l){return ee((r||{})[l],(e||{})[l],l)});let c;return r===void 0?c=Z:e===void 0?c=L:c=y.any(o,function(h){return h.status!==V})?Y:V,{after:"",before:"",children:o,key:t,status:c}},ee=function(r,e,t){return typeof r=="object"||typeof e=="object"?le(r,e,t):de(r,e,t)},{SvgImage:z}=pe,te=function(r){return(r-1)*20},P="before",E="after",fe="unchanged",I=class I extends k.Component{render(){const e=q(this.props.className,{"diff-row":!0,before:this.props.side===P,after:this.props.side===E});return p("div",{className:e,children:w("div",{style:{paddingLeft:te(this.props.depth)},children:[this.props.showKey&&this.props.propKey+": ",p("span",{className:"inner-value dark "+this.props.className,children:this.props.value})]})})}};I.propTypes={className:i.string.isRequired,depth:i.number.isRequired,propKey:i.string.isRequired,showKey:i.bool.isRequired,side:i.oneOf([P,E]).isRequired,value:i.string};let R=I;const M=class M extends k.Component{render(){const e=this;return p("div",{onClick:e.props.onClick,style:{clear:"both"},children:y.map([P,E],function(t){return p("div",{className:"diff-row collapsed "+t,children:p("div",{style:{paddingLeft:te(e.props.depth)},children:p("span",{children:" [ show unmodified ] "})})},t)})})}};M.propTypes={depth:i.number,onClick:i.func.isRequired},M.defaultProps={depth:0};let D=M;const O=class O extends k.Component{constructor(){super(...arguments),this.state={expanded:this.props.expanded},this.expand=()=>{this.setState({expanded:!0})}}render(){const e=this.props.entry,t=e.status==="removed",s=e.status==="added",n=e.status==="changed",a=e.children.length>0,o=q({removed:t||n&&!a,dark:t,"blank-space":s}),c=q({added:s||n&&!a,dark:s,"blank-space":t});let l;this.state.expanded?l=e.children:l=y(e.children).select(function(u){return u.status!==fe});let h=l.length<e.children.length;e.children.length===l.length+1&&(l=e.children,h=!1);const b=this;return w("div",{children:[e.key&&w("div",{style:{clear:"both"},children:[p(R,{side:P,className:o,depth:this.props.depth,propKey:e.key,showKey:!s,value:e.before}),p(R,{side:E,className:c,depth:this.props.depth,propKey:e.key,showKey:!t,value:e.after})]}),y.map(l,function(u){return p(O,{depth:b.props.depth+1,entry:u,expanded:b.state.expanded},u.key)}),h&&p(D,{depth:this.props.depth+1,onClick:this.expand})]})}};O.propTypes={depth:i.number,entry:i.shape({after:i.string,before:i.string,children:i.arrayOf(i.any),key:i.string}),expanded:i.bool},O.defaultProps={depth:0};let H=O;const G=class G extends k.Component{render(){const{before:e,after:t}=this.props,s=e.options&&e.options.backgroundImage?e.options.backgroundImage.url:"",n=t.options&&t.options.backgroundImage?t.options.backgroundImage.url:"";return w("div",{children:[p("div",{className:"diff-row before",children:s&&p("div",{className:q({image:!0,"image-unchanged":s===n,"image-removed":s!==n}),children:p(z,{src:s,title:s})})}),p("div",{className:"diff-row after",children:n&&p("div",{className:q({image:!0,"image-unchanged":s===n,"image-added":s!==n}),children:p(z,{src:n,title:n})})})]})}};G.propTypes={after:i.shape({options:i.objectOf(i.any)}).isRequired,before:i.shape({options:i.objectOf(i.any)}).isRequired};let F=G;const K=class K extends k.Component{render(){const{after:e,before:t,title:s,type:n}=this.props,a=ee(t,e);return w("div",{children:[p("div",{className:"diff-header",children:s}),p("div",{className:"diff-header",children:s}),w("div",{className:"diff-body ui-helper-clearfix",children:[n==="image"&&p(F,{before:t,after:e}),p(H,{entry:a})]})]})}};K.propTypes={after:i.shape({options:i.objectOf(i.any)}),before:i.shape({options:i.objectOf(i.any)}),title:i.string.isRequired,type:i.string},K.defaultProps={after:{},before:{},type:""};let _=K;try{_.displayName="WidgetDiff",_.__docgenInfo={description:"",displayName:"WidgetDiff",props:{}}}catch{}const Q=function(r,e){const{alignment:t,graded:s,options:n,type:a}=r||{},o={options:n};return e&&ie(a).length>1&&(o.alignment=t),a==="transformer"&&(o.graded=s),oe(a)&&(o.static=(r==null?void 0:r.static)??void 0),o},W=class W extends k.Component{render(){const{after:e,before:t,showAlignmentOptions:s,showSeparator:n,title:a}=this.props;let o,c;(t.content||e.content)&&(o=p(ae,{before:t.content,after:e.content,title:a}));const l=Object.keys(t.widgets??{}).filter(b=>t.content.includes(b)),h=Object.keys(e.widgets??{}).filter(b=>e.content.includes(b));return(l.length||h.length)&&(c=y.union(l,h).map(u=>{var d,m,f,C;return p(_,{before:Q((d=t.widgets)==null?void 0:d[u],s),after:Q((m=e.widgets)==null?void 0:m[u],s),title:u,type:(((f=t.widgets)==null?void 0:f[u])??{}).type||(((C=e.widgets)==null?void 0:C[u])??{}).type},u)})),w("div",{children:[o,c,n&&p("div",{className:"diff-separator"})]})}};W.defaultProps={after:{content:"",images:{},widgets:{}},before:{content:"",images:{},widgets:{}},showAlignmentOptions:!1,showSeparator:!1};let j=W;try{j.displayName="RendererDiff",j.__docgenInfo={description:"",displayName:"RendererDiff",props:{after:{defaultValue:{value:`{
            content: "",
            images: {},
            widgets: {},
        }`},description:"",name:"after",required:!1,type:{name:"RendererProps"}},before:{defaultValue:{value:`{
            content: "",
            images: {},
            widgets: {},
        }`},description:"",name:"before",required:!1,type:{name:"RendererProps"}},showAlignmentOptions:{defaultValue:{value:"false"},description:"",name:"showAlignmentOptions",required:!1,type:{name:"boolean"}},showSeparator:{defaultValue:{value:"false"},description:"",name:"showSeparator",required:!1,type:{name:"boolean"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}}}}}catch{}function X(r,e){let t=!0;for(let s=0;s<e.length;s++){if(s>=r.length)return!1;e[s]!==r[s]&&(t=!1)}return t}function A(r,e){if(r.length!==e.length)return!1;for(let t=0,s=r.length;t<s;t++)if(r[t]!==e[t])return!1;return!0}function ue(r){const e=[];for(let t=0;t<r.length;t++)typeof r[t]=="number"?e.push((r[t]+1).toString()+":"):e.push(r[t]);return e.join(" ")}class x extends k.Component{static generateCompletePathsList(e,t,s,n,a){if(n.type==="content"||n.type==="hint"||n.type==="tags"){const o=e.length>0&&A(a,e[0][1]),c=t.length>0&&A(a,t[0][1]);o&&c?(s.push(a),e.splice(0,1),t.splice(0,1)):o?(s.push(a),e.splice(0,1)):c&&(s.push(a),t.splice(0,1))}else if(n.type==="array"){let o=0,c=a.concat(o);for(;e.length>0&&X(e[0][1],c)||t.length>0&&X(t[0][1],c);)x.generateCompletePathsList(e,t,s,n.elementShape,c),o++,c=a.concat(o)}else if(n.type==="object"){const o=Object.keys(n.shape);for(let c=0;c<o.length;c++){const l=a.concat([o[c]]);x.generateCompletePathsList(e,t,s,n.shape[o[c]],l)}}}render(){const{before:e,after:t,shape:s,tags:n}=this.props,a=[],o=[];J().setContentMapper((d,m,f)=>a.push([d,f])).setHintMapper((d,m,f)=>a.push([d,f])).setTagsMapper((d,m,f)=>a.push([d,f])).mapTree(U(e),s),J().setContentMapper((d,m,f)=>o.push([d,f])).setHintMapper((d,m,f)=>o.push([d,f])).setTagsMapper((d,m,f)=>o.push([d,f])).mapTree(U(t),s);const c=a.slice(),l=o.slice(),h=[];x.generateCompletePathsList(c,l,h,s,[]);const b=h.length,u=h.map((d,m)=>{const f=d[d.length-1]==="tags",C=ue(d);let N=a.find(v=>A(v[1],d)),T=o.find(v=>A(v[1],d));if(f){N||(N=[[],d]),T||(T=[[],d]);const v=[];Array.isArray(N[0])&&N[0].forEach(g=>{typeof g=="string"&&v.push(n.idToName(g))});const S=[];Array.isArray(T[0])&&T[0].forEach(g=>{typeof g=="string"&&S.push(n.idToName(g))});const se=v.filter(g=>S.includes(g)),re=v.filter(g=>!S.includes(g)),ne=S.filter(g=>!v.includes(g));return p(ce,{beforeOnly:re,afterOnly:ne,intersection:se,title:C,showSeparator:m<b-1},m)}return N||(N=[B($.content),d]),T||(T=[B($.content),d]),p(j,{before:N[0],after:T[0],title:C,showAlignmentOptions:!1,showSeparator:m<b-1},m)});return p("div",{className:"framework-perseus",children:u})}}try{x.displayName="StructuredItemDiff",x.__docgenInfo={description:"",displayName:"StructuredItemDiff",props:{after:{defaultValue:null,description:"",name:"after",required:!0,type:{name:"Item"}},before:{defaultValue:null,description:"",name:"before",required:!0,type:{name:"Item"}},shape:{defaultValue:null,description:"",name:"shape",required:!0,type:{name:"Shape"}},tags:{defaultValue:null,description:"",name:"tags",required:!0,type:{name:"Tag"}}}}}catch{}export{j as R,x as S,_ as W};
