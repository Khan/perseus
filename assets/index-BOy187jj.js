import{j as n}from"./jsx-runtime-BT65X5dW.js";import{r as c}from"./index-C6mWTJJr.js";import{V as u,I as $}from"./index-C0xJ1VDw.js";import{m as N,c as A,u as v,b as I,T as R,w as H,f as U,a as z,I as G,x as V}from"./index-BDsoIsav.js";import{s as l,a as g,b as W}from"./index-BfjDPqC2.js";import{c as Y,b as K}from"./index-CcqtyHPG.js";import{r as y}from"./index-B1Gws05u.js";import{n as j}from"./no-important-DlFk8a1I.js";import{w as q}from"./index-3H81sEQ1.js";import{M as J}from"./index-BWwc-H8c.js";const O={root:{color:{inverse:{background:g.surface.inverse,foreground:g.text.inverse}},border:{radius:W.radius.radius_040}},backdrop:{color:{background:g.surface.overlay}},dialog:{spacing:{padding:l.medium_16}},footer:{color:{border:g.border.primary}},header:{color:{border:g.border.primary,secondary:g.text.secondary},spacing:{paddingBlockMd:l.large_24,paddingInlineMd:l.xLarge_32,paddingInlineSm:l.medium_16,gap:l.xSmall_8,titleGapMd:l.medium_16,titleGapSm:l.xLarge_32}},panel:{spacing:{gap:l.xLarge_32}},closeButton:{spacing:{gap:l.xSmall_8}}},Q=N(O,{root:{color:{inverse:{background:g.khanmigo.primary}}}}),X={default:O,khanmigo:Q},x=A(O);function Z(o){const e=c.useContext(R),t=X[e]||O;return n.jsx(x.Provider,{value:t,children:o.children})}const ee=c.forwardRef(function(e,t){const{above:s,below:r,role:i="dialog",style:m,children:f,testId:a,"aria-labelledby":b,"aria-describedby":p}=e,{theme:E}=v(x),h=I(oe,E);return n.jsxs(u,{style:[h.wrapper,m],children:[r&&n.jsx(u,{style:h.below,children:r}),n.jsx(u,{role:i,"aria-modal":"true","aria-labelledby":b,"aria-describedby":p,ref:t,style:h.dialog,testId:a,children:f}),s&&n.jsx(u,{style:h.above,children:s})]})}),L=c.forwardRef(function(e,t){return n.jsx(Z,{children:n.jsx(ee,{...e,ref:t})})}),te="@media (max-width: 767px)",oe=o=>({wrapper:{display:"flex",flexDirection:"row",alignItems:"stretch",width:"100%",height:"100%",position:"relative",[te]:{padding:o.dialog.spacing.padding,flexDirection:"column"}},dialog:{width:"100%",height:"100%",borderRadius:o.root.border.radius,overflow:"hidden"},above:{pointerEvents:"none",position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:1},below:{pointerEvents:"none",position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:-1}});L.displayName="ModalDialog";function F({children:o}){const{theme:e}=v(x),t=I(ne,e);return n.jsx(u,{style:t.footer,children:o})}F.__IS_MODAL_FOOTER__=!0;F.isComponentOf=o=>o&&o.type&&o.type.__IS_MODAL_FOOTER__;const ne=o=>({footer:{flex:"0 0 auto",boxSizing:"border-box",minHeight:l.xxxLarge_64,paddingLeft:l.medium_16,paddingRight:l.medium_16,paddingTop:l.xSmall_8,paddingBottom:l.xSmall_8,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",boxShadow:`0px -1px 0px ${o.footer.color.border}`}});function _(o){const{breadcrumbs:e=void 0,light:t,subtitle:s=void 0,testId:r,title:i,titleId:m}=o;if(s&&e)throw new Error("'subtitle' and 'breadcrumbs' can't be used together");const{theme:f}=v(x),a=I(se,f);return n.jsxs(u,{style:[a.header,!t&&a.dark],testId:r,children:[e&&n.jsx(u,{style:a.breadcrumbs,children:e}),n.jsx(Y,{tag:"h2",style:a.title,id:m,testId:r&&`${r}-title`,children:i}),s&&n.jsx(K,{style:t&&a.subtitle,testId:r&&`${r}-subtitle`,children:s})]})}const T="@media (max-width: 767px)",se=o=>({header:{boxShadow:`0px 1px 0px ${o.header.color.border}`,display:"flex",flexDirection:"column",minHeight:66,paddingBlock:o.header.spacing.paddingBlockMd,paddingInline:o.header.spacing.paddingInlineMd,position:"relative",width:"100%",[T]:{paddingInline:o.header.spacing.paddingInlineSm}},dark:{background:o.root.color.inverse.background,color:o.root.color.inverse.foreground},breadcrumbs:{color:o.header.color.secondary,marginBottom:o.header.spacing.gap},title:{paddingRight:o.header.spacing.titleGapMd,[T]:{paddingRight:o.header.spacing.titleGapSm}},subtitle:{color:o.header.color.secondary,marginTop:o.header.spacing.gap}});_.defaultProps={light:!0};const re='button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])';class ie extends c.Component{tryToFocus(e){if(e instanceof HTMLElement){try{e.focus()}catch{}return document.activeElement===e}}focusElementIn(e){const t=this.modalRoot,s=Array.from(t.querySelectorAll(re)),r=e?0:s.length-1,i=s[r];this.tryToFocus(i)}render(){const{style:e}=this.props;return n.jsxs(c.Fragment,{children:[n.jsx("div",{tabIndex:0,className:"modal-focus-trap-first",onFocus:this.handleFocusMoveToLast,style:{position:"fixed"}}),n.jsx(u,{style:e,ref:this.getModalRoot,children:this.props.children}),n.jsx("div",{tabIndex:0,className:"modal-focus-trap-last",onFocus:this.handleFocusMoveToFirst,style:{position:"fixed"}})]})}constructor(...e){super(...e),this.getModalRoot=t=>{if(!t)return;const s=y.findDOMNode(t);if(!s)throw new Error("Assertion error: modal root should exist after mount");this.modalRoot=s},this.handleFocusMoveToLast=()=>{this.focusElementIn(!1)},this.handleFocusMoveToFirst=()=>{this.focusElementIn(!0)}}}const P="data-modal-launcher-portal",de="a[href], details, input, textarea, select, button";function le(o){return Array.from(o.querySelectorAll(de))}class ae extends c.Component{componentDidMount(){const e=y.findDOMNode(this);if(!e)return;const t=this._getInitialFocusElement(e)||this._getFirstFocusableElement(e)||this._getDialogElement(e);setTimeout(()=>{t.focus()},0)}_getInitialFocusElement(e){const{initialFocusId:t}=this.props;return t?y.findDOMNode(e.querySelector(`#${t}`)):null}_getFirstFocusableElement(e){const t=le(e);return t?t[0]:null}_getDialogElement(e){const t=y.findDOMNode(e.querySelector('[role="dialog"]'));return t.tabIndex=-1,t}render(){const{children:e,testId:t}=this.props,s={[P]:!0};return n.jsx(u,{style:this.props.wbThemeStyles.modalPositioner,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,testId:t,...s,children:e})}constructor(...e){super(...e),this._mousePressedOutside=!1,this.handleMouseDown=t=>{this._mousePressedOutside=t.target===t.currentTarget},this.handleMouseUp=t=>{t.target===t.currentTarget&&this._mousePressedOutside&&this.props.onCloseModal(),this._mousePressedOutside=!1}}}const ce=o=>({modalPositioner:{position:"fixed",left:0,top:0,width:"100%",height:"100%",alignItems:"center",justifyContent:"center",overflow:"auto",background:o.backdrop.color.background}});var ue=H(ce,x)(ae);const S=(()=>{if(typeof window>"u")return!1;const o=window.navigator.userAgent;return o.indexOf("iPad")>-1||o.indexOf("iPhone")>-1})();class d extends c.Component{componentDidMount(){if(d.numModalsOpened===0){const e=document.body;if(!e)throw new Error("couldn't find document.body");d.oldOverflow=e.style.overflow,d.oldScrollY=window.scrollY,S&&(d.oldPosition=e.style.position,d.oldWidth=e.style.width,d.oldTop=e.style.top),e.style.overflow="hidden",S&&(e.style.position="fixed",e.style.width="100%",e.style.top=`${-d.oldScrollY}px`)}d.numModalsOpened++}componentWillUnmount(){if(d.numModalsOpened--,d.numModalsOpened===0){const e=document.body;if(!e)throw new Error("couldn't find document.body");e.style.overflow=d.oldOverflow,S&&(e.style.position=d.oldPosition,e.style.width=d.oldWidth,e.style.top=d.oldTop),typeof window<"u"&&window.scrollTo&&window.scrollTo(0,d.oldScrollY)}}render(){return null}}d.numModalsOpened=0;const pe={closeModal:void 0},k=c.createContext(pe);k.displayName="ModalContext";class B extends c.Component{static getDerivedStateFromProps(e,t){return typeof e.opened=="boolean"&&e.children&&console.warn("'children' and 'opened' can't be used together"),typeof e.opened=="boolean"&&!e.onClose&&console.warn("'onClose' should be used with 'opened'"),typeof e.opened!="boolean"&&!e.children&&console.warn("either 'children' or 'opened' must be set"),{opened:typeof e.opened=="boolean"?e.opened:t.opened}}componentDidUpdate(e){!e.opened&&this.props.opened&&this._saveLastElementFocused()}_renderModal(){return typeof this.props.modal=="function"?this.props.modal({closeModal:this.handleCloseModal}):this.props.modal}render(){const e=this.props.children?this.props.children({openModal:this._openModal}):null,{body:t}=document;return t?n.jsxs(k.Provider,{value:{closeModal:this.handleCloseModal},children:[e,this.state.opened&&y.createPortal(n.jsx(ie,{style:me.container,children:n.jsx(ue,{initialFocusId:this.props.initialFocusId,testId:this.props.testId,onCloseModal:this.props.backdropDismissEnabled?this.handleCloseModal:()=>{},children:this._renderModal()})}),t),this.state.opened&&n.jsx(he,{onClose:this.handleCloseModal}),this.state.opened&&n.jsx(d,{})]}):null}constructor(...e){super(...e),this.state={opened:!1},this._saveLastElementFocused=()=>{this.lastElementFocusedOutsideModal=document.activeElement},this._openModal=()=>{this._saveLastElementFocused(),this.setState({opened:!0})},this._returnFocus=()=>{const{closedFocusId:t,schedule:s}=this.props,r=this.lastElementFocusedOutsideModal;if(t){const i=y.findDOMNode(document.getElementById(t));if(i){s.animationFrame(()=>{i.focus()});return}}r!=null&&s.animationFrame(()=>{r.focus()})},this.handleCloseModal=()=>{this.setState({opened:!1},()=>{const{onClose:t}=this.props;t==null||t(),this._returnFocus()})}}}B.defaultProps={backdropDismissEnabled:!0};class he extends c.Component{componentDidMount(){window.addEventListener("keyup",this._handleKeyup)}componentWillUnmount(){window.removeEventListener("keyup",this._handleKeyup)}render(){return null}constructor(...e){super(...e),this._handleKeyup=t=>{t.key==="Escape"&&(t.preventDefault(),t.stopPropagation(),this.props.onClose())}}}const me=j.StyleSheet.create({container:{zIndex:1080}});q(B);function M(o){const{scrollOverflow:e,style:t,children:s}=o,{theme:r}=v(x),i=I(ge,r);return n.jsx(u,{style:[i.wrapper,e&&i.scrollOverflow],children:n.jsx(u,{style:[i.content,t],children:s})})}M.__IS_MODAL_CONTENT__=!0;M.isComponentOf=o=>o&&o.type&&o.type.__IS_MODAL_CONTENT__;const fe="@media (max-width: 767px)",ge=o=>({wrapper:{flex:1,display:"block"},scrollOverflow:{overflow:"auto"},content:{flex:1,minHeight:"100%",padding:l.xLarge_32,boxSizing:"border-box",[fe]:{padding:`${l.xLarge_32}px ${l.medium_16}px`}}});M.defaultProps={scrollOverflow:!0};class xe extends c.Component{render(){const{onClick:e,style:t,testId:s}=this.props;return n.jsx(k.Consumer,{children:({closeModal:r})=>{if(r&&e)throw new Error("You've specified 'onClose' on a modal when using ModalLauncher.  Please specify 'onClose' on the ModalLauncher instead");return n.jsx(G,{icon:V,"aria-label":"Close modal",onClick:e||r,kind:"tertiary",actionType:"neutral",style:t,testId:s})}})}}function D({closeButtonVisible:o=!0,scrollOverflow:e=!0,light:t=!0,content:s,footer:r,header:i,onClose:m,style:f,testId:a}){const{theme:b}=v(x),p=I(ye,b),h=c.useCallback(()=>{const C=M.isComponentOf(s)?s:n.jsx(M,{children:s});return C&&c.cloneElement(C,{scrollOverflow:e,style:[!!r&&p.hasFooter,C.props.style]})},[s,r,e,p.hasFooter])(),w=!t;return n.jsxs(u,{style:[p.wrapper,w&&p.dark,f],testId:a&&`${a}-panel`,children:[o&&n.jsx(xe,{onClick:m,style:[p.closeButton,w&&z.inverse],testId:a&&`${a}-close`}),i,h,!r||F.isComponentOf(r)?r:n.jsx(F,{children:r})]})}D.defaultProps={closeButtonVisible:!0,scrollOverflow:!0,light:!0};const ye=o=>({wrapper:{flex:"1 1 auto",position:"relative",display:"flex",flexDirection:"column",background:"white",boxSizing:"border-box",overflow:"hidden",height:"100%",width:"100%"},closeButton:{position:"absolute",right:o.closeButton.spacing.gap,top:o.closeButton.spacing.gap,zIndex:1,":focus":{...U.focus[":focus-visible"]}},dark:{background:o.root.color.inverse.background,color:o.root.color.inverse.foreground},hasFooter:{paddingBlockEnd:o.panel.spacing.gap}});class be extends c.Component{renderHeader(e){const{title:t,breadcrumbs:s=void 0,subtitle:r=void 0,testId:i}=this.props;return s?n.jsx(_,{title:t,breadcrumbs:s,titleId:e,testId:i&&`${i}-header`}):r?n.jsx(_,{title:t,subtitle:r,titleId:e,testId:i&&`${i}-header`}):n.jsx(_,{title:t,titleId:e,testId:i&&`${i}-header`})}render(){const{onClose:e,footer:t,content:s,above:r,below:i,style:m,closeButtonVisible:f,testId:a,titleId:b,role:p,"aria-describedby":E}=this.props;return n.jsx(J,{styleSheets:we,children:({styles:h})=>n.jsx($,{id:b,children:w=>n.jsx(L,{style:[h.dialog,m],above:r,below:i,testId:a,"aria-labelledby":w,"aria-describedby":E,role:p,children:n.jsx(D,{onClose:e,header:this.renderHeader(w),content:s,footer:t,closeButtonVisible:f,testId:a})})})})}}be.defaultProps={closeButtonVisible:!0};const we={small:j.StyleSheet.create({dialog:{width:"100%",height:"100%",overflow:"hidden"}}),mdOrLarger:j.StyleSheet.create({dialog:{width:"93.75%",maxWidth:576,height:"81.25%",maxHeight:624}})};function Me(o){let e=o&&o.parentElement;for(;e&&!e.hasAttribute(P);)e=e.parentElement;return e}function Te(o){return Me(o)}export{Te as m};
