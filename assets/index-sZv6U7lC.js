import{r as a}from"./index-qhcEwEpg.js";let u=function(i){return i.Immediately="schedule-immediately",i.OnDemand="schedule-on-demand",i}({}),n=function(i){return i.Resolve="resolve-on-clear",i.Cancel="cancel-on-clear",i}({}),I=function(i){return i.Reset="reset",i.Passive="passive",i}({});class _{constructor(e,t,r=u.Immediately){if(this._timeoutId=void 0,this._action=void 0,this._timeoutMs=void 0,typeof e!="function")throw new Error("Action must be a function");if(t<0)throw new Error("Timeout period must be >= 0");this._action=e,this._timeoutMs=t,r===u.Immediately&&this.set()}get isSet(){return this._timeoutId!=null}set(){this.isSet&&this.clear(n.Cancel),this._timeoutId=setTimeout(()=>this.clear(n.Resolve),this._timeoutMs)}clear(e=n.Cancel){const t=this._timeoutId;this._timeoutId=null,t!=null&&(clearTimeout(t),e===n.Resolve&&this._action())}}class y{constructor(e,t,r=u.Immediately){if(this._intervalId=void 0,this._action=void 0,this._intervalMs=void 0,typeof e!="function")throw new Error("Action must be a function");if(t<1)throw new Error("Interval period must be >= 1");this._action=e,this._intervalMs=t,r===u.Immediately&&this.set()}get isSet(){return this._intervalId!=null}set(){this.isSet&&this.clear(n.Cancel),this._intervalId=setInterval(()=>this._action(),this._intervalMs)}clear(e=n.Cancel){const t=this._intervalId;this._intervalId=null,t!=null&&(clearInterval(t),e===n.Resolve&&this._action())}}class w{constructor(e,t=u.Immediately){if(this._animationFrameId=void 0,this._action=void 0,typeof e!="function")throw new Error("Action must be a function");this._action=e,t===u.Immediately&&this.set()}get isSet(){return this._animationFrameId!=null}set(){this.isSet&&this.clear(n.Cancel),this._animationFrameId=requestAnimationFrame(e=>this.clear(n.Resolve,e))}clear(e=n.Cancel,t){const r=this._animationFrameId;this._animationFrameId=null,r!=null&&(cancelAnimationFrame(r),e===n.Resolve&&this._action(t||performance.now()))}}class c{constructor(){this._disabled=!1,this._registeredActions=[]}timeout(e,t,r){if(this._disabled)return c.NoopAction;const s=new _(e,t,r==null?void 0:r.schedulePolicy);return this._registeredActions.push(()=>s.clear(r==null?void 0:r.clearPolicy)),s}interval(e,t,r){if(this._disabled)return c.NoopAction;const s=new y(e,t,r==null?void 0:r.schedulePolicy);return this._registeredActions.push(()=>s.clear(r==null?void 0:r.clearPolicy)),s}animationFrame(e,t){if(this._disabled)return c.NoopAction;const r=new w(e,t==null?void 0:t.schedulePolicy);return this._registeredActions.push(()=>r.clear(t==null?void 0:t.clearPolicy)),r}clearAll(){const e=[...this._registeredActions];this._registeredActions=[],e.forEach(t=>t())}disable(){this._disabled=!0,this.clearAll()}}c.NoopAction={set:()=>{},get isSet(){return!1},clear:()=>{}};class A extends a.Component{constructor(...e){super(...e),this._actionScheduler=new c}componentWillUnmount(){this._actionScheduler.disable()}render(){const{children:e}=this.props;return e(this._actionScheduler)}}function m(){return m=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},m.apply(this,arguments)}function g(i){const e=`withActionScheduler(${i.displayName||i.name})`,t=r=>a.createElement(A,null,s=>a.createElement(i,m({},r,{schedule:s})));return t.displayName=e,t}function R(i,e,t={}){const{actionPolicy:r,clearPolicy:s,schedulePolicy:f}=t,h=a.useRef(i),o=a.useRef(null);if(typeof i!="function")throw new Error("Action must be a function");if(i!==h.current&&(h.current=i,r===I.Reset)){var v;(v=o.current)==null||v.set()}return a.useEffect(()=>(o.current=new _(()=>{h.current==null||h.current()},e,f),()=>{var l;(l=o.current)==null||l.clear(s),o.current=null}),[e,s,f]),a.useMemo(()=>({set:()=>{var l;(l=o.current)==null||l.set()},clear:l=>{var d;(d=o.current)==null||d.clear(l)},get isSet(){var l,d;return(l=(d=o.current)==null?void 0:d.isSet)!=null?l:!1}}),[])}export{R as u,g as w};
