import{j as t,a as h,F as E}from"./jsx-runtime-BGVbfQ2Z.js";import{B as L}from"./article-renderer-IypNbsfe.js";import{_ as o}from"./index-default-4_ZsnO94.js";import{U as w}from"./util-2H85FoUC.js";import{c as z}from"./unit-uxf7imOh.js";import"./dependencies-fnqF3NiV.js";import"./perseus-api-BF68z3pH.js";import"./multi-renderer-Su5KW17I.js";import"./hints-renderer-n6WaJYpu.js";import"./renderer-qN6twphC.js";import"./base-radio-oIB6BXUd.js";import{c as U}from"./components-HqUM7hS5.js";import"./jquery-5v7aFUvu.js";import{i as B}from"./constants-I_nlPaPx.js";import"./i18n-context-9-s9cJ--.js";import{V as S}from"./index-oMd7J_hd.js";import{S as G,O as g}from"./answer-choices-kx7yFjVP.js";import{s as c,c as _}from"./index-lUErx3pE.js";import{l as I}from"./index-awljIyHI.js";import{r as k}from"./index-qhcEwEpg.js";import{b as V}from"./index-B3k62xyQ.js";import{T as F}from"./toggleable-caret-1K5GCJBX.js";const d=b=>{const{children:a,label:e,labelSide:r="left",style:l}=b;return t("label",{className:I.css(R.label),children:h(S,{style:[R.row,l],children:[r==="start"||t(V,{style:R.spaceEnd,children:e}),a,r==="end"&&t(V,{style:R.spaceStart,children:e})]})})},R=I.StyleSheet.create({label:{width:"fit-content"},row:{flexDirection:"row",marginTop:c.xSmall_8,alignItems:"center",width:"fit-content"},spaceStart:{marginInlineStart:c.xSmall_8},spaceEnd:{marginInlineEnd:c.xSmall_8}});try{labeledrow.displayName="labeledrow",labeledrow.__docgenInfo={description:"",displayName:"labeledrow",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},labelSide:{defaultValue:null,description:"",name:"labelSide",required:!1,type:{name:"enum",value:[{value:'"start"'},{value:'"end"'}]}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"any"}}}}}catch{}function q({title:b,isOpen:a,onToggle:e}){return h(S,{style:{flexDirection:"row",justifyContent:"space-between",backgroundColor:_.offBlack8,padding:c.xSmall_8,marginTop:c.small_12,marginInline:-10,cursor:"pointer"},onClick:()=>e==null?void 0:e(!a),children:[t(V,{children:b}),t(F,{isExpanded:a})]})}try{q.displayName="Heading",q.__docgenInfo={description:"",displayName:"Heading",props:{title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},onToggle:{defaultValue:null,description:"",name:"onToggle",required:!1,type:{name:"((isOpen: boolean) => void)"}}}}}catch{}const{ButtonGroup:P,InfoTip:M,PropCheckBox:N,RangeInput:v}=U,$={url:null,width:0,height:0};function H(b,a){return Math.floor((b[1]-b[0])/a)}const y=class y extends k.Component{constructor(a){super(a),this._isMounted=!1,this.bgUrlRef=k.createRef(),this.labelXRef=k.createRef(),this.labelYRef=k.createRef(),this.change=(...e)=>z.apply(this,e),this.changeRulerLabel=e=>{this.change({rulerLabel:e.target.value})},this.changeRulerTicks=e=>{this.change({rulerTicks:+e.target.value})},this.changeBackgroundUrl=e=>{var i;if(e.type==="keypress"&&e.key!=="Enter")return;const r=(p,n,s)=>{const u={...this.props.backgroundImage};u.url=p,u.width=n,u.height=s,this.setState({backgroundImage:u},this.changeGraph)},l=(i=this.bgUrlRef.current)==null?void 0:i.value;l?w.getImageSize(l,(p,n)=>{this._isMounted&&r(l,p,n)}):r(null,0,0)},this.renderLabelChoices=e=>e.map(r=>t("option",{value:r[1],children:r[0]},r[1])),this.validRange=e=>o.every(e,function(l){return o.isFinite(l)})?e[0]>=e[1]?"Range must have a higher number on the right":!0:"Range must be a valid number",this.validateStepValue=e=>{const{step:r,range:l,name:i,minTicks:p,maxTicks:n}=e,s=H(l,r);return s<p?i+" is too large, there must be at least "+p+" ticks.":s>n?i+" is too small, there can be at most "+n+" ticks.":!0},this.validSnapStep=(e,r)=>this.validateStepValue({step:e,range:r,name:"Snap step",minTicks:5,maxTicks:60}),this.validGridStep=(e,r)=>this.validateStepValue({step:e,range:r,name:"Grid step",minTicks:3,maxTicks:60}),this.validStep=(e,r)=>this.validateStepValue({step:e,range:r,name:"Step",minTicks:3,maxTicks:20}),this.validBackgroundImageSize=e=>e.url?e.width<=450&&e.height<=450?!0:"Image must be smaller than 450px x 450px.":!0,this.validateGraphSettings=(e,r,l,i,p)=>{const n=this;let s;if(!o.every(e,function(f){return s=n.validRange(f),s===!0})||!o.every(r,function(f,x){return s=n.validStep(f,e[x]),s===!0})||!o.every(l,function(f,x){return s=n.validGridStep(f,e[x]),s===!0})||!o.every(i,function(f,x){return s=n.validSnapStep(f,e[x]),s===!0}))return s;const C=this.validBackgroundImageSize(p);return C!==!0?(s=C,s):!0},this.changeLabel=(e,r)=>{const l=r.target.value,i=this.state.labelsTextbox.slice();i[e]=l,this.setState({labelsTextbox:i},this.changeGraph)},this.changeRange=(e,r)=>{const l=this.state.rangeTextbox.slice();l[e]=r;const i=this.state.stepTextbox.slice(),p=this.state.gridStepTextbox.slice(),n=this.state.snapStepTextbox.slice(),s=w.scaleFromExtent(l[e],this.props.box[e]);if(this.validRange(l[e])===!0){i[e]=w.tickStepFromExtent(l[e],this.props.box[e]);const u=w.gridStepFromTickStep(i[e],s);u&&(p[e]=u),n[e]=p[e]/2}this.setState({stepTextbox:i,gridStepTextbox:p,snapStepTextbox:n,rangeTextbox:l},this.changeGraph)},this.changeStep=e=>{this.setState({stepTextbox:e},this.changeGraph)},this.changeSnapStep=e=>{this.setState({snapStepTextbox:e},this.changeGraph)},this.changeGridStep=e=>{this.setState({gridStepTextbox:e,snapStepTextbox:o.map(e,function(r){return r/2})},this.changeGraph)},this.changeGraph=()=>{const e=this.state.labelsTextbox,r=o.map(this.state.rangeTextbox,function(u){return o.map(u,Number)}),l=o.map(this.state.stepTextbox,Number),i=this.state.gridStepTextbox,p=this.state.snapStepTextbox,n=this.state.backgroundImage,s=this.validateGraphSettings(r,l,i,p,n);s===!0?this.change({valid:!0,labels:e,range:r,step:l,gridStep:i,snapStep:p,backgroundImage:n}):this.change({valid:s})},this.state={isExpanded:!0,...y.stateFromProps(a)}}static stateFromProps(a){return{labelsTextbox:a.labels,gridStepTextbox:a.gridStep,snapStepTextbox:a.snapStep,stepTextbox:a.step,rangeTextbox:a.range,backgroundImage:{...a.backgroundImage}}}componentDidMount(){this._isMounted=!0,this.changeGraph=o.debounce(this.changeGraph,300)}UNSAFE_componentWillReceiveProps(a){(!o.isEqual(this.props.labels,a.labels)||!o.isEqual(this.props.gridStep,a.gridStep)||!o.isEqual(this.props.snapStep,a.snapStep)||!o.isEqual(this.props.step,a.step)||!o.isEqual(this.props.range,a.range)||!o.isEqual(this.props.backgroundImage,a.backgroundImage))&&this.setState(y.stateFromProps(a))}componentWillUnmount(){this._isMounted=!1}render(){return h(E,{children:[t(q,{title:"Common Graph Settings",isOpen:this.state.isExpanded,onToggle:()=>this.setState({isExpanded:!this.state.isExpanded})}),this.state.isExpanded&&h(S,{children:[h("div",{className:"graph-settings",children:[h("div",{className:"perseus-widget-row",children:[t("div",{className:"perseus-widget-left-col",children:t(d,{label:"x Label",children:t("input",{type:"text",className:"graph-settings-axis-label",ref:this.labelXRef,onChange:a=>this.changeLabel(0,a),value:this.state.labelsTextbox[0]||""})})}),t("div",{className:"perseus-widget-right-col",children:t(d,{label:"y Label",children:t("input",{type:"text",className:"graph-settings-axis-label",ref:this.labelYRef,onChange:a=>this.changeLabel(1,a),value:this.state.labelsTextbox[1]||""})})})]}),h("div",{className:"perseus-widget-row",children:[t("div",{className:"perseus-widget-left-col",children:t(d,{label:"x Range",children:t(v,{value:this.state.rangeTextbox[0],onChange:a=>this.changeRange(0,a)})})}),t("div",{className:"perseus-widget-right-col",children:t(d,{label:"y Range",children:t(v,{value:this.state.rangeTextbox[1],onChange:a=>this.changeRange(1,a)})})})]}),h("div",{className:"perseus-widget-row",children:[t("div",{className:"perseus-widget-left-col",children:t(d,{label:"Tick Step",children:t(v,{value:this.state.stepTextbox,onChange:this.changeStep})})}),t("div",{className:"perseus-widget-right-col",children:t(d,{label:"Grid Step",children:t(v,{value:this.state.gridStepTextbox,onChange:this.changeGridStep})})})]}),t("div",{className:"perseus-widget-row",children:t("div",{className:"perseus-widget-left-col",children:t(d,{label:"Snap Step",children:t(v,{value:this.state.snapStepTextbox,onChange:this.changeSnapStep})})})}),t("div",{className:"perseus-widget-row",children:t(d,{label:"Markings:",children:t(P,{value:this.props.markings,allowEmpty:!1,buttons:[{value:"graph",content:"Graph"},{value:"grid",content:"Grid"},{value:"none",content:"None"}],onChange:this.change("markings")})})}),t("div",{className:"perseus-widget-left-col",children:t(N,{label:"Show tooltips",showTooltips:this.props.showTooltips,onChange:this.change})})]}),h(d,{label:"Background image URL:",style:m.resetSpaceTop,children:[t("input",{type:"text",className:I.css(m.backgroundUrlInput),ref:this.bgUrlRef,value:this.state.backgroundImage.url||"",onChange:a=>{const e={...this.props.backgroundImage};e.url=a.target.value,this.setState({backgroundImage:e})},onKeyPress:this.changeBackgroundUrl,onBlur:this.changeBackgroundUrl}),t(M,{children:t("p",{children:'Create an image in graphie, or use the "Add image" function to create a background.'})})]}),h(S,{style:m.rulerSection,children:[h(S,{style:m.checkboxRow,children:[t(N,{label:"Show ruler",showRuler:this.props.showRuler,onChange:this.change,style:m.resetSpaceTop}),t(N,{label:"Show protractor",showProtractor:this.props.showProtractor,onChange:this.change,style:m.resetSpaceTop})]}),(this.props.showRuler||this.props.showProtractor)&&t(L,{layout:"floating",text:"The ruler and protractor are not accessible. Please consider an alternate approach.",kind:"warning"}),this.props.showRuler&&h(S,{style:m.spaceTop,children:[t(d,{label:"Ruler label:",style:m.resetSpaceTop,children:h(G,{id:"ruler-label-select",selectedValue:this.props.rulerLabel,onChange:a=>{this.change({rulerLabel:a})},placeholder:"None",style:m.singleSelectShort,children:[t(g,{value:"",label:"None",horizontalRule:"full-width"}),t(g,{value:"mm",label:"Milimeters"}),t(g,{value:"cm",label:"Centimeters"}),t(g,{value:"m",label:"Meters"}),t(g,{value:"km",label:"Kilometers",horizontalRule:"full-width"}),t(g,{value:"in",label:"Inches"}),t(g,{value:"ft",label:"Feet"}),t(g,{value:"yd",label:"Yards"}),t(g,{value:"mi",label:"Miles"})]})}),t(d,{label:"Ruler ticks:",children:t(G,{id:"ruler-ticks-select",selectedValue:`${this.props.rulerTicks}`,onChange:a=>{this.change({rulerTicks:a})},placeholder:"10",style:m.singleSelectShort,children:[1,2,4,8,10,16].map(a=>t(g,{value:`${a}`,label:`${a}`},a))})})]})]})]})]})}};y.defaultProps={box:[B.defaultBoxSizeSmall,B.defaultBoxSizeSmall],labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],gridStep:[1,1],snapStep:[1,1],valid:!0,backgroundImage:$,markings:"graph",showProtractor:!1,showRuler:!1,showTooltips:!1,rulerLabel:"",rulerTicks:10};let T=y;const m=I.StyleSheet.create({resetSpaceTop:{marginTop:0},spaceTop:{marginTop:c.xSmall_8},singleSelectShort:{height:26},backgroundUrlInput:{border:`1px solid ${_.offBlack32}`,borderRadius:c.xxxSmall_4,padding:c.xxxSmall_4},checkboxRow:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:c.xSmall_8},rulerSection:{marginTop:c.xSmall_8,borderTop:`1px solid ${_.offBlack16}`,paddingTop:c.xSmall_8,paddingBottom:c.xSmall_8,borderBottom:`1px solid ${_.offBlack16}`}}),ge=T;try{T.displayName="InteractiveGraphSettings",T.__docgenInfo={description:"",displayName:"InteractiveGraphSettings",props:{box:{defaultValue:{value:`[
            interactiveSizes.defaultBoxSizeSmall,
            interactiveSizes.defaultBoxSizeSmall,
        ]`},description:"The size of the graph area in pixels.",name:"box",required:!1,type:{name:"[x: number, y: number]"}},labels:{defaultValue:{value:'["x", "y"]'},description:"The labels for the x and y axes.",name:"labels",required:!1,type:{name:"readonly string[]"}},range:{defaultValue:{value:`[
            [-10, 10],
            [-10, 10],
        ]`},description:"The range of the graph.",name:"range",required:!1,type:{name:"[x: Range, y: Range]"}},step:{defaultValue:{value:"[1, 1]"},description:`How far apart the tick marks on the axes are in the x and y
directions.`,name:"step",required:!1,type:{name:"[x: number, y: number]"}},gridStep:{defaultValue:{value:"[1, 1]"},description:"How far apart the grid lines are in the x and y directions.",name:"gridStep",required:!1,type:{name:"[x: number, y: number]"}},snapStep:{defaultValue:{value:"[1, 1]"},description:"How far apart the snap-to points are in the x and y directions.",name:"snapStep",required:!1,type:{name:"[x: number, y: number]"}},valid:{defaultValue:{value:"true"},description:`An error message to display in the graph area, or true if the
graph is valid.`,name:"valid",required:!1,type:{name:"string | boolean"}},backgroundImage:{defaultValue:{value:`{
    url: null,
    width: 0,
    height: 0,
} as const`},description:"The background image to display in the graph area and its properties.",name:"backgroundImage",required:!1,type:{name:"PerseusImageBackground"}},markings:{defaultValue:{value:"graph"},description:`The type of markings to display on the graph.
- graph: shows the axes and the grid lines
- grid: shows only the grid lines
- none: shows no markings`,name:"markings",required:!1,type:{name:"enum",value:[{value:'"graph"'},{value:'"grid"'},{value:'"none"'}]}},showProtractor:{defaultValue:{value:"false"},description:"Whether to show the protractor on the graph.",name:"showProtractor",required:!1,type:{name:"boolean"}},showRuler:{defaultValue:{value:"false"},description:"Whether to show the ruler on the graph.",name:"showRuler",required:!1,type:{name:"boolean"}},showTooltips:{defaultValue:{value:"false"},description:"Whether to show tooltips on the graph.",name:"showTooltips",required:!1,type:{name:"boolean"}},rulerLabel:{defaultValue:{value:""},description:"The label to display on the ruler, if any.",name:"rulerLabel",required:!1,type:{name:"string"}},rulerTicks:{defaultValue:{value:"10"},description:"The number of ticks to display on the ruler.",name:"rulerTicks",required:!1,type:{name:"number"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(arg1: Partial<Props>) => void"}}}}}catch{}export{ge as I,d as L};
