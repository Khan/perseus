var m=Object.defineProperty;var d=(o,n,t)=>n in o?m(o,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[n]=t;var r=(o,n,t)=>(d(o,typeof n!="symbol"?n+"":n,t),t);import{j as c}from"./jsx-runtime-BT65X5dW.js";import{$ as y}from"./jquery-CkHB0_Mt.js";import{P as u}from"./index-CrGd2QqM.js";import{r as g}from"./index-C6mWTJJr.js";import{h as p}from"./index-B1Gws05u.js";import{_ as l}from"./underscore-U-AHniOr.js";const f={};function v(o){if(!f[o]){const n=y("<span>").text(o).appendTo("body");f[o]=n.width()+5,n.remove()}return f[o]}class h extends g.Component{constructor(){super(...arguments);r(this,"state",{items:this.props.options.concat("")});r(this,"onChange",(t,i)=>{let s=l.clone(this.state.items);s[t]=i.target.value,t===s.length-1&&(s=s.concat("")),this.setState({items:s}),this.props.onChange(l.compact(s))});r(this,"onKeyDown",(t,i)=>{const s=i.nativeEvent.keyCode;if(s===8&&this.state.items[t]===""){i.preventDefault();const e=l.clone(this.state.items),a=t===0?0:t-1;t===e.length-1&&(t===0||e[a]!=="")?p.findDOMNode(this.refs["input_"+a]).focus():(e.splice(t,1),this.setState({items:e},function(){p.findDOMNode(this.refs["input_"+a]).focus()}))}else if(s===8&&this.state.items[t].length===1&&t===this.state.items.length-2){i.preventDefault();const e=l.clone(this.state.items);e.splice(t,1),this.setState({items:e}),this.props.onChange(l.compact(e))}else if(s===13){i.preventDefault();const e=l.clone(this.state.items),a=t+1;t===e.length-2?p.findDOMNode(this.refs["input_"+a]).focus():(e.splice(a,0,""),this.setState({items:e},function(){p.findDOMNode(this.refs["input_"+a]).focus()}))}})}UNSAFE_componentWillReceiveProps(t){this.setState({items:t.options.concat("")})}render(){const t=["perseus-text-list-editor","perseus-clearfix","layout-"+this.props.layout].join(" "),i=l.map(this.state.items,function(s,e){return c.jsx("li",{children:c.jsx("input",{ref:"input_"+e,type:"text",value:s,onChange:this.onChange.bind(this,e),onKeyDown:this.onKeyDown.bind(this,e),style:{width:v(s)}})},e)},this);return c.jsx("ul",{className:t,children:i})}}r(h,"propTypes",{options:u.array,layout:u.oneOf(["horizontal","vertical"]),onChange:u.func.isRequired}),r(h,"defaultProps",{options:[],layout:"horizontal"});h.__docgenInfo={description:"",methods:[{name:"onChange",docblock:null,modifiers:[],params:[{name:"index",optional:!1,type:null},{name:"event",optional:!1,type:null}],returns:null},{name:"onKeyDown",docblock:null,modifiers:[],params:[{name:"index",optional:!1,type:null},{name:"event",optional:!1,type:null}],returns:null}],displayName:"TextListEditor",props:{options:{defaultValue:{value:"[]",computed:!1},description:"",type:{name:"array"},required:!1},layout:{defaultValue:{value:'"horizontal"',computed:!1},description:"",type:{name:"enum",value:[{value:'"horizontal"',computed:!1},{value:'"vertical"',computed:!1}]},required:!1},onChange:{description:"",type:{name:"func"},required:!0}}};export{h as T};
