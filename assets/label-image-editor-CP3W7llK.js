var ue=Object.defineProperty;var pe=(i,l,e)=>l in i?ue(i,l,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[l]=e;var d=(i,l,e)=>pe(i,typeof l!="symbol"?l+"":l,e);import{r as g,j as n,n as s,o as M,c4 as I,ag as me,w as he,U as Z,ao as ge,c5 as fe}from"./iframe-4uQEbDMh.js";import"./item-version-DatYEWf7.js";import"./article-renderer-DhVQGZs3.js";import"./server-item-renderer-DGa6cRBh.js";import"./hints-renderer-B1AYVrGg.js";import{E as ye}from"./editor-jsonify-YmxYUrj2.js";import{c as ee}from"./components-BeSkLA48.js";const Q="#FAFAFA",J="#F0F1F2",we="#D6D8DA",be="#BABEC2",ne="#888D93",O="#626569",k="#21242C";class ke extends g.Component{constructor(){super(...arguments);d(this,"state",{focused:!1});d(this,"handleBlur",e=>{const{onBlur:t}=this.props;t==null||t(e),this.setState({focused:!1})});d(this,"handleFocus",e=>{const{onFocus:t}=this.props;t==null||t(e),this.setState({focused:!0})});d(this,"disableDefault",e=>{e.preventDefault()})}render(){const{forwardedRef:e,width:t,grow:a,shrink:r,icon:o,backgroundColor:c,focusBorderColor:m,borderColor:u,color:p,onSubmit:h,leftSideIcon:S,id:N,testId:y,type:j,labelMediumInputText:U,...H}=this.props,{focused:E}=this.state,v={},G=[T.input,T.container];t&&(v.width=t),a&&(v.flexGrow=a===!0?1:a),(r||r===0)&&(v.flexShrink=r===!0?0:r),c?v.backgroundColor=c:G.push(T.defaultBackground),p&&(v.color=p);const de=E?m||M.blue:u||M.offBlack16;v.border=`1px solid ${de}`;const K=o&&n.jsx("span",{className:s.css(T.icon),children:o}),ce=U?T.labelMediumInputBase:T.inputBase;return n.jsxs("form",{className:s.css(...G),style:v,onSubmit:h||this.disableDefault,children:[S&&K,n.jsx("input",{...H,onFocus:this.handleFocus,onBlur:this.handleBlur,type:j,className:s.css(ce),ref:e,id:N,"data-testid":y}),!S&&K]})}}const T=s.StyleSheet.create({inputBase:{background:"inherit",border:"none",fontFamily:"inherit",fontSize:15,lineHeight:"22px",outline:"none","::placeholder":{color:O},width:"100%",color:"inherit",marginBottom:0,paddingLeft:0,boxShadow:"none",padding:0,margin:0},labelMediumInputBase:{background:"inherit",border:"none",outline:"none","::placeholder":{color:O},width:"100%",fontWeight:"normal",fontFamily:"Lato, san-serif",fontSize:"16px",lineHeight:"20px"},input:{height:40,borderRadius:4,boxSizing:"border-box",padding:"8px 10px"},container:{display:"inline-flex",alignItems:"center",marginBottom:0},defaultBackground:{backgroundColor:M.white},icon:{display:"flex",alignItems:"center",justifyContent:"center"}}),W=g.forwardRef((i,l)=>n.jsx(ke,{...i,forwardedRef:l})),X="javascript:void(0)";class D extends g.Component{render(){const{children:l,className:e,highlighted:t,href:a,inlineStyles:r,referrer:o,style:c,target:m,testId:u,element:p,...h}=this.props,[S,N]=a?a.split("#"):[X];let y=S;o&&(y.indexOf("?")>-1?y+="&ref="+o:y+="?ref="+o),N&&(y+="#"+N);const j=[Y.link,t&&Y.highlighted];Array.isArray(c)?j.push(...c):j.push(c);const U=e?" "+e:"",H=p==="a"?{href:y}:{to:y};let E=h.rel;return m==="_blank"&&!E&&(E="noopener noreferrer"),g.createElement(p,{"data-testid":u,...h,...H,className:s.css(...j)+U,style:r,target:m,rel:E},l)}}d(D,"defaultProps",{highlighted:!1,href:X,style:[],element:"a"});const Y=s.StyleSheet.create({link:{backgroundColor:"transparent",color:"inherit",textDecoration:"none",":hover":{textDecoration:"underline"}},highlighted:{textDecoration:"underline"}});D.__docgenInfo={description:"A wrapper that creates an anchor tag with normalized styles",methods:[],displayName:"Link",props:{element:{required:!1,tsType:{name:"ReactElementType",raw:"React.ElementType"},description:"",defaultValue:{value:'"a"',computed:!1}},highlighted:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},href:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'"javascript:void(0)"',computed:!1}},style:{required:!1,tsType:{name:"union",raw:"CSSProperties | Array<CSSProperties>",elements:[{name:"CSSProperties"},{name:"Array",elements:[{name:"CSSProperties"}],raw:"Array<CSSProperties>"}]},description:"",defaultValue:{value:"[]",computed:!1}},children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},className:{required:!1,tsType:{name:"string"},description:""},inlineStyles:{required:!1,tsType:{name:"signature",type:"object",raw:`{
    [key: string]: any;
}`,signature:{properties:[{key:{name:"string"},value:{name:"any",required:!0}}]}},description:""},referrer:{required:!1,tsType:{name:"string"},description:""},target:{required:!1,tsType:{name:"string"},description:""},rel:{required:!1,tsType:{name:"string"},description:""},testId:{required:!1,tsType:{name:"string"},description:""},onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: React.MouseEvent) => unknown",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent"},name:"e"}],return:{name:"unknown"}}},description:""},onMouseOver:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: React.MouseEvent) => unknown",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent"},name:"e"}],return:{name:"unknown"}}},description:""},onMouseLeave:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: React.MouseEvent) => unknown",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent"},name:"e"}],return:{name:"unknown"}}},description:""},onMouseEnter:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: React.MouseEvent) => unknown",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent"},name:"e"}],return:{name:"unknown"}}},description:""},onBlur:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: React.SyntheticEvent) => unknown",signature:{arguments:[{type:{name:"ReactSyntheticEvent",raw:"React.SyntheticEvent"},name:"e"}],return:{name:"unknown"}}},description:""},onFocus:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: React.SyntheticEvent) => unknown",signature:{arguments:[{type:{name:"ReactSyntheticEvent",raw:"React.SyntheticEvent"},name:"e"}],return:{name:"unknown"}}},description:""},onKeyDown:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: React.KeyboardEvent) => unknown",signature:{arguments:[{type:{name:"ReactKeyboardEvent",raw:"React.KeyboardEvent"},name:"e"}],return:{name:"unknown"}}},description:""},"aria-label":{required:!1,tsType:{name:"string"},description:""},"aria-selected":{required:!1,tsType:{name:"boolean"},description:""},"aria-current":{required:!1,tsType:{name:"boolean"},description:""},role:{required:!1,tsType:{name:"literal",value:'"tab"'},description:""},title:{required:!1,tsType:{name:"string"},description:""},id:{required:!1,tsType:{name:"string"},description:""},tabIndex:{required:!1,tsType:{name:"number"},description:""}}};const{Icon:te}=ee,ve={path:"M11 11V7a1 1 0 0 1 2 0v4h4a1 1 0 0 1 0 2h-4v4a1 1 0 0 1-2 0v-4H7a1 1 0 0 1 0-2h4zm1 13C5.373 24 0 18.627 0 12S5.373 0 12 0s12 5.373 12 12-5.373 12-12 12zm0-2c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z",width:24,height:24},xe={path:"M12 24C5.373 24 0 18.627 0 12S5.373 0 12 0s12 5.373 12 12-5.373 12-12 12zm0-2c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10zm-5-9a1 1 0 0 1 0-2h10a1 1 0 0 1 0 2H7z",width:24,height:24},Ce=()=>n.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",children:[n.jsxs("filter",{id:"draggable-grip-shadow",width:"112.5%",height:"116.7%",x:"-6.2%",y:"-8.3%",filterUnits:"objectBoundingBox",children:[n.jsx("feGaussianBlur",{in:"SourceAlpha",stdDeviation:".5",result:"shadowBlurInner"}),n.jsx("feOffset",{in:"shadowBlurInner",dy:"1",result:"shadowOffsetInner"}),n.jsx("feComposite",{in:"shadowOffsetInner",in2:"SourceAlpha",k2:"-1",k3:"1",operator:"arithmetic",result:"shadowInnerInner"}),n.jsx("feColorMatrix",{in:"shadowInnerInner",values:"0 0 0 0 0.129411765 0 0 0 0 0.141176471 0 0 0 0 0.17254902 0 0 0 0.2 0"})]}),n.jsx("path",{d:"M1 4a1 1 0 1 1 0-2h14a1 1 0 0 1 0 2H1zm0 10a1 1 0 0 1 0-2h14a1 1 0 0 1 0 2H1zm0-5a1 1 0 1 1 0-2h14a1 1 0 0 1 0 2H1z",fill:k,filter:"url(#draggable-grip-shadow)"})]}),Se=({onClick:i})=>n.jsxs(D,{className:s.css(b.addAnswer,Re.addAnswer),onClick:i,children:[n.jsx(te,{icon:ve,size:24}),n.jsx("div",{className:s.css(b.spacer)}),"Add an answer choice"]}),Te=({answer:i,onChange:l,onRemove:e})=>n.jsxs("li",{className:s.css(b.answer),children:[n.jsx(D,{onClick:e,children:n.jsx(te,{icon:xe,size:24,color:"#D92916"})}),n.jsx("div",{className:s.css(b.spacer)}),n.jsx(W,{grow:1,onChange:t=>l(t.target.value),value:i}),n.jsx("div",{className:s.css(b.spacer)}),n.jsx(D,{style:[b.disabled],title:"Answer reordering is not implemented.",children:n.jsx(Ce,{})})]}),se=({choices:i,onChange:l})=>n.jsxs("div",{children:[n.jsx("div",{className:s.css(b.title),children:"Answer Choices"}),n.jsx("ul",{className:s.css(b.answers),children:i.map((e,t)=>n.jsx(Te,{answer:e,onChange:a=>l([...i.slice(0,t),a,...i.slice(t+1)]),onRemove:()=>l([...i.slice(0,t),...i.slice(t+1)])},t))}),n.jsx(Se,{onClick:()=>l([...i,""])})]}),b=s.StyleSheet.create({title:{...I,marginBottom:6,color:k},answers:{marginTop:12,marginBottom:12},answer:{display:"flex",flexDirection:"row",alignItems:"center",":not(:first-child)":{marginTop:12}},addAnswer:{...I,display:"flex",flexDirection:"row",alignItems:"center",color:"#1865f2"},spacer:{width:16},disabled:{cursor:"not-allowed"}}),Re=s.StyleSheet.create({addAnswer:{":link":{color:"#1865f2"}}});se.__docgenInfo={description:"The list of choices, handles adding, removing and reording of answers.",methods:[],displayName:"AnswerChoices",props:{choices:{required:!0,tsType:{name:"ReadonlyArray",elements:[{name:"string"}],raw:"ReadonlyArray<string>"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(choices: ReadonlyArray<string>) => void",signature:{arguments:[{type:{name:"ReadonlyArray",elements:[{name:"string"}],raw:"ReadonlyArray<string>"},name:"choices"}],return:{name:"void"}}},description:""}}};class V extends g.Component{constructor(e){super(e);d(this,"focusFlag");d(this,"waitingForClick");d(this,"handleClick",e=>{this.props.disabled||(this.props.shouldUpdate()&&(this.waitingForClick=!1),this.props.onClick&&!this.props.disabled&&this.props.onClick(e))});d(this,"handleMouseEnter",()=>{!this.props.disabled&&this.props.shouldUpdate()&&!this.waitingForClick&&this.setState({hovered:!0})});d(this,"handleMouseLeave",()=>{!this.props.disabled&&this.props.shouldUpdate()&&!this.waitingForClick&&this.setState({hovered:!1})});d(this,"handleTouchStart",()=>{!this.props.disabled&&this.props.shouldUpdate()&&this.setState({hovered:!0})});d(this,"handleTouchEnd",()=>{!this.props.disabled&&this.props.shouldUpdate()&&(this.setState({hovered:!1}),this.waitingForClick=!0)});d(this,"handleMouseDown",()=>{!this.props.disabled&&this.props.shouldUpdate()&&(this.setState({focused:!1}),this.focusFlag=!0)});d(this,"handleBlur",()=>{!this.props.disabled&&this.props.shouldUpdate()&&this.setState({focused:!1})});d(this,"handleFocus",()=>{!this.props.disabled&&this.props.shouldUpdate()&&(this.focusFlag?this.focusFlag=!1:this.setState({focused:!0}))});this.state={focused:!1,hovered:e.startHovered}}render(){const e={onBlur:this.handleBlur,onClick:this.handleClick,onFocus:this.handleFocus,onMouseDown:this.handleMouseDown,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd},{children:t}=this.props;return(t==null?void 0:t(this.state,e))||null}}d(V,"defaultProps",{startHovered:!1,shouldUpdate:()=>!0});V.__docgenInfo={description:"",methods:[{name:"handleClick",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:{name:"ReactMouseEvent",raw:"React.MouseEvent",alias:"React.MouseEvent"}}],returns:null},{name:"handleMouseEnter",docblock:null,modifiers:[],params:[],returns:null},{name:"handleMouseLeave",docblock:null,modifiers:[],params:[],returns:null},{name:"handleTouchStart",docblock:null,modifiers:[],params:[],returns:null},{name:"handleTouchEnd",docblock:null,modifiers:[],params:[],returns:null},{name:"handleMouseDown",docblock:null,modifiers:[],params:[],returns:null},{name:"handleBlur",docblock:null,modifiers:[],params:[],returns:null},{name:"handleFocus",docblock:null,modifiers:[],params:[],returns:null}],displayName:"HoverBehavior",props:{children:{required:!1,tsType:{name:"signature",type:"function",raw:"(state: State, handlers: Handlers) => React.ReactElement",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
    focused: boolean;
    hovered: boolean;
}`,signature:{properties:[{key:"focused",value:{name:"boolean",required:!0}},{key:"hovered",value:{name:"boolean",required:!0}}]}},name:"state"},{type:{name:"signature",type:"object",raw:`{
    onBlur: () => unknown;
    onClick: (e: React.MouseEvent) => unknown;
    onFocus: () => unknown;
    onMouseDown: () => unknown;
    onMouseEnter: () => unknown;
    onMouseLeave: () => unknown;
    onTouchStart: () => unknown;
    onTouchEnd: () => unknown;
}`,signature:{properties:[{key:"onBlur",value:{name:"signature",type:"function",raw:"() => unknown",signature:{arguments:[],return:{name:"unknown"}},required:!0}},{key:"onClick",value:{name:"signature",type:"function",raw:"(e: React.MouseEvent) => unknown",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent"},name:"e"}],return:{name:"unknown"}},required:!0}},{key:"onFocus",value:{name:"signature",type:"function",raw:"() => unknown",signature:{arguments:[],return:{name:"unknown"}},required:!0}},{key:"onMouseDown",value:{name:"signature",type:"function",raw:"() => unknown",signature:{arguments:[],return:{name:"unknown"}},required:!0}},{key:"onMouseEnter",value:{name:"signature",type:"function",raw:"() => unknown",signature:{arguments:[],return:{name:"unknown"}},required:!0}},{key:"onMouseLeave",value:{name:"signature",type:"function",raw:"() => unknown",signature:{arguments:[],return:{name:"unknown"}},required:!0}},{key:"onTouchStart",value:{name:"signature",type:"function",raw:"() => unknown",signature:{arguments:[],return:{name:"unknown"}},required:!0}},{key:"onTouchEnd",value:{name:"signature",type:"function",raw:"() => unknown",signature:{arguments:[],return:{name:"unknown"}},required:!0}}]}},name:"handlers"}],return:{name:"ReactReactElement",raw:"React.ReactElement"}}},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: React.MouseEvent) => unknown",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent"},name:"e"}],return:{name:"unknown"}}},description:""},startHovered:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},shouldUpdate:{required:!1,tsType:{name:"signature",type:"function",raw:"() => boolean",signature:{arguments:[],return:{name:"boolean"}}},description:"",defaultValue:{value:"() => true",computed:!1}}}};const P=4,qe=i=>{};class _ extends g.Component{render(){const{checked:l,disabled:e,appearDisabled:t,onChange:a,tabIndex:r,style:o,dataTestId:c,id:m}=this.props,u=O;return n.jsx(V,{children:({focused:p},h)=>n.jsxs("div",{...h,className:s.css(R.container,p&&R.focused),style:o,"data-testid":c,"data-checked":l,children:[n.jsx("svg",{className:s.css(R.svg,(e||t)&&R.disabled),width:q,height:q,viewBox:`-${w} -${w}
                         ${q} ${q}`,children:n.jsxs("g",{fill:"none",fillRule:"evenodd",children:[l&&n.jsxs("g",{children:[n.jsx("rect",{fill:u,width:C,height:C,x:"0",y:"0",rx:P}),n.jsx("path",{fill:M.white,stroke:M.white,d:`M4.98 7.41a0.58.58 0 1 0-0.81.81L6.47
                                 10.53c0.23.23.59.23.81
                                 0l4.55-4.55a0.58.58 0 0
                                 0-0.81-0.81L6.88 9.31 4.98 7.41z`})]}),!l&&n.jsx("rect",{fill:M.white,stroke:ne,width:C-2*w,height:C-2*w,x:w,y:w,rx:"4",strokeWidth:Me})]})}),n.jsx("input",{type:"checkbox",id:m,checked:l,className:s.css(R.checkbox,e&&R.defaultCursor),disabled:e,onChange:a,tabIndex:r})]})})}}d(_,"defaultProps",{checked:!1,onChange:qe});const C=16,w=.5,Me=1,q=C+2*w,R=s.StyleSheet.create({container:{position:"relative",display:"inline-block",verticalAlign:"middle",lineHeight:0,borderRadius:P,width:q,height:q,flexShrink:0},focused:{"::before":{content:'""',position:"absolute",top:-2,right:-2,bottom:-2,left:-2,borderRadius:P+2,backgroundColor:"lightblue"}},svg:{position:"absolute",left:0,top:0},checkbox:{appearance:"none",opacity:0,position:"absolute",top:w,width:C,height:C,margin:0,outline:"none",cursor:"pointer"},disabled:{opacity:.5},defaultCursor:{cursor:"default"}});_.__docgenInfo={description:"",methods:[],displayName:"Checkbox",props:{checked:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},disabled:{required:!1,tsType:{name:"boolean"},description:""},appearDisabled:{required:!1,tsType:{name:"boolean"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(event: React.ChangeEvent<HTMLInputElement>) => void",signature:{arguments:[{type:{name:"ReactChangeEvent",raw:"React.ChangeEvent<HTMLInputElement>",elements:[{name:"HTMLInputElement"}]},name:"event"}],return:{name:"void"}}},description:"",defaultValue:{value:"(event: React.ChangeEvent<HTMLInputElement>) => {}",computed:!1}},tabIndex:{required:!1,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:""},style:{required:!1,tsType:{name:"signature",type:"object",raw:`{
    marginTop: number;
}`,signature:{properties:[{key:"marginTop",value:{name:"number",required:!0}}]}},description:""},dataTestId:{required:!1,tsType:{name:"string"},description:""},id:{required:!1,tsType:{name:"string"},description:""}}};const ae=({multipleAnswers:i,hideChoicesFromInstructions:l,onChange:e})=>n.jsxs("div",{children:[n.jsx("div",{className:s.css(A.title),children:"Behavior"}),n.jsxs("ul",{children:[n.jsxs("li",{className:s.css(A.option),children:[n.jsx(_,{checked:i,onChange:()=>e({multipleAnswers:!i})}),n.jsx("span",{className:s.css(A.label),children:"Allow multiple answers per marker"})]}),n.jsxs("li",{className:s.css(A.option),children:[n.jsx(_,{checked:l,onChange:()=>e({hideChoicesFromInstructions:!l})}),n.jsx("span",{className:s.css(A.label),children:"Do not display answer choices in instructions"})]})]})]}),A=s.StyleSheet.create({title:{...I,marginBottom:6,color:k},option:{display:"flex",padding:"6px 0"},label:{fontFamily:"inherit",fontSize:15,lineHeight:1.25,marginLeft:16,color:k}});ae.__docgenInfo={description:"",methods:[],displayName:"Behavior",props:{multipleAnswers:{required:!0,tsType:{name:"boolean"},description:""},hideChoicesFromInstructions:{required:!0,tsType:{name:"boolean"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:`(options: {
    multipleAnswers?: boolean;
    hideChoicesFromInstructions?: boolean;
}) => void`,signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
    multipleAnswers?: boolean;
    hideChoicesFromInstructions?: boolean;
}`,signature:{properties:[{key:"multipleAnswers",value:{name:"boolean",required:!1}},{key:"hideChoicesFromInstructions",value:{name:"boolean",required:!1}}]}},name:"options"}],return:{name:"void"}}},description:""}}};function je(i){i.focus({preventScroll:!0})}const{Icon:Ee}=ee,Ae=i=>{const e=me.findDOMNode(i);e.focus&&je(e)},Ie=`M10,3.8C10,4,9.9,4.2,9.8,4.3L5.1,8.9L4.3,9.8C4.2,9.9,4,10,3.8,10
 S3.5,9.9,3.4,9.8L2.5,8.9L0.2,6.6C0.1,6.5,0,6.3,0,6.2s0.1-0.3,0.2-0.4
 l0.9-0.9c0.1-0.1,0.3-0.2,0.4-0.2s0.3,0.1,0.4,0.2l1.9,1.9l4.2-4.2c0.1
 -0.1,0.3-0.2,0.4-0.2c0.2,0,0.3,0.1,0.4,0.2l0.9,0.9C9.9,3.5,10,3.7,
 10,3.8z`,De=30;class z extends g.Component{constructor(){super(...arguments);d(this,"node")}handleKeyDown(e){const{onDropdownClose:t}=this.props,a=e.key,r=e.target;a==="ArrowDown"&&r.nextSibling&&(e.preventDefault(),r.nextSibling.focus()),a==="ArrowUp"&&r.previousSibling&&(e.preventDefault(),r.previousSibling.focus()),a==="ArrowUp"&&!r.previousSibling&&t&&(e.preventDefault(),t()),(a==="Escape"||a==="Tab")&&t&&t()}render(){const{selected:e,value:t,onClick:a,children:r,disabled:o,hideFocusState:c,testId:m,ariaLabel:u}=this.props;return n.jsx("button",{ref:p=>this.node=p,value:t,role:"menuitemradio","aria-checked":e,className:s.css(f.notAButton,o&&f.cursorDefault,c&&f.noFocus),onClick:p=>{!o&&a&&a(p)},onKeyDown:p=>this.handleKeyDown(p),"aria-disabled":o,"aria-label":u,"data-testid":m,children:n.jsxs("span",{className:s.css(f.option,e&&f.optionSelected,o&&f.optionDisabled),children:[r,e&&n.jsx("span",{className:s.css(f.check),children:n.jsx(Ee,{icon:Ie})})]})})}}class re extends g.Component{constructor(){super(...arguments);d(this,"focusedElement")}componentDidMount(){this.focusedElement&&Ae(this.focusedElement)}render(){const{children:e,onSelected:t,selectedValues:a,noMargin:r,onDropdownClose:o,hideFocusState:c}=this.props;return n.jsx("div",{style:{top},className:s.css(f.optionGroup,r&&f.optionGroupNoMargin),children:g.Children.map(e,(m,u)=>{const p=a.includes(m.props.value),h=p||u===0?S=>this.focusedElement=S:null;return g.cloneElement(m,{...m.props,key:u,selected:p,onClick:()=>t(m.props.value),ref:h,onDropdownClose:o,hideFocusState:c})})})}}const f=s.StyleSheet.create({optionGroup:{margin:"4px 0"},optionGroupNoMargin:{margin:0},option:{display:"flex",flexDirection:"row",alignItems:"center",paddingLeft:32,paddingRight:32,height:De,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:k,userSelect:"none",":hover":{backgroundColor:J}},optionSelected:{backgroundColor:J,color:"#11ACCD"},optionDisabled:{color:be,":hover":{backgroundColor:"transparent"}},check:{position:"absolute",left:11},notAButton:{backgroundColor:"transparent",border:"none",display:"block",padding:0,margin:0,width:"100%",font:"inherit"},noFocus:{outline:"none"},cursorDefault:{cursor:"default"}});re.__docgenInfo={description:"",methods:[],displayName:"OptionGroup",props:{onSelected:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},children:{required:!1,tsType:{name:"Array",elements:[{name:"ReactReactElement",raw:"React.ReactElement<React.ComponentProps<typeof Option>>",elements:[{name:"ReactComponentProps",raw:"React.ComponentProps<typeof Option>",elements:[{name:"Option"}]}]}],raw:"Array<React.ReactElement<React.ComponentProps<typeof Option>>>"},description:""},selectedValues:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"Array<string>"},description:""},noMargin:{required:!1,tsType:{name:"boolean"},description:""},onDropdownClose:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},hideFocusState:{required:!1,tsType:{name:"boolean"},description:""}}};z.__docgenInfo={description:"",methods:[{name:"handleKeyDown",docblock:null,modifiers:[],params:[{name:"event",optional:!1,type:{name:"any"}}],returns:{type:{name:"void"}}}],displayName:"Option",props:{value:{required:!0,tsType:{name:"string"},description:""},children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},selected:{required:!1,tsType:{name:"boolean"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onDropdownClose:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},hideFocusState:{required:!1,tsType:{name:"boolean"},description:""},testId:{required:!1,tsType:{name:"string"},description:""},ariaLabel:{required:!1,tsType:{name:"string"},description:""}}};class oe extends g.Component{constructor(e){super(e);d(this,"_marker");d(this,"handleClick",e=>{const{showDropdown:t}=this.state;this._marker===e.target?this.setState({showDropdown:!t}):t&&this._marker&&!this._marker.contains(e.target)&&(e.stopPropagation(),this.setState({showDropdown:!1}))});d(this,"handleLabelChange",e=>{this.updateMarker({label:e.target.value})});d(this,"handleSelectAnswer",e=>{let{answers:t}=this.props;t.includes(e)?t=t.filter(a=>a!==e):t=[...t,e],this.updateMarker({answers:t})});this.state={showDropdown:!1}}componentDidMount(){document.addEventListener("click",this.handleClick,!0)}UNSAFE_componentWillReceiveProps(e){const{answers:t}=this.props,a=t.filter(r=>e.choices.includes(r));JSON.stringify(t)!==JSON.stringify(a)&&setTimeout(()=>this.updateMarker({answers:a}))}componentWillUnmount(){document.removeEventListener("click",this.handleClick,!0)}openDropdown(){this.setState({showDropdown:!0})}updateMarker(e){const{answers:t,label:a,onChange:r,x:o,y:c}=this.props;r({answers:t,label:a,x:o,y:c,...e})}render(){const{answers:e,choices:t,label:a,onRemove:r,x:o,y:c}=this.props,{showDropdown:m}=this.state;return n.jsx("div",{className:s.css(x.marker,e.length>0&&x.markerWithAnswers,m&&x.markerSelected),ref:u=>this._marker=u,style:{left:`${o}%`,top:`${c}%`},title:"Click to select marker answers or to delete marker. Repositioning marker is not implemented.",children:m&&n.jsx("div",{children:n.jsxs("div",{className:s.css(x.dropdownBody,x.dropdownPositionWithArrow),children:[n.jsx(z,{value:"",onClick:()=>r(),children:"Delete marker"}),n.jsx("hr",{className:s.css(x.dividerHorizontal)}),n.jsx(re,{onSelected:this.handleSelectAnswer,selectedValues:e,children:t.map(u=>n.jsx(z,{value:u,children:u},u))}),n.jsx("div",{className:s.css(x.labelContainer),children:n.jsx(W,{placeholder:"ARIA label (for screen readers)",onChange:this.handleLabelChange,value:a,width:"100%"})})]})})})}}const x=s.StyleSheet.create({marker:{position:"absolute",boxSizing:"content-box",width:16,height:16,marginLeft:-8,marginTop:-8,cursor:"pointer",background:"linear-gradient(to bottom, rgba(33, 36, 44, 0.2), rgba(33, 36, 44, 0.5))",border:"solid 2px #ffffff",borderRadius:16,boxShadow:"0 2px 10px 0 rgba(33, 36, 44, 0.1)"},markerSelected:{width:28,height:28,marginLeft:-12,marginTop:-12,border:"none",borderRadius:28,"::before":{content:"''",display:"block",width:20,height:20,marginLeft:2,marginTop:2,border:"solid 2px #ffffff",borderRadius:20}},markerWithAnswers:{background:"#1865f2"},dropdownPositionWithArrow:{left:46,bottom:-12,"::before":{content:"''",display:"block",position:"absolute",width:0,height:0,left:-16,bottom:8,borderRight:`solid 16px ${Q}`,borderTop:"solid 16px transparent",borderBottom:"solid 16px transparent"}},labelContainer:{padding:4},dividerHorizontal:{height:0,margin:0,border:`solid ${we}`,borderWidth:"0 0 1px",boxShadow:"none"},dropdownBody:{position:"absolute",border:"solid 1px rgba(0, 0, 0, 0.1)",zIndex:1e3,color:k,backgroundColor:Q,borderRadius:4,maxHeight:320,cursor:"pointer"}});oe.__docgenInfo={description:"",methods:[{name:"openDropdown",docblock:null,modifiers:[],params:[],returns:null},{name:"updateMarker",docblock:null,modifiers:[],params:[{name:"props",optional:!1,type:{name:"any"}}],returns:null},{name:"handleClick",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:{name:"MouseEvent",alias:"MouseEvent"}}],returns:null},{name:"handleLabelChange",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:null}],returns:null},{name:"handleSelectAnswer",docblock:null,modifiers:[],params:[{name:"toggleAnswer",optional:!1,type:{name:"string"}}],returns:null}],displayName:"Marker",props:{choices:{required:!0,tsType:{name:"Array",raw:'PerseusLabelImageWidgetOptions["choices"]'},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:`(
    marker: PerseusLabelImageWidgetOptions["markers"][number],
) => void`,signature:{arguments:[{type:{name:"Array[number]",raw:'PerseusLabelImageWidgetOptions["markers"][number]'},name:"marker"}],return:{name:"void"}}},description:""},onRemove:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};class ie extends g.Component{constructor(){super(...arguments);d(this,"_markers",[]);d(this,"handleImageDoubleClick",e=>{e.preventDefault();const t=e.currentTarget.getBoundingClientRect(),a=Math.round((e.clientX-t.left)/t.width*1e3)/10,r=Math.round((e.clientY-t.top)/t.height*1e3)/10,{markers:o,onChange:c}=this.props;c([...o,{answers:[],label:"",x:a,y:r}])})}openDropdownForMarkerIndices(e){e.forEach(t=>{var a;this._markers[t]&&((a=this._markers[t])==null||a.openDropdown())})}render(){const{choices:e,imageUrl:t,imageWidth:a,imageHeight:r,markers:o,onChange:c}=this.props,m=he().staticUrl;return n.jsxs("div",{children:[n.jsx("div",{className:s.css(F.title),children:"Markers"}),n.jsx("div",{className:s.css(F.subtitle),children:t?n.jsxs("span",{children:["Double-click on the image to add a marker.",n.jsx("br",{}),n.jsx("br",{}),"Markers are read by screen readers in the order that you add them here, so add in a logical order for the learner (e.g. sequentially, clockwise). You can test order by using keyboard tabbing."]}):"Upload an image to place markers."}),t&&n.jsxs("div",{className:s.css(F.markersCanvas),style:{maxWidth:a,maxHeight:r},children:[n.jsx("img",{alt:"",className:s.css(F.image),src:m(Z.getRealImageUrl(t)),onDoubleClick:this.handleImageDoubleClick}),o.map((u,p)=>g.createElement(oe,{...u,choices:e,key:`${u.x}.${u.y}`,onChange:h=>c([...o.slice(0,p),h,...o.slice(p+1)]),onRemove:()=>c([...o.slice(0,p),...o.slice(p+1)]),ref:h=>this._markers[p]=h}))]})]})}}const F=s.StyleSheet.create({title:{...I,marginBottom:6,color:k},subtitle:{fontFamily:"inherit",fontSize:12,lineHeight:"14px",marginBottom:12,color:ne},markersCanvas:{position:"relative",border:"solid 1px rgba(33, 36, 44, 0.16)"},image:{display:"block",maxWidth:"100%"}});ie.__docgenInfo={description:"",methods:[{name:"openDropdownForMarkerIndices",docblock:null,modifiers:[],params:[{name:"indices",optional:!1,type:{name:"ReadonlyArray",elements:[{name:"number"}],raw:"ReadonlyArray<number>",alias:"ReadonlyArray"}}],returns:null},{name:"handleImageDoubleClick",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:{name:"ReactMouseEvent",raw:"React.MouseEvent",alias:"React.MouseEvent"}}],returns:null}],displayName:"QuestionMarkers",props:{choices:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},imageUrl:{required:!0,tsType:{name:"string"},description:""},imageWidth:{required:!0,tsType:{name:"number"},description:""},imageHeight:{required:!0,tsType:{name:"number"},description:""},markers:{required:!0,tsType:{name:"Array",raw:'PerseusLabelImageWidgetOptions["markers"]'},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:'(markers: PerseusLabelImageWidgetOptions["markers"]) => void',signature:{arguments:[{type:{name:"Array",raw:'PerseusLabelImageWidgetOptions["markers"]'},name:"markers"}],return:{name:"void"}}},description:""}}};const le=({onChange:i,url:l})=>n.jsxs("div",{children:[n.jsx("div",{className:s.css(B.title),children:"Image"}),n.jsxs("div",{className:s.css(B.components),children:[n.jsx(W,{placeholder:"URL",grow:1,onChange:e=>i(e.target.value),value:l}),n.jsx("div",{className:s.css(B.spacer)}),n.jsx(ge,{disabled:!l,"aria-label":l?"":"Not implemented. Use the 'Add Image' button in the editor to upload image, then copy the URL here.",onClick:()=>i(""),style:B.btn,children:l?"Remove":"Upload"})]})]}),B=s.StyleSheet.create({title:{...I,marginBottom:6,color:k},components:{display:"flex"},spacer:{width:16},btn:{minWidth:90}});le.__docgenInfo={description:"",methods:[],displayName:"SelectImage",props:{onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(url: string) => void",signature:{arguments:[{type:{name:"string"},name:"url"}],return:{name:"void"}}},description:""},url:{required:!0,tsType:{name:"string"},description:""}}};class $ extends g.Component{constructor(){super(...arguments);d(this,"_questionMarkers");d(this,"getSaveWarnings",()=>{const{choices:e,imageAlt:t,imageUrl:a,markers:r}=this.props,o=[];if(e.length<2&&o.push("Question requires at least two answer choices"),a?t||o.push("Question image has no alt text"):o.push("Image is not specified for question"),!r.length)o.push("Question has no markers, to label answers on image");else{let c=0,m=0;for(const u of r)u.answers.length||c++,u.label||m++;c&&o.push(`Question has ${c} markers with no answers selected`),m&&o.push(`Question has ${m} markers with no ARIA label`)}return o});d(this,"handleImageChange",e=>{this.props.onChange({imageUrl:e,imageWidth:0,imageHeight:0}),e&&Z.getImageSize(e,(t,a)=>{this.props.onChange({imageUrl:e,imageWidth:t,imageHeight:a})})});d(this,"handleAltChange",e=>{this.props.onChange({imageAlt:e})});d(this,"handleChoicesChange",e=>{this.props.onChange({choices:e})});d(this,"handleMarkersChange",e=>{this.props.onChange({markers:e})});d(this,"handleBehaviorChange",e=>{this.props.onChange(e)})}componentDidUpdate(e){const t={};e.markers.forEach(r=>t[`${r.x}.${r.y}`]=r);const a=this.props.markers.map((r,o)=>t.hasOwnProperty(`${r.x}.${r.y}`)?-1:o).filter(r=>r!==-1);a.length&&this._questionMarkers&&this._questionMarkers.openDropdownForMarkerIndices(a)}serialize(){return ye.serialize.call(this)}render(){const{choices:e,imageAlt:t,imageUrl:a,imageWidth:r,imageHeight:o,markers:c,multipleAnswers:m,hideChoicesFromInstructions:u}=this.props,p=a&&r>0&&o>0;return n.jsxs("div",{children:[n.jsx(le,{onChange:this.handleImageChange,url:a}),n.jsx("div",{className:s.css(L.smallSpacer)}),p&&n.jsx(W,{placeholder:"Alt text (for screen readers)",onChange:h=>this.handleAltChange(h.target.value),value:t,width:"100%"}),n.jsx("div",{className:s.css(L.largeSpacer)}),n.jsx(ie,{choices:e,imageUrl:p?a:"",imageWidth:r,imageHeight:o,markers:c,onChange:this.handleMarkersChange,ref:h=>this._questionMarkers=h}),n.jsx("div",{className:s.css(L.largeSpacer)}),n.jsx(se,{choices:e,onChange:this.handleChoicesChange}),n.jsx("div",{className:s.css(L.largeSpacer)}),n.jsx(ae,{multipleAnswers:m,hideChoicesFromInstructions:u,onChange:this.handleBehaviorChange})]})}}d($,"defaultProps",fe.defaultWidgetOptions),d($,"widgetName","label-image");const L=s.StyleSheet.create({largeSpacer:{height:32},smallSpacer:{height:16}});$.__docgenInfo={description:`Direct image labeling widget editor.

Label on image widget enables creating more natural, conceptual questions
that involve the use of images, and enable learners to demonstrate their
knowledge by directly interacting with the image.`,methods:[{name:"getSaveWarnings",docblock:null,modifiers:[],params:[],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:{type:{name:"any"}}},{name:"handleImageChange",docblock:null,modifiers:[],params:[{name:"url",optional:!1,type:{name:"string"}}],returns:null},{name:"handleAltChange",docblock:null,modifiers:[],params:[{name:"alt",optional:!1,type:{name:"string"}}],returns:null},{name:"handleChoicesChange",docblock:null,modifiers:[],params:[{name:"choices",optional:!1,type:{name:"ReadonlyArray",elements:[{name:"string"}],raw:"ReadonlyArray<string>",alias:"ReadonlyArray"}}],returns:null},{name:"handleMarkersChange",docblock:null,modifiers:[],params:[{name:"markers",optional:!1,type:{name:"Array",raw:'PerseusLabelImageWidgetOptions["markers"]'}}],returns:null},{name:"handleBehaviorChange",docblock:null,modifiers:[],params:[{name:"options",optional:!1,type:{name:"any"}}],returns:null}],displayName:"LabelImageEditor",props:{choices:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:"",defaultValue:{value:"[]",computed:!1}},imageAlt:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'""',computed:!1}},imageUrl:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'""',computed:!1}},imageWidth:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},imageHeight:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},markers:{required:!1,tsType:{name:"Array",raw:'PerseusLabelImageWidgetOptions["markers"]'},description:"",defaultValue:{value:"[]",computed:!1}},multipleAnswers:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},hideChoicesFromInstructions:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(options: any) => void",signature:{arguments:[{type:{name:"any"},name:"options"}],return:{name:"void"}}},description:""}}};export{$ as L};
