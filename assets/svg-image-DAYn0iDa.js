var _s=(s,t,e)=>{if(!t.has(s))throw TypeError("Cannot "+e)};var _e=(s,t,e)=>(_s(s,t,"read from private field"),e?e.call(s):t.get(s)),xi=(s,t,e)=>{if(t.has(s))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(s):t.set(s,e)},Mi=(s,t,e,r)=>(_s(s,t,"write to private field"),r?r.call(s,e):t.set(s,e),e);import{_ as w}from"./underscore-U-AHniOr.js";import{U as Je}from"./core-widget-registry-2tCIH_GM.js";import{P as $t,E as Vt}from"./perseus-error-UcbLzupY.js";import{C as Hn}from"./index-BGfZpMKd.js";import{c as On}from"./index-D7h-teXI.js";import{$ as E}from"./jquery-CkHB0_Mt.js";import{r as Tt}from"./index-C6mWTJJr.js";import{g as se}from"./dependencies-BsVPGK1s.js";import{U as Lt,h as Jt,K as Xt,r as zn,j as ct,k as Ft,d as dt,z as Bn,m as Zs,n as Ae,o as Ai,p as Wt,q as Cs,t as Fn,v as Ws,w as $e,x as Gn,y as pe,A as zi,B as Bi,C as Fi,D as Gi}from"./util-Cjm22Ttl.js";import{F as Ps}from"./fixed-to-responsive-CXYuKT1B.js";import{e as Yn}from"./index-BzwLglMS.js";import{c as Ce}from"./index-CC9jxhwQ.js";import{R as Xn}from"./index-CskvhqFA.js";import{c as qn}from"./client-CASytsYC.js";import{I as Un}from"./inline-icon-olZqfQoG.js";import{i as Zn}from"./icon-paths-C3bPmxpL.js";import{I as Ke}from"./image-loader-Clck2KCg.js";function As(s){return[(s[0][0]+s[1][0])/2,(s[0][1]+s[1][1])/2]}const Re={log:(s,t)=>{se().Log.log(s,t)},error:(s,t,e)=>{se().Log.error(s,t,e)}},Wn=/^file\+graphie:/,$n=/\/([^/]+)$/;function $s(){const{JIPT:s,kaLocale:t}=se();return s.useJIPT?"en-pt":t}function Es(){return $s()!=="en"}const Kn=/\/(?=[^/]+$)/;function jn(s){if(Wn.test(s))return Lt.getDataUrl(s);const[t,e]=Lt.getBaseUrl(s).split(Kn);return`${t}/${$s()}/${e}-data.json`}function Jn(s){const t=s.match($n);if(t==null)throw new $t("not a valid URL",Vt.InvalidInput);return t&&t[1]}function Qn(s,t,e){const r=t.match(new RegExp(`^(?:svgData|svgOtherData)${s}\\((.+)\\);$`)),a=r?r[1]:t;try{return JSON.parse(a)}catch(u){return e(u),null}}const je={};function to(s,t){const e=Jn(s),r=je[e];if(r!=null)if(r.loaded){const{data:a,localized:u}=r;t(a,u)}else r.dataCallbacks.push(t);else{const a={loaded:!1,dataCallbacks:[t],localized:Es()};je[e]=a;const u=async(v,y)=>{const b=await fetch(v);if(!(b!=null&&b.ok)){y();return}const S=await b.text(),x=Qn(e,S,A=>{Re.error("Failed to parse JSONP for svg-image",Vt.Service,{cause:A,loggedMetadata:{dataUrl:Lt.getDataUrl(v),jsonp:S}})});if(!x)return;const M=je[e]={...je[e],loaded:!0,data:x};M.dataCallbacks.forEach(A=>{A(M.data,a.localized)})},d=(v,y,b)=>{Re.error("Data load failed for svg-image",Vt.Service,{cause:b,loggedMetadata:{dataUrl:Lt.getDataUrl(s),status:y}})};Es()?(a.localized=!1,u(jn(s),()=>u(Lt.getDataUrl(s),d))):u(Lt.getDataUrl(s),d)}}function eo(){const s=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(const e in t)if(s.style[e]!==void 0)return{end:t[e]};return!1}E.fn.emulateTransitionEnd=function(s){let t=!1;const e=this;return E(this).one("bsTransitionEnd",function(){t=!0}),setTimeout(function(){t||E(e).trigger(E.support.transition.end)},s),this};E(function(){E.support.transition=eo(),E.support.transition&&(E.event.special.bsTransitionEnd={bindType:E.support.transition.end,delegateType:E.support.transition.end,handle:function(s){if(E(s.target).is(this))return s.handleObj.handler.apply(this,arguments)}})});function Ks(s,t){const e=window.scrollX,r=window.scrollY,a=document.querySelector("meta[name=viewport]");a?a.setAttribute("content",s):E("head").append(`<meta name="viewport" content="${s}">`),document.body.style.opacity=.9999,setTimeout(()=>{document.body.style.opacity=1,window.scrollTo(e,r),t!=null&&setTimeout(t,0)},0)}function qt(){}qt.prototype._initialize=function(s){this._$document||(this._activeZoom=this._initialScrollPosition=this._initialTouchPosition=this._touchMoveListener=null,this._$document=E(document),this._$window=E(window),this._$body=E(document.body),this._boundClick=E.proxy(this._clickHandler,this),this._enableMobilePinch=s)};qt.prototype.handleZoomClick=function(s,t){this._initialize(t);const e=s.target;if(!(!e||e.tagName!=="IMG")&&!this._$body.hasClass("zoom-overlay-open")){if(s.metaKey||s.ctrlKey)return window.open(s.target.src,"_blank");!t&&e.width>=window.innerWidth-At.getOffset()||(this._activeZoomClose(!0),t?Ks("width=device-width, initial-scale=1, minimum-scale=1",()=>this._zoom(e)):this._zoom(e),t||(this._$window.on("scroll.zoom",E.proxy(this._scrollHandler,this)),this._$document.on("keyup.zoom",E.proxy(this._keyHandler,this)),this._$document.on("touchstart.zoom",E.proxy(this._touchStart,this))),document.addEventListener("click",this._boundClick,!0),s.stopPropagation())}};qt.prototype._zoom=function(s){this._activeZoom=new At(s,this._enableMobilePinch),this._activeZoom.zoomImage()};qt.prototype._activeZoomClose=function(s){this._activeZoom&&(s?(this._activeZoom.dispose(),this._disposeActiveZoom()):Ks(`width=device-width, initial-scale=1, minimum-scale=1,
            maximum-scale=1`,()=>{this._activeZoom&&(this._activeZoom.close(),this._disposeActiveZoom())}))};qt.prototype._disposeActiveZoom=function(){this._$window.off(".zoom"),this._$document.off(".zoom"),document.removeEventListener("click",this._boundClick,!0),this._activeZoom=null};qt.prototype._scrollHandler=function(s){this._initialScrollPosition===null&&(this._initialScrollPosition=window.scrollY);const t=this._initialScrollPosition-window.scrollY;Math.abs(t)>=40&&this._activeZoomClose()};qt.prototype._keyHandler=function(s){[27,13,32].includes(s.keyCode)&&this._activeZoomClose()};qt.prototype._clickHandler=function(s){s.stopPropagation(),s.preventDefault(),this._activeZoomClose()};qt.prototype._touchStart=function(s){this._initialTouchPosition=s.originalEvent.touches[0].pageY,E(s.target).on("touchmove.zoom",E.proxy(this._touchMove,this))};qt.prototype._touchMove=function(s){Math.abs(s.originalEvent.touches[0].pageY-this._initialTouchPosition)>10&&(this._activeZoomClose(),E(s.target).off("touchmove.zoom"))};function At(s,t){this._fullHeight=this._fullWidth=this._overlay=null,this._targetImage=s,this._enableMobilePinch=t,this._$body=E(document.body)}At._OFFSET=80;At._MAX_WIDTH=2560;At._MAX_HEIGHT=4096;At.getOffset=function(s){return s?0:At._OFFSET};At.prototype.getOffset=function(){return At.getOffset(this._enableMobilePinch)};At.prototype.zoomImage=function(){const s=document.createElement("img"),t=E(s);s.onload=(function(){this._fullHeight=Number(s.height),this._fullWidth=Number(s.width);const e=this._imageOffset=E(this._targetImage).offset(),r=this._left=e.left-E(window).scrollLeft(),a=this._top=e.top-E(window).scrollTop();t.css({left:r,top:a,width:this._targetImage.width,height:this._targetImage.height}),this._zoomOriginal()}).bind(this),s.src=this._targetImage.src,s.alt=this._targetImage.alt,s.tabIndex=0,s.role="button",this.$zoomedImage=t};At.prototype._zoomOriginal=function(){var s,t,e;this.$zoomedImage.addClass("zoom-img").attr("data-action","zoom-out"),E(this._targetImage).css("visibility","hidden"),this._backdrop=document.createElement("div"),this._backdrop.className="zoom-backdrop",(s=document.body)==null||s.appendChild(this._backdrop),this._overlay=document.createElement("div"),this._overlay.className="zoom-overlay",(t=document.body)==null||t.appendChild(this._overlay),(e=this._overlay)==null||e.appendChild(this.$zoomedImage[0]),this._calculateZoom(),this._triggerAnimation()};At.prototype._calculateZoom=function(){const s=this._fullWidth,t=this._fullHeight,e=window.innerHeight-this.getOffset(),r=window.innerWidth-this.getOffset(),a=s/this._targetImage.width,u=s/t,d=r/e;s<r&&t<e?this._imgScaleFactor=a:u<d?this._imgScaleFactor=e/t*a:this._imgScaleFactor=r/(s??0)*a};At.prototype._triggerAnimation=function(){const s=E(window).scrollTop()+window.innerHeight/2,t=E(window).scrollLeft()+window.innerWidth/2,e=this._imgScaleFactor,r=this._imageOffset.top+this._targetImage.height/2,a=this._imageOffset.left+this._targetImage.width/2;this._translateY=(s-r)/e,this._translateX=(t-a)/e,this._zoomedInTransformString=`
        scale(${e})
        translate3d(${this._translateX}px, ${this._translateY}px, 0)
    `,this.$zoomedImage.css({transform:this._zoomedInTransformString}).addClass("zoom-transition").one(E.support.transition.end,E.proxy(this._onZoomInFinish,this)).emulateTransitionEnd(300),this._$body.addClass("zoom-overlay-open")};At.prototype._onZoomInFinish=function(){const s=this._targetImage.height*this._imgScaleFactor,t=this._targetImage.width*this._imgScaleFactor;let e=0,r=0,a=0,u=0,d=0,v=0;t<window.innerWidth?(e="50%",a=-t/2):d=(t-window.innerWidth)/2,s<window.innerHeight?(r="50%",u=-s/2):v=(s-window.innerHeight)/2,this.$zoomedImage.css({height:s,left:e,marginLeft:a,marginTop:u,top:r,transform:"",width:t}).removeClass("zoom-transition"),E(this._overlay).scrollLeft(d).scrollTop(v)};At.prototype.close=function(){this._$body.removeClass("zoom-overlay-open").addClass("zoom-overlay-transitioning"),this.$zoomedImage.css({height:this._targetImage.height,left:this._left,marginLeft:0,marginTop:0,top:this._top,transform:this._zoomedInTransformString,width:this._targetImage.width}).removeClass("zoom-transition"),E(this._overlay).scrollLeft(0).scrollTop(0),setTimeout(()=>{this.$zoomedImage.css({transform:"scale(1)"}).addClass("zoom-transition").one(E.support.transition.end,E.proxy(this.dispose,this)).emulateTransitionEnd(300)},10)};At.prototype.dispose=function(){this.$zoomedImage&&this.$zoomedImage[0].parentNode&&(this.$zoomedImage.remove(),this.$zoomedImage=null,this._overlay.parentNode.removeChild(this._overlay),this._backdrop.parentNode.removeChild(this._backdrop),this._$body.removeClass("zoom-overlay-transitioning")),E(this._targetImage).css("visibility","visible"),this._targetImage.focus()};const io=new qt;function Is(s,t){return s+":"+t}function so(s){return s.split(":")[0]}const js={_fireEvent:function(s,...t){for(const e of s)e.call(this,...t)},_applyConstraints:function(s,t,e){let r=!1;return w.reduce(this.state.constraints,(a,u)=>{if(a===!1)return!1;if(r)return a;const d=u.call(this,a,t,{onSkipRemaining:()=>{r=!0},...e});if(d===!1)return!1;if(Jt(d,2))return d;if(d===!0||d==null)return a;throw new $t("Constraint returned invalid result: "+d,Vt.Internal)},s,this)},draw:function(){const s=this.cloneState();js._fireEvent.call(this,this.state.draw,s,this.prevState),this.prevState=s},listen:function(s,t,e){this._listenerMap=this._listenerMap||{};const r=Is(s,t),a=this._listenerMap[r]=this._listenerMap[r]||this.state[s].length;this.state[s][a]=e},unlisten:function(s,t){this._listenerMap=this._listenerMap||{};const e=Is(s,t),r=this._listenerMap[e];if(r!==void 0){this.state[s].splice(r,1),delete this._listenerMap[e];const a=w.keys(this._listenerMap);w.each(a,function(u){so(u)===s&&this._listenerMap[u]>r&&this._listenerMap[u]--},this)}}};let Si=null;function no(){const s=document.createElement("div"),t=["transform","msTransform","MozTransform","WebkitTransform","OTransform"];let e=null;return w.each(t,function(r){typeof s.style[r]<"u"&&(e=r)}),e}let Ti=null;function oo(){const s=document.createElement("div"),t=kt.getPrefixedTransform();return s.style[t]="translateZ(0px)",!!s.style[t]}const ro=["add","modify","draw","remove","constraints","onMoveStart","onMove","onMoveEnd","onClick"],kt={assert:function(s,t){if(!s)throw new $t("Assertion Error"+(t?": "+t:""),Vt.Internal)},createGettersFor:function(s,t){w.each(w.keys(t),function(e){s.prototype[e]===void 0&&(s.prototype[e]=function(){return this.state[e]})})},addMovableHelperMethodsTo:function(s){w.each(js,function(t,e){s.prototype[e]===void 0&&(s.prototype[e]=t)})},arrayify:function(s){return s==null?[]:w.isArray(s)?w.filter(w.flatten(s),w.identity):[s]},normalizeOptions:function(s){const t={...s};return ro.forEach(function(e){s[e]!==void 0&&(t[e]=kt.arrayify(s[e]))}),t},getPrefixedTransform:function(){return Si=Si||no(),Si},getCanUse3dTransform:function(){return Ti==null&&(Ti=oo()),Ti}};/*!
 * Raphael 1.5.2 - JavaScript Vector Library
 *
 * Copyright (c) 2010 Dmitry Baranovskiy (http://raphaeljs.com)
 * Licensed under the MIT (http://raphaeljs.com/license.html) license.
 */const jt=function(){var s;"".trim?s=function(n,i,o){n.setAttribute(i,String(o).trim())}:s=function(n,i,o){n.setAttribute(i,String(o))};function t(){if(t.is(arguments[0],pt)){for(var n=arguments[0],i=fi[A](t,n.splice(0,3+t.is(n[0],rt))),o=i.set(),l=0,c=n[I];l<c;l++){var f=n[l]||{};r[d](f.type)&&o[K](i[f.type]().attr(f))}return o}return fi[A](t,arguments)}t.version="1.5.2";var e=/[, ]+/,r={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},a=/\{(\d+)\}/g,u="prototype",d="hasOwnProperty",v=document,y=window,b={was:Object[u][d].call(y,"Raphael"),is:y.Raphael},S=function(){this.customAttributes={}},x,M="appendChild",A="apply",C="concat",R="createTouch"in v,_="",O=" ",H=String,z="split",j="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend orientationchange touchcancel gesturestart gesturechange gestureend"[z](O),tt={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},J="join",I="length",ot=H[u].toLowerCase,X=Math,F=X.max,st=X.min,nt=X.abs,$=X.pow,lt=X.PI,rt="number",W="string",pt="array",xt="toString",Et="fill",ae=Object[u][xt],K="push",we=/^url\(['"]?([^\)]+?)['"]?\)$/i,Ne=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,li={NaN:1,Infinity:1,"-Infinity":1},le=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,B=X.round,Y=parseFloat,et=parseInt,ft=" progid:DXImageTransform.Microsoft",wt=H[u].toUpperCase,Mt={blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/",opacity:1,path:"M0,0",r:0,rotation:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",translation:"0 0",width:0,x:0,y:0},Ct={along:"along",blur:rt,"clip-rect":"csv",cx:rt,cy:rt,fill:"colour","fill-opacity":rt,"font-size":rt,height:rt,opacity:rt,path:"path",r:rt,rotation:"csv",rx:rt,ry:rt,scale:"csv",stroke:"colour","stroke-opacity":rt,"stroke-width":rt,translation:"csv",width:rt,x:rt,y:rt},vt="replace",xe=/^(from|to|\d+%?)$/,ne=/\s*,\s*/,ce={hs:1,rg:1},Ve=/,?([achlmqrstvxz]),?/gi,gn=/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/ig,vn=/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/ig,Zi=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,bn=function(n,i){return n.key-i.key};if(t.type=y.SVGAngle||v.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML",t.type=="VML"){var ci=v.createElement("div"),He;if(ci.innerHTML='<v:shape adj="1"/>',He=ci.firstChild,He.style.behavior="url(#default#VML)",!(He&&typeof He.adj=="object"))return t.type=null;ci=null}t.svg=!(t.vml=t.type=="VML"),S[u]=t[u],x=S[u],t._id=0,t._oid=0,t.fn={},t.is=function(n,i){return i=ot.call(i),i=="finite"?!li[d](+n):i=="null"&&n===null||i==typeof n||i=="object"&&n===Object(n)||i=="array"&&Array.isArray&&Array.isArray(n)||ae.call(n).slice(8,-1).toLowerCase()==i},t.angle=function(n,i,o,l,c,f){if(c==null){var p=n-o,h=i-l;return!p&&!h?0:((p<0)*180+X.atan(-h/-p)*180/lt+360)%360}else return t.angle(n,i,c,f)-t.angle(o,l,c,f)},t.rad=function(n){return n%360*lt/180},t.deg=function(n){return n*180/lt%360},t.snapTo=function(n,i,o){if(o=t.is(o,"finite")?o:10,t.is(n,pt)){for(var l=n.length;l--;)if(nt(n[l]-i)<=o)return n[l]}else{n=+n;var c=i%n;if(c<o)return i-c;if(c>n-o)return i-c+n}return i};function Oe(){for(var n=[],i=0;i<32;i++)n[i]=(~~(X.random()*16))[xt](16);return n[12]=4,n[16]=(n[16]&3|8)[xt](16),"r-"+n[J]("")}t.setWindow=function(n){y=n,v=y.document};var ze=function(n){if(t.vml){var i=/^\s+|\s+$/g,o;try{var l=new ActiveXObject("htmlfile");l.write("<body>"),l.close(),o=l.body}catch{o=createPopup().document.body}var c=o.createTextRange();ze=Gt(function(p){try{o.style.color=H(p)[vt](i,_);var h=c.queryCommandValue("ForeColor");return h=(h&255)<<16|h&65280|(h&16711680)>>>16,"#"+("000000"+h[xt](16)).slice(-6)}catch{return"none"}})}else{var f=v.createElement("i");f.title="Raphaël Colour Picker",f.style.display="none",v.body[M](f),ze=Gt(function(p){return f.style.color=p,v.defaultView.getComputedStyle(f,_).getPropertyValue("color")})}return ze(n)},Wi=function(){return"hsb("+[this.h,this.s,this.b]+")"},yn=function(){return"hsl("+[this.h,this.s,this.l]+")"},wn=function(){return this.hex};t.hsb2rgb=function(n,i,o,l){return t.is(n,"object")&&"h"in n&&"s"in n&&"b"in n&&(o=n.b,i=n.s,n=n.h,l=n.o),t.hsl2rgb(n,i,o/2,l)},t.hsl2rgb=function(n,i,o,l){t.is(n,"object")&&"h"in n&&"s"in n&&"l"in n&&(o=n.l,i=n.s,n=n.h),(n>1||i>1||o>1)&&(n/=360,i/=100,o/=100);var c={},f=["r","g","b"],p,h,m;if(!i)c={r:o,g:o,b:o};else{o<.5?p=o*(1+i):p=o+i-o*i,h=2*o-p;for(var g=0;g<3;g++)m=n+1/3*-(g-1),m<0&&m++,m>1&&m--,m*6<1?c[f[g]]=h+(p-h)*6*m:m*2<1?c[f[g]]=p:m*3<2?c[f[g]]=h+(p-h)*(2/3-m)*6:c[f[g]]=h}return c.r*=255,c.g*=255,c.b*=255,c.hex="#"+(16777216|c.b|c.g<<8|c.r<<16).toString(16).slice(1),t.is(l,"finite")&&(c.opacity=l),c.toString=wn,c},t.rgb2hsb=function(n,i,o){if(i==null&&t.is(n,"object")&&"r"in n&&"g"in n&&"b"in n&&(o=n.b,i=n.g,n=n.r),i==null&&t.is(n,W)){var l=t.getRGB(n);n=l.r,i=l.g,o=l.b}(n>1||i>1||o>1)&&(n/=255,i/=255,o/=255);var c=F(n,i,o),f=st(n,i,o),p,h,m=c;if(f==c)return{h:0,s:0,b:c,toString:Wi};var g=c-f;return h=g/c,n==c?p=(i-o)/g:i==c?p=2+(o-n)/g:p=4+(n-i)/g,p/=6,p<0&&p++,p>1&&p--,{h:p,s:h,b:m,toString:Wi}},t.rgb2hsl=function(n,i,o){if(i==null&&t.is(n,"object")&&"r"in n&&"g"in n&&"b"in n&&(o=n.b,i=n.g,n=n.r),i==null&&t.is(n,W)){var l=t.getRGB(n);n=l.r,i=l.g,o=l.b}(n>1||i>1||o>1)&&(n/=255,i/=255,o/=255);var c=F(n,i,o),f=st(n,i,o),p,h,m=(c+f)/2,g;if(f==c)g={h:0,s:0,l:m};else{var T=c-f;h=m<.5?T/(c+f):T/(2-c-f),n==c?p=(i-o)/T:i==c?p=2+(o-n)/T:p=4+(n-i)/T,p/=6,p<0&&p++,p>1&&p--,g={h:p,s:h,l:m}}return g.toString=yn,g},t._path2string=function(){return this.join(",")[vt](Ve,"$1")};function Gt(n,i,o){function l(){var c=Array[u].slice.call(arguments,0),f=c[J]("►"),p=l.cache=l.cache||{},h=l.count=l.count||[];return p[d](f)||(h[I]>=1e3&&delete p[h.shift()],h[K](f),p[f]=n[A](i,c)),o?o(p[f]):p[f]}return l}t.getRGB=Gt(function(n){if(!n||(n=H(n)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1};if(n=="none")return{r:-1,g:-1,b:-1,hex:"none"};!(ce[d](n.toLowerCase().substring(0,2))||n.charAt()=="#")&&(n=ze(n));var i,o,l,c,f,p,h=n.match(Ne);return h?(h[2]&&(l=et(h[2].substring(5),16),o=et(h[2].substring(3,5),16),i=et(h[2].substring(1,3),16)),h[3]&&(l=et((f=h[3].charAt(3))+f,16),o=et((f=h[3].charAt(2))+f,16),i=et((f=h[3].charAt(1))+f,16)),h[4]&&(p=h[4][z](ne),i=Y(p[0]),p[0].slice(-1)=="%"&&(i*=2.55),o=Y(p[1]),p[1].slice(-1)=="%"&&(o*=2.55),l=Y(p[2]),p[2].slice(-1)=="%"&&(l*=2.55),h[1].toLowerCase().slice(0,4)=="rgba"&&(c=Y(p[3])),p[3]&&p[3].slice(-1)=="%"&&(c/=100)),h[5]?(p=h[5][z](ne),i=Y(p[0]),p[0].slice(-1)=="%"&&(i*=2.55),o=Y(p[1]),p[1].slice(-1)=="%"&&(o*=2.55),l=Y(p[2]),p[2].slice(-1)=="%"&&(l*=2.55),(p[0].slice(-3)=="deg"||p[0].slice(-1)=="°")&&(i/=360),h[1].toLowerCase().slice(0,4)=="hsba"&&(c=Y(p[3])),p[3]&&p[3].slice(-1)=="%"&&(c/=100),t.hsb2rgb(i,o,l,c)):h[6]?(p=h[6][z](ne),i=Y(p[0]),p[0].slice(-1)=="%"&&(i*=2.55),o=Y(p[1]),p[1].slice(-1)=="%"&&(o*=2.55),l=Y(p[2]),p[2].slice(-1)=="%"&&(l*=2.55),(p[0].slice(-3)=="deg"||p[0].slice(-1)=="°")&&(i/=360),h[1].toLowerCase().slice(0,4)=="hsla"&&(c=Y(p[3])),p[3]&&p[3].slice(-1)=="%"&&(c/=100),t.hsl2rgb(i,o,l,c)):(h={r:i,g:o,b:l},h.hex="#"+(16777216|l|o<<8|i<<16).toString(16).slice(1),t.is(c,"finite")&&(h.opacity=c),h)):{r:-1,g:-1,b:-1,hex:"none",error:1}},t),t.getColor=function(n){var i=this.getColor.start=this.getColor.start||{h:0,s:1,b:n||.75},o=this.hsb2rgb(i.h,i.s,i.b);return i.h+=.075,i.h>1&&(i.h=0,i.s-=.2,i.s<=0&&(this.getColor.start={h:0,s:1,b:i.b})),o.hex},t.getColor.reset=function(){delete this.start},t.parsePathString=Gt(function(n){if(!n)return null;var i={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},o=[];return t.is(n,pt)&&t.is(n[0],pt)&&(o=Fe(n)),o[I]||H(n)[vt](gn,function(l,c,f){var p=[],h=ot.call(c);for(f[vt](vn,function(m,g){g&&p[K](+g)}),h=="m"&&p[I]>2&&(o[K]([c][C](p.splice(0,2))),h="l",c=c=="m"?"l":"L");p[I]>=i[h]&&(o[K]([c][C](p.splice(0,i[h]))),!!i[h]););}),o[xt]=t._path2string,o}),t.findDotsAtSegment=function(n,i,o,l,c,f,p,h,m){var g=1-m,T=$(g,3)*n+$(g,2)*3*m*o+g*3*m*m*c+$(m,3)*p,D=$(g,3)*i+$(g,2)*3*m*l+g*3*m*m*f+$(m,3)*h,N=n+2*m*(o-n)+m*m*(c-2*o+n),V=i+2*m*(l-i)+m*m*(f-2*l+i),L=o+2*m*(c-o)+m*m*(p-2*c+o),P=l+2*m*(f-l)+m*m*(h-2*f+l),k=(1-m)*n+m*o,U=(1-m)*i+m*l,q=(1-m)*c+m*p,it=(1-m)*f+m*h,Z=90-X.atan((N-L)/(V-P))*180/lt;return(N>L||V<P)&&(Z+=180),{x:T,y:D,m:{x:N,y:V},n:{x:L,y:P},start:{x:k,y:U},end:{x:q,y:it},alpha:Z}};var Be=Gt(function(n){if(!n)return{x:0,y:0,width:0,height:0};n=Xe(n);for(var i=0,o=0,l=[],c=[],f,p=0,h=n[I];p<h;p++)if(f=n[p],f[0]=="M")i=f[1],o=f[2],l[K](i),c[K](o);else{var m=xn(i,o,f[1],f[2],f[3],f[4],f[5],f[6]);l=l[C](m.min.x,m.max.x),c=c[C](m.min.y,m.max.y),i=f[5],o=f[6]}var g=st[A](0,l),T=st[A](0,c);return{x:g,y:T,width:F[A](0,l)-g,height:F[A](0,c)-T}}),Fe=function(n){var i=[];(!t.is(n,pt)||!t.is(n&&n[0],pt))&&(n=t.parsePathString(n));for(var o=0,l=n[I];o<l;o++){i[o]=[];for(var c=0,f=n[o][I];c<f;c++)i[o][c]=n[o][c]}return i[xt]=t._path2string,i},hi=Gt(function(n){(!t.is(n,pt)||!t.is(n&&n[0],pt))&&(n=t.parsePathString(n));var i=[],o=0,l=0,c=0,f=0,p=0;n[0][0]=="M"&&(o=n[0][1],l=n[0][2],c=o,f=l,p++,i[K](["M",o,l]));for(var h=p,m=n[I];h<m;h++){var g=i[h]=[],T=n[h];if(T[0]!=ot.call(T[0]))switch(g[0]=ot.call(T[0]),g[0]){case"a":g[1]=T[1],g[2]=T[2],g[3]=T[3],g[4]=T[4],g[5]=T[5],g[6]=+(T[6]-o).toFixed(3),g[7]=+(T[7]-l).toFixed(3);break;case"v":g[1]=+(T[1]-l).toFixed(3);break;case"m":c=T[1],f=T[2];default:for(var D=1,N=T[I];D<N;D++)g[D]=+(T[D]-(D%2?o:l)).toFixed(3)}else{g=i[h]=[],T[0]=="m"&&(c=T[1]+o,f=T[2]+l);for(var V=0,L=T[I];V<L;V++)i[h][V]=T[V]}var P=i[h][I];switch(i[h][0]){case"z":o=c,l=f;break;case"h":o+=+i[h][P-1];break;case"v":l+=+i[h][P-1];break;default:o+=+i[h][P-2],l+=+i[h][P-1]}}return i[xt]=t._path2string,i},0,Fe),Me=Gt(function(n){(!t.is(n,pt)||!t.is(n&&n[0],pt))&&(n=t.parsePathString(n));var i=[],o=0,l=0,c=0,f=0,p=0;n[0][0]=="M"&&(o=+n[0][1],l=+n[0][2],c=o,f=l,p++,i[0]=["M",o,l]);for(var h=p,m=n[I];h<m;h++){var g=i[h]=[],T=n[h];if(T[0]!=wt.call(T[0]))switch(g[0]=wt.call(T[0]),g[0]){case"A":g[1]=T[1],g[2]=T[2],g[3]=T[3],g[4]=T[4],g[5]=T[5],g[6]=+(T[6]+o),g[7]=+(T[7]+l);break;case"V":g[1]=+T[1]+l;break;case"H":g[1]=+T[1]+o;break;case"M":c=+T[1]+o,f=+T[2]+l;default:for(var D=1,N=T[I];D<N;D++)g[D]=+T[D]+(D%2?o:l)}else for(var V=0,L=T[I];V<L;V++)i[h][V]=T[V];switch(g[0]){case"Z":o=c,l=f;break;case"H":o=g[1];break;case"V":l=g[1];break;case"M":c=i[h][i[h][I]-2],f=i[h][i[h][I]-1];default:o=i[h][i[h][I]-2],l=i[h][i[h][I]-1]}}return i[xt]=t._path2string,i},null,Fe),Ge=function(n,i,o,l){return[n,i,o,l,o,l]},$i=function(n,i,o,l,c,f){var p=.3333333333333333,h=2/3;return[p*n+h*o,p*i+h*l,p*c+h*o,p*f+h*l,c,f]},Ki=function(n,i,o,l,c,f,p,h,m,g){var T=lt*120/180,D=lt/180*(+c||0),N=[],V,L=Gt(function(Ts,ks,We){var Nn=Ts*X.cos(We)-ks*X.sin(We),Vn=Ts*X.sin(We)+ks*X.cos(We);return{x:Nn,y:Vn}});if(g)yt=g[0],at=g[1],gt=g[2],ht=g[3];else{V=L(n,i,-D),n=V.x,i=V.y,V=L(h,m,-D),h=V.x,m=V.y;var P=(n-h)/2,k=(i-m)/2,U=P*P/(o*o)+k*k/(l*l);U>1&&(U=X.sqrt(U),o=U*o,l=U*l);var q=o*o,it=l*l,Z=(f==p?-1:1)*X.sqrt(nt((q*it-q*k*k-it*P*P)/(q*k*k+it*P*P))),gt=Z*o*k/l+(n+h)/2,ht=Z*-l*P/o+(i+m)/2,yt=X.asin(((i-ht)/l).toFixed(9)),at=X.asin(((m-ht)/l).toFixed(9));yt=n<gt?lt-yt:yt,at=h<gt?lt-at:at,yt<0&&(yt=lt*2+yt),at<0&&(at=lt*2+at),p&&yt>at&&(yt=yt-lt*2),!p&&at>yt&&(at=at-lt*2)}var St=at-yt;if(nt(St)>T){var Dt=at,Yt=h,Ut=m;at=yt+T*(p&&at>yt?1:-1),h=gt+o*X.cos(at),m=ht+l*X.sin(at),N=Ki(h,m,o,l,c,0,p,Yt,Ut,[at,Dt,gt,ht])}St=at-yt;var Qt=X.cos(yt),Pt=X.sin(yt),de=X.cos(at),Nt=X.sin(at),te=X.tan(St/4),oe=4/3*o*te,ys=4/3*l*te,ws=[n,i],fe=[n+oe*Pt,i-ys*Qt],xs=[h+oe*Nt,m-ys*de],Ms=[h,m];if(fe[0]=2*ws[0]-fe[0],fe[1]=2*ws[1]-fe[1],g)return[fe,xs,Ms][C](N);N=[fe,xs,Ms][C](N)[J]()[z](",");for(var Ss=[],ee=0,Dn=N[I];ee<Dn;ee++)Ss[ee]=ee%2?L(N[ee-1],N[ee],D).y:L(N[ee],N[ee+1],D).x;return Ss},Ye=function(n,i,o,l,c,f,p,h,m){var g=1-m;return{x:$(g,3)*n+$(g,2)*3*m*o+g*3*m*m*c+$(m,3)*p,y:$(g,3)*i+$(g,2)*3*m*l+g*3*m*m*f+$(m,3)*h}},xn=Gt(function(n,i,o,l,c,f,p,h){var m=c-2*o+n-(p-2*c+o),g=2*(o-n)-2*(c-o),T=n-o,D=(-g+X.sqrt(g*g-4*m*T))/2/m,N=(-g-X.sqrt(g*g-4*m*T))/2/m,V=[i,h],L=[n,p],P;return nt(D)>"1e12"&&(D=.5),nt(N)>"1e12"&&(N=.5),D>0&&D<1&&(P=Ye(n,i,o,l,c,f,p,h,D),L[K](P.x),V[K](P.y)),N>0&&N<1&&(P=Ye(n,i,o,l,c,f,p,h,N),L[K](P.x),V[K](P.y)),m=f-2*l+i-(h-2*f+l),g=2*(l-i)-2*(f-l),T=i-l,D=(-g+X.sqrt(g*g-4*m*T))/2/m,N=(-g-X.sqrt(g*g-4*m*T))/2/m,nt(D)>"1e12"&&(D=.5),nt(N)>"1e12"&&(N=.5),D>0&&D<1&&(P=Ye(n,i,o,l,c,f,p,h,D),L[K](P.x),V[K](P.y)),N>0&&N<1&&(P=Ye(n,i,o,l,c,f,p,h,N),L[K](P.x),V[K](P.y)),{min:{x:st[A](0,L),y:st[A](0,V)},max:{x:F[A](0,L),y:F[A](0,V)}}}),Xe=Gt(function(n,i){for(var o=Me(n),l=i&&Me(i),c={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},f={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},p=function(P,k){var U,q;if(!P)return["C",k.x,k.y,k.x,k.y,k.x,k.y];switch(!(P[0]in{T:1,Q:1})&&(k.qx=k.qy=null),P[0]){case"M":k.X=P[1],k.Y=P[2];break;case"A":P=["C"][C](Ki[A](0,[k.x,k.y][C](P.slice(1))));break;case"S":U=k.x+(k.x-(k.bx||k.x)),q=k.y+(k.y-(k.by||k.y)),P=["C",U,q][C](P.slice(1));break;case"T":k.qx=k.x+(k.x-(k.qx||k.x)),k.qy=k.y+(k.y-(k.qy||k.y)),P=["C"][C]($i(k.x,k.y,k.qx,k.qy,P[1],P[2]));break;case"Q":k.qx=P[1],k.qy=P[2],P=["C"][C]($i(k.x,k.y,P[1],P[2],P[3],P[4]));break;case"L":P=["C"][C](Ge(k.x,k.y,P[1],P[2]));break;case"H":P=["C"][C](Ge(k.x,k.y,P[1],k.y));break;case"V":P=["C"][C](Ge(k.x,k.y,k.x,P[1]));break;case"Z":P=["C"][C](Ge(k.x,k.y,k.X,k.Y));break}return P},h=function(P,k){if(P[k][I]>7){P[k].shift();for(var U=P[k];U[I];)P.splice(k++,0,["C"][C](U.splice(0,6)));P.splice(k,1),T=F(o[I],l&&l[I]||0)}},m=function(P,k,U,q,it){P&&k&&P[it][0]=="M"&&k[it][0]!="M"&&(k.splice(it,0,["M",q.x,q.y]),U.bx=0,U.by=0,U.x=P[it][1],U.y=P[it][2],T=F(o[I],l&&l[I]||0))},g=0,T=F(o[I],l&&l[I]||0);g<T;g++){o[g]=p(o[g],c),h(o,g),l&&(l[g]=p(l[g],f)),l&&h(l,g),m(o,l,c,f,g),m(l,o,f,c,g);var D=o[g],N=l&&l[g],V=D[I],L=l&&N[I];c.x=D[V-2],c.y=D[V-1],c.bx=Y(D[V-4])||c.x,c.by=Y(D[V-3])||c.y,f.bx=l&&(Y(N[L-4])||f.x),f.by=l&&(Y(N[L-3])||f.y),f.x=l&&N[L-2],f.y=l&&N[L-1]}return l?[o,l]:o},null,Fe),ji=Gt(function(n){for(var i=[],o=0,l=n[I];o<l;o++){var c={},f=n[o].match(/^([^:]*):?([\d\.]*)/);if(c.color=t.getRGB(f[1]),c.color.error)return null;c.color=c.color.hex,f[2]&&(c.offset=f[2]+"%"),i[K](c)}for(o=1,l=i[I]-1;o<l;o++)if(!i[o].offset){for(var p=Y(i[o-1].offset||0),h=0,m=o+1;m<l;m++)if(i[m].offset){h=i[m].offset;break}h||(h=100,m=l),h=Y(h);for(var g=(h-p)/(m-o+1);o<m;o++)p+=g,i[o].offset=p+"%"}return i}),Ji=function(n,i,o,l){var c;if(t.is(n,W)||t.is(n,"object")){if(c=t.is(n,W)?v.getElementById(n):n,c.tagName)return i==null?{container:c,width:c.style.pixelWidth||c.offsetWidth,height:c.style.pixelHeight||c.offsetHeight}:{container:c,width:i,height:o}}else return{container:1,x:n,y:i,width:o,height:l}},ui=function(n,i){var o=this;for(var l in i)if(i[d](l)&&!(l in n))switch(typeof i[l]){case"function":(function(c){n[l]=n===o?c:function(){return c[A](o,arguments)}})(i[l]);break;case"object":n[l]=n[l]||{},ui.call(this,n[l],i[l]);break;default:n[l]=i[l];break}},he=function(n,i){n==i.top&&(i.top=n.prev),n==i.bottom&&(i.bottom=n.next),n.next&&(n.next.prev=n.prev),n.prev&&(n.prev.next=n.next)},Qi=function(n,i){i.top!==n&&(he(n,i),n.next=null,n.prev=i.top,i.top.next=n,i.top=n)},ts=function(n,i){i.bottom!==n&&(he(n,i),n.next=i.bottom,n.prev=null,i.bottom.prev=n,i.bottom=n)},es=function(n,i,o){he(n,o),i==o.top&&(o.top=n),i.next&&(i.next.prev=n),n.next=i.next,n.prev=i,i.next=n},is=function(n,i,o){he(n,o),i==o.bottom&&(o.bottom=n),i.prev&&(i.prev.next=n),n.prev=i.prev,i.prev=n,n.next=i},ss=function(n){return function(){throw new Error("Raphaël: you are calling to method “"+n+"” of removed object")}};if(t.pathToRelative=hi,t.svg){x.svgns="http://www.w3.org/2000/svg",x.xlink="http://www.w3.org/1999/xlink",B=function(n){return+n+(~~n===n)*.5};var Q=function(n,i){if(i)for(var o in i)i[d](o)&&s(n,o,H(i[o]));else return n=v.createElementNS(x.svgns,n),n.style.webkitTapHighlightColor="rgba(0,0,0,0)",n};t[xt]=function(){return`Your browser supports SVG.
You are running Raphaël `+this.version};var ns=function(n,i){var o=Q("path");i.canvas&&i.canvas[M](o);var l=new mt(o,i);return l.type="path",Kt(l,{fill:"none",stroke:"#000",path:n}),l},Se=function(n,i,o){var l="linear",c=.5,f=.5,p=n.style;if(i=H(i)[vt](Zi,function(k,U,q){if(l="radial",U&&q){c=Y(U),f=Y(q);var it=(f>.5)*2-1;$(c-.5,2)+$(f-.5,2)>.25&&(f=X.sqrt(.25-$(c-.5,2))*it+.5)&&f!=.5&&(f=f.toFixed(5)-1e-5*it)}return _}),i=i[z](/\s*\-\s*/),l=="linear"){var h=i.shift();if(h=-Y(h),isNaN(h))return null;var m=[0,0,X.cos(h*lt/180),X.sin(h*lt/180)],g=1/(F(nt(m[2]),nt(m[3]))||1);m[2]*=g,m[3]*=g,m[2]<0&&(m[0]=-m[2],m[2]=0),m[3]<0&&(m[1]=-m[3],m[3]=0)}var T=ji(i);if(!T)return null;var D=n.getAttribute(Et);D=D.match(/^url\(#(.*)\)$/),D&&o.defs.removeChild(v.getElementById(D[1]));var N=Q(l+"Gradient");N.id=Oe(),Q(N,l=="radial"?{fx:c,fy:f}:{x1:m[0],y1:m[1],x2:m[2],y2:m[3]}),o.defs[M](N);for(var V=0,L=T[I];V<L;V++){var P=Q("stop");Q(P,{offset:T[V].offset?T[V].offset:V?"100%":"0%","stop-color":T[V].color||"#fff"}),N[M](P)}return Q(n,{fill:"url(#"+N.id+")",opacity:1,"fill-opacity":1}),p.fill=_,p.opacity=1,p.fillOpacity=1,1},di=function(n){var i=n.getBBox();Q(n.pattern,{patternTransform:t.format("translate({0},{1})",i.x,i.y)})},Kt=function(n,i){var o={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},l=n.node,c=n.attrs,f=n.rotate(),p=function(at,St){if(St=o[ot.call(St)],St){for(var Dt=at.attrs["stroke-width"]||"1",Yt={round:Dt,square:Dt,butt:0}[at.attrs["stroke-linecap"]||i["stroke-linecap"]]||0,Ut=[],Qt=St[I];Qt--;)Ut[Qt]=St[Qt]*Dt+(Qt%2?1:-1)*Yt;Q(l,{"stroke-dasharray":Ut[J](",")})}};i[d]("rotation")&&(f=i.rotation);var h=H(f)[z](e);h.length-1?(h[1]=+h[1],h[2]=+h[2]):h=null,Y(f)&&n.rotate(0,!0);for(var m in i)if(i[d](m)){if(!Mt[d](m))continue;var g=i[m];switch(c[m]=g,m){case"blur":n.blur(g);break;case"rotation":n.rotate(g,!0);break;case"href":case"title":case"target":var T=l.parentNode;if(ot.call(T.tagName)!="a"){var D=Q("a");T.insertBefore(D,l),D[M](l),T=D}m=="target"&&g=="blank"?T.setAttributeNS(n.paper.xlink,"show","new"):T.setAttributeNS(n.paper.xlink,m,g);break;case"cursor":l.style.cursor=g;break;case"clip-rect":var N=H(g)[z](e);if(N[I]==4){n.clip&&n.clip.parentNode.parentNode.removeChild(n.clip.parentNode);var V=Q("clipPath"),L=Q("rect");V.id=Oe(),Q(L,{x:N[0],y:N[1],width:N[2],height:N[3]}),V[M](L),n.paper.defs[M](V),Q(l,{"clip-path":"url(#"+V.id+")"}),n.clip=L}if(!g){var P=v.getElementById(l.getAttribute("clip-path")[vt](/(^url\(#|\)$)/g,_));P&&P.parentNode.removeChild(P),Q(l,{"clip-path":_}),delete n.clip}break;case"path":n.type=="path"&&Q(l,{d:g?c.path=Me(g):"M0,0"});break;case"width":if(s(l,m,g),c.fx)m="x",g=c.x;else break;case"x":c.fx&&(g=-c.x-(c.width||0));case"rx":if(m=="rx"&&n.type=="rect")break;case"cx":h&&(m=="x"||m=="cx")&&(h[1]+=g-c[m]),s(l,m,g),n.pattern&&di(n);break;case"height":if(s(l,m,g),c.fy)m="y",g=c.y;else break;case"y":c.fy&&(g=-c.y-(c.height||0));case"ry":if(m=="ry"&&n.type=="rect")break;case"cy":h&&(m=="y"||m=="cy")&&(h[2]+=g-c[m]),s(l,m,g),n.pattern&&di(n);break;case"r":n.type=="rect"?Q(l,{rx:g,ry:g}):s(l,m,g);break;case"src":n.type=="image"&&l.setAttributeNS(n.paper.xlink,"href",g);break;case"stroke-width":l.style.strokeWidth=g,s(l,m,g),c["stroke-dasharray"]&&p(n,c["stroke-dasharray"]);break;case"stroke-dasharray":p(n,g);break;case"translation":var k=H(g)[z](e);k[0]=+k[0]||0,k[1]=+k[1]||0,h&&(h[1]+=k[0],h[2]+=k[1]),Ze.call(n,k[0],k[1]);break;case"scale":k=H(g)[z](e),n.scale(+k[0]||1,+k[1]||+k[0]||1,isNaN(Y(k[2]))?null:+k[2],isNaN(Y(k[3]))?null:+k[3]);break;case Et:var U=H(g).match(we);if(U){V=Q("pattern");var q=Q("image");V.id=Oe(),Q(V,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),Q(q,{x:0,y:0}),q.setAttributeNS(n.paper.xlink,"href",U[1]),V[M](q);var it=v.createElement("img");it.style.cssText="position:absolute;left:-9999em;top-9999em",it.onload=function(){Q(V,{width:this.offsetWidth,height:this.offsetHeight}),Q(q,{width:this.offsetWidth,height:this.offsetHeight}),v.body.removeChild(this),n.paper.safari()},v.body[M](it),it.src=U[1],n.paper.defs[M](V),l.style.fill="url(#"+V.id+")",Q(l,{fill:"url(#"+V.id+")"}),n.pattern=V,n.pattern&&di(n);break}var Z=t.getRGB(g);if(!Z.error)delete i.gradient,delete c.gradient,!t.is(c.opacity,"undefined")&&t.is(i.opacity,"undefined")&&Q(l,{opacity:c.opacity}),!t.is(c["fill-opacity"],"undefined")&&t.is(i["fill-opacity"],"undefined")&&Q(l,{"fill-opacity":c["fill-opacity"]});else if(({circle:1,ellipse:1}[d](n.type)||H(g).charAt()!="r")&&Se(l,g,n.paper)){c.gradient=g,c.fill="none";break}Z[d]("opacity")&&Q(l,{"fill-opacity":Z.opacity>1?Z.opacity/100:Z.opacity});case"stroke":Z=t.getRGB(g),s(l,m,Z.hex),m=="stroke"&&Z[d]("opacity")&&Q(l,{"stroke-opacity":Z.opacity>1?Z.opacity/100:Z.opacity});break;case"gradient":({circle:1,ellipse:1}[d](n.type)||H(g).charAt()!="r")&&Se(l,g,n.paper);break;case"opacity":c.gradient&&!c[d]("stroke-opacity")&&Q(l,{"stroke-opacity":g>1?g/100:g});case"fill-opacity":if(c.gradient){var gt=v.getElementById(l.getAttribute(Et)[vt](/^url\(#|\)$/g,_));if(gt){var ht=gt.getElementsByTagName("stop");s(ht[ht[I]-1],"stop-opacity",g)}break}default:m=="font-size"&&(g=et(g,10)+"px");var yt=m[vt](/(\-.)/g,function(at){return wt.call(at.substring(1))});l.style[yt]=g,s(l,m,g);break}}Mn(n,i),h?n.rotate(h.join(O)):Y(f)&&n.rotate(f,!0)},os=1.2,Mn=function(n,i){if(!(n.type!="text"||!(i[d]("text")||i[d]("font")||i[d]("font-size")||i[d]("x")||i[d]("y")))){var o=n.attrs,l=n.node,c=l.firstChild?et(v.defaultView.getComputedStyle(l.firstChild,_).getPropertyValue("font-size"),10):10;if(i[d]("text")){for(o.text=i.text;l.firstChild;)l.removeChild(l.firstChild);for(var f=H(i.text)[z](`
`),p=0,h=f[I];p<h;p++)if(f[p]){var m=Q("tspan");p&&Q(m,{dy:c*os,x:o.x}),m[M](v.createTextNode(f[p])),l[M](m)}}else for(f=l.getElementsByTagName("tspan"),p=0,h=f[I];p<h;p++)p&&Q(f[p],{dy:c*os,x:o.x});Q(l,{y:o.y});var g=n.getBBox(),T=o.y-(g.y+g.height/2);T&&t.is(T,"finite")&&Q(l,{y:o.y+T})}},mt=function(n,i){this[0]=n,this.id=t._oid++,this.node=n,n.raphael=this,this.paper=i,this.attrs=this.attrs||{},this.transformations=[],this._={tx:0,ty:0,rt:{deg:0,cx:0,cy:0},sx:1,sy:1},!i.bottom&&(i.bottom=this),this.prev=i.top,i.top&&(i.top.next=this),i.top=this,this.next=null},ut=mt[u];mt[u].rotate=function(n,i,o){if(this.removed)return this;if(n==null)return this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][J](O):this._.rt.deg;var l=this.getBBox();return n=H(n)[z](e),n[I]-1&&(i=Y(n[1]),o=Y(n[2])),n=Y(n[0]),i!=null&&i!==!1?this._.rt.deg=n:this._.rt.deg+=n,o==null&&(i=null),this._.rt.cx=i,this._.rt.cy=o,i=i??l.x+l.width/2,o=o??l.y+l.height/2,this._.rt.deg?(this.transformations[0]=t.format("rotate({0} {1} {2})",this._.rt.deg,i,o),this.clip&&Q(this.clip,{transform:t.format("rotate({0} {1} {2})",-this._.rt.deg,i,o)})):(this.transformations[0]=_,this.clip&&Q(this.clip,{transform:_})),Q(this.node,{transform:this.transformations[J](O)}),this},mt[u].hide=function(){return!this.removed&&(this.node.style.display="none"),this},mt[u].show=function(){return!this.removed&&(this.node.style.display=""),this},mt[u].remove=function(){if(!this.removed){he(this,this.paper),this.node.parentNode.removeChild(this.node);for(var n in this)delete this[n];this.removed=!0}},mt[u].getBBox=function(){if(this.removed)return this;if(this.type=="path")return Be(this.attrs.path);if(this.node.style.display=="none"){this.show();var n=!0}var i={};try{i=this.node.getBBox()}catch{}finally{i=i||{}}if(this.type=="text"){i={x:i.x,y:1/0,width:0,height:0};for(var o=0,l=this.node.getNumberOfChars();o<l;o++){var c=this.node.getExtentOfChar(o);c.y<i.y&&(i.y=c.y),c.y+c.height-i.y>i.height&&(i.height=c.y+c.height-i.y),c.x+c.width-i.x>i.width&&(i.width=c.x+c.width-i.x)}}return n&&this.hide(),i},mt[u].attr=function(n,i){if(this.removed)return this;if(n==null){var o={};for(var l in this.attrs)this.attrs[d](l)&&(o[l]=this.attrs[l]);return this._.rt.deg&&(o.rotation=this.rotate()),(this._.sx!=1||this._.sy!=1)&&(o.scale=this.scale()),o.gradient&&o.fill=="none"&&(o.fill=o.gradient)&&delete o.gradient,o}if(i==null&&t.is(n,W))return n=="translation"?Ze.call(this):n=="rotation"?this.rotate():n=="scale"?this.scale():n==Et&&this.attrs.fill=="none"&&this.attrs.gradient?this.attrs.gradient:this.attrs[n];if(i==null&&t.is(n,pt)){for(var c={},f=0,p=n.length;f<p;f++)c[n[f]]=this.attr(n[f]);return c}if(i!=null){var h={};h[n]=i}else n!=null&&t.is(n,"object")&&(h=n);for(var m in this.paper.customAttributes)if(this.paper.customAttributes[d](m)&&h[d](m)&&t.is(this.paper.customAttributes[m],"function")){var g=this.paper.customAttributes[m].apply(this,[][C](h[m]));this.attrs[m]=h[m];for(var T in g)g[d](T)&&(h[T]=g[T])}return Kt(this,h),this},mt[u].toFront=function(){if(this.removed)return this;this.node.parentNode[M](this.node);var n=this.paper;return n.top!=this&&Qi(this,n),this},mt[u].toBack=function(){return this.removed?this:(this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),ts(this,this.paper),this.paper),this)},mt[u].insertAfter=function(n){if(this.removed)return this;var i=n.node||n[n.length-1].node;return i.nextSibling?i.parentNode.insertBefore(this.node,i.nextSibling):i.parentNode[M](this.node),es(this,n,this.paper),this},mt[u].insertBefore=function(n){if(this.removed)return this;var i=n.node||n[0].node;return i.parentNode.insertBefore(this.node,i),is(this,n,this.paper),this},mt[u].blur=function(n){var i=this;if(+n!=0){var o=Q("filter"),l=Q("feGaussianBlur");i.attrs.blur=n,o.id=Oe(),Q(l,{stdDeviation:+n||1.5}),o.appendChild(l),i.paper.defs.appendChild(o),i._blur=o,Q(i.node,{filter:"url(#"+o.id+")"})}else i._blur&&(i._blur.parentNode.removeChild(i._blur),delete i._blur,delete i.attrs.blur),i.node.removeAttribute("filter")};var rs=function(n,i,o,l){var c=Q("circle");n.canvas&&n.canvas[M](c);var f=new mt(c,n);return f.attrs={cx:i,cy:o,r:l,fill:"none",stroke:"#000"},f.type="circle",Q(c,f.attrs),f},as=function(n,i,o,l,c,f){var p=Q("rect");n.canvas&&n.canvas[M](p);var h=new mt(p,n);return h.attrs={x:i,y:o,width:l,height:c,r:f||0,rx:f||0,ry:f||0,fill:"none",stroke:"#000"},h.type="rect",Q(p,h.attrs),h},ls=function(n,i,o,l,c){var f=Q("ellipse");n.canvas&&n.canvas[M](f);var p=new mt(f,n);return p.attrs={cx:i,cy:o,rx:l,ry:c,fill:"none",stroke:"#000"},p.type="ellipse",Q(f,p.attrs),p},cs=function(n,i,o,l,c,f){var p=Q("image");Q(p,{x:o,y:l,width:c,height:f,preserveAspectRatio:"none"}),p.setAttributeNS(n.xlink,"href",i),n.canvas&&n.canvas[M](p);var h=new mt(p,n);return h.attrs={x:o,y:l,width:c,height:f,src:i},h.type="image",h},hs=function(n,i,o,l){var c=Q("text");Q(c,{x:i,y:o,"text-anchor":"middle"}),n.canvas&&n.canvas[M](c);var f=new mt(c,n);return f.attrs={x:i,y:o,"text-anchor":"middle",text:l,font:Mt.font,stroke:"none",fill:"#000"},f.type="text",Kt(f,f.attrs),f},us=function(n,i){return this.width=n||this.width,this.height=i||this.height,s(this.canvas,"width",this.width),s(this.canvas,"height",this.height),this},fi=function(){var n=Ji[A](0,arguments),i=n&&n.container,o=n.x,l=n.y,c=n.width,f=n.height;if(!i)throw new Error("SVG container not found.");var p=Q("svg");return o=o||0,l=l||0,c=c||512,f=f||342,Q(p,{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:c,height:f}),i==1?(p.style.cssText="position:absolute;left:"+o+"px;top:"+l+"px",v.body[M](p)):i.firstChild?i.insertBefore(p,i.firstChild):i[M](p),i=new S,i.width=c,i.height=f,i.canvas=p,ui.call(i,i,t.fn),i.clear(),i};x.clear=function(){for(var n=this.canvas;n.firstChild;)n.removeChild(n.firstChild);this.bottom=this.top=null,(this.desc=Q("desc"))[M](v.createTextNode("Created with Raphaël")),n[M](this.desc),n[M](this.defs=Q("defs"))},x.remove=function(){this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var n in this)this[n]=ss(n)}}if(t.vml){let n=function(i,o,l,c,f){return f?t.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",i+f,o,l-f*2,f,-f,c-f*2,f*2-l,f*2-c):t.format("M{0},{1}l{2},0,0,{3},{4},0z",i,o,l,c,-l)};var ds={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},Sn=/([clmz]),?([^clmz]*)/gi,Tn=/ progid:\S+Blur\([^\)]+\)/g,kn=/-?[^,\s-]+/g,Te=1e3+O+1e3,ue=10,ke={path:1,rect:1},_n=function(i){var o=/[ahqstv]/ig,l=Me;if(H(i).match(o)&&(l=Xe),o=/[clmz]/g,l==Me&&!H(i).match(o)){var c=H(i)[vt](Sn,function(N,V,L){var P=[],k=ot.call(V)=="m",U=ds[V];return L[vt](kn,function(q){k&&P[I]==2&&(U+=P+ds[V=="m"?"l":"L"],P=[]),P[K](B(q*ue))}),U+P});return c}var f=l(i),p,h;c=[];for(var m=0,g=f[I];m<g;m++){p=f[m],h=ot.call(f[m][0]),h=="z"&&(h="x");for(var T=1,D=p[I];T<D;T++)h+=B(p[T]*ue)+(T!=D-1?",":_);c[K](h)}return c[J](O)};t[xt]=function(){return`Your browser doesn’t support SVG. Falling down to VML.
You are running Raphaël `+this.version},ns=function(i,o){var l=_t("group");l.style.cssText="position:absolute;left:0;top:0;width:"+o.width+"px;height:"+o.height+"px",l.coordsize=o.coordsize,l.coordorigin=o.coordorigin;var c=_t("shape"),f=c.style;f.width=o.width+"px",f.height=o.height+"px",c.coordsize=Te,c.coordorigin=o.coordorigin,l[M](c);var p=new mt(c,l,o),h={fill:"none",stroke:"#000"};return i&&(h.path=i),p.type="path",p.path=[],p.Path=_,Kt(p,h),o.canvas[M](l),p},Kt=function(i,o){i.attrs=i.attrs||{};var l=i.node,c=i.attrs,f=l.style,p,h=(o.x!=c.x||o.y!=c.y||o.width!=c.width||o.height!=c.height||o.r!=c.r)&&i.type=="rect",m=i;for(var g in o)o[d](g)&&(c[g]=o[g]);if(h&&(c.path=n(c.x,c.y,c.width,c.height,c.r),i.X=c.x,i.Y=c.y,i.W=c.width,i.H=c.height),o.href&&(l.href=o.href),o.title&&(l.title=o.title),o.target&&(l.target=o.target),o.cursor&&(f.cursor=o.cursor),"blur"in o&&i.blur(o.blur),(o.path&&i.type=="path"||h)&&(l.path=_n(c.path)),o.rotation!=null&&i.rotate(o.rotation,!0),o.translation&&(p=H(o.translation)[z](e),Ze.call(i,p[0],p[1]),i._.rt.cx!=null&&(i._.rt.cx+=+p[0],i._.rt.cy+=+p[1],i.setBox(i.attrs,p[0],p[1]))),o.scale&&(p=H(o.scale)[z](e),i.scale(+p[0]||1,+p[1]||+p[0]||1,+p[2]||null,+p[3]||null)),"clip-rect"in o){var T=H(o["clip-rect"])[z](e);if(T[I]==4){T[2]=+T[2]+ +T[0],T[3]=+T[3]+ +T[1];var D=l.clipRect||v.createElement("div"),N=D.style,V=l.parentNode;N.clip=t.format("rect({1}px {2}px {3}px {0}px)",T),l.clipRect||(N.position="absolute",N.top=0,N.left=0,N.width=i.paper.width+"px",N.height=i.paper.height+"px",V.parentNode.insertBefore(D,V),D[M](V),l.clipRect=D)}o["clip-rect"]||l.clipRect&&(l.clipRect.style.clip=_)}if(i.type=="image"&&o.src&&(l.src=o.src),i.type=="image"&&o.opacity&&(l.filterOpacity=ft+".Alpha(opacity="+o.opacity*100+")",f.filter=(l.filterMatrix||_)+(l.filterOpacity||_)),o.font&&(f.font=o.font),o["font-family"]&&(f.fontFamily='"'+o["font-family"][z](",")[0][vt](/^['"]+|['"]+$/g,_)+'"'),o["font-size"]&&(f.fontSize=o["font-size"]),o["font-weight"]&&(f.fontWeight=o["font-weight"]),o["font-style"]&&(f.fontStyle=o["font-style"]),o.opacity!=null||o["stroke-width"]!=null||o.fill!=null||o.stroke!=null||o["stroke-width"]!=null||o["stroke-opacity"]!=null||o["fill-opacity"]!=null||o["stroke-dasharray"]!=null||o["stroke-miterlimit"]!=null||o["stroke-linejoin"]!=null||o["stroke-linecap"]!=null){l=i.shape||l;var L=l.getElementsByTagName(Et)&&l.getElementsByTagName(Et)[0],P=!1;if(!L&&(P=L=_t(Et)),"fill-opacity"in o||"opacity"in o){var k=((+c["fill-opacity"]+1||2)-1)*((+c.opacity+1||2)-1)*((+t.getRGB(o.fill).o+1||2)-1);k=st(F(k,0),1),L.opacity=k}if(o.fill&&(L.on=!0),(L.on==null||o.fill=="none")&&(L.on=!1),L.on&&o.fill){var U=o.fill.match(we);U?(L.src=U[1],L.type="tile"):(L.color=t.getRGB(o.fill).hex,L.src=_,L.type="solid",t.getRGB(o.fill).error&&(m.type in{circle:1,ellipse:1}||H(o.fill).charAt()!="r")&&Se(m,o.fill)&&(c.fill="none",c.gradient=o.fill))}P&&l[M](L);var q=l.getElementsByTagName("stroke")&&l.getElementsByTagName("stroke")[0],it=!1;!q&&(it=q=_t("stroke")),(o.stroke&&o.stroke!="none"||o["stroke-width"]||o["stroke-opacity"]!=null||o["stroke-dasharray"]||o["stroke-miterlimit"]||o["stroke-linejoin"]||o["stroke-linecap"])&&(q.on=!0),(o.stroke=="none"||q.on==null||o.stroke==0||o["stroke-width"]==0)&&(q.on=!1);var Z=t.getRGB(o.stroke);q.on&&o.stroke&&(q.color=Z.hex),k=((+c["stroke-opacity"]+1||2)-1)*((+c.opacity+1||2)-1)*((+Z.o+1||2)-1);var gt=(Y(o["stroke-width"])||1)*.75;if(k=st(F(k,0),1),o["stroke-width"]==null&&(gt=c["stroke-width"]),o["stroke-width"]&&(q.weight=gt),gt&&gt<1&&(k*=gt)&&(q.weight=1),q.opacity=k,o["stroke-linejoin"]&&(q.joinstyle=o["stroke-linejoin"]||"miter"),q.miterlimit=o["stroke-miterlimit"]||8,o["stroke-linecap"]&&(q.endcap=o["stroke-linecap"]=="butt"?"flat":o["stroke-linecap"]=="square"?"square":"round"),o["stroke-dasharray"]){var ht={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};q.dashstyle=ht[d](o["stroke-dasharray"])?ht[o["stroke-dasharray"]]:_}it&&l[M](q)}if(m.type=="text")switch(f=m.paper.span.style,c.font&&(f.font=c.font),c["font-family"]&&(f.fontFamily=c["font-family"]),c["font-size"]&&(f.fontSize=c["font-size"]),c["font-weight"]&&(f.fontWeight=c["font-weight"]),c["font-style"]&&(f.fontStyle=c["font-style"]),m.node.string&&(m.paper.span.innerHTML=H(m.node.string)[vt](/</g,"&#60;")[vt](/&/g,"&#38;")[vt](/\n/g,"<br>")),m.W=c.w=m.paper.span.offsetWidth,m.H=c.h=m.paper.span.offsetHeight,m.X=c.x,m.Y=c.y+B(m.H/2),c["text-anchor"]){case"start":m.node.style["v-text-align"]="left",m.bbx=B(m.W/2);break;case"end":m.node.style["v-text-align"]="right",m.bbx=-B(m.W/2);break;default:m.node.style["v-text-align"]="center";break}},Se=function(i,o){i.attrs=i.attrs||{},i.attrs;var l,c="linear",f=".5 .5";if(i.attrs.gradient=o,o=H(o)[vt](Zi,function(D,N,V){return c="radial",N&&V&&(N=Y(N),V=Y(V),$(N-.5,2)+$(V-.5,2)>.25&&(V=X.sqrt(.25-$(N-.5,2))*((V>.5)*2-1)+.5),f=N+O+V),_}),o=o[z](/\s*\-\s*/),c=="linear"){var p=o.shift();if(p=-Y(p),isNaN(p))return null}var h=ji(o);if(!h)return null;if(i=i.shape||i.node,l=i.getElementsByTagName(Et)[0]||_t(Et),!l.parentNode&&i.appendChild(l),h[I]){l.on=!0,l.method="none",l.color=h[0].color,l.color2=h[h[I]-1].color;for(var m=[],g=0,T=h[I];g<T;g++)h[g].offset&&m[K](h[g].offset+O+h[g].color);l.colors&&(l.colors.value=m[I]?m[J]():"0% "+l.color),c=="radial"?(l.type="gradientradial",l.focus="100%",l.focussize=f,l.focusposition=f):(l.type="gradient",l.angle=(270-p)%360)}return 1},mt=function(i,o,l){this[0]=i,this.id=t._oid++,this.node=i,i.raphael=this,this.X=0,this.Y=0,this.attrs={},this.Group=o,this.paper=l,this._={tx:0,ty:0,rt:{deg:0},sx:1,sy:1},!l.bottom&&(l.bottom=this),this.prev=l.top,l.top&&(l.top.next=this),l.top=this,this.next=null},ut=mt[u],ut.rotate=function(i,o,l){return this.removed?this:i==null?this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][J](O):this._.rt.deg:(i=H(i)[z](e),i[I]-1&&(o=Y(i[1]),l=Y(i[2])),i=Y(i[0]),o!=null?this._.rt.deg=i:this._.rt.deg+=i,l==null&&(o=null),this._.rt.cx=o,this._.rt.cy=l,this.setBox(this.attrs,o,l),this.Group.style.rotation=this._.rt.deg,this)},ut.setBox=function(i,o,l){if(this.removed)return this;var c=this.Group.style,f=this.shape&&this.shape.style||this.node.style;i=i||{};for(var p in i)i[d](p)&&(this.attrs[p]=i[p]);o=o||this._.rt.cx,l=l||this._.rt.cy;var h=this.attrs,m,g,T,D;switch(this.type){case"circle":m=h.cx-h.r,g=h.cy-h.r,T=D=h.r*2;break;case"ellipse":m=h.cx-h.rx,g=h.cy-h.ry,T=h.rx*2,D=h.ry*2;break;case"image":m=+h.x,g=+h.y,T=h.width||0,D=h.height||0;break;case"text":this.textpath.v=["m",B(h.x),", ",B(h.y-2),"l",B(h.x)+1,", ",B(h.y-2)][J](_),m=h.x-B(this.W/2),g=h.y-this.H/2,T=this.W,D=this.H;break;case"rect":case"path":if(!this.attrs.path)m=0,g=0,T=this.paper.width,D=this.paper.height;else{var N=Be(this.attrs.path);m=N.x,g=N.y,T=N.width,D=N.height}break;default:m=0,g=0,T=this.paper.width,D=this.paper.height;break}o=o??m+T/2,l=l??g+D/2;var V=o-this.paper.width/2,L=l-this.paper.height/2,P;c.left!=(P=V+"px")&&(c.left=P),c.top!=(P=L+"px")&&(c.top=P),this.X=ke[d](this.type)?-V:m,this.Y=ke[d](this.type)?-L:g,this.W=T,this.H=D,ke[d](this.type)?(f.left!=(P=-V*ue+"px")&&(f.left=P),f.top!=(P=-L*ue+"px")&&(f.top=P)):this.type=="text"?(f.left!=(P=-V+"px")&&(f.left=P),f.top!=(P=-L+"px")&&(f.top=P)):(c.width!=(P=this.paper.width+"px")&&(c.width=P),c.height!=(P=this.paper.height+"px")&&(c.height=P),f.left!=(P=m-V+"px")&&(f.left=P),f.top!=(P=g-L+"px")&&(f.top=P),f.width!=(P=T+"px")&&(f.width=P),f.height!=(P=D+"px")&&(f.height=P))},ut.hide=function(){return!this.removed&&(this.Group.style.display="none"),this},ut.show=function(){return!this.removed&&(this.Group.style.display="block"),this},ut.getBBox=function(){return this.removed?this:ke[d](this.type)?Be(this.attrs.path):{x:this.X+(this.bbx||0),y:this.Y,width:this.W,height:this.H}},ut.remove=function(){if(!this.removed){he(this,this.paper),this.node.parentNode.removeChild(this.node),this.Group.parentNode.removeChild(this.Group),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var i in this)delete this[i];this.removed=!0}},ut.attr=function(i,o){if(this.removed)return this;if(i==null){var l={};for(var c in this.attrs)this.attrs[d](c)&&(l[c]=this.attrs[c]);return this._.rt.deg&&(l.rotation=this.rotate()),(this._.sx!=1||this._.sy!=1)&&(l.scale=this.scale()),l.gradient&&l.fill=="none"&&(l.fill=l.gradient)&&delete l.gradient,l}if(o==null&&t.is(i,"string"))return i=="translation"?Ze.call(this):i=="rotation"?this.rotate():i=="scale"?this.scale():i==Et&&this.attrs.fill=="none"&&this.attrs.gradient?this.attrs.gradient:this.attrs[i];if(this.attrs&&o==null&&t.is(i,pt)){var f,p={};for(c=0,f=i[I];c<f;c++)p[i[c]]=this.attr(i[c]);return p}var h;if(o!=null&&(h={},h[i]=o),o==null&&t.is(i,"object")&&(h=i),h){for(var m in this.paper.customAttributes)if(this.paper.customAttributes[d](m)&&h[d](m)&&t.is(this.paper.customAttributes[m],"function")){var g=this.paper.customAttributes[m].apply(this,[][C](h[m]));this.attrs[m]=h[m];for(var T in g)g[d](T)&&(h[T]=g[T])}h.text&&this.type=="text"&&(this.node.string=h.text),Kt(this,h),h.gradient&&({circle:1,ellipse:1}[d](this.type)||H(h.gradient).charAt()!="r")&&Se(this,h.gradient),(!ke[d](this.type)||this._.rt.deg)&&this.setBox(this.attrs)}return this},ut.toFront=function(){return!this.removed&&this.Group.parentNode[M](this.Group),this.paper.top!=this&&Qi(this,this.paper),this},ut.toBack=function(){return this.removed?this:(this.Group.parentNode.firstChild!=this.Group&&(this.Group.parentNode.insertBefore(this.Group,this.Group.parentNode.firstChild),ts(this,this.paper)),this)},ut.insertAfter=function(i){return this.removed?this:(i.constructor==It&&(i=i[i.length-1]),i.Group.nextSibling?i.Group.parentNode.insertBefore(this.Group,i.Group.nextSibling):i.Group.parentNode[M](this.Group),es(this,i,this.paper),this)},ut.insertBefore=function(i){return this.removed?this:(i.constructor==It&&(i=i[0]),i.Group.parentNode.insertBefore(this.Group,i.Group),is(this,i,this.paper),this)},ut.blur=function(i){var o=this.node.runtimeStyle,l=o.filter;l=l.replace(Tn,_),+i!=0?(this.attrs.blur=i,o.filter=l+O+ft+".Blur(pixelradius="+(+i||1.5)+")",o.margin=t.format("-{0}px 0 0 -{0}px",B(+i||1.5))):(o.filter=l,o.margin=0,delete this.attrs.blur)},rs=function(i,o,l,c){var f=_t("group"),p=_t("oval");p.style,f.style.cssText="position:absolute;left:0;top:0;width:"+i.width+"px;height:"+i.height+"px",f.coordsize=Te,f.coordorigin=i.coordorigin,f[M](p);var h=new mt(p,f,i);return h.type="circle",Kt(h,{stroke:"#000",fill:"none"}),h.attrs.cx=o,h.attrs.cy=l,h.attrs.r=c,h.setBox({x:o-c,y:l-c,width:c*2,height:c*2}),i.canvas[M](f),h},as=function(i,o,l,c,f,p){var h=n(o,l,c,f,p),m=i.path(h),g=m.attrs;return m.X=g.x=o,m.Y=g.y=l,m.W=g.width=c,m.H=g.height=f,g.r=p,g.path=h,m.type="rect",m},ls=function(i,o,l,c,f){var p=_t("group"),h=_t("oval");h.style,p.style.cssText="position:absolute;left:0;top:0;width:"+i.width+"px;height:"+i.height+"px",p.coordsize=Te,p.coordorigin=i.coordorigin,p[M](h);var m=new mt(h,p,i);return m.type="ellipse",Kt(m,{stroke:"#000"}),m.attrs.cx=o,m.attrs.cy=l,m.attrs.rx=c,m.attrs.ry=f,m.setBox({x:o-c,y:l-f,width:c*2,height:f*2}),i.canvas[M](p),m},cs=function(i,o,l,c,f,p){var h=_t("group"),m=_t("image");h.style.cssText="position:absolute;left:0;top:0;width:"+i.width+"px;height:"+i.height+"px",h.coordsize=Te,h.coordorigin=i.coordorigin,m.src=o,h[M](m);var g=new mt(m,h,i);return g.type="image",g.attrs.src=o,g.attrs.x=l,g.attrs.y=c,g.attrs.w=f,g.attrs.h=p,g.setBox({x:l,y:c,width:f,height:p}),i.canvas[M](h),g},hs=function(i,o,l,c){var f=_t("group"),p=_t("shape"),h=p.style,m=_t("path");m.style;var g=_t("textpath");f.style.cssText="position:absolute;left:0;top:0;width:"+i.width+"px;height:"+i.height+"px",f.coordsize=Te,f.coordorigin=i.coordorigin,m.v=t.format("m{0},{1}l{2},{1}",B(o*10),B(l*10),B(o*10)+1),m.textpathok=!0,h.width=i.width,h.height=i.height,g.string=H(c),g.on=!0,p[M](g),p[M](m),f[M](p);var T=new mt(g,f,i);return T.shape=p,T.textpath=m,T.type="text",T.attrs.text=c,T.attrs.x=o,T.attrs.y=l,T.attrs.w=1,T.attrs.h=1,Kt(T,{font:Mt.font,stroke:"none",fill:"#000"}),T.setBox(),i.canvas[M](f),T},us=function(i,o){var l=this.canvas.style;return i==+i&&(i+="px"),o==+o&&(o+="px"),l.width=i,l.height=o,l.clip="rect(0 "+i+" "+o+" 0)",this};var _t;v.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!v.namespaces.rvml&&v.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),_t=function(i){return v.createElement("<rvml:"+i+' class="rvml">')}}catch{_t=function(o){return v.createElement("<"+o+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}fi=function(){var i=Ji[A](0,arguments),o=i.container,l=i.height,c=i.width,f=i.x,p=i.y;if(!o)throw new Error("VML container not found.");var h=new S,m=h.canvas=v.createElement("div"),g=m.style;return f=f||0,p=p||0,c=c||512,l=l||342,c==+c&&(c+="px"),l==+l&&(l+="px"),h.width=1e3,h.height=1e3,h.coordsize=ue*1e3+O+ue*1e3,h.coordorigin="0 0",h.span=v.createElement("span"),h.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",m[M](h.span),g.cssText=t.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",c,l),o==1?(v.body[M](m),g.left=f+"px",g.top=p+"px",g.position="absolute"):o.firstChild?o.insertBefore(m,o.firstChild):o[M](m),ui.call(h,h,t.fn),h},x.clear=function(){this.canvas.innerHTML=_,this.span=v.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas[M](this.span),this.bottom=this.top=null},x.remove=function(){this.canvas.parentNode.removeChild(this.canvas);for(var i in this)this[i]=ss(i);return!0}}var fs=navigator.userAgent.match(/Version\/(.*?)\s/);navigator.vendor=="Apple Computer, Inc."&&(fs&&fs[1]<4||navigator.platform.slice(0,2)=="iP")?x.safari=function(){var n=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});y.setTimeout(function(){n.remove()})}:x.safari=function(){};for(var Cn=function(){this.returnValue=!1},Pn=function(){return this.originalEvent.preventDefault()},An=function(){this.cancelBubble=!0},En=function(){return this.originalEvent.stopPropagation()},In=function(){if(v.addEventListener)return function(n,i,o,l){var c=R&&tt[i]?tt[i]:i,f=function(p){if(R&&tt[d](i)){for(var h=0,m=p.targetTouches&&p.targetTouches.length;h<m;h++)if(p.targetTouches[h].target==n){var g=p;p=p.targetTouches[h],p.originalEvent=g,p.preventDefault=Pn,p.stopPropagation=En;break}}return o.call(l,p)};return n.addEventListener(c,f,!1),function(){return n.removeEventListener(c,f,!1),!0}};if(v.attachEvent)return function(n,i,o,l){var c=function(p){return p=p||y.event,p.preventDefault=p.preventDefault||Cn,p.stopPropagation=p.stopPropagation||An,o.call(l,p)};n.attachEvent("on"+i,c);var f=function(){return n.detachEvent("on"+i,c),!0};return f}}(),Ht=[],pi=function(n){for(var i=n.clientX,o=n.clientY,l=v.documentElement.scrollTop||v.body.scrollTop,c=v.documentElement.scrollLeft||v.body.scrollLeft,f,p=Ht.length;p--;){if(f=Ht[p],R){for(var h=n.touches.length,m;h--;)if(m=n.touches[h],m.identifier==f.el._drag.id){i=m.clientX,o=m.clientY,(n.originalEvent?n.originalEvent:n).preventDefault();break}}else n.preventDefault();i+=c,o+=l,f.move&&f.move.call(f.move_scope||f.el,i-f.el._drag.x,o-f.el._drag.y,i,o,n)}},mi=function(n){t.unmousemove(pi).unmouseup(mi);for(var i=Ht.length,o;i--;)o=Ht[i],o.el._drag={},o.end&&o.end.call(o.end_scope||o.start_scope||o.move_scope||o.el,n);Ht=[]},ps=j[I];ps--;)(function(n){t[n]=mt[u][n]=function(i,o){return t.is(i,"function")&&(this.events=this.events||[],this.events.push({name:n,f:i,unbind:In(this.shape||this.node||v,n,i,o||this)})),this},t["un"+n]=mt[u]["un"+n]=function(i){for(var o=this.events,l=o[I];l--;)if(o[l].name==n&&o[l].f==i)return o[l].unbind(),o.splice(l,1),!o.length&&delete this.events,this;return this}})(j[ps]);ut.hover=function(n,i,o,l){return this.mouseover(n,o).mouseout(i,l||o)},ut.unhover=function(n,i){return this.unmouseover(n).unmouseout(i)},ut.drag=function(n,i,o,l,c,f){return this._drag={},this.mousedown(function(p){(p.originalEvent||p).preventDefault();var h=v.documentElement.scrollTop||v.body.scrollTop,m=v.documentElement.scrollLeft||v.body.scrollLeft;this._drag.x=p.clientX+m,this._drag.y=p.clientY+h,this._drag.id=p.identifier,i&&i.call(c||l||this,p.clientX+m,p.clientY+h,p),!Ht.length&&t.mousemove(pi).mouseup(mi),Ht.push({el:this,move:n,end:o,move_scope:l,start_scope:c,end_scope:f})}),this},ut.undrag=function(n,i,o){for(var l=Ht.length;l--;)Ht[l].el==this&&Ht[l].move==n&&Ht[l].end==o&&Ht.splice(l++,1);!Ht.length&&t.unmousemove(pi).unmouseup(mi)},x.circle=function(n,i,o){return rs(this,n||0,i||0,o||0)},x.rect=function(n,i,o,l,c){return as(this,n||0,i||0,o||0,l||0,c||0)},x.ellipse=function(n,i,o,l){return ls(this,n||0,i||0,o||0,l||0)},x.path=function(n){return n&&!t.is(n,W)&&!t.is(n[0],pt)&&(n+=_),ns(t.format[A](t,arguments),this)},x.image=function(n,i,o,l,c){return cs(this,n||"about:blank",i||0,o||0,l||0,c||0)},x.text=function(n,i,o){return hs(this,n||0,i||0,H(o))},x.set=function(n){return arguments[I]>1&&(n=Array[u].splice.call(arguments,0,arguments[I])),new It(n)},x.setSize=us,x.top=x.bottom=null,x.raphael=t;function ms(){return this.x+O+this.y}ut.resetScale=function(){if(this.removed)return this;this._.sx=1,this._.sy=1,this.attrs.scale="1 1"},ut.scale=function(n,i,o,l){if(this.removed)return this;if(n==null&&i==null)return{x:this._.sx,y:this._.sy,toString:ms};i=i||n,!+i&&(i=n);var c,f,p=this.attrs;if(n!=0){var h=this.getBBox(),m=h.x+h.width/2,g=h.y+h.height/2,T=nt(n/this._.sx),D=nt(i/this._.sy);o=+o||o==0?o:m,l=+l||l==0?l:g;var N=this._.sx>0,V=this._.sy>0,L=~~(n/nt(n)),P=~~(i/nt(i)),k=T*L,U=D*P,q=this.node.style,it=o+nt(m-o)*k*(m>o==N?1:-1),Z=l+nt(g-l)*U*(g>l==V?1:-1),gt=n*L>i*P?D:T;switch(this.type){case"rect":case"image":var ht=p.width*T,yt=p.height*D;this.attr({height:yt,r:p.r*gt,width:ht,x:it-ht/2,y:Z-yt/2});break;case"circle":case"ellipse":this.attr({rx:p.rx*T,ry:p.ry*D,r:p.r*gt,cx:it,cy:Z});break;case"text":this.attr({x:it,y:Z});break;case"path":for(var at=hi(p.path),St=!0,Dt=N?k:T,Yt=V?U:D,Ut=0,Qt=at[I];Ut<Qt;Ut++){var Pt=at[Ut],de=wt.call(Pt[0]);if(!(de=="M"&&St))if(St=!1,de=="A")Pt[at[Ut][I]-2]*=Dt,Pt[at[Ut][I]-1]*=Yt,Pt[1]*=T,Pt[2]*=D,Pt[5]=+(L+P?!!+Pt[5]:!+Pt[5]);else if(de=="H")for(var Nt=1,te=Pt[I];Nt<te;Nt++)Pt[Nt]*=Dt;else if(de=="V")for(Nt=1,te=Pt[I];Nt<te;Nt++)Pt[Nt]*=Yt;else for(Nt=1,te=Pt[I];Nt<te;Nt++)Pt[Nt]*=Nt%2?Dt:Yt}var oe=Be(at);c=it-oe.x-oe.width/2,f=Z-oe.y-oe.height/2,at[0][1]+=c,at[0][2]+=f,this.attr({path:at});break}this.type in{text:1,image:1}&&(L!=1||P!=1)?this.transformations?(this.transformations[2]="scale("[C](L,",",P,")"),s(this.node,"transform",this.transformations[J](O)),c=L==-1?-p.x-(ht||0):p.x,f=P==-1?-p.y-(yt||0):p.y,this.attr({x:c,y:f}),p.fx=L-1,p.fy=P-1):(this.node.filterMatrix=ft+".Matrix(M11="[C](L,", M12=0, M21=0, M22=",P,", Dx=0, Dy=0, sizingmethod='auto expand', filtertype='bilinear')"),q.filter=(this.node.filterMatrix||_)+(this.node.filterOpacity||_)):this.transformations?(this.transformations[2]=_,s(this.node,"transform",this.transformations[J](O)),p.fx=0,p.fy=0):(this.node.filterMatrix=_,q.filter=(this.node.filterMatrix||_)+(this.node.filterOpacity||_)),p.scale=[n,i,o,l][J](O),this._.sx=n,this._.sy=i}return this},ut.clone=function(){if(this.removed)return null;var n=this.attr();return delete n.scale,delete n.translation,this.paper[this.type]().attr(n)};var gi={},qe=function(n,i,o,l,c,f,p,h,m){if(n===o&&i===l&&c===p&&f==h){var g=p-n,T=h-i,D=Math.sqrt(g*g+T*T);if(m==null)return D;var N=m/D;return{start:{x:n,y:i},m:{x:n,y:i},n:{x:p,y:h},end:{x:p,y:h},x:n+N*g,y:i+N*T,alpha:90-X.atan(g/T)*180/lt}}var V=0,L=100,P=[n,i,o,l,c,f,p,h].join(),k=gi[P],U,q;if(!k&&(gi[P]=k={data:[]}),k.timer&&clearTimeout(k.timer),k.timer=setTimeout(function(){delete gi[P]},2e3),m!=null){var it=qe(n,i,o,l,c,f,p,h);L=~~it*10}for(var Z=0;Z<L+1;Z++){if(k.data[m]>Z?q=k.data[Z*L]:(q=t.findDotsAtSegment(n,i,o,l,c,f,p,h,Z/L),k.data[Z]=q),Z&&(V+=$($(U.x-q.x,2)+$(U.y-q.y,2),.5)),m!=null&&V>=m)return q;U=q}if(m==null)return V},vi=function(n,i){return function(o,l,c){o=Xe(o);for(var f,p,h,m,g="",T={},D,N=0,V=0,L=o.length;V<L;V++){if(h=o[V],h[0]=="M")f=+h[1],p=+h[2];else{if(m=qe(f,p,h[1],h[2],h[3],h[4],h[5],h[6]),N+m>l){if(i&&!T.start){if(D=qe(f,p,h[1],h[2],h[3],h[4],h[5],h[6],l-N),g+=["C",D.start.x,D.start.y,D.m.x,D.m.y,D.x,D.y],c)return g;T.start=g,g=["M",D.x,D.y+"C",D.n.x,D.n.y,D.end.x,D.end.y,h[5],h[6]][J](),N+=m,f=+h[5],p=+h[6];continue}if(!n&&!i)return D=qe(f,p,h[1],h[2],h[3],h[4],h[5],h[6],l-N),{x:D.x,y:D.y,alpha:D.alpha}}N+=m,f=+h[5],p=+h[6]}g+=h}return T.end=g,D=n?N:i?T:t.findDotsAtSegment(f,p,h[1],h[2],h[3],h[4],h[5],h[6],1),D.alpha&&(D={x:D.x,y:D.y,alpha:D.alpha}),D}},gs=vi(1),Ue=vi(),bi=vi(0,1);ut.getTotalLength=function(){if(this.type=="path")return this.node.getTotalLength?this.node.getTotalLength():gs(this.attrs.path)},ut.getPointAtLength=function(n){if(this.type=="path")return Ue(this.attrs.path,n)},ut.getSubpath=function(n,i){if(this.type=="path"){if(nt(this.getTotalLength()-i)<"1e-6")return bi(this.attrs.path,n).end;var o=bi(this.attrs.path,i,1);return n?bi(o,n).end:o}},t.easing_formulas={linear:function(n){return n},"<":function(n){return $(n,3)},">":function(n){return $(n-1,3)+1},"<>":function(n){return n=n*2,n<1?$(n,3)/2:(n-=2,($(n,3)+2)/2)},backIn:function(n){var i=1.70158;return n*n*((i+1)*n-i)},backOut:function(n){n=n-1;var i=1.70158;return n*n*((i+1)*n+i)+1},elastic:function(n){if(n==0||n==1)return n;var i=.3,o=i/4;return $(2,-10*n)*X.sin((n-o)*(2*lt)/i)+1},bounce:function(n){var i=7.5625,o=2.75,l;return n<1/o?l=i*n*n:n<2/o?(n-=1.5/o,l=i*n*n+.75):n<2.5/o?(n-=2.25/o,l=i*n*n+.9375):(n-=2.625/o,l=i*n*n+.984375),l}};var Ot=[],vs=function(){for(var n=+new Date,i=0;i<Ot[I];i++){var o=Ot[i];if(!(o.stop||o.el.removed)){var l=n-o.start,c=o.ms,f=o.easing,p=o.from,h=o.diff,m=o.to,g=o.t,T=o.el,D={},N;if(l<c){var V=f(l/c);for(var L in p)if(p[d](L)){switch(Ct[L]){case"along":N=V*c*h[L],m.back&&(N=m.len-N);var P=Ue(m[L],N);T.translate(h.sx-h.x||0,h.sy-h.y||0),h.x=P.x,h.y=P.y,T.translate(P.x-h.sx,P.y-h.sy),m.rot&&T.rotate(h.r+P.alpha,P.x,P.y);break;case rt:N=+p[L]+V*c*h[L];break;case"colour":N="rgb("+[yi(B(p[L].r+V*c*h[L].r)),yi(B(p[L].g+V*c*h[L].g)),yi(B(p[L].b+V*c*h[L].b))][J](",")+")";break;case"path":N=[];for(var k=0,U=p[L][I];k<U;k++){N[k]=[p[L][k][0]];for(var q=1,it=p[L][k][I];q<it;q++)N[k][q]=+p[L][k][q]+V*c*h[L][k][q];N[k]=N[k][J](O)}N=N[J](O);break;case"csv":switch(L){case"translation":var Z=V*c*h[L][0]-g.x,gt=V*c*h[L][1]-g.y;g.x+=Z,g.y+=gt,N=Z+O+gt;break;case"rotation":N=+p[L][0]+V*c*h[L][0],p[L][1]&&(N+=","+p[L][1]+","+p[L][2]);break;case"scale":N=[+p[L][0]+V*c*h[L][0],+p[L][1]+V*c*h[L][1],2 in m[L]?m[L][2]:_,3 in m[L]?m[L][3]:_][J](O);break;case"clip-rect":for(N=[],k=4;k--;)N[k]=+p[L][k]+V*c*h[L][k];break}break;default:var ht=[].concat(p[L]);for(N=[],k=T.paper.customAttributes[L].length;k--;)N[k]=+ht[k]+V*c*h[L][k];break}D[L]=N}T.attr(D),T._run&&T._run.call(T)}else m.along&&(P=Ue(m.along,m.len*!m.back),T.translate(h.sx-(h.x||0)+P.x-h.sx,h.sy-(h.y||0)+P.y-h.sy),m.rot&&T.rotate(h.r+P.alpha,P.x,P.y)),(g.x||g.y)&&T.translate(-g.x,-g.y),m.scale&&(m.scale+=_),T.attr(m),Ot.splice(i--,1)}}t.svg&&T&&T.paper&&T.paper.safari(),Ot[I]&&setTimeout(vs)},Ln=function(n,i,o,l,c){var f=o-l;i.timeouts.push(setTimeout(function(){t.is(c,"function")&&c.call(i),i.animate(n,f,n.easing)},l))},yi=function(n){return F(st(n,255),0)},Ze=function(n,i){if(n==null)return{x:this._.tx,y:this._.ty,toString:ms};switch(this._.tx+=+n,this._.ty+=+i,this.type){case"circle":case"ellipse":this.attr({cx:+n+this.attrs.cx,cy:+i+this.attrs.cy});break;case"rect":case"image":case"text":this.attr({x:+n+this.attrs.x,y:+i+this.attrs.y});break;case"path":var o=hi(this.attrs.path);o[0][1]+=+n,o[0][2]+=+i,this.attr({path:o});break}return this};ut.animateWith=function(n,i,o,l,c){for(var f=0,p=Ot.length;f<p;f++)Ot[f].el.id==n.id&&(i.start=Ot[f].start);return this.animate(i,o,l,c)},ut.animateAlong=bs(),ut.animateAlongBack=bs(1);function bs(n){return function(i,o,l,c){var f={back:n};return t.is(l,"function")?c=l:f.rot=l,i&&i.constructor==mt&&(i=i.attrs.path),i&&(f.along=i),this.animate(f,o,c)}}function Rn(n,i,o,l,c,f){var p=3*i,h=3*(l-i)-p,m=1-p-h,g=3*o,T=3*(c-o)-g,D=1-g-T;function N(P){return((m*P+h)*P+p)*P}function V(P,k){var U=L(P,k);return((D*U+T)*U+g)*U}function L(P,k){var U,q,it,Z,gt,ht;for(it=P,ht=0;ht<8;ht++){if(Z=N(it)-P,nt(Z)<k)return it;if(gt=(3*m*it+2*h)*it+p,nt(gt)<1e-6)break;it=it-Z/gt}if(U=0,q=1,it=P,it<U)return U;if(it>q)return q;for(;U<q;){if(Z=N(it),nt(Z-P)<k)return it;P>Z?U=it:q=it,it=(q-U)/2+U}return it}return V(n,1/(200*f))}ut.onAnimation=function(n){return this._run=n||0,this},ut.animate=function(n,i,o,l){var c=this;if(c.timeouts=c.timeouts||[],(t.is(o,"function")||!o)&&(l=o||null),c.removed)return l&&l.call(c),c;var f={},p={},h=!1,m={};for(var g in n)if(n[d](g)&&(Ct[d](g)||c.paper.customAttributes[d](g)))switch(h=!0,f[g]=c.attr(g),f[g]==null&&(f[g]=Mt[g]),p[g]=n[g],Ct[g]){case"along":var T=gs(n[g]),D=Ue(n[g],T*!!n.back),N=c.getBBox();m[g]=T/i,m.tx=N.x,m.ty=N.y,m.sx=D.x,m.sy=D.y,p.rot=n.rot,p.back=n.back,p.len=T,n.rot&&(m.r=Y(c.rotate())||0);break;case rt:m[g]=(p[g]-f[g])/i;break;case"colour":f[g]=t.getRGB(f[g]);var V=t.getRGB(p[g]);m[g]={r:(V.r-f[g].r)/i,g:(V.g-f[g].g)/i,b:(V.b-f[g].b)/i};break;case"path":var L=Xe(f[g],p[g]);f[g]=L[0];var P=L[1];m[g]=[];for(var k=0,U=f[g][I];k<U;k++){m[g][k]=[0];for(var q=1,it=f[g][k][I];q<it;q++)m[g][k][q]=(P[k][q]-f[g][k][q])/i}break;case"csv":var Z=H(n[g])[z](e),gt=H(f[g])[z](e);switch(g){case"translation":f[g]=[0,0],m[g]=[Z[0]/i,Z[1]/i];break;case"rotation":f[g]=gt[1]==Z[1]&&gt[2]==Z[2]?gt:[0,Z[1],Z[2]],m[g]=[(Z[0]-f[g][0])/i,0,0];break;case"scale":n[g]=Z,f[g]=H(f[g])[z](e),m[g]=[(Z[0]-f[g][0])/i,(Z[1]-f[g][1])/i,0,0];break;case"clip-rect":for(f[g]=H(f[g])[z](e),m[g]=[],k=4;k--;)m[g][k]=(Z[k]-f[g][k])/i;break}p[g]=Z;break;default:for(Z=[].concat(n[g]),gt=[].concat(f[g]),m[g]=[],k=c.paper.customAttributes[g][I];k--;)m[g][k]=((Z[k]||0)-(gt[k]||0))/i;break}if(h){var St=t.easing_formulas[o];if(!St)if(St=H(o).match(le),St&&St[I]==5){var Dt=St;St=function(Yt){return Rn(Yt,+Dt[1],+Dt[2],+Dt[3],+Dt[4],i)}}else St=function(Yt){return Yt};Ot.push({start:n.start||+new Date,ms:i,easing:St,from:f,diff:m,to:p,el:c,t:{x:0,y:0}}),t.is(l,"function")&&(c._ac=setTimeout(function(){l.call(c)},i)),Ot[I]==1&&setTimeout(vs)}else{var ht=[],yt;for(var at in n)n[d](at)&&xe.test(at)&&(g={value:n[at]},at=="from"&&(at=0),at=="to"&&(at=100),g.key=et(at,10),ht.push(g));for(ht.sort(bn),ht[0].key&&ht.unshift({key:0,value:c.attrs}),k=0,U=ht[I];k<U;k++)Ln(ht[k].value,c,i/100*ht[k].key,i/100*(ht[k-1]&&ht[k-1].key||0),ht[k-1]&&ht[k-1].value.callback);yt=ht[ht[I]-1].value.callback,yt&&c.timeouts.push(setTimeout(function(){yt.call(c)},i))}return this},ut.stop=function(){for(var n=0;n<Ot.length;n++)Ot[n].el.id==this.id&&Ot.splice(n--,1);for(n=0,ii=this.timeouts&&this.timeouts.length;n<ii;n++)clearTimeout(this.timeouts[n]);return this.timeouts=[],clearTimeout(this._ac),delete this._ac,this},ut.translate=function(n,i){return this.attr({translation:n+" "+i})},ut[xt]=function(){return"Raphaël’s object"},t.ae=Ot;var It=function(n){if(this.items=[],this[I]=0,this.type="set",n)for(var i=0,o=n[I];i<o;i++)n[i]&&(n[i].constructor==mt||n[i].constructor==It)&&(this[this.items[I]]=this.items[this.items[I]]=n[i],this[I]++)};It[u][K]=function(){for(var n,i,o=0,l=arguments[I];o<l;o++)n=arguments[o],n&&(n.constructor==mt||n.constructor==It)&&(i=this.items[I],this[i]=this.items[i]=n,this[I]++);return this},It[u].pop=function(){return delete this[this[I]--],this.items.pop()};for(var wi in ut)ut[d](wi)&&(It[u][wi]=function(n){return function(){for(var i=0,o=this.items[I];i<o;i++)this.items[i][n][A](this.items[i],arguments);return this}}(wi));return It[u].attr=function(n,i){if(n&&t.is(n,pt)&&t.is(n[0],"object"))for(var o=0,l=n[I];o<l;o++)this.items[o].attr(n[o]);else for(var c=0,f=this.items[I];c<f;c++)this.items[c].attr(n,i);return this},It[u].animate=function(n,i,o,l){(t.is(o,"function")||!o)&&(l=o||null);var c=this.items[I],f=c,p,h=this,m;for(l&&(m=function(){!--c&&l.call(h)}),o=t.is(o,W)?o:m,p=this.items[--f].animate(n,i,o,m);f--;)this.items[f]&&!this.items[f].removed&&this.items[f].animateWith(p,n,i,o,m);return this},It[u].insertAfter=function(n){for(var i=this.items[I];i--;)this.items[i].insertAfter(n);return this},It[u].getBBox=function(){for(var n=[],i=[],o=[],l=[],c=this.items[I];c--;){var f=this.items[c].getBBox();n[K](f.x),i[K](f.y),o[K](f.x+f.width),l[K](f.y+f.height)}return n=st[A](0,n),i=st[A](0,i),{x:n,y:i,width:F[A](0,o)-n,height:F[A](0,l)-i}},It[u].clone=function(n){n=new It;for(var i=0,o=this.items[I];i<o;i++)n[K](this.items[i].clone());return n},t.registerFont=function(n){if(!n.face)return n;this.fonts=this.fonts||{};var i={w:n.w,face:{},glyphs:{}},o=n.face["font-family"];for(var l in n.face)n.face[d](l)&&(i.face[l]=n.face[l]);if(this.fonts[o]?this.fonts[o][K](i):this.fonts[o]=[i],!n.svg){i.face["units-per-em"]=et(n.face["units-per-em"],10);for(var c in n.glyphs)if(n.glyphs[d](c)){var f=n.glyphs[c];if(i.glyphs[c]={w:f.w,k:{},d:f.d&&"M"+f.d[vt](/[mlcxtrv]/g,function(h){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[h]||"M"})+"z"},f.k)for(var p in f.k)f[d](p)&&(i.glyphs[c].k[p]=f.k[p])}}return n},x.getFont=function(n,i,o,l){if(l=l||"normal",o=o||"normal",i=+i||{normal:400,bold:700,lighter:300,bolder:800}[i]||400,!!t.fonts){var c=t.fonts[n];if(!c){var f=new RegExp("(^|\\s)"+n[vt](/[^\w\d\s+!~.:_-]/g,_)+"(\\s|$)","i");for(var p in t.fonts)if(t.fonts[d](p)&&f.test(p)){c=t.fonts[p];break}}var h;if(c)for(var m=0,g=c[I];m<g&&(h=c[m],!(h.face["font-weight"]==i&&(h.face["font-style"]==o||!h.face["font-style"])&&h.face["font-stretch"]==l));m++);return h}},x.print=function(n,i,o,l,c,f,p){f=f||"middle",p=F(st(p||0,1),-1);var h=this.set(),m=H(o)[z](_),g=0,T;if(t.is(l,o)&&(l=this.getFont(l)),l){T=(c||16)/l.face["units-per-em"];for(var D=l.face.bbox.split(e),N=+D[0],V=+D[1]+(f=="baseline"?D[3]-D[1]+ +l.face.descent:(D[3]-D[1])/2),L=0,P=m[I];L<P;L++){var k=L&&l.glyphs[m[L-1]]||{},U=l.glyphs[m[L]];g+=L?(k.w||l.w)+(k.k&&k.k[m[L]]||0)+l.w*p:0,U&&U.d&&h[K](this.path(U.d).attr({fill:"#000",stroke:"none",translation:[g,0]}))}h.scale(T,T,N,V).translate(n-N,i-V)}return h},t.format=function(n,i){var o=t.is(i,pt)?[0][C](i):arguments;return n&&t.is(n,W)&&o[I]-1&&(n=n[vt](a,function(l,c){return o[++c]==null?_:o[c]})),n||_},t.ninja=function(){return b.was?y.Raphael=b.is:Raphael=void 0,t},t.el=ut,t.st=It[u],t}(),G={BLUE:Ce.blue,PINK:"#FF00AF",GREEN:Ce.green,PURPLE:"#9D38BD",RED:"#DF0030",GRAY:"gray",BLACK:"black",LIGHT_BLUE:"#9AB8ED",LIGHT_ORANGE:"#EDD19B",LIGHT_PINK:"#ED9BD3",LIGHT_GREEN:"#9BEDCE",LIGHT_PURPLE:"#DA9BED",LIGHT_RED:"#ED9AAC",BLUE_C:"#63D9EA",GRAY_C:"#E3E5E6",GRAY_F:"#888D93",GRAY_G:"#626569",KA_GREEN:"#71B307",_BACKGROUND:"#FDFDFD",INTERACTING:Ce.green,INTERACTIVE:Ce.green,DYNAMIC:Ce.blue};class ao{constructor(t,e,r){this.scaleVector=a=>{if(typeof a=="number")return this.scaleVector([a,a]);const u=a[0],d=a[1];return[u*this.xScale,d*this.yScale]},this.scalePoint=a=>{if(typeof a=="number")return this.scalePoint([a,a]);const u=a[0],d=a[1];return[(u-this.bounds.xMin)*this.xScale,(this.bounds.yMax-d)*this.yScale]},this.unscalePoint=a=>{if(typeof a=="number")return this.unscalePoint([a,a]);const u=a[0],d=a[1];return[u/this.xScale+this.bounds.xMin,this.bounds.yMax-d/this.yScale]},this.unscaleVector=a=>typeof a=="number"?this.unscaleVector([a,a]):[a[0]/this.xScale,a[1]/this.yScale],this.setScale=a=>{typeof a=="number"&&(a=[a,a]),this.xScale=a[0],this.yScale=a[1],this.raphael.setSize(...this.canvasDimensions())},this.canvasDimensions=()=>[this.bounds.width()*this.xScale,this.bounds.height()*this.yScale],this.pixelsPerUnitX=()=>this.xScale,this.pixelsPerUnitY=()=>this.yScale,this.raphael=t,this.bounds=r,this.xScale=e[0],this.yScale=e[1],this.setScale(e)}}class lo{constructor(t,e){this.xMin=t[0],this.xMax=t[1],this.yMin=e[0],this.yMax=e[1]}width(){return this.xMax-this.xMin}height(){return this.yMax-this.yMin}}const Ls=new WeakMap;function Js(s,t){const e=Tt.createElement(Xn,{throwIfNested:!1},s);let r=Ls.get(t);r==null&&(r=qn(t),Ls.set(t,r)),r.render(e)}function co(s,t){const e=E(s).find("."+t);return e.length===0?E("<span>").addClass(t).appendTo(E(s)):e}const Qs={processMath:async function(s,t,e,r){const a=E(s);if(a.attr("data-math-formula")==null||e){const u=co(a,"tex-holder");t==null&&a.attr("data-math-formula")&&(t=a.attr("data-math-formula")),t=t!=null?t+"":"",t=Xt.cleanMath(t),a.attr("data-math-formula",t);const{TeX:d}=await se();Js(Tt.createElement(d,{children:t,onRender:r}),u[0])}}},{processMath:ho}=Qs;function Ei(s,t){return typeof s=="number"&&(s=[s,s]),t=t*Math.PI/180,[s[0]*Math.cos(t),s[1]*Math.sin(t)]}var ge,ve,Us;let Ii=(Us=class{constructor(t){xi(this,ge,void 0);xi(this,ve,void 0);this.isMobile=!1,this.currentStyle={"stroke-width":2,fill:"none"},this.label=(e,r,a,u,d)=>{const v=typeof u=="object"?u:d,y=typeof u=="boolean"?u:!0;return this.withStyle(v,()=>{const b=E("<span>").addClass("graphie-label"),S=this.currentStyle["label-distance"];b.css({position:"absolute",padding:(S??7)+"px",color:"black"}).data("labelDirection",a).appendTo(this.el),b.setPosition=M=>{const A=this.scalePoint(M);b.css({left:A[0],top:A[1]})},b.setPosition(e);const x=b[0];return b.processMath=function(M,A){ho(x,M,A,function(){const C=x.scrollWidth,R=x.scrollHeight;Rs(x,[C,R])})},b.processText=function(M){b.html(M);const A=x.scrollWidth,C=x.scrollHeight;Rs(x,[A,C])},y?b.processMath(r,!1):b.processText(r),b})},this.svgPath=(e,r)=>e.map((a,u)=>{if(a===!0)return"z";const d=r?a:this.scalePoint(a);return(u===0?"M":"L")+Xt.bound(d[0])+" "+Xt.bound(d[1])}).join(""),this.svgParabolaPath=(e,r,a)=>{const u=function(O){return(e*O+r)*O+a};if(e===0){const O=[[this.bounds().xMin,u(this.bounds().xMin)],[this.bounds().xMax,u(this.bounds().xMax)]];return this.svgPath(O)}const d=-r/(2*e),v=Math.max(Math.abs(d-this.bounds().xMin),Math.abs(d-this.bounds().xMax)),y=d+v,b=[d,u(d)],S=[y,u(y)],x=[b[0],b[1]-(S[1]-b[1])],M=Math.abs(b[0]-S[0]),A=[b[0]-M,S[1]],C=[b[0]+M,S[1]],_=[A,x,C].map(this.scalePoint).flat().map(Xt.bound);return"M"+_[0]+","+_[1]+" Q"+_[2]+","+_[3]+" "+_[4]+","+_[5]},this.svgSinusoidPath=(e,r,a,u)=>{const d=Math.abs(Math.PI/(2*r)),v=function(_){return e*Math.sin(r*_-a)+u},y=function(_){return e*r*Math.cos(a-r*_)},b=(_,O)=>{const H=_+d*O,z=H+d,j=[H,H*2/3+z*1/3,H*1/3+z*2/3,z],tt=[v(H),v(H)+y(H)*(z-H)/3,v(z)-y(z)*(z-H)/3,v(z)];return Bn(j,tt).map(this.scalePoint)},S=this.bounds().width(),x=Math.ceil(S/d)+1;let M=a/r;const A=M-this.bounds().xMin;M-=d*Math.ceil(A/d);let C=b(M,0),R="M"+C[0][0]+","+C[0][1]+" C"+C[1][0]+","+C[1][1]+" "+C[2][0]+","+C[2][1]+" "+C[3][0]+","+C[3][1];for(let _=1;_<x;_++)C=b(M,_),R+=" C"+C[1][0]+","+C[1][1]+" "+C[2][0]+","+C[2][1]+" "+C[3][0]+","+C[3][1];return R},this.scalePoint=e=>this.drawingTransform().scalePoint(e),this.scaleVector=e=>this.drawingTransform().scaleVector(e),this.unscalePoint=e=>this.drawingTransform().unscalePoint(e),this.unscaleVector=e=>this.drawingTransform().unscaleVector(e),this.el=t,E(t).css("position","relative"),this.raphael=jt(t),E(t).attr("aria-hidden","true"),E(t).children("div").css("position","absolute")}init(t){let e=t.scale||[40,40];if(e=typeof e=="number"?[e,e]:e,t.range==null)throw new $t("range should be specified in graph init",Vt.Internal);Mi(this,ge,new lo(...t.range)),Mi(this,ve,new ao(this.raphael,e,this.bounds()));const[r,a]=this.drawingTransform().canvasDimensions();return E(this.el).css({width:r,height:a}),this.range=t.range,this.scale=e,this.dimensions=[r,a],this.xpixels=r,this.ypixels=a,this.isMobile=t.isMobile??!1,this}graphInit(t){t=t||{};for(const[F,st]of Yn(t))!F.match(/.*Opacity$/)&&F!=="range"&&typeof st=="number"&&(t[F]=[st,st]),(F==="range"||F==="gridRange")&&(t[F]=ki(t[F]));const e=ki(t.range||[[-10,10],[-10,10]]),r=ki(t.gridRange||e),a=t.scale||[20,20],u=t.grid!=null?t.grid:!0,d=t.gridOpacity||.1,v=fo(t.gridStep||[1,1]),y=t.axes!=null?t.axes:!0,b=t.axisArrows||"",S=t.axisOpacity||1,x=t.axisCenter||[Math.min(Math.max(e[0][0],0),e[0][1]),Math.min(Math.max(e[1][0],0),e[1][1])],M=t.axisLabels!=null?t.axisLabels:!1,A=t.ticks!=null?t.ticks:!0,C=t.tickStep||[2,2],R=t.tickLen||[5,5],_=t.tickOpacity||1,O=t.labels||t.labelStep||!1,H=t.labelStep||[1,1],z=t.labelOpacity||1;let j=t.unityLabels||!1;const tt=t.labelFormat||function(F){return F};let J=t.xLabelFormat||tt,I=t.yLabelFormat||tt;const ot=[[e[0][0]-(e[0][0]>0?1:0),e[0][1]+(e[0][1]<0?1:0)],[e[1][0]-(e[1][0]>0?1:0),e[1][1]+(e[1][1]<0?1:0)]];Array.isArray(j)||(j=[j,j]);const X=function(F){return function(st){return(F(st)+"").replace(/-(\d)/g,"\\llap{-}$1")}};if(J=X(J),I=X(I),this.init({range:ot,scale:a,isMobile:t.isMobile}),u&&this.grid(r[0],r[1],{stroke:t.isMobile?G.GRAY_C:"#000000",opacity:t.isMobile?1:d,step:v,strokeWidth:t.isMobile?1:2}),y){if(b==="<->"||b===!0){const F=this;this.style({stroke:t.isMobile?G.GRAY_G:"#000000",opacity:t.isMobile?1:S,strokeWidth:t.isMobile?1:2,arrows:"->"},function(){e[1][0]<0&&e[1][1]>0&&(F.path([x,[r[0][0],x[1]]]),F.path([x,[r[0][1],x[1]]])),e[0][0]<0&&e[0][1]>0&&(F.path([x,[x[0],r[1][0]]]),F.path([x,[x[0],r[1][1]]]))})}else if(b==="->"||b===""){const F=this;this.style({stroke:"#000000",opacity:S,strokeWidth:2,arrows:b},function(){F.path([[r[0][0],x[1]],[r[0][1],x[1]]]),F.path([[x[0],r[1][0]],[x[0],r[1][1]]])})}M&&M.length===2&&(this.label([r[0][1],x[1]],M[0],"right"),this.label([x[0],r[1][1]],M[1],"above"))}if(A){const F=t.isMobile,st=this;this.style({stroke:t.isMobile?G.GRAY_G:"#000000",opacity:t.isMobile?1:_,strokeWidth:1},()=>{let nt=v[0]*C[0],$=R[0]/a[1],lt=r[0][0],rt=r[0][1];if(e[1][0]<0&&e[1][1]>0){for(let W=nt+x[0];W<=rt;W+=nt)(W<rt||!b)&&st.line([W,-$+x[1]],[W,F?0:$+x[1]]);for(let W=-nt+x[0];W>=lt;W-=nt)(W>lt||!b)&&st.line([W,-$+x[1]],[W,F?0:$+x[1]])}if(nt=v[1]*C[1],$=R[1]/a[0],lt=r[1][0],rt=r[1][1],e[0][0]<0&&e[0][1]>0){for(let W=nt+x[1];W<=rt;W+=nt)(W<rt||!b)&&this.line([-$+x[0],W],[F?0:$+x[0],W]);for(let W=-nt+x[1];W>=lt;W-=nt)(W>lt||!b)&&this.line([-$+x[0],W],[F?0:$+x[0],W])}})}if(O){const F=this;this.style({stroke:t.isMobile?G.GRAY_G:"#000000",opacity:t.isMobile?1:z},function(){let st=v[0]*C[0]*H[0],nt=r[0][0],$=r[0][1];const lt=x[0]<0?"above":"below",rt=x[0]<0?"right":"left",W=x[0]===0&&x[1]!==0,pt=x[0]!==0&&x[1]===0,xt=x[0]!==0||x[1]!==0,Et=j[0]||xt,ae=j[1]||xt;for(let K=(W?0:st)+x[0];K<=$;K+=st)(K<$||!b)&&F.label([K,x[1]],J(K),lt);for(let K=-st*(Et?1:2)+x[0];K>=nt;K-=st)(K>nt||!b)&&F.label([K,x[1]],J(K),lt);st=v[1]*C[1]*H[1],nt=r[1][0],$=r[1][1];for(let K=(pt?0:st)+x[1];K<=$;K+=st)(K<$||!b)&&F.label([x[0],K],I(K),rt);for(let K=-st*(ae?1:2)+x[1];K>=nt;K-=st)(K>nt||!b)&&F.label([x[0],K],I(K),rt)})}}drawingTransform(){if(_e(this,ve)==null)throw new Error("Can't get drawingTransform of an uninitialized Graphie");return _e(this,ve)}bounds(){if(_e(this,ge)==null)throw new Error("Can't get bounds of an uninitialized Graphie");return _e(this,ge)}style(t,e){const r=this.processAttributes(t);if(typeof e=="function"){const a=this.currentStyle;this.currentStyle={...this.currentStyle,...r};const u=e.call(this);return this.currentStyle=a,u}Object.assign(this.currentStyle,r)}grid(t,e,r){return this.withStyle(r,()=>{const a=this.currentStyle.step||[1,1],u=this.raphael.set();let d=a[0]*Math.ceil(t[0]/a[0]);for(;d<=t[1];d+=a[0])u.push(this.line([d,e[0]],[d,e[1]]));let v=a[1]*Math.ceil(e[0]/a[1]);for(;v<=e[1];v+=a[1])u.push(this.line([t[0],v],[t[1],v]));return u})}arc(t,e,r,a,u,d){return this.withStyle(d,()=>{r=(r%360+360)%360,a=(a%360+360)%360;const v=this.scalePoint(t),y=this.scaleVector(e),b=Ei(e,r),S=Ei(e,a),x=R=>zn(R,6),M=this.scalePoint([x(t[0]+b[0]),x(t[1]+b[1])]),A=this.scalePoint([x(t[0]+S[0]),x(t[1]+S[1])]),C=((a-r)%360+360)%360>180;return this.raphael.path("M"+M.join(" ")+"A"+y.join(" ")+" 0 "+(C?1:0)+" 0 "+A.join(" ")+(u?"L"+v.join(" ")+"z":""))})}circle(t,e,r){return this.withStyle(r,()=>this.raphael.ellipse(...this.scalePoint(t),...this.scaleVector([e,e])))}rect(t,e,r,a,u){return this.withStyle(u,()=>{const d=this.scalePoint([t,e+a]),v=this.scaleVector([r,a]),y=this.raphael.rect(...d.concat(v));return this.isMobile&&(y.node.style.shapeRendering="crispEdges"),y})}ellipse(t,e,r){return this.withStyle(r,()=>this.raphael.ellipse(...this.scalePoint(t).concat(this.scaleVector(e))))}fixedEllipse(t,e,r,a,u){return this.withStyle(u,()=>{const d=this.scalePoint(t),v=this.scaleVector(e),y=2*v[0]*r+a,b=2*v[1]*r+a,S=d[0]-y/2,x=d[1]-b/2,M=document.createElement("div");E(M).css({position:"absolute",width:y+"px",height:b+"px",left:S+"px",top:x+"px"});const C=jt(M,y,b).ellipse(y/2,b/2,v[0],v[1]);return{wrapper:M,visibleShape:C}})}unstyledPath(t){const e=this.raphael.path(this.svgPath(t));return e.graphiePath=t,e}path(t,e){return this.withStyle(e,()=>this.unstyledPath(t))}fixedPath(t,e,r){t=t.map(this.scalePoint),e=e?this.scalePoint(e):null,r=r||this.svgPath;const a=t.map(z=>z[0]),u=t.map(z=>z[1]),d=Math.min(...a),v=Math.max(...a),y=Math.min(...u),b=Math.max(...u),S=[4,4],x=[d,y];t=t.map(function(z){return ct(dt(z,x),Ft(S,.5))});const M=v-d+S[0],A=b-y+S[1],C=x[0]-S[0]/2,R=x[1]-S[1]/2,_=document.createElement("div");E(_).css({position:"absolute",width:M+"px",height:A+"px",left:C+"px",top:R+"px",transformOrigin:e?M/2+e[0]+"px "+(A/2+e[1])+"px":null});const H=jt(_,M,A).path(r(t));return{wrapper:_,visibleShape:H}}scaledPath(t,e){return this.withStyle(e,()=>{const r=this.raphael.path(this.svgPath(t,!0));return r.graphiePath=t,r})}line(t,e,r){return this.withStyle(r,()=>{const a=this.unstyledPath([t,e]);return this.isMobile&&(a.node.style.shapeRendering="crispEdges"),a})}parabola(t,e,r,a){return this.withStyle(a,()=>this.raphael.path(this.svgParabolaPath(t,e,r)))}fixedLine(t,e,r){const a=[r,r];t=this.scalePoint(t),e=this.scalePoint(e);const u=[Math.min(t[0],e[0]),Math.min(t[1],e[1])];t=ct(dt(t,u),Ft(a,.5)),e=ct(dt(e,u),Ft(a,.5));const d=u[0]-a[0]/2,v=u[1]-a[1]/2,y=Math.abs(t[0]-e[0])+a[0],b=Math.abs(t[1]-e[1])+a[1],S=document.createElement("div");E(S).css({position:"absolute",width:y+"px",height:b+"px",left:d+"px",top:v+"px",transformOrigin:t[0]+"px "+t[1]+"px"});const x=jt(S,y,b),M="M"+t[0]+" "+t[1]+" L"+e[0]+" "+e[1],A=x.path(M);return A.graphiePath=[t,e],{wrapper:S,visibleShape:A}}sinusoid(t,e,r,a,u){return this.withStyle(u,()=>this.raphael.path(this.svgSinusoidPath(t,e,r,a)))}plotParametric(t,e,r){return this.withStyle(r,()=>{const a=M=>Math.abs(M[1])>5e5?[M[0],Math.min(Math.max(M[1],-5e5),5e5)]:M,u=M=>a(t(M)),d=e[0],v=e[1];let y=(v-d)/(this.currentStyle["plot-points"]||800);y===0&&(y=1);const b=this.raphael.set();let S=[],x=u(d)[1];for(let M=d;M<=v;M+=y){const A=u(M),C=A[1];C>0!=x>0&&Math.abs(C-x)>2*this.drawingTransform().pixelsPerUnitY()||isNaN(C)?(b.push(this.unstyledPath(S)),S=[]):S.push(A),x=C}return b.push(this.unstyledPath(S)),b})}plot(t,e,r){return this.withStyle(r,()=>{const a=e[0],u=e[1];this.currentStyle["plot-points"]||(this.currentStyle["plot-points"]=2*(u-a)*this.drawingTransform().pixelsPerUnitX());const d=v=>[v,t(v)];return this.plotParametric(d,e)})}withStyle(t,e){const r=this.currentStyle;this.currentStyle={...this.currentStyle,...this.processAttributes(t)};const a=this.postprocessDrawingResult(e());return this.currentStyle=r,a}postprocessDrawingResult(t){const e=t.constructor.prototype;return e===jt.el||e===jt.st?(t.attr(this.currentStyle),this.currentStyle.arrows&&(t=this.addArrowheads(t))):t instanceof E&&t.css({...this.currentStyle,...po}),t}addArrowheads(t){const e=t.constructor.prototype;if(e===jt.el){if(t.type==="path"&&typeof t.arrowheadsDrawn>"u"){const a=.6+.4*t.attr("stroke-width"),u=t.getTotalLength(),d=this.raphael.set(),v=this.raphael.path(this.isMobile?"M-4,4 C-4,4 -0.25,0 -0.25,0 C-0.25,0 -4,-4 -4,-4":"M-3 4 C-2.75 2.5 0 0.25 0.75 0C0 -0.25 -2.75 -2.5 -3 -4"),y=t.getPointAtLength(u-.4),b=t.getPointAtLength(u-.75*a),S=Math.atan2(y.y-b.y,y.x-b.x)*180/Math.PI,x=t.attr();delete x.path;let M=t.getSubpath(0,u-.75*a);return M=this.raphael.path(M).attr(x),M.arrowheadsDrawn=!0,t.remove(),v.rotate(S,this.isMobile?1e-5:.75,0).scale(a,a,.75,0).translate(b.x,b.y).attr(x).attr({"stroke-linejoin":"round","stroke-linecap":"round"}),v.arrowheadsDrawn=!0,d.push(M),d.push(v),d}}else if(e===jt.st)for(let r=0,a=t.items.length;r<a;r++)this.addArrowheads(t.items[r]);return t}processAttributes(t){const e={scale:a=>{this.drawingTransform().setScale(a)},clipRect:a=>{const u=a[0],d=a[1];return u[1]+=d[1],{"clip-rect":this.scalePoint(u).concat(this.scaleVector(d)).join(" ")}},strokeWidth:function(a){return{"stroke-width":parseFloat(a)}},rx:a=>({rx:this.scaleVector([a,0])[0]}),ry:a=>({ry:this.scaleVector([0,a])[1]}),r:a=>{const u=this.scaleVector([a,a]);return{rx:u[0],ry:u[1]}}},r={};return Object.entries(t||{}).forEach(function([a,u]){const d=e[a];if(typeof d=="function")Object.assign(r,d(u));else{const v=String(a).replace(/([A-Z]+)([A-Z][a-z])/g,"$1-$2").replace(/([a-z\d])([A-Z])/g,"$1-$2").toLowerCase();r[v]=u}}),r}addMouseLayer(t){var u;const e={allowScratchpad:!1,setDrawingAreaAvailable:function(){},...t},r=2;if(this.mouselayer=jt(this.el,this.xpixels,this.ypixels),E(this.mouselayer.canvas).css("z-index",r),e.onClick||e.onMouseDown||e.onMouseMove||e.onMouseOver||e.onMouseOut){const d=this.mouselayer.rect(0,0,this.xpixels,this.ypixels).attr({fill:"#000",opacity:0});let v=!1;if(E(this.mouselayer.canvas).on("vmousedown",y=>{if(y.target===d[0]){if(e.onMouseDown&&e.onMouseDown(this.getMouseCoord(y)),v=!0,e.onMouseMove){const b=e.onMouseMove;E(document).bind("vmousemove.mouseLayer",S=>{v&&(S.preventDefault(),b(this.getMouseCoord(S)))})}E(document).bind("vmouseup.mouseLayer",b=>{E(document).unbind(".mouseLayer"),v&&e.onClick&&e.onClick(this.getMouseCoord(b)),v=!1})}}),e.onMouseOver){const y=e.onMouseOver;E(this.mouselayer.canvas).on("vmouseover",b=>{y(this.getMouseCoord(b))})}if(e.onMouseOut){const y=e.onMouseOut;E(this.mouselayer.canvas).on("vmouseout",b=>{y(this.getMouseCoord(b))})}}e.allowScratchpad||(u=e.setDrawingAreaAvailable)==null||u.call(e,!1),this._mouselayerWrapper=document.createElement("div"),E(this._mouselayerWrapper).css({position:"absolute",left:0,top:0,zIndex:r}),this._visiblelayerWrapper=document.createElement("div"),E(this._visiblelayerWrapper).css({position:"absolute",left:0,top:0});const a=this.el;a.appendChild(this._visiblelayerWrapper),a.appendChild(this._mouselayerWrapper),this.addToMouseLayerWrapper=d=>{var v;(v=this._mouselayerWrapper)==null||v.appendChild(d)},this.addToVisibleLayerWrapper=d=>{var v;(v=this._visiblelayerWrapper)==null||v.appendChild(d)}}addToMouseLayerWrapper(t){throw new Error("addToMouseLayerWrapper is not ready. Call addMouseLayer() first.")}addToVisibleLayerWrapper(t){throw new Error("addToVisibleLayerWrapper is not ready. Call addMouseLayer() first.")}getMousePx(t){const e=E(this.el).offset(),r=t.pageX-e.left,a=t.pageY-e.top;return[r,a]}getMouseCoord(t){return this.unscalePoint(this.getMousePx(t))}},ge=new WeakMap,ve=new WeakMap,Us);const uo={center:[-.5,-.5],above:[-.5,-1],"above right":[0,-1],right:[0,-.5],"below right":[0,0],below:[-.5,0],"below left":[-1,0],left:[-1,-.5],"above left":[-1,-1]};function ki(s){function t(u){return typeof u=="number"?[-u,u]:u}function e(u){return Array.isArray(u)?u:[u,u]}if(s==null)return s;const[r,a]=e(s);return[t(r),t(a)]}function fo(s){return Array.isArray(s)?s:[s,s]}const po={"stroke-width":null},Rs=function(s,t){const e=E(s),r=e.data("labelDirection");let[a,u]=t;if(a===0&&u===0&&([a,u]=[1,1],Re.log("Label size was 0x0 in graphie.js; using 1x1 instead")),e.css("visibility",""),typeof r=="number"){const d=Math.cos(r),v=Math.sin(r),y=Math.min(a/2/Math.abs(d),u/2/Math.abs(v));e.css({marginLeft:-a/2+d*y,marginTop:-u/2-v*y})}else{const d=s.scrollHeight===u,v=e.closest(".svg-image"),y=e.closest(".graphie"),b=v.length>0?v:y;b.css("line-height","normal"),d&&s.scrollHeight!==u&&(u=s.scrollHeight);const S=b.css(["max-width","width"])??{"max-width":"0px"},x=S["max-width"]!=="none"?S["max-width"]:S.width;let M=(b.width()??0)/parseInt(x.replace(/px$/,""))*100;(isNaN(M)||M===0)&&(M=100);const A=e.css("padding")??"0px",R=Math.round(parseInt((A!=="none"?A:"0px").replace(/px$/,""))*M)/100,_=uo[r||"center"],O={marginLeft:Math.round(a*_[0]*M)/100,marginTop:Math.round(u*_[1]*M)/100,padding:`${R}px`};M!==1&&(O.fontSize=`${Math.round(M*100)/100}%`),e.css(O)}},bt={Graphie:Ii,createGraphie:function(s){return new Ii(s)},unscaledSvgPath:function(s){return s[0]===!0?"":s.map(function(t,e){return t===!0?"z":(e===0?"M":"L")+t[0]+" "+t[1]}).join("")},getDistance:function(s,t){return Zs(s,t)},findAngleDeprecated:function(s,t,e){if(e===void 0){const r=s[0]-t[0],a=s[1]-t[1];return!r&&!a?0:(180+Math.atan2(-a,-r)*180/Math.PI+360)%360}return bt.findAngleDeprecated(s,e)-bt.findAngleDeprecated(t,e)},graphs:{}};(function(s,t,e,r){if(typeof s>"u")return;var a="virtualMouseBindings",u="virtualTouchID",d="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),v="clientX clientY pageX pageY screenX screenY".split(" "),y=s.event.mouseHooks?s.event.mouseHooks.props:[],b=s.event.props.concat(y),S={},x=0,M=0,A=0,C=!1,R=[],_=!1,O=!1,H="addEventListener"in e,z=s(e),j=1,tt=0;s.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500};function J(B){for(;B&&typeof B.originalEvent<"u";)B=B.originalEvent;return B}function I(B,Y){var et=B.type,ft,wt,Mt,Ct,vt,xe,ne,ce,Ve;if(B=s.Event(B),B.type=Y,ft=B.originalEvent,wt=s.event.props,et.search(/mouse/)>-1&&(wt=b),ft)for(ne=wt.length,Ct;ne;)Ct=wt[--ne],B[Ct]=ft[Ct];if(et.search(/mouse(down|up)|click/)>-1&&!B.which&&(B.which=1),et.search(/^touch/)!==-1&&(Mt=J(ft),et=Mt.touches,vt=Mt.changedTouches,xe=et&&et.length?et[0]:vt&&vt.length?vt[0]:r,xe))for(ce=0,Ve=v.length;ce<Ve;ce++)Ct=v[ce],B[Ct]=xe[Ct];return B}function ot(B){for(var Y={},et,ft;B;){et=s.data(B,a);for(ft in et)et[ft]&&(Y[ft]=Y.hasVirtualBinding=!0);B=B.parentNode}return Y}function X(B,Y){for(var et;B;){if(et=s.data(B,a),et&&(!Y||et[Y]))return B;B=B.parentNode}return null}function F(){O=!1}function st(){O=!0}function nt(){tt=0,R.length=0,_=!1,st()}function $(){F()}function lt(){rt(),x=setTimeout(function(){x=0,nt()},s.vmouse.resetTimerDuration)}function rt(){x&&(clearTimeout(x),x=0)}function W(B,Y,et){var ft;return(et&&et[B]||!et&&X(Y.target,B))&&(ft=I(Y,B),s(Y.target).trigger(ft)),ft}function pt(B){var Y=s.data(B.target,u);if(!_&&(!tt||tt!==Y)){var et=W("v"+B.type,B);et&&(et.isDefaultPrevented()&&B.preventDefault(),et.isPropagationStopped()&&B.stopPropagation(),et.isImmediatePropagationStopped()&&B.stopImmediatePropagation())}}function xt(B){var Y=J(B).touches,et,ft;if(Y&&Y.length===1&&(et=B.target,ft=ot(et),ft.hasVirtualBinding)){tt=j++,s.data(et,u,tt),rt(),$(),C=!1;var wt=J(B).touches[0];M=wt.pageX,A=wt.pageY,W("vmouseover",B,ft),W("vmousedown",B,ft)}}function Et(B){O||(C||W("vmousecancel",B,ot(B.target)),C=!0,lt())}function ae(B){if(!O){var Y=J(B).touches[0],et=wt,ft=s.vmouse.moveDistanceThreshold,wt=wt||Math.abs(Y.pageX-M)>ft||Math.abs(Y.pageY-A)>ft,Mt=ot(B.target);wt&&!et&&W("vmousecancel",B,Mt),W("vmousemove",B,Mt),lt()}}function K(B){if(!O){st();var Y=ot(B.target),et;if(W("vmouseup",B,Y),!C){var ft=W("vclick",B,Y);ft&&ft.isDefaultPrevented()&&(et=J(B).changedTouches[0],R.push({touchID:tt,x:et.clientX,y:et.clientY}),_=!0)}W("vmouseout",B,Y),C=!1,lt()}}function we(B){var Y=s.data(B,a),et;if(Y){for(et in Y)if(Y[et])return!0}return!1}function Ne(){}function li(B){var Y=B.substr(1);return{setup:function(et,ft){we(this)||s.data(this,a,{});var wt=s.data(this,a);wt[B]=!0,S[B]=(S[B]||0)+1,S[B]===1&&z.bind(Y,pt),s(this).bind(Y,Ne),H&&(S.touchstart=(S.touchstart||0)+1,S.touchstart===1&&z.bind("touchstart",xt).bind("touchend",K).bind("touchmove",ae).bind("scroll",Et))},teardown:function(et,ft){--S[B],S[B]||z.unbind(Y,pt),H&&(--S.touchstart,S.touchstart||z.unbind("touchstart",xt).unbind("touchmove",ae).unbind("touchend",K).unbind("scroll",Et));var wt=s(this),Mt=s.data(this,a);Mt&&(Mt[B]=!1),wt.unbind(Y,Ne),we(this)||wt.removeData(a)}}}for(var le=0;le<d.length;le++)s.event.special[d[le]]=li(d[le]);H&&e.addEventListener("click",function(B){var Y=R.length,et=B.target,ft,wt,Mt,Ct,vt;if(Y)for(ft=B.clientX,wt=B.clientY,threshold=s.vmouse.clickDistanceThreshold,Mt=et;Mt;){for(Ct=0;Ct<Y;Ct++)if(vt=R[Ct],Mt===et&&Math.abs(vt.x-ft)<threshold&&Math.abs(vt.y-wt)<threshold||s.data(Mt,u)===vt.touchID){B.preventDefault(),B.stopPropagation();return}Mt=Mt.parentNode}},!0)})(E,window,document);const Qe=function(s,t,e){const r=s.range[0][1]-s.range[0][0],a=s.range[1][1]-s.range[1][0],u=r+a,d=s.unscaleVector(Ae(1,e)),v=Ft(Ai(d),u),y=ct(t,v),b=Wt(d)[1];return s.constrainToBoundsOnAngle(y,4,b*Math.PI/180)};class Yi{constructor(t,e){this.graphie=t,this.initialPoint=e}transform(t){const e=kt.getPrefixedTransform();this.wrapper.style[e]=t}toFront(){const t=this.wrapper.parentNode;t&&t.appendChild(this.wrapper)}toBack(){const t=this.wrapper.parentNode;t!=null&&t.firstChild!==this.wrapper&&t.insertBefore(this.wrapper,t.firstChild)}remove(){this.visibleShape.remove(),E(this.wrapper).remove()}getMouseTarget(){return this.visibleShape[0]}moveTo(t){const e=dt(this.graphie.scalePoint(t),this.graphie.scalePoint(this.initialPoint)),r=kt.getCanUse3dTransform(),a="translateX("+e[0]+"px) translateY("+e[1]+"px)"+(r?" translateZ(0)":"");this.transform(a)}hide(){this.visibleShape.hide()}show(){this.visibleShape.show()}attr(...t){this.visibleShape.attr(...t)}animate(...t){this.visibleShape.animate(...t)}}const mo={center:null,createPath:null,mouselayer:!1};class go extends Yi{constructor(t,e,r){const a=t.scalePoint(w.head(e));super(t,a),r=w.extend({},mo,r);const u=t.fixedPath(e,r.center,r.createPath);this.wrapper=u.wrapper,this.visibleShape=u.visibleShape,r.mouselayer?(this.wrapper.style.touchAction="none",this.graphie.addToMouseLayerWrapper(this.wrapper)):this.graphie.addToVisibleLayerWrapper(this.wrapper)}}const me=class me extends go{constructor(t,e){const r=[.75,0],u=[[-3,4],[-2.75,2.5],[0,.25],r,[0,-.25],[-2.75,-2.5],[-3,-4]].map(d=>{const v=dt(d,r),y=Ft(v,me.scale);return ct(r,y)}).map(t.unscalePoint);super(t,u,{center:t.unscalePoint(r),createPath:vo}),this.center=r,this.attr(w.extend({"stroke-linejoin":"round","stroke-linecap":"round","stroke-dasharray":""},e))}toCoordAtAngle(t,e){const r=this.graphie.scalePoint(Qe(this.graphie,t,e));this.transform("translateX("+(r[0]+me.scale*this.center[0])+"px) translateY("+(r[1]+me.scale*this.center[1])+"px) translateZ(0) rotate("+(360-Xt.bound(e))+"deg)")}};me.scale=1.4;let ie=me;const vo=function(s){let t="M"+s[0][0]+" "+s[0][1];for(let e=1;e<s.length;e+=3)t+="C"+s[e][0]+" "+s[e][1]+" "+s[e+1][0]+" "+s[e+1][1]+" "+s[e+2][0]+" "+s[e+2][1];return t},bo={maxScale:1,mouselayer:!1,shadow:!1,disableMouseEventsOnWrapper:!1};class ri extends Yi{constructor(t,e,r,a){super(t,e),a=w.extend({},bo,a);const u=t.fixedEllipse(e,r,a.maxScale,a.padding);if(this.visibleShape=u.visibleShape,this.wrapper=u.wrapper,this.graphie=t,this.initialPoint=e,a.interactiveKindForTesting&&this.wrapper.setAttribute("data-interactive-kind-for-testing",a.interactiveKindForTesting),a.mouselayer?(this.wrapper.style.touchAction="none",this.graphie.addToMouseLayerWrapper(this.wrapper)):this.graphie.addToVisibleLayerWrapper(this.wrapper),a.shadow){const d="drop-shadow(0px 0px 5px rgba(0, 0, 0, 0.5))",v=this.wrapper;v.style.filter=d,this.moveTo=function(y){const b=dt(this.graphie.scalePoint(y),this.graphie.scalePoint(this.initialPoint)),S=kt.getCanUse3dTransform(),x="translateX("+Math.round(b[0])+"px) translateY("+Math.round(b[1])+"px)"+(S?" translateZ(0)":"");this.transform(x)}}a.disableMouseEventsOnWrapper&&(this.wrapper.style.pointerEvents="none",this.visibleShape.node.style.pointerEvents="auto")}}const yo={thickness:2,mouselayer:!1};class ai extends Yi{constructor(t,e,r,a){const u=[t.range[0][0],0],d=[t.range[0][1],0],v=t.scalePoint(u);super(t,v),a=w.extend({},yo,a);const y=t.fixedLine(u,d,a.thickness);this.wrapper=y.wrapper,this.visibleShape=y.visibleShape,a.interactiveKindForTesting&&this.wrapper.setAttribute("data-interactive-kind-for-testing",a.interactiveKindForTesting),this.visibleShape.attr(a.normalStyle),this.initialPoint=v,this.initialLength=Zs(t.scalePoint(u),t.scalePoint(d)),a.mouselayer?(this.wrapper.style.touchAction="none",this.graphie.addToMouseLayerWrapper(this.wrapper)):this.graphie.addToVisibleLayerWrapper(this.wrapper),this.moveTo(e,r)}getMouseTarget(){return this.wrapper}moveTo(t,e){const r=this.graphie.scalePoint(t),a=this.graphie.scalePoint(e),u=Wt(dt(a,r)),d=u[0],v=Xt.bound(u[1]),y=dt(r,this.initialPoint),b=Xt.bound(d/this.initialLength),S=kt.getCanUse3dTransform(),x="translateX("+y[0]+"px) translateY("+y[1]+"px) "+(S?" translateZ(0)":"")+"rotate("+v+"deg) scaleX("+b+") scaleY(1)";this.transform(x)}}const{clockwise:wo,reverseVector:Li}=Fn;function Ds(s){const t=70.2941120352484,e=.5687298702748785*20;return(t-e)*Math.exp(-.037587715462826674*s)+e}function Ee(s,t){return[s*Math.cos(t),s*Math.sin(t)*-1]}function Pe(s,t){const e=t*Math.PI/180;return Ee(s,e)}let zt=!1;const xo={bogusShape:{animate:function(){},attr:function(){},remove:function(){}}};w.extend(bt.Graphie.prototype,{labelAngle:function(s){const t=this;w.defaults(s,{point1:[0,0],vertex:[0,0],point3:[0,0],label:null,numArcs:1,showRightAngleMarker:!0,pushOut:0,clockwise:!1,style:{}});let e=s.text===void 0?"":s.text;const r=s.vertex,a=t.scalePoint(r);let u,d;s.clockwise?(u=s.point1,d=s.point3):(u=s.point3,d=s.point1);const v=bt.findAngleDeprecated(u,r),y=bt.findAngleDeprecated(d,r),b=(y+360-v)%360,S=(v+b/2)%360;let M=5*s.pushOut+Ds(b);const A=[];if(Math.abs(b-90)<1e-9&&s.showRightAngleMarker){const C=ct(a,Pe(M,v)),R=ct(a,Pe(M,y));M*=Math.SQRT2;const _=ct(a,Pe(M,S));w.each([C,R],function(O){A.push(t.scaledPath([O,_],s.style))})}else w.times(s.numArcs,function(C){A.push(t.arc(r,t.unscaleVector(M),v,y,s.style)),M+=3});if(e){const C=e.match(/\$deg(\d)?/);if(C){const H=C[1]||1;e=e.replace(C[0],Xt.toFixedApprox(b,H)+"^{\\circ}")}const R=Pe(M+15,S),_=ct(a,R),O=t.unscalePoint(_);s.label?(s.label.setPosition(O),s.label.processMath(e,!0)):t.label(O,e,"center",s.style)}return A},labelSide:function(s){const t=this;w.defaults(s,{point1:[0,0],point2:[0,0],label:null,text:"",numTicks:0,numArrows:0,clockwise:!1,style:{}});let e,r;s.clockwise?(e=s.point1,r=s.point2):(e=s.point2,r=s.point1);const a=[(e[0]+r[0])/2,(e[1]+r[1])/2],u=t.scalePoint(a),d=Math.atan2(r[1]-e[1],r[0]-e[0]),v=d+Math.PI/2,y=[];let b=0;if(s.numTicks){const x=s.numTicks,M=5,A=5,C=w.extend({},s.style,{strokeWidth:2});w.times(x,function(R){const _=M*(R-(x-1)/2),O=Ee(_,d),H=Ee(A,v),z=[ct(u,O,H),ct(u,O,Li(H))];y.push(t.scaledPath(z,C))}),b+=M*(x-1)+15}if(s.numArrows){const x=s.numArrows,M=[e,r].sort(function(_,O){return _[1]===O[1]?_[0]-O[0]:_[1]-O[1]})[0],A=t.scalePoint(M),C=w.extend({},s.style,{arrows:"->",strokeWidth:2}),R=5;w.times(x,function(_){const O=b+R*_;let H=Ee(O,d);M!==e&&(H=Li(H));const z=ct(u,H);y.push(t.scaledPath([A,z],C))})}let S=s.text;if(S){const x=S.match(/\$len(\d)?/);if(x){const _=bt.getDistance(e,r),O=x[1]||1;S=S.replace(x[0],Xt.toFixedApprox(_,O))}const A=Ee(20,v),C=ct(u,A),R=t.unscalePoint(C);s.label?(s.label.setPosition(R),s.label.processMath(S,!0)):t.label(R,S,"center",s.style)}return y},labelVertex:function(s){const t=this;if(w.defaults(s,{point1:null,vertex:[0,0],point3:null,label:null,text:"",clockwise:!1,style:{}}),!s.text)return;const e=s.vertex,r=t.scalePoint(e);let a,u;s.clockwise?(a=s.point1,u=s.point3):(a=s.point3,u=s.point1);let d=135,v;if(a&&u){const M=bt.findAngleDeprecated(a,e);d=(bt.findAngleDeprecated(u,e)+360-M)%360,v=(M+d/2+180)%360}else a?v=bt.findAngleDeprecated(e,a)+90:u?v=bt.findAngleDeprecated(u,e)+90:v=135;const y=10+Ds(360-d),b=Pe(y,v),S=ct(r,b),x=t.unscalePoint(S);s.label?(s.label.setPosition(x),s.label.processMath(s.text,!0)):t.label(x,s.text,"center",s.style)},addMovablePoint:function(s){const t=E.extend(!0,{graph:this,coord:[0,0],snapX:0,snapY:0,pointSize:4,highlight:!1,dragging:!1,visible:!0,bounded:!0,constraints:{fixed:!1,constrainX:!1,constrainY:!1,fixedAngle:{},fixedDistance:{}},lineStarts:[],lineEnds:[],polygonVertices:[],normalStyle:{},highlightStyle:{fill:G.INTERACTING,stroke:G.INTERACTING},labelStyle:{color:G.INTERACTIVE},vertexLabel:"",mouseTarget:null},s),e=t.constraints.fixed?G.DYNAMIC:G.INTERACTIVE;t.normalStyle=w.extend({},{fill:e,stroke:e},s.normalStyle),s.coordX!==void 0&&(t.coord[0]=s.coordX),s.coordY!==void 0&&(t.coord[1]=s.coordY);const r=t.graph,a=function(d){t.visible&&t.bounded&&!t.constraints.fixed&&(d=r.constrainToBounds(d,10));let v=d[0],y=d[1];if(t.snapX!==0&&(v=Math.round(v/t.snapX)*t.snapX),t.snapY!==0&&(y=Math.round(y/t.snapY)*t.snapY),t.constraints.fixedDistance.snapPoints){const S=r.scalePoint(d);let x=S[0],M=S[1];const A=2*Math.PI/t.constraints.fixedDistance.snapPoints,C=t.constraints.fixedDistance.dist,R=t.constraints.fixedDistance.point,_=(R[0]-r.range[0][0])*r.scale[0],O=(-R[1]+r.range[1][1])*r.scale[1];let H=x-_,z=-M+O,j=Math.atan(z/H);H<0&&(j+=Math.PI),j=Math.round(j/A)*A,H=C*Math.cos(j),z=C*Math.sin(j),x=H+_,M=-z+O,v=Xt.roundTo(5,x/r.scale[0]+r.range[0][0]),y=Xt.roundTo(5,r.range[1][1]-M/r.scale[1])}return t.applyConstraint([v,y])};t.applyConstraint=function(d,v,y){let b=d.slice();const S={};if(y?E.extend(S,{fixed:!1,constrainX:!1,constrainY:!1,fixedAngle:{},fixedDistance:{}},v):E.extend(S,this.constraints,v),S.constrainX)b=[this.coord[0],d[1]];else if(S.constrainY)b=[d[0],this.coord[1]];else if(typeof S.fixedAngle.angle=="number"&&typeof S.fixedDistance.dist=="number"){const x=S.fixedAngle.vertex.coord||S.fixedAngle.vertex,M=S.fixedAngle.ref.coord||S.fixedAngle.ref,A=S.fixedDistance.point.coord||S.fixedDistance.point,C=(S.fixedAngle.angle+bt.findAngleDeprecated(M,x))*Math.PI/180,R=S.fixedDistance.dist;b[0]=R*Math.cos(C)+A[0],b[1]=R*Math.sin(C)+A[1]}else if(typeof S.fixedAngle.angle=="number"){const x=S.fixedAngle.vertex.coord||S.fixedAngle.vertex,M=S.fixedAngle.ref.coord||S.fixedAngle.ref,A=(S.fixedAngle.angle+bt.findAngleDeprecated(M,x))*Math.PI/180,C=bt.findAngleDeprecated(d,x)*Math.PI/180;let _=bt.getDistance(d,x)*Math.cos(A-C);_=_<1?1:_,b[0]=_*Math.cos(A)+x[0],b[1]=_*Math.sin(A)+x[1]}else if(typeof S.fixedDistance.dist=="number"){const x=S.fixedDistance.point.coord||S.fixedDistance.point;let M=bt.findAngleDeprecated(d,x);const A=S.fixedDistance.dist;M=M*Math.PI/180,b[0]=A*Math.cos(M)+x[0],b[1]=A*Math.sin(M)+x[1]}else S.fixed&&(b=t.coord);return b},t.coord=a(t.coord);const u=2;if(t.visible&&r.style(t.normalStyle,function(){const d=[t.pointSize/r.scale[0],t.pointSize/r.scale[1]],v={maxScale:u,padding:2};t.visibleShape=new ri(r,t.coord,d,v),t.visibleShape.attr(w.omit(t.normalStyle,"scale")),t.visibleShape.toFront()}),t.normalStyle.scale=1,t.highlightStyle.scale=u,t.vertexLabel&&(t.labeledVertex=this.label([0,0],"","center",t.labelStyle)),t.drawLabel=function(){t.vertexLabel&&t.graph.labelVertex({vertex:t.coord,label:t.labeledVertex,text:t.vertexLabel,style:t.labelStyle})},t.drawLabel(),t.grab=function(d){d=d||[0,0],E(document).bind("vmousemove.point vmouseup.point",function(v){v.preventDefault(),t.dragging=!0,zt=!0;let y=ct(r.getMouseCoord(v),d);y=a(y);let b=y[0],S=y[1],x,M;if(v.type==="vmousemove"){let A=!0;if(w.isFunction(t.onMove)){const C=t.onMove(b,S);C===!1&&(A=!1),w.isArray(C)&&(b=C[0],S=C[1])}if(x=(b-r.range[0][0])*r.scale[0],M=(-S+r.range[1][1])*r.scale[1],A){const C=r.unscalePoint([x,M]);t.visibleShape.moveTo(C),t.mouseTarget.moveTo(C),t.coord=[b,S],t.updateLineEnds(),E(t).trigger("move")}t.drawLabel()}else if(v.type==="vmouseup"){if(E(document).unbind(".point"),t.dragging=!1,zt=!1,w.isFunction(t.onMoveEnd)){const A=t.onMoveEnd(b,S);if(w.isArray(A)){b=A[0],S=A[1],x=(b-r.range[0][0])*r.scale[0],M=(-S+r.range[1][1])*r.scale[1];const C=r.unscalePoint([x,M]);t.visibleShape.moveTo(C),t.mouseTarget.moveTo(C),t.coord=[b,S]}}t.highlight||(t.visibleShape.animate(t.normalStyle,50),t.onUnhighlight&&t.onUnhighlight())}})},t.visible&&!t.constraints.fixed){if(!t.mouseTarget){const v=r.unscaleVector(16),y={mouselayer:!0,padding:0,disableMouseEventsOnWrapper:!0,interactiveKindForTesting:"movable-point"};t.mouseTarget=new ri(r,t.coord,v,y),t.mouseTarget.attr({fill:"#000",opacity:0})}const d=E(t.mouseTarget.getMouseTarget());d.css("cursor","move"),d.bind("vmousedown vmouseover vmouseout",function(v){if(v.type==="vmouseover")t.highlight=!0,zt||(t.visibleShape.animate(t.highlightStyle,50),t.onHighlight&&t.onHighlight());else if(v.type==="vmouseout")t.highlight=!1,!t.dragging&&!zt&&(t.visibleShape.animate(t.normalStyle,50),t.onUnhighlight&&t.onUnhighlight());else if(v.type==="vmousedown"&&(v.which===1||v.which===0)){v.preventDefault();const y=t.coord,b=r.getMouseCoord(v),x=!("ontouchstart"in window)?[0,0]:dt(y,b);t.grab(x)}})}return t.moveTo=function(d,v,y){const S=bt.getDistance(this.graph.scalePoint([d,v]),this.graph.scalePoint(this.coord))*5,x=y&&function(M){t.coord=M,t.updateLineEnds()};this.visibleShape.animateTo([d,v],S,x),this.mouseTarget.animateTo([d,v],S,x),this.coord=[d,v],w.isFunction(this.onMove)&&this.onMove(d,v)},t.updateLineEnds=function(){E(this.lineStarts).each(function(){this.coordA=t.coord,this.transform()}),E(this.lineEnds).each(function(){this.coordZ=t.coord,this.transform()}),E(this.polygonVertices).each(function(){this.transform()})},t.setCoord=function(d){this.visible&&(this.visibleShape.moveTo(d),this.mouseTarget!=null&&this.mouseTarget.moveTo(d)),this.coord=d.slice()},t.setCoordConstrained=function(d){this.setCoord(a(d))},t.toBack=function(){this.visible&&(this.mouseTarget!=null&&this.mouseTarget.toBack(),this.visibleShape.toBack())},t.toFront=function(){this.visible&&(this.mouseTarget!=null&&this.mouseTarget.toFront(),this.visibleShape.toFront())},t.remove=function(){this.visibleShape&&this.visibleShape.remove(),this.mouseTarget&&this.mouseTarget.remove(),this.labeledVertex&&this.labeledVertex.remove()},t},addMovableLineSegment:function(s){const t=E.extend({graph:this,coordA:[0,0],coordZ:[1,1],snapX:0,snapY:0,fixed:!1,ticks:0,normalStyle:{},highlightStyle:{stroke:G.INTERACTING,"stroke-width":6},labelStyle:{stroke:G.INTERACTIVE,color:G.INTERACTIVE},highlight:!1,dragging:!1,tick:[],extendLine:!1,extendRay:!1,constraints:{fixed:!1,constrainX:!1,constrainY:!1},sideLabel:"",vertexLabels:[],numArrows:0,numTicks:0,movePointsWithLine:!1},s),e=t.fixed?G.DYNAMIC:G.INTERACTIVE;t.normalStyle=w.extend({},{"stroke-width":2,stroke:e},s.normalStyle),t.arrowStyle=w.extend({},t.normalStyle,{color:t.normalStyle.stroke}),s.pointA!==void 0?(t.coordA=s.pointA.coord,t.pointA.lineStarts.push(t)):s.coordA!==void 0&&(t.coordA=s.coordA.slice()),s.pointZ!==void 0?(t.coordZ=s.pointZ.coord,t.pointZ.lineEnds.push(t)):s.coordA!==void 0&&(t.coordA=t.coordA.slice());const r=t.graph;r.style(t.normalStyle);for(let u=0;u<t.ticks;++u)t.tick[u]=xo.bogusShape;let a=bt.unscaledSvgPath([[0,0],[1,0]]);for(let u=0;u<t.ticks;++u){const d=.5-(t.ticks-1+u*2)/r.scale[0];a+=bt.unscaledSvgPath([[d,-7],[d,7]])}if(s={thickness:Math.max(t.normalStyle["stroke-width"],t.highlightStyle["stroke-width"])},t.visibleLine=new ai(r,[0,0],[1,0],s),t.visibleLine.attr(t.normalStyle),!t.fixed){const u={thickness:30,mouselayer:!0,interactiveKindForTesting:"movable-line"};t.mouseTarget=new ai(r,[0,0],[1,0],u),t.mouseTarget.attr({fill:"#000",opacity:0})}if(t.transform=function(u){u&&(typeof this.pointA=="object"&&(this.coordA=this.pointA.coord),typeof this.pointZ=="object"&&(this.coordZ=this.pointZ.coord));const d=function(R){const _=R.graph.scalePoint(R.coordA),O=R.graph.scalePoint(R.coordZ);return Wt(dt(O,_))[1]},v=function(R,_,O){R=t.graph;const H=R.range[0][1]-R.range[0][0],z=R.range[1][1]-R.range[1][0],j=H+z,tt=R.unscaleVector(Ae(1,O)),J=Ft(Ai(tt),j),I=ct(_,J),ot=Wt(tt)[1];return R.constrainToBoundsOnAngle(I,4,ot*Math.PI/180)},y=d(this);let b=this.coordA,S=this.coordZ;this.extendLine?(b=v(r,b,360-y),S=v(r,S,(540-y)%360)):this.extendRay&&(S=v(r,b,360-y));const x=[this.visibleLine];this.fixed||x.push(this.mouseTarget),w.each(x,function(R){R.moveTo(b,S)}),this._arrows==null&&(this._arrows=[],this.extendLine?(this._arrows.push(new ie(r,this.normalStyle)),this._arrows.push(new ie(r,this.normalStyle))):this.extendRay&&this._arrows.push(new ie(r,this.normalStyle)));const M=[this.coordA,this.coordZ],A=[360-y,(540-y)%360];w.each(this._arrows,function(R,_){R.toCoordAtAngle(M[_],A[_])}),w.invoke(this.temp,"remove"),this.temp=[];const C=this.coordA[0]<this.coordZ[0]||this.coordA[0]===this.coordZ[0]&&this.coordA[1]>this.coordZ[1];this.sideLabel&&this.temp.push(this.graph.labelSide({point1:this.coordA,point2:this.coordZ,label:this.labeledSide,text:this.sideLabel,numArrows:this.numArrows,numTicks:this.numTicks,clockwise:C,style:this.labelStyle})),this.vertexLabels.length&&(this.graph.labelVertex({vertex:this.coordA,point3:this.coordZ,label:this.labeledVertices[0],text:this.vertexLabels[0],clockwise:C,style:this.labelStyle}),this.graph.labelVertex({point1:this.coordA,vertex:this.coordZ,label:this.labeledVertices[1],text:this.vertexLabels[1],clockwise:C,style:this.labelStyle})),this.temp=w.flatten(this.temp)},t.toBack=function(){t.fixed||t.mouseTarget.toBack(),t.visibleLine.toBack()},t.toFront=function(){t.fixed||t.mouseTarget.toFront(),t.visibleLine.toFront()},t.remove=function(){t.fixed||t.mouseTarget.remove(),t.visibleLine.remove(),t.labeledSide&&t.labeledSide.remove(),t.labeledVertices&&w.invoke(t.labeledVertices,"remove"),t._arrows&&w.invoke(t._arrows,"remove"),t.temp.length&&w.invoke(t.temp,"remove")},t.hide=function(){t.visibleLine.hide(),t.temp.length&&w.invoke(t.temp,"hide"),t._arrows&&w.invoke(t._arrows,"hide")},t.show=function(){t.visibleLine.show(),t.temp.length&&w.invoke(t.temp,"show"),t._arrows&&w.invoke(t._arrows,"show")},t.sideLabel&&(t.labeledSide=this.label([0,0],"","center",t.labelStyle)),t.vertexLabels.length&&(t.labeledVertices=w.map(t.vertexLabels,function(u){return this.label([0,0],"","center",t.labelStyle)},this)),!t.fixed&&!t.constraints.fixed){const u=E(t.mouseTarget.getMouseTarget());u.css("cursor","move"),u.bind("vmousedown vmouseover vmouseout",function(d){if(d.type==="vmouseover")zt||(t.highlight=!0,t.visibleLine.animate(t.highlightStyle,50),t.arrowStyle=w.extend({},t.arrowStyle,{color:t.highlightStyle.stroke,stroke:t.highlightStyle.stroke}),t.transform());else if(d.type==="vmouseout")t.highlight=!1,t.dragging||(t.visibleLine.animate(t.normalStyle,50),t.arrowStyle=w.extend({},t.arrowStyle,{color:t.normalStyle.stroke,stroke:t.normalStyle.stroke}),t.transform());else if(d.type==="vmousedown"&&(d.which===1||d.which===0)){d.preventDefault();let v=(d.pageX-E(r.raphael.canvas.parentNode).offset().left)/r.scale[0]+r.range[0][0],y=r.range[1][1]-(d.pageY-E(r.raphael.canvas.parentNode).offset().top)/r.scale[1];t.snapX>0&&(v=Math.round(v/t.snapX)*t.snapX),t.snapY>0&&(y=Math.round(y/t.snapY)*t.snapY);const b=[t.coordA[0]-v,t.coordA[1]-y],S=[t.coordZ[0]-v,t.coordZ[1]-y],x=-Math.min(r.scaleVector(b)[0],r.scaleVector(S)[0]),M=Math.max(r.scaleVector(b)[0],r.scaleVector(S)[0]),A=Math.max(r.scaleVector(b)[1],r.scaleVector(S)[1]),C=-Math.min(r.scaleVector(b)[1],r.scaleVector(S)[1]);E(document).bind("vmousemove.lineSegment vmouseup.lineSegment",function(R){R.preventDefault(),t.dragging=!0,zt=!0;let _=R.pageX-E(r.raphael.canvas.parentNode).offset().left,O=R.pageY-E(r.raphael.canvas.parentNode).offset().top;_=Math.max(x+10,Math.min(r.xpixels-10-M,_)),O=Math.max(A+10,Math.min(r.ypixels-10-C,O));let H=_/r.scale[0]+r.range[0][0],z=r.range[1][1]-O/r.scale[1];if(t.snapX>0&&(H=Math.round(H/t.snapX)*t.snapX),t.snapY>0&&(z=Math.round(z/t.snapY)*t.snapY),R.type==="vmousemove"){t.constraints.constrainX&&(H=t.coordA[0]-b[0]),t.constraints.constrainY&&(z=t.coordA[1]-b[1]);const j=H+b[0]-t.coordA[0],tt=z+b[1]-t.coordA[1];t.coordA=[H+b[0],z+b[1]],t.coordZ=[H+S[0],z+S[1]],t.transform(),t.movePointsWithLine&&(typeof t.pointA=="object"&&t.pointA.setCoord([t.pointA.coord[0]+j,t.pointA.coord[1]+tt]),typeof t.pointZ=="object"&&t.pointZ.setCoord([t.pointZ.coord[0]+j,t.pointZ.coord[1]+tt])),w.isFunction(t.onMove)&&t.onMove(j,tt)}else R.type==="vmouseup"&&(E(document).unbind(".lineSegment"),t.dragging=!1,zt=!1,t.highlight||(t.visibleLine.animate(t.normalStyle,50),t.arrowStyle=w.extend({},t.arrowStyle,{color:t.normalStyle.stroke,stroke:t.normalStyle.stroke}),t.transform()),w.isFunction(t.onMoveEnd)&&t.onMoveEnd());E(t).trigger("move")})}})}return t.pointA!==void 0&&t.pointA.toFront(),t.pointZ!==void 0&&t.pointZ.toFront(),t.transform(),t},addMovablePolygon:function(s){const t=this,e=E.extend({snapX:0,snapY:0,fixed:!1,constrainToGraph:!0,normalStyle:{},highlightStyle:{stroke:G.INTERACTING,"stroke-width":2,fill:G.INTERACTING,"fill-opacity":.05},pointHighlightStyle:{fill:G.INTERACTING,stroke:G.INTERACTING},labelStyle:{stroke:G.DYNAMIC,"stroke-width":1,color:G.DYNAMIC},angleLabels:[],showRightAngleMarkers:[],sideLabels:[],vertexLabels:[],numArcs:[],numArrows:[],numTicks:[],updateOnPointMove:!0,closed:!0},w.omit(s,"points")),r=e.fixed?G.DYNAMIC:G.INTERACTIVE;e.normalStyle=w.extend({"stroke-width":2,"fill-opacity":0,fill:r,stroke:r},s.normalStyle),e.points=s.points;const a=function(u){return!w.isArray(u)};if(e.update=function(){const u=e.points.length;e.coords=w.map(e.points,function(y,b){return a(y)?y.coord:y}),e.left=w.min(w.pluck(e.coords,0)),e.right=w.max(w.pluck(e.coords,0)),e.top=w.max(w.pluck(e.coords,1)),e.bottom=w.min(w.pluck(e.coords,1));let d=w.map(e.coords,function(y){return t.scalePoint(y)});e.closed?d.push(!0):d=d.concat(w.clone(d).reverse()),e.path=bt.unscaledSvgPath(d),w.invoke(e.temp,"remove"),e.temp=[];const v=wo(e.coords);(e.angleLabels.length||e.showRightAngleMarkers.length)&&w.each(e.labeledAngles,function(y,b){e.temp.push(t.labelAngle({point1:e.coords[(b-1+u)%u],vertex:e.coords[b],point3:e.coords[(b+1)%u],label:y,text:e.angleLabels[b],showRightAngleMarker:e.showRightAngleMarkers[b],numArcs:e.numArcs[b],clockwise:v,style:e.labelStyle}))}),e.sideLabels.length&&w.each(e.labeledSides,function(y,b){e.temp.push(t.labelSide({point1:e.coords[b],point2:e.coords[(b+1)%u],label:y,text:e.sideLabels[b],numArrows:e.numArrows[b],numTicks:e.numTicks[b],clockwise:v,style:e.labelStyle}))}),e.vertexLabels.length&&w.each(e.labeledVertices,function(y,b){t.labelVertex({point1:e.coords[(b-1+u)%u],vertex:e.coords[b],point3:e.coords[(b+1)%u],label:y,text:e.vertexLabels[b],clockwise:v,style:e.labelStyle})}),e.temp=w.flatten(e.temp)},e.transform=function(){e.update(),e.visibleShape.attr({path:e.path}),e.fixed||e.mouseTarget.attr({path:e.path})},e.remove=function(){e.visibleShape.remove(),e.fixed||e.mouseTarget.remove(),e.labeledAngles&&w.invoke(e.labeledAngles,"remove"),e.labeledSides&&w.invoke(e.labeledSides,"remove"),e.labeledVertices&&w.invoke(e.labeledVertices,"remove"),e.temp.length&&w.invoke(e.temp,"remove")},e.toBack=function(){e.fixed||e.mouseTarget.toBack(),e.visibleShape.toBack()},e.toFront=function(){e.fixed||e.mouseTarget.toFront(),e.visibleShape.toFront()},e.updateOnPointMove&&w.each(w.filter(e.points,a),function(u){u.polygonVertices.push(e)}),e.coords=new Array(e.points.length),e.angleLabels.length){const u=Math.max(e.angleLabels.length,e.showRightAngleMarkers.length);e.labeledAngles=w.times(u,function(){return this.label([0,0],"","center",e.labelStyle)},this)}return e.sideLabels.length&&(e.labeledSides=w.map(e.sideLabels,function(u){return this.label([0,0],"","center",e.labelStyle)},this)),e.vertexLabels.length&&(e.labeledVertices=w.map(e.vertexLabels,function(u){return this.label([0,0],"","center",e.labelStyle)},this)),e.update(),e.visibleShape=t.raphael.path(e.path),e.visibleShape.attr(e.normalStyle),e.fixed||(e.mouseTarget=t.mouselayer.path(e.path),e.mouseTarget.attr({fill:"#000",opacity:0,cursor:"move"}),E(e.mouseTarget[0]).bind("vmousedown vmouseover vmouseout",function(u){if(u.type==="vmouseover")(!zt||e.dragging)&&(e.highlight=!0,e.visibleShape.animate(e.highlightStyle,50),w.each(w.filter(e.points,a),function(d){d.visibleShape.animate(e.pointHighlightStyle,50)}));else if(u.type==="vmouseout"){if(e.highlight=!1,!e.dragging){e.visibleShape.animate(e.normalStyle,50);const d=w.filter(e.points,a);w.any(w.pluck(d,"dragging"))||w.each(d,function(v){v.visibleShape.animate(v.normalStyle,50)})}}else if(u.type==="vmousedown"&&(u.which===1||u.which===0)){u.preventDefault(),w.each(w.filter(e.points,a),function(R){R.dragging=!0});let d=(u.pageX-E(t.raphael.canvas.parentNode).offset().left)/t.scale[0]+t.range[0][0],v=t.range[1][1]-(u.pageY-E(t.raphael.canvas.parentNode).offset().top)/t.scale[1];e.snapX>0&&(d=Math.round(d/e.snapX)*e.snapX),e.snapY>0&&(v=Math.round(v/e.snapY)*e.snapY);let y=d,b=v;const S=e.coords.slice(),x=(d-e.left)*t.scale[0],M=(e.right-d)*t.scale[0],A=(e.top-v)*t.scale[1],C=(v-e.bottom)*t.scale[1];E(document).bind("vmousemove.polygon vmouseup.polygon",function(R){R.preventDefault(),e.dragging=!0,zt=!0;let _=R.pageX-E(t.raphael.canvas.parentNode).offset().left,O=R.pageY-E(t.raphael.canvas.parentNode).offset().top;e.constrainToGraph&&(_=Math.max(x+10,Math.min(t.xpixels-10-M,_)),O=Math.max(A+10,Math.min(t.ypixels-10-C,O)));let H=_/t.scale[0]+t.range[0][0],z=t.range[1][1]-O/t.scale[1];if(e.snapX>0&&(H=Math.round(H/e.snapX)*e.snapX),e.snapY>0&&(z=Math.round(z/e.snapY)*e.snapY),R.type==="vmousemove"){let j=H-d,tt=z-v,J=!0;if(w.isFunction(e.onMove)){const ot=e.onMove(j,tt);ot===!1?J=!1:w.isArray(ot)&&(j=ot[0],tt=ot[1],H=d+j,z=v+tt)}const I=function(ot){return[S[ot][0]+j,S[ot][1]+tt]};J&&(w.each(e.points,function(ot,X){a(ot)?ot.setCoord(I(X)):e.points[X]=I(X)}),e.transform(),E(e).trigger("move"),y=H,b=z)}else if(R.type==="vmouseup"){E(document).unbind(".polygon");const j=w.filter(e.points,a);w.each(j,function(tt){tt.dragging=!1}),e.dragging=!1,zt=!1,e.highlight||(e.visibleShape.animate(e.normalStyle,50),w.each(j,function(tt){tt.visibleShape.animate(tt.normalStyle,50)})),w.isFunction(e.onMoveEnd)&&e.onMoveEnd(y-d,b-v)}})}})),w.invoke(w.filter(e.points,a),"toFront"),e},constrainToBounds:function(s,t){const e=this.unscalePoint([t,this.ypixels-t]),r=this.unscalePoint([this.xpixels-t,t]),a=Math.max(e[0],Math.min(r[0],s[0])),u=Math.max(e[1],Math.min(r[1],s[1]));return[a,u]},constrainToBoundsOnAngle:function(s,t,e){const r=this.unscalePoint([t,this.ypixels-t]),a=this.unscalePoint([this.xpixels-t,t]);let u=s.slice();return u[0]<r[0]?u=[r[0],u[1]+(r[0]-u[0])*Math.tan(e)]:u[0]>a[0]&&(u=[a[0],u[1]-(u[0]-a[0])*Math.tan(e)]),u[1]<r[1]?u=[u[0]+(r[1]-u[1])/Math.tan(e),r[1]]:u[1]>a[1]&&(u=[u[0]-(u[1]-a[1])/Math.tan(e),a[1]]),u},addMovableAngle:function(s){return new tn(this,s)},addCircleGraph:function(s){const t=this,e=E.extend({center:[0,0],radius:2,snapX:.5,snapY:.5,snapRadius:.5,minRadius:1,centerConstraints:{},centerNormalStyle:{},centerHighlightStyle:{stroke:G.INTERACTING,fill:G.INTERACTING},circleNormalStyle:{stroke:G.INTERACTIVE,"fill-opacity":0},circleHighlightStyle:{stroke:G.INTERACTING,fill:G.INTERACTING,"fill-opacity":.05}},s),r=e.centerConstraints.fixed?G.DYNAMIC:G.INTERACTIVE,a=s?s.centerNormalStyle:null;e.centerNormalStyle=w.extend({},{fill:r,stroke:r},a),e.centerPoint=t.addMovablePoint({graph:t,coord:e.center,normalStyle:e.centerNormalStyle,snapX:e.snapX,snapY:e.snapY,constraints:e.centerConstraints}),e.circ=t.circle(e.center,e.radius,e.circleNormalStyle),e.perim=t.mouselayer.circle(t.scalePoint(e.center)[0],t.scalePoint(e.center)[1],t.scaleVector(e.radius)[0]).attr({"stroke-width":20,opacity:.002}),e.centerConstraints.fixed||E(e.centerPoint.mouseTarget.getMouseTarget()).on("vmouseover vmouseout",function(d){e.centerPoint.highlight||e.centerPoint.dragging?e.circ.animate(e.circleHighlightStyle,50):e.circ.animate(e.circleNormalStyle,50)}),e.toFront=function(){e.circ.toFront(),e.perim.toFront(),e.centerPoint.visibleShape.toFront(),e.centerConstraints.fixed||e.centerPoint.mouseTarget.toFront()},e.centerPoint.onMove=function(d,v){e.toFront(),e.circ.attr({cx:t.scalePoint(d)[0],cy:t.scalePoint(v)[1]}),e.perim.attr({cx:t.scalePoint(d)[0],cy:t.scalePoint(v)[1]}),e.onMove&&e.onMove(d,v)},E(e.centerPoint).on("move",function(){e.center=this.coord,E(e).trigger("move")}),e.setCenter=function(d,v){e.centerPoint.setCoord([d,v]),e.centerPoint.onMove(d,v),e.center=[d,v]},e.setRadius=function(d){e.radius=d,e.perim.attr({r:t.scaleVector(d)[0]}),e.circ.attr({rx:t.scaleVector(d)[0],ry:t.scaleVector(d)[1]})},e.remove=function(){e.centerPoint.remove(),e.circ.remove(),e.perim.remove()};const u=[[Math.PI*-1,Math.PI*-.875,"ew-resize"],[Math.PI*-.875,Math.PI*-.625,"nesw-resize"],[Math.PI*-.625,Math.PI*-.375,"ns-resize"],[Math.PI*-.375,Math.PI*-.125,"nwse-resize"],[Math.PI*-.125,Math.PI*.125,"ew-resize"],[Math.PI*.125,Math.PI*.375,"nesw-resize"],[Math.PI*.375,Math.PI*.625,"ns-resize"],[Math.PI*.625,Math.PI*.875,"nwse-resize"],[Math.PI*.875,Math.PI*1,"ew-resize"]];return E(e.perim.node).on("vmousemove",d=>{let[v,y]=this.getMouseCoord(d);v-=e.center[0],y-=e.center[1];const b=Math.atan2(y,v);u.forEach(function(S){const[x,M,A]=S;b>=x&&b<M&&E(e.perim.node).css("cursor",A)})}),E(e.perim.node).css("cursor","nesw-resize"),e.perim.node.addEventListener("touchstart",function(d){d.preventDefault()},{passive:!1}),E(e.perim.node).on("vmouseover vmouseout vmousedown",function(d){if(d.type==="vmouseover")e.highlight=!0,zt||(e.circ.animate(e.circleHighlightStyle,50),e.centerPoint.visibleShape.animate(e.centerHighlightStyle,50));else if(d.type==="vmouseout")e.highlight=!1,!e.dragging&&!e.centerPoint.dragging&&(e.circ.animate(e.circleNormalStyle,50),e.centerPoint.visibleShape.animate(e.centerNormalStyle,50));else if(d.type==="vmousedown"&&(d.which===1||d.which===0)){d.preventDefault(),e.toFront();const v=e.radius;E(document).on("vmousemove vmouseup",function(y){if(y.preventDefault(),e.dragging=!0,zt=!0,y.type==="vmousemove"){const b=t.constrainToBounds(t.getMouseCoord(y),10);let S=bt.getDistance(e.centerPoint.coord,b);S=Math.max(e.minRadius,Math.round(S/e.snapRadius)*e.snapRadius);const x=e.radius;let M=!0;if(e.onResize){const A=e.onResize(S,x);w.isNumber(A)?S=A:A===!1&&(M=!1)}M&&(e.setRadius(S),E(e).trigger("move"))}else y.type==="vmouseup"&&(E(document).off("vmousemove vmouseup"),e.dragging=!1,zt=!1,e.onResizeEnd&&e.onResizeEnd(e.radius,v))})}}),e},addRotateHandle:function(){const s=function(t,e,r,a,u,d,v){const y=function(x,M){const A=r+M,C=Ae(A,d+x),R=ct(e,C),_=t.scalePoint(R);return _[0]+","+_[1]},b=t.scaleVector(r-a),S=t.scaleVector(r+a);return t.raphael.path(" M"+y(u,-a)+" L"+y(u,-3*a)+" L"+y(2*u,0)+" L"+y(u,3*a)+" L"+y(u,a)+" A"+S[0]+","+S[1]+",0,0,1,"+y(-u,a)+" L"+y(-u,3*a)+" L"+y(-2*u,0)+" L"+y(-u,-3*a)+" L"+y(-u,-a)+" A"+b[0]+","+b[1]+",0,0,0,"+y(u,-a)+" Z").attr({stroke:null,fill:v?G.INTERACTING:G.INTERACTIVE})};return function(t){const e=this;let r=t.center;const a=t.radius,u=t.lengthAngle||30,d=t.hideArrow||!1,v=t.mouseTarget,y=w.uniqueId("rotateHandle");w.isArray(r)&&(r={coord:r});const b=e.addMovablePoint({coord:Cs(r.coord,Ae(a,t.angleDeg||0)),constraints:{fixedDistance:{dist:a,point:r}},mouseTarget:v});r.toFront();let S=r.coord,x=b.coord,M=x,A=!1,C=!1,R;const _=function(z){if(d)return;const j=dt(z,r.coord),J=Wt(j)[1];R&&R.remove(),R=s(e,r.coord,t.radius,A||C?t.hoverWidth/2:t.width/2,u,J,A||C)};E(r).on("move."+y,function(){const z=dt(r.coord,S);b.setCoord(ct(b.coord,z)),_(b.coord),S=r.coord,b.constraints.fixedDistance.point=r,x=b.coord}),b.onMove=function(z,j){A||(M=x,A=!0);let tt=[z,j];if(t.onMove){const J=Wt(dt(x,r.coord)),I=Wt(dt(tt,r.coord)),ot=J[1],X=I[1];let F=t.onMove(X,ot);F!=null&&F!==!0&&(F===!1&&(F=ot),tt=ct(r.coord,Ae(J[0],F)))}return _(tt),x=tt,tt},b.onMoveEnd=function(){if(A=!1,_(b.coord),t.onMoveEnd){const z=Wt(dt(M,r.coord)),j=Wt(dt(b.coord,r.coord));t.onMoveEnd(j[1],z[1])}},b.visibleShape.remove(),v||b.mouseTarget.attr({scale:2});const O=E(b.mouseTarget.getMouseTarget());O.bind("vmouseover",function(z){C=!0,_(b.coord)}),O.bind("vmouseout",function(z){C=!1,_(b.coord)}),_(b.coord);const H=b.remove;return b.remove=function(){H.call(b),R&&R.remove(),E(r).off("move."+y)},b.update=function(){_(b.coord)},b}}(),addReflectButton:function(){const s=function(t,e,r,a,u,d,v){Ws(r[0],r[1])&&(r=[r[0],Cs(r[0],[1,1])]);const y=Ai(dt(r[1],r[0])),b=Ft(y,a/2),S=Ft(y,u),x=$e(S,90),M=$e(S,-90),A=Gn(b),C=$e(b,90),R=$e(b,-90),_=pe(e,x),O=pe(e,M),H=pe(e,x,b,C),z=pe(e,x,A,C),j=pe(e,M,b,R),tt=pe(e,M,A,R),J=t.path([_,H,z,!0],d),I=t.path([O,j,tt,!0],v);return{remove:function(){J.remove(),I.remove()}}};return function(t){const e=this,r=t.line,a=e.addMovablePoint({constraints:t.constraints,coord:As([r.pointA.coord,r.pointZ.coord]),snapX:e.snap[0],snapY:e.snap[1],onMove:function(_,O){return!1},onMoveEnd:function(_,O){t.onMoveEnd&&t.onMoveEnd.call(this,_,O)}});let u=!1,d=!1,v;const y=function(){return u},b=w.map([0,1],function(_){const O=_?t.highlightStyle:t.normalStyle;return w.map([0,1],function(H){return w.defaults({"fill-opacity":H},O)})}),S=function(_){return d&&(_=!_),b[+y()][+_]},x=function(_,O){v&&v.remove(),v=s(e,_,O,y()?t.size*1.5:t.size,y()?t.size*.125:.25,S(0),S(1))},M=function(_,O){_=_||r.pointA.coord,O=O||r.pointZ.coord;const H=As([_,O]);a.setCoord(H),x(H,[_,O])};E(r).on("move",w.bind(M,a,null,null));const A=E(a.mouseTarget.getMouseTarget());A.on("vclick",function(){t.onClick()!==!1&&(d=!d,x(a.coord,[r.pointA.coord,r.pointZ.coord]))}),r.pointA.toFront(),r.pointZ.toFront(),a.visibleShape.remove();const C=e.scaleVector(t.size)[0]/20;a.mouseTarget.attr({scale:1.5*C}),A.css("cursor","pointer"),A.bind("vmouseover",function(_){u=!0,x(a.coord,[r.pointA.coord,r.pointZ.coord])}),A.bind("vmouseout",function(_){u=!1,x(a.coord,[r.pointA.coord,r.pointZ.coord])});const R=a.remove;return a.remove=function(){v.remove(),R.call(a)},a.update=M,a.isFlipped=function(){return d},M(),a}}(),protractor:function(s){return new Mo(this,s)},ruler:function(s){return new So(this,s||{})},addPoints:ct});function Mo(s,t){this.set=s.raphael.set(),this.cx=t[0],this.cy=t[1];const e=this,r=s.unscaleVector(180.5)[0],a=s.scalePoint([this.cx-r,this.cy+r-s.unscaleVector(10.5)[1]]),u=s.mouselayer.image("https://ka-perseus-graphie.s3.amazonaws.com/e9d032f2ab8b95979f674fbfa67056442ba1ff6a.png",a[0],a[1],360,180);this.set.push(u),u.node.addEventListener("touchstart",function(C){C.preventDefault()},{passive:!1});const d=function(C,R){const _=s.scaleVector(r);_[0]-=16,_[1]-=16;const O=s.scalePoint(t),H=Math.sin((C+90)*Math.PI/180)*(_[0]+R)+O[0],z=Math.cos((C+90)*Math.PI/180)*(_[1]+R)+O[1];return H+","+z},v=s.raphael.path(" M"+d(180,6)+" L"+d(180,2)+" L"+d(183,10)+" L"+d(180,18)+" L"+d(180,14)+" A"+(s.scaleVector(r)[0]+10)+","+(s.scaleVector(r)[1]+10)+",0,0,1,"+d(170,14)+" L"+d(170,18)+" L"+d(167,10)+" L"+d(170,2)+" L"+d(170,6)+" A"+(s.scaleVector(r)[0]+10)+","+(s.scaleVector(r)[1]+10)+",0,0,0,"+d(180,6)+" Z").attr({stroke:null,fill:G.INTERACTIVE});this.set.push(v),this.centerPoint=s.addMovablePoint({coord:t,visible:!1}),this.rotateHandle=s.addMovablePoint({bounded:!1,coord:[Math.sin(275*Math.PI/180)*r+this.cx,Math.cos(275*Math.PI/180)*r+this.cy],onMove:function(C,R){const _=Math.atan2(e.centerPoint.coord[1]-R,e.centerPoint.coord[0]-C)*180/Math.PI;e.rotate(-_-5,!0)}}),this.rotateHandle.constraints.fixedDistance.dist=r,this.rotateHandle.constraints.fixedDistance.point=this.centerPoint,this.rotateHandle.visibleShape.remove(),this.rotateHandle.mouseTarget.attr({scale:2});let y=!1,b=!1;const S=function(){return b||y},M=E(this.rotateHandle.mouseTarget.getMouseTarget());M.bind("vmousedown",function(C){y=!0,M.css("cursor","-webkit-grabbing"),M.css("cursor","grabbing"),v.animate({scale:1.5,fill:G.INTERACTING},50),E(document).bind("vmouseup.rotateHandle",function(R){y=!1,M.css("cursor","-webkit-grab"),M.css("cursor","grab"),S()||v.animate({scale:1,fill:G.INTERACTIVE},50),E(document).unbind("vmouseup.rotateHandle")})}),M.bind("vmouseover",function(C){b=!0,v.animate({scale:1.5,fill:G.INTERACTING},50)}),M.bind("vmouseout",function(C){b=!1,S()||v.animate({scale:1,fill:G.INTERACTIVE},50)});const A=E.map(this.set,function(C){return C.node});return this.makeTranslatable=function(){E(A).css("cursor","move"),M.css("cursor","-webkit-grab"),M.css("cursor","grab"),E(A).bind("vmousedown",function(R){R.preventDefault();let _=R.pageX-E(s.raphael.canvas.parentNode).offset().left,O=R.pageY-E(s.raphael.canvas.parentNode).offset().top;E(document).bind("vmousemove.protractor",function(H){let z=H.pageX-E(s.raphael.canvas.parentNode).offset().left,j=H.pageY-E(s.raphael.canvas.parentNode).offset().top;z=Math.max(10,Math.min(s.xpixels-10,z)),j=Math.max(10,Math.min(s.ypixels-10,j));const tt=z-_,J=j-O;E.each(e.set.items,function(){this.translate(tt,J)}),e.centerPoint.setCoord([e.centerPoint.coord[0]+tt/s.scale[0],e.centerPoint.coord[1]-J/s.scale[1]]),e.rotateHandle.setCoord([e.rotateHandle.coord[0]+tt/s.scale[0],e.rotateHandle.coord[1]-J/s.scale[1]]),_=z,O=j}),E(document).one("vmouseup",function(H){E(document).unbind("vmousemove.protractor")})})},this.rotation=0,this.rotate=function(C,R){const _=s.scalePoint(this.centerPoint.coord);return R&&(this.rotation=0),this.set.rotate(this.rotation+C,_[0],_[1]),this.rotation=this.rotation+C,this},this.moveTo=function(R,_){const O=s.scalePoint(e.centerPoint.coord),H=s.scalePoint([R,_]),z=bt.getDistance(O,H)*2;E({x:O[0],y:O[1]}).animate({x:H[0],y:H[1]},{duration:z,step:function(j,tt){let J=0,I=0;tt.prop==="x"?J=j-s.scalePoint(e.centerPoint.coord)[0]:tt.prop==="y"&&(I=j-s.scalePoint(e.centerPoint.coord)[1]),E.each(e.set.items,function(){this.translate(J,I)}),e.centerPoint.setCoord([e.centerPoint.coord[0]+J/s.scale[0],e.centerPoint.coord[1]-I/s.scale[1]]),e.rotateHandle.setCoord([e.rotateHandle.coord[0]+J/s.scale[0],e.rotateHandle.coord[1]-I/s.scale[1]])}})},this.rotateTo=function(R){Math.abs(this.rotation-R)>180&&(this.rotation+=360);const _=Math.abs(this.rotation-R)*5;E({0:this.rotation}).animate({0:R},{duration:_,step:function(O,H){e.rotate(O,!0),e.rotateHandle.setCoord([Math.sin((O+275)*Math.PI/180)*r+e.centerPoint.coord[0],Math.cos((O+275)*Math.PI/180)*r+e.centerPoint.coord[1]])}})},this.remove=function(){this.set.remove()},this.makeTranslatable(),this}function So(s,t){w.defaults(t,{center:[0,0],pixelsPerUnit:40,ticksPerUnit:10,units:10,label:"",style:{fill:null,stroke:G.GRAY}});const e=w.extend({},t.style,{strokeWidth:1}),r=w.extend({},t.style,{strokeWidth:2}),a=t.units*t.pixelsPerUnit,u=50,d=s.unscalePoint(dt(s.scalePoint(t.center),Ft([a,-50],.5))),v=t.pixelsPerUnit/s.scale[0],y=u/s.scale[0],b=ct(d,[t.units*v,y]),S=1;let x;if(t.ticksPerUnit===10)x={10:S,5:S*.55,1:S*.35};else{const X=[1,.6,.45,.3];x={};for(let F=t.ticksPerUnit;F>=1;F/=2)x[F]=S*(X.shift()||.2)}const M=w.keys(x).sort(function(X,F){return F-X});function A(X){for(let F=0;F<M.length;F++){const st=M[F];if(X%st===0)return x[st]}return 0}const C=d[0],R=d[1],_=b[0],O=b[1],H=t.units*t.ticksPerUnit+1,z=s.raphael.set(),j=1/s.scale[0];z.push(s.line([C-j,R],[_+j,R],r)),z.push(s.line([C-j,O],[_+j,O],r)),w.times(H,function(X){const F=X/t.ticksPerUnit,st=C+F*v,nt=A(X)*y,$=X===0||X===H-1?r:e;if(z.push(s.line([st,R],[st,R+nt],$)),F%1===0){const lt=s.scalePoint([st,O]);let rt,W;F===0?(rt=t.label,W={mm:13,cm:11,m:8,km:11,in:8,ft:8,yd:10,mi:10}[rt]||3*rt.toString().length):(rt=F,W=-3*(F.toString().length+1));const pt=s.raphael.text(lt[0]+W,lt[1]+10,rt);pt.attr({"font-family":"KaTeX_Main","font-size":"12px",color:"#444"}),z.push(pt)}});const tt=s.mouselayer.path(s.svgPath([d,[C,O],b,[_,R],!0]));tt.attr({fill:"#000",opacity:0,stroke:"#000","stroke-width":2}),z.push(tt),tt.node.addEventListener("touchstart",function(X){X.preventDefault()},{passive:!1});const J=E.map(z,function(X){return X.node});E(J).css("cursor","move"),E(J).bind("vmousedown",function(X){X.preventDefault();let F=X.pageX-E(s.raphael.canvas.parentNode).offset().left,st=X.pageY-E(s.raphael.canvas.parentNode).offset().top;E(document).bind("vmousemove.ruler",function(nt){let $=nt.pageX-E(s.raphael.canvas.parentNode).offset().left,lt=nt.pageY-E(s.raphael.canvas.parentNode).offset().top;$=Math.max(10,Math.min(s.xpixels-10,$)),lt=Math.max(10,Math.min(s.ypixels-10,lt));const rt=$-F,W=lt-st;z.translate(rt,W),I.setCoord([I.coord[0]+rt/s.scale[0],I.coord[1]-W/s.scale[1]]),ot.setCoord([ot.coord[0]+rt/s.scale[0],ot.coord[1]-W/s.scale[1]]),F=$,st=lt}),E(document).one("vmouseup",function(nt){E(document).unbind("vmousemove.ruler")})});const I=s.addMovablePoint({coord:d,normalStyle:{fill:G.INTERACTIVE,"fill-opacity":0,stroke:G.INTERACTIVE},highlightStyle:{fill:G.INTERACTING,"fill-opacity":.1,stroke:G.INTERACTING},pointSize:6,onMove:function(X,F){const st=ot.coord[1]-F,nt=ot.coord[0]-X,$=Math.atan2(st,nt)*180/Math.PI,lt=Ft(ct([X,F],ot.coord),.5),rt=s.scalePoint(lt),W=Ft(ct(I.coord,ot.coord),.5),pt=s.scalePoint(W),xt=dt(rt,pt);z.rotate(-$,pt[0],pt[1]),z.translate(xt[0],xt[1])}}),ot=s.addMovablePoint({coord:[_,R],normalStyle:{fill:G.INTERACTIVE,"fill-opacity":0,stroke:G.INTERACTIVE},highlightStyle:{fill:G.INTERACTING,"fill-opacity":.1,stroke:G.INTERACTING},pointSize:6,onMove:function(X,F){const st=F-I.coord[1],nt=X-I.coord[0],$=Math.atan2(st,nt)*180/Math.PI,lt=Ft(ct([X,F],I.coord),.5),rt=s.scalePoint(lt),W=Ft(ct(I.coord,ot.coord),.5),pt=s.scalePoint(W),xt=dt(rt,pt);z.rotate(-$,pt[0],pt[1]),z.translate(xt[0],xt[1])}});return I.constraints.fixedDistance.dist=a/s.scale[0],I.constraints.fixedDistance.point=ot,ot.constraints.fixedDistance.dist=a/s.scale[0],ot.constraints.fixedDistance.point=I,this.remove=function(){z.remove(),I.remove(),ot.remove()},this}function tn(s,t){if(this.graphie=s,w.extend(this,t),w.defaults(this,{normalStyle:{stroke:G.INTERACTIVE,"stroke-width":2,fill:G.INTERACTIVE},highlightStyle:{stroke:G.INTERACTING,"stroke-width":2,fill:G.INTERACTING},labelStyle:{stroke:G.DYNAMIC,"stroke-width":1,color:G.DYNAMIC},angleStyle:{stroke:G.DYNAMIC,"stroke-width":1,color:G.DYNAMIC},allowReflex:!0}),!this.points||this.points.length!==3)throw new $t("MovableAngle requires 3 points",Vt.InvalidInput);this.points=w.map(t.points,function(e){return w.isArray(e)?s.addMovablePoint({coord:e,visible:!1,constraints:{fixed:!0},normalStyle:this.normalStyle}):e},this),this.coords=w.pluck(this.points,"coord"),this.reflex==null&&(this.allowReflex?this.reflex=this._getClockwiseAngle(this.coords)>180:this.reflex=!1),this.rays=w.map([0,2],function(e){return s.addMovableLineSegment({pointA:this.points[1],pointZ:this.points[e],fixed:!0,extendRay:!0})},this),this.temp=[],this.labeledAngle=s.label([0,0],"","center",this.labelStyle),this.fixed||(this.addMoveHandlers(),this.addHighlightHandlers()),this.update()}w.extend(tn.prototype,{points:[],snapDegrees:0,snapOffsetDeg:0,angleLabel:"",numArcs:1,pushOut:0,fixed:!1,addMoveHandlers:function(){const s=this.graphie;function t(u,d){return bt.getDistance(s.scalePoint(u),s.scalePoint(d))<30}const e=this.points;e[1].onMove=function(u,d){const v=e[1].coord,y=[u,d],b=ct(y,Li(v));let S=!0;const x={};return w.each([0,2],function(M){const A=e[M].coord;let C=ct(A,b),R=bt.findAngleDeprecated(y,C);R*=Math.PI/180,C=s.constrainToBoundsOnAngle(C,10,R),x[M]=C,t(y,C)&&(S=!1)}),S&&w.each(x,function(M,A){e[A].setCoord(M)}),S};const r=this.snapDegrees,a=this.snapOffsetDeg;w.each([0,2],function(u){e[u].onMove=function(d,v){const y=[d,v],b=e[1].coord;if(t(b,y))return!1;if(r){let S=bt.findAngleDeprecated(y,b);S=Math.round((S-a)/r)*r+a;const x=bt.getDistance(y,b);return ct(b,Ei(x,S))}return!0}}),E(e).on("move",(function(){this.update(),E(this).trigger("move")}).bind(this))},addHighlightHandlers:function(){const s=this.points[1];s.onHighlight=(function(){w.each(this.points,function(t){t.visibleShape.animate(this.highlightStyle,50)},this),w.each(this.rays,function(t){t.visibleLine.animate(this.highlightStyle,50),t.arrowStyle=w.extend({},t.arrowStyle,{color:this.highlightStyle.stroke,stroke:this.highlightStyle.stroke})},this),this.angleStyle=w.extend({},this.angleStyle,{color:this.highlightStyle.stroke,stroke:this.highlightStyle.stroke}),this.update()}).bind(this),s.onUnhighlight=(function(){w.each(this.points,function(t){t.visibleShape.animate(this.normalStyle,50)},this),w.each(this.rays,function(t){t.visibleLine.animate(t.normalStyle,50),t.arrowStyle=w.extend({},t.arrowStyle,{color:t.normalStyle.stroke,stroke:t.normalStyle.stroke})},this),this.angleStyle=w.extend({},this.angleStyle,{color:G.DYNAMIC,stroke:G.DYNAMIC}),this.update()}).bind(this)},_getClockwiseAngle:function(s){return bt.findAngleDeprecated(s[2],s[0],s[1])+360%360},isReflex:function(){return this.reflex},isClockwise:function(){return this._getClockwiseAngle(this.coords)>180===this.reflex},getClockwiseCoords:function(){return this.isClockwise()?w.clone(this.coords):w.clone(this.coords).reverse()},update:function(s){const t=this.coords;this.coords=w.pluck(this.points,"coord"),w.invoke(this.points,"updateLineEnds");const e=this._getClockwiseAngle(t),r=this._getClockwiseAngle(this.coords),a=e>180,u=r>180;this.allowReflex&&(s==null&&(s=a!==u&&Math.abs(r-e)<180),s&&(this.reflex=!this.reflex)),w.invoke(this.temp,"remove"),this.temp=this.graphie.labelAngle({point1:this.coords[0],vertex:this.coords[1],point3:this.coords[2],label:this.labeledAngle,text:this.angleLabel,numArcs:this.numArcs,pushOut:this.pushOut,clockwise:this.reflex===u,style:this.angleStyle})},remove:function(){w.invoke(this.rays,"remove"),w.invoke(this.temp,"remove"),this.labeledAngle.remove()}});const Ns=Lt.nestedMap;function Xi(s){w.extend(this,s)}const _i=function(){throw new $t("Abstract method! Must be implemented by Graphie Movable"+this.constructor.displayName,Vt.NotAllowed)};w.extend(Xi.prototype,{movableProps:[],add:_i,modify:_i,remove:_i,toFront:function(){},componentDidMount:function(){}});const To=function(s,t){return w.extend({},s,{children:w.filter(w.flatten(t),w.identity)})},en=function(s){const t=function(e){if(!(this instanceof t))throw new $t("Use createElement or JSX with graphie movables",Vt.NotAllowed);return this.props=To(e,e.children||[]),this};return s.displayName=s.displayName||w.uniqueId("GraphieClass"),t.displayName=s.displayName,t.prototype=new Xi(s),t.prototype.constructor=t,t},ko=function(s){return en({displayName:s.name||w.uniqueId("GraphieSimpleClass"),movableProps:["children"],add:function(t){this._elements=s(t,this.props),this._prevProps=this.props},modify:function(t){if(!Je(this.props,this._prevProps))return this.remove(),this.add(t),this._prevProps=this.props,"reordered"},remove:function(){Ns(this._elements,t=>{t&&t.remove()}),this._elements=null,this._prevProps=null},toFront:function(){Ns(this._elements,t=>{w.isFunction(t.toFront)&&t.toFront()})}})},Rt={GraphieMovable:Xi,createClass:en,createSimpleClass:ko},_o=kt.normalizeOptions,Co=kt.assert,Po={cursor:null},Ao={added:!1,isHovering:!1,isMouseOver:!1,isDragging:!1,mouseTarget:null};class Ci{constructor(t,e){this._listenerMap={},this.graphie=t,this.state={id:w.uniqueId("movable")},this.modify({...Ao,...e})}modify(t){this.update({...this._createDefaultState(),...t})}_createDefaultState(){return{id:this.state.id,add:[],modify:[],draw:[],remove:[],onMoveStart:[],onMove:[],onMoveEnd:[],onClick:[],...Po}}update(t){const e=this.graphie,r=this.cloneState(),a=Object.assign(this.state,_o(t));if(a.mouseTarget&&!r.mouseTarget){let u;a.mouseTarget.getMouseTarget?u=E(a.mouseTarget.getMouseTarget()):u=E(a.mouseTarget[0]),!("ontouchstart"in window)&&(u.on("vmouseover",()=>{a.isMouseOver=!0,e.isDragging||(a.isHovering=!0),this.state.added&&this.draw()}),u.on("vmouseout",()=>{a.isMouseOver=!1,a.isDragging||(a.isHovering=!1),this.state.added&&this.draw()})),u[0].addEventListener("touchstart",function(v){v.preventDefault()},{passive:!1}),u.on("vmousedown",v=>{if(v.which!==0&&v.which!==1)return;v.preventDefault();const y=e.getMouseCoord(v);this.grab(y)})}if(a.mouseTarget&&a.cursor!==void 0){let u;a.mouseTarget.getMouseTarget?u=E(a.mouseTarget.getMouseTarget()):u=E(a.mouseTarget[0]),u.css("cursor",a.cursor||"")}a.added||(this._fireEvent(a.modify,this.cloneState(),{}),a.added=!0,this.prevState=this.cloneState()),this._fireEvent(a.modify,this.cloneState(),this.prevState)}cloneState(){return{...this.state}}_fireEvent(t,...e){if(t!=null)for(const r of t)r.call(this,...e)}draw(){const t=this.cloneState();this._fireEvent(this.state.draw,t,this.prevState),this.prevState=t}grab(t){Co(Jt(t));const e=this.graphie,r=this.state;r.isHovering=!0,r.isDragging=!0,e.isDragging=!0;const a=t;let u=a;this._fireEvent(r.onMoveStart,a,a);const d=y=>{y.preventDefault();const b=e.getMouseCoord(y);this._fireEvent(r.onMove,b,u),this.draw(),u=b},v=()=>{E(document).unbind("vmousemove",d),E(document).unbind("vmouseup",v),r.isHovering&&this._fireEvent(r.onClick,u,a),r.isHovering=this.state.isMouseOver,r.isDragging=!1,e.isDragging=!1,this._fireEvent(r.onMoveEnd,u,a),this.draw()};E(document).bind("vmousemove",d),E(document).bind("vmouseup",v)}_applyConstraints(t,e,r){let a=!1;return(this.state.constraints??[]).reduce((u,d)=>{if(u===!1)return!1;if(a)return u;const v=d.call(this,u,e,{onSkipRemaining:()=>{a=!0},...r});if(v===!1)return!1;if(Jt(v,2))return v;if(v===!0||v==null)return u;throw new $t("Constraint returned invalid result: "+v,Vt.Internal)},t)}toBack(){this.state.mouseTarget&&this.state.mouseTarget.toBack()}toFront(){this.state.mouseTarget&&this.state.mouseTarget.toFront()}listen(t,e,r){this._listenerMap=this._listenerMap||{};const a=Vs(t,e),u=this._listenerMap[a]=this._listenerMap[a]||this.state[t].length;this.state[t][u]=r}unlisten(t,e){this._listenerMap=this._listenerMap||{};const r=Vs(t,e),a=this._listenerMap[r];a!==void 0&&(this.state[t].splice(a,1),delete this._listenerMap[r],w.keys(this._listenerMap).forEach(d=>{Eo(d)===t&&this._listenerMap[d]>a&&this._listenerMap[d]--}))}remove(){this.state.added=!1,this._fireEvent(this.state.remove),this.state.mouseTarget&&(E(this.state.mouseTarget).off(),this.state.mouseTarget.remove(),this.state.mouseTarget=null)}cursor(){return this.state.cursor}added(){return this.state.added}isHovering(){return this.state.isHovering}isMouseOver(){return this.state.isMouseOver}isDragging(){return this.state.isDragging}mouseTarget(){return this.state.mouseTarget}}function Vs(s,t){return s+":"+t}function Eo(s){return s.split(":")[0]}const Hs=function(s){const t=s.graphie.scalePoint(s.coord(0)),e=s.graphie.scalePoint(s.coord(1));return Wt(dt(e,t))[1]},ti={draw:function(){this.draw()},pointsToFront:function(s){w.invoke(s.points,"toFront")}};ti.standard=[ti.draw,ti.pointsToFront];const Ri={draw:function(){this.draw()}};Ri.standard=[Ri.draw];const Ie={basic:function(s){const t=this.graphie;let e=this.coord(0),r=this.coord(1);if(!this.state.visibleShape){const d={thickness:10};this.state.visibleShape=new ai(t,e,r,d),this.state.visibleShape.attr(this.normalStyle()),this.state.visibleShape.toFront(),this.mouseTarget()&&this.mouseTarget().toFront()}const a=Hs(this);s.extendLine?(e=Qe(t,e,360-a),r=Qe(t,r,(540-a)%360)):s.extendRay&&(r=Qe(t,r,360-a));const u=[this.state.visibleShape];this.mouseTarget()&&u.push(this.mouseTarget()),w.each(u,function(d){d.moveTo(e,r)})},arrows:function(s){this._arrows==null&&(this._arrows=[],s.extendLine?(this._arrows.push(new ie(this.graphie,this.normalStyle())),this._arrows.push(new ie(this.graphie,this.normalStyle()))):s.extendRay&&this._arrows.push(new ie(this.graphie,this.normalStyle())));const t=Hs(this),e=[360-t,(540-t)%360];w.each(this._arrows,function(r,a){r.toCoordAtAngle(this.coord(a),e[a])},this)},highlight:function(s,t){s.isHovering&&!t.isHovering?s.visibleShape.animate(s.highlightStyle,50):!s.isHovering&&t.isHovering&&s.visibleShape.animate(s.normalStyle,50)}};Ie.standard=[Ie.basic,Ie.arrows,Ie.highlight];const ei={basic:function(){this.state.visibleShape&&this.state.visibleShape.remove()},arrows:function(){this._arrows!=null&&w.invoke(this._arrows,"remove"),this._arrows=null}};ei.standard=[ei.basic,ei.arrows];const sn={fixed:function(){return function(){return!1}},snap:function(s){return function(t,e){if(s===null)return!0;let r=dt(t,e);return s=s||this.graphie.snap,r=Fi(r,s),ct(e,r)}},bound:function(s,t,e){return e===void 0&&(s===void 0?e=10:e=0),function(r,a){const u=this.graphie,d=dt(r,a);s=s||u.range,t===void 0&&(t=u.snap);let v=u.unscalePoint([e,u.ypixels-e]),y=u.unscalePoint([u.xpixels-e,e]);t&&(v=zi(v,t),y=Bi(y,t));const b=w.map(this.coords(),function(x,M){const A=dt(y,x);return[dt(v,x),A]}),S=w.reduce(b,function(x,M){const A=M[0],C=M[1],R=Math.max(A[0],Math.min(C[0],x[0])),_=Math.max(A[1],Math.min(C[1],x[1]));return[R,_]},d);return ct(a,S)}}};sn.standard=null;const nn={updatePoints:function(s,t){const e=dt(s,t);w.each(this.state.points,function(r){r.setCoord(ct(r.coord(),e))})}};nn.standard=null;const on={add:ti,modify:Ri,draw:Ie,remove:ei,onMoveStart:{standard:null},constraints:sn,onMove:nn,onMoveEnd:{standard:null}},Os=kt.assert,zs=kt.normalizeOptions,rn={points:null,static:!1,cursor:"move",normalStyle:null,highlightStyle:null,extendLine:!1,extendRay:!1},an={visibleShape:null,mouseTarget:null},be=function(s,t,e){Os(s!=null),Os(e!=null),w.extend(this,{graphie:s,movable:t,state:{id:w.uniqueId("movableLine")}}),this.modify(w.extend({},an,e))};w.extend(be,on);kt.createGettersFor(be,w.extend({},rn,an));kt.addMovableHelperMethodsTo(be);w.extend(be.prototype,{cloneState:function(){return w.extend(this.movable.cloneState(),{coords:this.coords()},this.state)},_createDefaultState:function(){return w.extend({id:this.state.id},zs(Gi(on,"standard")),rn)},modify:function(s){this.update(w.extend(this._createDefaultState(),s))},update:function(s){const t=this,e=this.graphie,r=t.state=w.extend(t.state,zs(s)),a=r.static?G.DYNAMIC:G.INTERACTIVE;if(r.normalStyle=w.extend({stroke:a,"stroke-width":2},r.normalStyle),r.highlightStyle=w.extend({stroke:G.INTERACTING,"stroke-width":3},r.highlightStyle),!r.static&&!r.mouseTarget){const u={thickness:30,mouselayer:!0,interactiveKindForTesting:"movable-line"};r.mouseTarget=new ai(e,this.coord(0),this.coord(1),u),r.mouseTarget.attr({fill:"#000",opacity:0})}r.static&&r.mouseTarget&&(r.mouseTarget.remove(),r.mouseTarget=null),t.movable.modify(w.extend({},r,{mouseTarget:r.mouseTarget,add:null,modify:null,draw:t.draw.bind(t),remove:null,onMoveStart:function(){t._initialRefCoord=t.coord(0),t._prevRefCoord=t._initialRefCoord,t._totalDelta=[0,0],t._fireEvent(t.state.onMoveStart,t.coord(0),t.coord(0))},onMove:function(u,d){const v=dt(u,d);t._totalDelta=ct(t._totalDelta,v);let y=ct(t._initialRefCoord,t._totalDelta);y=t._applyConstraints(y,t._prevRefCoord),y!==!1&&(t._fireEvent(t.state.onMove,y,t._prevRefCoord),t._prevRefCoord=y)},onMoveEnd:function(){t._fireEvent(t.state.onMoveEnd,t._prevRefCoord,t._initialRefCoord)}})),r.added||(t.prevState={},t._fireEvent(r.add,t.cloneState(),t.prevState),r.added=!0,w.invoke(r.points,"listen","onMove",r.id,t.draw.bind(t)),t.prevState=t.cloneState()),t._fireEvent(r.modify,t.cloneState(),t.prevState)},coords:function(){return w.invoke(this.state.points,"coord")},point:function(s){return this.state.points[s]},coord:function(s){return this.point(s).coord()},remove:function(){this.state.added=!1,this._fireEvent(this.state.remove),this.points&&w.invoke(this.points,"unlisten","onMove",this.state.id),this.movable&&this.movable.remove()},toBack:function(){this.movable.toBack(),this.state.visibleShape&&this.state.visibleShape.toBack()},toFront:function(){this.state.visibleShape&&this.state.visibleShape.toFront(),this.movable.toFront()},isHovering:function(){return this.movable.isHovering()},isDragging:function(){return this.movable.isDragging()},mouseTarget:function(){return this.movable.mouseTarget()}});const Di={constrain:function(){this.constrain()}};Di.standard=[Di.constrain];const Ni={draw:function(){this.draw()}};Ni.standard=[Ni.draw];const si={basic:function(s,t){const e=this.graphie;if(!this.state.visibleShape){const r=[this.pointSize()/e.scale[0],this.pointSize()/e.scale[1]],a={maxScale:Math.max(this.highlightStyle().scale,this.normalStyle().scale),padding:10,shadow:s.shadow};this.state.visibleShape=new ri(e,this.coord(),r,a),this.state.visibleShape.attr(w.omit(this.normalStyle(),"scale")),this.state.visibleShape.toFront(),this.mouseTarget()&&this.mouseTarget().toFront()}s.normalStyle!==t.normalStyle&&!w.isEqual(s.normalStyle,t.normalStyle)&&this.state.visibleShape.attr(this.normalStyle()),this.state.visibleShape.moveTo(this.coord()),this.mouseTarget()&&this.mouseTarget().moveTo(this.coord())},highlight:function(s,t){s.isHovering&&!t.isHovering?s.visibleShape.animate(this.highlightStyle(),50):!s.isHovering&&t.isHovering&&s.visibleShape.animate(this.normalStyle(),50)}};si.standard=[si.basic,si.highlight];const Vi={basic:function(){this.state.visibleShape&&(this.state.visibleShape.remove(),this.state.visibleShape=null)}};Vi.standard=Vi.basic;const ln={fixed:function(){return function(){return!1}},snap:function(s){return function(t){return s===null?!0:Fi(t,s||this.graphie.snap)}},bound:function(s,t,e){const r=e===void 0?s===void 0?10:0:e;return function(a,u,d){const v=this.graphie;s=s||v.range,t===void 0&&(t=v.snap);let y=v.unscalePoint([r,v.ypixels-r]),b=v.unscalePoint([v.xpixels-r,r]);if(t&&(y=zi(y,t),b=Bi(b,t)),d&&d.onOutOfBounds)return(a[0]>b[0]||a[0]<y[0]||a[1]>b[1]||a[1]<y[1])&&(d.onSkipRemaining(),d.onOutOfBounds()),a;const S=Math.max(y[0],Math.min(b[0],a[0])),x=Math.max(y[1],Math.min(b[1],a[1]));return[S,x]}}};ln.standard=null;const Zt={add:Di,modify:Ni,draw:si,remove:Vi,onMoveStart:{standard:null},constraints:ln,onMove:{standard:null},onMoveEnd:{standard:null},onClick:{standard:null}},Pi=kt.assert,Bs=kt.normalizeOptions,{processMath:Io}=Qs,Lo={coord:[0,0],pointSize:4,static:!1,cursor:"move",normalStyle:null,highlightStyle:null,shadow:!1,tooltip:!1},Ro={added:!1,hasMoved:!1,visibleShape:null,outOfBounds:!1,mouseTarget:null,touchOffset:null},Fs=[];var Bt;let Gs=(Bt=class{constructor(t,e,r){this._listenerMap={},this.graphie=t,this.movable=e,this.state={id:w.uniqueId("movablePoint")},this.modify({...Ro,...r})}modify(t){this.update(w.extend(this._createDefaultState(),t))}_createDefaultState(){return{id:this.state.id,...Bs(Gi(Zt,"standard")),...Lo}}cloneState(){return{...this.movable.cloneState(),...this.state}}update(t){const e=this,r=e.graphie,a=w.extend(e.state,Bs(t));Pi(Jt(a.coord));const u=a.static?G.DYNAMIC:G.INTERACTIVE;if(a.normalStyle=w.extend({fill:u,stroke:u,scale:1},a.normalStyle),a.highlightStyle=w.extend({fill:G.INTERACTING,stroke:G.INTERACTING,scale:2},a.highlightStyle),!a.static&&!a.mouseTarget){const y=e.state.coord,b=r.unscaleVector(24),S={mouselayer:!0,padding:0,interactiveKindForTesting:"movable-point"};a.mouseTarget=new ri(r,y,b,S),a.mouseTarget.attr({fill:"#000",opacity:0})}const d=()=>{this._showTooltip(y=>{Js(Tt.createElement("span",{style:{fontSize:"2em"}},Tt.createElement(Un,{...Zn,style:{position:"static",color:G.INTERACTIVE,marginLeft:9,marginRight:9}})),y)})};let v=a.coord;e.movable.modify(w.extend({},a,{add:null,modify:null,draw:e.draw.bind(e),remove:null,onMoveStart:y=>{if(a.hasMoved=!1,v=a.coord,a.touchOffset==null){const S=!("ontouchstart"in window);a.touchOffset=S?[0,0]:dt(v,y)}const b=a.visibleShape.wrapper;if(a.shadow){const S="none";b.style.filter=S}if(a.showHairlines&&a.showHairlines(a.coord),Fs.forEach(S=>S()),a.tooltip&&(a.xOnlyTooltip?this._showTooltip(`${a.coord[0]}`):this._showTooltip(`(${a.coord[0]}, ${a.coord[1]})`),a.shadow)){const S=b.getElementsByClassName("tooltip-content")[0],x="drop-shadow(0px 0px 5px rgba(0, 0, 0, 0.5))";S.style.filter=x}e._fireEvent(a.onMoveStart,v,v),e.draw()},onMove:(y,b)=>{const S=ct(y,a.touchOffset);e.moveTo(S),a.showHairlines&&(this.state.outOfBounds?a.hideHairlines():a.showHairlines(a.coord)),a.tooltip&&(this.state.outOfBounds||(a.xOnlyTooltip?this._showTooltip(`${a.coord[0]}`):this._showTooltip(`(${a.coord[0]}, ${a.coord[1]})`))),a.onRemove&&this.state.outOfBounds&&d()},onMoveEnd:()=>{e.isHovering()&&!a.hasMoved&&e._fireEvent(a.onClick,a.coord,v);const y=a.visibleShape.wrapper;if(a.shadow){const b="drop-shadow(0px 0px 5px rgba(0, 0, 0, 0.5))";y.style.filter=b}if(a.hideHairlines&&a.hideHairlines(),a.hasMoved)this._hideTooltip();else if(a.onRemove){d();const b=y.getElementsByClassName("tooltip-content")[0];b.style.filter="none",this._tooltip.firstChild.addEventListener("touchstart",S=>{S.stopPropagation()},!0),this._tooltip.firstChild.addEventListener("touchend",S=>{a.onRemove(),S.stopPropagation()},!0)}else a.tooltip&&this._hideTooltip();a.outOfBounds&&a.onRemove(),e._fireEvent(a.onMoveEnd,a.coord,v),a.hasMoved=!1,a.touchOffset=null,e.draw()}})),a.added||(e.prevState={},e._fireEvent(a.add,e.cloneState(),e.prevState),a.added=!0,e.prevState=e.cloneState()),e._fireEvent(a.modify,e.cloneState(),e.prevState)}draw(){const t=this.cloneState();this._fireEvent(this.state.draw,t,this.prevState),this.prevState=t}constrain(){const t=this._applyConstraints(this.coord(),this.coord());return Jt(t)&&this.setCoord(t),t!==!1}_fireEvent(t,...e){for(const r of t)r.call(this,...e)}_applyConstraints(t,e,r){let a=!1;return this.state.constraints.reduce((u,d)=>{if(u===!1)return!1;if(a)return u;const v=d.call(this,u,e,{onSkipRemaining:()=>{a=!0},...r});if(v===!1)return!1;if(Jt(v,2))return v;if(v===!0||v==null)return u;throw new $t("Constraint returned invalid result: "+v,Vt.Internal)},t)}_showTooltip(t){this._tooltip||(this._tooltip=document.createElement("div"),this._tooltip.className="tooltip-content",this.state.visibleShape.wrapper.className="tooltip",this.state.visibleShape.wrapper.appendChild(this._tooltip),Fs.push(()=>{this.state.added&&this._hideTooltip()})),this._tooltip.firstChild&&this._tooltip.removeChild(this._tooltip.firstChild),this.state.visibleShape.wrapper.className="tooltip visible",this._tooltip.appendChild(document.createElement("span")),typeof t=="string"?Io(this._tooltip.firstChild,t,!1):typeof t=="function"?t(this._tooltip.firstChild):this._tooltip.firstChild.appendChild(t)}_hideTooltip(){this._tooltip&&(this.state.visibleShape.wrapper.className="tooltip")}coord(){return this.state.coord}setCoord(t){Pi(Jt(t,2)),this.state.coord=w.clone(t),this.draw()}setCoordConstrained(t){Pi(Jt(t,2));const e=this._applyConstraints(t,this.coord());e!==!1&&(this.state.coord=w.clone(e),this.draw())}listen(t,e,r){this._listenerMap=this._listenerMap||{};const a=Ys(t,e),u=this._listenerMap[a]=this._listenerMap[a]||this.state[t].length;this.state[t][u]=r}unlisten(t,e){this._listenerMap=this._listenerMap||{};const r=Ys(t,e),a=this._listenerMap[r];if(a!==void 0){this.state[t].splice(a,1),delete this._listenerMap[r];const u=w.keys(this._listenerMap);w.each(u,d=>{Do(d)===t&&this._listenerMap[d]>a&&this._listenerMap[d]--},this)}}grab(t){this.state.touchOffset=[0,0],this.movable.grab(t),this.moveTo(t)}moveTo(t){const e=this.state;this.state.outOfBounds=!1;const r=this._applyConstraints(t,e.coord,e.onRemove?{onOutOfBounds:()=>{this.state.outOfBounds=!0},onSkipRemaining:()=>{}}:{onSkipRemaining:()=>{}});if(r!==!1&&(Jt(r)&&(t=r),!Ws(t,e.coord))){const a=e.coord;e.coord=t,e.hasMoved=!0,this._fireEvent(e.onMove,e.coord,a),this.draw()}}remove(){this.state.added=!1,this._fireEvent(this.state.remove),this.movable&&this.movable.remove(),this.state.mouseTarget=null}pointSize(){return this.state.pointSize}static(){return this.state.static}cursor(){return this.state.cursor}normalStyle(){return this.state.normalStyle}highlightStyle(){return this.state.highlightStyle}shadow(){return this.state.shadow}tooltip(){return this.state.tooltip}added(){return this.state.added}hasMoved(){return this.state.hasMoved}visibleShape(){return this.state.visibleShape}outOfBounds(){return this.state.outOfBounds}mouseTarget(){return this.state.mouseTarget}touchOffset(){return this.state.touchOffset}isHovering(){return this.movable.isHovering()}isDragging(){return this.movable.isDragging()}toBack(){this.movable.toBack(),this.state.visibleShape&&this.state.visibleShape.toBack()}toFront(){this.state.visibleShape&&this.state.visibleShape.toFront(),this.movable.toFront()}},Bt.add=Zt.add,Bt.modify=Zt.modify,Bt.draw=Zt.draw,Bt.remove=Zt.remove,Bt.onMoveStart=Zt.onMoveStart,Bt.constraints=Zt.constraints,Bt.onMove=Zt.onMove,Bt.onMoveEnd=Zt.onMoveEnd,Bt.onClick=Zt.onClick,Bt);function Ys(s,t){return s+":"+t}function Do(s){return s.split(":")[0]}function No(s){return w.reduce(s,function(t,e){return t+e},0)}function Vo(s){const t=w.zip(s,s.slice(1).concat(s.slice(0,1))),e=w.map(t,function(r){const a=r[0],u=r[1];return(u[0]-a[0])*(u[1]+a[1])});return No(e)>0}const ni={constrain:function(){this.constrain()},pointsToFront:function(s){w.invoke(s.points,"toFront")}};ni.standard=[ni.constrain,ni.pointsToFront];const Hi={draw:function(){this.draw()}};Hi.standard=[Hi.draw];const Le={basic:function(s,t){const e=this.graphie,r=this.path(s);this.state.visibleShape||(this.state.visibleShape=e.raphael.path(r),this.state.visibleShape.attr(this.normalStyle())),s.normalStyle!==t.normalStyle&&!w.isEqual(s.normalStyle,t.normalStyle)&&this.state.visibleShape.attr(this.normalStyle()),this.state.visibleShape.attr({path:r}),this.mouseTarget()&&this.mouseTarget().attr({path:r})},labels:function(s,t){const e=this.graphie,r=this,a=w.invoke(s.points,"coord"),u=Vo(a),d=a.length;r.state._labelCache!=null&&w.invoke(r.state._labelCache,"remove"),r.state._labelCache=[],(s.angleLabels.length||s.showRightAngleMarkers.length)&&(r.state._labeledAngles==null&&(r.state._labeledAngles=w.times(Math.max(s.angleLabels.length,s.showRightAngleMarkers.length),function(){return e.label([0,0],"","center",s.labelStyle)})),w.each(r.state._labeledAngles,function(v,y){r.state._labelCache.push(e.labelAngle({point1:a[(y-1+d)%d],vertex:a[y],point3:a[(y+1)%d],label:v,text:s.angleLabels[y],showRightAngleMarker:s.showRightAngleMarkers[y],numArcs:s.numArcs[y],clockwise:u,style:s.labelStyle}))})),s.sideLabels.length&&(r.state._labeledSides==null&&(r.state._labeledSides=w.map(s.sideLabels,function(v){return e.label([0,0],"","center",s.labelStyle)})),w.each(r.state._labeledSides,function(v,y){r.state._labelCache.push(e.labelSide({point1:a[y],point2:a[(y+1)%d],label:v,text:s.sideLabels[y],numArrows:s.numArrows[y],numTicks:s.numTicks[y],clockwise:u,style:s.labelStyle}))})),s.vertexLabels.length&&(r.state._labeledVertices==null&&(r.state._labeledVertices=w.map(s.vertexLabels,function(v){return e.label([0,0],"","center",s.labelStyle)})),w.each(r.state._labeledVertices,function(v,y){r.state._labelCache.push(e.labelVertex({point1:a[(y-1+d)%d],vertex:a[y],point3:a[(y+1)%d],label:v,text:s.vertexLabels[y],clockwise:u,style:s.labelStyle}))})),r.state._labelCache=w.flatten(r.state._labelCache)},highlight:function(s,t){s.isHovering&&!t.isHovering?s.visibleShape.animate(this.highlightStyle(),50):!s.isHovering&&t.isHovering&&s.visibleShape.animate(this.normalStyle(),50)}};Le.standard=[Le.basic,Le.labels,Le.highlight];const oi={basic:function(){this.state.visibleShape&&this.state.visibleShape.remove()},labels:function(){const s=[this.state._labeledSides,this.state._labeledVertices,this.state._labeledAngles,this.state._labelCache];w.each(s,function(t){t!=null&&t.length&&w.invoke(t,"remove")})}};oi.standard=[oi.basic,oi.labels];const cn={fixed:function(){return function(){return!1}},snap:function(s){return function(t){return s===null?!0:(s=s||this.graphie.snap,Fi(t,s))}},bound:function(s,t,e){return e===void 0&&(s===void 0?e=10:e=0),function(r,a){const u=this.graphie,d=dt(r,a);s=s||u.range,t===void 0&&(t=u.snap);let v=u.unscalePoint([e,u.ypixels-e]),y=u.unscalePoint([u.xpixels-e,e]);t&&(v=zi(v,t),y=Bi(y,t));const b=w.map(this.coords(),function(x,M){const A=dt(y,x);return[dt(v,x),A]}),S=w.reduce(b,function(x,M){const A=M[0],C=M[1],R=Math.max(A[0],Math.min(C[0],x[0])),_=Math.max(A[1],Math.min(C[1],x[1]));return[R,_]},d);return ct(a,S)}}};cn.standard=null;const hn={updatePoints:function(s,t){const e=dt(s,t);w.each(this.state.points,function(r){r.setCoord(ct(r.coord(),e))})}};hn.standard=null;const un={add:ni,modify:Hi,draw:Le,remove:oi,onMoveStart:{standard:null},constraints:cn,onMove:hn,onMoveEnd:{standard:null},onClick:{standard:null}},Xs=kt.assert,qs=kt.normalizeOptions,dn={points:null,angleLabels:[],showRightAngleMarkers:[],sideLabels:[],vertexLabels:[],numArcs:[],numArrows:[],numTicks:[],closed:!0,static:!1,cursor:"move",normalStyle:null,highlightStyle:null,labelStyle:null},fn={added:!1,hasMoved:!1,visibleShape:null,mouseTarget:null},ye=function(s,t,e){Xs(s!=null),Xs(e!=null),w.extend(this,{graphie:s,movable:t,state:{id:w.uniqueId("movablePolygon")}}),this.modify(w.extend({},fn,e))};w.extend(ye,un);kt.createGettersFor(ye,w.extend({},dn,fn));kt.addMovableHelperMethodsTo(ye);w.extend(ye.prototype,{cloneState:function(){return w.extend(this.movable.cloneState(),this.state)},_createDefaultState:function(){return w.extend({id:this.state.id},qs(Gi(un,"standard")),dn)},modify:function(s){this.update(w.extend(this._createDefaultState(),s))},update:function(s){const t=this,e=t.graphie,r=w.extend(t.state,qs(s)),a=r.static?G.DYNAMIC:G.INTERACTIVE;r.normalStyle=w.extend({},r.normalStyle,{"stroke-width":2,"fill-opacity":0,fill:a,stroke:a},s.normalStyle),r.highlightStyle=w.extend({},{stroke:G.INTERACTING,"stroke-width":2,fill:G.INTERACTING,"fill-opacity":.05},r.highlightStyle),r.labelStyle=w.extend({},{stroke:G.DYNAMIC,"stroke-width":1,color:G.DYNAMIC},r.labelStyle),r.static||r.mouseTarget||(r.mouseTarget=e.mouselayer.path(this.path()),r.mouseTarget.attr({fill:"#000",opacity:0,cursor:"move"})),t.movable.modify(w.extend({},r,{modify:null,draw:t.draw.bind(t),remove:null,onMoveStart:function(){t._initialRefCoord=t.coord(0),t._prevRefCoord=t._initialRefCoord,t._totalDelta=[0,0],t._fireEvent(t.state.onMoveStart,t.coord(0),t.coord(0))},onMove:function(u,d){const v=dt(u,d);t._totalDelta=ct(t._totalDelta,v);let y=ct(t._initialRefCoord,t._totalDelta);y=t._applyConstraints(y,t._prevRefCoord),y!==!1&&(t._fireEvent(t.state.onMove,y,t._prevRefCoord),t._prevRefCoord=y)},onMoveEnd:function(){t._fireEvent(t.state.onMoveEnd,t._prevRefCoord,t._initialRefCoord)}})),w.invoke(r.points,"listen","onMove",r.id,t.draw.bind(t)),r.added||(t.prevState={},t._fireEvent(r.add,t.cloneState(),t.prevState),r.added=!0,t.prevState=t.cloneState()),t._fireEvent(r.modify,t.cloneState(),t.prevState)},path:function(s){const t=this.graphie;s=s||this.state;let e=w.map(s.points,function(r){return t.scalePoint(r.coord())});return s.closed?e.push(!0):e=e.concat(w.clone(e).reverse()),bt.unscaledSvgPath(e)},coords:function(){return w.invoke(this.state.points,"coord")},point:function(s){return this.state.points[s]},coord:function(s){return this.point(s).coord()},remove:function(){this.state.added=!1,this._fireEvent(this.state.remove),this.state.points&&w.invoke(this.state.points,"unlisten","onMove",this.state.id),this.movable&&this.movable.remove(),this.state.mouseTarget=null},constrain:function(){if(this.points==null||this.points.length===0)return;const s=this.coord(0),t=this._applyConstraints(s,s);t!==!1&&this._fireEvent(this.state.onMove,t,s)},normalStyle:function(){return w.clone(this.state.normalStyle)},highlightStyle:function(){return w.clone(this.state.highlightStyle)},toBack:function(){this.movable.toBack(),this.state.visibleShape&&this.state.visibleShape.toBack()},toFront:function(){this.state.visibleShape&&this.state.visibleShape.toFront(),this.movable.toFront()},isHovering:function(){return this.movable.isHovering()},isDragging:function(){return this.movable.isDragging()},mouseTarget:function(){return this.movable.mouseTarget()}});const De={MovablePoint:Gs,addMovablePoint:function(s,t){const e=new Ci(s,{});return new Gs(s,e,t)},MovableLine:be,addMovableLine:function(s,t){const e=new Ci(s,{});return new be(s,e,t)},MovablePolygon:ye,addMovablePolygon:function(s,t){const e=new Ci(s,{});return new ye(s,e,t)},addMaybeMobileMovablePoint:function(s,t){const e=s.props.apiOptions.isMobile,r=e?{stroke:"#ffffff","stroke-width":3,fill:G.INTERACTIVE}:{stroke:G.INTERACTIVE,fill:G.INTERACTIVE},a=Object.assign(r,t.normalStyle),u=Object.assign(e?{...r,"stroke-width":0,scale:.75}:{},t.highlightStyle),d=Object.assign({normalStyle:a,highlightStyle:u,shadow:e,tooltip:e&&s.props.showTooltips,showHairlines:s.showHairlines,hideHairlines:s.hideHairlines},e?{pointSize:7}:{});return De.addMovablePoint(s.graphie,Object.assign(t,d))}},pn=Rt.createClass({displayName:"MovablePoint",movableProps:["children"],_getProps:function(){if(this.props.isMobile){const s=this.props.isMobile,t=s?{stroke:"#ffffff","stroke-width":3,fill:G.INTERACTIVE}:{stroke:G.INTERACTIVE,fill:G.INTERACTIVE},e=s?Object.assign(t,this.props.mobileStyleOverride||{}):Object.assign(t,this.props.normalStyle),r=s?{...t,"stroke-width":0,scale:.75}:this.props.highlightStyle,a=Object.assign({normalStyle:e,highlightStyle:r,shadow:s,tooltip:s&&this.props.showTooltips},s?{pointSize:7}:{});return Object.assign(this.props,a)}return this.props},add:function(s){this.point=De.addMovablePoint(s,this._getProps())},modify:function(){this.point.modify(this._getProps())},remove:function(){this.point.remove()},toFront:function(){this.point.toFront()},grab:function(s){this.point.grab(s)}});w.extend(pn,De.MovablePoint);const mn=Rt.createClass({displayName:"MovableLine",movableProps:["children"],add:function(s){const t=w.pluck(this.props.children,"point"),e=w.extend({},this.props,{points:t});this.line=De.addMovableLine(s,e)},modify:function(){const s=w.pluck(this.props.children,"point"),t=w.extend({},this.props,{points:s});this.line.modify(t)},remove:function(){this.line.remove()},toFront:function(){this.line.toFront()}});w.extend(mn,De.MovableLine);const Ho=Rt.createSimpleClass((s,t)=>{let e=t.coord;t.unscaled&&(e=s.unscalePoint(e));let r=null;return se().JIPT.useJIPT?(r=s.label(e,t.text,t.direction,!1,t.style),se().graphieMovablesJiptLabels.addLabel(r,t.tex)):r=s.label(e,t.text,t.direction,t.tex,t.style),r}),Oo=Rt.createClass({displayName:"Line",movableProps:["children"],add:function(s){const t=this.props;this.graphie=s,this.line=this.graphie.line(t.start,t.end,t.style)},modify:function(){const s=this.props,t=this.graphie.svgPath([s.start,s.end]);this.line.attr(w.extend({},s.style,{path:t}))},remove:function(){this.line.remove()},toFront:function(){this.line.toFront()}}),zo=Rt.createClass({displayName:"Parabola",movableProps:["children"],add:function(s){const t=this.props;this.graphie=s,this.parabola=this.graphie.parabola(t.a,t.b,t.c,t.style)},modify:function(){const s=this.props,t=this.graphie.svgParabolaPath(s.a,s.b,s.c);this.parabola.attr(w.extend({},s.style,{path:t}))},remove:function(){this.parabola.remove()},toFront:function(){this.parabola.toFront()}}),Bo=Rt.createClass({displayName:"Sinusoid",movableProps:["children"],add:function(s){const t=this.props;this.graphie=s,this.sinusoid=this.graphie.sinusoid(t.a,t.b,t.c,t.d,t.style)},modify:function(){const s=this.props,t=this.graphie.svgSinusoidPath(s.a,s.b,s.c,s.d);this.sinusoid.attr(w.extend({},s.style,{path:t}))},remove:function(){this.sinusoid.remove()},toFront:function(){this.sinusoid.toFront()}}),Fo=Rt.createSimpleClass((s,t)=>s.plot(t.fn,t.range,t.style)),Go=Rt.createSimpleClass((s,t)=>s.plotParametric(t.fn,t.range,t.style)),Yo=Rt.createSimpleClass((s,t)=>s.ellipse(t.coord,s.unscaleVector([4,4]),{fill:t.color||G.BLACK,stroke:t.color||G.BLACK})),Xo=Rt.createClass({displayName:"Path",movableProps:["children"],add:function(s){const t=this.props;this.graphie=s,this.path=this.graphie.path(t.coords,t.style)},modify:function(){const s=this.props,t=this.graphie.svgPath(s.coords);this.path.attr({path:t})},remove:function(){this.path.remove()},toFront:function(){this.path.toFront()}}),qo=Rt.createSimpleClass((s,t)=>{let e=t.center,r=t.radius;return t.unscaled&&(e=s.unscalePoint(e),r=s.unscaleVector(r)),s.arc(e,r,t.startAngle,t.endAngle,t.sector,t.style)}),Uo=Rt.createSimpleClass((s,t)=>s.circle(t.center,t.radius,t.style)),Zo=Rt.createSimpleClass((s,t)=>s.rect(t.x,t.y,t.width,t.height,t.style)),Wo={Arc:qo,Circle:Uo,Label:Ho,Line:Oo,MovableLine:mn,MovablePoint:pn,Parabola:zo,Path:Xo,Plot:Fo,PlotParametric:Go,Point:Yo,Sinusoid:Bo,Rect:Zo},$o=Rt.GraphieMovable,Ko=bt.createGraphie,{nestedMap:jo}=Lt,{assert:Jo}=kt,qi=class qi extends Tt.Component{constructor(){super(...arguments),this.graphieDivRef=Tt.createRef(),this._graphie=new Ii(document.createElement("div")),this._movables={},this.movables={},this.getGraphie=()=>this._graphie,this._range=()=>{const t=e=>e[0]>=e[1]?[-10,10]:e;return[t(this.props.range[0]),t(this.props.range[1])]},this._box=()=>{const t=e=>e>0?e:340;return[t(this.props.box[0]),t(this.props.box[1])]},this._scale=()=>{const t=this._box(),e=this._range();return t.map((r,a)=>{const u=e[a][1]-e[a][0];return r/u})},this._setupGraphie=()=>{this._removeMovables();const t=this.graphieDivRef.current;if(t==null||t instanceof Text)throw new Error("No graphie container div found");t.innerHTML="";const e=this._graphie=Ko(t);e.init({range:this._range(),scale:this._scale(),isMobile:this.props.isMobile}),this.props.addMouseLayer&&e.addMouseLayer({onClick:this.props.onClick,onMouseDown:this.props.onMouseDown,onMouseMove:this.props.onMouseMove,setDrawingAreaAvailable:this.props.setDrawingAreaAvailable}),e.snap=this.props.options.snapStep||[1,1],this.props.responsive&&(E(t).css({width:"100%",height:"100%"}),e.raphael.setSize("100%","100%")),this.props.setup(e,w.extend({range:this._range(),scale:this._scale()},this.props.options))},this._removeMovables=()=>{w.invoke(this._movables,"remove"),this._movables={}},this._renderMovables=(t,e)=>{const r=e.graphie,a=e.oldMovables,u=e.newMovables,d=y=>{w.each(y.movableProps,b=>{y.props[b]=this._renderMovables(y.props[b],e)})};let v=!1;return jo(t,y=>{if(!y)return e.nextKey++,y;const b=new y.type(y.props);Jo(b instanceof $o,"All children of a Graphie component must be Graphie movables");const S=y.key,x=S??"_no_id_"+e.nextKey;e.nextKey++;const M=y.ref;d(b);const A=a[x];return A?b.constructor===A.constructor?(A.props=b.props,A.modify(r)==="reordered"&&(v=!0),u[x]=A):(S==null&&Re.error("Replacing a <Graphie> child with a child of a different type. Please add keys to your <Graphie> children",Vt.Internal),A.remove(),b.add(r),v=!0,u[x]=b):(b.add(r),v=!0,u[x]=b),v&&u[x].toFront(),M&&(this.movables[M]=u[x]),u[x]})},this._updateMovables=()=>{const t=this._graphie,e=this._movables,r={};this._movables=r,this.movables={},this._renderMovables(this.props.children,{nextKey:1,graphie:t,oldMovables:e,newMovables:r}),w.each(e,(a,u)=>{r[u]||a.remove()})}}componentDidMount(){this._setupGraphie(),this._updateMovables()}shouldComponentUpdate(t){return!w.isEqual(this.props,t)}componentDidUpdate(t){this.props.setup!==t.setup&&Re.error("<Graphie> was given a new setup function. This is a bad idea; please refactor your code to give the same setup function reference to <Graphie> on every render.",Vt.Internal),(!Je(this.props.options,t.options)||!Je(this.props.box,t.box)||!Je(this.props.range,t.range))&&this._setupGraphie(),this._updateMovables()}render(){return Tt.createElement("div",{className:"graphie-container"},Tt.createElement("div",{className:"graphie",ref:this.graphieDivRef}))}};qi.defaultProps={range:[[-10,10],[-10,10]],options:{},responsive:!1,addMouseLayer:!0};let re=qi;w.extend(re,Rt);w.extend(re,Wo);re.__docgenInfo={description:"",methods:[{name:"getGraphie",docblock:`Allow parents of the <Graphie> component to grab a reference to the
underlying graphie object using
\`this.refs.graphieComponent.getGraphie()\`

This shouldn't be necessary for 90% of cases, but the power is there.
Use it for good and not evil.`,modifiers:[],params:[],returns:null,description:`Allow parents of the <Graphie> component to grab a reference to the
underlying graphie object using
\`this.refs.graphieComponent.getGraphie()\`

This shouldn't be necessary for 90% of cases, but the power is there.
Use it for good and not evil.`},{name:"_range",docblock:null,modifiers:[],params:[],returns:null},{name:"_box",docblock:null,modifiers:[],params:[],returns:null},{name:"_scale",docblock:null,modifiers:[],params:[],returns:null},{name:"_setupGraphie",docblock:null,modifiers:[],params:[],returns:null},{name:"_removeMovables",docblock:null,modifiers:[],params:[],returns:null},{name:"_renderMovables",docblock:null,modifiers:[],params:[{name:"children",optional:!1,type:null},{name:"options",optional:!1,type:null}],returns:null},{name:"_updateMovables",docblock:null,modifiers:[],params:[],returns:null}],displayName:"Graphie",props:{addMouseLayer:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},box:{required:!0,tsType:{name:"tuple",raw:"[width: number, height: number]",elements:[{name:"unknown"},{name:"unknown"}]},description:""},range:{required:!1,tsType:{name:"tuple",raw:"[Coord, Coord]",elements:[{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]}]},description:"",defaultValue:{value:`[
    [-10, 10],
    [-10, 10],
]`,computed:!1}},ranges:{required:!1,tsType:{name:"tuple",raw:"[Range, Range]",elements:[{name:"tuple",raw:"[min: number, max: number]",elements:[{name:"unknown"},{name:"unknown"}]},{name:"tuple",raw:"[min: number, max: number]",elements:[{name:"unknown"},{name:"unknown"}]}]},description:""},gridStep:{required:!1,tsType:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},description:""},step:{required:!1,tsType:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},description:""},scale:{required:!1,tsType:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},description:""},isMobile:{required:!1,tsType:{name:"boolean"},description:""},responsive:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},options:{required:!1,tsType:{name:"any"},description:"",defaultValue:{value:"{}",computed:!1}},setDrawingAreaAvailable:{required:!1,tsType:{name:"signature",type:"function",raw:"(boolean) => void",signature:{arguments:[{name:"boolean"}],return:{name:"void"}}},description:""},setup:{required:!0,tsType:{name:"signature",type:"function",raw:`(
    graphie: any,
    options: {
        range: [Coord, Coord];
        scale: [number, number];
    },
) => void`,signature:{arguments:[{type:{name:"any"},name:"graphie"},{type:{name:"signature",type:"object",raw:`{
    range: [Coord, Coord];
    scale: [number, number];
}`,signature:{properties:[{key:"range",value:{name:"tuple",raw:"[Coord, Coord]",elements:[{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]}],required:!0}},{key:"scale",value:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}],required:!0}}]}},name:"options"}],return:{name:"void"}}},description:""},onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(at: Coord) => void",signature:{arguments:[{type:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},name:"at"}],return:{name:"void"}}},description:""},onMouseDown:{required:!1,tsType:{name:"signature",type:"function",raw:"(at: Coord) => void",signature:{arguments:[{type:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},name:"at"}],return:{name:"void"}}},description:""},onMouseMove:{required:!1,tsType:{name:"signature",type:"function",raw:"(at: Coord) => void",signature:{arguments:[{type:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},name:"at"}],return:{name:"void"}}},description:""}}};const Qo=700;function tr(s){return/\.(jpg|jpeg)$/i.test(s)}function er(s){return Tt.createElement("span",{style:{top:0,left:0,width:"100%",height:"100%",position:"absolute",minWidth:"20px",display:"flex",justifyContent:"center",alignContent:"center"}},Tt.createElement(Hn,{size:"medium"}))}const Ui=class Ui extends Tt.Component{constructor(t){super(t),this.onImageLoad=()=>{this.sizeProvided()?this.setState({imageLoaded:!0}):Lt.getImageSize(this.props.src,(e,r)=>{this._isMounted&&this.setState({imageLoaded:!0,imageDimensions:[e,r]})})},this.setupGraphie=(e,r)=>{w.map(r.labels,a=>{const{JIPT:u}=se();if(u.useJIPT&&this.state.labelDataIsLocalized){const d=e.label(a.coordinates,a.content,a.alignment,!1);se().svgImageJiptLabels.addLabel(d,a.typesetAsMath)}else if(a.coordinates){const d=this.props.scale!==1?{"font-size":100*this.props.scale+"%"}:null,v=e.label(a.coordinates,a.content,a.alignment,a.typesetAsMath,d),y=v[0].style;let b=this._tryGetPixels(y.top),S=this._tryGetPixels(y.left);if(b===null||S===null){const A=v.position();b=A.top,S=A.left}const x=(this.props.height||0)*this.props.scale,M=(this.props.width||0)*this.props.scale;v.css({top:b/x*100+"%",left:S/M*100+"%"}),w.each(a.style,(A,C)=>{v.css(C,A)})}this.setState({labelsRendered:{...this.state.labelsRendered,[a.content]:!0}})})},this._handleZoomClick=e=>{var a,u;(E(e.target).width()<this.props.width||this.props.zoomToFullSizeOnMobile)&&io.handleZoomClick(e,this.props.zoomToFullSizeOnMobile),(u=(a=this.props).trackInteraction)==null||u.call(a)},this.handleUpdate=e=>{this.props.onUpdate(),!Lt.isLabeledSVG(this.props.src)&&e==="loaded"&&this.setState({imageLoaded:!0})},t.setAssetStatus(t.src,!1),this._isMounted=!1,this.state={imageLoaded:!1,imageDimensions:null,dataLoaded:!1,labelDataIsLocalized:!1,labels:[],labelsRendered:{},range:[[0,0],[0,0]]}}componentDidMount(){this._isMounted=!0,Lt.isLabeledSVG(this.props.src)&&this.loadResources()}UNSAFE_componentWillReceiveProps(t){this.props.src!==t.src&&this.setState({imageLoaded:!1,dataLoaded:!1})}shouldComponentUpdate(t,e){if(!w.isEqual(this.props,t))return!0;const r=this.isLoadedInState(this.state),a=this.isLoadedInState(e);return r!==a}componentDidUpdate(t,e){const r=this.isLoadedInState(e),a=this.isLoadedInState(this.state);Lt.isLabeledSVG(this.props.src)&&!a&&this.loadResources(),!r&&a&&this.props.setAssetStatus(this.props.src,!0)}componentWillUnmount(){this._isMounted=!1}isLoadedInState(t){return Lt.isLabeledSVG(this.props.src)?t.imageLoaded&&t.dataLoaded:t.imageLoaded}loadResources(){to(this.props.src,(t,e)=>{if(this._isMounted&&t.labels&&t.range){const r={};t.labels.forEach(a=>{r[a.content]=!1}),this.setState({dataLoaded:!0,labelDataIsLocalized:e,labelsRendered:r,labels:t.labels,range:t.range})}})}sizeProvided(){return this.props.width!=null&&this.props.height!=null}_tryGetPixels(t){return t=t||"",t.endsWith("px")&&parseFloat(t)||null}render(){const t=this.props.src,e={alt:this.props.alt,title:this.props.title},r=this.props.width&&this.props.width*this.props.scale,a=this.props.height&&this.props.height*this.props.scale,u={width:r,height:a},d=this.props.responsive&&!!(r&&a);let v;this.props.extraGraphie&&this.props.extraGraphie.labels.length&&(v=Tt.createElement(re,{box:this.props.extraGraphie.box,range:this.props.extraGraphie.range,options:{labels:this.props.extraGraphie.labels},responsive:!0,addMouseLayer:!1,setup:this.setupGraphie}));const y=this.props.preloader===void 0?er:this.props.preloader,b=y?()=>y(u):null;if(!Lt.isLabeledSVG(t)){if(d){const M=On({zoomable:(r||0)>Qo,"svg-image":!0});return e.onClick=this._handleZoomClick,Tt.createElement(Ps,{className:M,width:r,height:a,constrainHeight:this.props.constrainHeight,allowFullBleed:this.props.allowFullBleed&&tr(t)},Tt.createElement(Ke,{src:t,imgProps:e,preloader:b,onUpdate:this.handleUpdate}),v)}return e.style=u,Tt.createElement(Ke,{src:t,preloader:b,imgProps:e,onUpdate:this.handleUpdate})}const S=Lt.getSvgUrl(t);let x;if(this.isLoadedInState(this.state)){let M;if(this.sizeProvided())M=[r,a];else if(this.state.imageDimensions)M=[this.state.imageDimensions[0]*this.props.scale,this.state.imageDimensions[1]*this.props.scale];else throw new $t("svg-image has no dimensions",Vt.InvalidInput,{metadata:{src:this.props.src}});x=Tt.createElement(re,{ref:"graphie",box:M,scale:[40*this.props.scale,40*this.props.scale],range:this.state.range,options:w.pick(this.state,"labels"),responsive:d,addMouseLayer:!1,setup:this.setupGraphie})}return d?Tt.createElement(Ps,{className:"svg-image",width:r,height:a,constrainHeight:this.props.constrainHeight},Tt.createElement(Ke,{src:S,onLoad:this.onImageLoad,onUpdate:this.handleUpdate,preloader:b,imgProps:e}),x,v):(e.style=u,Tt.createElement("div",{className:"unresponsive-svg-image",style:u},Tt.createElement(Ke,{src:S,onLoad:this.onImageLoad,onUpdate:this.handleUpdate,preloader:b,imgProps:e}),x))}};Ui.defaultProps={constrainHeight:!1,onUpdate:()=>{},responsive:!0,src:"",scale:1,zoomToFullSizeOnMobile:!1,setAssetStatus:(t,e)=>{}};let Oi=Ui;Oi.__docgenInfo={description:"",methods:[{name:"isLoadedInState",docblock:null,modifiers:[],params:[{name:"state",optional:!1,type:{name:"signature",type:"object",raw:`{
    // For labeled SVGs, when both dataLoaded and imageLoaded are true,
    // indicates that loading has completed.
    dataLoaded: boolean;
    imageDimensions: [number, number] | null | undefined;
    // Used to indicate when a non-labeled SVG image is finished loading
    // and for labeled SVGs, indicates that it's safe to set up the graphie
    // containing the labels.
    imageLoaded: boolean;
    // Some graphies have labels which are rendered after the main image is
    // loaded.  This object keeps track of whether those labels have been
    // rendered.
    labelsRendered: LabelsRenderedMap;
    labelDataIsLocalized: boolean;
    labels: ReadonlyArray<Label>;
    range: [Coord, Coord];
}`,signature:{properties:[{key:"dataLoaded",value:{name:"boolean",required:!0}},{key:"imageDimensions",value:{name:"union",raw:"[number, number] | null | undefined",elements:[{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},{name:"null"},{name:"undefined"}],required:!0}},{key:"imageLoaded",value:{name:"boolean",required:!0}},{key:"labelsRendered",value:{name:"signature",type:"object",raw:`{
    [label: string]: boolean;
}`,signature:{properties:[{key:{name:"string"},value:{name:"boolean",required:!0}}]},required:!0}},{key:"labelDataIsLocalized",value:{name:"boolean",required:!0}},{key:"labels",value:{name:"ReadonlyArray",elements:[{name:"signature",type:"object",raw:`{
    coordinates: ReadonlyArray<any>;
    content: string;
    alignment: Alignment;
    typesetAsMath: boolean;
}`,signature:{properties:[{key:"coordinates",value:{name:"ReadonlyArray",elements:[{name:"any"}],raw:"ReadonlyArray<any>",required:!0}},{key:"content",value:{name:"string",required:!0}},{key:"alignment",value:{name:"union",raw:`| "default"
| "block"
| "inline-block"
| "inline"
| "float-left"
| "float-right"
| "full-width"`,elements:[{name:"literal",value:'"default"'},{name:"literal",value:'"block"'},{name:"literal",value:'"inline-block"'},{name:"literal",value:'"inline"'},{name:"literal",value:'"float-left"'},{name:"literal",value:'"float-right"'},{name:"literal",value:'"full-width"'}],required:!0}},{key:"typesetAsMath",value:{name:"boolean",required:!0}}]}}],raw:"ReadonlyArray<Label>",required:!0}},{key:"range",value:{name:"tuple",raw:"[Coord, Coord]",elements:[{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]}],required:!0}}]},alias:"State"}}],returns:{type:{name:"boolean"}}},{name:"loadResources",docblock:null,modifiers:[],params:[],returns:null},{name:"sizeProvided",docblock:null,modifiers:[],params:[],returns:{type:{name:"boolean"}}},{name:"onImageLoad",docblock:null,modifiers:[],params:[],returns:null},{name:"setupGraphie",docblock:null,modifiers:[],params:[{name:"graphie",optional:!1,type:{name:"any"}},{name:"options",optional:!1,type:{name:"any"}}],returns:null},{name:"_tryGetPixels",docblock:null,modifiers:[],params:[{name:"value",optional:!1,type:{name:"string"}}],returns:{type:{name:"union",raw:"null | number",elements:[{name:"null"},{name:"number"}]}}},{name:"_handleZoomClick",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:{name:"ReactSyntheticEvent",raw:"React.SyntheticEvent",alias:"React.SyntheticEvent"}}],returns:null},{name:"handleUpdate",docblock:null,modifiers:[],params:[{name:"status",optional:!1,type:{name:"string"}}],returns:null}],displayName:"SvgImage",props:{allowFullBleed:{required:!1,tsType:{name:"boolean"},description:""},alt:{required:!0,tsType:{name:"string"},description:""},constrainHeight:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},extraGraphie:{required:!1,tsType:{name:"signature",type:"object",raw:`{
    box: Size;
    range: [Coord, Coord];
    labels: ReadonlyArray<any>;
}`,signature:{properties:[{key:"box",value:{name:"tuple",raw:"[width: number, height: number]",elements:[{name:"unknown"},{name:"unknown"}],required:!0}},{key:"range",value:{name:"tuple",raw:"[Coord, Coord]",elements:[{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]}],required:!0}},{key:"labels",value:{name:"ReadonlyArray",elements:[{name:"any"}],raw:"ReadonlyArray<any>",required:!0}}]}},description:""},height:{required:!1,tsType:{name:"number"},description:""},onUpdate:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:`When the DOM updates to replace the preloader with the image, or
vice-versa, we trigger this callback.`,defaultValue:{value:"() => {}",computed:!1}},overrideAriaHidden:{required:!1,tsType:{name:"boolean"},description:`If alt is provided, DO NOT set aria-hidden=true unless this override flag
is set.`},preloader:{required:!1,tsType:{name:"signature",type:"function",raw:"(dimensions: Dimensions) => React.ReactNode",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
    width?: number;
    height?: number;
}`,signature:{properties:[{key:"width",value:{name:"number",required:!1}},{key:"height",value:{name:"number",required:!1}}]}},name:"dimensions"}],return:{name:"ReactReactNode",raw:"React.ReactNode"}}},description:""},responsive:{required:!1,tsType:{name:"boolean"},description:`By default, this component attempts to be responsive whenever
possible (specifically, when width and height are passed in).

You can expliclty force unresponsive behavior by *either*
not passing in width/height *or* setting this prop to false.

The difference is that forcing via this prop will result in
explicit width and height styles being set on the rendered
component.`,defaultValue:{value:"true",computed:!1}},scale:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"1",computed:!1}},src:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'""',computed:!1}},title:{required:!1,tsType:{name:"string"},description:""},trackInteraction:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},width:{required:!1,tsType:{name:"number"},description:""},zoomToFullSizeOnMobile:{required:!1,tsType:{name:"boolean"},description:`Whether clicking this image will allow it to be fully zoomed in to
its original size on click, and allow the user to scroll in that
state. This also does some hacky viewport meta tag changing to
ensure this works on mobile devices, so I (david@) don't recommend
enabling this on desktop yet.`,defaultValue:{value:"false",computed:!1}},setAssetStatus:{required:!1,tsType:{name:"signature",type:"function",raw:"(assetKey: string, loaded: boolean) => void",signature:{arguments:[{type:{name:"string"},name:"assetKey"},{type:{name:"boolean"},name:"loaded"}],return:{name:"void"}}},description:`If provided, use AssetContext.Consumer, see renderer.jsx.
If not, it defaults to a no-op.`,defaultValue:{value:"(src: string, status: boolean) => {}",computed:!1}}}};export{re as G,De as I,G as K,Re as L,Oi as S,ai as W,kt as a,bt as b};
