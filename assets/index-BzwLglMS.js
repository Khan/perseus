var f=r=>r==null||typeof r!="object"?r:Array.isArray(r)?r.map(f):Object.keys(r).reduce((t,e)=>(t[e]=f(r[e]),t),{}),y=r=>Object.entries(r),k=Object.freeze({Unknown:"Unknown",Internal:"Internal",InvalidInput:"InvalidInput",InvalidUse:"InvalidUse",NotFound:"NotFound",NotAllowed:"NotAllowed",Unauthorized:"Unauthorized",NotImplemented:"NotImplemented"});function m(r,t,e){return(t=function(n){var a=function(s,u){if(typeof s!="object"||s===null)return s;var o=s[Symbol.toPrimitive];if(o!==void 0){var i=o.call(s,u);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(u==="string"?String:Number)(s)}(n,"string");return typeof a=="symbol"?a:String(a)}(t))in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}class g{constructor(t,e,n){m(this,"_name",void 0),m(this,"_message",void 0),m(this,"_stackFrames",void 0),this._name=t,this._message=e,this._stackFrames=[...n]}get message(){return this._message}get name(){return this._name}get messageWithName(){return"".concat(this.name,": ").concat(this.message)}get stack(){return[...this._stackFrames]}get standardizedStack(){return"".concat(this.messageWithName,`
`).concat(this._stackFrames.join(`
`))}static fromConsequenceAndCause(t,e){for(var n,a=[],s=e.stack,u=(n=t==null?void 0:t.stack)!==null&&n!==void 0?n:[],o=s.length-1,i=u.length-1;o>=0&&i>=0&&s[o]===u[i];)a.unshift(s[o]),o--,i--;for(;o>=0;o--)a.unshift(s[o]);for(;i>=0;i--)a.unshift(u[i]);return new g(t.name,((d,c)=>{var l=h=>(h==null?void 0:h.trim())||"(empty message)",v=l(d);return c==null?v:"".concat(v,`
	caused by
		`).concat(l(c))})(t.message,e.messageWithName),a)}static normalize(t){var e,n,a,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,o=(e=t.message.toString().split(`
`).find(l=>l.trim().length))!==null&&e!==void 0?e:"(empty message)",i=t.toString(),d=((n=t.stack)!==null&&n!==void 0&&n.startsWith(i)&&t.stack!==i?t.stack.substring(i.length):(a=t.stack)!==null&&a!==void 0?a:"").split(`
`).filter(l=>l.trim().length),c=d.length>=s+u?s:0;return new g(t.name,o,d.slice(c))}static from(t){var e,n,a=t.toString(),s=((e=t.stack)!==null&&e!==void 0&&e.startsWith(a)&&t.stack!==a?t.stack.substring(a.length):(n=t.stack)!==null&&n!==void 0?n:"").split(`
`).filter(u=>u.trim().length);return new g(t.name,t.message,s)}}class b extends Error{constructor(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:k.Unknown,{cause:n,prefix:a,name:s,metadata:u,stripStackFrames:o,minimumFrameCount:i,compositeStack:d}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Object.freeze({});super(t),m(this,"kind",void 0),m(this,"originalMessage",void 0),m(this,"originalStack",void 0),m(this,"metadata",void 0),m(this,"cause",void 0),this.originalMessage=t,this.metadata=(h=>{if(h==null)return h;var p=f(h);return Object.freeze(p)})(u),this.name="".concat(a??"").concat(e).concat(s??"","Error"),this.kind=e,this.originalStack=this.stack,this.cause=n;var c=g.normalize(this,o??0,i??1);if(delete this.stack,this.stack=c.standardizedStack,n!=null){var l=g.from(n),v=g.fromConsequenceAndCause(c,l);this.message=v.message,d===!0&&(this.stack=v.standardizedStack)}}}var S=r=>!!r;class w extends b{constructor(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:k.InvalidInput,n=arguments.length>2?arguments[2]:void 0;super("Unhandled case for '".concat(t,"'"),e,n)}}export{y as e,S as f,w};
