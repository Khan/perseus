import{a as Ce}from"./version-akiLXZts.js";import{c as ze,g as Le}from"./_commonjsHelpers-4gQjN7DL.js";const Ue="@khanacademy/kas",He="__lib_version__";Ce(Ue,He);var Ne={exports:{}};(function(e,n){(function(){var r=this,c=r._,l={},h=Array.prototype,y=Object.prototype,M=Function.prototype,k=h.push,_=h.slice,v=h.concat,p=y.toString,d=y.hasOwnProperty,f=h.forEach,E=h.map,w=h.reduce,R=h.reduceRight,q=h.filter,W=h.every,$=h.some,ce=h.indexOf,ve=h.lastIndexOf,Z=Array.isArray,Q=Object.keys,se=M.bind,s=function(t){if(t instanceof s)return t;if(!(this instanceof s))return new s(t);this._wrapped=t};e.exports&&(n=e.exports=s),n._=s,s.VERSION="1.4.4";var B=s.each=s.forEach=function(t,i,a){if(t!=null){if(f&&t.forEach===f)t.forEach(i,a);else if(t.length===+t.length){for(var o=0,x=t.length;o<x;o++)if(i.call(a,t[o],o,t)===l)return}else for(var T in t)if(s.has(t,T)&&i.call(a,t[T],T,t)===l)return}};s.map=s.collect=function(t,i,a){var o=[];return t==null?o:E&&t.map===E?t.map(i,a):(B(t,function(x,T,S){o[o.length]=i.call(a,x,T,S)}),o)};var ye="Reduce of empty array with no initial value";s.reduce=s.foldl=s.inject=function(t,i,a,o){var x=arguments.length>2;if(t==null&&(t=[]),w&&t.reduce===w)return o&&(i=s.bind(i,o)),x?t.reduce(i,a):t.reduce(i);if(B(t,function(T,S,L){x?a=i.call(o,a,T,S,L):(a=T,x=!0)}),!x)throw new TypeError(ye);return a},s.reduceRight=s.foldr=function(t,i,a,o){var x=arguments.length>2;if(t==null&&(t=[]),R&&t.reduceRight===R)return o&&(i=s.bind(i,o)),x?t.reduceRight(i,a):t.reduceRight(i);var T=t.length;if(T!==+T){var S=s.keys(t);T=S.length}if(B(t,function(L,z,ee){z=S?S[--T]:--T,x?a=i.call(o,a,t[z],z,ee):(a=t[z],x=!0)}),!x)throw new TypeError(ye);return a},s.find=s.detect=function(t,i,a){var o;return X(t,function(x,T,S){if(i.call(a,x,T,S))return o=x,!0}),o},s.filter=s.select=function(t,i,a){var o=[];return t==null?o:q&&t.filter===q?t.filter(i,a):(B(t,function(x,T,S){i.call(a,x,T,S)&&(o[o.length]=x)}),o)},s.reject=function(t,i,a){return s.filter(t,function(o,x,T){return!i.call(a,o,x,T)},a)},s.every=s.all=function(t,i,a){i||(i=s.identity);var o=!0;return t==null?o:W&&t.every===W?t.every(i,a):(B(t,function(x,T,S){if(!(o=o&&i.call(a,x,T,S)))return l}),!!o)};var X=s.some=s.any=function(t,i,a){i||(i=s.identity);var o=!1;return t==null?o:$&&t.some===$?t.some(i,a):(B(t,function(x,T,S){if(o||(o=i.call(a,x,T,S)))return l}),!!o)};s.contains=s.include=function(t,i){return t==null?!1:ce&&t.indexOf===ce?t.indexOf(i)!=-1:X(t,function(a){return a===i})},s.invoke=function(t,i){var a=_.call(arguments,2),o=s.isFunction(i);return s.map(t,function(x){return(o?i:x[i]).apply(x,a)})},s.pluck=function(t,i){return s.map(t,function(a){return a[i]})},s.where=function(t,i,a){return s.isEmpty(i)?a?null:[]:s[a?"find":"filter"](t,function(o){for(var x in i)if(i[x]!==o[x])return!1;return!0})},s.findWhere=function(t,i){return s.where(t,i,!0)},s.max=function(t,i,a){if(!i&&s.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!i&&s.isEmpty(t))return-1/0;var o={computed:-1/0,value:-1/0};return B(t,function(x,T,S){var L=i?i.call(a,x,T,S):x;L>=o.computed&&(o={value:x,computed:L})}),o.value},s.min=function(t,i,a){if(!i&&s.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!i&&s.isEmpty(t))return 1/0;var o={computed:1/0,value:1/0};return B(t,function(x,T,S){var L=i?i.call(a,x,T,S):x;L<o.computed&&(o={value:x,computed:L})}),o.value},s.shuffle=function(t){var i,a=0,o=[];return B(t,function(x){i=s.random(a++),o[a-1]=o[i],o[i]=x}),o};var j=function(t){return s.isFunction(t)?t:function(i){return i[t]}};s.sortBy=function(t,i,a){var o=j(i);return s.pluck(s.map(t,function(x,T,S){return{value:x,index:T,criteria:o.call(a,x,T,S)}}).sort(function(x,T){var S=x.criteria,L=T.criteria;if(S!==L){if(S>L||S===void 0)return 1;if(S<L||L===void 0)return-1}return x.index<T.index?-1:1}),"value")};var A=function(t,i,a,o){var x={},T=j(i||s.identity);return B(t,function(S,L){var z=T.call(a,S,L,t);o(x,z,S)}),x};s.groupBy=function(t,i,a){return A(t,i,a,function(o,x,T){(s.has(o,x)?o[x]:o[x]=[]).push(T)})},s.countBy=function(t,i,a){return A(t,i,a,function(o,x){s.has(o,x)||(o[x]=0),o[x]++})},s.sortedIndex=function(t,i,a,o){a=a==null?s.identity:j(a);for(var x=a.call(o,i),T=0,S=t.length;T<S;){var L=T+S>>>1;a.call(o,t[L])<x?T=L+1:S=L}return T},s.toArray=function(t){return t?s.isArray(t)?_.call(t):t.length===+t.length?s.map(t,s.identity):s.values(t):[]},s.size=function(t){return t==null?0:t.length===+t.length?t.length:s.keys(t).length},s.first=s.head=s.take=function(t,i,a){if(t!=null)return i!=null&&!a?_.call(t,0,i):t[0]},s.initial=function(t,i,a){return _.call(t,0,t.length-(i==null||a?1:i))},s.last=function(t,i,a){if(t!=null)return i!=null&&!a?_.call(t,Math.max(t.length-i,0)):t[t.length-1]},s.rest=s.tail=s.drop=function(t,i,a){return _.call(t,i==null||a?1:i)},s.compact=function(t){return s.filter(t,s.identity)};var V=function(t,i,a){return B(t,function(o){s.isArray(o)?i?k.apply(a,o):V(o,i,a):a.push(o)}),a};s.flatten=function(t,i){return V(t,i,[])},s.without=function(t){return s.difference(t,_.call(arguments,1))},s.uniq=s.unique=function(t,i,a,o){s.isFunction(i)&&(o=a,a=i,i=!1);var x=a?s.map(t,a,o):t,T=[],S=[];return B(x,function(L,z){(i?!z||S[S.length-1]!==L:!s.contains(S,L))&&(S.push(L),T.push(t[z]))}),T},s.union=function(){return s.uniq(v.apply(h,arguments))},s.intersection=function(t){var i=_.call(arguments,1);return s.filter(s.uniq(t),function(a){return s.every(i,function(o){return s.indexOf(o,a)>=0})})},s.difference=function(t){var i=v.apply(h,_.call(arguments,1));return s.filter(t,function(a){return!s.contains(i,a)})},s.zip=function(){for(var t=_.call(arguments),i=s.max(s.pluck(t,"length")),a=new Array(i),o=0;o<i;o++)a[o]=s.pluck(t,""+o);return a},s.object=function(t,i){if(t==null)return{};for(var a={},o=0,x=t.length;o<x;o++)i?a[t[o]]=i[o]:a[t[o][0]]=t[o][1];return a},s.indexOf=function(t,i,a){if(t==null)return-1;var o=0,x=t.length;if(a)if(typeof a=="number")o=a<0?Math.max(0,x+a):a;else return o=s.sortedIndex(t,i),t[o]===i?o:-1;if(ce&&t.indexOf===ce)return t.indexOf(i,a);for(;o<x;o++)if(t[o]===i)return o;return-1},s.lastIndexOf=function(t,i,a){if(t==null)return-1;var o=a!=null;if(ve&&t.lastIndexOf===ve)return o?t.lastIndexOf(i,a):t.lastIndexOf(i);for(var x=o?a:t.length;x--;)if(t[x]===i)return x;return-1},s.range=function(t,i,a){arguments.length<=1&&(i=t||0,t=0),a=arguments[2]||1;for(var o=Math.max(Math.ceil((i-t)/a),0),x=0,T=new Array(o);x<o;)T[x++]=t,t+=a;return T},s.bind=function(t,i){if(t.bind===se&&se)return se.apply(t,_.call(arguments,1));var a=_.call(arguments,2);return function(){return t.apply(i,a.concat(_.call(arguments)))}},s.partial=function(t){var i=_.call(arguments,1);return function(){return t.apply(this,i.concat(_.call(arguments)))}},s.bindAll=function(t){var i=_.call(arguments,1);return i.length===0&&(i=s.functions(t)),B(i,function(a){t[a]=s.bind(t[a],t)}),t},s.memoize=function(t,i){var a={};return i||(i=s.identity),function(){var o=i.apply(this,arguments);return s.has(a,o)?a[o]:a[o]=t.apply(this,arguments)}},s.delay=function(t,i){var a=_.call(arguments,2);return setTimeout(function(){return t.apply(null,a)},i)},s.defer=function(t){return s.delay.apply(s,[t,1].concat(_.call(arguments,1)))},s.throttle=function(t,i){var a,o,x,T,S=0,L=function(){S=new Date,x=null,T=t.apply(a,o)};return function(){var z=new Date,ee=i-(z-S);return a=this,o=arguments,ee<=0?(clearTimeout(x),x=null,S=z,T=t.apply(a,o)):x||(x=setTimeout(L,ee)),T}},s.debounce=function(t,i,a){var o,x;return function(){var T=this,S=arguments,L=function(){o=null,a||(x=t.apply(T,S))},z=a&&!o;return clearTimeout(o),o=setTimeout(L,i),z&&(x=t.apply(T,S)),x}},s.once=function(t){var i=!1,a;return function(){return i||(i=!0,a=t.apply(this,arguments),t=null),a}},s.wrap=function(t,i){return function(){var a=[t];return k.apply(a,arguments),i.apply(this,a)}},s.compose=function(){var t=arguments;return function(){for(var i=arguments,a=t.length-1;a>=0;a--)i=[t[a].apply(this,i)];return i[0]}},s.after=function(t,i){return t<=0?i():function(){if(--t<1)return i.apply(this,arguments)}},s.keys=Q||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var i=[];for(var a in t)s.has(t,a)&&(i[i.length]=a);return i},s.values=function(t){var i=[];for(var a in t)s.has(t,a)&&i.push(t[a]);return i},s.pairs=function(t){var i=[];for(var a in t)s.has(t,a)&&i.push([a,t[a]]);return i},s.invert=function(t){var i={};for(var a in t)s.has(t,a)&&(i[t[a]]=a);return i},s.functions=s.methods=function(t){var i=[];for(var a in t)s.isFunction(t[a])&&i.push(a);return i.sort()},s.extend=function(t){return B(_.call(arguments,1),function(i){if(i)for(var a in i)t[a]=i[a]}),t},s.pick=function(t){var i={},a=v.apply(h,_.call(arguments,1));return B(a,function(o){o in t&&(i[o]=t[o])}),i},s.omit=function(t){var i={},a=v.apply(h,_.call(arguments,1));for(var o in t)s.contains(a,o)||(i[o]=t[o]);return i},s.defaults=function(t){return B(_.call(arguments,1),function(i){if(i)for(var a in i)t[a]==null&&(t[a]=i[a])}),t},s.clone=function(t){return s.isObject(t)?s.isArray(t)?t.slice():s.extend({},t):t},s.tap=function(t,i){return i(t),t};var I=function(t,i,a,o){if(t===i)return t!==0||1/t==1/i;if(t==null||i==null)return t===i;t instanceof s&&(t=t._wrapped),i instanceof s&&(i=i._wrapped);var x=p.call(t);if(x!=p.call(i))return!1;switch(x){case"[object String]":return t==String(i);case"[object Number]":return t!=+t?i!=+i:t==0?1/t==1/i:t==+i;case"[object Date]":case"[object Boolean]":return+t==+i;case"[object RegExp]":return t.source==i.source&&t.global==i.global&&t.multiline==i.multiline&&t.ignoreCase==i.ignoreCase}if(typeof t!="object"||typeof i!="object")return!1;for(var T=a.length;T--;)if(a[T]==t)return o[T]==i;a.push(t),o.push(i);var S=0,L=!0;if(x=="[object Array]"){if(S=t.length,L=S==i.length,L)for(;S--&&(L=I(t[S],i[S],a,o)););}else{var z=t.constructor,ee=i.constructor;if(z!==ee&&!(s.isFunction(z)&&z instanceof z&&s.isFunction(ee)&&ee instanceof ee))return!1;for(var K in t)if(s.has(t,K)&&(S++,!(L=s.has(i,K)&&I(t[K],i[K],a,o))))break;if(L){for(K in i)if(s.has(i,K)&&!S--)break;L=!S}}return a.pop(),o.pop(),L};s.isEqual=function(t,i){return I(t,i,[],[])},s.isEmpty=function(t){if(t==null)return!0;if(s.isArray(t)||s.isString(t))return t.length===0;for(var i in t)if(s.has(t,i))return!1;return!0},s.isElement=function(t){return!!(t&&t.nodeType===1)},s.isArray=Z||function(t){return p.call(t)=="[object Array]"},s.isObject=function(t){return t===Object(t)},B(["Arguments","Function","String","Number","Date","RegExp"],function(t){s["is"+t]=function(i){return p.call(i)=="[object "+t+"]"}}),s.isArguments(arguments)||(s.isArguments=function(t){return!!(t&&s.has(t,"callee"))}),typeof/./!="function"&&(s.isFunction=function(t){return typeof t=="function"}),s.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},s.isNaN=function(t){return s.isNumber(t)&&t!=+t},s.isBoolean=function(t){return t===!0||t===!1||p.call(t)=="[object Boolean]"},s.isNull=function(t){return t===null},s.isUndefined=function(t){return t===void 0},s.has=function(t,i){return d.call(t,i)},s.noConflict=function(){return r._=c,this},s.identity=function(t){return t},s.times=function(t,i,a){for(var o=Array(t),x=0;x<t;x++)o[x]=i.call(a,x);return o},s.random=function(t,i){return i==null&&(i=t,t=0),t+Math.floor(Math.random()*(i-t+1))};var D={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};D.unescape=s.invert(D.escape);var C={escape:new RegExp("["+s.keys(D.escape).join("")+"]","g"),unescape:new RegExp("("+s.keys(D.unescape).join("|")+")","g")};s.each(["escape","unescape"],function(t){s[t]=function(i){return i==null?"":(""+i).replace(C[t],function(a){return D[t][a]})}}),s.result=function(t,i){if(t==null)return null;var a=t[i];return s.isFunction(a)?a.call(t):a},s.mixin=function(t){B(s.functions(t),function(i){var a=s[i]=t[i];s.prototype[i]=function(){var o=[this._wrapped];return k.apply(o,arguments),Me.call(this,a.apply(s,o))}})};var F=0;s.uniqueId=function(t){var i=++F+"";return t?t+i:i},s.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var ae=/(.)^/,G={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},oe=/\\|'|\r|\n|\t|\u2028|\u2029/g;s.template=function(t,i,a){var o;a=s.defaults({},a,s.templateSettings);var x=new RegExp([(a.escape||ae).source,(a.interpolate||ae).source,(a.evaluate||ae).source].join("|")+"|$","g"),T=0,S="__p+='";t.replace(x,function(z,ee,K,me,fe){return S+=t.slice(T,fe).replace(oe,function(xe){return"\\"+G[xe]}),ee&&(S+=`'+
((__t=(`+ee+`))==null?'':_.escape(__t))+
'`),K&&(S+=`'+
((__t=(`+K+`))==null?'':__t)+
'`),me&&(S+=`';
`+me+`
__p+='`),T=fe+z.length,z}),S+=`';
`,a.variable||(S=`with(obj||{}){
`+S+`}
`),S=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+S+`return __p;
`;try{o=new Function(a.variable||"obj","_",S)}catch(z){throw z.source=S,z}if(i)return o(i,s);var L=function(z){return o.call(this,z,s)};return L.source="function("+(a.variable||"obj")+`){
`+S+"}",L},s.chain=function(t){return s(t).chain()};var Me=function(t){return this._chain?s(t).chain():t};s.mixin(s),B(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var i=h[t];s.prototype[t]=function(){var a=this._wrapped;return i.apply(a,arguments),(t=="shift"||t=="splice")&&a.length===0&&delete a[0],Me.call(this,a)}}),B(["concat","join","slice"],function(t){var i=h[t];s.prototype[t]=function(){return Me.call(this,i.apply(this._wrapped,arguments))}}),s.extend(s.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(ze)})(Ne,Ne.exports);var Be=Ne.exports;const u=Le(Be);var Ze=function(){var e=function(_,v,p,d){for(p=p||{},d=_.length;d--;p[_[d]]=v);return p},n=[1,11],r=[1,9],c=[8,17],l=[6,11],h=[6,11,13,17],y={trace:function(){},yy:{},symbols_:{error:2,unitvalue:3,magnitude:4,unit:5,EOF:6,float:7,POW:8,int:9,multatoms:10,DIV:11,expatom:12,MUL:13,atom:14,"^":15,nat:16,ATOM:17,FLOAT:18,NAT:19,NEG:20,$accept:0,$end:1},terminals_:{2:"error",6:"EOF",8:"POW",11:"DIV",13:"MUL",15:"^",17:"ATOM",18:"FLOAT",19:"NAT",20:"NEG"},productions_:[0,[3,3],[3,2],[4,3],[4,1],[5,3],[5,1],[10,3],[10,2],[10,1],[12,3],[12,1],[14,1],[7,1],[7,1],[16,1],[9,2],[9,1]],performAction:function(v,p,d,f,E,w,R){var q=w.length-1;switch(E){case 1:return{type:"unitMagnitude",magnitude:w[q-2],unit:w[q-1]};case 2:return{type:"unitStandalone",unit:w[q-1]};case 3:this.$=w[q-2]+"e"+w[q];break;case 4:case 13:case 14:case 15:case 17:this.$=w[q];break;case 5:this.$={num:w[q-2],denom:w[q]};break;case 6:this.$={num:w[q],denom:null};break;case 7:this.$=[w[q-2]].concat(w[q]);break;case 8:this.$=[w[q-1]].concat(w[q]);break;case 9:this.$=[w[q]];break;case 10:this.$={name:w[q-2],pow:w[q]};break;case 11:this.$={name:w[q],pow:1};break;case 12:this.$=v;break;case 16:this.$="-"+w[q];break}},table:[{3:1,4:2,5:3,7:4,10:5,12:8,14:10,16:7,17:n,18:[1,6],19:r},{1:[3]},{5:12,10:5,12:8,14:10,17:n},{6:[1,13]},{8:[1,14],17:[2,4]},{6:[2,6],11:[1,15]},e(c,[2,13]),e(c,[2,14]),e(l,[2,9],{12:8,14:10,10:17,13:[1,16],17:n}),e([6,8,11,13,17],[2,15]),e(h,[2,11],{15:[1,18]}),e([6,11,13,15,17],[2,12]),{6:[1,19]},{1:[2,2]},{9:20,19:[1,22],20:[1,21]},{10:23,12:8,14:10,17:n},{10:24,12:8,14:10,17:n},e(l,[2,8]),{16:25,19:r},{1:[2,1]},{17:[2,3]},{19:[1,26]},{17:[2,17]},{6:[2,5]},e(l,[2,7]),e(h,[2,10]),{17:[2,16]}],defaultActions:{13:[2,2],19:[2,1],20:[2,3],22:[2,17],23:[2,5],26:[2,16]},parseError:function(v,p){if(p.recoverable)this.trace(v);else throw new Error(v)},parse:function(v){var p=this,d=[0],f=[null],E=[],w=this.table,R="",q=0,W=0,$=2,ce=1,ve=E.slice.call(arguments,1),Z=Object.create(this.lexer),Q={yy:{}};for(var se in this.yy)Object.prototype.hasOwnProperty.call(this.yy,se)&&(Q.yy[se]=this.yy[se]);Z.setInput(v,Q.yy),Q.yy.lexer=Z,Q.yy.parser=this,typeof Z.yylloc>"u"&&(Z.yylloc={});var s=Z.yylloc;E.push(s);var B=Z.options&&Z.options.ranges;typeof Q.yy.parseError=="function"?this.parseError=Q.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function ye(){var oe;return oe=Z.lex()||ce,typeof oe!="number"&&(oe=p.symbols_[oe]||oe),oe}for(var X,j,A,V,I={},D,C,F,ae;;){if(j=d[d.length-1],this.defaultActions[j]?A=this.defaultActions[j]:((X===null||typeof X>"u")&&(X=ye()),A=w[j]&&w[j][X]),typeof A>"u"||!A.length||!A[0]){var G="";ae=[];for(D in w[j])this.terminals_[D]&&D>$&&ae.push("'"+this.terminals_[D]+"'");Z.showPosition?G="Parse error on line "+(q+1)+`:
`+Z.showPosition()+`
Expecting `+ae.join(", ")+", got '"+(this.terminals_[X]||X)+"'":G="Parse error on line "+(q+1)+": Unexpected "+(X==ce?"end of input":"'"+(this.terminals_[X]||X)+"'"),this.parseError(G,{text:Z.match,token:this.terminals_[X]||X,line:Z.yylineno,loc:s,expected:ae})}if(A[0]instanceof Array&&A.length>1)throw new Error("Parse Error: multiple actions possible at state: "+j+", token: "+X);switch(A[0]){case 1:d.push(X),f.push(Z.yytext),E.push(Z.yylloc),d.push(A[1]),X=null,W=Z.yyleng,R=Z.yytext,q=Z.yylineno,s=Z.yylloc;break;case 2:if(C=this.productions_[A[1]][1],I.$=f[f.length-C],I._$={first_line:E[E.length-(C||1)].first_line,last_line:E[E.length-1].last_line,first_column:E[E.length-(C||1)].first_column,last_column:E[E.length-1].last_column},B&&(I._$.range=[E[E.length-(C||1)].range[0],E[E.length-1].range[1]]),V=this.performAction.apply(I,[R,W,q,Q.yy,A[1],f,E].concat(ve)),typeof V<"u")return V;C&&(d=d.slice(0,-1*C*2),f=f.slice(0,-1*C),E=E.slice(0,-1*C)),d.push(this.productions_[A[1]][0]),f.push(I.$),E.push(I._$),F=w[d[d.length-2]][d[d.length-1]],d.push(F);break;case 3:return!0}}return!0}},M=function(){var _={EOF:1,parseError:function(p,d){if(this.yy.parser)this.yy.parser.parseError(p,d);else throw new Error(p)},setInput:function(v,p){return this.yy=p||this.yy||{},this._input=v,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var v=this._input[0];this.yytext+=v,this.yyleng++,this.offset++,this.match+=v,this.matched+=v;var p=v.match(/(?:\r\n?|\n).*/g);return p?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),v},unput:function(v){var p=v.length,d=v.split(/(?:\r\n?|\n)/g);this._input=v+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-p),this.offset-=p;var f=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),d.length-1&&(this.yylineno-=d.length-1);var E=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:d?(d.length===f.length?this.yylloc.first_column:0)+f[f.length-d.length].length-d[0].length:this.yylloc.first_column-p},this.options.ranges&&(this.yylloc.range=[E[0],E[0]+this.yyleng-p]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(v){this.unput(this.match.slice(v))},pastInput:function(){var v=this.matched.substr(0,this.matched.length-this.match.length);return(v.length>20?"...":"")+v.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var v=this.match;return v.length<20&&(v+=this._input.substr(0,20-v.length)),(v.substr(0,20)+(v.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var v=this.pastInput(),p=new Array(v.length+1).join("-");return v+this.upcomingInput()+`
`+p+"^"},test_match:function(v,p){var d,f,E;if(this.options.backtrack_lexer&&(E={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(E.yylloc.range=this.yylloc.range.slice(0))),f=v[0].match(/(?:\r\n?|\n).*/g),f&&(this.yylineno+=f.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:f?f[f.length-1].length-f[f.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+v[0].length},this.yytext+=v[0],this.match+=v[0],this.matches=v,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(v[0].length),this.matched+=v[0],d=this.performAction.call(this,this.yy,this,p,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),d)return d;if(this._backtrack){for(var w in E)this[w]=E[w];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var v,p,d,f;this._more||(this.yytext="",this.match="");for(var E=this._currentRules(),w=0;w<E.length;w++)if(d=this._input.match(this.rules[E[w]]),d&&(!p||d[0].length>p[0].length)){if(p=d,f=w,this.options.backtrack_lexer){if(v=this.test_match(d,E[w]),v!==!1)return v;if(this._backtrack){p=!1;continue}else return!1}else if(!this.options.flex)break}return p?(v=this.test_match(p,E[f]),v!==!1?v:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var p=this.next();return p||this.lex()},begin:function(p){this.conditionStack.push(p)},popState:function(){var p=this.conditionStack.length-1;return p>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(p){return p=this.conditionStack.length-1-Math.abs(p||0),p>=0?this.conditionStack[p]:"INITIAL"},pushState:function(p){this.begin(p)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(p,d,f,E){switch(f){case 0:return 11;case 1:return"(";case 2:return")";case 3:return 8;case 4:return 15;case 5:return 13;case 6:return 18;case 7:return 19;case 8:return 20;case 9:return 17;case 10:return 17;case 11:return 17;case 12:break;case 13:return 6}},rules:[/^(?:\/)/,/^(?:\()/,/^(?:\))/,/^(?:(\*|x|\u00d7|\u2219|\u22c5|\u00b7)\s*10\s*\^)/,/^(?:\^)/,/^(?:\*)/,/^(?:[0-9]+\.[0-9]+)/,/^(?:[0-9]+)/,/^(?:-)/,/^(?:\u00b0( ?)[cCfF])/,/^(?:fl\.? oz\.?)/,/^(?:[\u00b5]?([A-Za-z-]+|[\u2103\u2109\u212b]))/,/^(?:\s+)/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};return _}();y.lexer=M;function k(){this.yy={}}return k.prototype=y,y.Parser=k,new k}();const Ye=Ze;var _e=function(){var e=function(j,A,V,I){for(V=V||{},I=j.length;I--;V[j[I]]=A);return V},n=[1,7],r=[1,17],c=[1,13],l=[1,14],h=[1,15],y=[1,32],M=[1,22],k=[1,23],_=[1,24],v=[1,25],p=[1,26],d=[1,33],f=[1,27],E=[1,28],w=[1,29],R=[1,30],q=[1,20],W=[1,36],$=[1,37],ce=[5,6,8,10,33,35,41,43,45],ve=[1,39],Z=[1,40],Q=[5,6,8,10,12,14,16,19,21,22,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],se=[10,16,19,21,22,28,29,30,31,32,34,37,39,42,43,44,46],s=[5,6,8,10,12,14,16,18,19,21,22,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],B={trace:function(){},yy:{},symbols_:{error:2,equation:3,expression:4,SIGN:5,EOF:6,additive:7,"+":8,multiplicative:9,"-":10,triglog:11,"*":12,negative:13,"/":14,trig:15,TRIG:16,trigfunc:17,"^":18,TRIGINV:19,logbase:20,ln:21,log:22,_:23,subscriptable:24,power:25,primitive:26,variable:27,VAR:28,CONST:29,INT:30,FLOAT:31,"{":32,"}":33,"(":34,")":35,function:36,FUNC:37,invocation:38,sqrt:39,"[":40,"]":41,abs:42,"|":43,"LEFT|":44,"RIGHT|":45,FRAC:46,$accept:0,$end:1},terminals_:{2:"error",5:"SIGN",6:"EOF",8:"+",10:"-",12:"*",14:"/",16:"TRIG",18:"^",19:"TRIGINV",21:"ln",22:"log",23:"_",28:"VAR",29:"CONST",30:"INT",31:"FLOAT",32:"{",33:"}",34:"(",35:")",37:"FUNC",39:"sqrt",40:"[",41:"]",42:"abs",43:"|",44:"LEFT|",45:"RIGHT|",46:"FRAC"},productions_:[0,[3,4],[3,2],[3,1],[4,1],[7,3],[7,3],[7,1],[9,2],[9,3],[9,3],[9,1],[13,2],[13,1],[15,1],[17,1],[17,3],[17,1],[20,1],[20,1],[20,3],[11,2],[11,2],[11,1],[25,3],[25,1],[27,1],[24,3],[24,1],[24,1],[24,1],[24,1],[24,3],[24,3],[36,1],[38,4],[38,4],[38,7],[38,4],[38,3],[38,3],[38,4],[26,1],[26,1],[26,7]],performAction:function(A,V,I,D,C,F,ae){var G=F.length-1;switch(C){case 1:return new D.Eq(F[G-3],F[G-2],F[G-1]);case 2:return F[G-1];case 3:return new D.Add([]);case 4:case 7:case 11:case 13:case 15:case 20:case 23:case 25:case 42:case 43:this.$=F[G];break;case 5:this.$=D.Add.createOrAppend(F[G-2],F[G]);break;case 6:this.$=D.Add.createOrAppend(F[G-2],D.Mul.handleNegative(F[G],"subtract"));break;case 8:this.$=D.Mul.fold(D.Mul.createOrAppend(F[G-1],F[G]));break;case 9:this.$=D.Mul.fold(D.Mul.createOrAppend(F[G-2],F[G]));break;case 10:this.$=D.Mul.fold(D.Mul.handleDivide(F[G-2],F[G]));break;case 12:this.$=D.Mul.handleNegative(F[G]);break;case 14:case 17:this.$=[A];break;case 16:this.$=F[G-2].concat(F[G]);break;case 18:this.$=D.Log.natural();break;case 19:this.$=D.Log.common();break;case 21:this.$=D.Trig.create(F[G-1],F[G]);break;case 22:this.$=D.Log.create(F[G-1],F[G]);break;case 24:this.$=new D.Pow(F[G-2],F[G]);break;case 26:case 34:this.$=A;break;case 27:this.$=new D.Var(F[G-2],F[G]);break;case 28:this.$=new D.Var(F[G]);break;case 29:this.$=new D.Const(A.toLowerCase());break;case 30:this.$=D.Int.create(Number(A));break;case 31:this.$=D.Float.create(Number(A));break;case 32:this.$=F[G-1].completeParse();break;case 33:this.$=F[G-1].completeParse().addHint("parens");break;case 35:case 36:this.$=D.Pow.sqrt(F[G-1]);break;case 37:this.$=new D.Pow.nthroot(F[G-1],F[G-4]);break;case 38:case 39:case 40:this.$=new D.Abs(F[G-1]);break;case 41:this.$=new D.Func(F[G-3],F[G-1]);break;case 44:this.$=D.Mul.handleDivide(F[G-4],F[G-1]);break}},table:[{3:1,4:2,6:[1,3],7:4,9:5,10:n,11:8,13:6,15:12,16:r,17:9,19:c,20:10,21:l,22:h,24:18,25:11,26:16,27:21,28:y,29:M,30:k,31:_,32:v,34:p,36:31,37:d,38:19,39:f,42:E,43:w,44:R,46:q},{1:[3]},{5:[1,34],6:[1,35]},{1:[2,3]},e([5,6],[2,4],{8:W,10:$}),e(ce,[2,7],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:ve,14:Z,16:r,19:c,21:l,22:h,28:y,29:M,30:k,31:_,32:v,34:p,37:d,39:f,42:E,44:R,46:q}),e(Q,[2,11]),{10:n,11:8,13:41,15:12,16:r,17:9,19:c,20:10,21:l,22:h,24:18,25:11,26:16,27:21,28:y,29:M,30:k,31:_,32:v,34:p,36:31,37:d,38:19,39:f,42:E,43:w,44:R,46:q},e(Q,[2,13]),{10:n,11:8,13:42,15:12,16:r,17:9,19:c,20:10,21:l,22:h,24:18,25:11,26:16,27:21,28:y,29:M,30:k,31:_,32:v,34:p,36:31,37:d,38:19,39:f,42:E,43:w,44:R,46:q},{10:n,11:8,13:43,15:12,16:r,17:9,19:c,20:10,21:l,22:h,24:18,25:11,26:16,27:21,28:y,29:M,30:k,31:_,32:v,34:p,36:31,37:d,38:19,39:f,42:E,43:w,44:R,46:q},e(Q,[2,23]),e(se,[2,15],{18:[1,44]}),e(se,[2,17]),e(se,[2,18]),e(se,[2,19],{23:[1,45]}),e(Q,[2,25],{18:[1,46]}),e([10,16,18,19,21,22,28,29,30,31,32,34,37,39,42,43,44,46],[2,14]),e(s,[2,42]),e(s,[2,43]),{32:[1,47]},e(s,[2,28],{23:[1,48]}),e(s,[2,29]),e(s,[2,30]),e(s,[2,31]),{7:49,9:5,10:n,11:8,13:6,15:12,16:r,17:9,19:c,20:10,21:l,22:h,24:18,25:11,26:16,27:21,28:y,29:M,30:k,31:_,32:v,34:p,36:31,37:d,38:19,39:f,42:E,43:w,44:R,46:q},{7:50,9:5,10:n,11:8,13:6,15:12,16:r,17:9,19:c,20:10,21:l,22:h,24:18,25:11,26:16,27:21,28:y,29:M,30:k,31:_,32:v,34:p,36:31,37:d,38:19,39:f,42:E,43:w,44:R,46:q},{32:[1,52],34:[1,51],40:[1,53]},{34:[1,54]},{7:55,9:5,10:n,11:8,13:6,15:12,16:r,17:9,19:c,20:10,21:l,22:h,24:18,25:11,26:16,27:21,28:y,29:M,30:k,31:_,32:v,34:p,36:31,37:d,38:19,39:f,42:E,43:w,44:R,46:q},{7:56,9:5,10:n,11:8,13:6,15:12,16:r,17:9,19:c,20:10,21:l,22:h,24:18,25:11,26:16,27:21,28:y,29:M,30:k,31:_,32:v,34:p,36:31,37:d,38:19,39:f,42:E,43:w,44:R,46:q},{34:[1,57]},e([5,6,8,10,12,14,16,18,19,21,22,23,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],[2,26]),{34:[2,34]},{4:58,7:4,9:5,10:n,11:8,13:6,15:12,16:r,17:9,19:c,20:10,21:l,22:h,24:18,25:11,26:16,27:21,28:y,29:M,30:k,31:_,32:v,34:p,36:31,37:d,38:19,39:f,42:E,43:w,44:R,46:q},{1:[2,2]},{9:59,10:n,11:8,13:6,15:12,16:r,17:9,19:c,20:10,21:l,22:h,24:18,25:11,26:16,27:21,28:y,29:M,30:k,31:_,32:v,34:p,36:31,37:d,38:19,39:f,42:E,43:w,44:R,46:q},{9:60,10:n,11:8,13:6,15:12,16:r,17:9,19:c,20:10,21:l,22:h,24:18,25:11,26:16,27:21,28:y,29:M,30:k,31:_,32:v,34:p,36:31,37:d,38:19,39:f,42:E,43:w,44:R,46:q},e(Q,[2,8]),{10:n,11:8,13:61,15:12,16:r,17:9,19:c,20:10,21:l,22:h,24:18,25:11,26:16,27:21,28:y,29:M,30:k,31:_,32:v,34:p,36:31,37:d,38:19,39:f,42:E,43:w,44:R,46:q},{10:n,11:8,13:62,15:12,16:r,17:9,19:c,20:10,21:l,22:h,24:18,25:11,26:16,27:21,28:y,29:M,30:k,31:_,32:v,34:p,36:31,37:d,38:19,39:f,42:E,43:w,44:R,46:q},e(Q,[2,12]),e(Q,[2,21]),e(Q,[2,22]),{10:n,11:8,13:63,15:12,16:r,17:9,19:c,20:10,21:l,22:h,24:18,25:11,26:16,27:21,28:y,29:M,30:k,31:_,32:v,34:p,36:31,37:d,38:19,39:f,42:E,43:w,44:R,46:q},{24:64,27:21,28:y,29:M,30:k,31:_,32:v,34:p},{10:n,11:8,13:65,15:12,16:r,17:9,19:c,20:10,21:l,22:h,24:18,25:11,26:16,27:21,28:y,29:M,30:k,31:_,32:v,34:p,36:31,37:d,38:19,39:f,42:E,43:w,44:R,46:q},{7:66,9:5,10:n,11:8,13:6,15:12,16:r,17:9,19:c,20:10,21:l,22:h,24:18,25:11,26:16,27:21,28:y,29:M,30:k,31:_,32:v,34:p,36:31,37:d,38:19,39:f,42:E,43:w,44:R,46:q},{24:67,27:21,28:y,29:M,30:k,31:_,32:v,34:p},{8:W,10:$,33:[1,68]},{8:W,10:$,35:[1,69]},{7:70,9:5,10:n,11:8,13:6,15:12,16:r,17:9,19:c,20:10,21:l,22:h,24:18,25:11,26:16,27:21,28:y,29:M,30:k,31:_,32:v,34:p,36:31,37:d,38:19,39:f,42:E,43:w,44:R,46:q},{7:71,9:5,10:n,11:8,13:6,15:12,16:r,17:9,19:c,20:10,21:l,22:h,24:18,25:11,26:16,27:21,28:y,29:M,30:k,31:_,32:v,34:p,36:31,37:d,38:19,39:f,42:E,43:w,44:R,46:q},{7:72,9:5,10:n,11:8,13:6,15:12,16:r,17:9,19:c,20:10,21:l,22:h,24:18,25:11,26:16,27:21,28:y,29:M,30:k,31:_,32:v,34:p,36:31,37:d,38:19,39:f,42:E,43:w,44:R,46:q},{7:73,9:5,10:n,11:8,13:6,15:12,16:r,17:9,19:c,20:10,21:l,22:h,24:18,25:11,26:16,27:21,28:y,29:M,30:k,31:_,32:v,34:p,36:31,37:d,38:19,39:f,42:E,43:w,44:R,46:q},{8:W,10:$,43:[1,74]},{8:W,10:$,45:[1,75]},{7:76,9:5,10:n,11:8,13:6,15:12,16:r,17:9,19:c,20:10,21:l,22:h,24:18,25:11,26:16,27:21,28:y,29:M,30:k,31:_,32:v,34:p,36:31,37:d,38:19,39:f,42:E,43:w,44:R,46:q},{6:[1,77]},e(ce,[2,5],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:ve,14:Z,16:r,19:c,21:l,22:h,28:y,29:M,30:k,31:_,32:v,34:p,37:d,39:f,42:E,44:R,46:q}),e(ce,[2,6],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:ve,14:Z,16:r,19:c,21:l,22:h,28:y,29:M,30:k,31:_,32:v,34:p,37:d,39:f,42:E,44:R,46:q}),e(Q,[2,9]),e(Q,[2,10]),e(se,[2,16]),e(se,[2,20]),e(Q,[2,24]),{8:W,10:$,33:[1,78]},e(s,[2,27]),e(s,[2,32]),e(s,[2,33]),{8:W,10:$,35:[1,79]},{8:W,10:$,33:[1,80]},{8:W,10:$,41:[1,81]},{8:W,10:$,35:[1,82]},e(s,[2,39]),e(s,[2,40]),{8:W,10:$,35:[1,83]},{1:[2,1]},{32:[1,84]},e(s,[2,35]),e(s,[2,36]),{32:[1,85]},e(s,[2,38]),e(s,[2,41]),{7:86,9:5,10:n,11:8,13:6,15:12,16:r,17:9,19:c,20:10,21:l,22:h,24:18,25:11,26:16,27:21,28:y,29:M,30:k,31:_,32:v,34:p,36:31,37:d,38:19,39:f,42:E,43:w,44:R,46:q},{7:87,9:5,10:n,11:8,13:6,15:12,16:r,17:9,19:c,20:10,21:l,22:h,24:18,25:11,26:16,27:21,28:y,29:M,30:k,31:_,32:v,34:p,36:31,37:d,38:19,39:f,42:E,43:w,44:R,46:q},{8:W,10:$,33:[1,88]},{8:W,10:$,33:[1,89]},e(s,[2,44]),e(s,[2,37])],defaultActions:{3:[2,3],33:[2,34],35:[2,2],77:[2,1]},parseError:function(A,V){if(V.recoverable)this.trace(A);else throw new Error(A)},parse:function(A){var V=this,I=[0],D=[null],C=[],F=this.table,ae="",G=0,oe=0,Me=2,t=1,i=C.slice.call(arguments,1),a=Object.create(this.lexer),o={yy:{}};for(var x in this.yy)Object.prototype.hasOwnProperty.call(this.yy,x)&&(o.yy[x]=this.yy[x]);a.setInput(A,o.yy),o.yy.lexer=a,o.yy.parser=this,typeof a.yylloc>"u"&&(a.yylloc={});var T=a.yylloc;C.push(T);var S=a.options&&a.options.ranges;typeof o.yy.parseError=="function"?this.parseError=o.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function L(){var we;return we=a.lex()||t,typeof we!="number"&&(we=V.symbols_[we]||we),we}for(var z,ee,K,me,fe={},xe,he,Te,Ae;;){if(ee=I[I.length-1],this.defaultActions[ee]?K=this.defaultActions[ee]:((z===null||typeof z>"u")&&(z=L()),K=F[ee]&&F[ee][z]),typeof K>"u"||!K.length||!K[0]){var Oe="";Ae=[];for(xe in F[ee])this.terminals_[xe]&&xe>Me&&Ae.push("'"+this.terminals_[xe]+"'");a.showPosition?Oe="Parse error on line "+(G+1)+`:
`+a.showPosition()+`
Expecting `+Ae.join(", ")+", got '"+(this.terminals_[z]||z)+"'":Oe="Parse error on line "+(G+1)+": Unexpected "+(z==t?"end of input":"'"+(this.terminals_[z]||z)+"'"),this.parseError(Oe,{text:a.match,token:this.terminals_[z]||z,line:a.yylineno,loc:T,expected:Ae})}if(K[0]instanceof Array&&K.length>1)throw new Error("Parse Error: multiple actions possible at state: "+ee+", token: "+z);switch(K[0]){case 1:I.push(z),D.push(a.yytext),C.push(a.yylloc),I.push(K[1]),z=null,oe=a.yyleng,ae=a.yytext,G=a.yylineno,T=a.yylloc;break;case 2:if(he=this.productions_[K[1]][1],fe.$=D[D.length-he],fe._$={first_line:C[C.length-(he||1)].first_line,last_line:C[C.length-1].last_line,first_column:C[C.length-(he||1)].first_column,last_column:C[C.length-1].last_column},S&&(fe._$.range=[C[C.length-(he||1)].range[0],C[C.length-1].range[1]]),me=this.performAction.apply(fe,[ae,oe,G,o.yy,K[1],D,C].concat(i)),typeof me<"u")return me;he&&(I=I.slice(0,-1*he*2),D=D.slice(0,-1*he),C=C.slice(0,-1*he)),I.push(this.productions_[K[1]][0]),D.push(fe.$),C.push(fe._$),Te=F[I[I.length-2]][I[I.length-1]],I.push(Te);break;case 3:return!0}}return!0}},ye=function(){var j={EOF:1,parseError:function(V,I){if(this.yy.parser)this.yy.parser.parseError(V,I);else throw new Error(V)},setInput:function(A,V){return this.yy=V||this.yy||{},this._input=A,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var A=this._input[0];this.yytext+=A,this.yyleng++,this.offset++,this.match+=A,this.matched+=A;var V=A.match(/(?:\r\n?|\n).*/g);return V?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),A},unput:function(A){var V=A.length,I=A.split(/(?:\r\n?|\n)/g);this._input=A+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-V),this.offset-=V;var D=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),I.length-1&&(this.yylineno-=I.length-1);var C=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:I?(I.length===D.length?this.yylloc.first_column:0)+D[D.length-I.length].length-I[0].length:this.yylloc.first_column-V},this.options.ranges&&(this.yylloc.range=[C[0],C[0]+this.yyleng-V]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(A){this.unput(this.match.slice(A))},pastInput:function(){var A=this.matched.substr(0,this.matched.length-this.match.length);return(A.length>20?"...":"")+A.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var A=this.match;return A.length<20&&(A+=this._input.substr(0,20-A.length)),(A.substr(0,20)+(A.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var A=this.pastInput(),V=new Array(A.length+1).join("-");return A+this.upcomingInput()+`
`+V+"^"},test_match:function(A,V){var I,D,C;if(this.options.backtrack_lexer&&(C={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(C.yylloc.range=this.yylloc.range.slice(0))),D=A[0].match(/(?:\r\n?|\n).*/g),D&&(this.yylineno+=D.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:D?D[D.length-1].length-D[D.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+A[0].length},this.yytext+=A[0],this.match+=A[0],this.matches=A,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(A[0].length),this.matched+=A[0],I=this.performAction.call(this,this.yy,this,V,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),I)return I;if(this._backtrack){for(var F in C)this[F]=C[F];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var A,V,I,D;this._more||(this.yytext="",this.match="");for(var C=this._currentRules(),F=0;F<C.length;F++)if(I=this._input.match(this.rules[C[F]]),I&&(!V||I[0].length>V[0].length)){if(V=I,D=F,this.options.backtrack_lexer){if(A=this.test_match(I,C[F]),A!==!1)return A;if(this._backtrack){V=!1;continue}else return!1}else if(!this.options.flex)break}return V?(A=this.test_match(V,C[D]),A!==!1?A:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var V=this.next();return V||this.lex()},begin:function(V){this.conditionStack.push(V)},popState:function(){var V=this.conditionStack.length-1;return V>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(V){return V=this.conditionStack.length-1-Math.abs(V||0),V>=0?this.conditionStack[V]:"INITIAL"},pushState:function(V){this.begin(V)},stateStackSize:function(){return this.conditionStack.length},options:{flex:!0},performAction:function(V,I,D,C){switch(D){case 0:break;case 1:break;case 2:break;case 3:return"INT";case 4:return"FLOAT";case 5:return"^";case 6:return"*";case 7:return"*";case 8:return"*";case 9:return"*";case 10:return"/";case 11:return"/";case 12:return"-";case 13:return"-";case 14:return"+";case 15:return"^";case 16:return"(";case 17:return")";case 18:return"(";case 19:return")";case 20:return"[";case 21:return"]";case 22:return"{";case 23:return"}";case 24:return"{";case 25:return"}";case 26:return"_";case 27:return"|";case 28:return"LEFT|";case 29:return"RIGHT|";case 30:return"!";case 31:return"SIGN";case 32:return I.yytext="<=","SIGN";case 33:return I.yytext=">=","SIGN";case 34:return I.yytext="<=","SIGN";case 35:return I.yytext=">=","SIGN";case 36:return I.yytext="<>","SIGN";case 37:return I.yytext="<>","SIGN";case 38:return I.yytext="<>","SIGN";case 39:return I.yytext="<>","SIGN";case 40:return I.yytext="<=","SIGN";case 41:return I.yytext=">=","SIGN";case 42:return"FRAC";case 43:return"FRAC";case 44:return"sqrt";case 45:return"abs";case 46:return"ln";case 47:return"log";case 48:return"TRIG";case 49:return"TRIG";case 50:return"TRIG";case 51:return"TRIG";case 52:return I.yytext="sin","TRIG";case 53:return I.yytext="cos","TRIG";case 54:return I.yytext="tan","TRIG";case 55:return I.yytext="csc","TRIG";case 56:return I.yytext="sec","TRIG";case 57:return I.yytext="cot","TRIG";case 58:return I.yytext="arcsin","TRIG";case 59:return I.yytext="arccos","TRIG";case 60:return I.yytext="arctan","TRIG";case 61:return I.yytext="arccsc","TRIG";case 62:return I.yytext="arcsec","TRIG";case 63:return I.yytext="arccot","TRIG";case 64:return"TRIGINV";case 65:return"TRIGINV";case 66:return I.yytext="sinh","TRIG";case 67:return I.yytext="cosh","TRIG";case 68:return I.yytext="tanh","TRIG";case 69:return I.yytext="csch","TRIG";case 70:return I.yytext="sech","TRIG";case 71:return I.yytext="tanh","TRIG";case 72:return"CONST";case 73:return I.yytext="pi","CONST";case 74:return I.yytext="pi","CONST";case 75:return"VAR";case 76:return I.yytext="theta","VAR";case 77:return I.yytext="theta","VAR";case 78:return"VAR";case 79:return I.yytext="phi","VAR";case 80:return I.yytext="phi","VAR";case 81:return V.symbolLexer(I.yytext);case 82:return"EOF";case 83:return"INVALID";case 84:console.log(I.yytext);break}},rules:[/^(?:\s+)/,/^(?:\\space)/,/^(?:\\ )/,/^(?:[0-9]+\.?)/,/^(?:([0-9]+)?\.[0-9]+)/,/^(?:\*\*)/,/^(?:\*)/,/^(?:\\cdot|·)/,/^(?:\\times|×)/,/^(?:\\ast)/,/^(?:\/)/,/^(?:\\div|÷)/,/^(?:-)/,/^(?:−)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:\\left\()/,/^(?:\\right\))/,/^(?:\[)/,/^(?:\])/,/^(?:\{)/,/^(?:\})/,/^(?:\\left\{)/,/^(?:\\right\})/,/^(?:_)/,/^(?:\|)/,/^(?:\\left\|)/,/^(?:\\right\|)/,/^(?:\!)/,/^(?:<=|>=|<>|<|>|=)/,/^(?:\\le)/,/^(?:\\ge)/,/^(?:\\leq)/,/^(?:\\geq)/,/^(?:=\/=)/,/^(?:\\ne)/,/^(?:\\neq)/,/^(?:≠)/,/^(?:≤)/,/^(?:≥)/,/^(?:\\frac)/,/^(?:\\dfrac)/,/^(?:sqrt|\\sqrt)/,/^(?:abs|\\abs)/,/^(?:ln|\\ln)/,/^(?:log|\\log)/,/^(?:sin|cos|tan)/,/^(?:csc|sec|cot)/,/^(?:sinh|cosh|tanh)/,/^(?:csch|sech|coth)/,/^(?:\\sin)/,/^(?:\\cos)/,/^(?:\\tan)/,/^(?:\\csc)/,/^(?:\\sec)/,/^(?:\\cot)/,/^(?:\\arcsin)/,/^(?:\\arccos)/,/^(?:\\arctan)/,/^(?:\\arccsc)/,/^(?:\\arcsec)/,/^(?:\\arccot)/,/^(?:arcsin|arccos|arctan)/,/^(?:arccsc|arcsec|arccot)/,/^(?:\\sinh)/,/^(?:\\cosh)/,/^(?:\\tanh)/,/^(?:\\csch)/,/^(?:\\sech)/,/^(?:\\coth)/,/^(?:pi)/,/^(?:π)/,/^(?:\\pi)/,/^(?:theta)/,/^(?:θ)/,/^(?:\\theta)/,/^(?:phi)/,/^(?:φ)/,/^(?:\\phi)/,/^(?:[a-zA-Z])/,/^(?:$)/,/^(?:.)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84],inclusive:!0}}};return j}();B.lexer=ye;function X(){this.yy={}}return X.prototype=B,B.Parser=X,new X}(),ie=function(){throw new Error("Abstract method - must override for expr: "+this.print())},De=function(e){throw new Error(e)},Pe=function(e){return e!==e},Je=function(e,n){var r=n-e;return Math.random()*r+e},qe=12,Fe=9;function le(){}u.extend(le.prototype,{func:ie,args:ie,construct:function(e){var n=new this.func;return this.func.apply(n,e),n},recurse:function(e){var n=Array.prototype.slice.call(arguments,1),r=u.map(this.args(),function(c){return u.isString(c)?c:c[e].apply(c,n)});return this.construct(r)},eval:ie,codegen:ie,compile:function(){var e=this.codegen();try{return new Function("vars","return "+e+";")}catch{throw new Error("Function did not compile: "+e)}},print:ie,tex:ie,asTex:function(e){e=e||{},u.defaults(e,{display:!0,dynamic:!0,times:!1});var n=this.tex();return e.display&&(n="\\displaystyle "+n),e.dynamic&&(n=n.replace(/\(/g,"\\left("),n=n.replace(/\)/g,"\\right)")),e.times&&(n=n.replace(/\\cdot/g,"\\times")),n},name:function(){return this.func.name?this.func.name:this.func.toString().match(/^function\s*([^\s(]+)/)[1]},repr:function(){return this.name()+"("+u.map(this.args(),function(e){return u.isString(e)?e:e.repr()}).join(",")+")"},strip:function(){return this.recurse("strip")},normalize:function(){return this.recurse("normalize")},expand:function(){return this.recurse("expand")},factor:function(e){return this.recurse("factor",e)},collect:function(e){return this.recurse("collect",e)},equals:function(e){return this.normalize().print()===e.normalize().print()},simplify:function(e){e=u.extend({once:!1},e);var n=this.factor(e),r=n.collect(e);n.equals(r)&&(r=this.collect(e));var c=r.expand(e),l=c.collect(e);c.equals(l)&&(l=r.collect(e));var h=l;return e.once||this.equals(h)?h:h.simplify(e)},isSimplified:function(){return this.equals(this.simplify())},exprArgs:function(){return u.filter(this.args(),function(e){return e instanceof le})},getVars:function(e){return u.uniq(u.flatten(u.invoke(this.exprArgs(),"getVars",e))).sort()},getConsts:function(){return u.uniq(u.flatten(u.invoke(this.exprArgs(),"getConsts"))).sort()},getUnits:function(){return u.flatten(u.invoke(this.exprArgs(),"getUnits"))},is:function(e){return this instanceof e},has:function(e){return this instanceof e?!0:u.any(this.exprArgs(),function(n){return n.has(e)})},raiseToThe:function(e){return new P(this,e)},isSubtract:function(){return!1},isDivide:function(){return!1},isRoot:function(){return!1},needsExplicitMul:function(){return this.args()[0].needsExplicitMul()},sameVars:function(e){var n=this.getVars(),r=e.getVars(),c=function(M,k){return!u.difference(M,k).length},l=function(M){return u.uniq(u.invoke(M,"toLowerCase")).sort()},h=c(n,r),y=c(l(n),l(r));return{equal:h,equalIgnoringCase:y}},compare:function(e){if(e instanceof de)return!1;var n=u.union(this.getVars(!0),e.getVars(!0)),r=function(w,R){return Math.abs(w)<1||Math.abs(R)<1?Math.abs(w-R):Math.abs(1-w/R)},c=function(w,R){var q=r(w,R);return w===R||Pe(w)&&Pe(R)||q<Math.pow(10,-Fe)};if(!n.length&&!this.has(ne)&&!e.has(ne))return c(this.eval(),e.eval());var l=this.collect(),h=e.collect(),y=this.getUnits(),M=e.getUnits();if(!u.isEqual(y,M))return!1;for(var k=0;k<qe;k++){var _={},v=Math.pow(10,1+Math.floor(3*k/qe)),p=k%2===0;u.each(n,function(w){_[w]=p?Je(-v,v):u.random(-v,v)});var d;if(l.has(pe)||h.has(pe)||l.has(ne)||h.has(ne)){var f=l.partialEval(_),E=h.partialEval(_);d=f.simplify().equals(E.simplify())}else{var f=l.eval(_),E=h.eval(_);d=c(f,E)}if(!d)return!1}return!0},partialEval:function(e){return this instanceof ne?this:this.has(pe)?this instanceof pe?new pe(this.symbol,this.arg.partialEval(e)):this.recurse("partialEval",e):new te(this.eval(e).toFixed(Fe)).collect()},sameForm:function(e){return this.strip().equals(e.strip())},findGCD:function(e){return this.equals(e)?e:g.One},getDenominator:function(){return g.One},asMul:function(){return new m(g.One,this)},isPositive:ie,isNegative:function(){return!1},asPositiveFactor:function(){return this.isPositive()?this:g.One},addHint:function(e){if(!e)return this;var n=this.construct(this.args());return n.hints=u.clone(this.hints),n.hints[e]=!0,n},hints:{parens:!1},asExpr:function(){return this},completeParse:function(){return this.recurse("completeParse")},abs:ie,negate:function(){return new m(g.Neg,this)}});function ke(){}ke.prototype=new le;u.extend(ke.prototype,{args:function(){return this.terms},normalize:function(){var e=u.sortBy(u.invoke(this.terms,"normalize"),function(n){return n.print()});return new this.func(e)},expand:function(){return this.recurse("expand").flatten()},partition:function(){var e=u.groupBy(this.terms,function(c){return c instanceof g}),n=e[!0]||[],r=e[!1]||[];return[new this.func(n),new this.func(r)]},flatten:function(){var e=this,n=u.reject(this.terms,function(y){return y.equals(e.identity)});if(n.length===0)return e.identity;if(n.length===1)return n[0];var r=u.groupBy(n,function(y){return y instanceof e.func}),c=r[!0]||[],l=r[!1]||[],h=l.concat(u.flatten(u.pluck(c,"terms"),!0));return new e.func(h)},identity:void 0,reduce:ie,isPositive:function(){var e=u.invoke(this.terms,"collect");return u.all(u.invoke(e,"isPositive"))},replace:function(e,n){var r;e instanceof le?r=u.indexOf(this.terms,e):r=e;var c=[];u.isArray(n)?c=n:n&&(c=[n]);var l=this.terms.slice(0,r).concat(c).concat(this.terms.slice(r+1));return new this.func(l)},remove:function(e){return this.replace(e)},getDenominator:function(){return new m(u.invoke(this.terms,"getDenominator")).flatten()}});function J(){arguments.length===1?this.terms=arguments[0]:this.terms=u.toArray(arguments)}J.prototype=new ke;u.extend(J.prototype,{func:J,eval:function(e,n){return u.reduce(this.terms,function(r,c){return r+c.eval(e,n)},0)},codegen:function(){return u.map(this.terms,function(e){return"("+e.codegen()+")"}).join(" + ")||"0"},print:function(){return u.invoke(this.terms,"print").join("+")},tex:function(){var e="";return u.each(this.terms,function(n){!e||n.isSubtract()?e+=n.tex():e+="+"+n.tex()}),e},collect:function(e){var n=u.invoke(this.terms,"collect",e),r=[];u.each(n,function(h){if(h instanceof m){var y=h.partition();r.push([y[1].flatten(),y[0].reduce(e)])}else h instanceof g?r.push([g.One,h]):r.push([h,g.One])});var c=u.groupBy(r,function(h){return h[0].normalize().print()}),l=u.compact(u.map(c,function(h){var y=h[0][0],M=new J(u.zip.apply(u,h)[1]),k=M.reduce(e);return new m(k,y).collect(e)}));return new J(l).flatten()},factor:function(e){e=u.extend({keepNegative:!1},e);var n=u.invoke(this.terms,"collect"),r;n[0]instanceof m?r=n[0].terms:r=[n[0]],u.each(u.rest(this.terms),function(l){r=u.map(r,function(h){return l.findGCD(h)})}),!e.keepNegative&&this.isNegative()&&r.push(g.Neg),r=new m(r).flatten().collect();var c=u.map(n,function(l){return m.handleDivide(l,r).simplify()});return c=new J(c).flatten(),m.createOrAppend(r,c).flatten()},reduce:function(e){return u.reduce(this.terms,function(n,r){return n.add(r,e)},this.identity)},needsExplicitMul:function(){return!1},isNegative:function(){var e=u.invoke(this.terms,"collect");return u.all(u.invoke(e,"isNegative"))},negate:function(){return new J(u.invoke(this.terms,"negate"))}});function m(){arguments.length===1?this.terms=arguments[0]:this.terms=u.toArray(arguments)}m.prototype=new ke;u.extend(m.prototype,{func:m,eval:function(e,n){return u.reduce(this.terms,function(r,c){return r*c.eval(e,n)},1)},codegen:function(){return u.map(this.terms,function(e){return"("+e.codegen()+")"}).join(" * ")||"0"},print:function(){return u.map(this.terms,function(e){return e instanceof J?"("+e.print()+")":e.print()}).join("*")},getUnits:function(){var e=u(this.terms).chain().map(function(n){return n.getUnits()}).flatten().value();return e.sort((n,r)=>n.unit.localeCompare(r.unit)),e},tex:function(){for(var e=" \\cdot ",n=u.groupBy(this.terms,function(f){return f.isDivide()?"inverse":f instanceof g?"number":"other"}),r=n.inverse||[],c=n.number||[],l=n.other||[],h="",y,M=0;M<c.length;M++){var k=c[M]instanceof H&&!(c[M]instanceof N);if(k&&l.length>0&&r.length>0){var _=c.slice();_.splice(M,1);var v=_.concat(r).concat(l);return c[M].tex()+new m(v).tex()}}if(c=u.compact(u.map(c,function(f){var E=f instanceof H&&!(f instanceof N),w=!f.hints.fraction||r.length>0;if(E&&w){r.push(new P(new N(f.d),g.Div));var R=new N(f.n);return R.hints=f.hints,u.any(f.hints)?R:null}else return f})),c.length===0&&l.length===1)y=l[0].tex();else{var p="";u.each(c,function(f){f.hints.subtract&&f.hints.entered?(h+="-",p+=(p?e:"")+f.abs().tex()):f instanceof N&&f.n===-1&&(f.hints.negate||f.hints.subtract)?h+="-":p+=(p?e:"")+f.tex()}),u.each(l,function(f){f.needsExplicitMul()?p+=(p?e:"")+f.tex():f instanceof J?p+="("+f.tex()+")":p+=f.tex()}),y=p||"1"}if(r.length){var d=new m(u.invoke(r,"asDivide")).flatten().tex();return h+"\\frac{"+y+"}{"+d+"}"}else return h+y},strip:function(){var e=u.map(this.terms,function(n){return n instanceof g?n.abs():n.strip()});return new m(e).flatten()},expand:function(){var e=function(w){return w instanceof J},n=function(w){return w instanceof P&&w.exp.isNegative()},r=function(w){return n(w)&&e(w.base)},c=this.recurse("expand").flatten(),l=u.any(c.terms,e),h=u.any(c.terms,r);if(!(l||h))return c;var y=u.groupBy(c.terms,n),M=y[!1]||[],k=y[!0]||[];if(l){var _=u.groupBy(M,e),v=_[!0]||[],p=_[!1]||[],d=u.reduce(v,function(w,R){return u.reduce(w,function(q,W){return q.concat(u.map(R.terms,function($){return W.concat($)}))},[])},[[]]),f=u.map(d,function(w){return new m(p.concat(w)).flatten()});M=[new J(f)]}if(h){var E=new m(u.invoke(k,"getDenominator")).flatten();k=[new P(E.expand(),g.Div)]}return new m(M.concat(k)).flatten()},factor:function(e){var n=this.recurse("factor",e).flatten();if(!(n instanceof m))return n;var r=u.groupBy(n.terms,function(l){return l instanceof H}),c=u.reduce(r[!0],function(l,h){return{n:l.n*h.n,d:l.d*h.d}},{n:1,d:1});return c.d===1?c=new N(c.n):c=new H(c.n,c.d),new m((r[!1]||[]).concat(c)).flatten()},collect:function(e){var n=this.recurse("collect",e).partition(),r=n[0].reduce(e);if(r.eval()===0)return g.Zero;var c=n[1].flatten();if(!(c instanceof m))return new m(r,c).flatten();c=c.terms;var y=[];u.each(c,function(f){f instanceof P?y.push([f.base,f.exp]):y.push([f,g.One])});var l=u.groupBy(y,function(f){return f[0].normalize().print()}),h=u.compact(u.map(l,function(f){var E=f[0][0],w=new J(u.zip.apply(u,f)[1]),R=w.collect(e);return R instanceof g&&R.eval()===0?null:[E,R]})),y=u.groupBy(h,function(f){return f[0]instanceof U&&f[0].isBasic()?"trig":f[0]instanceof re?"log":"expr"}),M=y.trig||[],k=y.log||[],_=y.expr||[];if(M.length>1){var v=u.groupBy(M,function(f){return f[0].arg.normalize().print()});M=[],u.each(v,function(f){var E=f[0][0].arg,w={sin:g.Zero,cos:g.Zero};u.each(f,function(R){w[R[0].type]=R[1]}),m.handleNegative(w.sin).collect(e).equals(w.cos)&&(w.cos.isNegative()?w={tan:w.sin}:w={cot:w.cos}),u.each(w,function(R,q){M.push([new U(q,E),R])})})}if(k.length>1){var p=u.groupBy(k,function(f){return f[0].base.normalize().print()});k=[],u.each(p,function(f){f.length===2&&m.handleNegative(f[0][1]).collect(e).equals(f[1][1])?f[0][1].isNegative()?k.push([new re(f[0][0].power,f[1][0].power),f[1][1]]):k.push([new re(f[1][0].power,f[0][0].power),f[0][1]]):k=k.concat(f)})}y=M.concat(k).concat(_);var d=u.map(y,function(f){return new P(f[0],f[1]).collect(e)});return new m([r].concat(d)).flatten()},isSubtract:function(){return u.any(this.terms,function(e){return e instanceof g&&e.hints.subtract})},factorIn:function(e){var n=this.partition(),r=n[0].terms,c=r.length&&u.all(r,function(h){return h.n>0});if(c){var l=r[0].negate();return l.hints=r[0].hints,this.replace(r[0],l.addHint(e))}else return new m([g.negativeOne(e)].concat(this.terms))},factorOut:function(){var e=!1,n=u.compact(u.map(this.terms,function(r,c,l){return!e&&r instanceof g&&r.hints.divide?(e=!0,r.n!==-1?r.negate():null):r}));return n.length===1?n[0]:new m(n)},reduce:function(e){return u.reduce(this.terms,function(n,r){return n.mul(r,e)},this.identity)},findGCD:function(e){return new m(u.invoke(this.terms,"findGCD",e)).flatten()},asMul:function(){return this},asPositiveFactor:function(){if(this.isPositive())return this;var e=u.invoke(this.collect().terms,"asPositiveFactor");return new m(e).flatten()},isNegative:function(){return u.any(u.invoke(this.collect().terms,"isNegative"))},fold:function(){return m.fold(this)},negate:function(){var e=function(r){return r instanceof g};if(u.any(this.terms,e)){var n=u.find(this.terms,e);return this.replace(n,n.negate())}else return new m([g.Neg].concat(this.terms))}});u.each([J,m],function(e){u.extend(e,{createOrAppend:function(n,r){return n instanceof e?new e(n.terms.concat(r)):new e(n,r)}})});u.extend(m,{handleNegative:function(e,n){if(e instanceof g&&e.n>0){var r=e.negate();return r.hints=e.hints,r.addHint(n)}else return e instanceof m?e.factorIn(n):new m(g.negativeOne(n),e)},handleDivide:function(e,n){if(n instanceof m){var r=m.handleDivide(e,n.terms[0]),c=new m(u.rest(n.terms)).flatten();return m.handleDivide(r,c)}var l=function(p){return p instanceof N},h=function(p){return p instanceof H};if(l(n)&&e instanceof m&&u.any(e.terms,l)){var y=e.terms.slice().reverse(),M=u.find(y,h);if(!l(M))return new m(e.terms.concat([new H(1,n.n).addHint("fraction")]));var k=new H(M.n,n.n);return k.hints=M.hints,M===y[0]&&(k=k.addHint("fraction")),M.n<0&&n.n<0?(k.d=-k.d,e.replace(M,[g.Neg,k])):e.replace(M,k)}var _=function(p,d){if(d instanceof N){if(p instanceof N)return p.n<0&&d.n<0?[g.Neg,new H(p.n,-d.n).addHint("fraction")]:[new H(p.n,d.n).addHint("fraction")];var f=new H(1,d.eval());return d.eval()<0?[p,f.addHint("negate")]:[p,f]}else{var E;if(d instanceof U&&d.exp){var w=d.exp;d.exp=void 0,d=new P(d,w)}return d instanceof P?E=new P(d.base,m.handleNegative(d.exp,"divide")):E=new P(d,g.Div),p instanceof N&&p.n===1?[E]:[p,E]}};if(e instanceof m){var v=_(u.last(e.terms),n);return new m(u.initial(e.terms).concat(v))}else{var v=_(e,n);return new m(v).flatten()}},fold:function(e){if(e instanceof m){var n=u.find(u.initial(e.terms),function(d){return(d instanceof U||d instanceof re)&&d.hints.open}),r=u.indexOf(e.terms,n);if(n){var c=u.last(e.terms);if(n.hints.parens||c.hints.parens||c.has(U)||c.has(re))n.hints.open=!1;else{var l;return n instanceof U?l=U.create([n.type,n.exp],m.createOrAppend(n.arg,c).fold()):l=re.create(n.base,m.createOrAppend(n.power,c).fold()),r===0?l:new m(e.terms.slice(0,r).concat(l)).fold()}}var h=e.partition(),y=h[0].terms,M=function(d){return d.n>0},k=function(d){return d.n===-1&&d.hints.negate},_=function(d){return M(d)||k(d)};if(y.length>1&&u.some(y,k)&&u.some(y,M)&&u.every(y,_)){var v=u.indexOf(e.terms,u.find(e.terms,k)),p=u.indexOf(e.terms,u.find(e.terms,M));if(v<p)return e.replace(p,e.terms[p].negate()).remove(v)}}return e}});function P(e,n){this.base=e,this.exp=n}P.prototype=new le;u.extend(P.prototype,{func:P,args:function(){return[this.base,this.exp]},eval:function(e,n){var r=this.base.eval(e,n),c=this.exp.eval(e,n);if(r<0){var l=this.exp.simplify();if(l instanceof te){var h=l.n,y=(h-h.toFixed()).toString().length-2,M=Math.pow(10,y),k=new H(h*M,M);l=k.simplify()}if(l instanceof H){var _=Math.abs(l.d)%2===1;if(_){var v=Math.abs(l.n)%2===1,p=v?-1:1;return p*Math.pow(-1*r,c)}}}return Math.pow(r,c)},getUnits:function(){return this.base.getUnits().map((function(e){return{unit:e.unit,pow:e.pow*this.exp.n}}).bind(this))},codegen:function(){return"Math.pow("+this.base.codegen()+", "+this.exp.codegen()+")"},print:function(){var e=this.base.print();return(this.base instanceof ke||this.base instanceof P)&&(e="("+e+")"),e+"^("+this.exp.print()+")"},tex:function(){if(this.isDivide())return"\\frac{1}{"+this.asDivide().tex()+"}";if(this.isRoot())return this.exp.n!==1&&De("Node marked with hint 'root' does not have exponent of form 1/x."),this.exp.d===2?"\\sqrt{"+this.base.tex()+"}":"\\sqrt["+this.exp.d+"]{"+this.base.tex()+"}";if(this.base instanceof U&&!this.base.isInverse()&&this.exp instanceof g&&this.exp.isSimple()&&this.exp.eval()>=0){var e=this.base.tex({split:!0});return e[0]+"^{"+this.exp.tex()+"}"+e[1]}else{var n=this.base.tex();return this.base instanceof ke||this.base instanceof P||this.base instanceof g&&!this.base.isSimple()?n="("+n+")":(this.base instanceof U||this.base instanceof re)&&(n="["+n+"]"),n+"^{"+this.exp.tex()+"}"}},needsExplicitMul:function(){return this.isRoot()?!1:this.base.needsExplicitMul()},expand:function(){var e=this.recurse("expand");if(e.base instanceof m){var n=u.map(e.base.terms,function(_){return new P(_,e.exp)});return new m(n).expand()}else if(e.base instanceof J&&e.exp instanceof N&&e.exp.abs().eval()>1){for(var r=e.exp.eval()>0,c=e.exp.abs().eval(),l=function(_){return r?_:new P(_,g.Div)},h={1:e.base},y=2;y<=c;y*=2){var k=new m(h[y/2],h[y/2]);h[y]=k.expand().collect()}if(u.has(h,c))return l(h[c]);var M=u.map(c.toString(2).split(""),function(_,v,p){return Number(_)*Math.pow(2,p.length-v-1)});M=u.without(M,0);var k=new m(u.pick(h,M)).expand().collect();return l(k)}else if(e.exp instanceof J){var n=u.map(e.exp.terms,function(v){return new P(e.base,v).expand()});return new m(n).expand()}else return e},factor:function(){var e=this.recurse("factor");if(e.base instanceof m){var n=u.map(e.base.terms,function(r){return r instanceof N&&e.exp.equals(g.Div)?new H(1,r.n):new P(r,e.exp)});return new m(n)}else return e},collect:function(e){if(this.base instanceof P){var n=this.base.base,r=m.createOrAppend(this.base.exp,this.exp);return new P(n,r).collect(e)}var c=this.recurse("collect",e),l=function(v){return v instanceof re&&v.base.equals(c.base)};if(c.exp instanceof g&&c.exp.eval()===0)return g.One;if(c.exp instanceof g&&c.exp.eval()===1)return c.base;if(l(c.exp))return c.exp.power;if(c.exp instanceof m&&u.any(c.exp.terms,l)){var h=u.find(c.exp.terms,l),n=h.power,r=c.exp.remove(h).flatten();return new P(n,r).collect(e)}else if(c.base instanceof g&&c.exp instanceof g){if(e&&e.preciseFloats){var r=c.exp.asRational(),y=c.base.getDecimalPlaces(),M=new P(c.base,new H(1,r.d)),k=M.collect().getDecimalPlaces();if(k>y){var _=new P(c.base,new N(r.n)).collect();return new P(_,new H(1,r.d))}}return c.base.raiseToThe(c.exp,e)}else return c},isDivide:function(){var e=function(n){return n instanceof g&&n.hints.divide};return e(this.exp)||this.exp instanceof m&&u.any(this.exp.terms,e)},asDivide:function(){if(this.exp instanceof g){if(this.exp.eval()===-1)return this.base;var e=this.exp.negate();return e.hints=u.clone(this.exp.hints),e.hints.divide=!1,new P(this.base,e)}else{if(this.exp instanceof m)return new P(this.base,this.exp.factorOut());De("called asDivide() on an Expr that wasn't a Num or Mul")}},isRoot:function(){return this.exp instanceof H&&this.exp.hints.root},isSquaredTrig:function(){return this.base instanceof U&&!this.base.isInverse()&&this.exp instanceof g&&this.exp.eval()===2},getDenominator:function(){if(this.exp instanceof g&&this.exp.eval()===-1)return m.createOrAppend(this.base,this.base.getDenominator()).flatten();if(this.exp.isNegative()){var e=new P(this.base,m.handleNegative(this.exp).collect());return m.createOrAppend(e,e.collect().getDenominator()).flatten()}else return this.base instanceof g?new P(this.base.getDenominator(),this.exp).collect():g.One},findGCD:function(e){var n,r;if(e instanceof P?(n=e.base,r=e.exp):(n=e,r=g.One),this.base.equals(n)){if(this.exp.equals(r))return this;if(this.exp instanceof g&&r instanceof g)return new P(this.base,g.min(this.exp,r)).collect();if(this.exp instanceof g||r instanceof g)return g.One;var c=this.exp.asMul().partition(),l=r.asMul().partition();if(c[1].equals(l[1])){var h=g.min(c[0].reduce(),l[0].reduce()),y=new m(h,c[1].flatten()).flatten();return new P(n,y).collect()}}return g.One},isPositive:function(){if(this.base.isPositive())return!0;var e=this.exp.simplify();return e instanceof N&&e.eval()%2===0},asPositiveFactor:function(){if(this.isPositive())return this;var e=this.exp.simplify();if(e instanceof N){var n=e.eval();if(n>2)return new P(this.base,new N(n-1));if(n<-2)return new P(this.base,new N(n+1))}return g.One}});u.extend(P,{sqrt:function(e){return new P(e,g.Sqrt)},nthroot:function(e,n){var r=m.fold(m.handleDivide(new N(1),n));return new P(e,r.addHint("root"))}});function re(e,n){this.base=e,this.power=n}re.prototype=new le;u.extend(re.prototype,{func:re,args:function(){return[this.base,this.power]},eval:function(e,n){return Math.log(this.power.eval(e,n))/Math.log(this.base.eval(e,n))},codegen:function(){return"(Math.log("+this.power.codegen()+") / Math.log("+this.base.codegen()+"))"},print:function(){var e="("+this.power.print()+")";return this.isNatural()?"ln"+e:"log_("+this.base.print()+") "+e},tex:function(){var e="("+this.power.tex()+")";return this.isNatural()?"\\ln"+e:"\\log_{"+this.base.tex()+"}"+e},collect:function(e){var n=this.recurse("collect",e);return n.power instanceof g&&n.power.eval()===1?g.Zero:n.base.equals(n.power)?g.One:n.power instanceof P&&n.power.base.equals(n.base)?n.power.exp:n},expand:function(){var e=this.recurse("expand");if(e.power instanceof m){var n=u.map(e.power.terms,function(r){return new re(e.base,r).expand()});return new J(n)}else return e.power instanceof P?new m(e.power.exp,new re(e.base,e.power.base).expand()).flatten():e.isNatural()?e:m.handleDivide(new re(ue.e,e.power),new re(ue.e,e.base))},hints:u.extend(re.prototype.hints,{open:!1}),isPositive:function(){var e=this.collect();return e.base instanceof g&&e.power instanceof g?this.eval()>0:!1},needsExplicitMul:function(){return!1},isNatural:function(){return this.base.equals(ue.e)}});u.extend(re,{natural:function(){return ue.e},common:function(){return g.Ten},create:function(e,n){var r=new re(e,n);return n.hints.parens||(r=r.addHint("open")),r}});function U(e,n){this.type=e,this.arg=n}U.prototype=new le;u.extend(U.prototype,{func:U,args:function(){return[this.type,this.arg]},functions:{sin:{eval:Math.sin,codegen:"Math.sin((",tex:"\\sin",expand:function(){return this}},cos:{eval:Math.cos,codegen:"Math.cos((",tex:"\\cos",expand:function(){return this}},tan:{eval:Math.tan,codegen:"Math.tan((",tex:"\\tan",expand:function(){return m.handleDivide(U.sin(this.arg),U.cos(this.arg))}},csc:{eval:function(e){return 1/Math.sin(e)},codegen:"(1/Math.sin(",tex:"\\csc",expand:function(){return m.handleDivide(g.One,U.sin(this.arg))}},sec:{eval:function(e){return 1/Math.cos(e)},codegen:"(1/Math.cos(",tex:"\\sec",expand:function(){return m.handleDivide(g.One,U.cos(this.arg))}},cot:{eval:function(e){return 1/Math.tan(e)},codegen:"(1/Math.tan(",tex:"\\cot",expand:function(){return m.handleDivide(U.cos(this.arg),U.sin(this.arg))}},arcsin:{eval:Math.asin,codegen:"Math.asin((",tex:"\\arcsin"},arccos:{eval:Math.acos,codegen:"Math.acos((",tex:"\\arccos"},arctan:{eval:Math.atan,codegen:"Math.atan((",tex:"\\arctan"},arccsc:{eval:function(e){return Math.asin(1/e)},codegen:"Math.asin(1/(",tex:"\\operatorname{arccsc}"},arcsec:{eval:function(e){return Math.acos(1/e)},codegen:"Math.acos(1/(",tex:"\\operatorname{arcsec}"},arccot:{eval:function(e){return Math.atan(1/e)},codegen:"Math.atan(1/(",tex:"\\operatorname{arccot}"},sinh:{eval:function(e){return(Math.exp(e)-Math.exp(-e))/2},codegen:function(e){return"((Math.exp("+e+") - Math.exp(-("+e+"))) / 2)"},tex:"\\sinh",expand:function(){return this}},cosh:{eval:function(e){return(Math.exp(e)+Math.exp(-e))/2},codegen:function(e){return"((Math.exp("+e+") + Math.exp(-("+e+"))) / 2)"},tex:"\\cosh",expand:function(){return this}},tanh:{eval:function(e){return(Math.exp(e)-Math.exp(-e))/(Math.exp(e)+Math.exp(-e))},codegen:function(e){return"((Math.exp("+e+") - Math.exp(-("+e+"))) / (Math.exp("+e+") + Math.exp(-("+e+"))))"},tex:"\\tanh",expand:function(){return m.handleDivide(U.sinh(this.arg),U.cosh(this.arg))}},csch:{eval:function(e){return 2/(Math.exp(e)-Math.exp(-e))},codegen:function(e){return"(2 / (Math.exp("+e+") - Math.exp(-("+e+"))))"},tex:"\\csch",expand:function(){return m.handleDivide(g.One,U.sinh(this.arg))}},sech:{eval:function(e){return 2/(Math.exp(e)+Math.exp(-e))},codegen:function(e){return"(2 / (Math.exp("+e+") + Math.exp(-("+e+"))))"},tex:"\\sech",expand:function(){return m.handleDivide(g.One,U.cosh(this.arg))}},coth:{eval:function(e){return(Math.exp(e)+Math.exp(-e))/(Math.exp(e)-Math.exp(-e))},codegen:function(e){return"((Math.exp("+e+") + Math.exp(-("+e+"))) / (Math.exp("+e+") - Math.exp(-("+e+"))))"},tex:"\\coth",expand:function(){return m.handleDivide(U.cosh(this.arg),U.sinh(this.arg))}}},isEven:function(){return u.contains(["cos","sec"],this.type)},isInverse:function(){return this.type.indexOf("arc")===0},isBasic:function(){return u.contains(["sin","cos"],this.type)},eval:function(e,n){var r=this.functions[this.type].eval,c=this.arg.eval(e,n);return r(c)},codegen:function(){var e=this.functions[this.type].codegen;if(typeof e=="function")return e(this.arg.codegen());if(typeof e=="string")return e+this.arg.codegen()+"))";throw new Error("codegen not implemented for "+this.type)},print:function(){return this.type+"("+this.arg.print()+")"},tex:function(e){var n=this.functions[this.type].tex,r="("+this.arg.tex()+")";return e&&e.split?[n,r]:n+r},hints:u.extend(U.prototype.hints,{open:!1}),isPositive:function(){var e=this.collect();return e.arg instanceof g?this.eval()>0:!1},completeParse:function(){if(this.exp){var e=new P(this,this.exp);return this.exp=void 0,e}else return this},needsExplicitMul:function(){return!1},expand:function(){var e=this.recurse("expand");if(e.isInverse())return e;var n=e.functions[e.type].expand;return u.bind(n,e)()},collect:function(e){var n=this.recurse("collect",e);if(!n.isInverse()&&n.arg.isNegative()){var r;return n.arg instanceof g?r=n.arg.abs():r=m.handleDivide(n.arg,g.Neg).collect(e),n.isEven()?new U(n.type,r):new m(g.Neg,new U(n.type,r))}else return n}});u.extend(U,{create:function(e,n){var r=e[0],c=e[1];c&&c.equals(g.Neg)&&(r="arc"+r,c=void 0);var l=new U(r,n);return n.hints.parens||(l=l.addHint("open")),c&&(l.exp=c),l},sin:function(e){return new U("sin",e)},cos:function(e){return new U("cos",e)},sinh:function(e){return new U("sinh",e)},cosh:function(e){return new U("cosh",e)}});function be(e){this.arg=e}be.prototype=new le;u.extend(be.prototype,{func:be,args:function(){return[this.arg]},eval:function(e,n){return Math.abs(this.arg.eval(e,n))},codegen:function(){return"Math.abs("+this.arg.codegen()+")"},print:function(){return"abs("+this.arg.print()+")"},tex:function(){return"\\left|"+this.arg.tex()+"\\right|"},collect:function(e){var n=this.recurse("collect",e);if(n.arg.isPositive())return n.arg;if(n.arg instanceof g)return n.arg.abs();if(n.arg instanceof m){var r=u.groupBy(n.arg.terms,function(l){return l.isPositive()?"positive":l instanceof g?"number":"other"}),c=r.positive.concat(u.invoke(r.number,"abs"));return r.other.length&&c.push(new be(new m(r.other).flatten())),new m(c).flatten()}else return n},expand:function(){var e=this.recurse("expand");if(e.arg instanceof m){var n=u.map(e.arg.terms,function(r){return new be(r)});return new m(n)}else return e},isPositive:function(){return!0}});function de(e,n,r){this.left=e,this.type=n,this.right=r}de.prototype=new le;u.extend(de.prototype,{func:de,args:function(){return[this.left,this.type,this.right]},needsExplicitMul:function(){return!1},print:function(){return this.left.print()+this.type+this.right.print()},signs:{"=":" = ","<":" < ",">":" > ","<>":" \\ne ","<=":" \\le ",">=":" \\ge "},tex:function(){return this.left.tex()+this.signs[this.type]+this.right.tex()},normalize:function(){var e=this.recurse("normalize");return u.contains([">",">="],e.type)?new de(e.right,e.type.replace(">","<"),e.left):e},asExpr:function(e){var n=function(M){return M instanceof g&&M.isSimple()&&M.eval()===0},r=[];this.left instanceof J?r=u.clone(this.left.terms):n(this.left)||(r=[this.left]),this.right instanceof J?r=r.concat(this.right.negate().terms):n(this.right)||r.push(this.right.negate());var c=!this.isEquality();r=u.invoke(r,"collect",{preciseFloats:!0});for(var l=0;l<r.length;l++){var h=r[l].getDenominator();c&&!h.isPositive()&&(h=h.asPositiveFactor()),h.equals(g.One)||(r=u.map(r,function(M){return m.createOrAppend(M,h).simplify({once:!0,preciseFloats:!0})}))}var y=new J(r).flatten();return e?y:this.divideThrough(y)},divideThrough:function(e){var n=!this.isEquality(),r=e.simplify({once:!0}),c=r.factor({keepNegative:n});if(!(c instanceof m))return e;var l=c.terms,h=function(f){return f instanceof J},y=function(f){return!!f.getVars().length},M=function(f){return f.equals(g.One)},k=u.groupBy(l,h),_=k[!0]||[],v=k[!1]||[];if(_.length&&this.isEquality())return new m(_).flatten();var p=v;_.length||(p=u.reject(p,y)),n&&(p=u.invoke(p,"asPositiveFactor")),p=u.reject(p,M),p=u.map(p,function(f){return new P(f,g.Div)});var d=new m(l.concat(p)).collect();return d.equals(c)?r:d},isEquality:function(){return u.contains(["=","<>"],this.type)},compare:function(e){if(!(e instanceof de))return!1;var n=this.normalize(),r=e.normalize();if(n.type!==r.type)return!1;var c=n.divideThrough(n.asExpr(!0).collect()),l=r.divideThrough(r.asExpr(!0).collect());return n.isEquality()?c.compare(l)||c.compare(m.handleNegative(l)):c.compare(l)},sameForm:function(e){var n=this.normalize(),r=e.normalize(),c=n.left.sameForm(r.left)&&n.right.sameForm(r.right);return n.isEquality()?c||n.left.sameForm(r.right)&&n.right.sameForm(r.left):c},isSimplified:function(){var e=this.asExpr(!0),n=this.divideThrough(e).simplify();return e.equals(n)&&this.left.isSimplified()&&this.right.isSimplified()}});u.extend(de.prototype,{solveLinearEquationForVariable:function(e){var n=this.asExpr();if(!n.is(J)||n.terms.length!==2)throw new Error("Can only handle linear equations of the form a + bx (= 0)");var r=function(h){return h.has(Ee)&&u.contains(h.getVars(),e.symbol)},c,l;return r(n.terms[0])?(c=m.handleNegative(n.terms[1]),l=m.handleDivide(n.terms[0],e)):(c=m.handleNegative(n.terms[0]),l=m.handleDivide(n.terms[1],e)),m.handleDivide(c,l).simplify()}});function ge(){}ge.prototype=new le;u.extend(ge.prototype,{needsExplicitMul:function(){return!1},findGCD:function(e){return e instanceof ge||e instanceof g?this.equals(e)?this:g.One:e.findGCD(this)}});function pe(e,n){this.symbol=e,this.arg=n}pe.prototype=new ge;u.extend(pe.prototype,{func:pe,args:function(){return[this.symbol,this.arg]},print:function(){return this.symbol+"("+this.arg.print()+")"},tex:function(){return this.symbol+"("+this.arg.tex()+")"},eval:function(e,n){var r=this.arg,c=e[this.symbol],l=u.extend(u.clone(e),{x:r.eval(e,n)}),h=Ge(c,n);return h.parsed?h.expr.eval(l,n):h},codegen:function(){return'vars["'+this.symbol+'"]('+this.arg.codegen()+")"},getUnits:function(){return this.arg.getUnits()},getVars:function(e){return e?this.arg.getVars():u.union(this.arg.getVars(),[this.symbol]).sort()},getConsts:function(){return this.arg.getConsts()}});function Ee(e,n){this.symbol=e,this.subscript=n}Ee.prototype=new ge;u.extend(Ee.prototype,{func:Ee,args:function(){return[this.symbol,this.subscript]},exprArgs:function(){return[]},recurse:function(){return this},print:function(){var e="";return this.subscript&&(e="_("+this.subscript.print()+")"),this.symbol+e},prettyPrint:function(){var e=this.subscript;return e&&(e instanceof g||e instanceof ge)?this.symbol+"_"+e.print():this.print()},tex:function(){var e="";this.subscript&&(e="_{"+this.subscript.tex()+"}");var n=this.symbol.length>1?"\\":"";return n+this.symbol+e},repr:function(){return"Var("+this.print()+")"},eval:function(e,n){return e[this.prettyPrint()]},codegen:function(){return'vars["'+this.prettyPrint()+'"]'},getVars:function(){return[this.prettyPrint()]},isPositive:function(){return!1}});function ue(e){this.symbol=e}ue.prototype=new ge;u.extend(ue.prototype,{func:ue,args:function(){return[this.symbol]},recurse:function(){return this},eval:function(e,n){if(this.symbol==="pi")return Math.PI;if(this.symbol==="e")return Math.E},codegen:function(){if(this.symbol==="pi")return"Math.PI";if(this.symbol==="e")return"Math.E"},print:function(){return this.symbol},tex:function(){if(this.symbol==="pi")return"\\pi ";if(this.symbol==="e")return"e"},isPositive:function(){return this.eval()>0},abs:function(){return this.eval()>0?this:m.handleNegative(this)},getConsts:function(){return[this.print()]}});ue.e=new ue("e");ue.pi=new ue("pi");function g(){}g.prototype=new le;u.extend(g.prototype,{repr:function(){return this.print()},strip:function(){return this.abs()},recurse:function(){return this},codegen:function(){return this.print()},add:ie,mul:ie,negate:ie,isSubtract:function(){return this.hints.subtract},abs:ie,needsExplicitMul:function(){return!0},findGCD:ie,isPositive:function(){return this.eval()>0},isNegative:function(){return this.eval()<0},asPositiveFactor:function(){return this.isPositive()?this:this.abs()},hints:u.extend(g.prototype.hints,{negate:!1,subtract:!1,divide:!1,root:!1,fraction:!1,entered:!1}),isSimple:ie,getDecimalPlaces:function(){var e=(""+this.n).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0},asRational:ie});function H(e,n){var r=e,c=n;c<0&&(r=-r,c=-c),this.n=r,this.d=c}H.prototype=new g;u.extend(H.prototype,{func:H,args:function(){return[this.n,this.d]},eval:function(){return this.n/this.d},print:function(){return this.n.toString()+"/"+this.d.toString()},tex:function(){var e="\\frac{"+Math.abs(this.n).toString()+"}{"+this.d.toString()+"}";return this.n<0?"-"+e:e},add:function(e,n){return e instanceof H?new H(this.n*e.d+this.d*e.n,this.d*e.d).collect():e.add(this,n)},mul:function(e,n){return e instanceof H?new H(this.n*e.n,this.d*e.d).collect():e.mul(this,n)},collect:function(){var e=g.findGCD(this.n,this.d),n=this.n/e,r=this.d/e;return r===1?new N(n):new H(n,r)},negate:function(){return new H(-this.n,this.d)},abs:function(){return new H(Math.abs(this.n),this.d)},findGCD:function(e){if(e instanceof H){var n=g.findGCD(this.n*e.d,e.n*this.d),r=this.d*e.d;return new H(n,r).collect()}else return e instanceof N?new H(g.findGCD(this.n,e.n),this.d):e.findGCD(this)},raiseToThe:function(e){if(e instanceof N){var n=e.eval()>0,r=e.abs().eval(),c=Math.pow(this.n,r),l=Math.pow(this.d,r);return n?new H(c,l).collect():new H(l,c).collect()}else return new te(this.eval()).raiseToThe(e)},getDenominator:function(){return new N(this.d)},isSimple:function(){return!1},asRational:function(){return this}});function N(e){this.n=e}N.prototype=new H(0,1);u.extend(N.prototype,{func:N,args:function(){return[this.n]},print:function(){return this.n.toString()},tex:function(){return this.n.toString()},negate:function(){return new N(-this.n)},abs:function(){return new N(Math.abs(this.n))},isSimple:function(){return!0},findGCD:function(e){return e instanceof N?new N(g.findGCD(this.n,e.n)):e.findGCD(this)}});u.extend(N,{create:function(e){return new N(e).addHint("entered")}});function te(e){this.n=e}te.prototype=new g;u.extend(te.prototype,{func:te,args:function(){return[this.n]},eval:function(){return this.n},print:function(){return this.n.toString()},tex:function(){return this.n.toString()},add:function(e,n){return n&&n.preciseFloats?te.toDecimalPlaces(this.n+e.eval(),Math.max(this.getDecimalPlaces(),e.getDecimalPlaces())):new te(this.n+e.eval()).collect()},mul:function(e,n){return n&&n.preciseFloats?te.toDecimalPlaces(this.n*e.eval(),this.getDecimalPlaces()+e.getDecimalPlaces()):new te(this.n*e.eval()).collect()},collect:function(){return this},negate:function(){return new te(-this.n)},abs:function(){return new te(Math.abs(this.n))},findGCD:function(e){return e instanceof g?new te(g.findGCD(this.eval(),e.eval())).collect():e.findGCD(this)},raiseToThe:function(e,n){return n&&n.preciseFloats&&e instanceof N&&e.n>1?te.toDecimalPlaces(new P(this,e).eval(),this.getDecimalPlaces()*e.n):new te(new P(this,e).eval()).collect()},asRational:function(){var e=this.n.toString().split(".");if(e.length===1)return new H(this.n,1);var n=Number(e.join("")),r=Math.pow(10,e[1].length);return new H(n,r).collect()},getDenominator:function(){return this.asRational().getDenominator()},isSimple:function(){return!0}});u.extend(te,{create:function(e){return new te(e).addHint("entered")},toDecimalPlaces:function(e,n){return new te(+e.toFixed(Math.min(n,20))).collect()}});u.extend(g,{negativeOne:function(e){return e==="subtract"?g.Sub:e==="divide"?g.Div:g.Neg},findGCD:function(e,n){var r;if(e=Math.abs(e),n=Math.abs(n),e!==Math.floor(e)||n!==Math.floor(n))return 1;for(;n;)r=e%n,e=n,n=r;return e},min:function(){return u.min(u.toArray(arguments),function(e){return e.eval()})},max:function(){return u.max(u.toArray(arguments),function(e){return e.eval()})}});g.Neg=new N(-1).addHint("negate");g.Sub=new N(-1).addHint("subtract");g.Div=new N(-1).addHint("divide");g.Sqrt=new H(1,2).addHint("root");g.Zero=new N(0);g.One=new N(1);g.Ten=new N(10);J.prototype.identity=g.Zero;m.prototype.identity=g.One;var Ke=function(e,n){throw new Error(n.loc.first_column)};_e.yy={Add:J,Mul:m,Pow:P,Log:re,Trig:U,Eq:de,Abs:be,Func:pe,Const:ue,Var:Ee,Int:N,Float:te,parseError:Ke,constants:["e"],symbolLexer:function(e){return u.contains(_e.yy.constants,e)?"CONST":u.contains(_e.yy.functions,e)?"FUNC":"VAR"}};const Ge=function(e,n){try{n&&n.functions?_e.yy.functions=u.without(n.functions,"i"):_e.yy.functions=[],n&&n.decimal_separator&&(e=e.split(n.decimal_separator).join("."));var r=_e.parse(e).completeParse();return{parsed:!0,expr:r}}catch(c){return{parsed:!1,error:c.message}}};function ne(e){this.symbol=e}ne.prototype=new ge;var Re=function(e){if(u(Se).has(e)||u(Ie).has(e))return new ne(e);var n=u(u(Ve).keys()).find(function(c){return new RegExp("^"+c).test(e)});if(n){var r=e.replace(new RegExp("^"+n),"");if(u(Se).has(r)||Ie[r]&&Ie[r].prefixes===Y)return new m(Ve[n],new ne(r));throw new Error(r+" does not allow prefixes")}else return new ne(e)};const Xe=function(e){try{var n=Ye.parse(e),r=[];u(n.unit.num).each(function(y){r.push(new P(Re(y.name),new N(y.pow)))}),u(n.unit.denom).each(function(y){r.push(new P(Re(y.name),new N(-1*y.pow)))});var c=new m(r).flatten();if(n.type==="unitMagnitude"){var l=[new te(+n.magnitude)].concat(r),h=new m(l);return{parsed:!0,unit:c,expr:h,coefficient:n.magnitude,type:n.type}}else return{parsed:!0,unit:c,type:n.type}}catch(y){return{parsed:!1,error:y.message}}};u.extend(ne.prototype,{func:ne,args:function(){return[this.symbol]},recurse:function(){return this},eval:function(e,n){return 1},getUnits:function(){return[{unit:this.symbol,pow:1}]},codegen:function(){return"1"},print:function(){return this.symbol},tex:function(){return this.symbol},collect:function(e){if(u(Se).has(this.symbol))return this;if(u(Ie).has(this.symbol))return Ie[this.symbol].conversion;throw new Error("could not understand unit: "+this.symbol)}});var Se={m:new ne("m"),g:new ne("g"),s:new ne("s"),A:new ne("A"),K:new ne("K"),mol:new ne("mol"),cd:new ne("cd")},Ve={a:new P(new N(10),new N(-18)),f:new P(new N(10),new N(-15)),p:new P(new N(10),new N(-12)),n:new P(new N(10),new N(-9)),u:new P(new N(10),new N(-6)),m:new P(new N(10),new N(-3)),c:new P(new N(10),new N(-2)),d:new P(new N(10),new N(-1)),da:new N(10),h:new P(new N(10),new N(2)),k:new P(new N(10),new N(3)),M:new P(new N(10),new N(6)),G:new P(new N(10),new N(9)),T:new P(new N(10),new N(12)),P:new P(new N(10),new N(15)),E:new P(new N(10),new N(18)),hella:new P(new N(10),new N(27))},Y={},O={},b=function(e,n){var r=e.split("|"),c=r[0].trim(),l=r[1].trim(),h=g.One;c!==""&&(h=Ge(c).expr);var y=l.split("/"),M=[h];return y[0]&&y[0].split(" ").filter(function(k){return k!==""}).map(function(k){M.push(new ne(k))}),y[1]&&y[1].split(" ").filter(function(k){return k!==""}).map(function(k){M.push(new P(new ne(k),g.Div))}),{conversion:new m(M),prefixes:n}},Ie={Da:b("1.6605388628 x 10^-24 | g",Y),u:b("| Da",O),meter:b("| m",O),meters:b("| m",O),in:b("254 / 10000 | m",O),ft:b("3048  / 10000 | m",O),yd:b("9144  / 10000 | m",O),mi:b("1609344 / 1000 | m",O),ly:b("9.4607 x 10^15 | m",O),nmi:b("1852 | m",O),Å:b("10^-10 | m",O),pc:b("3.0857 x 10^16 | m",O),min:b("60 | s",O),hr:b("3600 | s",O),sec:b("| s",O),day:b("86400 | s",O),wk:b("604800 | s",O),fortnight:b("14 | day",O),shake:b("10^-8 | s",O),olympiad:b("126200000 | s",O),"°C":b("1 | K",O),"°F":b("5/9 | K",O),"°R":b("5/9 | K",O),e:b("1.6021765314 x 10^-19 | C",O),c:b("299792458 | m / s",O),kn:b("514/1000 | m / s",O),kt:b("| kn",O),knot:b("| kn",O),J:b("| N m",Y),BTU:b("1060 | J",O),cal:b("4184 / 1000 | J",Y),eV:b("1.602176514 x 10^-19 | J",Y),erg:b("10^−7 | J",Y),W:b("| J / s",Y),"H-e":b("80 | W",O),N:b("1000 | g m / s s",Y),lb:b("4448221615 / 1000000000 | N",O),dyn:b("10^-5 | N",O),Pa:b("1 | N / m m m",Y),bar:b("10^5 | Pa",Y),"㏔":b("1/1000 | bar",O),"㍴":b("| bar",O),atm:b("101325 | Pa",O),Torr:b("1/760 | atm",O),mmHg:b("| Torr",O),ha:b("10^4 | m m",O),b:b("10^−28 | m m",Y),barn:b("| b",Y),acre:b("4046.87 | m m",O),skilodge:b("10^-31 | m m",O),outhouse:b("10^-34 | m m",O),shed:b("10^-52 | m m",O),L:b("1/1000 | m m m",Y),gal:b("3785/1000 | L",Y),cup:b("1/16 | gal",O),qt:b("1/4 | gal",O),quart:b("| qt",O),p:b("1/8 | gal",O),pt:b("| p",O),pint:b("| p",O),"fl oz":b("1/8 | cup",O),"fl. oz.":b("1/8 | cup",O),tbsp:b("1/16 | cup",O),tsp:b("1/3 | tbsp",O),rev:b("2 pi | rad",O),deg:b("180 pi | rad",O),"°":b("| deg",O),arcminute:b("1/60 | deg",O),arcsec:b("1/3600 | deg",O),Hu:b("1000 | dB",Y),dozen:b("12 |",O),mol:b("6.0221412927 x 10^23 |",Y),"%":b("1/100 |",O),percent:b("| %",O),ppm:b("1/1000000 |",O),V:b("1000 | g m m / s s C",Y),C:b("| A s",Y),ampere:b("| A",O),Ω:b("| V / A",Y),ohm:b("| Ω",O),F:b("| C / V",Y),H:b("| ohm s",Y),T:b("1000 | g / C s",Y),Wb:b("1000 | g m m / C s",Y),lm:b("pi x 10^4 | cd / m m",O),lx:b("| lm / m m",O),nit:b("| cd / m m",O),sb:b("10^4 | cd / m m",O),stilb:b("1 | sb",O),apostilb:b("1 / pi x 10^(-4) | sb",O),blondel:b("| apostilb",O),asb:b("| apostilb",O),la:b("| lm",O),Lb:b("| lm",O),sk:b("10^-7 | lm",O),skot:b("| sk",O),bril:b("10^-11 | lm",O),Hz:b("| / s",Y)};g.Zero;g.One;const $e=function(e,n,r){var c={form:!1,simplify:!1};r!==void 0?r=u.extend(c,r):r=c;var l=e.sameVars(n);if(!l.equal){var h;return l.equalIgnoringCase?h="Check your variables; one or more are using the wrong case (upper or lower).":h="Check your variables; you may have used the wrong letter for one or more of them.",{equal:!1,wrongVariableCase:l.equalIgnoringCase,wrongVariableNames:!l.equalIgnoringCase,message:h}}return e.compare(n)?r.form&&!e.sameForm(n)?{equal:!1,message:"Your answer is not in the correct form."}:r.simplify&&!e.isSimplified()?{equal:!1,message:"Your answer is not fully expanded and simplified."}:{equal:!0,message:null}:{equal:!1,message:null}};export{de as E,m as M,Ee as V,$e as c,Ge as p,Xe as u};
