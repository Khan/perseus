import{r as o,R as C}from"./index-qhcEwEpg.js";import{l as m}from"./index-awljIyHI.js";function c(){return c=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},c.apply(this,arguments)}function v(n,e){if(n==null)return{};var t={},r=Object.keys(n),s,a;for(a=0;a<r.length;a++)s=r[a],!(e.indexOf(s)>=0)&&(t[s]=n[s]);return t}function b(n){const e=[];if(n)if(Array.isArray(n))for(const t of n)e.push(...b(t));else e.push(n);else return e;return e}function _(n){const e=[],t=[];if(!n)return{style:{},className:""};const r=typeof global<"u"&&global.SNAPSHOT_INLINE_APHRODITE;b(n).forEach(a=>{const i=a._definition;if(i!=null)if(r){const d={};for(const[h,u]of Object.entries(i))d[h.replace(/-[a-z]/g,g=>g[1].toUpperCase())]=u;t.push(d)}else e.push(a);else t.push(a)});const s=Object.assign({},...t);if(t.length>0&&!r){const a=m.StyleSheet.create({inlineStyles:s});e.push(a.inlineStyles)}return{style:r?s:{},className:m.css(...e)}}const N=["children","style","tag","testId"],F=/^h[1-6]$/,w=m.StyleSheet.create({text:{WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale"},header:{marginTop:0,marginBottom:0}}),L=o.forwardRef(function(e,t){let{children:r,style:s,tag:a="span",testId:i}=e,d=v(e,N);const h=F.test(a),u=_([w.text,h&&w.header,s]),g=d.className?[d.className,u.className].join(" "):u.className;return o.createElement(a,c({},d,{style:u.style,className:g,"data-test-id":i,ref:t}),r)}),O=["className","style"];function y(n,e){return o.forwardRef((t,r)=>{const{className:s,style:a}=t,i=v(t,O),d=typeof n=="string"?P[n]:null,{className:h,style:u}=_([d,e,a]);return o.createElement(n,c({},i,{ref:r,className:[h,s].filter(Boolean).join(" "),style:u}))})}const P=m.StyleSheet.create({button:{margin:0,"::-moz-focus-inner":{border:0}}}),T=["testId","tag"],p=m.StyleSheet.create({default:{alignItems:"stretch",borderWidth:0,borderStyle:"solid",boxSizing:"border-box",display:"flex",flexDirection:"column",margin:0,padding:0,position:"relative",zIndex:0,minHeight:0,minWidth:0}}),$=y("div",p.default),j=y("article",p.default),D=y("aside",p.default),q=y("nav",p.default),A=y("section",p.default),M=o.forwardRef(function(e,t){const{testId:r,tag:s="div"}=e,a=v(e,T),i=c({},a,{"data-test-id":r});switch(s){case"article":return o.createElement(j,c({},i,{ref:t}));case"aside":return o.createElement(D,c({},i,{ref:t}));case"nav":return o.createElement(q,c({},i,{ref:t}));case"section":return o.createElement(A,c({},i,{ref:t}));case"div":return o.createElement($,c({},i,{ref:t}));default:throw Error(`${s} is not an allowed value for the 'tag' prop`)}});let l=function(n){return n.Root="root",n.Initial="initial",n.Standard="standard",n}({});const f=o.createContext(l.Root);f.displayName="RenderStateContext";class W extends o.Component{constructor(...e){super(...e),this.state={mounted:!1},this._isTheRootComponent=!1}componentDidMount(){this._isTheRootComponent&&this.setState({mounted:!0})}_renderAsRootComponent(){const{mounted:e}=this.state,{children:t,placeholder:r}=this.props;return this._isTheRootComponent=!0,e?o.createElement(f.Provider,{value:l.Standard},t()):r?o.createElement(f.Provider,{value:l.Initial},r()):null}_maybeRender(e){const{children:t,placeholder:r}=this.props;switch(e){case l.Root:return this._renderAsRootComponent();case l.Initial:return r?r():null;case l.Standard:return t()}{var s;return console.log(`We got a render state we don't understand: "${(s=JSON.stringify(e))!=null?s:""}"`),this._maybeRender(l.Root)}}render(){return o.createElement(f.Consumer,null,e=>this._maybeRender(e))}}class S{constructor(e){this._uniqueFactoryName=void 0,this.get=r=>{const s=r.toLowerCase();if(!this._hasValidIdChars(r))throw new Error(`Invalid identifier key: ${r}`);return`${this._uniqueFactoryName}-${s}`},e=typeof e=="string"?e:"";const t=e.toLowerCase();if(!this._hasValidIdChars(t))throw new Error(`Invalid factory scope: ${e}`);this._uniqueFactoryName=`uid-${t}-${S._factoryUniquenessCounter++}`}_hasValidIdChars(e){if(typeof e!="string")return!1;const t=e.replace(/[^\d\w-]/g,"-");return e===t}}S._factoryUniquenessCounter=0;class R{get(e){return e}}R.Default=new R;var x=R.Default;class z extends o.Component{constructor(...e){super(...e),this._idFactory=void 0}_performRender(e){const{children:t,mockOnFirstRender:r,scope:s}=this.props;return e?r?t(x):null:(this._idFactory||(this._idFactory=new S(s)),t(this._idFactory))}render(){return o.createElement(W,{placeholder:()=>this._performRender(!0)},()=>this._performRender(!1))}}class I extends o.Component{renderChildren(e){const{id:t,children:r}=this.props,s=e?e.get(I.defaultId):t;if(!s)throw new Error("Did not get an identifier factory nor a id prop");return r(s)}render(){const{id:e,scope:t}=this.props;return e?this.renderChildren():o.createElement(z,{scope:t,mockOnFirstRender:!0},r=>this.renderChildren(r))}}I.defaultId="wb-id";const E=()=>o.useContext(f),B=n=>{const e=E(),t=o.useRef(null);if(e===l.Root)throw new Error("Components using useUniqueIdWithMock() should be descendants of <RenderStateRoot>");return e===l.Initial?x:(t.current||(t.current=new S(n)),t.current)},{useEffect:U,useState:V}=C,K=({children:n,throwIfNested:e=!0})=>{const[t,r]=V(!0),s=E();if(U(()=>{r(!1)},[]),s!==l.Root){if(e)throw new Error("There's already a <RenderStateRoot> above this instance in the render tree.  This instance should be removed.");return o.createElement(o.Fragment,null,n)}const a=t?l.Initial:l.Standard;return o.createElement(f.Provider,{value:a},n)};export{I,K as R,L as T,z as U,M as V,y as a,B as u};
