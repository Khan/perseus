var Hn=Object.defineProperty;var On=(s,t,e)=>t in s?Hn(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var F=(s,t,e)=>(On(s,typeof t!="symbol"?t+"":t,e),e),ks=(s,t,e)=>{if(!t.has(s))throw TypeError("Cannot "+e)};var Ce=(s,t,e)=>(ks(s,t,"read from private field"),e?e.call(s):t.get(s)),Si=(s,t,e)=>{if(t.has(s))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(s):t.set(s,e)},Ti=(s,t,e,r)=>(ks(s,t,"write to private field"),r?r.call(s,e):t.set(s,e),e);import{j as At}from"./jsx-runtime-BT65X5dW.js";import{_ as w}from"./underscore-U-AHniOr.js";import{U as Qe}from"./core-widget-registry-C9bL1P7Y.js";import{P as jt,E as Ht}from"./perseus-error-CSETqePQ.js";import{C as zn}from"./index-fj4wzhGb.js";import{c as Bn}from"./index-D7h-teXI.js";import{$ as E}from"./jquery-CkHB0_Mt.js";import{r as ai}from"./index-C6mWTJJr.js";import{g as ne}from"./dependencies-BsVPGK1s.js";import{U as Rt,h as Qt,K as qt,r as Fn,j as ht,k as Ft,d as ft,z as Gn,m as Us,n as Ee,o as Ii,p as $t,q as _s,t as Yn,v as Zs,w as je,x as Xn,y as pe,A as Bi,B as Fi,C as Gi,D as Yi}from"./util-dAxPyTH2.js";import{F as Cs}from"./fixed-to-responsive-CTsII9Xx.js";import{e as qn}from"./index-BzwLglMS.js";import{c as Pe}from"./index-CjnMbH_2.js";import{R as Un}from"./index-CskvhqFA.js";import{c as Zn}from"./client-CAS5PaPY.js";import{I as Wn}from"./inline-icon-AJRwMA4Z.js";import{i as $n}from"./icon-paths-C3bPmxpL.js";import{I as Ke}from"./image-loader-CdkY-jNs.js";function Ps(s){return[(s[0][0]+s[1][0])/2,(s[0][1]+s[1][1])/2]}const De={log:(s,t)=>{ne().Log.log(s,t)},error:(s,t,e)=>{ne().Log.error(s,t,e)}},jn=/^file\+graphie:/,Kn=/\/([^/]+)$/;function Ws(){const{JIPT:s,kaLocale:t}=ne();return s.useJIPT?"en-pt":t}function As(){return Ws()!=="en"}const Jn=/\/(?=[^/]+$)/;function Qn(s){if(jn.test(s))return Rt.getDataUrl(s);const[t,e]=Rt.getBaseUrl(s).split(Jn);return`${t}/${Ws()}/${e}-data.json`}function to(s){const t=s.match(Kn);if(t==null)throw new jt("not a valid URL",Ht.InvalidInput);return t&&t[1]}function eo(s,t,e){const r=t.match(new RegExp(`^(?:svgData|svgOtherData)${s}\\((.+)\\);$`)),l=r?r[1]:t;try{return JSON.parse(l)}catch(h){return e(h),null}}const Je={};function io(s,t){const e=to(s),r=Je[e];if(r!=null)if(r.loaded){const{data:l,localized:h}=r;t(l,h)}else r.dataCallbacks.push(t);else{const l={loaded:!1,dataCallbacks:[t],localized:As()};Je[e]=l;const h=async(v,b)=>{const y=await fetch(v);if(!(y!=null&&y.ok)){b();return}const M=await y.text(),x=eo(e,M,_=>{De.error("Failed to parse JSONP for svg-image",Ht.Service,{cause:_,loggedMetadata:{dataUrl:Rt.getDataUrl(v),jsonp:M}})});if(!x)return;const S=Je[e]={...Je[e],loaded:!0,data:x};S.dataCallbacks.forEach(_=>{_(S.data,l.localized)})},d=(v,b,y)=>{De.error("Data load failed for svg-image",Ht.Service,{cause:y,loggedMetadata:{dataUrl:Rt.getDataUrl(s),status:b}})};As()?(l.localized=!1,h(Qn(s),()=>h(Rt.getDataUrl(s),d))):h(Rt.getDataUrl(s),d)}}function so(){const s=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(const e in t)if(s.style[e]!==void 0)return{end:t[e]};return!1}E.fn.emulateTransitionEnd=function(s){let t=!1;const e=this;return E(this).one("bsTransitionEnd",function(){t=!0}),setTimeout(function(){t||E(e).trigger(E.support.transition.end)},s),this};E(function(){E.support.transition=so(),E.support.transition&&(E.event.special.bsTransitionEnd={bindType:E.support.transition.end,delegateType:E.support.transition.end,handle:function(s){if(E(s.target).is(this))return s.handleObj.handler.apply(this,arguments)}})});function $s(s,t){const e=window.scrollX,r=window.scrollY,l=document.querySelector("meta[name=viewport]");l?l.setAttribute("content",s):E("head").append(`<meta name="viewport" content="${s}">`),document.body.style.opacity=.9999,setTimeout(()=>{document.body.style.opacity=1,window.scrollTo(e,r),t!=null&&setTimeout(t,0)},0)}function Ut(){}Ut.prototype._initialize=function(s){this._$document||(this._activeZoom=this._initialScrollPosition=this._initialTouchPosition=this._touchMoveListener=null,this._$document=E(document),this._$window=E(window),this._$body=E(document.body),this._boundClick=E.proxy(this._clickHandler,this),this._enableMobilePinch=s)};Ut.prototype.handleZoomClick=function(s,t){this._initialize(t);const e=s.target;if(!(!e||e.tagName!=="IMG")&&!this._$body.hasClass("zoom-overlay-open")){if(s.metaKey||s.ctrlKey)return window.open(s.target.src,"_blank");!t&&e.width>=window.innerWidth-Et.getOffset()||(this._activeZoomClose(!0),t?$s("width=device-width, initial-scale=1, minimum-scale=1",()=>this._zoom(e)):this._zoom(e),t||(this._$window.on("scroll.zoom",E.proxy(this._scrollHandler,this)),this._$document.on("keyup.zoom",E.proxy(this._keyHandler,this)),this._$document.on("touchstart.zoom",E.proxy(this._touchStart,this))),document.addEventListener("click",this._boundClick,!0),s.stopPropagation())}};Ut.prototype._zoom=function(s){this._activeZoom=new Et(s,this._enableMobilePinch),this._activeZoom.zoomImage()};Ut.prototype._activeZoomClose=function(s){this._activeZoom&&(s?(this._activeZoom.dispose(),this._disposeActiveZoom()):$s(`width=device-width, initial-scale=1, minimum-scale=1,
            maximum-scale=1`,()=>{this._activeZoom&&(this._activeZoom.close(),this._disposeActiveZoom())}))};Ut.prototype._disposeActiveZoom=function(){this._$window.off(".zoom"),this._$document.off(".zoom"),document.removeEventListener("click",this._boundClick,!0),this._activeZoom=null};Ut.prototype._scrollHandler=function(s){this._initialScrollPosition===null&&(this._initialScrollPosition=window.scrollY);const t=this._initialScrollPosition-window.scrollY;Math.abs(t)>=40&&this._activeZoomClose()};Ut.prototype._keyHandler=function(s){[27,13,32].includes(s.keyCode)&&this._activeZoomClose()};Ut.prototype._clickHandler=function(s){s.stopPropagation(),s.preventDefault(),this._activeZoomClose()};Ut.prototype._touchStart=function(s){this._initialTouchPosition=s.originalEvent.touches[0].pageY,E(s.target).on("touchmove.zoom",E.proxy(this._touchMove,this))};Ut.prototype._touchMove=function(s){Math.abs(s.originalEvent.touches[0].pageY-this._initialTouchPosition)>10&&(this._activeZoomClose(),E(s.target).off("touchmove.zoom"))};function Et(s,t){this._fullHeight=this._fullWidth=this._overlay=null,this._targetImage=s,this._enableMobilePinch=t,this._$body=E(document.body)}Et._OFFSET=80;Et._MAX_WIDTH=2560;Et._MAX_HEIGHT=4096;Et.getOffset=function(s){return s?0:Et._OFFSET};Et.prototype.getOffset=function(){return Et.getOffset(this._enableMobilePinch)};Et.prototype.zoomImage=function(){const s=document.createElement("img"),t=E(s);s.onload=(function(){this._fullHeight=Number(s.height),this._fullWidth=Number(s.width);const e=this._imageOffset=E(this._targetImage).offset(),r=this._left=e.left-E(window).scrollLeft(),l=this._top=e.top-E(window).scrollTop();t.css({left:r,top:l,width:this._targetImage.width,height:this._targetImage.height}),this._zoomOriginal()}).bind(this),s.src=this._targetImage.src,s.alt=this._targetImage.alt,s.tabIndex=0,s.role="button",this.$zoomedImage=t};Et.prototype._zoomOriginal=function(){var s,t,e;this.$zoomedImage.addClass("zoom-img").attr("data-action","zoom-out"),E(this._targetImage).css("visibility","hidden"),this._backdrop=document.createElement("div"),this._backdrop.className="zoom-backdrop",(s=document.body)==null||s.appendChild(this._backdrop),this._overlay=document.createElement("div"),this._overlay.className="zoom-overlay",(t=document.body)==null||t.appendChild(this._overlay),(e=this._overlay)==null||e.appendChild(this.$zoomedImage[0]),this._calculateZoom(),this._triggerAnimation()};Et.prototype._calculateZoom=function(){const s=this._fullWidth,t=this._fullHeight,e=window.innerHeight-this.getOffset(),r=window.innerWidth-this.getOffset(),l=s/this._targetImage.width,h=s/t,d=r/e;s<r&&t<e?this._imgScaleFactor=l:h<d?this._imgScaleFactor=e/t*l:this._imgScaleFactor=r/(s??0)*l};Et.prototype._triggerAnimation=function(){const s=E(window).scrollTop()+window.innerHeight/2,t=E(window).scrollLeft()+window.innerWidth/2,e=this._imgScaleFactor,r=this._imageOffset.top+this._targetImage.height/2,l=this._imageOffset.left+this._targetImage.width/2;this._translateY=(s-r)/e,this._translateX=(t-l)/e,this._zoomedInTransformString=`
        scale(${e})
        translate3d(${this._translateX}px, ${this._translateY}px, 0)
    `,this.$zoomedImage.css({transform:this._zoomedInTransformString}).addClass("zoom-transition").one(E.support.transition.end,E.proxy(this._onZoomInFinish,this)).emulateTransitionEnd(300),this._$body.addClass("zoom-overlay-open")};Et.prototype._onZoomInFinish=function(){const s=this._targetImage.height*this._imgScaleFactor,t=this._targetImage.width*this._imgScaleFactor;let e=0,r=0,l=0,h=0,d=0,v=0;t<window.innerWidth?(e="50%",l=-t/2):d=(t-window.innerWidth)/2,s<window.innerHeight?(r="50%",h=-s/2):v=(s-window.innerHeight)/2,this.$zoomedImage.css({height:s,left:e,marginLeft:l,marginTop:h,top:r,transform:"",width:t}).removeClass("zoom-transition"),E(this._overlay).scrollLeft(d).scrollTop(v)};Et.prototype.close=function(){this._$body.removeClass("zoom-overlay-open").addClass("zoom-overlay-transitioning"),this.$zoomedImage.css({height:this._targetImage.height,left:this._left,marginLeft:0,marginTop:0,top:this._top,transform:this._zoomedInTransformString,width:this._targetImage.width}).removeClass("zoom-transition"),E(this._overlay).scrollLeft(0).scrollTop(0),setTimeout(()=>{this.$zoomedImage.css({transform:"scale(1)"}).addClass("zoom-transition").one(E.support.transition.end,E.proxy(this.dispose,this)).emulateTransitionEnd(300)},10)};Et.prototype.dispose=function(){this.$zoomedImage&&this.$zoomedImage[0].parentNode&&(this.$zoomedImage.remove(),this.$zoomedImage=null,this._overlay.parentNode.removeChild(this._overlay),this._backdrop.parentNode.removeChild(this._backdrop),this._$body.removeClass("zoom-overlay-transitioning")),E(this._targetImage).css("visibility","visible"),this._targetImage.focus()};const no=new Ut;function Es(s,t){return s+":"+t}function oo(s){return s.split(":")[0]}const js={_fireEvent:function(s,...t){for(const e of s)e.call(this,...t)},_applyConstraints:function(s,t,e){let r=!1;return w.reduce(this.state.constraints,(l,h)=>{if(l===!1)return!1;if(r)return l;const d=h.call(this,l,t,{onSkipRemaining:()=>{r=!0},...e});if(d===!1)return!1;if(Qt(d,2))return d;if(d===!0||d==null)return l;throw new jt("Constraint returned invalid result: "+d,Ht.Internal)},s,this)},draw:function(){const s=this.cloneState();js._fireEvent.call(this,this.state.draw,s,this.prevState),this.prevState=s},listen:function(s,t,e){this._listenerMap=this._listenerMap||{};const r=Es(s,t),l=this._listenerMap[r]=this._listenerMap[r]||this.state[s].length;this.state[s][l]=e},unlisten:function(s,t){this._listenerMap=this._listenerMap||{};const e=Es(s,t),r=this._listenerMap[e];if(r!==void 0){this.state[s].splice(r,1),delete this._listenerMap[e];const l=w.keys(this._listenerMap);w.each(l,function(h){oo(h)===s&&this._listenerMap[h]>r&&this._listenerMap[h]--},this)}}};let ki=null;function ro(){const s=document.createElement("div"),t=["transform","msTransform","MozTransform","WebkitTransform","OTransform"];let e=null;return w.each(t,function(r){typeof s.style[r]<"u"&&(e=r)}),e}let _i=null;function ao(){const s=document.createElement("div"),t=kt.getPrefixedTransform();return s.style[t]="translateZ(0px)",!!s.style[t]}const lo=["add","modify","draw","remove","constraints","onMoveStart","onMove","onMoveEnd","onClick"],kt={assert:function(s,t){if(!s)throw new jt("Assertion Error"+(t?": "+t:""),Ht.Internal)},createGettersFor:function(s,t){w.each(w.keys(t),function(e){s.prototype[e]===void 0&&(s.prototype[e]=function(){return this.state[e]})})},addMovableHelperMethodsTo:function(s){w.each(js,function(t,e){s.prototype[e]===void 0&&(s.prototype[e]=t)})},arrayify:function(s){return s==null?[]:w.isArray(s)?w.filter(w.flatten(s),w.identity):[s]},normalizeOptions:function(s){const t={...s};return lo.forEach(function(e){s[e]!==void 0&&(t[e]=kt.arrayify(s[e]))}),t},getPrefixedTransform:function(){return ki=ki||ro(),ki},getCanUse3dTransform:function(){return _i==null&&(_i=ao()),_i}};/*!
 * Raphael 1.5.2 - JavaScript Vector Library
 *
 * Copyright (c) 2010 Dmitry Baranovskiy (http://raphaeljs.com)
 * Licensed under the MIT (http://raphaeljs.com/license.html) license.
 */const Jt=function(){var s;"".trim?s=function(n,i,o){n.setAttribute(i,String(o).trim())}:s=function(n,i,o){n.setAttribute(i,String(o))};function t(){if(t.is(arguments[0],mt)){for(var n=arguments[0],i=mi[_](t,n.splice(0,3+t.is(n[0],at))),o=i.set(),a=0,c=n[L];a<c;a++){var f=n[a]||{};r[d](f.type)&&o[K](i[f.type]().attr(f))}return o}return mi[_](t,arguments)}t.version="1.5.2";var e=/[, ]+/,r={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},l=/\{(\d+)\}/g,h="prototype",d="hasOwnProperty",v=document,b=window,y={was:Object[h][d].call(b,"Raphael"),is:b.Raphael},M=function(){this.customAttributes={}},x,S="appendChild",_="apply",A="concat",I="createTouch"in v,P="",H=" ",O=String,z="split",J="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend orientationchange touchcancel gesturestart gesturechange gestureend"[z](H),it={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},tt="join",L="length",rt=O[h].toLowerCase,q=Math,G=q.max,nt=q.min,ot=q.abs,j=q.pow,ct=q.PI,at="number",$="string",mt="array",Mt="toString",It="fill",ae=Object[h][Mt],K="push",xe=/^url\(['"]?([^\)]+?)['"]?\)$/i,Ve=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,hi={NaN:1,Infinity:1,"-Infinity":1},le=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,B=q.round,X=parseFloat,et=parseInt,pt=" progid:DXImageTransform.Microsoft",xt=O[h].toUpperCase,St={blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/",opacity:1,path:"M0,0",r:0,rotation:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",translation:"0 0",width:0,x:0,y:0},Ct={along:"along",blur:at,"clip-rect":"csv",cx:at,cy:at,fill:"colour","fill-opacity":at,"font-size":at,height:at,opacity:at,path:"path",r:at,rotation:"csv",rx:at,ry:at,scale:"csv",stroke:"colour","stroke-opacity":at,"stroke-width":at,translation:"csv",width:at,x:at,y:at},bt="replace",Me=/^(from|to|\d+%?)$/,oe=/\s*,\s*/,ce={hs:1,rg:1},He=/,?([achlmqrstvxz]),?/gi,gn=/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/ig,vn=/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/ig,Ui=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,bn=function(n,i){return n.key-i.key};if(t.type=b.SVGAngle||v.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML",t.type=="VML"){var ui=v.createElement("div"),Oe;if(ui.innerHTML='<v:shape adj="1"/>',Oe=ui.firstChild,Oe.style.behavior="url(#default#VML)",!(Oe&&typeof Oe.adj=="object"))return t.type=null;ui=null}t.svg=!(t.vml=t.type=="VML"),M[h]=t[h],x=M[h],t._id=0,t._oid=0,t.fn={},t.is=function(n,i){return i=rt.call(i),i=="finite"?!hi[d](+n):i=="null"&&n===null||i==typeof n||i=="object"&&n===Object(n)||i=="array"&&Array.isArray&&Array.isArray(n)||ae.call(n).slice(8,-1).toLowerCase()==i},t.angle=function(n,i,o,a,c,f){if(c==null){var p=n-o,u=i-a;return!p&&!u?0:((p<0)*180+q.atan(-u/-p)*180/ct+360)%360}else return t.angle(n,i,c,f)-t.angle(o,a,c,f)},t.rad=function(n){return n%360*ct/180},t.deg=function(n){return n*180/ct%360},t.snapTo=function(n,i,o){if(o=t.is(o,"finite")?o:10,t.is(n,mt)){for(var a=n.length;a--;)if(ot(n[a]-i)<=o)return n[a]}else{n=+n;var c=i%n;if(c<o)return i-c;if(c>n-o)return i-c+n}return i};function ze(){for(var n=[],i=0;i<32;i++)n[i]=(~~(q.random()*16))[Mt](16);return n[12]=4,n[16]=(n[16]&3|8)[Mt](16),"r-"+n[tt]("")}t.setWindow=function(n){b=n,v=b.document};var Be=function(n){if(t.vml){var i=/^\s+|\s+$/g,o;try{var a=new ActiveXObject("htmlfile");a.write("<body>"),a.close(),o=a.body}catch{o=createPopup().document.body}var c=o.createTextRange();Be=Gt(function(p){try{o.style.color=O(p)[bt](i,P);var u=c.queryCommandValue("ForeColor");return u=(u&255)<<16|u&65280|(u&16711680)>>>16,"#"+("000000"+u[Mt](16)).slice(-6)}catch{return"none"}})}else{var f=v.createElement("i");f.title="Raphaël Colour Picker",f.style.display="none",v.body[S](f),Be=Gt(function(p){return f.style.color=p,v.defaultView.getComputedStyle(f,P).getPropertyValue("color")})}return Be(n)},Zi=function(){return"hsb("+[this.h,this.s,this.b]+")"},yn=function(){return"hsl("+[this.h,this.s,this.l]+")"},wn=function(){return this.hex};t.hsb2rgb=function(n,i,o,a){return t.is(n,"object")&&"h"in n&&"s"in n&&"b"in n&&(o=n.b,i=n.s,n=n.h,a=n.o),t.hsl2rgb(n,i,o/2,a)},t.hsl2rgb=function(n,i,o,a){t.is(n,"object")&&"h"in n&&"s"in n&&"l"in n&&(o=n.l,i=n.s,n=n.h),(n>1||i>1||o>1)&&(n/=360,i/=100,o/=100);var c={},f=["r","g","b"],p,u,m;if(!i)c={r:o,g:o,b:o};else{o<.5?p=o*(1+i):p=o+i-o*i,u=2*o-p;for(var g=0;g<3;g++)m=n+1/3*-(g-1),m<0&&m++,m>1&&m--,m*6<1?c[f[g]]=u+(p-u)*6*m:m*2<1?c[f[g]]=p:m*3<2?c[f[g]]=u+(p-u)*(2/3-m)*6:c[f[g]]=u}return c.r*=255,c.g*=255,c.b*=255,c.hex="#"+(16777216|c.b|c.g<<8|c.r<<16).toString(16).slice(1),t.is(a,"finite")&&(c.opacity=a),c.toString=wn,c},t.rgb2hsb=function(n,i,o){if(i==null&&t.is(n,"object")&&"r"in n&&"g"in n&&"b"in n&&(o=n.b,i=n.g,n=n.r),i==null&&t.is(n,$)){var a=t.getRGB(n);n=a.r,i=a.g,o=a.b}(n>1||i>1||o>1)&&(n/=255,i/=255,o/=255);var c=G(n,i,o),f=nt(n,i,o),p,u,m=c;if(f==c)return{h:0,s:0,b:c,toString:Zi};var g=c-f;return u=g/c,n==c?p=(i-o)/g:i==c?p=2+(o-n)/g:p=4+(n-i)/g,p/=6,p<0&&p++,p>1&&p--,{h:p,s:u,b:m,toString:Zi}},t.rgb2hsl=function(n,i,o){if(i==null&&t.is(n,"object")&&"r"in n&&"g"in n&&"b"in n&&(o=n.b,i=n.g,n=n.r),i==null&&t.is(n,$)){var a=t.getRGB(n);n=a.r,i=a.g,o=a.b}(n>1||i>1||o>1)&&(n/=255,i/=255,o/=255);var c=G(n,i,o),f=nt(n,i,o),p,u,m=(c+f)/2,g;if(f==c)g={h:0,s:0,l:m};else{var T=c-f;u=m<.5?T/(c+f):T/(2-c-f),n==c?p=(i-o)/T:i==c?p=2+(o-n)/T:p=4+(n-i)/T,p/=6,p<0&&p++,p>1&&p--,g={h:p,s:u,l:m}}return g.toString=yn,g},t._path2string=function(){return this.join(",")[bt](He,"$1")};function Gt(n,i,o){function a(){var c=Array[h].slice.call(arguments,0),f=c[tt]("►"),p=a.cache=a.cache||{},u=a.count=a.count||[];return p[d](f)||(u[L]>=1e3&&delete p[u.shift()],u[K](f),p[f]=n[_](i,c)),o?o(p[f]):p[f]}return a}t.getRGB=Gt(function(n){if(!n||(n=O(n)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1};if(n=="none")return{r:-1,g:-1,b:-1,hex:"none"};!(ce[d](n.toLowerCase().substring(0,2))||n.charAt()=="#")&&(n=Be(n));var i,o,a,c,f,p,u=n.match(Ve);return u?(u[2]&&(a=et(u[2].substring(5),16),o=et(u[2].substring(3,5),16),i=et(u[2].substring(1,3),16)),u[3]&&(a=et((f=u[3].charAt(3))+f,16),o=et((f=u[3].charAt(2))+f,16),i=et((f=u[3].charAt(1))+f,16)),u[4]&&(p=u[4][z](oe),i=X(p[0]),p[0].slice(-1)=="%"&&(i*=2.55),o=X(p[1]),p[1].slice(-1)=="%"&&(o*=2.55),a=X(p[2]),p[2].slice(-1)=="%"&&(a*=2.55),u[1].toLowerCase().slice(0,4)=="rgba"&&(c=X(p[3])),p[3]&&p[3].slice(-1)=="%"&&(c/=100)),u[5]?(p=u[5][z](oe),i=X(p[0]),p[0].slice(-1)=="%"&&(i*=2.55),o=X(p[1]),p[1].slice(-1)=="%"&&(o*=2.55),a=X(p[2]),p[2].slice(-1)=="%"&&(a*=2.55),(p[0].slice(-3)=="deg"||p[0].slice(-1)=="°")&&(i/=360),u[1].toLowerCase().slice(0,4)=="hsba"&&(c=X(p[3])),p[3]&&p[3].slice(-1)=="%"&&(c/=100),t.hsb2rgb(i,o,a,c)):u[6]?(p=u[6][z](oe),i=X(p[0]),p[0].slice(-1)=="%"&&(i*=2.55),o=X(p[1]),p[1].slice(-1)=="%"&&(o*=2.55),a=X(p[2]),p[2].slice(-1)=="%"&&(a*=2.55),(p[0].slice(-3)=="deg"||p[0].slice(-1)=="°")&&(i/=360),u[1].toLowerCase().slice(0,4)=="hsla"&&(c=X(p[3])),p[3]&&p[3].slice(-1)=="%"&&(c/=100),t.hsl2rgb(i,o,a,c)):(u={r:i,g:o,b:a},u.hex="#"+(16777216|a|o<<8|i<<16).toString(16).slice(1),t.is(c,"finite")&&(u.opacity=c),u)):{r:-1,g:-1,b:-1,hex:"none",error:1}},t),t.getColor=function(n){var i=this.getColor.start=this.getColor.start||{h:0,s:1,b:n||.75},o=this.hsb2rgb(i.h,i.s,i.b);return i.h+=.075,i.h>1&&(i.h=0,i.s-=.2,i.s<=0&&(this.getColor.start={h:0,s:1,b:i.b})),o.hex},t.getColor.reset=function(){delete this.start},t.parsePathString=Gt(function(n){if(!n)return null;var i={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},o=[];return t.is(n,mt)&&t.is(n[0],mt)&&(o=Ge(n)),o[L]||O(n)[bt](gn,function(a,c,f){var p=[],u=rt.call(c);for(f[bt](vn,function(m,g){g&&p[K](+g)}),u=="m"&&p[L]>2&&(o[K]([c][A](p.splice(0,2))),u="l",c=c=="m"?"l":"L");p[L]>=i[u]&&(o[K]([c][A](p.splice(0,i[u]))),!!i[u]););}),o[Mt]=t._path2string,o}),t.findDotsAtSegment=function(n,i,o,a,c,f,p,u,m){var g=1-m,T=j(g,3)*n+j(g,2)*3*m*o+g*3*m*m*c+j(m,3)*p,D=j(g,3)*i+j(g,2)*3*m*a+g*3*m*m*f+j(m,3)*u,N=n+2*m*(o-n)+m*m*(c-2*o+n),V=i+2*m*(a-i)+m*m*(f-2*a+i),R=o+2*m*(c-o)+m*m*(p-2*c+o),C=a+2*m*(f-a)+m*m*(u-2*f+a),k=(1-m)*n+m*o,Z=(1-m)*i+m*a,U=(1-m)*c+m*p,st=(1-m)*f+m*u,W=90-q.atan((N-R)/(V-C))*180/ct;return(N>R||V<C)&&(W+=180),{x:T,y:D,m:{x:N,y:V},n:{x:R,y:C},start:{x:k,y:Z},end:{x:U,y:st},alpha:W}};var Fe=Gt(function(n){if(!n)return{x:0,y:0,width:0,height:0};n=qe(n);for(var i=0,o=0,a=[],c=[],f,p=0,u=n[L];p<u;p++)if(f=n[p],f[0]=="M")i=f[1],o=f[2],a[K](i),c[K](o);else{var m=xn(i,o,f[1],f[2],f[3],f[4],f[5],f[6]);a=a[A](m.min.x,m.max.x),c=c[A](m.min.y,m.max.y),i=f[5],o=f[6]}var g=nt[_](0,a),T=nt[_](0,c);return{x:g,y:T,width:G[_](0,a)-g,height:G[_](0,c)-T}}),Ge=function(n){var i=[];(!t.is(n,mt)||!t.is(n&&n[0],mt))&&(n=t.parsePathString(n));for(var o=0,a=n[L];o<a;o++){i[o]=[];for(var c=0,f=n[o][L];c<f;c++)i[o][c]=n[o][c]}return i[Mt]=t._path2string,i},di=Gt(function(n){(!t.is(n,mt)||!t.is(n&&n[0],mt))&&(n=t.parsePathString(n));var i=[],o=0,a=0,c=0,f=0,p=0;n[0][0]=="M"&&(o=n[0][1],a=n[0][2],c=o,f=a,p++,i[K](["M",o,a]));for(var u=p,m=n[L];u<m;u++){var g=i[u]=[],T=n[u];if(T[0]!=rt.call(T[0]))switch(g[0]=rt.call(T[0]),g[0]){case"a":g[1]=T[1],g[2]=T[2],g[3]=T[3],g[4]=T[4],g[5]=T[5],g[6]=+(T[6]-o).toFixed(3),g[7]=+(T[7]-a).toFixed(3);break;case"v":g[1]=+(T[1]-a).toFixed(3);break;case"m":c=T[1],f=T[2];default:for(var D=1,N=T[L];D<N;D++)g[D]=+(T[D]-(D%2?o:a)).toFixed(3)}else{g=i[u]=[],T[0]=="m"&&(c=T[1]+o,f=T[2]+a);for(var V=0,R=T[L];V<R;V++)i[u][V]=T[V]}var C=i[u][L];switch(i[u][0]){case"z":o=c,a=f;break;case"h":o+=+i[u][C-1];break;case"v":a+=+i[u][C-1];break;default:o+=+i[u][C-2],a+=+i[u][C-1]}}return i[Mt]=t._path2string,i},0,Ge),Se=Gt(function(n){(!t.is(n,mt)||!t.is(n&&n[0],mt))&&(n=t.parsePathString(n));var i=[],o=0,a=0,c=0,f=0,p=0;n[0][0]=="M"&&(o=+n[0][1],a=+n[0][2],c=o,f=a,p++,i[0]=["M",o,a]);for(var u=p,m=n[L];u<m;u++){var g=i[u]=[],T=n[u];if(T[0]!=xt.call(T[0]))switch(g[0]=xt.call(T[0]),g[0]){case"A":g[1]=T[1],g[2]=T[2],g[3]=T[3],g[4]=T[4],g[5]=T[5],g[6]=+(T[6]+o),g[7]=+(T[7]+a);break;case"V":g[1]=+T[1]+a;break;case"H":g[1]=+T[1]+o;break;case"M":c=+T[1]+o,f=+T[2]+a;default:for(var D=1,N=T[L];D<N;D++)g[D]=+T[D]+(D%2?o:a)}else for(var V=0,R=T[L];V<R;V++)i[u][V]=T[V];switch(g[0]){case"Z":o=c,a=f;break;case"H":o=g[1];break;case"V":a=g[1];break;case"M":c=i[u][i[u][L]-2],f=i[u][i[u][L]-1];default:o=i[u][i[u][L]-2],a=i[u][i[u][L]-1]}}return i[Mt]=t._path2string,i},null,Ge),Ye=function(n,i,o,a){return[n,i,o,a,o,a]},Wi=function(n,i,o,a,c,f){var p=.3333333333333333,u=2/3;return[p*n+u*o,p*i+u*a,p*c+u*o,p*f+u*a,c,f]},$i=function(n,i,o,a,c,f,p,u,m,g){var T=ct*120/180,D=ct/180*(+c||0),N=[],V,R=Gt(function(Ss,Ts,$e){var Nn=Ss*q.cos($e)-Ts*q.sin($e),Vn=Ss*q.sin($e)+Ts*q.cos($e);return{x:Nn,y:Vn}});if(g)wt=g[0],lt=g[1],vt=g[2],ut=g[3];else{V=R(n,i,-D),n=V.x,i=V.y,V=R(u,m,-D),u=V.x,m=V.y;var C=(n-u)/2,k=(i-m)/2,Z=C*C/(o*o)+k*k/(a*a);Z>1&&(Z=q.sqrt(Z),o=Z*o,a=Z*a);var U=o*o,st=a*a,W=(f==p?-1:1)*q.sqrt(ot((U*st-U*k*k-st*C*C)/(U*k*k+st*C*C))),vt=W*o*k/a+(n+u)/2,ut=W*-a*C/o+(i+m)/2,wt=q.asin(((i-ut)/a).toFixed(9)),lt=q.asin(((m-ut)/a).toFixed(9));wt=n<vt?ct-wt:wt,lt=u<vt?ct-lt:lt,wt<0&&(wt=ct*2+wt),lt<0&&(lt=ct*2+lt),p&&wt>lt&&(wt=wt-ct*2),!p&&lt>wt&&(lt=lt-ct*2)}var Tt=lt-wt;if(ot(Tt)>T){var Nt=lt,Yt=u,Zt=m;lt=wt+T*(p&&lt>wt?1:-1),u=vt+o*q.cos(lt),m=ut+a*q.sin(lt),N=$i(u,m,o,a,c,0,p,Yt,Zt,[lt,Nt,vt,ut])}Tt=lt-wt;var te=q.cos(wt),Pt=q.sin(wt),de=q.cos(lt),Vt=q.sin(lt),ee=q.tan(Tt/4),re=4/3*o*ee,bs=4/3*a*ee,ys=[n,i],fe=[n+re*Pt,i-bs*te],ws=[u+re*Vt,m-bs*de],xs=[u,m];if(fe[0]=2*ys[0]-fe[0],fe[1]=2*ys[1]-fe[1],g)return[fe,ws,xs][A](N);N=[fe,ws,xs][A](N)[tt]()[z](",");for(var Ms=[],ie=0,Dn=N[L];ie<Dn;ie++)Ms[ie]=ie%2?R(N[ie-1],N[ie],D).y:R(N[ie],N[ie+1],D).x;return Ms},Xe=function(n,i,o,a,c,f,p,u,m){var g=1-m;return{x:j(g,3)*n+j(g,2)*3*m*o+g*3*m*m*c+j(m,3)*p,y:j(g,3)*i+j(g,2)*3*m*a+g*3*m*m*f+j(m,3)*u}},xn=Gt(function(n,i,o,a,c,f,p,u){var m=c-2*o+n-(p-2*c+o),g=2*(o-n)-2*(c-o),T=n-o,D=(-g+q.sqrt(g*g-4*m*T))/2/m,N=(-g-q.sqrt(g*g-4*m*T))/2/m,V=[i,u],R=[n,p],C;return ot(D)>"1e12"&&(D=.5),ot(N)>"1e12"&&(N=.5),D>0&&D<1&&(C=Xe(n,i,o,a,c,f,p,u,D),R[K](C.x),V[K](C.y)),N>0&&N<1&&(C=Xe(n,i,o,a,c,f,p,u,N),R[K](C.x),V[K](C.y)),m=f-2*a+i-(u-2*f+a),g=2*(a-i)-2*(f-a),T=i-a,D=(-g+q.sqrt(g*g-4*m*T))/2/m,N=(-g-q.sqrt(g*g-4*m*T))/2/m,ot(D)>"1e12"&&(D=.5),ot(N)>"1e12"&&(N=.5),D>0&&D<1&&(C=Xe(n,i,o,a,c,f,p,u,D),R[K](C.x),V[K](C.y)),N>0&&N<1&&(C=Xe(n,i,o,a,c,f,p,u,N),R[K](C.x),V[K](C.y)),{min:{x:nt[_](0,R),y:nt[_](0,V)},max:{x:G[_](0,R),y:G[_](0,V)}}}),qe=Gt(function(n,i){for(var o=Se(n),a=i&&Se(i),c={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},f={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},p=function(C,k){var Z,U;if(!C)return["C",k.x,k.y,k.x,k.y,k.x,k.y];switch(!(C[0]in{T:1,Q:1})&&(k.qx=k.qy=null),C[0]){case"M":k.X=C[1],k.Y=C[2];break;case"A":C=["C"][A]($i[_](0,[k.x,k.y][A](C.slice(1))));break;case"S":Z=k.x+(k.x-(k.bx||k.x)),U=k.y+(k.y-(k.by||k.y)),C=["C",Z,U][A](C.slice(1));break;case"T":k.qx=k.x+(k.x-(k.qx||k.x)),k.qy=k.y+(k.y-(k.qy||k.y)),C=["C"][A](Wi(k.x,k.y,k.qx,k.qy,C[1],C[2]));break;case"Q":k.qx=C[1],k.qy=C[2],C=["C"][A](Wi(k.x,k.y,C[1],C[2],C[3],C[4]));break;case"L":C=["C"][A](Ye(k.x,k.y,C[1],C[2]));break;case"H":C=["C"][A](Ye(k.x,k.y,C[1],k.y));break;case"V":C=["C"][A](Ye(k.x,k.y,k.x,C[1]));break;case"Z":C=["C"][A](Ye(k.x,k.y,k.X,k.Y));break}return C},u=function(C,k){if(C[k][L]>7){C[k].shift();for(var Z=C[k];Z[L];)C.splice(k++,0,["C"][A](Z.splice(0,6)));C.splice(k,1),T=G(o[L],a&&a[L]||0)}},m=function(C,k,Z,U,st){C&&k&&C[st][0]=="M"&&k[st][0]!="M"&&(k.splice(st,0,["M",U.x,U.y]),Z.bx=0,Z.by=0,Z.x=C[st][1],Z.y=C[st][2],T=G(o[L],a&&a[L]||0))},g=0,T=G(o[L],a&&a[L]||0);g<T;g++){o[g]=p(o[g],c),u(o,g),a&&(a[g]=p(a[g],f)),a&&u(a,g),m(o,a,c,f,g),m(a,o,f,c,g);var D=o[g],N=a&&a[g],V=D[L],R=a&&N[L];c.x=D[V-2],c.y=D[V-1],c.bx=X(D[V-4])||c.x,c.by=X(D[V-3])||c.y,f.bx=a&&(X(N[R-4])||f.x),f.by=a&&(X(N[R-3])||f.y),f.x=a&&N[R-2],f.y=a&&N[R-1]}return a?[o,a]:o},null,Ge),ji=Gt(function(n){for(var i=[],o=0,a=n[L];o<a;o++){var c={},f=n[o].match(/^([^:]*):?([\d\.]*)/);if(c.color=t.getRGB(f[1]),c.color.error)return null;c.color=c.color.hex,f[2]&&(c.offset=f[2]+"%"),i[K](c)}for(o=1,a=i[L]-1;o<a;o++)if(!i[o].offset){for(var p=X(i[o-1].offset||0),u=0,m=o+1;m<a;m++)if(i[m].offset){u=i[m].offset;break}u||(u=100,m=a),u=X(u);for(var g=(u-p)/(m-o+1);o<m;o++)p+=g,i[o].offset=p+"%"}return i}),Ki=function(n,i,o,a){var c;if(t.is(n,$)||t.is(n,"object")){if(c=t.is(n,$)?v.getElementById(n):n,c.tagName)return i==null?{container:c,width:c.style.pixelWidth||c.offsetWidth,height:c.style.pixelHeight||c.offsetHeight}:{container:c,width:i,height:o}}else return{container:1,x:n,y:i,width:o,height:a}},fi=function(n,i){var o=this;for(var a in i)if(i[d](a)&&!(a in n))switch(typeof i[a]){case"function":(function(c){n[a]=n===o?c:function(){return c[_](o,arguments)}})(i[a]);break;case"object":n[a]=n[a]||{},fi.call(this,n[a],i[a]);break;default:n[a]=i[a];break}},he=function(n,i){n==i.top&&(i.top=n.prev),n==i.bottom&&(i.bottom=n.next),n.next&&(n.next.prev=n.prev),n.prev&&(n.prev.next=n.next)},Ji=function(n,i){i.top!==n&&(he(n,i),n.next=null,n.prev=i.top,i.top.next=n,i.top=n)},Qi=function(n,i){i.bottom!==n&&(he(n,i),n.next=i.bottom,n.prev=null,i.bottom.prev=n,i.bottom=n)},ts=function(n,i,o){he(n,o),i==o.top&&(o.top=n),i.next&&(i.next.prev=n),n.next=i.next,n.prev=i,i.next=n},es=function(n,i,o){he(n,o),i==o.bottom&&(o.bottom=n),i.prev&&(i.prev.next=n),n.prev=i.prev,i.prev=n,n.next=i},is=function(n){return function(){throw new Error("Raphaël: you are calling to method “"+n+"” of removed object")}};if(t.pathToRelative=di,t.svg){x.svgns="http://www.w3.org/2000/svg",x.xlink="http://www.w3.org/1999/xlink",B=function(n){return+n+(~~n===n)*.5};var Q=function(n,i){if(i)for(var o in i)i[d](o)&&s(n,o,O(i[o]));else return n=v.createElementNS(x.svgns,n),n.style.webkitTapHighlightColor="rgba(0,0,0,0)",n};t[Mt]=function(){return`Your browser supports SVG.
You are running Raphaël `+this.version};var ss=function(n,i){var o=Q("path");i.canvas&&i.canvas[S](o);var a=new gt(o,i);return a.type="path",Kt(a,{fill:"none",stroke:"#000",path:n}),a},Te=function(n,i,o){var a="linear",c=.5,f=.5,p=n.style;if(i=O(i)[bt](Ui,function(k,Z,U){if(a="radial",Z&&U){c=X(Z),f=X(U);var st=(f>.5)*2-1;j(c-.5,2)+j(f-.5,2)>.25&&(f=q.sqrt(.25-j(c-.5,2))*st+.5)&&f!=.5&&(f=f.toFixed(5)-1e-5*st)}return P}),i=i[z](/\s*\-\s*/),a=="linear"){var u=i.shift();if(u=-X(u),isNaN(u))return null;var m=[0,0,q.cos(u*ct/180),q.sin(u*ct/180)],g=1/(G(ot(m[2]),ot(m[3]))||1);m[2]*=g,m[3]*=g,m[2]<0&&(m[0]=-m[2],m[2]=0),m[3]<0&&(m[1]=-m[3],m[3]=0)}var T=ji(i);if(!T)return null;var D=n.getAttribute(It);D=D.match(/^url\(#(.*)\)$/),D&&o.defs.removeChild(v.getElementById(D[1]));var N=Q(a+"Gradient");N.id=ze(),Q(N,a=="radial"?{fx:c,fy:f}:{x1:m[0],y1:m[1],x2:m[2],y2:m[3]}),o.defs[S](N);for(var V=0,R=T[L];V<R;V++){var C=Q("stop");Q(C,{offset:T[V].offset?T[V].offset:V?"100%":"0%","stop-color":T[V].color||"#fff"}),N[S](C)}return Q(n,{fill:"url(#"+N.id+")",opacity:1,"fill-opacity":1}),p.fill=P,p.opacity=1,p.fillOpacity=1,1},pi=function(n){var i=n.getBBox();Q(n.pattern,{patternTransform:t.format("translate({0},{1})",i.x,i.y)})},Kt=function(n,i){var o={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},a=n.node,c=n.attrs,f=n.rotate(),p=function(lt,Tt){if(Tt=o[rt.call(Tt)],Tt){for(var Nt=lt.attrs["stroke-width"]||"1",Yt={round:Nt,square:Nt,butt:0}[lt.attrs["stroke-linecap"]||i["stroke-linecap"]]||0,Zt=[],te=Tt[L];te--;)Zt[te]=Tt[te]*Nt+(te%2?1:-1)*Yt;Q(a,{"stroke-dasharray":Zt[tt](",")})}};i[d]("rotation")&&(f=i.rotation);var u=O(f)[z](e);u.length-1?(u[1]=+u[1],u[2]=+u[2]):u=null,X(f)&&n.rotate(0,!0);for(var m in i)if(i[d](m)){if(!St[d](m))continue;var g=i[m];switch(c[m]=g,m){case"blur":n.blur(g);break;case"rotation":n.rotate(g,!0);break;case"href":case"title":case"target":var T=a.parentNode;if(rt.call(T.tagName)!="a"){var D=Q("a");T.insertBefore(D,a),D[S](a),T=D}m=="target"&&g=="blank"?T.setAttributeNS(n.paper.xlink,"show","new"):T.setAttributeNS(n.paper.xlink,m,g);break;case"cursor":a.style.cursor=g;break;case"clip-rect":var N=O(g)[z](e);if(N[L]==4){n.clip&&n.clip.parentNode.parentNode.removeChild(n.clip.parentNode);var V=Q("clipPath"),R=Q("rect");V.id=ze(),Q(R,{x:N[0],y:N[1],width:N[2],height:N[3]}),V[S](R),n.paper.defs[S](V),Q(a,{"clip-path":"url(#"+V.id+")"}),n.clip=R}if(!g){var C=v.getElementById(a.getAttribute("clip-path")[bt](/(^url\(#|\)$)/g,P));C&&C.parentNode.removeChild(C),Q(a,{"clip-path":P}),delete n.clip}break;case"path":n.type=="path"&&Q(a,{d:g?c.path=Se(g):"M0,0"});break;case"width":if(s(a,m,g),c.fx)m="x",g=c.x;else break;case"x":c.fx&&(g=-c.x-(c.width||0));case"rx":if(m=="rx"&&n.type=="rect")break;case"cx":u&&(m=="x"||m=="cx")&&(u[1]+=g-c[m]),s(a,m,g),n.pattern&&pi(n);break;case"height":if(s(a,m,g),c.fy)m="y",g=c.y;else break;case"y":c.fy&&(g=-c.y-(c.height||0));case"ry":if(m=="ry"&&n.type=="rect")break;case"cy":u&&(m=="y"||m=="cy")&&(u[2]+=g-c[m]),s(a,m,g),n.pattern&&pi(n);break;case"r":n.type=="rect"?Q(a,{rx:g,ry:g}):s(a,m,g);break;case"src":n.type=="image"&&a.setAttributeNS(n.paper.xlink,"href",g);break;case"stroke-width":a.style.strokeWidth=g,s(a,m,g),c["stroke-dasharray"]&&p(n,c["stroke-dasharray"]);break;case"stroke-dasharray":p(n,g);break;case"translation":var k=O(g)[z](e);k[0]=+k[0]||0,k[1]=+k[1]||0,u&&(u[1]+=k[0],u[2]+=k[1]),We.call(n,k[0],k[1]);break;case"scale":k=O(g)[z](e),n.scale(+k[0]||1,+k[1]||+k[0]||1,isNaN(X(k[2]))?null:+k[2],isNaN(X(k[3]))?null:+k[3]);break;case It:var Z=O(g).match(xe);if(Z){V=Q("pattern");var U=Q("image");V.id=ze(),Q(V,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),Q(U,{x:0,y:0}),U.setAttributeNS(n.paper.xlink,"href",Z[1]),V[S](U);var st=v.createElement("img");st.style.cssText="position:absolute;left:-9999em;top-9999em",st.onload=function(){Q(V,{width:this.offsetWidth,height:this.offsetHeight}),Q(U,{width:this.offsetWidth,height:this.offsetHeight}),v.body.removeChild(this),n.paper.safari()},v.body[S](st),st.src=Z[1],n.paper.defs[S](V),a.style.fill="url(#"+V.id+")",Q(a,{fill:"url(#"+V.id+")"}),n.pattern=V,n.pattern&&pi(n);break}var W=t.getRGB(g);if(!W.error)delete i.gradient,delete c.gradient,!t.is(c.opacity,"undefined")&&t.is(i.opacity,"undefined")&&Q(a,{opacity:c.opacity}),!t.is(c["fill-opacity"],"undefined")&&t.is(i["fill-opacity"],"undefined")&&Q(a,{"fill-opacity":c["fill-opacity"]});else if(({circle:1,ellipse:1}[d](n.type)||O(g).charAt()!="r")&&Te(a,g,n.paper)){c.gradient=g,c.fill="none";break}W[d]("opacity")&&Q(a,{"fill-opacity":W.opacity>1?W.opacity/100:W.opacity});case"stroke":W=t.getRGB(g),s(a,m,W.hex),m=="stroke"&&W[d]("opacity")&&Q(a,{"stroke-opacity":W.opacity>1?W.opacity/100:W.opacity});break;case"gradient":({circle:1,ellipse:1}[d](n.type)||O(g).charAt()!="r")&&Te(a,g,n.paper);break;case"opacity":c.gradient&&!c[d]("stroke-opacity")&&Q(a,{"stroke-opacity":g>1?g/100:g});case"fill-opacity":if(c.gradient){var vt=v.getElementById(a.getAttribute(It)[bt](/^url\(#|\)$/g,P));if(vt){var ut=vt.getElementsByTagName("stop");s(ut[ut[L]-1],"stop-opacity",g)}break}default:m=="font-size"&&(g=et(g,10)+"px");var wt=m[bt](/(\-.)/g,function(lt){return xt.call(lt.substring(1))});a.style[wt]=g,s(a,m,g);break}}Mn(n,i),u?n.rotate(u.join(H)):X(f)&&n.rotate(f,!0)},ns=1.2,Mn=function(n,i){if(!(n.type!="text"||!(i[d]("text")||i[d]("font")||i[d]("font-size")||i[d]("x")||i[d]("y")))){var o=n.attrs,a=n.node,c=a.firstChild?et(v.defaultView.getComputedStyle(a.firstChild,P).getPropertyValue("font-size"),10):10;if(i[d]("text")){for(o.text=i.text;a.firstChild;)a.removeChild(a.firstChild);for(var f=O(i.text)[z](`
`),p=0,u=f[L];p<u;p++)if(f[p]){var m=Q("tspan");p&&Q(m,{dy:c*ns,x:o.x}),m[S](v.createTextNode(f[p])),a[S](m)}}else for(f=a.getElementsByTagName("tspan"),p=0,u=f[L];p<u;p++)p&&Q(f[p],{dy:c*ns,x:o.x});Q(a,{y:o.y});var g=n.getBBox(),T=o.y-(g.y+g.height/2);T&&t.is(T,"finite")&&Q(a,{y:o.y+T})}},gt=function(n,i){this[0]=n,this.id=t._oid++,this.node=n,n.raphael=this,this.paper=i,this.attrs=this.attrs||{},this.transformations=[],this._={tx:0,ty:0,rt:{deg:0,cx:0,cy:0},sx:1,sy:1},!i.bottom&&(i.bottom=this),this.prev=i.top,i.top&&(i.top.next=this),i.top=this,this.next=null},dt=gt[h];gt[h].rotate=function(n,i,o){if(this.removed)return this;if(n==null)return this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][tt](H):this._.rt.deg;var a=this.getBBox();return n=O(n)[z](e),n[L]-1&&(i=X(n[1]),o=X(n[2])),n=X(n[0]),i!=null&&i!==!1?this._.rt.deg=n:this._.rt.deg+=n,o==null&&(i=null),this._.rt.cx=i,this._.rt.cy=o,i=i??a.x+a.width/2,o=o??a.y+a.height/2,this._.rt.deg?(this.transformations[0]=t.format("rotate({0} {1} {2})",this._.rt.deg,i,o),this.clip&&Q(this.clip,{transform:t.format("rotate({0} {1} {2})",-this._.rt.deg,i,o)})):(this.transformations[0]=P,this.clip&&Q(this.clip,{transform:P})),Q(this.node,{transform:this.transformations[tt](H)}),this},gt[h].hide=function(){return!this.removed&&(this.node.style.display="none"),this},gt[h].show=function(){return!this.removed&&(this.node.style.display=""),this},gt[h].remove=function(){if(!this.removed){he(this,this.paper),this.node.parentNode.removeChild(this.node);for(var n in this)delete this[n];this.removed=!0}},gt[h].getBBox=function(){if(this.removed)return this;if(this.type=="path")return Fe(this.attrs.path);if(this.node.style.display=="none"){this.show();var n=!0}var i={};try{i=this.node.getBBox()}catch{}finally{i=i||{}}if(this.type=="text"){i={x:i.x,y:1/0,width:0,height:0};for(var o=0,a=this.node.getNumberOfChars();o<a;o++){var c=this.node.getExtentOfChar(o);c.y<i.y&&(i.y=c.y),c.y+c.height-i.y>i.height&&(i.height=c.y+c.height-i.y),c.x+c.width-i.x>i.width&&(i.width=c.x+c.width-i.x)}}return n&&this.hide(),i},gt[h].attr=function(n,i){if(this.removed)return this;if(n==null){var o={};for(var a in this.attrs)this.attrs[d](a)&&(o[a]=this.attrs[a]);return this._.rt.deg&&(o.rotation=this.rotate()),(this._.sx!=1||this._.sy!=1)&&(o.scale=this.scale()),o.gradient&&o.fill=="none"&&(o.fill=o.gradient)&&delete o.gradient,o}if(i==null&&t.is(n,$))return n=="translation"?We.call(this):n=="rotation"?this.rotate():n=="scale"?this.scale():n==It&&this.attrs.fill=="none"&&this.attrs.gradient?this.attrs.gradient:this.attrs[n];if(i==null&&t.is(n,mt)){for(var c={},f=0,p=n.length;f<p;f++)c[n[f]]=this.attr(n[f]);return c}if(i!=null){var u={};u[n]=i}else n!=null&&t.is(n,"object")&&(u=n);for(var m in this.paper.customAttributes)if(this.paper.customAttributes[d](m)&&u[d](m)&&t.is(this.paper.customAttributes[m],"function")){var g=this.paper.customAttributes[m].apply(this,[][A](u[m]));this.attrs[m]=u[m];for(var T in g)g[d](T)&&(u[T]=g[T])}return Kt(this,u),this},gt[h].toFront=function(){if(this.removed)return this;this.node.parentNode[S](this.node);var n=this.paper;return n.top!=this&&Ji(this,n),this},gt[h].toBack=function(){return this.removed?this:(this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),Qi(this,this.paper),this.paper),this)},gt[h].insertAfter=function(n){if(this.removed)return this;var i=n.node||n[n.length-1].node;return i.nextSibling?i.parentNode.insertBefore(this.node,i.nextSibling):i.parentNode[S](this.node),ts(this,n,this.paper),this},gt[h].insertBefore=function(n){if(this.removed)return this;var i=n.node||n[0].node;return i.parentNode.insertBefore(this.node,i),es(this,n,this.paper),this},gt[h].blur=function(n){var i=this;if(+n!=0){var o=Q("filter"),a=Q("feGaussianBlur");i.attrs.blur=n,o.id=ze(),Q(a,{stdDeviation:+n||1.5}),o.appendChild(a),i.paper.defs.appendChild(o),i._blur=o,Q(i.node,{filter:"url(#"+o.id+")"})}else i._blur&&(i._blur.parentNode.removeChild(i._blur),delete i._blur,delete i.attrs.blur),i.node.removeAttribute("filter")};var os=function(n,i,o,a){var c=Q("circle");n.canvas&&n.canvas[S](c);var f=new gt(c,n);return f.attrs={cx:i,cy:o,r:a,fill:"none",stroke:"#000"},f.type="circle",Q(c,f.attrs),f},rs=function(n,i,o,a,c,f){var p=Q("rect");n.canvas&&n.canvas[S](p);var u=new gt(p,n);return u.attrs={x:i,y:o,width:a,height:c,r:f||0,rx:f||0,ry:f||0,fill:"none",stroke:"#000"},u.type="rect",Q(p,u.attrs),u},as=function(n,i,o,a,c){var f=Q("ellipse");n.canvas&&n.canvas[S](f);var p=new gt(f,n);return p.attrs={cx:i,cy:o,rx:a,ry:c,fill:"none",stroke:"#000"},p.type="ellipse",Q(f,p.attrs),p},ls=function(n,i,o,a,c,f){var p=Q("image");Q(p,{x:o,y:a,width:c,height:f,preserveAspectRatio:"none"}),p.setAttributeNS(n.xlink,"href",i),n.canvas&&n.canvas[S](p);var u=new gt(p,n);return u.attrs={x:o,y:a,width:c,height:f,src:i},u.type="image",u},cs=function(n,i,o,a){var c=Q("text");Q(c,{x:i,y:o,"text-anchor":"middle"}),n.canvas&&n.canvas[S](c);var f=new gt(c,n);return f.attrs={x:i,y:o,"text-anchor":"middle",text:a,font:St.font,stroke:"none",fill:"#000"},f.type="text",Kt(f,f.attrs),f},hs=function(n,i){return this.width=n||this.width,this.height=i||this.height,s(this.canvas,"width",this.width),s(this.canvas,"height",this.height),this},mi=function(){var n=Ki[_](0,arguments),i=n&&n.container,o=n.x,a=n.y,c=n.width,f=n.height;if(!i)throw new Error("SVG container not found.");var p=Q("svg");return o=o||0,a=a||0,c=c||512,f=f||342,Q(p,{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:c,height:f}),i==1?(p.style.cssText="position:absolute;left:"+o+"px;top:"+a+"px",v.body[S](p)):i.firstChild?i.insertBefore(p,i.firstChild):i[S](p),i=new M,i.width=c,i.height=f,i.canvas=p,fi.call(i,i,t.fn),i.clear(),i};x.clear=function(){for(var n=this.canvas;n.firstChild;)n.removeChild(n.firstChild);this.bottom=this.top=null,(this.desc=Q("desc"))[S](v.createTextNode("Created with Raphaël")),n[S](this.desc),n[S](this.defs=Q("defs"))},x.remove=function(){this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var n in this)this[n]=is(n)}}if(t.vml){let n=function(i,o,a,c,f){return f?t.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",i+f,o,a-f*2,f,-f,c-f*2,f*2-a,f*2-c):t.format("M{0},{1}l{2},0,0,{3},{4},0z",i,o,a,c,-a)};var us={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},Sn=/([clmz]),?([^clmz]*)/gi,Tn=/ progid:\S+Blur\([^\)]+\)/g,kn=/-?[^,\s-]+/g,ke=1e3+H+1e3,ue=10,_e={path:1,rect:1},_n=function(i){var o=/[ahqstv]/ig,a=Se;if(O(i).match(o)&&(a=qe),o=/[clmz]/g,a==Se&&!O(i).match(o)){var c=O(i)[bt](Sn,function(N,V,R){var C=[],k=rt.call(V)=="m",Z=us[V];return R[bt](kn,function(U){k&&C[L]==2&&(Z+=C+us[V=="m"?"l":"L"],C=[]),C[K](B(U*ue))}),Z+C});return c}var f=a(i),p,u;c=[];for(var m=0,g=f[L];m<g;m++){p=f[m],u=rt.call(f[m][0]),u=="z"&&(u="x");for(var T=1,D=p[L];T<D;T++)u+=B(p[T]*ue)+(T!=D-1?",":P);c[K](u)}return c[tt](H)};t[Mt]=function(){return`Your browser doesn’t support SVG. Falling down to VML.
You are running Raphaël `+this.version},ss=function(i,o){var a=_t("group");a.style.cssText="position:absolute;left:0;top:0;width:"+o.width+"px;height:"+o.height+"px",a.coordsize=o.coordsize,a.coordorigin=o.coordorigin;var c=_t("shape"),f=c.style;f.width=o.width+"px",f.height=o.height+"px",c.coordsize=ke,c.coordorigin=o.coordorigin,a[S](c);var p=new gt(c,a,o),u={fill:"none",stroke:"#000"};return i&&(u.path=i),p.type="path",p.path=[],p.Path=P,Kt(p,u),o.canvas[S](a),p},Kt=function(i,o){i.attrs=i.attrs||{};var a=i.node,c=i.attrs,f=a.style,p,u=(o.x!=c.x||o.y!=c.y||o.width!=c.width||o.height!=c.height||o.r!=c.r)&&i.type=="rect",m=i;for(var g in o)o[d](g)&&(c[g]=o[g]);if(u&&(c.path=n(c.x,c.y,c.width,c.height,c.r),i.X=c.x,i.Y=c.y,i.W=c.width,i.H=c.height),o.href&&(a.href=o.href),o.title&&(a.title=o.title),o.target&&(a.target=o.target),o.cursor&&(f.cursor=o.cursor),"blur"in o&&i.blur(o.blur),(o.path&&i.type=="path"||u)&&(a.path=_n(c.path)),o.rotation!=null&&i.rotate(o.rotation,!0),o.translation&&(p=O(o.translation)[z](e),We.call(i,p[0],p[1]),i._.rt.cx!=null&&(i._.rt.cx+=+p[0],i._.rt.cy+=+p[1],i.setBox(i.attrs,p[0],p[1]))),o.scale&&(p=O(o.scale)[z](e),i.scale(+p[0]||1,+p[1]||+p[0]||1,+p[2]||null,+p[3]||null)),"clip-rect"in o){var T=O(o["clip-rect"])[z](e);if(T[L]==4){T[2]=+T[2]+ +T[0],T[3]=+T[3]+ +T[1];var D=a.clipRect||v.createElement("div"),N=D.style,V=a.parentNode;N.clip=t.format("rect({1}px {2}px {3}px {0}px)",T),a.clipRect||(N.position="absolute",N.top=0,N.left=0,N.width=i.paper.width+"px",N.height=i.paper.height+"px",V.parentNode.insertBefore(D,V),D[S](V),a.clipRect=D)}o["clip-rect"]||a.clipRect&&(a.clipRect.style.clip=P)}if(i.type=="image"&&o.src&&(a.src=o.src),i.type=="image"&&o.opacity&&(a.filterOpacity=pt+".Alpha(opacity="+o.opacity*100+")",f.filter=(a.filterMatrix||P)+(a.filterOpacity||P)),o.font&&(f.font=o.font),o["font-family"]&&(f.fontFamily='"'+o["font-family"][z](",")[0][bt](/^['"]+|['"]+$/g,P)+'"'),o["font-size"]&&(f.fontSize=o["font-size"]),o["font-weight"]&&(f.fontWeight=o["font-weight"]),o["font-style"]&&(f.fontStyle=o["font-style"]),o.opacity!=null||o["stroke-width"]!=null||o.fill!=null||o.stroke!=null||o["stroke-width"]!=null||o["stroke-opacity"]!=null||o["fill-opacity"]!=null||o["stroke-dasharray"]!=null||o["stroke-miterlimit"]!=null||o["stroke-linejoin"]!=null||o["stroke-linecap"]!=null){a=i.shape||a;var R=a.getElementsByTagName(It)&&a.getElementsByTagName(It)[0],C=!1;if(!R&&(C=R=_t(It)),"fill-opacity"in o||"opacity"in o){var k=((+c["fill-opacity"]+1||2)-1)*((+c.opacity+1||2)-1)*((+t.getRGB(o.fill).o+1||2)-1);k=nt(G(k,0),1),R.opacity=k}if(o.fill&&(R.on=!0),(R.on==null||o.fill=="none")&&(R.on=!1),R.on&&o.fill){var Z=o.fill.match(xe);Z?(R.src=Z[1],R.type="tile"):(R.color=t.getRGB(o.fill).hex,R.src=P,R.type="solid",t.getRGB(o.fill).error&&(m.type in{circle:1,ellipse:1}||O(o.fill).charAt()!="r")&&Te(m,o.fill)&&(c.fill="none",c.gradient=o.fill))}C&&a[S](R);var U=a.getElementsByTagName("stroke")&&a.getElementsByTagName("stroke")[0],st=!1;!U&&(st=U=_t("stroke")),(o.stroke&&o.stroke!="none"||o["stroke-width"]||o["stroke-opacity"]!=null||o["stroke-dasharray"]||o["stroke-miterlimit"]||o["stroke-linejoin"]||o["stroke-linecap"])&&(U.on=!0),(o.stroke=="none"||U.on==null||o.stroke==0||o["stroke-width"]==0)&&(U.on=!1);var W=t.getRGB(o.stroke);U.on&&o.stroke&&(U.color=W.hex),k=((+c["stroke-opacity"]+1||2)-1)*((+c.opacity+1||2)-1)*((+W.o+1||2)-1);var vt=(X(o["stroke-width"])||1)*.75;if(k=nt(G(k,0),1),o["stroke-width"]==null&&(vt=c["stroke-width"]),o["stroke-width"]&&(U.weight=vt),vt&&vt<1&&(k*=vt)&&(U.weight=1),U.opacity=k,o["stroke-linejoin"]&&(U.joinstyle=o["stroke-linejoin"]||"miter"),U.miterlimit=o["stroke-miterlimit"]||8,o["stroke-linecap"]&&(U.endcap=o["stroke-linecap"]=="butt"?"flat":o["stroke-linecap"]=="square"?"square":"round"),o["stroke-dasharray"]){var ut={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};U.dashstyle=ut[d](o["stroke-dasharray"])?ut[o["stroke-dasharray"]]:P}st&&a[S](U)}if(m.type=="text")switch(f=m.paper.span.style,c.font&&(f.font=c.font),c["font-family"]&&(f.fontFamily=c["font-family"]),c["font-size"]&&(f.fontSize=c["font-size"]),c["font-weight"]&&(f.fontWeight=c["font-weight"]),c["font-style"]&&(f.fontStyle=c["font-style"]),m.node.string&&(m.paper.span.innerHTML=O(m.node.string)[bt](/</g,"&#60;")[bt](/&/g,"&#38;")[bt](/\n/g,"<br>")),m.W=c.w=m.paper.span.offsetWidth,m.H=c.h=m.paper.span.offsetHeight,m.X=c.x,m.Y=c.y+B(m.H/2),c["text-anchor"]){case"start":m.node.style["v-text-align"]="left",m.bbx=B(m.W/2);break;case"end":m.node.style["v-text-align"]="right",m.bbx=-B(m.W/2);break;default:m.node.style["v-text-align"]="center";break}},Te=function(i,o){i.attrs=i.attrs||{},i.attrs;var a,c="linear",f=".5 .5";if(i.attrs.gradient=o,o=O(o)[bt](Ui,function(D,N,V){return c="radial",N&&V&&(N=X(N),V=X(V),j(N-.5,2)+j(V-.5,2)>.25&&(V=q.sqrt(.25-j(N-.5,2))*((V>.5)*2-1)+.5),f=N+H+V),P}),o=o[z](/\s*\-\s*/),c=="linear"){var p=o.shift();if(p=-X(p),isNaN(p))return null}var u=ji(o);if(!u)return null;if(i=i.shape||i.node,a=i.getElementsByTagName(It)[0]||_t(It),!a.parentNode&&i.appendChild(a),u[L]){a.on=!0,a.method="none",a.color=u[0].color,a.color2=u[u[L]-1].color;for(var m=[],g=0,T=u[L];g<T;g++)u[g].offset&&m[K](u[g].offset+H+u[g].color);a.colors&&(a.colors.value=m[L]?m[tt]():"0% "+a.color),c=="radial"?(a.type="gradientradial",a.focus="100%",a.focussize=f,a.focusposition=f):(a.type="gradient",a.angle=(270-p)%360)}return 1},gt=function(i,o,a){this[0]=i,this.id=t._oid++,this.node=i,i.raphael=this,this.X=0,this.Y=0,this.attrs={},this.Group=o,this.paper=a,this._={tx:0,ty:0,rt:{deg:0},sx:1,sy:1},!a.bottom&&(a.bottom=this),this.prev=a.top,a.top&&(a.top.next=this),a.top=this,this.next=null},dt=gt[h],dt.rotate=function(i,o,a){return this.removed?this:i==null?this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][tt](H):this._.rt.deg:(i=O(i)[z](e),i[L]-1&&(o=X(i[1]),a=X(i[2])),i=X(i[0]),o!=null?this._.rt.deg=i:this._.rt.deg+=i,a==null&&(o=null),this._.rt.cx=o,this._.rt.cy=a,this.setBox(this.attrs,o,a),this.Group.style.rotation=this._.rt.deg,this)},dt.setBox=function(i,o,a){if(this.removed)return this;var c=this.Group.style,f=this.shape&&this.shape.style||this.node.style;i=i||{};for(var p in i)i[d](p)&&(this.attrs[p]=i[p]);o=o||this._.rt.cx,a=a||this._.rt.cy;var u=this.attrs,m,g,T,D;switch(this.type){case"circle":m=u.cx-u.r,g=u.cy-u.r,T=D=u.r*2;break;case"ellipse":m=u.cx-u.rx,g=u.cy-u.ry,T=u.rx*2,D=u.ry*2;break;case"image":m=+u.x,g=+u.y,T=u.width||0,D=u.height||0;break;case"text":this.textpath.v=["m",B(u.x),", ",B(u.y-2),"l",B(u.x)+1,", ",B(u.y-2)][tt](P),m=u.x-B(this.W/2),g=u.y-this.H/2,T=this.W,D=this.H;break;case"rect":case"path":if(!this.attrs.path)m=0,g=0,T=this.paper.width,D=this.paper.height;else{var N=Fe(this.attrs.path);m=N.x,g=N.y,T=N.width,D=N.height}break;default:m=0,g=0,T=this.paper.width,D=this.paper.height;break}o=o??m+T/2,a=a??g+D/2;var V=o-this.paper.width/2,R=a-this.paper.height/2,C;c.left!=(C=V+"px")&&(c.left=C),c.top!=(C=R+"px")&&(c.top=C),this.X=_e[d](this.type)?-V:m,this.Y=_e[d](this.type)?-R:g,this.W=T,this.H=D,_e[d](this.type)?(f.left!=(C=-V*ue+"px")&&(f.left=C),f.top!=(C=-R*ue+"px")&&(f.top=C)):this.type=="text"?(f.left!=(C=-V+"px")&&(f.left=C),f.top!=(C=-R+"px")&&(f.top=C)):(c.width!=(C=this.paper.width+"px")&&(c.width=C),c.height!=(C=this.paper.height+"px")&&(c.height=C),f.left!=(C=m-V+"px")&&(f.left=C),f.top!=(C=g-R+"px")&&(f.top=C),f.width!=(C=T+"px")&&(f.width=C),f.height!=(C=D+"px")&&(f.height=C))},dt.hide=function(){return!this.removed&&(this.Group.style.display="none"),this},dt.show=function(){return!this.removed&&(this.Group.style.display="block"),this},dt.getBBox=function(){return this.removed?this:_e[d](this.type)?Fe(this.attrs.path):{x:this.X+(this.bbx||0),y:this.Y,width:this.W,height:this.H}},dt.remove=function(){if(!this.removed){he(this,this.paper),this.node.parentNode.removeChild(this.node),this.Group.parentNode.removeChild(this.Group),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var i in this)delete this[i];this.removed=!0}},dt.attr=function(i,o){if(this.removed)return this;if(i==null){var a={};for(var c in this.attrs)this.attrs[d](c)&&(a[c]=this.attrs[c]);return this._.rt.deg&&(a.rotation=this.rotate()),(this._.sx!=1||this._.sy!=1)&&(a.scale=this.scale()),a.gradient&&a.fill=="none"&&(a.fill=a.gradient)&&delete a.gradient,a}if(o==null&&t.is(i,"string"))return i=="translation"?We.call(this):i=="rotation"?this.rotate():i=="scale"?this.scale():i==It&&this.attrs.fill=="none"&&this.attrs.gradient?this.attrs.gradient:this.attrs[i];if(this.attrs&&o==null&&t.is(i,mt)){var f,p={};for(c=0,f=i[L];c<f;c++)p[i[c]]=this.attr(i[c]);return p}var u;if(o!=null&&(u={},u[i]=o),o==null&&t.is(i,"object")&&(u=i),u){for(var m in this.paper.customAttributes)if(this.paper.customAttributes[d](m)&&u[d](m)&&t.is(this.paper.customAttributes[m],"function")){var g=this.paper.customAttributes[m].apply(this,[][A](u[m]));this.attrs[m]=u[m];for(var T in g)g[d](T)&&(u[T]=g[T])}u.text&&this.type=="text"&&(this.node.string=u.text),Kt(this,u),u.gradient&&({circle:1,ellipse:1}[d](this.type)||O(u.gradient).charAt()!="r")&&Te(this,u.gradient),(!_e[d](this.type)||this._.rt.deg)&&this.setBox(this.attrs)}return this},dt.toFront=function(){return!this.removed&&this.Group.parentNode[S](this.Group),this.paper.top!=this&&Ji(this,this.paper),this},dt.toBack=function(){return this.removed?this:(this.Group.parentNode.firstChild!=this.Group&&(this.Group.parentNode.insertBefore(this.Group,this.Group.parentNode.firstChild),Qi(this,this.paper)),this)},dt.insertAfter=function(i){return this.removed?this:(i.constructor==Lt&&(i=i[i.length-1]),i.Group.nextSibling?i.Group.parentNode.insertBefore(this.Group,i.Group.nextSibling):i.Group.parentNode[S](this.Group),ts(this,i,this.paper),this)},dt.insertBefore=function(i){return this.removed?this:(i.constructor==Lt&&(i=i[0]),i.Group.parentNode.insertBefore(this.Group,i.Group),es(this,i,this.paper),this)},dt.blur=function(i){var o=this.node.runtimeStyle,a=o.filter;a=a.replace(Tn,P),+i!=0?(this.attrs.blur=i,o.filter=a+H+pt+".Blur(pixelradius="+(+i||1.5)+")",o.margin=t.format("-{0}px 0 0 -{0}px",B(+i||1.5))):(o.filter=a,o.margin=0,delete this.attrs.blur)},os=function(i,o,a,c){var f=_t("group"),p=_t("oval");p.style,f.style.cssText="position:absolute;left:0;top:0;width:"+i.width+"px;height:"+i.height+"px",f.coordsize=ke,f.coordorigin=i.coordorigin,f[S](p);var u=new gt(p,f,i);return u.type="circle",Kt(u,{stroke:"#000",fill:"none"}),u.attrs.cx=o,u.attrs.cy=a,u.attrs.r=c,u.setBox({x:o-c,y:a-c,width:c*2,height:c*2}),i.canvas[S](f),u},rs=function(i,o,a,c,f,p){var u=n(o,a,c,f,p),m=i.path(u),g=m.attrs;return m.X=g.x=o,m.Y=g.y=a,m.W=g.width=c,m.H=g.height=f,g.r=p,g.path=u,m.type="rect",m},as=function(i,o,a,c,f){var p=_t("group"),u=_t("oval");u.style,p.style.cssText="position:absolute;left:0;top:0;width:"+i.width+"px;height:"+i.height+"px",p.coordsize=ke,p.coordorigin=i.coordorigin,p[S](u);var m=new gt(u,p,i);return m.type="ellipse",Kt(m,{stroke:"#000"}),m.attrs.cx=o,m.attrs.cy=a,m.attrs.rx=c,m.attrs.ry=f,m.setBox({x:o-c,y:a-f,width:c*2,height:f*2}),i.canvas[S](p),m},ls=function(i,o,a,c,f,p){var u=_t("group"),m=_t("image");u.style.cssText="position:absolute;left:0;top:0;width:"+i.width+"px;height:"+i.height+"px",u.coordsize=ke,u.coordorigin=i.coordorigin,m.src=o,u[S](m);var g=new gt(m,u,i);return g.type="image",g.attrs.src=o,g.attrs.x=a,g.attrs.y=c,g.attrs.w=f,g.attrs.h=p,g.setBox({x:a,y:c,width:f,height:p}),i.canvas[S](u),g},cs=function(i,o,a,c){var f=_t("group"),p=_t("shape"),u=p.style,m=_t("path");m.style;var g=_t("textpath");f.style.cssText="position:absolute;left:0;top:0;width:"+i.width+"px;height:"+i.height+"px",f.coordsize=ke,f.coordorigin=i.coordorigin,m.v=t.format("m{0},{1}l{2},{1}",B(o*10),B(a*10),B(o*10)+1),m.textpathok=!0,u.width=i.width,u.height=i.height,g.string=O(c),g.on=!0,p[S](g),p[S](m),f[S](p);var T=new gt(g,f,i);return T.shape=p,T.textpath=m,T.type="text",T.attrs.text=c,T.attrs.x=o,T.attrs.y=a,T.attrs.w=1,T.attrs.h=1,Kt(T,{font:St.font,stroke:"none",fill:"#000"}),T.setBox(),i.canvas[S](f),T},hs=function(i,o){var a=this.canvas.style;return i==+i&&(i+="px"),o==+o&&(o+="px"),a.width=i,a.height=o,a.clip="rect(0 "+i+" "+o+" 0)",this};var _t;v.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!v.namespaces.rvml&&v.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),_t=function(i){return v.createElement("<rvml:"+i+' class="rvml">')}}catch{_t=function(o){return v.createElement("<"+o+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}mi=function(){var i=Ki[_](0,arguments),o=i.container,a=i.height,c=i.width,f=i.x,p=i.y;if(!o)throw new Error("VML container not found.");var u=new M,m=u.canvas=v.createElement("div"),g=m.style;return f=f||0,p=p||0,c=c||512,a=a||342,c==+c&&(c+="px"),a==+a&&(a+="px"),u.width=1e3,u.height=1e3,u.coordsize=ue*1e3+H+ue*1e3,u.coordorigin="0 0",u.span=v.createElement("span"),u.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",m[S](u.span),g.cssText=t.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",c,a),o==1?(v.body[S](m),g.left=f+"px",g.top=p+"px",g.position="absolute"):o.firstChild?o.insertBefore(m,o.firstChild):o[S](m),fi.call(u,u,t.fn),u},x.clear=function(){this.canvas.innerHTML=P,this.span=v.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas[S](this.span),this.bottom=this.top=null},x.remove=function(){this.canvas.parentNode.removeChild(this.canvas);for(var i in this)this[i]=is(i);return!0}}var ds=navigator.userAgent.match(/Version\/(.*?)\s/);navigator.vendor=="Apple Computer, Inc."&&(ds&&ds[1]<4||navigator.platform.slice(0,2)=="iP")?x.safari=function(){var n=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});b.setTimeout(function(){n.remove()})}:x.safari=function(){};for(var Cn=function(){this.returnValue=!1},Pn=function(){return this.originalEvent.preventDefault()},An=function(){this.cancelBubble=!0},En=function(){return this.originalEvent.stopPropagation()},In=function(){if(v.addEventListener)return function(n,i,o,a){var c=I&&it[i]?it[i]:i,f=function(p){if(I&&it[d](i)){for(var u=0,m=p.targetTouches&&p.targetTouches.length;u<m;u++)if(p.targetTouches[u].target==n){var g=p;p=p.targetTouches[u],p.originalEvent=g,p.preventDefault=Pn,p.stopPropagation=En;break}}return o.call(a,p)};return n.addEventListener(c,f,!1),function(){return n.removeEventListener(c,f,!1),!0}};if(v.attachEvent)return function(n,i,o,a){var c=function(p){return p=p||b.event,p.preventDefault=p.preventDefault||Cn,p.stopPropagation=p.stopPropagation||An,o.call(a,p)};n.attachEvent("on"+i,c);var f=function(){return n.detachEvent("on"+i,c),!0};return f}}(),Ot=[],gi=function(n){for(var i=n.clientX,o=n.clientY,a=v.documentElement.scrollTop||v.body.scrollTop,c=v.documentElement.scrollLeft||v.body.scrollLeft,f,p=Ot.length;p--;){if(f=Ot[p],I){for(var u=n.touches.length,m;u--;)if(m=n.touches[u],m.identifier==f.el._drag.id){i=m.clientX,o=m.clientY,(n.originalEvent?n.originalEvent:n).preventDefault();break}}else n.preventDefault();i+=c,o+=a,f.move&&f.move.call(f.move_scope||f.el,i-f.el._drag.x,o-f.el._drag.y,i,o,n)}},vi=function(n){t.unmousemove(gi).unmouseup(vi);for(var i=Ot.length,o;i--;)o=Ot[i],o.el._drag={},o.end&&o.end.call(o.end_scope||o.start_scope||o.move_scope||o.el,n);Ot=[]},fs=J[L];fs--;)(function(n){t[n]=gt[h][n]=function(i,o){return t.is(i,"function")&&(this.events=this.events||[],this.events.push({name:n,f:i,unbind:In(this.shape||this.node||v,n,i,o||this)})),this},t["un"+n]=gt[h]["un"+n]=function(i){for(var o=this.events,a=o[L];a--;)if(o[a].name==n&&o[a].f==i)return o[a].unbind(),o.splice(a,1),!o.length&&delete this.events,this;return this}})(J[fs]);dt.hover=function(n,i,o,a){return this.mouseover(n,o).mouseout(i,a||o)},dt.unhover=function(n,i){return this.unmouseover(n).unmouseout(i)},dt.drag=function(n,i,o,a,c,f){return this._drag={},this.mousedown(function(p){(p.originalEvent||p).preventDefault();var u=v.documentElement.scrollTop||v.body.scrollTop,m=v.documentElement.scrollLeft||v.body.scrollLeft;this._drag.x=p.clientX+m,this._drag.y=p.clientY+u,this._drag.id=p.identifier,i&&i.call(c||a||this,p.clientX+m,p.clientY+u,p),!Ot.length&&t.mousemove(gi).mouseup(vi),Ot.push({el:this,move:n,end:o,move_scope:a,start_scope:c,end_scope:f})}),this},dt.undrag=function(n,i,o){for(var a=Ot.length;a--;)Ot[a].el==this&&Ot[a].move==n&&Ot[a].end==o&&Ot.splice(a++,1);!Ot.length&&t.unmousemove(gi).unmouseup(vi)},x.circle=function(n,i,o){return os(this,n||0,i||0,o||0)},x.rect=function(n,i,o,a,c){return rs(this,n||0,i||0,o||0,a||0,c||0)},x.ellipse=function(n,i,o,a){return as(this,n||0,i||0,o||0,a||0)},x.path=function(n){return n&&!t.is(n,$)&&!t.is(n[0],mt)&&(n+=P),ss(t.format[_](t,arguments),this)},x.image=function(n,i,o,a,c){return ls(this,n||"about:blank",i||0,o||0,a||0,c||0)},x.text=function(n,i,o){return cs(this,n||0,i||0,O(o))},x.set=function(n){return arguments[L]>1&&(n=Array[h].splice.call(arguments,0,arguments[L])),new Lt(n)},x.setSize=hs,x.top=x.bottom=null,x.raphael=t;function ps(){return this.x+H+this.y}dt.resetScale=function(){if(this.removed)return this;this._.sx=1,this._.sy=1,this.attrs.scale="1 1"},dt.scale=function(n,i,o,a){if(this.removed)return this;if(n==null&&i==null)return{x:this._.sx,y:this._.sy,toString:ps};i=i||n,!+i&&(i=n);var c,f,p=this.attrs;if(n!=0){var u=this.getBBox(),m=u.x+u.width/2,g=u.y+u.height/2,T=ot(n/this._.sx),D=ot(i/this._.sy);o=+o||o==0?o:m,a=+a||a==0?a:g;var N=this._.sx>0,V=this._.sy>0,R=~~(n/ot(n)),C=~~(i/ot(i)),k=T*R,Z=D*C,U=this.node.style,st=o+ot(m-o)*k*(m>o==N?1:-1),W=a+ot(g-a)*Z*(g>a==V?1:-1),vt=n*R>i*C?D:T;switch(this.type){case"rect":case"image":var ut=p.width*T,wt=p.height*D;this.attr({height:wt,r:p.r*vt,width:ut,x:st-ut/2,y:W-wt/2});break;case"circle":case"ellipse":this.attr({rx:p.rx*T,ry:p.ry*D,r:p.r*vt,cx:st,cy:W});break;case"text":this.attr({x:st,y:W});break;case"path":for(var lt=di(p.path),Tt=!0,Nt=N?k:T,Yt=V?Z:D,Zt=0,te=lt[L];Zt<te;Zt++){var Pt=lt[Zt],de=xt.call(Pt[0]);if(!(de=="M"&&Tt))if(Tt=!1,de=="A")Pt[lt[Zt][L]-2]*=Nt,Pt[lt[Zt][L]-1]*=Yt,Pt[1]*=T,Pt[2]*=D,Pt[5]=+(R+C?!!+Pt[5]:!+Pt[5]);else if(de=="H")for(var Vt=1,ee=Pt[L];Vt<ee;Vt++)Pt[Vt]*=Nt;else if(de=="V")for(Vt=1,ee=Pt[L];Vt<ee;Vt++)Pt[Vt]*=Yt;else for(Vt=1,ee=Pt[L];Vt<ee;Vt++)Pt[Vt]*=Vt%2?Nt:Yt}var re=Fe(lt);c=st-re.x-re.width/2,f=W-re.y-re.height/2,lt[0][1]+=c,lt[0][2]+=f,this.attr({path:lt});break}this.type in{text:1,image:1}&&(R!=1||C!=1)?this.transformations?(this.transformations[2]="scale("[A](R,",",C,")"),s(this.node,"transform",this.transformations[tt](H)),c=R==-1?-p.x-(ut||0):p.x,f=C==-1?-p.y-(wt||0):p.y,this.attr({x:c,y:f}),p.fx=R-1,p.fy=C-1):(this.node.filterMatrix=pt+".Matrix(M11="[A](R,", M12=0, M21=0, M22=",C,", Dx=0, Dy=0, sizingmethod='auto expand', filtertype='bilinear')"),U.filter=(this.node.filterMatrix||P)+(this.node.filterOpacity||P)):this.transformations?(this.transformations[2]=P,s(this.node,"transform",this.transformations[tt](H)),p.fx=0,p.fy=0):(this.node.filterMatrix=P,U.filter=(this.node.filterMatrix||P)+(this.node.filterOpacity||P)),p.scale=[n,i,o,a][tt](H),this._.sx=n,this._.sy=i}return this},dt.clone=function(){if(this.removed)return null;var n=this.attr();return delete n.scale,delete n.translation,this.paper[this.type]().attr(n)};var bi={},Ue=function(n,i,o,a,c,f,p,u,m){if(n===o&&i===a&&c===p&&f==u){var g=p-n,T=u-i,D=Math.sqrt(g*g+T*T);if(m==null)return D;var N=m/D;return{start:{x:n,y:i},m:{x:n,y:i},n:{x:p,y:u},end:{x:p,y:u},x:n+N*g,y:i+N*T,alpha:90-q.atan(g/T)*180/ct}}var V=0,R=100,C=[n,i,o,a,c,f,p,u].join(),k=bi[C],Z,U;if(!k&&(bi[C]=k={data:[]}),k.timer&&clearTimeout(k.timer),k.timer=setTimeout(function(){delete bi[C]},2e3),m!=null){var st=Ue(n,i,o,a,c,f,p,u);R=~~st*10}for(var W=0;W<R+1;W++){if(k.data[m]>W?U=k.data[W*R]:(U=t.findDotsAtSegment(n,i,o,a,c,f,p,u,W/R),k.data[W]=U),W&&(V+=j(j(Z.x-U.x,2)+j(Z.y-U.y,2),.5)),m!=null&&V>=m)return U;Z=U}if(m==null)return V},yi=function(n,i){return function(o,a,c){o=qe(o);for(var f,p,u,m,g="",T={},D,N=0,V=0,R=o.length;V<R;V++){if(u=o[V],u[0]=="M")f=+u[1],p=+u[2];else{if(m=Ue(f,p,u[1],u[2],u[3],u[4],u[5],u[6]),N+m>a){if(i&&!T.start){if(D=Ue(f,p,u[1],u[2],u[3],u[4],u[5],u[6],a-N),g+=["C",D.start.x,D.start.y,D.m.x,D.m.y,D.x,D.y],c)return g;T.start=g,g=["M",D.x,D.y+"C",D.n.x,D.n.y,D.end.x,D.end.y,u[5],u[6]][tt](),N+=m,f=+u[5],p=+u[6];continue}if(!n&&!i)return D=Ue(f,p,u[1],u[2],u[3],u[4],u[5],u[6],a-N),{x:D.x,y:D.y,alpha:D.alpha}}N+=m,f=+u[5],p=+u[6]}g+=u}return T.end=g,D=n?N:i?T:t.findDotsAtSegment(f,p,u[1],u[2],u[3],u[4],u[5],u[6],1),D.alpha&&(D={x:D.x,y:D.y,alpha:D.alpha}),D}},ms=yi(1),Ze=yi(),wi=yi(0,1);dt.getTotalLength=function(){if(this.type=="path")return this.node.getTotalLength?this.node.getTotalLength():ms(this.attrs.path)},dt.getPointAtLength=function(n){if(this.type=="path")return Ze(this.attrs.path,n)},dt.getSubpath=function(n,i){if(this.type=="path"){if(ot(this.getTotalLength()-i)<"1e-6")return wi(this.attrs.path,n).end;var o=wi(this.attrs.path,i,1);return n?wi(o,n).end:o}},t.easing_formulas={linear:function(n){return n},"<":function(n){return j(n,3)},">":function(n){return j(n-1,3)+1},"<>":function(n){return n=n*2,n<1?j(n,3)/2:(n-=2,(j(n,3)+2)/2)},backIn:function(n){var i=1.70158;return n*n*((i+1)*n-i)},backOut:function(n){n=n-1;var i=1.70158;return n*n*((i+1)*n+i)+1},elastic:function(n){if(n==0||n==1)return n;var i=.3,o=i/4;return j(2,-10*n)*q.sin((n-o)*(2*ct)/i)+1},bounce:function(n){var i=7.5625,o=2.75,a;return n<1/o?a=i*n*n:n<2/o?(n-=1.5/o,a=i*n*n+.75):n<2.5/o?(n-=2.25/o,a=i*n*n+.9375):(n-=2.625/o,a=i*n*n+.984375),a}};var zt=[],gs=function(){for(var n=+new Date,i=0;i<zt[L];i++){var o=zt[i];if(!(o.stop||o.el.removed)){var a=n-o.start,c=o.ms,f=o.easing,p=o.from,u=o.diff,m=o.to,g=o.t,T=o.el,D={},N;if(a<c){var V=f(a/c);for(var R in p)if(p[d](R)){switch(Ct[R]){case"along":N=V*c*u[R],m.back&&(N=m.len-N);var C=Ze(m[R],N);T.translate(u.sx-u.x||0,u.sy-u.y||0),u.x=C.x,u.y=C.y,T.translate(C.x-u.sx,C.y-u.sy),m.rot&&T.rotate(u.r+C.alpha,C.x,C.y);break;case at:N=+p[R]+V*c*u[R];break;case"colour":N="rgb("+[xi(B(p[R].r+V*c*u[R].r)),xi(B(p[R].g+V*c*u[R].g)),xi(B(p[R].b+V*c*u[R].b))][tt](",")+")";break;case"path":N=[];for(var k=0,Z=p[R][L];k<Z;k++){N[k]=[p[R][k][0]];for(var U=1,st=p[R][k][L];U<st;U++)N[k][U]=+p[R][k][U]+V*c*u[R][k][U];N[k]=N[k][tt](H)}N=N[tt](H);break;case"csv":switch(R){case"translation":var W=V*c*u[R][0]-g.x,vt=V*c*u[R][1]-g.y;g.x+=W,g.y+=vt,N=W+H+vt;break;case"rotation":N=+p[R][0]+V*c*u[R][0],p[R][1]&&(N+=","+p[R][1]+","+p[R][2]);break;case"scale":N=[+p[R][0]+V*c*u[R][0],+p[R][1]+V*c*u[R][1],2 in m[R]?m[R][2]:P,3 in m[R]?m[R][3]:P][tt](H);break;case"clip-rect":for(N=[],k=4;k--;)N[k]=+p[R][k]+V*c*u[R][k];break}break;default:var ut=[].concat(p[R]);for(N=[],k=T.paper.customAttributes[R].length;k--;)N[k]=+ut[k]+V*c*u[R][k];break}D[R]=N}T.attr(D),T._run&&T._run.call(T)}else m.along&&(C=Ze(m.along,m.len*!m.back),T.translate(u.sx-(u.x||0)+C.x-u.sx,u.sy-(u.y||0)+C.y-u.sy),m.rot&&T.rotate(u.r+C.alpha,C.x,C.y)),(g.x||g.y)&&T.translate(-g.x,-g.y),m.scale&&(m.scale+=P),T.attr(m),zt.splice(i--,1)}}t.svg&&T&&T.paper&&T.paper.safari(),zt[L]&&setTimeout(gs)},Ln=function(n,i,o,a,c){var f=o-a;i.timeouts.push(setTimeout(function(){t.is(c,"function")&&c.call(i),i.animate(n,f,n.easing)},a))},xi=function(n){return G(nt(n,255),0)},We=function(n,i){if(n==null)return{x:this._.tx,y:this._.ty,toString:ps};switch(this._.tx+=+n,this._.ty+=+i,this.type){case"circle":case"ellipse":this.attr({cx:+n+this.attrs.cx,cy:+i+this.attrs.cy});break;case"rect":case"image":case"text":this.attr({x:+n+this.attrs.x,y:+i+this.attrs.y});break;case"path":var o=di(this.attrs.path);o[0][1]+=+n,o[0][2]+=+i,this.attr({path:o});break}return this};dt.animateWith=function(n,i,o,a,c){for(var f=0,p=zt.length;f<p;f++)zt[f].el.id==n.id&&(i.start=zt[f].start);return this.animate(i,o,a,c)},dt.animateAlong=vs(),dt.animateAlongBack=vs(1);function vs(n){return function(i,o,a,c){var f={back:n};return t.is(a,"function")?c=a:f.rot=a,i&&i.constructor==gt&&(i=i.attrs.path),i&&(f.along=i),this.animate(f,o,c)}}function Rn(n,i,o,a,c,f){var p=3*i,u=3*(a-i)-p,m=1-p-u,g=3*o,T=3*(c-o)-g,D=1-g-T;function N(C){return((m*C+u)*C+p)*C}function V(C,k){var Z=R(C,k);return((D*Z+T)*Z+g)*Z}function R(C,k){var Z,U,st,W,vt,ut;for(st=C,ut=0;ut<8;ut++){if(W=N(st)-C,ot(W)<k)return st;if(vt=(3*m*st+2*u)*st+p,ot(vt)<1e-6)break;st=st-W/vt}if(Z=0,U=1,st=C,st<Z)return Z;if(st>U)return U;for(;Z<U;){if(W=N(st),ot(W-C)<k)return st;C>W?Z=st:U=st,st=(U-Z)/2+Z}return st}return V(n,1/(200*f))}dt.onAnimation=function(n){return this._run=n||0,this},dt.animate=function(n,i,o,a){var c=this;if(c.timeouts=c.timeouts||[],(t.is(o,"function")||!o)&&(a=o||null),c.removed)return a&&a.call(c),c;var f={},p={},u=!1,m={};for(var g in n)if(n[d](g)&&(Ct[d](g)||c.paper.customAttributes[d](g)))switch(u=!0,f[g]=c.attr(g),f[g]==null&&(f[g]=St[g]),p[g]=n[g],Ct[g]){case"along":var T=ms(n[g]),D=Ze(n[g],T*!!n.back),N=c.getBBox();m[g]=T/i,m.tx=N.x,m.ty=N.y,m.sx=D.x,m.sy=D.y,p.rot=n.rot,p.back=n.back,p.len=T,n.rot&&(m.r=X(c.rotate())||0);break;case at:m[g]=(p[g]-f[g])/i;break;case"colour":f[g]=t.getRGB(f[g]);var V=t.getRGB(p[g]);m[g]={r:(V.r-f[g].r)/i,g:(V.g-f[g].g)/i,b:(V.b-f[g].b)/i};break;case"path":var R=qe(f[g],p[g]);f[g]=R[0];var C=R[1];m[g]=[];for(var k=0,Z=f[g][L];k<Z;k++){m[g][k]=[0];for(var U=1,st=f[g][k][L];U<st;U++)m[g][k][U]=(C[k][U]-f[g][k][U])/i}break;case"csv":var W=O(n[g])[z](e),vt=O(f[g])[z](e);switch(g){case"translation":f[g]=[0,0],m[g]=[W[0]/i,W[1]/i];break;case"rotation":f[g]=vt[1]==W[1]&&vt[2]==W[2]?vt:[0,W[1],W[2]],m[g]=[(W[0]-f[g][0])/i,0,0];break;case"scale":n[g]=W,f[g]=O(f[g])[z](e),m[g]=[(W[0]-f[g][0])/i,(W[1]-f[g][1])/i,0,0];break;case"clip-rect":for(f[g]=O(f[g])[z](e),m[g]=[],k=4;k--;)m[g][k]=(W[k]-f[g][k])/i;break}p[g]=W;break;default:for(W=[].concat(n[g]),vt=[].concat(f[g]),m[g]=[],k=c.paper.customAttributes[g][L];k--;)m[g][k]=((W[k]||0)-(vt[k]||0))/i;break}if(u){var Tt=t.easing_formulas[o];if(!Tt)if(Tt=O(o).match(le),Tt&&Tt[L]==5){var Nt=Tt;Tt=function(Yt){return Rn(Yt,+Nt[1],+Nt[2],+Nt[3],+Nt[4],i)}}else Tt=function(Yt){return Yt};zt.push({start:n.start||+new Date,ms:i,easing:Tt,from:f,diff:m,to:p,el:c,t:{x:0,y:0}}),t.is(a,"function")&&(c._ac=setTimeout(function(){a.call(c)},i)),zt[L]==1&&setTimeout(gs)}else{var ut=[],wt;for(var lt in n)n[d](lt)&&Me.test(lt)&&(g={value:n[lt]},lt=="from"&&(lt=0),lt=="to"&&(lt=100),g.key=et(lt,10),ut.push(g));for(ut.sort(bn),ut[0].key&&ut.unshift({key:0,value:c.attrs}),k=0,Z=ut[L];k<Z;k++)Ln(ut[k].value,c,i/100*ut[k].key,i/100*(ut[k-1]&&ut[k-1].key||0),ut[k-1]&&ut[k-1].value.callback);wt=ut[ut[L]-1].value.callback,wt&&c.timeouts.push(setTimeout(function(){wt.call(c)},i))}return this},dt.stop=function(){for(var n=0;n<zt.length;n++)zt[n].el.id==this.id&&zt.splice(n--,1);for(n=0,ii=this.timeouts&&this.timeouts.length;n<ii;n++)clearTimeout(this.timeouts[n]);return this.timeouts=[],clearTimeout(this._ac),delete this._ac,this},dt.translate=function(n,i){return this.attr({translation:n+" "+i})},dt[Mt]=function(){return"Raphaël’s object"},t.ae=zt;var Lt=function(n){if(this.items=[],this[L]=0,this.type="set",n)for(var i=0,o=n[L];i<o;i++)n[i]&&(n[i].constructor==gt||n[i].constructor==Lt)&&(this[this.items[L]]=this.items[this.items[L]]=n[i],this[L]++)};Lt[h][K]=function(){for(var n,i,o=0,a=arguments[L];o<a;o++)n=arguments[o],n&&(n.constructor==gt||n.constructor==Lt)&&(i=this.items[L],this[i]=this.items[i]=n,this[L]++);return this},Lt[h].pop=function(){return delete this[this[L]--],this.items.pop()};for(var Mi in dt)dt[d](Mi)&&(Lt[h][Mi]=function(n){return function(){for(var i=0,o=this.items[L];i<o;i++)this.items[i][n][_](this.items[i],arguments);return this}}(Mi));return Lt[h].attr=function(n,i){if(n&&t.is(n,mt)&&t.is(n[0],"object"))for(var o=0,a=n[L];o<a;o++)this.items[o].attr(n[o]);else for(var c=0,f=this.items[L];c<f;c++)this.items[c].attr(n,i);return this},Lt[h].animate=function(n,i,o,a){(t.is(o,"function")||!o)&&(a=o||null);var c=this.items[L],f=c,p,u=this,m;for(a&&(m=function(){!--c&&a.call(u)}),o=t.is(o,$)?o:m,p=this.items[--f].animate(n,i,o,m);f--;)this.items[f]&&!this.items[f].removed&&this.items[f].animateWith(p,n,i,o,m);return this},Lt[h].insertAfter=function(n){for(var i=this.items[L];i--;)this.items[i].insertAfter(n);return this},Lt[h].getBBox=function(){for(var n=[],i=[],o=[],a=[],c=this.items[L];c--;){var f=this.items[c].getBBox();n[K](f.x),i[K](f.y),o[K](f.x+f.width),a[K](f.y+f.height)}return n=nt[_](0,n),i=nt[_](0,i),{x:n,y:i,width:G[_](0,o)-n,height:G[_](0,a)-i}},Lt[h].clone=function(n){n=new Lt;for(var i=0,o=this.items[L];i<o;i++)n[K](this.items[i].clone());return n},t.registerFont=function(n){if(!n.face)return n;this.fonts=this.fonts||{};var i={w:n.w,face:{},glyphs:{}},o=n.face["font-family"];for(var a in n.face)n.face[d](a)&&(i.face[a]=n.face[a]);if(this.fonts[o]?this.fonts[o][K](i):this.fonts[o]=[i],!n.svg){i.face["units-per-em"]=et(n.face["units-per-em"],10);for(var c in n.glyphs)if(n.glyphs[d](c)){var f=n.glyphs[c];if(i.glyphs[c]={w:f.w,k:{},d:f.d&&"M"+f.d[bt](/[mlcxtrv]/g,function(u){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[u]||"M"})+"z"},f.k)for(var p in f.k)f[d](p)&&(i.glyphs[c].k[p]=f.k[p])}}return n},x.getFont=function(n,i,o,a){if(a=a||"normal",o=o||"normal",i=+i||{normal:400,bold:700,lighter:300,bolder:800}[i]||400,!!t.fonts){var c=t.fonts[n];if(!c){var f=new RegExp("(^|\\s)"+n[bt](/[^\w\d\s+!~.:_-]/g,P)+"(\\s|$)","i");for(var p in t.fonts)if(t.fonts[d](p)&&f.test(p)){c=t.fonts[p];break}}var u;if(c)for(var m=0,g=c[L];m<g&&(u=c[m],!(u.face["font-weight"]==i&&(u.face["font-style"]==o||!u.face["font-style"])&&u.face["font-stretch"]==a));m++);return u}},x.print=function(n,i,o,a,c,f,p){f=f||"middle",p=G(nt(p||0,1),-1);var u=this.set(),m=O(o)[z](P),g=0,T;if(t.is(a,o)&&(a=this.getFont(a)),a){T=(c||16)/a.face["units-per-em"];for(var D=a.face.bbox.split(e),N=+D[0],V=+D[1]+(f=="baseline"?D[3]-D[1]+ +a.face.descent:(D[3]-D[1])/2),R=0,C=m[L];R<C;R++){var k=R&&a.glyphs[m[R-1]]||{},Z=a.glyphs[m[R]];g+=R?(k.w||a.w)+(k.k&&k.k[m[R]]||0)+a.w*p:0,Z&&Z.d&&u[K](this.path(Z.d).attr({fill:"#000",stroke:"none",translation:[g,0]}))}u.scale(T,T,N,V).translate(n-N,i-V)}return u},t.format=function(n,i){var o=t.is(i,mt)?[0][A](i):arguments;return n&&t.is(n,$)&&o[L]-1&&(n=n[bt](l,function(a,c){return o[++c]==null?P:o[c]})),n||P},t.ninja=function(){return y.was?b.Raphael=y.is:Raphael=void 0,t},t.el=dt,t.st=Lt[h],t}(),Y={BLUE:Pe.blue,PINK:"#FF00AF",GREEN:Pe.green,PURPLE:"#9D38BD",RED:"#DF0030",GRAY:"gray",BLACK:"black",LIGHT_BLUE:"#9AB8ED",LIGHT_ORANGE:"#EDD19B",LIGHT_PINK:"#ED9BD3",LIGHT_GREEN:"#9BEDCE",LIGHT_PURPLE:"#DA9BED",LIGHT_RED:"#ED9AAC",BLUE_C:"#63D9EA",GRAY_C:"#E3E5E6",GRAY_F:"#888D93",GRAY_G:"#626569",KA_GREEN:"#71B307",_BACKGROUND:"#FDFDFD",INTERACTING:Pe.green,INTERACTIVE:Pe.green,DYNAMIC:Pe.blue};class co{constructor(t,e,r){F(this,"raphael");F(this,"xScale");F(this,"yScale");F(this,"bounds");F(this,"scaleVector",t=>{if(typeof t=="number")return this.scaleVector([t,t]);const e=t[0],r=t[1];return[e*this.xScale,r*this.yScale]});F(this,"scalePoint",t=>{if(typeof t=="number")return this.scalePoint([t,t]);const e=t[0],r=t[1];return[(e-this.bounds.xMin)*this.xScale,(this.bounds.yMax-r)*this.yScale]});F(this,"unscalePoint",t=>{if(typeof t=="number")return this.unscalePoint([t,t]);const e=t[0],r=t[1];return[e/this.xScale+this.bounds.xMin,this.bounds.yMax-r/this.yScale]});F(this,"unscaleVector",t=>typeof t=="number"?this.unscaleVector([t,t]):[t[0]/this.xScale,t[1]/this.yScale]);F(this,"setScale",t=>{typeof t=="number"&&(t=[t,t]),this.xScale=t[0],this.yScale=t[1],this.raphael.setSize(...this.canvasDimensions())});F(this,"canvasDimensions",()=>[this.bounds.width()*this.xScale,this.bounds.height()*this.yScale]);F(this,"pixelsPerUnitX",()=>this.xScale);F(this,"pixelsPerUnitY",()=>this.yScale);this.raphael=t,this.bounds=r,this.xScale=e[0],this.yScale=e[1],this.setScale(e)}}class ho{constructor(t,e){F(this,"xMin");F(this,"xMax");F(this,"yMin");F(this,"yMax");this.xMin=t[0],this.xMax=t[1],this.yMin=e[0],this.yMax=e[1]}width(){return this.xMax-this.xMin}height(){return this.yMax-this.yMin}}const Is=new WeakMap;function Ks(s,t){const e=At.jsx(Un,{throwIfNested:!1,children:s});let r=Is.get(t);r==null&&(r=Zn(t),Is.set(t,r)),r.render(e)}function uo(s,t){const e=E(s).find("."+t);return e.length===0?E("<span>").addClass(t).appendTo(E(s)):e}const Js={processMath:async function(s,t,e,r){const l=E(s);if(l.attr("data-math-formula")==null||e){const h=uo(l,"tex-holder");t==null&&l.attr("data-math-formula")&&(t=l.attr("data-math-formula")),t=t!=null?t+"":"",t=qt.cleanMath(t),l.attr("data-math-formula",t);const{TeX:d}=await ne();Ks(ai.createElement(d,{children:t,onRender:r}),h[0])}}},{processMath:fo}=Js;function Li(s,t){return typeof s=="number"&&(s=[s,s]),t=t*Math.PI/180,[s[0]*Math.cos(t),s[1]*Math.sin(t)]}var ge,ve,qs;let Ri=(qs=class{constructor(t){F(this,"el");Si(this,ge,void 0);Si(this,ve,void 0);F(this,"raphael");F(this,"mouselayer");F(this,"_mouselayerWrapper");F(this,"_visiblelayerWrapper");F(this,"isMobile",!1);F(this,"currentStyle",{"stroke-width":2,fill:"none"});F(this,"range");F(this,"scale");F(this,"dimensions");F(this,"xpixels");F(this,"ypixels");F(this,"isDragging");F(this,"label",(t,e,r,l,h)=>{const d=typeof l=="object"?l:h,v=typeof l=="boolean"?l:!0;return this.withStyle(d,()=>{const b=E("<span>").addClass("graphie-label"),y=this.currentStyle["label-distance"];b.css({position:"absolute",padding:(y??7)+"px",color:"black"}).data("labelDirection",r).appendTo(this.el),b.setPosition=x=>{const S=this.scalePoint(x);b.css({left:S[0],top:S[1]})},b.setPosition(t);const M=b[0];return b.processMath=function(x,S){fo(M,x,S,function(){const _=M.scrollWidth,A=M.scrollHeight;Ls(M,[_,A])})},b.processText=function(x){b.html(x);const S=M.scrollWidth,_=M.scrollHeight;Ls(M,[S,_])},v?b.processMath(e,!1):b.processText(e),b})});F(this,"svgPath",(t,e)=>t.map((r,l)=>{if(r===!0)return"z";const h=e?r:this.scalePoint(r);return(l===0?"M":"L")+qt.bound(h[0])+" "+qt.bound(h[1])}).join(""));F(this,"svgParabolaPath",(t,e,r)=>{const l=function(P){return(t*P+e)*P+r};if(t===0){const P=[[this.bounds().xMin,l(this.bounds().xMin)],[this.bounds().xMax,l(this.bounds().xMax)]];return this.svgPath(P)}const h=-e/(2*t),d=Math.max(Math.abs(h-this.bounds().xMin),Math.abs(h-this.bounds().xMax)),v=h+d,b=[h,l(h)],y=[v,l(v)],M=[b[0],b[1]-(y[1]-b[1])],x=Math.abs(b[0]-y[0]),S=[b[0]-x,y[1]],_=[b[0]+x,y[1]],I=[S,M,_].map(this.scalePoint).flat().map(qt.bound);return"M"+I[0]+","+I[1]+" Q"+I[2]+","+I[3]+" "+I[4]+","+I[5]});F(this,"svgSinusoidPath",(t,e,r,l)=>{const h=Math.abs(Math.PI/(2*e)),d=function(I){return t*Math.sin(e*I-r)+l},v=function(I){return t*e*Math.cos(r-e*I)},b=(I,P)=>{const H=I+h*P,O=H+h,z=[H,H*2/3+O*1/3,H*1/3+O*2/3,O],J=[d(H),d(H)+v(H)*(O-H)/3,d(O)-v(O)*(O-H)/3,d(O)];return Gn(z,J).map(this.scalePoint)},y=this.bounds().width(),M=Math.ceil(y/h)+1;let x=r/e;const S=x-this.bounds().xMin;x-=h*Math.ceil(S/h);let _=b(x,0),A="M"+_[0][0]+","+_[0][1]+" C"+_[1][0]+","+_[1][1]+" "+_[2][0]+","+_[2][1]+" "+_[3][0]+","+_[3][1];for(let I=1;I<M;I++)_=b(x,I),A+=" C"+_[1][0]+","+_[1][1]+" "+_[2][0]+","+_[2][1]+" "+_[3][0]+","+_[3][1];return A});F(this,"scalePoint",t=>this.drawingTransform().scalePoint(t));F(this,"scaleVector",t=>this.drawingTransform().scaleVector(t));F(this,"unscalePoint",t=>this.drawingTransform().unscalePoint(t));F(this,"unscaleVector",t=>this.drawingTransform().unscaleVector(t));this.el=t,E(t).css("position","relative"),this.raphael=Jt(t),E(t).attr("aria-hidden","true"),E(t).children("div").css("position","absolute")}init(t){let e=t.scale||[40,40];if(e=typeof e=="number"?[e,e]:e,t.range==null)throw new jt("range should be specified in graph init",Ht.Internal);Ti(this,ge,new ho(...t.range)),Ti(this,ve,new co(this.raphael,e,this.bounds()));const[r,l]=this.drawingTransform().canvasDimensions();return E(this.el).css({width:r,height:l}),this.range=t.range,this.scale=e,this.dimensions=[r,l],this.xpixels=r,this.ypixels=l,this.isMobile=t.isMobile??!1,this}graphInit(t){t=t||{};for(const[G,nt]of qn(t))!G.match(/.*Opacity$/)&&G!=="range"&&typeof nt=="number"&&(t[G]=[nt,nt]),(G==="range"||G==="gridRange")&&(t[G]=Ci(t[G]));const e=Ci(t.range||[[-10,10],[-10,10]]),r=Ci(t.gridRange||e),l=t.scale||[20,20],h=t.grid!=null?t.grid:!0,d=t.gridOpacity||.1,v=mo(t.gridStep||[1,1]),b=t.axes!=null?t.axes:!0,y=t.axisArrows||"",M=t.axisOpacity||1,x=t.axisCenter||[Math.min(Math.max(e[0][0],0),e[0][1]),Math.min(Math.max(e[1][0],0),e[1][1])],S=t.axisLabels!=null?t.axisLabels:!1,_=t.ticks!=null?t.ticks:!0,A=t.tickStep||[2,2],I=t.tickLen||[5,5],P=t.tickOpacity||1,H=t.labels||t.labelStep||!1,O=t.labelStep||[1,1],z=t.labelOpacity||1;let J=t.unityLabels||!1;const it=t.labelFormat||function(G){return G};let tt=t.xLabelFormat||it,L=t.yLabelFormat||it;const rt=[[e[0][0]-(e[0][0]>0?1:0),e[0][1]+(e[0][1]<0?1:0)],[e[1][0]-(e[1][0]>0?1:0),e[1][1]+(e[1][1]<0?1:0)]];Array.isArray(J)||(J=[J,J]);const q=function(G){return function(nt){return(G(nt)+"").replace(/-(\d)/g,"\\llap{-}$1")}};if(tt=q(tt),L=q(L),this.init({range:rt,scale:l,isMobile:t.isMobile}),h&&this.grid(r[0],r[1],{stroke:t.isMobile?Y.GRAY_C:"#000000",opacity:t.isMobile?1:d,step:v,strokeWidth:t.isMobile?1:2}),b){if(y==="<->"||y===!0){const G=this;this.style({stroke:t.isMobile?Y.GRAY_G:"#000000",opacity:t.isMobile?1:M,strokeWidth:t.isMobile?1:2,arrows:"->"},function(){e[1][0]<0&&e[1][1]>0&&(G.path([x,[r[0][0],x[1]]]),G.path([x,[r[0][1],x[1]]])),e[0][0]<0&&e[0][1]>0&&(G.path([x,[x[0],r[1][0]]]),G.path([x,[x[0],r[1][1]]]))})}else if(y==="->"||y===""){const G=this;this.style({stroke:"#000000",opacity:M,strokeWidth:2,arrows:y},function(){G.path([[r[0][0],x[1]],[r[0][1],x[1]]]),G.path([[x[0],r[1][0]],[x[0],r[1][1]]])})}S&&S.length===2&&(this.label([r[0][1],x[1]],S[0],"right"),this.label([x[0],r[1][1]],S[1],"above"))}if(_){const G=t.isMobile,nt=this;this.style({stroke:t.isMobile?Y.GRAY_G:"#000000",opacity:t.isMobile?1:P,strokeWidth:1},()=>{let ot=v[0]*A[0],j=I[0]/l[1],ct=r[0][0],at=r[0][1];if(e[1][0]<0&&e[1][1]>0){for(let $=ot+x[0];$<=at;$+=ot)($<at||!y)&&nt.line([$,-j+x[1]],[$,G?0:j+x[1]]);for(let $=-ot+x[0];$>=ct;$-=ot)($>ct||!y)&&nt.line([$,-j+x[1]],[$,G?0:j+x[1]])}if(ot=v[1]*A[1],j=I[1]/l[0],ct=r[1][0],at=r[1][1],e[0][0]<0&&e[0][1]>0){for(let $=ot+x[1];$<=at;$+=ot)($<at||!y)&&this.line([-j+x[0],$],[G?0:j+x[0],$]);for(let $=-ot+x[1];$>=ct;$-=ot)($>ct||!y)&&this.line([-j+x[0],$],[G?0:j+x[0],$])}})}if(H){const G=this;this.style({stroke:t.isMobile?Y.GRAY_G:"#000000",opacity:t.isMobile?1:z},function(){let nt=v[0]*A[0]*O[0],ot=r[0][0],j=r[0][1];const ct=x[0]<0?"above":"below",at=x[0]<0?"right":"left",$=x[0]===0&&x[1]!==0,mt=x[0]!==0&&x[1]===0,Mt=x[0]!==0||x[1]!==0,It=J[0]||Mt,ae=J[1]||Mt;for(let K=($?0:nt)+x[0];K<=j;K+=nt)(K<j||!y)&&G.label([K,x[1]],tt(K),ct);for(let K=-nt*(It?1:2)+x[0];K>=ot;K-=nt)(K>ot||!y)&&G.label([K,x[1]],tt(K),ct);nt=v[1]*A[1]*O[1],ot=r[1][0],j=r[1][1];for(let K=(mt?0:nt)+x[1];K<=j;K+=nt)(K<j||!y)&&G.label([x[0],K],L(K),at);for(let K=-nt*(ae?1:2)+x[1];K>=ot;K-=nt)(K>ot||!y)&&G.label([x[0],K],L(K),at)})}}drawingTransform(){if(Ce(this,ve)==null)throw new Error("Can't get drawingTransform of an uninitialized Graphie");return Ce(this,ve)}bounds(){if(Ce(this,ge)==null)throw new Error("Can't get bounds of an uninitialized Graphie");return Ce(this,ge)}style(t,e){const r=this.processAttributes(t);if(typeof e=="function"){const l=this.currentStyle;this.currentStyle={...this.currentStyle,...r};const h=e.call(this);return this.currentStyle=l,h}Object.assign(this.currentStyle,r)}grid(t,e,r){return this.withStyle(r,()=>{const l=this.currentStyle.step||[1,1],h=this.raphael.set();let d=l[0]*Math.ceil(t[0]/l[0]);for(;d<=t[1];d+=l[0])h.push(this.line([d,e[0]],[d,e[1]]));let v=l[1]*Math.ceil(e[0]/l[1]);for(;v<=e[1];v+=l[1])h.push(this.line([t[0],v],[t[1],v]));return h})}arc(t,e,r,l,h,d){return this.withStyle(d,()=>{r=(r%360+360)%360,l=(l%360+360)%360;const v=this.scalePoint(t),b=this.scaleVector(e),y=Li(e,r),M=Li(e,l),x=I=>Fn(I,6),S=this.scalePoint([x(t[0]+y[0]),x(t[1]+y[1])]),_=this.scalePoint([x(t[0]+M[0]),x(t[1]+M[1])]),A=((l-r)%360+360)%360>180;return this.raphael.path("M"+S.join(" ")+"A"+b.join(" ")+" 0 "+(A?1:0)+" 0 "+_.join(" ")+(h?"L"+v.join(" ")+"z":""))})}circle(t,e,r){return this.withStyle(r,()=>this.raphael.ellipse(...this.scalePoint(t),...this.scaleVector([e,e])))}rect(t,e,r,l,h){return this.withStyle(h,()=>{const d=this.scalePoint([t,e+l]),v=this.scaleVector([r,l]),b=this.raphael.rect(...d.concat(v));return this.isMobile&&(b.node.style.shapeRendering="crispEdges"),b})}ellipse(t,e,r){return this.withStyle(r,()=>this.raphael.ellipse(...this.scalePoint(t).concat(this.scaleVector(e))))}fixedEllipse(t,e,r,l,h){return this.withStyle(h,()=>{const d=this.scalePoint(t),v=this.scaleVector(e),b=2*v[0]*r+l,y=2*v[1]*r+l,M=d[0]-b/2,x=d[1]-y/2,S=document.createElement("div");E(S).css({position:"absolute",width:b+"px",height:y+"px",left:M+"px",top:x+"px"});const A=Jt(S,b,y).ellipse(b/2,y/2,v[0],v[1]);return{wrapper:S,visibleShape:A}})}unstyledPath(t){const e=this.raphael.path(this.svgPath(t));return e.graphiePath=t,e}path(t,e){return this.withStyle(e,()=>this.unstyledPath(t))}fixedPath(t,e,r){t=t.map(this.scalePoint),e=e?this.scalePoint(e):null,r=r||this.svgPath;const l=t.map(z=>z[0]),h=t.map(z=>z[1]),d=Math.min(...l),v=Math.max(...l),b=Math.min(...h),y=Math.max(...h),M=[4,4],x=[d,b];t=t.map(function(z){return ht(ft(z,x),Ft(M,.5))});const S=v-d+M[0],_=y-b+M[1],A=x[0]-M[0]/2,I=x[1]-M[1]/2,P=document.createElement("div");E(P).css({position:"absolute",width:S+"px",height:_+"px",left:A+"px",top:I+"px",transformOrigin:e?S/2+e[0]+"px "+(_/2+e[1])+"px":null});const O=Jt(P,S,_).path(r(t));return{wrapper:P,visibleShape:O}}scaledPath(t,e){return this.withStyle(e,()=>{const r=this.raphael.path(this.svgPath(t,!0));return r.graphiePath=t,r})}line(t,e,r){return this.withStyle(r,()=>{const l=this.unstyledPath([t,e]);return this.isMobile&&(l.node.style.shapeRendering="crispEdges"),l})}parabola(t,e,r,l){return this.withStyle(l,()=>this.raphael.path(this.svgParabolaPath(t,e,r)))}fixedLine(t,e,r){const l=[r,r];t=this.scalePoint(t),e=this.scalePoint(e);const h=[Math.min(t[0],e[0]),Math.min(t[1],e[1])];t=ht(ft(t,h),Ft(l,.5)),e=ht(ft(e,h),Ft(l,.5));const d=h[0]-l[0]/2,v=h[1]-l[1]/2,b=Math.abs(t[0]-e[0])+l[0],y=Math.abs(t[1]-e[1])+l[1],M=document.createElement("div");E(M).css({position:"absolute",width:b+"px",height:y+"px",left:d+"px",top:v+"px",transformOrigin:t[0]+"px "+t[1]+"px"});const x=Jt(M,b,y),S="M"+t[0]+" "+t[1]+" L"+e[0]+" "+e[1],_=x.path(S);return _.graphiePath=[t,e],{wrapper:M,visibleShape:_}}sinusoid(t,e,r,l,h){return this.withStyle(h,()=>this.raphael.path(this.svgSinusoidPath(t,e,r,l)))}plotParametric(t,e,r){return this.withStyle(r,()=>{const l=S=>Math.abs(S[1])>5e5?[S[0],Math.min(Math.max(S[1],-5e5),5e5)]:S,h=S=>l(t(S)),d=e[0],v=e[1];let b=(v-d)/(this.currentStyle["plot-points"]||800);b===0&&(b=1);const y=this.raphael.set();let M=[],x=h(d)[1];for(let S=d;S<=v;S+=b){const _=h(S),A=_[1];A>0!=x>0&&Math.abs(A-x)>2*this.drawingTransform().pixelsPerUnitY()||isNaN(A)?(y.push(this.unstyledPath(M)),M=[]):M.push(_),x=A}return y.push(this.unstyledPath(M)),y})}plot(t,e,r){return this.withStyle(r,()=>{const l=e[0],h=e[1];this.currentStyle["plot-points"]||(this.currentStyle["plot-points"]=2*(h-l)*this.drawingTransform().pixelsPerUnitX());const d=v=>[v,t(v)];return this.plotParametric(d,e)})}withStyle(t,e){const r=this.currentStyle;this.currentStyle={...this.currentStyle,...this.processAttributes(t)};const l=this.postprocessDrawingResult(e());return this.currentStyle=r,l}postprocessDrawingResult(t){const e=t.constructor.prototype;return e===Jt.el||e===Jt.st?(t.attr(this.currentStyle),this.currentStyle.arrows&&(t=this.addArrowheads(t))):t instanceof E&&t.css({...this.currentStyle,...go}),t}addArrowheads(t){const e=t.constructor.prototype;if(e===Jt.el){if(t.type==="path"&&typeof t.arrowheadsDrawn>"u"){const l=.6+.4*t.attr("stroke-width"),h=t.getTotalLength(),d=this.raphael.set(),v=this.raphael.path(this.isMobile?"M-4,4 C-4,4 -0.25,0 -0.25,0 C-0.25,0 -4,-4 -4,-4":"M-3 4 C-2.75 2.5 0 0.25 0.75 0C0 -0.25 -2.75 -2.5 -3 -4"),b=t.getPointAtLength(h-.4),y=t.getPointAtLength(h-.75*l),M=Math.atan2(b.y-y.y,b.x-y.x)*180/Math.PI,x=t.attr();delete x.path;let S=t.getSubpath(0,h-.75*l);return S=this.raphael.path(S).attr(x),S.arrowheadsDrawn=!0,t.remove(),v.rotate(M,this.isMobile?1e-5:.75,0).scale(l,l,.75,0).translate(y.x,y.y).attr(x).attr({"stroke-linejoin":"round","stroke-linecap":"round"}),v.arrowheadsDrawn=!0,d.push(S),d.push(v),d}}else if(e===Jt.st)for(let r=0,l=t.items.length;r<l;r++)this.addArrowheads(t.items[r]);return t}processAttributes(t){const e={scale:l=>{this.drawingTransform().setScale(l)},clipRect:l=>{const h=l[0],d=l[1];return h[1]+=d[1],{"clip-rect":this.scalePoint(h).concat(this.scaleVector(d)).join(" ")}},strokeWidth:function(l){return{"stroke-width":parseFloat(l)}},rx:l=>({rx:this.scaleVector([l,0])[0]}),ry:l=>({ry:this.scaleVector([0,l])[1]}),r:l=>{const h=this.scaleVector([l,l]);return{rx:h[0],ry:h[1]}}},r={};return Object.entries(t||{}).forEach(function([l,h]){const d=e[l];if(typeof d=="function")Object.assign(r,d(h));else{const v=String(l).replace(/([A-Z]+)([A-Z][a-z])/g,"$1-$2").replace(/([a-z\d])([A-Z])/g,"$1-$2").toLowerCase();r[v]=h}}),r}addMouseLayer(t){var h;const e={allowScratchpad:!1,setDrawingAreaAvailable:function(){},...t},r=2;if(this.mouselayer=Jt(this.el,this.xpixels,this.ypixels),E(this.mouselayer.canvas).css("z-index",r),e.onClick||e.onMouseDown||e.onMouseMove||e.onMouseOver||e.onMouseOut){const d=this.mouselayer.rect(0,0,this.xpixels,this.ypixels).attr({fill:"#000",opacity:0});let v=!1;if(E(this.mouselayer.canvas).on("vmousedown",b=>{if(b.target===d[0]){if(e.onMouseDown&&e.onMouseDown(this.getMouseCoord(b)),v=!0,e.onMouseMove){const y=e.onMouseMove;E(document).bind("vmousemove.mouseLayer",M=>{v&&(M.preventDefault(),y(this.getMouseCoord(M)))})}E(document).bind("vmouseup.mouseLayer",y=>{E(document).unbind(".mouseLayer"),v&&e.onClick&&e.onClick(this.getMouseCoord(y)),v=!1})}}),e.onMouseOver){const b=e.onMouseOver;E(this.mouselayer.canvas).on("vmouseover",y=>{b(this.getMouseCoord(y))})}if(e.onMouseOut){const b=e.onMouseOut;E(this.mouselayer.canvas).on("vmouseout",y=>{b(this.getMouseCoord(y))})}}e.allowScratchpad||(h=e.setDrawingAreaAvailable)==null||h.call(e,!1),this._mouselayerWrapper=document.createElement("div"),E(this._mouselayerWrapper).css({position:"absolute",left:0,top:0,zIndex:r}),this._visiblelayerWrapper=document.createElement("div"),E(this._visiblelayerWrapper).css({position:"absolute",left:0,top:0});const l=this.el;l.appendChild(this._visiblelayerWrapper),l.appendChild(this._mouselayerWrapper),this.addToMouseLayerWrapper=d=>{var v;(v=this._mouselayerWrapper)==null||v.appendChild(d)},this.addToVisibleLayerWrapper=d=>{var v;(v=this._visiblelayerWrapper)==null||v.appendChild(d)}}addToMouseLayerWrapper(t){throw new Error("addToMouseLayerWrapper is not ready. Call addMouseLayer() first.")}addToVisibleLayerWrapper(t){throw new Error("addToVisibleLayerWrapper is not ready. Call addMouseLayer() first.")}getMousePx(t){const e=E(this.el).offset(),r=t.pageX-e.left,l=t.pageY-e.top;return[r,l]}getMouseCoord(t){return this.unscalePoint(this.getMousePx(t))}},ge=new WeakMap,ve=new WeakMap,qs);const po={center:[-.5,-.5],above:[-.5,-1],"above right":[0,-1],right:[0,-.5],"below right":[0,0],below:[-.5,0],"below left":[-1,0],left:[-1,-.5],"above left":[-1,-1]};function Ci(s){function t(h){return typeof h=="number"?[-h,h]:h}function e(h){return Array.isArray(h)?h:[h,h]}if(s==null)return s;const[r,l]=e(s);return[t(r),t(l)]}function mo(s){return Array.isArray(s)?s:[s,s]}const go={"stroke-width":null},Ls=function(s,t){const e=E(s),r=e.data("labelDirection");let[l,h]=t;if(l===0&&h===0&&([l,h]=[1,1],De.log("Label size was 0x0 in graphie.js; using 1x1 instead")),e.css("visibility",""),typeof r=="number"){const d=Math.cos(r),v=Math.sin(r),b=Math.min(l/2/Math.abs(d),h/2/Math.abs(v));e.css({marginLeft:-l/2+d*b,marginTop:-h/2-v*b})}else{const d=s.scrollHeight===h,v=e.closest(".svg-image"),b=e.closest(".graphie"),y=v.length>0?v:b;y.css("line-height","normal"),d&&s.scrollHeight!==h&&(h=s.scrollHeight);const M=y.css(["max-width","width"])??{"max-width":"0px"},x=M["max-width"]!=="none"?M["max-width"]:M.width;let S=(y.width()??0)/parseInt(x.replace(/px$/,""))*100;(isNaN(S)||S===0)&&(S=100);const _=e.css("padding")??"0px",I=Math.round(parseInt((_!=="none"?_:"0px").replace(/px$/,""))*S)/100,P=po[r||"center"],H={marginLeft:Math.round(l*P[0]*S)/100,marginTop:Math.round(h*P[1]*S)/100,padding:`${I}px`};S!==1&&(H.fontSize=`${Math.round(S*100)/100}%`),e.css(H)}},yt={Graphie:Ri,createGraphie:function(s){return new Ri(s)},unscaledSvgPath:function(s){return s[0]===!0?"":s.map(function(t,e){return t===!0?"z":(e===0?"M":"L")+t[0]+" "+t[1]}).join("")},getDistance:function(s,t){return Us(s,t)},findAngleDeprecated:function(s,t,e){if(e===void 0){const r=s[0]-t[0],l=s[1]-t[1];return!r&&!l?0:(180+Math.atan2(-l,-r)*180/Math.PI+360)%360}return yt.findAngleDeprecated(s,e)-yt.findAngleDeprecated(t,e)},graphs:{}};(function(s,t,e,r){if(typeof s>"u")return;var l="virtualMouseBindings",h="virtualTouchID",d="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),v="clientX clientY pageX pageY screenX screenY".split(" "),b=s.event.mouseHooks?s.event.mouseHooks.props:[],y=s.event.props.concat(b),M={},x=0,S=0,_=0,A=!1,I=[],P=!1,H=!1,O="addEventListener"in e,z=s(e),J=1,it=0;s.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500};function tt(B){for(;B&&typeof B.originalEvent<"u";)B=B.originalEvent;return B}function L(B,X){var et=B.type,pt,xt,St,Ct,bt,Me,oe,ce,He;if(B=s.Event(B),B.type=X,pt=B.originalEvent,xt=s.event.props,et.search(/mouse/)>-1&&(xt=y),pt)for(oe=xt.length,Ct;oe;)Ct=xt[--oe],B[Ct]=pt[Ct];if(et.search(/mouse(down|up)|click/)>-1&&!B.which&&(B.which=1),et.search(/^touch/)!==-1&&(St=tt(pt),et=St.touches,bt=St.changedTouches,Me=et&&et.length?et[0]:bt&&bt.length?bt[0]:r,Me))for(ce=0,He=v.length;ce<He;ce++)Ct=v[ce],B[Ct]=Me[Ct];return B}function rt(B){for(var X={},et,pt;B;){et=s.data(B,l);for(pt in et)et[pt]&&(X[pt]=X.hasVirtualBinding=!0);B=B.parentNode}return X}function q(B,X){for(var et;B;){if(et=s.data(B,l),et&&(!X||et[X]))return B;B=B.parentNode}return null}function G(){H=!1}function nt(){H=!0}function ot(){it=0,I.length=0,P=!1,nt()}function j(){G()}function ct(){at(),x=setTimeout(function(){x=0,ot()},s.vmouse.resetTimerDuration)}function at(){x&&(clearTimeout(x),x=0)}function $(B,X,et){var pt;return(et&&et[B]||!et&&q(X.target,B))&&(pt=L(X,B),s(X.target).trigger(pt)),pt}function mt(B){var X=s.data(B.target,h);if(!P&&(!it||it!==X)){var et=$("v"+B.type,B);et&&(et.isDefaultPrevented()&&B.preventDefault(),et.isPropagationStopped()&&B.stopPropagation(),et.isImmediatePropagationStopped()&&B.stopImmediatePropagation())}}function Mt(B){var X=tt(B).touches,et,pt;if(X&&X.length===1&&(et=B.target,pt=rt(et),pt.hasVirtualBinding)){it=J++,s.data(et,h,it),at(),j(),A=!1;var xt=tt(B).touches[0];S=xt.pageX,_=xt.pageY,$("vmouseover",B,pt),$("vmousedown",B,pt)}}function It(B){H||(A||$("vmousecancel",B,rt(B.target)),A=!0,ct())}function ae(B){if(!H){var X=tt(B).touches[0],et=xt,pt=s.vmouse.moveDistanceThreshold,xt=xt||Math.abs(X.pageX-S)>pt||Math.abs(X.pageY-_)>pt,St=rt(B.target);xt&&!et&&$("vmousecancel",B,St),$("vmousemove",B,St),ct()}}function K(B){if(!H){nt();var X=rt(B.target),et;if($("vmouseup",B,X),!A){var pt=$("vclick",B,X);pt&&pt.isDefaultPrevented()&&(et=tt(B).changedTouches[0],I.push({touchID:it,x:et.clientX,y:et.clientY}),P=!0)}$("vmouseout",B,X),A=!1,ct()}}function xe(B){var X=s.data(B,l),et;if(X){for(et in X)if(X[et])return!0}return!1}function Ve(){}function hi(B){var X=B.substr(1);return{setup:function(et,pt){xe(this)||s.data(this,l,{});var xt=s.data(this,l);xt[B]=!0,M[B]=(M[B]||0)+1,M[B]===1&&z.bind(X,mt),s(this).bind(X,Ve),O&&(M.touchstart=(M.touchstart||0)+1,M.touchstart===1&&z.bind("touchstart",Mt).bind("touchend",K).bind("touchmove",ae).bind("scroll",It))},teardown:function(et,pt){--M[B],M[B]||z.unbind(X,mt),O&&(--M.touchstart,M.touchstart||z.unbind("touchstart",Mt).unbind("touchmove",ae).unbind("touchend",K).unbind("scroll",It));var xt=s(this),St=s.data(this,l);St&&(St[B]=!1),xt.unbind(X,Ve),xe(this)||xt.removeData(l)}}}for(var le=0;le<d.length;le++)s.event.special[d[le]]=hi(d[le]);O&&e.addEventListener("click",function(B){var X=I.length,et=B.target,pt,xt,St,Ct,bt;if(X)for(pt=B.clientX,xt=B.clientY,threshold=s.vmouse.clickDistanceThreshold,St=et;St;){for(Ct=0;Ct<X;Ct++)if(bt=I[Ct],St===et&&Math.abs(bt.x-pt)<threshold&&Math.abs(bt.y-xt)<threshold||s.data(St,h)===bt.touchID){B.preventDefault(),B.stopPropagation();return}St=St.parentNode}},!0)})(E,window,document);const ti=function(s,t,e){const r=s.range[0][1]-s.range[0][0],l=s.range[1][1]-s.range[1][0],h=r+l,d=s.unscaleVector(Ee(1,e)),v=Ft(Ii(d),h),b=ht(t,v),y=$t(d)[1];return s.constrainToBoundsOnAngle(b,4,y*Math.PI/180)};class Xi{constructor(t,e){F(this,"graphie");F(this,"initialPoint");this.graphie=t,this.initialPoint=e}transform(t){const e=kt.getPrefixedTransform();this.wrapper.style[e]=t}toFront(){const t=this.wrapper.parentNode;t&&t.appendChild(this.wrapper)}toBack(){const t=this.wrapper.parentNode;t!=null&&t.firstChild!==this.wrapper&&t.insertBefore(this.wrapper,t.firstChild)}remove(){this.visibleShape.remove(),E(this.wrapper).remove()}getMouseTarget(){return this.visibleShape[0]}moveTo(t){const e=ft(this.graphie.scalePoint(t),this.graphie.scalePoint(this.initialPoint)),r=kt.getCanUse3dTransform(),l="translateX("+e[0]+"px) translateY("+e[1]+"px)"+(r?" translateZ(0)":"");this.transform(l)}hide(){this.visibleShape.hide()}show(){this.visibleShape.show()}attr(...t){this.visibleShape.attr(...t)}animate(...t){this.visibleShape.animate(...t)}}const vo={center:null,createPath:null,mouselayer:!1};class bo extends Xi{constructor(e,r,l){const h=e.scalePoint(w.head(r));super(e,h);F(this,"wrapper");F(this,"visibleShape");l=w.extend({},vo,l);const d=e.fixedPath(r,l.center,l.createPath);this.wrapper=d.wrapper,this.visibleShape=d.visibleShape,l.mouselayer?(this.wrapper.style.touchAction="none",this.graphie.addToMouseLayerWrapper(this.wrapper)):this.graphie.addToVisibleLayerWrapper(this.wrapper)}}const me=class me extends bo{constructor(e,r){const l=[.75,0],d=[[-3,4],[-2.75,2.5],[0,.25],l,[0,-.25],[-2.75,-2.5],[-3,-4]].map(v=>{const b=ft(v,l),y=Ft(b,me.scale);return ht(l,y)}).map(e.unscalePoint);super(e,d,{center:e.unscalePoint(l),createPath:yo});F(this,"center");this.center=l,this.attr(w.extend({"stroke-linejoin":"round","stroke-linecap":"round","stroke-dasharray":""},r))}toCoordAtAngle(e,r){const l=this.graphie.scalePoint(ti(this.graphie,e,r));this.transform("translateX("+(l[0]+me.scale*this.center[0])+"px) translateY("+(l[1]+me.scale*this.center[1])+"px) translateZ(0) rotate("+(360-qt.bound(r))+"deg)")}};F(me,"scale",1.4);let se=me;const yo=function(s){let t="M"+s[0][0]+" "+s[0][1];for(let e=1;e<s.length;e+=3)t+="C"+s[e][0]+" "+s[e][1]+" "+s[e+1][0]+" "+s[e+1][1]+" "+s[e+2][0]+" "+s[e+2][1];return t},wo={maxScale:1,mouselayer:!1,shadow:!1,disableMouseEventsOnWrapper:!1};class li extends Xi{constructor(e,r,l,h){super(e,r);F(this,"initialPoint");F(this,"wrapper");F(this,"visibleShape");h=w.extend({},wo,h);const d=e.fixedEllipse(r,l,h.maxScale,h.padding);if(this.visibleShape=d.visibleShape,this.wrapper=d.wrapper,this.graphie=e,this.initialPoint=r,h.interactiveKindForTesting&&this.wrapper.setAttribute("data-interactive-kind-for-testing",h.interactiveKindForTesting),h.mouselayer?(this.wrapper.style.touchAction="none",this.graphie.addToMouseLayerWrapper(this.wrapper)):this.graphie.addToVisibleLayerWrapper(this.wrapper),h.shadow){const v="drop-shadow(0px 0px 5px rgba(0, 0, 0, 0.5))",b=this.wrapper;b.style.filter=v,this.moveTo=function(y){const M=ft(this.graphie.scalePoint(y),this.graphie.scalePoint(this.initialPoint)),x=kt.getCanUse3dTransform(),S="translateX("+Math.round(M[0])+"px) translateY("+Math.round(M[1])+"px)"+(x?" translateZ(0)":"");this.transform(S)}}h.disableMouseEventsOnWrapper&&(this.wrapper.style.pointerEvents="none",this.visibleShape.node.style.pointerEvents="auto")}}const xo={thickness:2,mouselayer:!1};class ci extends Xi{constructor(e,r,l,h){const d=[e.range[0][0],0],v=[e.range[0][1],0],b=e.scalePoint(d);super(e,b);F(this,"initialLength");F(this,"wrapper");F(this,"visibleShape");h=w.extend({},xo,h);const y=e.fixedLine(d,v,h.thickness);this.wrapper=y.wrapper,this.visibleShape=y.visibleShape,h.interactiveKindForTesting&&this.wrapper.setAttribute("data-interactive-kind-for-testing",h.interactiveKindForTesting),this.visibleShape.attr(h.normalStyle),this.initialPoint=b,this.initialLength=Us(e.scalePoint(d),e.scalePoint(v)),h.mouselayer?(this.wrapper.style.touchAction="none",this.graphie.addToMouseLayerWrapper(this.wrapper)):this.graphie.addToVisibleLayerWrapper(this.wrapper),this.moveTo(r,l)}getMouseTarget(){return this.wrapper}moveTo(e,r){const l=this.graphie.scalePoint(e),h=this.graphie.scalePoint(r),d=$t(ft(h,l)),v=d[0],b=qt.bound(d[1]),y=ft(l,this.initialPoint),M=qt.bound(v/this.initialLength),x=kt.getCanUse3dTransform(),S="translateX("+y[0]+"px) translateY("+y[1]+"px) "+(x?" translateZ(0)":"")+"rotate("+b+"deg) scaleX("+M+") scaleY(1)";this.transform(S)}}const{clockwise:Mo,reverseVector:Di}=Yn;function Rs(s){const t=70.2941120352484,e=.5687298702748785*20;return(t-e)*Math.exp(-.037587715462826674*s)+e}function Ie(s,t){return[s*Math.cos(t),s*Math.sin(t)*-1]}function Ae(s,t){const e=t*Math.PI/180;return Ie(s,e)}let Bt=!1;const So={bogusShape:{animate:function(){},attr:function(){},remove:function(){}}};w.extend(yt.Graphie.prototype,{labelAngle:function(s){const t=this;w.defaults(s,{point1:[0,0],vertex:[0,0],point3:[0,0],label:null,numArcs:1,showRightAngleMarker:!0,pushOut:0,clockwise:!1,style:{}});let e=s.text===void 0?"":s.text;const r=s.vertex,l=t.scalePoint(r);let h,d;s.clockwise?(h=s.point1,d=s.point3):(h=s.point3,d=s.point1);const v=yt.findAngleDeprecated(h,r),b=yt.findAngleDeprecated(d,r),y=(b+360-v)%360,M=(v+y/2)%360;let S=5*s.pushOut+Rs(y);const _=[];if(Math.abs(y-90)<1e-9&&s.showRightAngleMarker){const A=ht(l,Ae(S,v)),I=ht(l,Ae(S,b));S*=Math.SQRT2;const P=ht(l,Ae(S,M));w.each([A,I],function(H){_.push(t.scaledPath([H,P],s.style))})}else w.times(s.numArcs,function(A){_.push(t.arc(r,t.unscaleVector(S),v,b,s.style)),S+=3});if(e){const A=e.match(/\$deg(\d)?/);if(A){const O=A[1]||1;e=e.replace(A[0],qt.toFixedApprox(y,O)+"^{\\circ}")}const I=Ae(S+15,M),P=ht(l,I),H=t.unscalePoint(P);s.label?(s.label.setPosition(H),s.label.processMath(e,!0)):t.label(H,e,"center",s.style)}return _},labelSide:function(s){const t=this;w.defaults(s,{point1:[0,0],point2:[0,0],label:null,text:"",numTicks:0,numArrows:0,clockwise:!1,style:{}});let e,r;s.clockwise?(e=s.point1,r=s.point2):(e=s.point2,r=s.point1);const l=[(e[0]+r[0])/2,(e[1]+r[1])/2],h=t.scalePoint(l),d=Math.atan2(r[1]-e[1],r[0]-e[0]),v=d+Math.PI/2,b=[];let y=0;if(s.numTicks){const x=s.numTicks,S=5,_=5,A=w.extend({},s.style,{strokeWidth:2});w.times(x,function(I){const P=S*(I-(x-1)/2),H=Ie(P,d),O=Ie(_,v),z=[ht(h,H,O),ht(h,H,Di(O))];b.push(t.scaledPath(z,A))}),y+=S*(x-1)+15}if(s.numArrows){const x=s.numArrows,S=[e,r].sort(function(P,H){return P[1]===H[1]?P[0]-H[0]:P[1]-H[1]})[0],_=t.scalePoint(S),A=w.extend({},s.style,{arrows:"->",strokeWidth:2}),I=5;w.times(x,function(P){const H=y+I*P;let O=Ie(H,d);S!==e&&(O=Di(O));const z=ht(h,O);b.push(t.scaledPath([_,z],A))})}let M=s.text;if(M){const x=M.match(/\$len(\d)?/);if(x){const P=yt.getDistance(e,r),H=x[1]||1;M=M.replace(x[0],qt.toFixedApprox(P,H))}const _=Ie(20,v),A=ht(h,_),I=t.unscalePoint(A);s.label?(s.label.setPosition(I),s.label.processMath(M,!0)):t.label(I,M,"center",s.style)}return b},labelVertex:function(s){const t=this;if(w.defaults(s,{point1:null,vertex:[0,0],point3:null,label:null,text:"",clockwise:!1,style:{}}),!s.text)return;const e=s.vertex,r=t.scalePoint(e);let l,h;s.clockwise?(l=s.point1,h=s.point3):(l=s.point3,h=s.point1);let d=135,v;if(l&&h){const S=yt.findAngleDeprecated(l,e);d=(yt.findAngleDeprecated(h,e)+360-S)%360,v=(S+d/2+180)%360}else l?v=yt.findAngleDeprecated(e,l)+90:h?v=yt.findAngleDeprecated(h,e)+90:v=135;const b=10+Rs(360-d),y=Ae(b,v),M=ht(r,y),x=t.unscalePoint(M);s.label?(s.label.setPosition(x),s.label.processMath(s.text,!0)):t.label(x,s.text,"center",s.style)},addMovablePoint:function(s){const t=E.extend(!0,{graph:this,coord:[0,0],snapX:0,snapY:0,pointSize:4,highlight:!1,dragging:!1,visible:!0,bounded:!0,constraints:{fixed:!1,constrainX:!1,constrainY:!1,fixedAngle:{},fixedDistance:{}},lineStarts:[],lineEnds:[],polygonVertices:[],normalStyle:{},highlightStyle:{fill:Y.INTERACTING,stroke:Y.INTERACTING},labelStyle:{color:Y.INTERACTIVE},vertexLabel:"",mouseTarget:null},s),e=t.constraints.fixed?Y.DYNAMIC:Y.INTERACTIVE;t.normalStyle=w.extend({},{fill:e,stroke:e},s.normalStyle),s.coordX!==void 0&&(t.coord[0]=s.coordX),s.coordY!==void 0&&(t.coord[1]=s.coordY);const r=t.graph,l=function(d){t.visible&&t.bounded&&!t.constraints.fixed&&(d=r.constrainToBounds(d,10));let v=d[0],b=d[1];if(t.snapX!==0&&(v=Math.round(v/t.snapX)*t.snapX),t.snapY!==0&&(b=Math.round(b/t.snapY)*t.snapY),t.constraints.fixedDistance.snapPoints){const M=r.scalePoint(d);let x=M[0],S=M[1];const _=2*Math.PI/t.constraints.fixedDistance.snapPoints,A=t.constraints.fixedDistance.dist,I=t.constraints.fixedDistance.point,P=(I[0]-r.range[0][0])*r.scale[0],H=(-I[1]+r.range[1][1])*r.scale[1];let O=x-P,z=-S+H,J=Math.atan(z/O);O<0&&(J+=Math.PI),J=Math.round(J/_)*_,O=A*Math.cos(J),z=A*Math.sin(J),x=O+P,S=-z+H,v=qt.roundTo(5,x/r.scale[0]+r.range[0][0]),b=qt.roundTo(5,r.range[1][1]-S/r.scale[1])}return t.applyConstraint([v,b])};t.applyConstraint=function(d,v,b){let y=d.slice();const M={};if(b?E.extend(M,{fixed:!1,constrainX:!1,constrainY:!1,fixedAngle:{},fixedDistance:{}},v):E.extend(M,this.constraints,v),M.constrainX)y=[this.coord[0],d[1]];else if(M.constrainY)y=[d[0],this.coord[1]];else if(typeof M.fixedAngle.angle=="number"&&typeof M.fixedDistance.dist=="number"){const x=M.fixedAngle.vertex.coord||M.fixedAngle.vertex,S=M.fixedAngle.ref.coord||M.fixedAngle.ref,_=M.fixedDistance.point.coord||M.fixedDistance.point,A=(M.fixedAngle.angle+yt.findAngleDeprecated(S,x))*Math.PI/180,I=M.fixedDistance.dist;y[0]=I*Math.cos(A)+_[0],y[1]=I*Math.sin(A)+_[1]}else if(typeof M.fixedAngle.angle=="number"){const x=M.fixedAngle.vertex.coord||M.fixedAngle.vertex,S=M.fixedAngle.ref.coord||M.fixedAngle.ref,_=(M.fixedAngle.angle+yt.findAngleDeprecated(S,x))*Math.PI/180,A=yt.findAngleDeprecated(d,x)*Math.PI/180;let P=yt.getDistance(d,x)*Math.cos(_-A);P=P<1?1:P,y[0]=P*Math.cos(_)+x[0],y[1]=P*Math.sin(_)+x[1]}else if(typeof M.fixedDistance.dist=="number"){const x=M.fixedDistance.point.coord||M.fixedDistance.point;let S=yt.findAngleDeprecated(d,x);const _=M.fixedDistance.dist;S=S*Math.PI/180,y[0]=_*Math.cos(S)+x[0],y[1]=_*Math.sin(S)+x[1]}else M.fixed&&(y=t.coord);return y},t.coord=l(t.coord);const h=2;if(t.visible&&r.style(t.normalStyle,function(){const d=[t.pointSize/r.scale[0],t.pointSize/r.scale[1]],v={maxScale:h,padding:2};t.visibleShape=new li(r,t.coord,d,v),t.visibleShape.attr(w.omit(t.normalStyle,"scale")),t.visibleShape.toFront()}),t.normalStyle.scale=1,t.highlightStyle.scale=h,t.vertexLabel&&(t.labeledVertex=this.label([0,0],"","center",t.labelStyle)),t.drawLabel=function(){t.vertexLabel&&t.graph.labelVertex({vertex:t.coord,label:t.labeledVertex,text:t.vertexLabel,style:t.labelStyle})},t.drawLabel(),t.grab=function(d){d=d||[0,0],E(document).bind("vmousemove.point vmouseup.point",function(v){v.preventDefault(),t.dragging=!0,Bt=!0;let b=ht(r.getMouseCoord(v),d);b=l(b);let y=b[0],M=b[1],x,S;if(v.type==="vmousemove"){let _=!0;if(w.isFunction(t.onMove)){const A=t.onMove(y,M);A===!1&&(_=!1),w.isArray(A)&&(y=A[0],M=A[1])}if(x=(y-r.range[0][0])*r.scale[0],S=(-M+r.range[1][1])*r.scale[1],_){const A=r.unscalePoint([x,S]);t.visibleShape.moveTo(A),t.mouseTarget.moveTo(A),t.coord=[y,M],t.updateLineEnds(),E(t).trigger("move")}t.drawLabel()}else if(v.type==="vmouseup"){if(E(document).unbind(".point"),t.dragging=!1,Bt=!1,w.isFunction(t.onMoveEnd)){const _=t.onMoveEnd(y,M);if(w.isArray(_)){y=_[0],M=_[1],x=(y-r.range[0][0])*r.scale[0],S=(-M+r.range[1][1])*r.scale[1];const A=r.unscalePoint([x,S]);t.visibleShape.moveTo(A),t.mouseTarget.moveTo(A),t.coord=[y,M]}}t.highlight||(t.visibleShape.animate(t.normalStyle,50),t.onUnhighlight&&t.onUnhighlight())}})},t.visible&&!t.constraints.fixed){if(!t.mouseTarget){const v=r.unscaleVector(16),b={mouselayer:!0,padding:0,disableMouseEventsOnWrapper:!0,interactiveKindForTesting:"movable-point"};t.mouseTarget=new li(r,t.coord,v,b),t.mouseTarget.attr({fill:"#000",opacity:0})}const d=E(t.mouseTarget.getMouseTarget());d.css("cursor","move"),d.bind("vmousedown vmouseover vmouseout",function(v){if(v.type==="vmouseover")t.highlight=!0,Bt||(t.visibleShape.animate(t.highlightStyle,50),t.onHighlight&&t.onHighlight());else if(v.type==="vmouseout")t.highlight=!1,!t.dragging&&!Bt&&(t.visibleShape.animate(t.normalStyle,50),t.onUnhighlight&&t.onUnhighlight());else if(v.type==="vmousedown"&&(v.which===1||v.which===0)){v.preventDefault();const b=t.coord,y=r.getMouseCoord(v),x=!("ontouchstart"in window)?[0,0]:ft(b,y);t.grab(x)}})}return t.moveTo=function(d,v,b){const M=yt.getDistance(this.graph.scalePoint([d,v]),this.graph.scalePoint(this.coord))*5,x=b&&function(S){t.coord=S,t.updateLineEnds()};this.visibleShape.animateTo([d,v],M,x),this.mouseTarget.animateTo([d,v],M,x),this.coord=[d,v],w.isFunction(this.onMove)&&this.onMove(d,v)},t.updateLineEnds=function(){E(this.lineStarts).each(function(){this.coordA=t.coord,this.transform()}),E(this.lineEnds).each(function(){this.coordZ=t.coord,this.transform()}),E(this.polygonVertices).each(function(){this.transform()})},t.setCoord=function(d){this.visible&&(this.visibleShape.moveTo(d),this.mouseTarget!=null&&this.mouseTarget.moveTo(d)),this.coord=d.slice()},t.setCoordConstrained=function(d){this.setCoord(l(d))},t.toBack=function(){this.visible&&(this.mouseTarget!=null&&this.mouseTarget.toBack(),this.visibleShape.toBack())},t.toFront=function(){this.visible&&(this.mouseTarget!=null&&this.mouseTarget.toFront(),this.visibleShape.toFront())},t.remove=function(){this.visibleShape&&this.visibleShape.remove(),this.mouseTarget&&this.mouseTarget.remove(),this.labeledVertex&&this.labeledVertex.remove()},t},addMovableLineSegment:function(s){const t=E.extend({graph:this,coordA:[0,0],coordZ:[1,1],snapX:0,snapY:0,fixed:!1,ticks:0,normalStyle:{},highlightStyle:{stroke:Y.INTERACTING,"stroke-width":6},labelStyle:{stroke:Y.INTERACTIVE,color:Y.INTERACTIVE},highlight:!1,dragging:!1,tick:[],extendLine:!1,extendRay:!1,constraints:{fixed:!1,constrainX:!1,constrainY:!1},sideLabel:"",vertexLabels:[],numArrows:0,numTicks:0,movePointsWithLine:!1},s),e=t.fixed?Y.DYNAMIC:Y.INTERACTIVE;t.normalStyle=w.extend({},{"stroke-width":2,stroke:e},s.normalStyle),t.arrowStyle=w.extend({},t.normalStyle,{color:t.normalStyle.stroke}),s.pointA!==void 0?(t.coordA=s.pointA.coord,t.pointA.lineStarts.push(t)):s.coordA!==void 0&&(t.coordA=s.coordA.slice()),s.pointZ!==void 0?(t.coordZ=s.pointZ.coord,t.pointZ.lineEnds.push(t)):s.coordA!==void 0&&(t.coordA=t.coordA.slice());const r=t.graph;r.style(t.normalStyle);for(let h=0;h<t.ticks;++h)t.tick[h]=So.bogusShape;let l=yt.unscaledSvgPath([[0,0],[1,0]]);for(let h=0;h<t.ticks;++h){const d=.5-(t.ticks-1+h*2)/r.scale[0];l+=yt.unscaledSvgPath([[d,-7],[d,7]])}if(s={thickness:Math.max(t.normalStyle["stroke-width"],t.highlightStyle["stroke-width"])},t.visibleLine=new ci(r,[0,0],[1,0],s),t.visibleLine.attr(t.normalStyle),!t.fixed){const h={thickness:30,mouselayer:!0,interactiveKindForTesting:"movable-line"};t.mouseTarget=new ci(r,[0,0],[1,0],h),t.mouseTarget.attr({fill:"#000",opacity:0})}if(t.transform=function(h){h&&(typeof this.pointA=="object"&&(this.coordA=this.pointA.coord),typeof this.pointZ=="object"&&(this.coordZ=this.pointZ.coord));const d=function(I){const P=I.graph.scalePoint(I.coordA),H=I.graph.scalePoint(I.coordZ);return $t(ft(H,P))[1]},v=function(I,P,H){I=t.graph;const O=I.range[0][1]-I.range[0][0],z=I.range[1][1]-I.range[1][0],J=O+z,it=I.unscaleVector(Ee(1,H)),tt=Ft(Ii(it),J),L=ht(P,tt),rt=$t(it)[1];return I.constrainToBoundsOnAngle(L,4,rt*Math.PI/180)},b=d(this);let y=this.coordA,M=this.coordZ;this.extendLine?(y=v(r,y,360-b),M=v(r,M,(540-b)%360)):this.extendRay&&(M=v(r,y,360-b));const x=[this.visibleLine];this.fixed||x.push(this.mouseTarget),w.each(x,function(I){I.moveTo(y,M)}),this._arrows==null&&(this._arrows=[],this.extendLine?(this._arrows.push(new se(r,this.normalStyle)),this._arrows.push(new se(r,this.normalStyle))):this.extendRay&&this._arrows.push(new se(r,this.normalStyle)));const S=[this.coordA,this.coordZ],_=[360-b,(540-b)%360];w.each(this._arrows,function(I,P){I.toCoordAtAngle(S[P],_[P])}),w.invoke(this.temp,"remove"),this.temp=[];const A=this.coordA[0]<this.coordZ[0]||this.coordA[0]===this.coordZ[0]&&this.coordA[1]>this.coordZ[1];this.sideLabel&&this.temp.push(this.graph.labelSide({point1:this.coordA,point2:this.coordZ,label:this.labeledSide,text:this.sideLabel,numArrows:this.numArrows,numTicks:this.numTicks,clockwise:A,style:this.labelStyle})),this.vertexLabels.length&&(this.graph.labelVertex({vertex:this.coordA,point3:this.coordZ,label:this.labeledVertices[0],text:this.vertexLabels[0],clockwise:A,style:this.labelStyle}),this.graph.labelVertex({point1:this.coordA,vertex:this.coordZ,label:this.labeledVertices[1],text:this.vertexLabels[1],clockwise:A,style:this.labelStyle})),this.temp=w.flatten(this.temp)},t.toBack=function(){t.fixed||t.mouseTarget.toBack(),t.visibleLine.toBack()},t.toFront=function(){t.fixed||t.mouseTarget.toFront(),t.visibleLine.toFront()},t.remove=function(){t.fixed||t.mouseTarget.remove(),t.visibleLine.remove(),t.labeledSide&&t.labeledSide.remove(),t.labeledVertices&&w.invoke(t.labeledVertices,"remove"),t._arrows&&w.invoke(t._arrows,"remove"),t.temp.length&&w.invoke(t.temp,"remove")},t.hide=function(){t.visibleLine.hide(),t.temp.length&&w.invoke(t.temp,"hide"),t._arrows&&w.invoke(t._arrows,"hide")},t.show=function(){t.visibleLine.show(),t.temp.length&&w.invoke(t.temp,"show"),t._arrows&&w.invoke(t._arrows,"show")},t.sideLabel&&(t.labeledSide=this.label([0,0],"","center",t.labelStyle)),t.vertexLabels.length&&(t.labeledVertices=w.map(t.vertexLabels,function(h){return this.label([0,0],"","center",t.labelStyle)},this)),!t.fixed&&!t.constraints.fixed){const h=E(t.mouseTarget.getMouseTarget());h.css("cursor","move"),h.bind("vmousedown vmouseover vmouseout",function(d){if(d.type==="vmouseover")Bt||(t.highlight=!0,t.visibleLine.animate(t.highlightStyle,50),t.arrowStyle=w.extend({},t.arrowStyle,{color:t.highlightStyle.stroke,stroke:t.highlightStyle.stroke}),t.transform());else if(d.type==="vmouseout")t.highlight=!1,t.dragging||(t.visibleLine.animate(t.normalStyle,50),t.arrowStyle=w.extend({},t.arrowStyle,{color:t.normalStyle.stroke,stroke:t.normalStyle.stroke}),t.transform());else if(d.type==="vmousedown"&&(d.which===1||d.which===0)){d.preventDefault();let v=(d.pageX-E(r.raphael.canvas.parentNode).offset().left)/r.scale[0]+r.range[0][0],b=r.range[1][1]-(d.pageY-E(r.raphael.canvas.parentNode).offset().top)/r.scale[1];t.snapX>0&&(v=Math.round(v/t.snapX)*t.snapX),t.snapY>0&&(b=Math.round(b/t.snapY)*t.snapY);const y=[t.coordA[0]-v,t.coordA[1]-b],M=[t.coordZ[0]-v,t.coordZ[1]-b],x=-Math.min(r.scaleVector(y)[0],r.scaleVector(M)[0]),S=Math.max(r.scaleVector(y)[0],r.scaleVector(M)[0]),_=Math.max(r.scaleVector(y)[1],r.scaleVector(M)[1]),A=-Math.min(r.scaleVector(y)[1],r.scaleVector(M)[1]);E(document).bind("vmousemove.lineSegment vmouseup.lineSegment",function(I){I.preventDefault(),t.dragging=!0,Bt=!0;let P=I.pageX-E(r.raphael.canvas.parentNode).offset().left,H=I.pageY-E(r.raphael.canvas.parentNode).offset().top;P=Math.max(x+10,Math.min(r.xpixels-10-S,P)),H=Math.max(_+10,Math.min(r.ypixels-10-A,H));let O=P/r.scale[0]+r.range[0][0],z=r.range[1][1]-H/r.scale[1];if(t.snapX>0&&(O=Math.round(O/t.snapX)*t.snapX),t.snapY>0&&(z=Math.round(z/t.snapY)*t.snapY),I.type==="vmousemove"){t.constraints.constrainX&&(O=t.coordA[0]-y[0]),t.constraints.constrainY&&(z=t.coordA[1]-y[1]);const J=O+y[0]-t.coordA[0],it=z+y[1]-t.coordA[1];t.coordA=[O+y[0],z+y[1]],t.coordZ=[O+M[0],z+M[1]],t.transform(),t.movePointsWithLine&&(typeof t.pointA=="object"&&t.pointA.setCoord([t.pointA.coord[0]+J,t.pointA.coord[1]+it]),typeof t.pointZ=="object"&&t.pointZ.setCoord([t.pointZ.coord[0]+J,t.pointZ.coord[1]+it])),w.isFunction(t.onMove)&&t.onMove(J,it)}else I.type==="vmouseup"&&(E(document).unbind(".lineSegment"),t.dragging=!1,Bt=!1,t.highlight||(t.visibleLine.animate(t.normalStyle,50),t.arrowStyle=w.extend({},t.arrowStyle,{color:t.normalStyle.stroke,stroke:t.normalStyle.stroke}),t.transform()),w.isFunction(t.onMoveEnd)&&t.onMoveEnd());E(t).trigger("move")})}})}return t.pointA!==void 0&&t.pointA.toFront(),t.pointZ!==void 0&&t.pointZ.toFront(),t.transform(),t},addMovablePolygon:function(s){const t=this,e=E.extend({snapX:0,snapY:0,fixed:!1,constrainToGraph:!0,normalStyle:{},highlightStyle:{stroke:Y.INTERACTING,"stroke-width":2,fill:Y.INTERACTING,"fill-opacity":.05},pointHighlightStyle:{fill:Y.INTERACTING,stroke:Y.INTERACTING},labelStyle:{stroke:Y.DYNAMIC,"stroke-width":1,color:Y.DYNAMIC},angleLabels:[],showRightAngleMarkers:[],sideLabels:[],vertexLabels:[],numArcs:[],numArrows:[],numTicks:[],updateOnPointMove:!0,closed:!0},w.omit(s,"points")),r=e.fixed?Y.DYNAMIC:Y.INTERACTIVE;e.normalStyle=w.extend({"stroke-width":2,"fill-opacity":0,fill:r,stroke:r},s.normalStyle),e.points=s.points;const l=function(h){return!w.isArray(h)};if(e.update=function(){const h=e.points.length;e.coords=w.map(e.points,function(b,y){return l(b)?b.coord:b}),e.left=w.min(w.pluck(e.coords,0)),e.right=w.max(w.pluck(e.coords,0)),e.top=w.max(w.pluck(e.coords,1)),e.bottom=w.min(w.pluck(e.coords,1));let d=w.map(e.coords,function(b){return t.scalePoint(b)});e.closed?d.push(!0):d=d.concat(w.clone(d).reverse()),e.path=yt.unscaledSvgPath(d),w.invoke(e.temp,"remove"),e.temp=[];const v=Mo(e.coords);(e.angleLabels.length||e.showRightAngleMarkers.length)&&w.each(e.labeledAngles,function(b,y){e.temp.push(t.labelAngle({point1:e.coords[(y-1+h)%h],vertex:e.coords[y],point3:e.coords[(y+1)%h],label:b,text:e.angleLabels[y],showRightAngleMarker:e.showRightAngleMarkers[y],numArcs:e.numArcs[y],clockwise:v,style:e.labelStyle}))}),e.sideLabels.length&&w.each(e.labeledSides,function(b,y){e.temp.push(t.labelSide({point1:e.coords[y],point2:e.coords[(y+1)%h],label:b,text:e.sideLabels[y],numArrows:e.numArrows[y],numTicks:e.numTicks[y],clockwise:v,style:e.labelStyle}))}),e.vertexLabels.length&&w.each(e.labeledVertices,function(b,y){t.labelVertex({point1:e.coords[(y-1+h)%h],vertex:e.coords[y],point3:e.coords[(y+1)%h],label:b,text:e.vertexLabels[y],clockwise:v,style:e.labelStyle})}),e.temp=w.flatten(e.temp)},e.transform=function(){e.update(),e.visibleShape.attr({path:e.path}),e.fixed||e.mouseTarget.attr({path:e.path})},e.remove=function(){e.visibleShape.remove(),e.fixed||e.mouseTarget.remove(),e.labeledAngles&&w.invoke(e.labeledAngles,"remove"),e.labeledSides&&w.invoke(e.labeledSides,"remove"),e.labeledVertices&&w.invoke(e.labeledVertices,"remove"),e.temp.length&&w.invoke(e.temp,"remove")},e.toBack=function(){e.fixed||e.mouseTarget.toBack(),e.visibleShape.toBack()},e.toFront=function(){e.fixed||e.mouseTarget.toFront(),e.visibleShape.toFront()},e.updateOnPointMove&&w.each(w.filter(e.points,l),function(h){h.polygonVertices.push(e)}),e.coords=new Array(e.points.length),e.angleLabels.length){const h=Math.max(e.angleLabels.length,e.showRightAngleMarkers.length);e.labeledAngles=w.times(h,function(){return this.label([0,0],"","center",e.labelStyle)},this)}return e.sideLabels.length&&(e.labeledSides=w.map(e.sideLabels,function(h){return this.label([0,0],"","center",e.labelStyle)},this)),e.vertexLabels.length&&(e.labeledVertices=w.map(e.vertexLabels,function(h){return this.label([0,0],"","center",e.labelStyle)},this)),e.update(),e.visibleShape=t.raphael.path(e.path),e.visibleShape.attr(e.normalStyle),e.fixed||(e.mouseTarget=t.mouselayer.path(e.path),e.mouseTarget.attr({fill:"#000",opacity:0,cursor:"move"}),E(e.mouseTarget[0]).bind("vmousedown vmouseover vmouseout",function(h){if(h.type==="vmouseover")(!Bt||e.dragging)&&(e.highlight=!0,e.visibleShape.animate(e.highlightStyle,50),w.each(w.filter(e.points,l),function(d){d.visibleShape.animate(e.pointHighlightStyle,50)}));else if(h.type==="vmouseout"){if(e.highlight=!1,!e.dragging){e.visibleShape.animate(e.normalStyle,50);const d=w.filter(e.points,l);w.any(w.pluck(d,"dragging"))||w.each(d,function(v){v.visibleShape.animate(v.normalStyle,50)})}}else if(h.type==="vmousedown"&&(h.which===1||h.which===0)){h.preventDefault(),w.each(w.filter(e.points,l),function(I){I.dragging=!0});let d=(h.pageX-E(t.raphael.canvas.parentNode).offset().left)/t.scale[0]+t.range[0][0],v=t.range[1][1]-(h.pageY-E(t.raphael.canvas.parentNode).offset().top)/t.scale[1];e.snapX>0&&(d=Math.round(d/e.snapX)*e.snapX),e.snapY>0&&(v=Math.round(v/e.snapY)*e.snapY);let b=d,y=v;const M=e.coords.slice(),x=(d-e.left)*t.scale[0],S=(e.right-d)*t.scale[0],_=(e.top-v)*t.scale[1],A=(v-e.bottom)*t.scale[1];E(document).bind("vmousemove.polygon vmouseup.polygon",function(I){I.preventDefault(),e.dragging=!0,Bt=!0;let P=I.pageX-E(t.raphael.canvas.parentNode).offset().left,H=I.pageY-E(t.raphael.canvas.parentNode).offset().top;e.constrainToGraph&&(P=Math.max(x+10,Math.min(t.xpixels-10-S,P)),H=Math.max(_+10,Math.min(t.ypixels-10-A,H)));let O=P/t.scale[0]+t.range[0][0],z=t.range[1][1]-H/t.scale[1];if(e.snapX>0&&(O=Math.round(O/e.snapX)*e.snapX),e.snapY>0&&(z=Math.round(z/e.snapY)*e.snapY),I.type==="vmousemove"){let J=O-d,it=z-v,tt=!0;if(w.isFunction(e.onMove)){const rt=e.onMove(J,it);rt===!1?tt=!1:w.isArray(rt)&&(J=rt[0],it=rt[1],O=d+J,z=v+it)}const L=function(rt){return[M[rt][0]+J,M[rt][1]+it]};tt&&(w.each(e.points,function(rt,q){l(rt)?rt.setCoord(L(q)):e.points[q]=L(q)}),e.transform(),E(e).trigger("move"),b=O,y=z)}else if(I.type==="vmouseup"){E(document).unbind(".polygon");const J=w.filter(e.points,l);w.each(J,function(it){it.dragging=!1}),e.dragging=!1,Bt=!1,e.highlight||(e.visibleShape.animate(e.normalStyle,50),w.each(J,function(it){it.visibleShape.animate(it.normalStyle,50)})),w.isFunction(e.onMoveEnd)&&e.onMoveEnd(b-d,y-v)}})}})),w.invoke(w.filter(e.points,l),"toFront"),e},constrainToBounds:function(s,t){const e=this.unscalePoint([t,this.ypixels-t]),r=this.unscalePoint([this.xpixels-t,t]),l=Math.max(e[0],Math.min(r[0],s[0])),h=Math.max(e[1],Math.min(r[1],s[1]));return[l,h]},constrainToBoundsOnAngle:function(s,t,e){const r=this.unscalePoint([t,this.ypixels-t]),l=this.unscalePoint([this.xpixels-t,t]);let h=s.slice();return h[0]<r[0]?h=[r[0],h[1]+(r[0]-h[0])*Math.tan(e)]:h[0]>l[0]&&(h=[l[0],h[1]-(h[0]-l[0])*Math.tan(e)]),h[1]<r[1]?h=[h[0]+(r[1]-h[1])/Math.tan(e),r[1]]:h[1]>l[1]&&(h=[h[0]-(h[1]-l[1])/Math.tan(e),l[1]]),h},addMovableAngle:function(s){return new Qs(this,s)},addCircleGraph:function(s){const t=this,e=E.extend({center:[0,0],radius:2,snapX:.5,snapY:.5,snapRadius:.5,minRadius:1,centerConstraints:{},centerNormalStyle:{},centerHighlightStyle:{stroke:Y.INTERACTING,fill:Y.INTERACTING},circleNormalStyle:{stroke:Y.INTERACTIVE,"fill-opacity":0},circleHighlightStyle:{stroke:Y.INTERACTING,fill:Y.INTERACTING,"fill-opacity":.05}},s),r=e.centerConstraints.fixed?Y.DYNAMIC:Y.INTERACTIVE,l=s?s.centerNormalStyle:null;e.centerNormalStyle=w.extend({},{fill:r,stroke:r},l),e.centerPoint=t.addMovablePoint({graph:t,coord:e.center,normalStyle:e.centerNormalStyle,snapX:e.snapX,snapY:e.snapY,constraints:e.centerConstraints}),e.circ=t.circle(e.center,e.radius,e.circleNormalStyle),e.perim=t.mouselayer.circle(t.scalePoint(e.center)[0],t.scalePoint(e.center)[1],t.scaleVector(e.radius)[0]).attr({"stroke-width":20,opacity:.002}),e.centerConstraints.fixed||E(e.centerPoint.mouseTarget.getMouseTarget()).on("vmouseover vmouseout",function(d){e.centerPoint.highlight||e.centerPoint.dragging?e.circ.animate(e.circleHighlightStyle,50):e.circ.animate(e.circleNormalStyle,50)}),e.toFront=function(){e.circ.toFront(),e.perim.toFront(),e.centerPoint.visibleShape.toFront(),e.centerConstraints.fixed||e.centerPoint.mouseTarget.toFront()},e.centerPoint.onMove=function(d,v){e.toFront(),e.circ.attr({cx:t.scalePoint(d)[0],cy:t.scalePoint(v)[1]}),e.perim.attr({cx:t.scalePoint(d)[0],cy:t.scalePoint(v)[1]}),e.onMove&&e.onMove(d,v)},E(e.centerPoint).on("move",function(){e.center=this.coord,E(e).trigger("move")}),e.setCenter=function(d,v){e.centerPoint.setCoord([d,v]),e.centerPoint.onMove(d,v),e.center=[d,v]},e.setRadius=function(d){e.radius=d,e.perim.attr({r:t.scaleVector(d)[0]}),e.circ.attr({rx:t.scaleVector(d)[0],ry:t.scaleVector(d)[1]})},e.remove=function(){e.centerPoint.remove(),e.circ.remove(),e.perim.remove()};const h=[[Math.PI*-1,Math.PI*-.875,"ew-resize"],[Math.PI*-.875,Math.PI*-.625,"nesw-resize"],[Math.PI*-.625,Math.PI*-.375,"ns-resize"],[Math.PI*-.375,Math.PI*-.125,"nwse-resize"],[Math.PI*-.125,Math.PI*.125,"ew-resize"],[Math.PI*.125,Math.PI*.375,"nesw-resize"],[Math.PI*.375,Math.PI*.625,"ns-resize"],[Math.PI*.625,Math.PI*.875,"nwse-resize"],[Math.PI*.875,Math.PI*1,"ew-resize"]];return E(e.perim.node).on("vmousemove",d=>{let[v,b]=this.getMouseCoord(d);v-=e.center[0],b-=e.center[1];const y=Math.atan2(b,v);h.forEach(function(M){const[x,S,_]=M;y>=x&&y<S&&E(e.perim.node).css("cursor",_)})}),E(e.perim.node).css("cursor","nesw-resize"),e.perim.node.addEventListener("touchstart",function(d){d.preventDefault()},{passive:!1}),E(e.perim.node).on("vmouseover vmouseout vmousedown",function(d){if(d.type==="vmouseover")e.highlight=!0,Bt||(e.circ.animate(e.circleHighlightStyle,50),e.centerPoint.visibleShape.animate(e.centerHighlightStyle,50));else if(d.type==="vmouseout")e.highlight=!1,!e.dragging&&!e.centerPoint.dragging&&(e.circ.animate(e.circleNormalStyle,50),e.centerPoint.visibleShape.animate(e.centerNormalStyle,50));else if(d.type==="vmousedown"&&(d.which===1||d.which===0)){d.preventDefault(),e.toFront();const v=e.radius;E(document).on("vmousemove vmouseup",function(b){if(b.preventDefault(),e.dragging=!0,Bt=!0,b.type==="vmousemove"){const y=t.constrainToBounds(t.getMouseCoord(b),10);let M=yt.getDistance(e.centerPoint.coord,y);M=Math.max(e.minRadius,Math.round(M/e.snapRadius)*e.snapRadius);const x=e.radius;let S=!0;if(e.onResize){const _=e.onResize(M,x);w.isNumber(_)?M=_:_===!1&&(S=!1)}S&&(e.setRadius(M),E(e).trigger("move"))}else b.type==="vmouseup"&&(E(document).off("vmousemove vmouseup"),e.dragging=!1,Bt=!1,e.onResizeEnd&&e.onResizeEnd(e.radius,v))})}}),e},addRotateHandle:function(){const s=function(t,e,r,l,h,d,v){const b=function(x,S){const _=r+S,A=Ee(_,d+x),I=ht(e,A),P=t.scalePoint(I);return P[0]+","+P[1]},y=t.scaleVector(r-l),M=t.scaleVector(r+l);return t.raphael.path(" M"+b(h,-l)+" L"+b(h,-3*l)+" L"+b(2*h,0)+" L"+b(h,3*l)+" L"+b(h,l)+" A"+M[0]+","+M[1]+",0,0,1,"+b(-h,l)+" L"+b(-h,3*l)+" L"+b(-2*h,0)+" L"+b(-h,-3*l)+" L"+b(-h,-l)+" A"+y[0]+","+y[1]+",0,0,0,"+b(h,-l)+" Z").attr({stroke:null,fill:v?Y.INTERACTING:Y.INTERACTIVE})};return function(t){const e=this;let r=t.center;const l=t.radius,h=t.lengthAngle||30,d=t.hideArrow||!1,v=t.mouseTarget,b=w.uniqueId("rotateHandle");w.isArray(r)&&(r={coord:r});const y=e.addMovablePoint({coord:_s(r.coord,Ee(l,t.angleDeg||0)),constraints:{fixedDistance:{dist:l,point:r}},mouseTarget:v});r.toFront();let M=r.coord,x=y.coord,S=x,_=!1,A=!1,I;const P=function(z){if(d)return;const J=ft(z,r.coord),tt=$t(J)[1];I&&I.remove(),I=s(e,r.coord,t.radius,_||A?t.hoverWidth/2:t.width/2,h,tt,_||A)};E(r).on("move."+b,function(){const z=ft(r.coord,M);y.setCoord(ht(y.coord,z)),P(y.coord),M=r.coord,y.constraints.fixedDistance.point=r,x=y.coord}),y.onMove=function(z,J){_||(S=x,_=!0);let it=[z,J];if(t.onMove){const tt=$t(ft(x,r.coord)),L=$t(ft(it,r.coord)),rt=tt[1],q=L[1];let G=t.onMove(q,rt);G!=null&&G!==!0&&(G===!1&&(G=rt),it=ht(r.coord,Ee(tt[0],G)))}return P(it),x=it,it},y.onMoveEnd=function(){if(_=!1,P(y.coord),t.onMoveEnd){const z=$t(ft(S,r.coord)),J=$t(ft(y.coord,r.coord));t.onMoveEnd(J[1],z[1])}},y.visibleShape.remove(),v||y.mouseTarget.attr({scale:2});const H=E(y.mouseTarget.getMouseTarget());H.bind("vmouseover",function(z){A=!0,P(y.coord)}),H.bind("vmouseout",function(z){A=!1,P(y.coord)}),P(y.coord);const O=y.remove;return y.remove=function(){O.call(y),I&&I.remove(),E(r).off("move."+b)},y.update=function(){P(y.coord)},y}}(),addReflectButton:function(){const s=function(t,e,r,l,h,d,v){Zs(r[0],r[1])&&(r=[r[0],_s(r[0],[1,1])]);const b=Ii(ft(r[1],r[0])),y=Ft(b,l/2),M=Ft(b,h),x=je(M,90),S=je(M,-90),_=Xn(y),A=je(y,90),I=je(y,-90),P=pe(e,x),H=pe(e,S),O=pe(e,x,y,A),z=pe(e,x,_,A),J=pe(e,S,y,I),it=pe(e,S,_,I),tt=t.path([P,O,z,!0],d),L=t.path([H,J,it,!0],v);return{remove:function(){tt.remove(),L.remove()}}};return function(t){const e=this,r=t.line,l=e.addMovablePoint({constraints:t.constraints,coord:Ps([r.pointA.coord,r.pointZ.coord]),snapX:e.snap[0],snapY:e.snap[1],onMove:function(P,H){return!1},onMoveEnd:function(P,H){t.onMoveEnd&&t.onMoveEnd.call(this,P,H)}});let h=!1,d=!1,v;const b=function(){return h},y=w.map([0,1],function(P){const H=P?t.highlightStyle:t.normalStyle;return w.map([0,1],function(O){return w.defaults({"fill-opacity":O},H)})}),M=function(P){return d&&(P=!P),y[+b()][+P]},x=function(P,H){v&&v.remove(),v=s(e,P,H,b()?t.size*1.5:t.size,b()?t.size*.125:.25,M(0),M(1))},S=function(P,H){P=P||r.pointA.coord,H=H||r.pointZ.coord;const O=Ps([P,H]);l.setCoord(O),x(O,[P,H])};E(r).on("move",w.bind(S,l,null,null));const _=E(l.mouseTarget.getMouseTarget());_.on("vclick",function(){t.onClick()!==!1&&(d=!d,x(l.coord,[r.pointA.coord,r.pointZ.coord]))}),r.pointA.toFront(),r.pointZ.toFront(),l.visibleShape.remove();const A=e.scaleVector(t.size)[0]/20;l.mouseTarget.attr({scale:1.5*A}),_.css("cursor","pointer"),_.bind("vmouseover",function(P){h=!0,x(l.coord,[r.pointA.coord,r.pointZ.coord])}),_.bind("vmouseout",function(P){h=!1,x(l.coord,[r.pointA.coord,r.pointZ.coord])});const I=l.remove;return l.remove=function(){v.remove(),I.call(l)},l.update=S,l.isFlipped=function(){return d},S(),l}}(),protractor:function(s){return new To(this,s)},ruler:function(s){return new ko(this,s||{})},addPoints:ht});function To(s,t){this.set=s.raphael.set(),this.cx=t[0],this.cy=t[1];const e=this,r=s.unscaleVector(180.5)[0],l=s.scalePoint([this.cx-r,this.cy+r-s.unscaleVector(10.5)[1]]),h=s.mouselayer.image("https://ka-perseus-graphie.s3.amazonaws.com/e9d032f2ab8b95979f674fbfa67056442ba1ff6a.png",l[0],l[1],360,180);this.set.push(h),h.node.addEventListener("touchstart",function(A){A.preventDefault()},{passive:!1});const d=function(A,I){const P=s.scaleVector(r);P[0]-=16,P[1]-=16;const H=s.scalePoint(t),O=Math.sin((A+90)*Math.PI/180)*(P[0]+I)+H[0],z=Math.cos((A+90)*Math.PI/180)*(P[1]+I)+H[1];return O+","+z},v=s.raphael.path(" M"+d(180,6)+" L"+d(180,2)+" L"+d(183,10)+" L"+d(180,18)+" L"+d(180,14)+" A"+(s.scaleVector(r)[0]+10)+","+(s.scaleVector(r)[1]+10)+",0,0,1,"+d(170,14)+" L"+d(170,18)+" L"+d(167,10)+" L"+d(170,2)+" L"+d(170,6)+" A"+(s.scaleVector(r)[0]+10)+","+(s.scaleVector(r)[1]+10)+",0,0,0,"+d(180,6)+" Z").attr({stroke:null,fill:Y.INTERACTIVE});this.set.push(v),this.centerPoint=s.addMovablePoint({coord:t,visible:!1}),this.rotateHandle=s.addMovablePoint({bounded:!1,coord:[Math.sin(275*Math.PI/180)*r+this.cx,Math.cos(275*Math.PI/180)*r+this.cy],onMove:function(A,I){const P=Math.atan2(e.centerPoint.coord[1]-I,e.centerPoint.coord[0]-A)*180/Math.PI;e.rotate(-P-5,!0)}}),this.rotateHandle.constraints.fixedDistance.dist=r,this.rotateHandle.constraints.fixedDistance.point=this.centerPoint,this.rotateHandle.visibleShape.remove(),this.rotateHandle.mouseTarget.attr({scale:2});let b=!1,y=!1;const M=function(){return y||b},S=E(this.rotateHandle.mouseTarget.getMouseTarget());S.bind("vmousedown",function(A){b=!0,S.css("cursor","-webkit-grabbing"),S.css("cursor","grabbing"),v.animate({scale:1.5,fill:Y.INTERACTING},50),E(document).bind("vmouseup.rotateHandle",function(I){b=!1,S.css("cursor","-webkit-grab"),S.css("cursor","grab"),M()||v.animate({scale:1,fill:Y.INTERACTIVE},50),E(document).unbind("vmouseup.rotateHandle")})}),S.bind("vmouseover",function(A){y=!0,v.animate({scale:1.5,fill:Y.INTERACTING},50)}),S.bind("vmouseout",function(A){y=!1,M()||v.animate({scale:1,fill:Y.INTERACTIVE},50)});const _=E.map(this.set,function(A){return A.node});return this.makeTranslatable=function(){E(_).css("cursor","move"),S.css("cursor","-webkit-grab"),S.css("cursor","grab"),E(_).bind("vmousedown",function(I){I.preventDefault();let P=I.pageX-E(s.raphael.canvas.parentNode).offset().left,H=I.pageY-E(s.raphael.canvas.parentNode).offset().top;E(document).bind("vmousemove.protractor",function(O){let z=O.pageX-E(s.raphael.canvas.parentNode).offset().left,J=O.pageY-E(s.raphael.canvas.parentNode).offset().top;z=Math.max(10,Math.min(s.xpixels-10,z)),J=Math.max(10,Math.min(s.ypixels-10,J));const it=z-P,tt=J-H;E.each(e.set.items,function(){this.translate(it,tt)}),e.centerPoint.setCoord([e.centerPoint.coord[0]+it/s.scale[0],e.centerPoint.coord[1]-tt/s.scale[1]]),e.rotateHandle.setCoord([e.rotateHandle.coord[0]+it/s.scale[0],e.rotateHandle.coord[1]-tt/s.scale[1]]),P=z,H=J}),E(document).one("vmouseup",function(O){E(document).unbind("vmousemove.protractor")})})},this.rotation=0,this.rotate=function(A,I){const P=s.scalePoint(this.centerPoint.coord);return I&&(this.rotation=0),this.set.rotate(this.rotation+A,P[0],P[1]),this.rotation=this.rotation+A,this},this.moveTo=function(I,P){const H=s.scalePoint(e.centerPoint.coord),O=s.scalePoint([I,P]),z=yt.getDistance(H,O)*2;E({x:H[0],y:H[1]}).animate({x:O[0],y:O[1]},{duration:z,step:function(J,it){let tt=0,L=0;it.prop==="x"?tt=J-s.scalePoint(e.centerPoint.coord)[0]:it.prop==="y"&&(L=J-s.scalePoint(e.centerPoint.coord)[1]),E.each(e.set.items,function(){this.translate(tt,L)}),e.centerPoint.setCoord([e.centerPoint.coord[0]+tt/s.scale[0],e.centerPoint.coord[1]-L/s.scale[1]]),e.rotateHandle.setCoord([e.rotateHandle.coord[0]+tt/s.scale[0],e.rotateHandle.coord[1]-L/s.scale[1]])}})},this.rotateTo=function(I){Math.abs(this.rotation-I)>180&&(this.rotation+=360);const P=Math.abs(this.rotation-I)*5;E({0:this.rotation}).animate({0:I},{duration:P,step:function(H,O){e.rotate(H,!0),e.rotateHandle.setCoord([Math.sin((H+275)*Math.PI/180)*r+e.centerPoint.coord[0],Math.cos((H+275)*Math.PI/180)*r+e.centerPoint.coord[1]])}})},this.remove=function(){this.set.remove()},this.makeTranslatable(),this}function ko(s,t){w.defaults(t,{center:[0,0],pixelsPerUnit:40,ticksPerUnit:10,units:10,label:"",style:{fill:null,stroke:Y.GRAY}});const e=w.extend({},t.style,{strokeWidth:1}),r=w.extend({},t.style,{strokeWidth:2}),l=t.units*t.pixelsPerUnit,h=50,d=s.unscalePoint(ft(s.scalePoint(t.center),Ft([l,-50],.5))),v=t.pixelsPerUnit/s.scale[0],b=h/s.scale[0],y=ht(d,[t.units*v,b]),M=1;let x;if(t.ticksPerUnit===10)x={10:M,5:M*.55,1:M*.35};else{const q=[1,.6,.45,.3];x={};for(let G=t.ticksPerUnit;G>=1;G/=2)x[G]=M*(q.shift()||.2)}const S=w.keys(x).sort(function(q,G){return G-q});function _(q){for(let G=0;G<S.length;G++){const nt=S[G];if(q%nt===0)return x[nt]}return 0}const A=d[0],I=d[1],P=y[0],H=y[1],O=t.units*t.ticksPerUnit+1,z=s.raphael.set(),J=1/s.scale[0];z.push(s.line([A-J,I],[P+J,I],r)),z.push(s.line([A-J,H],[P+J,H],r)),w.times(O,function(q){const G=q/t.ticksPerUnit,nt=A+G*v,ot=_(q)*b,j=q===0||q===O-1?r:e;if(z.push(s.line([nt,I],[nt,I+ot],j)),G%1===0){const ct=s.scalePoint([nt,H]);let at,$;G===0?(at=t.label,$={mm:13,cm:11,m:8,km:11,in:8,ft:8,yd:10,mi:10}[at]||3*at.toString().length):(at=G,$=-3*(G.toString().length+1));const mt=s.raphael.text(ct[0]+$,ct[1]+10,at);mt.attr({"font-family":"KaTeX_Main","font-size":"12px",color:"#444"}),z.push(mt)}});const it=s.mouselayer.path(s.svgPath([d,[A,H],y,[P,I],!0]));it.attr({fill:"#000",opacity:0,stroke:"#000","stroke-width":2}),z.push(it),it.node.addEventListener("touchstart",function(q){q.preventDefault()},{passive:!1});const tt=E.map(z,function(q){return q.node});E(tt).css("cursor","move"),E(tt).bind("vmousedown",function(q){q.preventDefault();let G=q.pageX-E(s.raphael.canvas.parentNode).offset().left,nt=q.pageY-E(s.raphael.canvas.parentNode).offset().top;E(document).bind("vmousemove.ruler",function(ot){let j=ot.pageX-E(s.raphael.canvas.parentNode).offset().left,ct=ot.pageY-E(s.raphael.canvas.parentNode).offset().top;j=Math.max(10,Math.min(s.xpixels-10,j)),ct=Math.max(10,Math.min(s.ypixels-10,ct));const at=j-G,$=ct-nt;z.translate(at,$),L.setCoord([L.coord[0]+at/s.scale[0],L.coord[1]-$/s.scale[1]]),rt.setCoord([rt.coord[0]+at/s.scale[0],rt.coord[1]-$/s.scale[1]]),G=j,nt=ct}),E(document).one("vmouseup",function(ot){E(document).unbind("vmousemove.ruler")})});const L=s.addMovablePoint({coord:d,normalStyle:{fill:Y.INTERACTIVE,"fill-opacity":0,stroke:Y.INTERACTIVE},highlightStyle:{fill:Y.INTERACTING,"fill-opacity":.1,stroke:Y.INTERACTING},pointSize:6,onMove:function(q,G){const nt=rt.coord[1]-G,ot=rt.coord[0]-q,j=Math.atan2(nt,ot)*180/Math.PI,ct=Ft(ht([q,G],rt.coord),.5),at=s.scalePoint(ct),$=Ft(ht(L.coord,rt.coord),.5),mt=s.scalePoint($),Mt=ft(at,mt);z.rotate(-j,mt[0],mt[1]),z.translate(Mt[0],Mt[1])}}),rt=s.addMovablePoint({coord:[P,I],normalStyle:{fill:Y.INTERACTIVE,"fill-opacity":0,stroke:Y.INTERACTIVE},highlightStyle:{fill:Y.INTERACTING,"fill-opacity":.1,stroke:Y.INTERACTING},pointSize:6,onMove:function(q,G){const nt=G-L.coord[1],ot=q-L.coord[0],j=Math.atan2(nt,ot)*180/Math.PI,ct=Ft(ht([q,G],L.coord),.5),at=s.scalePoint(ct),$=Ft(ht(L.coord,rt.coord),.5),mt=s.scalePoint($),Mt=ft(at,mt);z.rotate(-j,mt[0],mt[1]),z.translate(Mt[0],Mt[1])}});return L.constraints.fixedDistance.dist=l/s.scale[0],L.constraints.fixedDistance.point=rt,rt.constraints.fixedDistance.dist=l/s.scale[0],rt.constraints.fixedDistance.point=L,this.remove=function(){z.remove(),L.remove(),rt.remove()},this}function Qs(s,t){if(this.graphie=s,w.extend(this,t),w.defaults(this,{normalStyle:{stroke:Y.INTERACTIVE,"stroke-width":2,fill:Y.INTERACTIVE},highlightStyle:{stroke:Y.INTERACTING,"stroke-width":2,fill:Y.INTERACTING},labelStyle:{stroke:Y.DYNAMIC,"stroke-width":1,color:Y.DYNAMIC},angleStyle:{stroke:Y.DYNAMIC,"stroke-width":1,color:Y.DYNAMIC},allowReflex:!0}),!this.points||this.points.length!==3)throw new jt("MovableAngle requires 3 points",Ht.InvalidInput);this.points=w.map(t.points,function(e){return w.isArray(e)?s.addMovablePoint({coord:e,visible:!1,constraints:{fixed:!0},normalStyle:this.normalStyle}):e},this),this.coords=w.pluck(this.points,"coord"),this.reflex==null&&(this.allowReflex?this.reflex=this._getClockwiseAngle(this.coords)>180:this.reflex=!1),this.rays=w.map([0,2],function(e){return s.addMovableLineSegment({pointA:this.points[1],pointZ:this.points[e],fixed:!0,extendRay:!0})},this),this.temp=[],this.labeledAngle=s.label([0,0],"","center",this.labelStyle),this.fixed||(this.addMoveHandlers(),this.addHighlightHandlers()),this.update()}w.extend(Qs.prototype,{points:[],snapDegrees:0,snapOffsetDeg:0,angleLabel:"",numArcs:1,pushOut:0,fixed:!1,addMoveHandlers:function(){const s=this.graphie;function t(h,d){return yt.getDistance(s.scalePoint(h),s.scalePoint(d))<30}const e=this.points;e[1].onMove=function(h,d){const v=e[1].coord,b=[h,d],y=ht(b,Di(v));let M=!0;const x={};return w.each([0,2],function(S){const _=e[S].coord;let A=ht(_,y),I=yt.findAngleDeprecated(b,A);I*=Math.PI/180,A=s.constrainToBoundsOnAngle(A,10,I),x[S]=A,t(b,A)&&(M=!1)}),M&&w.each(x,function(S,_){e[_].setCoord(S)}),M};const r=this.snapDegrees,l=this.snapOffsetDeg;w.each([0,2],function(h){e[h].onMove=function(d,v){const b=[d,v],y=e[1].coord;if(t(y,b))return!1;if(r){let M=yt.findAngleDeprecated(b,y);M=Math.round((M-l)/r)*r+l;const x=yt.getDistance(b,y);return ht(y,Li(x,M))}return!0}}),E(e).on("move",(function(){this.update(),E(this).trigger("move")}).bind(this))},addHighlightHandlers:function(){const s=this.points[1];s.onHighlight=(function(){w.each(this.points,function(t){t.visibleShape.animate(this.highlightStyle,50)},this),w.each(this.rays,function(t){t.visibleLine.animate(this.highlightStyle,50),t.arrowStyle=w.extend({},t.arrowStyle,{color:this.highlightStyle.stroke,stroke:this.highlightStyle.stroke})},this),this.angleStyle=w.extend({},this.angleStyle,{color:this.highlightStyle.stroke,stroke:this.highlightStyle.stroke}),this.update()}).bind(this),s.onUnhighlight=(function(){w.each(this.points,function(t){t.visibleShape.animate(this.normalStyle,50)},this),w.each(this.rays,function(t){t.visibleLine.animate(t.normalStyle,50),t.arrowStyle=w.extend({},t.arrowStyle,{color:t.normalStyle.stroke,stroke:t.normalStyle.stroke})},this),this.angleStyle=w.extend({},this.angleStyle,{color:Y.DYNAMIC,stroke:Y.DYNAMIC}),this.update()}).bind(this)},_getClockwiseAngle:function(s){return yt.findAngleDeprecated(s[2],s[0],s[1])+360%360},isReflex:function(){return this.reflex},isClockwise:function(){return this._getClockwiseAngle(this.coords)>180===this.reflex},getClockwiseCoords:function(){return this.isClockwise()?w.clone(this.coords):w.clone(this.coords).reverse()},update:function(s){const t=this.coords;this.coords=w.pluck(this.points,"coord"),w.invoke(this.points,"updateLineEnds");const e=this._getClockwiseAngle(t),r=this._getClockwiseAngle(this.coords),l=e>180,h=r>180;this.allowReflex&&(s==null&&(s=l!==h&&Math.abs(r-e)<180),s&&(this.reflex=!this.reflex)),w.invoke(this.temp,"remove"),this.temp=this.graphie.labelAngle({point1:this.coords[0],vertex:this.coords[1],point3:this.coords[2],label:this.labeledAngle,text:this.angleLabel,numArcs:this.numArcs,pushOut:this.pushOut,clockwise:this.reflex===h,style:this.angleStyle})},remove:function(){w.invoke(this.rays,"remove"),w.invoke(this.temp,"remove"),this.labeledAngle.remove()}});const Ds=Rt.nestedMap;function qi(s){w.extend(this,s)}const Pi=function(){throw new jt("Abstract method! Must be implemented by Graphie Movable"+this.constructor.displayName,Ht.NotAllowed)};w.extend(qi.prototype,{movableProps:[],add:Pi,modify:Pi,remove:Pi,toFront:function(){},componentDidMount:function(){}});const _o=function(s,t){return w.extend({},s,{children:w.filter(w.flatten(t),w.identity)})},tn=function(s){const t=function(e){if(!(this instanceof t))throw new jt("Use createElement or JSX with graphie movables",Ht.NotAllowed);return this.props=_o(e,e.children||[]),this};return s.displayName=s.displayName||w.uniqueId("GraphieClass"),t.displayName=s.displayName,t.prototype=new qi(s),t.prototype.constructor=t,t},Co=function(s){return tn({displayName:s.name||w.uniqueId("GraphieSimpleClass"),movableProps:["children"],add:function(t){this._elements=s(t,this.props),this._prevProps=this.props},modify:function(t){if(!Qe(this.props,this._prevProps))return this.remove(),this.add(t),this._prevProps=this.props,"reordered"},remove:function(){Ds(this._elements,t=>{t&&t.remove()}),this._elements=null,this._prevProps=null},toFront:function(){Ds(this._elements,t=>{w.isFunction(t.toFront)&&t.toFront()})}})},Dt={GraphieMovable:qi,createClass:tn,createSimpleClass:Co},Po=kt.normalizeOptions,Ao=kt.assert,Eo={cursor:null},Io={added:!1,isHovering:!1,isMouseOver:!1,isDragging:!1,mouseTarget:null};class Ai{constructor(t,e){F(this,"graphie");F(this,"state");F(this,"prevState");F(this,"_listenerMap",{});this.graphie=t,this.state={id:w.uniqueId("movable")},this.modify({...Io,...e})}modify(t){this.update({...this._createDefaultState(),...t})}_createDefaultState(){return{id:this.state.id,add:[],modify:[],draw:[],remove:[],onMoveStart:[],onMove:[],onMoveEnd:[],onClick:[],...Eo}}update(t){const e=this.graphie,r=this.cloneState(),l=Object.assign(this.state,Po(t));if(l.mouseTarget&&!r.mouseTarget){let h;l.mouseTarget.getMouseTarget?h=E(l.mouseTarget.getMouseTarget()):h=E(l.mouseTarget[0]),!("ontouchstart"in window)&&(h.on("vmouseover",()=>{l.isMouseOver=!0,e.isDragging||(l.isHovering=!0),this.state.added&&this.draw()}),h.on("vmouseout",()=>{l.isMouseOver=!1,l.isDragging||(l.isHovering=!1),this.state.added&&this.draw()})),h[0].addEventListener("touchstart",function(v){v.preventDefault()},{passive:!1}),h.on("vmousedown",v=>{if(v.which!==0&&v.which!==1)return;v.preventDefault();const b=e.getMouseCoord(v);this.grab(b)})}if(l.mouseTarget&&l.cursor!==void 0){let h;l.mouseTarget.getMouseTarget?h=E(l.mouseTarget.getMouseTarget()):h=E(l.mouseTarget[0]),h.css("cursor",l.cursor||"")}l.added||(this._fireEvent(l.modify,this.cloneState(),{}),l.added=!0,this.prevState=this.cloneState()),this._fireEvent(l.modify,this.cloneState(),this.prevState)}cloneState(){return{...this.state}}_fireEvent(t,...e){if(t!=null)for(const r of t)r.call(this,...e)}draw(){const t=this.cloneState();this._fireEvent(this.state.draw,t,this.prevState),this.prevState=t}grab(t){Ao(Qt(t));const e=this.graphie,r=this.state;r.isHovering=!0,r.isDragging=!0,e.isDragging=!0;const l=t;let h=l;this._fireEvent(r.onMoveStart,l,l);const d=b=>{b.preventDefault();const y=e.getMouseCoord(b);this._fireEvent(r.onMove,y,h),this.draw(),h=y},v=()=>{E(document).unbind("vmousemove",d),E(document).unbind("vmouseup",v),r.isHovering&&this._fireEvent(r.onClick,h,l),r.isHovering=this.state.isMouseOver,r.isDragging=!1,e.isDragging=!1,this._fireEvent(r.onMoveEnd,h,l),this.draw()};E(document).bind("vmousemove",d),E(document).bind("vmouseup",v)}_applyConstraints(t,e,r){let l=!1;return(this.state.constraints??[]).reduce((h,d)=>{if(h===!1)return!1;if(l)return h;const v=d.call(this,h,e,{onSkipRemaining:()=>{l=!0},...r});if(v===!1)return!1;if(Qt(v,2))return v;if(v===!0||v==null)return h;throw new jt("Constraint returned invalid result: "+v,Ht.Internal)},t)}toBack(){this.state.mouseTarget&&this.state.mouseTarget.toBack()}toFront(){this.state.mouseTarget&&this.state.mouseTarget.toFront()}listen(t,e,r){this._listenerMap=this._listenerMap||{};const l=Ns(t,e),h=this._listenerMap[l]=this._listenerMap[l]||this.state[t].length;this.state[t][h]=r}unlisten(t,e){this._listenerMap=this._listenerMap||{};const r=Ns(t,e),l=this._listenerMap[r];l!==void 0&&(this.state[t].splice(l,1),delete this._listenerMap[r],w.keys(this._listenerMap).forEach(d=>{Lo(d)===t&&this._listenerMap[d]>l&&this._listenerMap[d]--}))}remove(){this.state.added=!1,this._fireEvent(this.state.remove),this.state.mouseTarget&&(E(this.state.mouseTarget).off(),this.state.mouseTarget.remove(),this.state.mouseTarget=null)}cursor(){return this.state.cursor}added(){return this.state.added}isHovering(){return this.state.isHovering}isMouseOver(){return this.state.isMouseOver}isDragging(){return this.state.isDragging}mouseTarget(){return this.state.mouseTarget}}function Ns(s,t){return s+":"+t}function Lo(s){return s.split(":")[0]}const Vs=function(s){const t=s.graphie.scalePoint(s.coord(0)),e=s.graphie.scalePoint(s.coord(1));return $t(ft(e,t))[1]},ei={draw:function(){this.draw()},pointsToFront:function(s){w.invoke(s.points,"toFront")}};ei.standard=[ei.draw,ei.pointsToFront];const Ni={draw:function(){this.draw()}};Ni.standard=[Ni.draw];const Le={basic:function(s){const t=this.graphie;let e=this.coord(0),r=this.coord(1);if(!this.state.visibleShape){const d={thickness:10};this.state.visibleShape=new ci(t,e,r,d),this.state.visibleShape.attr(this.normalStyle()),this.state.visibleShape.toFront(),this.mouseTarget()&&this.mouseTarget().toFront()}const l=Vs(this);s.extendLine?(e=ti(t,e,360-l),r=ti(t,r,(540-l)%360)):s.extendRay&&(r=ti(t,r,360-l));const h=[this.state.visibleShape];this.mouseTarget()&&h.push(this.mouseTarget()),w.each(h,function(d){d.moveTo(e,r)})},arrows:function(s){this._arrows==null&&(this._arrows=[],s.extendLine?(this._arrows.push(new se(this.graphie,this.normalStyle())),this._arrows.push(new se(this.graphie,this.normalStyle()))):s.extendRay&&this._arrows.push(new se(this.graphie,this.normalStyle())));const t=Vs(this),e=[360-t,(540-t)%360];w.each(this._arrows,function(r,l){r.toCoordAtAngle(this.coord(l),e[l])},this)},highlight:function(s,t){s.isHovering&&!t.isHovering?s.visibleShape.animate(s.highlightStyle,50):!s.isHovering&&t.isHovering&&s.visibleShape.animate(s.normalStyle,50)}};Le.standard=[Le.basic,Le.arrows,Le.highlight];const si={basic:function(){this.state.visibleShape&&this.state.visibleShape.remove()},arrows:function(){this._arrows!=null&&w.invoke(this._arrows,"remove"),this._arrows=null}};si.standard=[si.basic,si.arrows];const en={fixed:function(){return function(){return!1}},snap:function(s){return function(t,e){if(s===null)return!0;let r=ft(t,e);return s=s||this.graphie.snap,r=Gi(r,s),ht(e,r)}},bound:function(s,t,e){return e===void 0&&(s===void 0?e=10:e=0),function(r,l){const h=this.graphie,d=ft(r,l);s=s||h.range,t===void 0&&(t=h.snap);let v=h.unscalePoint([e,h.ypixels-e]),b=h.unscalePoint([h.xpixels-e,e]);t&&(v=Bi(v,t),b=Fi(b,t));const y=w.map(this.coords(),function(x,S){const _=ft(b,x);return[ft(v,x),_]}),M=w.reduce(y,function(x,S){const _=S[0],A=S[1],I=Math.max(_[0],Math.min(A[0],x[0])),P=Math.max(_[1],Math.min(A[1],x[1]));return[I,P]},d);return ht(l,M)}}};en.standard=null;const sn={updatePoints:function(s,t){const e=ft(s,t);w.each(this.state.points,function(r){r.setCoord(ht(r.coord(),e))})}};sn.standard=null;const nn={add:ei,modify:Ni,draw:Le,remove:si,onMoveStart:{standard:null},constraints:en,onMove:sn,onMoveEnd:{standard:null}},Hs=kt.assert,Os=kt.normalizeOptions,on={points:null,static:!1,cursor:"move",normalStyle:null,highlightStyle:null,extendLine:!1,extendRay:!1},rn={visibleShape:null,mouseTarget:null},be=function(s,t,e){Hs(s!=null),Hs(e!=null),w.extend(this,{graphie:s,movable:t,state:{id:w.uniqueId("movableLine")}}),this.modify(w.extend({},rn,e))};w.extend(be,nn);kt.createGettersFor(be,w.extend({},on,rn));kt.addMovableHelperMethodsTo(be);w.extend(be.prototype,{cloneState:function(){return w.extend(this.movable.cloneState(),{coords:this.coords()},this.state)},_createDefaultState:function(){return w.extend({id:this.state.id},Os(Yi(nn,"standard")),on)},modify:function(s){this.update(w.extend(this._createDefaultState(),s))},update:function(s){const t=this,e=this.graphie,r=t.state=w.extend(t.state,Os(s)),l=r.static?Y.DYNAMIC:Y.INTERACTIVE;if(r.normalStyle=w.extend({stroke:l,"stroke-width":2},r.normalStyle),r.highlightStyle=w.extend({stroke:Y.INTERACTING,"stroke-width":3},r.highlightStyle),!r.static&&!r.mouseTarget){const h={thickness:30,mouselayer:!0,interactiveKindForTesting:"movable-line"};r.mouseTarget=new ci(e,this.coord(0),this.coord(1),h),r.mouseTarget.attr({fill:"#000",opacity:0})}r.static&&r.mouseTarget&&(r.mouseTarget.remove(),r.mouseTarget=null),t.movable.modify(w.extend({},r,{mouseTarget:r.mouseTarget,add:null,modify:null,draw:t.draw.bind(t),remove:null,onMoveStart:function(){t._initialRefCoord=t.coord(0),t._prevRefCoord=t._initialRefCoord,t._totalDelta=[0,0],t._fireEvent(t.state.onMoveStart,t.coord(0),t.coord(0))},onMove:function(h,d){const v=ft(h,d);t._totalDelta=ht(t._totalDelta,v);let b=ht(t._initialRefCoord,t._totalDelta);b=t._applyConstraints(b,t._prevRefCoord),b!==!1&&(t._fireEvent(t.state.onMove,b,t._prevRefCoord),t._prevRefCoord=b)},onMoveEnd:function(){t._fireEvent(t.state.onMoveEnd,t._prevRefCoord,t._initialRefCoord)}})),r.added||(t.prevState={},t._fireEvent(r.add,t.cloneState(),t.prevState),r.added=!0,w.invoke(r.points,"listen","onMove",r.id,t.draw.bind(t)),t.prevState=t.cloneState()),t._fireEvent(r.modify,t.cloneState(),t.prevState)},coords:function(){return w.invoke(this.state.points,"coord")},point:function(s){return this.state.points[s]},coord:function(s){return this.point(s).coord()},remove:function(){this.state.added=!1,this._fireEvent(this.state.remove),this.points&&w.invoke(this.points,"unlisten","onMove",this.state.id),this.movable&&this.movable.remove()},toBack:function(){this.movable.toBack(),this.state.visibleShape&&this.state.visibleShape.toBack()},toFront:function(){this.state.visibleShape&&this.state.visibleShape.toFront(),this.movable.toFront()},isHovering:function(){return this.movable.isHovering()},isDragging:function(){return this.movable.isDragging()},mouseTarget:function(){return this.movable.mouseTarget()}});const Vi={constrain:function(){this.constrain()}};Vi.standard=[Vi.constrain];const Hi={draw:function(){this.draw()}};Hi.standard=[Hi.draw];const ni={basic:function(s,t){const e=this.graphie;if(!this.state.visibleShape){const r=[this.pointSize()/e.scale[0],this.pointSize()/e.scale[1]],l={maxScale:Math.max(this.highlightStyle().scale,this.normalStyle().scale),padding:10,shadow:s.shadow};this.state.visibleShape=new li(e,this.coord(),r,l),this.state.visibleShape.attr(w.omit(this.normalStyle(),"scale")),this.state.visibleShape.toFront(),this.mouseTarget()&&this.mouseTarget().toFront()}s.normalStyle!==t.normalStyle&&!w.isEqual(s.normalStyle,t.normalStyle)&&this.state.visibleShape.attr(this.normalStyle()),this.state.visibleShape.moveTo(this.coord()),this.mouseTarget()&&this.mouseTarget().moveTo(this.coord())},highlight:function(s,t){s.isHovering&&!t.isHovering?s.visibleShape.animate(this.highlightStyle(),50):!s.isHovering&&t.isHovering&&s.visibleShape.animate(this.normalStyle(),50)}};ni.standard=[ni.basic,ni.highlight];const Oi={basic:function(){this.state.visibleShape&&(this.state.visibleShape.remove(),this.state.visibleShape=null)}};Oi.standard=Oi.basic;const an={fixed:function(){return function(){return!1}},snap:function(s){return function(t){return s===null?!0:Gi(t,s||this.graphie.snap)}},bound:function(s,t,e){const r=e===void 0?s===void 0?10:0:e;return function(l,h,d){const v=this.graphie;s=s||v.range,t===void 0&&(t=v.snap);let b=v.unscalePoint([r,v.ypixels-r]),y=v.unscalePoint([v.xpixels-r,r]);if(t&&(b=Bi(b,t),y=Fi(y,t)),d&&d.onOutOfBounds)return(l[0]>y[0]||l[0]<b[0]||l[1]>y[1]||l[1]<b[1])&&(d.onSkipRemaining(),d.onOutOfBounds()),l;const M=Math.max(b[0],Math.min(y[0],l[0])),x=Math.max(b[1],Math.min(y[1],l[1]));return[M,x]}}};an.standard=null;const Wt={add:Vi,modify:Hi,draw:ni,remove:Oi,onMoveStart:{standard:null},constraints:an,onMove:{standard:null},onMoveEnd:{standard:null},onClick:{standard:null}},Ei=kt.assert,zs=kt.normalizeOptions,{processMath:Ro}=Js,Do={coord:[0,0],pointSize:4,static:!1,cursor:"move",normalStyle:null,highlightStyle:null,shadow:!1,tooltip:!1},No={added:!1,hasMoved:!1,visibleShape:null,outOfBounds:!1,mouseTarget:null,touchOffset:null},Bs=[];var Xt;let Fs=(Xt=class{constructor(t,e,r){F(this,"graphie");F(this,"movable");F(this,"state");F(this,"prevState");F(this,"_tooltip");F(this,"_listenerMap",{});this.graphie=t,this.movable=e,this.state={id:w.uniqueId("movablePoint")},this.modify({...No,...r})}modify(t){this.update(w.extend(this._createDefaultState(),t))}_createDefaultState(){return{id:this.state.id,...zs(Yi(Wt,"standard")),...Do}}cloneState(){return{...this.movable.cloneState(),...this.state}}update(t){const e=this,r=e.graphie,l=w.extend(e.state,zs(t));Ei(Qt(l.coord));const h=l.static?Y.DYNAMIC:Y.INTERACTIVE;if(l.normalStyle=w.extend({fill:h,stroke:h,scale:1},l.normalStyle),l.highlightStyle=w.extend({fill:Y.INTERACTING,stroke:Y.INTERACTING,scale:2},l.highlightStyle),!l.static&&!l.mouseTarget){const b=e.state.coord,y=r.unscaleVector(24),M={mouselayer:!0,padding:0,interactiveKindForTesting:"movable-point"};l.mouseTarget=new li(r,b,y,M),l.mouseTarget.attr({fill:"#000",opacity:0})}const d=()=>{this._showTooltip(b=>{Ks(At.jsx("span",{style:{fontSize:"2em"},children:At.jsx(Wn,{...$n,style:{position:"static",color:Y.INTERACTIVE,marginLeft:9,marginRight:9}})}),b)})};let v=l.coord;e.movable.modify(w.extend({},l,{add:null,modify:null,draw:e.draw.bind(e),remove:null,onMoveStart:b=>{if(l.hasMoved=!1,v=l.coord,l.touchOffset==null){const M=!("ontouchstart"in window);l.touchOffset=M?[0,0]:ft(v,b)}const y=l.visibleShape.wrapper;if(l.shadow){const M="none";y.style.filter=M}if(l.showHairlines&&l.showHairlines(l.coord),Bs.forEach(M=>M()),l.tooltip&&(l.xOnlyTooltip?this._showTooltip(`${l.coord[0]}`):this._showTooltip(`(${l.coord[0]}, ${l.coord[1]})`),l.shadow)){const M=y.getElementsByClassName("tooltip-content")[0],x="drop-shadow(0px 0px 5px rgba(0, 0, 0, 0.5))";M.style.filter=x}e._fireEvent(l.onMoveStart,v,v),e.draw()},onMove:(b,y)=>{const M=ht(b,l.touchOffset);e.moveTo(M),l.showHairlines&&(this.state.outOfBounds?l.hideHairlines():l.showHairlines(l.coord)),l.tooltip&&(this.state.outOfBounds||(l.xOnlyTooltip?this._showTooltip(`${l.coord[0]}`):this._showTooltip(`(${l.coord[0]}, ${l.coord[1]})`))),l.onRemove&&this.state.outOfBounds&&d()},onMoveEnd:()=>{e.isHovering()&&!l.hasMoved&&e._fireEvent(l.onClick,l.coord,v);const b=l.visibleShape.wrapper;if(l.shadow){const y="drop-shadow(0px 0px 5px rgba(0, 0, 0, 0.5))";b.style.filter=y}if(l.hideHairlines&&l.hideHairlines(),l.hasMoved)this._hideTooltip();else if(l.onRemove){d();const y=b.getElementsByClassName("tooltip-content")[0];y.style.filter="none",this._tooltip.firstChild.addEventListener("touchstart",M=>{M.stopPropagation()},!0),this._tooltip.firstChild.addEventListener("touchend",M=>{l.onRemove(),M.stopPropagation()},!0)}else l.tooltip&&this._hideTooltip();l.outOfBounds&&l.onRemove(),e._fireEvent(l.onMoveEnd,l.coord,v),l.hasMoved=!1,l.touchOffset=null,e.draw()}})),l.added||(e.prevState={},e._fireEvent(l.add,e.cloneState(),e.prevState),l.added=!0,e.prevState=e.cloneState()),e._fireEvent(l.modify,e.cloneState(),e.prevState)}draw(){const t=this.cloneState();this._fireEvent(this.state.draw,t,this.prevState),this.prevState=t}constrain(){const t=this._applyConstraints(this.coord(),this.coord());return Qt(t)&&this.setCoord(t),t!==!1}_fireEvent(t,...e){for(const r of t)r.call(this,...e)}_applyConstraints(t,e,r){let l=!1;return this.state.constraints.reduce((h,d)=>{if(h===!1)return!1;if(l)return h;const v=d.call(this,h,e,{onSkipRemaining:()=>{l=!0},...r});if(v===!1)return!1;if(Qt(v,2))return v;if(v===!0||v==null)return h;throw new jt("Constraint returned invalid result: "+v,Ht.Internal)},t)}_showTooltip(t){this._tooltip||(this._tooltip=document.createElement("div"),this._tooltip.className="tooltip-content",this.state.visibleShape.wrapper.className="tooltip",this.state.visibleShape.wrapper.appendChild(this._tooltip),Bs.push(()=>{this.state.added&&this._hideTooltip()})),this._tooltip.firstChild&&this._tooltip.removeChild(this._tooltip.firstChild),this.state.visibleShape.wrapper.className="tooltip visible",this._tooltip.appendChild(document.createElement("span")),typeof t=="string"?Ro(this._tooltip.firstChild,t,!1):typeof t=="function"?t(this._tooltip.firstChild):this._tooltip.firstChild.appendChild(t)}_hideTooltip(){this._tooltip&&(this.state.visibleShape.wrapper.className="tooltip")}coord(){return this.state.coord}setCoord(t){Ei(Qt(t,2)),this.state.coord=w.clone(t),this.draw()}setCoordConstrained(t){Ei(Qt(t,2));const e=this._applyConstraints(t,this.coord());e!==!1&&(this.state.coord=w.clone(e),this.draw())}listen(t,e,r){this._listenerMap=this._listenerMap||{};const l=Gs(t,e),h=this._listenerMap[l]=this._listenerMap[l]||this.state[t].length;this.state[t][h]=r}unlisten(t,e){this._listenerMap=this._listenerMap||{};const r=Gs(t,e),l=this._listenerMap[r];if(l!==void 0){this.state[t].splice(l,1),delete this._listenerMap[r];const h=w.keys(this._listenerMap);w.each(h,d=>{Vo(d)===t&&this._listenerMap[d]>l&&this._listenerMap[d]--},this)}}grab(t){this.state.touchOffset=[0,0],this.movable.grab(t),this.moveTo(t)}moveTo(t){const e=this.state;this.state.outOfBounds=!1;const r=this._applyConstraints(t,e.coord,e.onRemove?{onOutOfBounds:()=>{this.state.outOfBounds=!0},onSkipRemaining:()=>{}}:{onSkipRemaining:()=>{}});if(r!==!1&&(Qt(r)&&(t=r),!Zs(t,e.coord))){const l=e.coord;e.coord=t,e.hasMoved=!0,this._fireEvent(e.onMove,e.coord,l),this.draw()}}remove(){this.state.added=!1,this._fireEvent(this.state.remove),this.movable&&this.movable.remove(),this.state.mouseTarget=null}pointSize(){return this.state.pointSize}static(){return this.state.static}cursor(){return this.state.cursor}normalStyle(){return this.state.normalStyle}highlightStyle(){return this.state.highlightStyle}shadow(){return this.state.shadow}tooltip(){return this.state.tooltip}added(){return this.state.added}hasMoved(){return this.state.hasMoved}visibleShape(){return this.state.visibleShape}outOfBounds(){return this.state.outOfBounds}mouseTarget(){return this.state.mouseTarget}touchOffset(){return this.state.touchOffset}isHovering(){return this.movable.isHovering()}isDragging(){return this.movable.isDragging()}toBack(){this.movable.toBack(),this.state.visibleShape&&this.state.visibleShape.toBack()}toFront(){this.state.visibleShape&&this.state.visibleShape.toFront(),this.movable.toFront()}},F(Xt,"add",Wt.add),F(Xt,"modify",Wt.modify),F(Xt,"draw",Wt.draw),F(Xt,"remove",Wt.remove),F(Xt,"onMoveStart",Wt.onMoveStart),F(Xt,"constraints",Wt.constraints),F(Xt,"onMove",Wt.onMove),F(Xt,"onMoveEnd",Wt.onMoveEnd),F(Xt,"onClick",Wt.onClick),Xt);function Gs(s,t){return s+":"+t}function Vo(s){return s.split(":")[0]}function Ho(s){return w.reduce(s,function(t,e){return t+e},0)}function Oo(s){const t=w.zip(s,s.slice(1).concat(s.slice(0,1))),e=w.map(t,function(r){const l=r[0],h=r[1];return(h[0]-l[0])*(h[1]+l[1])});return Ho(e)>0}const oi={constrain:function(){this.constrain()},pointsToFront:function(s){w.invoke(s.points,"toFront")}};oi.standard=[oi.constrain,oi.pointsToFront];const zi={draw:function(){this.draw()}};zi.standard=[zi.draw];const Re={basic:function(s,t){const e=this.graphie,r=this.path(s);this.state.visibleShape||(this.state.visibleShape=e.raphael.path(r),this.state.visibleShape.attr(this.normalStyle())),s.normalStyle!==t.normalStyle&&!w.isEqual(s.normalStyle,t.normalStyle)&&this.state.visibleShape.attr(this.normalStyle()),this.state.visibleShape.attr({path:r}),this.mouseTarget()&&this.mouseTarget().attr({path:r})},labels:function(s,t){const e=this.graphie,r=this,l=w.invoke(s.points,"coord"),h=Oo(l),d=l.length;r.state._labelCache!=null&&w.invoke(r.state._labelCache,"remove"),r.state._labelCache=[],(s.angleLabels.length||s.showRightAngleMarkers.length)&&(r.state._labeledAngles==null&&(r.state._labeledAngles=w.times(Math.max(s.angleLabels.length,s.showRightAngleMarkers.length),function(){return e.label([0,0],"","center",s.labelStyle)})),w.each(r.state._labeledAngles,function(v,b){r.state._labelCache.push(e.labelAngle({point1:l[(b-1+d)%d],vertex:l[b],point3:l[(b+1)%d],label:v,text:s.angleLabels[b],showRightAngleMarker:s.showRightAngleMarkers[b],numArcs:s.numArcs[b],clockwise:h,style:s.labelStyle}))})),s.sideLabels.length&&(r.state._labeledSides==null&&(r.state._labeledSides=w.map(s.sideLabels,function(v){return e.label([0,0],"","center",s.labelStyle)})),w.each(r.state._labeledSides,function(v,b){r.state._labelCache.push(e.labelSide({point1:l[b],point2:l[(b+1)%d],label:v,text:s.sideLabels[b],numArrows:s.numArrows[b],numTicks:s.numTicks[b],clockwise:h,style:s.labelStyle}))})),s.vertexLabels.length&&(r.state._labeledVertices==null&&(r.state._labeledVertices=w.map(s.vertexLabels,function(v){return e.label([0,0],"","center",s.labelStyle)})),w.each(r.state._labeledVertices,function(v,b){r.state._labelCache.push(e.labelVertex({point1:l[(b-1+d)%d],vertex:l[b],point3:l[(b+1)%d],label:v,text:s.vertexLabels[b],clockwise:h,style:s.labelStyle}))})),r.state._labelCache=w.flatten(r.state._labelCache)},highlight:function(s,t){s.isHovering&&!t.isHovering?s.visibleShape.animate(this.highlightStyle(),50):!s.isHovering&&t.isHovering&&s.visibleShape.animate(this.normalStyle(),50)}};Re.standard=[Re.basic,Re.labels,Re.highlight];const ri={basic:function(){this.state.visibleShape&&this.state.visibleShape.remove()},labels:function(){const s=[this.state._labeledSides,this.state._labeledVertices,this.state._labeledAngles,this.state._labelCache];w.each(s,function(t){t!=null&&t.length&&w.invoke(t,"remove")})}};ri.standard=[ri.basic,ri.labels];const ln={fixed:function(){return function(){return!1}},snap:function(s){return function(t){return s===null?!0:(s=s||this.graphie.snap,Gi(t,s))}},bound:function(s,t,e){return e===void 0&&(s===void 0?e=10:e=0),function(r,l){const h=this.graphie,d=ft(r,l);s=s||h.range,t===void 0&&(t=h.snap);let v=h.unscalePoint([e,h.ypixels-e]),b=h.unscalePoint([h.xpixels-e,e]);t&&(v=Bi(v,t),b=Fi(b,t));const y=w.map(this.coords(),function(x,S){const _=ft(b,x);return[ft(v,x),_]}),M=w.reduce(y,function(x,S){const _=S[0],A=S[1],I=Math.max(_[0],Math.min(A[0],x[0])),P=Math.max(_[1],Math.min(A[1],x[1]));return[I,P]},d);return ht(l,M)}}};ln.standard=null;const cn={updatePoints:function(s,t){const e=ft(s,t);w.each(this.state.points,function(r){r.setCoord(ht(r.coord(),e))})}};cn.standard=null;const hn={add:oi,modify:zi,draw:Re,remove:ri,onMoveStart:{standard:null},constraints:ln,onMove:cn,onMoveEnd:{standard:null},onClick:{standard:null}},Ys=kt.assert,Xs=kt.normalizeOptions,un={points:null,angleLabels:[],showRightAngleMarkers:[],sideLabels:[],vertexLabels:[],numArcs:[],numArrows:[],numTicks:[],closed:!0,static:!1,cursor:"move",normalStyle:null,highlightStyle:null,labelStyle:null},dn={added:!1,hasMoved:!1,visibleShape:null,mouseTarget:null},ye=function(s,t,e){Ys(s!=null),Ys(e!=null),w.extend(this,{graphie:s,movable:t,state:{id:w.uniqueId("movablePolygon")}}),this.modify(w.extend({},dn,e))};w.extend(ye,hn);kt.createGettersFor(ye,w.extend({},un,dn));kt.addMovableHelperMethodsTo(ye);w.extend(ye.prototype,{cloneState:function(){return w.extend(this.movable.cloneState(),this.state)},_createDefaultState:function(){return w.extend({id:this.state.id},Xs(Yi(hn,"standard")),un)},modify:function(s){this.update(w.extend(this._createDefaultState(),s))},update:function(s){const t=this,e=t.graphie,r=w.extend(t.state,Xs(s)),l=r.static?Y.DYNAMIC:Y.INTERACTIVE;r.normalStyle=w.extend({},r.normalStyle,{"stroke-width":2,"fill-opacity":0,fill:l,stroke:l},s.normalStyle),r.highlightStyle=w.extend({},{stroke:Y.INTERACTING,"stroke-width":2,fill:Y.INTERACTING,"fill-opacity":.05},r.highlightStyle),r.labelStyle=w.extend({},{stroke:Y.DYNAMIC,"stroke-width":1,color:Y.DYNAMIC},r.labelStyle),r.static||r.mouseTarget||(r.mouseTarget=e.mouselayer.path(this.path()),r.mouseTarget.attr({fill:"#000",opacity:0,cursor:"move"})),t.movable.modify(w.extend({},r,{modify:null,draw:t.draw.bind(t),remove:null,onMoveStart:function(){t._initialRefCoord=t.coord(0),t._prevRefCoord=t._initialRefCoord,t._totalDelta=[0,0],t._fireEvent(t.state.onMoveStart,t.coord(0),t.coord(0))},onMove:function(h,d){const v=ft(h,d);t._totalDelta=ht(t._totalDelta,v);let b=ht(t._initialRefCoord,t._totalDelta);b=t._applyConstraints(b,t._prevRefCoord),b!==!1&&(t._fireEvent(t.state.onMove,b,t._prevRefCoord),t._prevRefCoord=b)},onMoveEnd:function(){t._fireEvent(t.state.onMoveEnd,t._prevRefCoord,t._initialRefCoord)}})),w.invoke(r.points,"listen","onMove",r.id,t.draw.bind(t)),r.added||(t.prevState={},t._fireEvent(r.add,t.cloneState(),t.prevState),r.added=!0,t.prevState=t.cloneState()),t._fireEvent(r.modify,t.cloneState(),t.prevState)},path:function(s){const t=this.graphie;s=s||this.state;let e=w.map(s.points,function(r){return t.scalePoint(r.coord())});return s.closed?e.push(!0):e=e.concat(w.clone(e).reverse()),yt.unscaledSvgPath(e)},coords:function(){return w.invoke(this.state.points,"coord")},point:function(s){return this.state.points[s]},coord:function(s){return this.point(s).coord()},remove:function(){this.state.added=!1,this._fireEvent(this.state.remove),this.state.points&&w.invoke(this.state.points,"unlisten","onMove",this.state.id),this.movable&&this.movable.remove(),this.state.mouseTarget=null},constrain:function(){if(this.points==null||this.points.length===0)return;const s=this.coord(0),t=this._applyConstraints(s,s);t!==!1&&this._fireEvent(this.state.onMove,t,s)},normalStyle:function(){return w.clone(this.state.normalStyle)},highlightStyle:function(){return w.clone(this.state.highlightStyle)},toBack:function(){this.movable.toBack(),this.state.visibleShape&&this.state.visibleShape.toBack()},toFront:function(){this.state.visibleShape&&this.state.visibleShape.toFront(),this.movable.toFront()},isHovering:function(){return this.movable.isHovering()},isDragging:function(){return this.movable.isDragging()},mouseTarget:function(){return this.movable.mouseTarget()}});const Ne={MovablePoint:Fs,addMovablePoint:function(s,t){const e=new Ai(s,{});return new Fs(s,e,t)},MovableLine:be,addMovableLine:function(s,t){const e=new Ai(s,{});return new be(s,e,t)},MovablePolygon:ye,addMovablePolygon:function(s,t){const e=new Ai(s,{});return new ye(s,e,t)},addMaybeMobileMovablePoint:function(s,t){const e=s.props.apiOptions.isMobile,r=e?{stroke:"#ffffff","stroke-width":3,fill:Y.INTERACTIVE}:{stroke:Y.INTERACTIVE,fill:Y.INTERACTIVE},l=Object.assign(r,t.normalStyle),h=Object.assign(e?{...r,"stroke-width":0,scale:.75}:{},t.highlightStyle),d=Object.assign({normalStyle:l,highlightStyle:h,shadow:e,tooltip:e&&s.props.showTooltips,showHairlines:s.showHairlines,hideHairlines:s.hideHairlines},e?{pointSize:7}:{});return Ne.addMovablePoint(s.graphie,Object.assign(t,d))}},fn=Dt.createClass({displayName:"MovablePoint",movableProps:["children"],_getProps:function(){if(this.props.isMobile){const s=this.props.isMobile,t=s?{stroke:"#ffffff","stroke-width":3,fill:Y.INTERACTIVE}:{stroke:Y.INTERACTIVE,fill:Y.INTERACTIVE},e=s?Object.assign(t,this.props.mobileStyleOverride||{}):Object.assign(t,this.props.normalStyle),r=s?{...t,"stroke-width":0,scale:.75}:this.props.highlightStyle,l=Object.assign({normalStyle:e,highlightStyle:r,shadow:s,tooltip:s&&this.props.showTooltips},s?{pointSize:7}:{});return Object.assign(this.props,l)}return this.props},add:function(s){this.point=Ne.addMovablePoint(s,this._getProps())},modify:function(){this.point.modify(this._getProps())},remove:function(){this.point.remove()},toFront:function(){this.point.toFront()},grab:function(s){this.point.grab(s)}});w.extend(fn,Ne.MovablePoint);const pn=Dt.createClass({displayName:"MovableLine",movableProps:["children"],add:function(s){const t=w.pluck(this.props.children,"point"),e=w.extend({},this.props,{points:t});this.line=Ne.addMovableLine(s,e)},modify:function(){const s=w.pluck(this.props.children,"point"),t=w.extend({},this.props,{points:s});this.line.modify(t)},remove:function(){this.line.remove()},toFront:function(){this.line.toFront()}});w.extend(pn,Ne.MovableLine);const zo=Dt.createSimpleClass((s,t)=>{let e=t.coord;t.unscaled&&(e=s.unscalePoint(e));let r=null;return ne().JIPT.useJIPT?(r=s.label(e,t.text,t.direction,!1,t.style),ne().graphieMovablesJiptLabels.addLabel(r,t.tex)):r=s.label(e,t.text,t.direction,t.tex,t.style),r}),Bo=Dt.createClass({displayName:"Line",movableProps:["children"],add:function(s){const t=this.props;this.graphie=s,this.line=this.graphie.line(t.start,t.end,t.style)},modify:function(){const s=this.props,t=this.graphie.svgPath([s.start,s.end]);this.line.attr(w.extend({},s.style,{path:t}))},remove:function(){this.line.remove()},toFront:function(){this.line.toFront()}}),Fo=Dt.createClass({displayName:"Parabola",movableProps:["children"],add:function(s){const t=this.props;this.graphie=s,this.parabola=this.graphie.parabola(t.a,t.b,t.c,t.style)},modify:function(){const s=this.props,t=this.graphie.svgParabolaPath(s.a,s.b,s.c);this.parabola.attr(w.extend({},s.style,{path:t}))},remove:function(){this.parabola.remove()},toFront:function(){this.parabola.toFront()}}),Go=Dt.createClass({displayName:"Sinusoid",movableProps:["children"],add:function(s){const t=this.props;this.graphie=s,this.sinusoid=this.graphie.sinusoid(t.a,t.b,t.c,t.d,t.style)},modify:function(){const s=this.props,t=this.graphie.svgSinusoidPath(s.a,s.b,s.c,s.d);this.sinusoid.attr(w.extend({},s.style,{path:t}))},remove:function(){this.sinusoid.remove()},toFront:function(){this.sinusoid.toFront()}}),Yo=Dt.createSimpleClass((s,t)=>s.plot(t.fn,t.range,t.style)),Xo=Dt.createSimpleClass((s,t)=>s.plotParametric(t.fn,t.range,t.style)),qo=Dt.createSimpleClass((s,t)=>s.ellipse(t.coord,s.unscaleVector([4,4]),{fill:t.color||Y.BLACK,stroke:t.color||Y.BLACK})),Uo=Dt.createClass({displayName:"Path",movableProps:["children"],add:function(s){const t=this.props;this.graphie=s,this.path=this.graphie.path(t.coords,t.style)},modify:function(){const s=this.props,t=this.graphie.svgPath(s.coords);this.path.attr({path:t})},remove:function(){this.path.remove()},toFront:function(){this.path.toFront()}}),Zo=Dt.createSimpleClass((s,t)=>{let e=t.center,r=t.radius;return t.unscaled&&(e=s.unscalePoint(e),r=s.unscaleVector(r)),s.arc(e,r,t.startAngle,t.endAngle,t.sector,t.style)}),Wo=Dt.createSimpleClass((s,t)=>s.circle(t.center,t.radius,t.style)),$o=Dt.createSimpleClass((s,t)=>s.rect(t.x,t.y,t.width,t.height,t.style)),jo={Arc:Zo,Circle:Wo,Label:zo,Line:Bo,MovableLine:pn,MovablePoint:fn,Parabola:Fo,Path:Uo,Plot:Yo,PlotParametric:Xo,Point:qo,Sinusoid:Go,Rect:$o},Ko=Dt.GraphieMovable,Jo=yt.createGraphie,{nestedMap:Qo}=Rt,{assert:tr}=kt;class we extends ai.Component{constructor(){super(...arguments);F(this,"graphieDivRef",ai.createRef());F(this,"_graphie",new Ri(document.createElement("div")));F(this,"_movables",{});F(this,"movables",{});F(this,"getGraphie",()=>this._graphie);F(this,"_range",()=>{const e=r=>r[0]>=r[1]?[-10,10]:r;return[e(this.props.range[0]),e(this.props.range[1])]});F(this,"_box",()=>{const e=r=>r>0?r:340;return[e(this.props.box[0]),e(this.props.box[1])]});F(this,"_scale",()=>{const e=this._box(),r=this._range();return e.map((l,h)=>{const d=r[h][1]-r[h][0];return l/d})});F(this,"_setupGraphie",()=>{this._removeMovables();const e=this.graphieDivRef.current;if(e==null||e instanceof Text)throw new Error("No graphie container div found");e.innerHTML="";const r=this._graphie=Jo(e);r.init({range:this._range(),scale:this._scale(),isMobile:this.props.isMobile}),this.props.addMouseLayer&&r.addMouseLayer({onClick:this.props.onClick,onMouseDown:this.props.onMouseDown,onMouseMove:this.props.onMouseMove,setDrawingAreaAvailable:this.props.setDrawingAreaAvailable}),r.snap=this.props.options.snapStep||[1,1],this.props.responsive&&(E(e).css({width:"100%",height:"100%"}),r.raphael.setSize("100%","100%")),this.props.setup(r,w.extend({range:this._range(),scale:this._scale()},this.props.options))});F(this,"_removeMovables",()=>{w.invoke(this._movables,"remove"),this._movables={}});F(this,"_renderMovables",(e,r)=>{const l=r.graphie,h=r.oldMovables,d=r.newMovables,v=y=>{w.each(y.movableProps,M=>{y.props[M]=this._renderMovables(y.props[M],r)})};let b=!1;return Qo(e,y=>{if(!y)return r.nextKey++,y;const M=new y.type(y.props);tr(M instanceof Ko,"All children of a Graphie component must be Graphie movables");const x=y.key,S=x??"_no_id_"+r.nextKey;r.nextKey++;const _=y.ref;v(M);const A=h[S];return A?M.constructor===A.constructor?(A.props=M.props,A.modify(l)==="reordered"&&(b=!0),d[S]=A):(x==null&&De.error("Replacing a <Graphie> child with a child of a different type. Please add keys to your <Graphie> children",Ht.Internal),A.remove(),M.add(l),b=!0,d[S]=M):(M.add(l),b=!0,d[S]=M),b&&d[S].toFront(),_&&(this.movables[_]=d[S]),d[S]})});F(this,"_updateMovables",()=>{const e=this._graphie,r=this._movables,l={};this._movables=l,this.movables={},this._renderMovables(this.props.children,{nextKey:1,graphie:e,oldMovables:r,newMovables:l}),w.each(r,(h,d)=>{l[d]||h.remove()})})}componentDidMount(){this._setupGraphie(),this._updateMovables()}shouldComponentUpdate(e){return!w.isEqual(this.props,e)}componentDidUpdate(e){this.props.setup!==e.setup&&De.error("<Graphie> was given a new setup function. This is a bad idea; please refactor your code to give the same setup function reference to <Graphie> on every render.",Ht.Internal),(!Qe(this.props.options,e.options)||!Qe(this.props.box,e.box)||!Qe(this.props.range,e.range))&&this._setupGraphie(),this._updateMovables()}render(){return At.jsx("div",{className:"graphie-container",children:At.jsx("div",{className:"graphie",ref:this.graphieDivRef})})}}F(we,"defaultProps",{range:[[-10,10],[-10,10]],options:{},responsive:!1,addMouseLayer:!0});w.extend(we,Dt);w.extend(we,jo);we.__docgenInfo={description:"",methods:[{name:"getGraphie",docblock:`Allow parents of the <Graphie> component to grab a reference to the
underlying graphie object using
\`this.refs.graphieComponent.getGraphie()\`

This shouldn't be necessary for 90% of cases, but the power is there.
Use it for good and not evil.`,modifiers:[],params:[],returns:null,description:`Allow parents of the <Graphie> component to grab a reference to the
underlying graphie object using
\`this.refs.graphieComponent.getGraphie()\`

This shouldn't be necessary for 90% of cases, but the power is there.
Use it for good and not evil.`},{name:"_range",docblock:null,modifiers:[],params:[],returns:null},{name:"_box",docblock:null,modifiers:[],params:[],returns:null},{name:"_scale",docblock:null,modifiers:[],params:[],returns:null},{name:"_setupGraphie",docblock:null,modifiers:[],params:[],returns:null},{name:"_removeMovables",docblock:null,modifiers:[],params:[],returns:null},{name:"_renderMovables",docblock:null,modifiers:[],params:[{name:"children",optional:!1,type:null},{name:"options",optional:!1,type:null}],returns:null},{name:"_updateMovables",docblock:null,modifiers:[],params:[],returns:null}],displayName:"Graphie",props:{addMouseLayer:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},box:{required:!0,tsType:{name:"tuple",raw:"[width: number, height: number]",elements:[{name:"unknown"},{name:"unknown"}]},description:""},range:{required:!1,tsType:{name:"tuple",raw:"[Coord, Coord]",elements:[{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]}]},description:"",defaultValue:{value:`[
    [-10, 10],
    [-10, 10],
]`,computed:!1}},ranges:{required:!1,tsType:{name:"tuple",raw:"[Range, Range]",elements:[{name:"tuple",raw:"[min: number, max: number]",elements:[{name:"unknown"},{name:"unknown"}]},{name:"tuple",raw:"[min: number, max: number]",elements:[{name:"unknown"},{name:"unknown"}]}]},description:""},gridStep:{required:!1,tsType:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},description:""},step:{required:!1,tsType:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},description:""},scale:{required:!1,tsType:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},description:""},isMobile:{required:!1,tsType:{name:"boolean"},description:""},responsive:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},options:{required:!1,tsType:{name:"any"},description:"",defaultValue:{value:"{}",computed:!1}},setDrawingAreaAvailable:{required:!1,tsType:{name:"signature",type:"function",raw:"(boolean) => void",signature:{arguments:[{name:"boolean"}],return:{name:"void"}}},description:""},setup:{required:!0,tsType:{name:"signature",type:"function",raw:`(
    graphie: any,
    options: {
        range: [Coord, Coord];
        scale: [number, number];
    },
) => void`,signature:{arguments:[{type:{name:"any"},name:"graphie"},{type:{name:"signature",type:"object",raw:`{
    range: [Coord, Coord];
    scale: [number, number];
}`,signature:{properties:[{key:"range",value:{name:"tuple",raw:"[Coord, Coord]",elements:[{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]}],required:!0}},{key:"scale",value:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}],required:!0}}]}},name:"options"}],return:{name:"void"}}},description:""},onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(at: Coord) => void",signature:{arguments:[{type:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},name:"at"}],return:{name:"void"}}},description:""},onMouseDown:{required:!1,tsType:{name:"signature",type:"function",raw:"(at: Coord) => void",signature:{arguments:[{type:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},name:"at"}],return:{name:"void"}}},description:""},onMouseMove:{required:!1,tsType:{name:"signature",type:"function",raw:"(at: Coord) => void",signature:{arguments:[{type:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},name:"at"}],return:{name:"void"}}},description:""}}};const er=700;function ir(s){return/\.(jpg|jpeg)$/i.test(s)}function sr(s){return At.jsx("span",{style:{top:0,left:0,width:"100%",height:"100%",position:"absolute",minWidth:"20px",display:"flex",justifyContent:"center",alignContent:"center"},children:At.jsx(zn,{size:"medium"})})}class mn extends ai.Component{constructor(e){super(e);F(this,"_isMounted");F(this,"onImageLoad",()=>{this.sizeProvided()?this.setState({imageLoaded:!0}):Rt.getImageSize(this.props.src,(e,r)=>{this._isMounted&&this.setState({imageLoaded:!0,imageDimensions:[e,r]})})});F(this,"setupGraphie",(e,r)=>{w.map(r.labels,l=>{const{JIPT:h}=ne();if(h.useJIPT&&this.state.labelDataIsLocalized){const d=e.label(l.coordinates,l.content,l.alignment,!1);ne().svgImageJiptLabels.addLabel(d,l.typesetAsMath)}else if(l.coordinates){const d=this.props.scale!==1?{"font-size":100*this.props.scale+"%"}:null,v=e.label(l.coordinates,l.content,l.alignment,l.typesetAsMath,d),b=v[0].style;let y=this._tryGetPixels(b.top),M=this._tryGetPixels(b.left);if(y===null||M===null){const _=v.position();y=_.top,M=_.left}const x=(this.props.height||0)*this.props.scale,S=(this.props.width||0)*this.props.scale;v.css({top:y/x*100+"%",left:M/S*100+"%"}),w.each(l.style,(_,A)=>{v.css(A,_)})}this.setState({labelsRendered:{...this.state.labelsRendered,[l.content]:!0}})})});F(this,"_handleZoomClick",e=>{var l,h;(E(e.target).width()<this.props.width||this.props.zoomToFullSizeOnMobile)&&no.handleZoomClick(e,this.props.zoomToFullSizeOnMobile),(h=(l=this.props).trackInteraction)==null||h.call(l)});F(this,"handleUpdate",e=>{this.props.onUpdate(),!Rt.isLabeledSVG(this.props.src)&&e==="loaded"&&this.setState({imageLoaded:!0})});e.setAssetStatus(e.src,!1),this._isMounted=!1,this.state={imageLoaded:!1,imageDimensions:null,dataLoaded:!1,labelDataIsLocalized:!1,labels:[],labelsRendered:{},range:[[0,0],[0,0]]}}componentDidMount(){this._isMounted=!0,Rt.isLabeledSVG(this.props.src)&&this.loadResources()}UNSAFE_componentWillReceiveProps(e){this.props.src!==e.src&&this.setState({imageLoaded:!1,dataLoaded:!1})}shouldComponentUpdate(e,r){if(!w.isEqual(this.props,e))return!0;const l=this.isLoadedInState(this.state),h=this.isLoadedInState(r);return l!==h}componentDidUpdate(e,r){const l=this.isLoadedInState(r),h=this.isLoadedInState(this.state);Rt.isLabeledSVG(this.props.src)&&!h&&this.loadResources(),!l&&h&&this.props.setAssetStatus(this.props.src,!0)}componentWillUnmount(){this._isMounted=!1}isLoadedInState(e){return Rt.isLabeledSVG(this.props.src)?e.imageLoaded&&e.dataLoaded:e.imageLoaded}loadResources(){io(this.props.src,(e,r)=>{if(this._isMounted&&e.labels&&e.range){const l={};e.labels.forEach(h=>{l[h.content]=!1}),this.setState({dataLoaded:!0,labelDataIsLocalized:r,labelsRendered:l,labels:e.labels,range:e.range})}})}sizeProvided(){return this.props.width!=null&&this.props.height!=null}_tryGetPixels(e){return e=e||"",e.endsWith("px")&&parseFloat(e)||null}render(){const e=this.props.src,r={alt:this.props.alt,title:this.props.title},l=this.props.width&&this.props.width*this.props.scale,h=this.props.height&&this.props.height*this.props.scale,d={width:l,height:h},v=this.props.responsive&&!!(l&&h);let b;this.props.extraGraphie&&this.props.extraGraphie.labels.length&&(b=At.jsx(we,{box:this.props.extraGraphie.box,range:this.props.extraGraphie.range,options:{labels:this.props.extraGraphie.labels},responsive:!0,addMouseLayer:!1,setup:this.setupGraphie}));const y=this.props.preloader===void 0?sr:this.props.preloader,M=y?()=>y(d):null;if(!Rt.isLabeledSVG(e)){if(v){const _=Bn({zoomable:(l||0)>er,"svg-image":!0});return r.onClick=this._handleZoomClick,At.jsxs(Cs,{className:_,width:l,height:h,constrainHeight:this.props.constrainHeight,allowFullBleed:this.props.allowFullBleed&&ir(e),children:[At.jsx(Ke,{src:e,imgProps:r,preloader:M,onUpdate:this.handleUpdate}),b]})}return r.style=d,At.jsx(Ke,{src:e,preloader:M,imgProps:r,onUpdate:this.handleUpdate})}const x=Rt.getSvgUrl(e);let S;if(this.isLoadedInState(this.state)){let _;if(this.sizeProvided())_=[l,h];else if(this.state.imageDimensions)_=[this.state.imageDimensions[0]*this.props.scale,this.state.imageDimensions[1]*this.props.scale];else throw new jt("svg-image has no dimensions",Ht.InvalidInput,{metadata:{src:this.props.src}});S=At.jsx(we,{ref:"graphie",box:_,scale:[40*this.props.scale,40*this.props.scale],range:this.state.range,options:w.pick(this.state,"labels"),responsive:v,addMouseLayer:!1,setup:this.setupGraphie})}return v?At.jsxs(Cs,{className:"svg-image",width:l,height:h,constrainHeight:this.props.constrainHeight,children:[At.jsx(Ke,{src:x,onLoad:this.onImageLoad,onUpdate:this.handleUpdate,preloader:M,imgProps:r}),S,b]}):(r.style=d,At.jsxs("div",{className:"unresponsive-svg-image",style:d,children:[At.jsx(Ke,{src:x,onLoad:this.onImageLoad,onUpdate:this.handleUpdate,preloader:M,imgProps:r}),S]}))}}F(mn,"defaultProps",{constrainHeight:!1,onUpdate:()=>{},responsive:!0,src:"",scale:1,zoomToFullSizeOnMobile:!1,setAssetStatus:(e,r)=>{}});mn.__docgenInfo={description:"",methods:[{name:"isLoadedInState",docblock:null,modifiers:[],params:[{name:"state",optional:!1,type:{name:"signature",type:"object",raw:`{
    // For labeled SVGs, when both dataLoaded and imageLoaded are true,
    // indicates that loading has completed.
    dataLoaded: boolean;
    imageDimensions: [number, number] | null | undefined;
    // Used to indicate when a non-labeled SVG image is finished loading
    // and for labeled SVGs, indicates that it's safe to set up the graphie
    // containing the labels.
    imageLoaded: boolean;
    // Some graphies have labels which are rendered after the main image is
    // loaded.  This object keeps track of whether those labels have been
    // rendered.
    labelsRendered: LabelsRenderedMap;
    labelDataIsLocalized: boolean;
    labels: ReadonlyArray<Label>;
    range: [Coord, Coord];
}`,signature:{properties:[{key:"dataLoaded",value:{name:"boolean",required:!0}},{key:"imageDimensions",value:{name:"union",raw:"[number, number] | null | undefined",elements:[{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},{name:"null"},{name:"undefined"}],required:!0}},{key:"imageLoaded",value:{name:"boolean",required:!0}},{key:"labelsRendered",value:{name:"signature",type:"object",raw:`{
    [label: string]: boolean;
}`,signature:{properties:[{key:{name:"string"},value:{name:"boolean",required:!0}}]},required:!0}},{key:"labelDataIsLocalized",value:{name:"boolean",required:!0}},{key:"labels",value:{name:"ReadonlyArray",elements:[{name:"signature",type:"object",raw:`{
    coordinates: ReadonlyArray<any>;
    content: string;
    alignment: Alignment;
    typesetAsMath: boolean;
}`,signature:{properties:[{key:"coordinates",value:{name:"ReadonlyArray",elements:[{name:"any"}],raw:"ReadonlyArray<any>",required:!0}},{key:"content",value:{name:"string",required:!0}},{key:"alignment",value:{name:"union",raw:`| "default"
| "block"
| "inline-block"
| "inline"
| "float-left"
| "float-right"
| "full-width"`,elements:[{name:"literal",value:'"default"'},{name:"literal",value:'"block"'},{name:"literal",value:'"inline-block"'},{name:"literal",value:'"inline"'},{name:"literal",value:'"float-left"'},{name:"literal",value:'"float-right"'},{name:"literal",value:'"full-width"'}],required:!0}},{key:"typesetAsMath",value:{name:"boolean",required:!0}}]}}],raw:"ReadonlyArray<Label>",required:!0}},{key:"range",value:{name:"tuple",raw:"[Coord, Coord]",elements:[{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]}],required:!0}}]},alias:"State"}}],returns:{type:{name:"boolean"}}},{name:"loadResources",docblock:null,modifiers:[],params:[],returns:null},{name:"sizeProvided",docblock:null,modifiers:[],params:[],returns:{type:{name:"boolean"}}},{name:"onImageLoad",docblock:null,modifiers:[],params:[],returns:null},{name:"setupGraphie",docblock:null,modifiers:[],params:[{name:"graphie",optional:!1,type:{name:"any"}},{name:"options",optional:!1,type:{name:"any"}}],returns:null},{name:"_tryGetPixels",docblock:null,modifiers:[],params:[{name:"value",optional:!1,type:{name:"string"}}],returns:{type:{name:"union",raw:"null | number",elements:[{name:"null"},{name:"number"}]}}},{name:"_handleZoomClick",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:{name:"ReactSyntheticEvent",raw:"React.SyntheticEvent",alias:"React.SyntheticEvent"}}],returns:null},{name:"handleUpdate",docblock:null,modifiers:[],params:[{name:"status",optional:!1,type:{name:"string"}}],returns:null}],displayName:"SvgImage",props:{allowFullBleed:{required:!1,tsType:{name:"boolean"},description:""},alt:{required:!0,tsType:{name:"string"},description:""},constrainHeight:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},extraGraphie:{required:!1,tsType:{name:"signature",type:"object",raw:`{
    box: Size;
    range: [Coord, Coord];
    labels: ReadonlyArray<any>;
}`,signature:{properties:[{key:"box",value:{name:"tuple",raw:"[width: number, height: number]",elements:[{name:"unknown"},{name:"unknown"}],required:!0}},{key:"range",value:{name:"tuple",raw:"[Coord, Coord]",elements:[{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]}],required:!0}},{key:"labels",value:{name:"ReadonlyArray",elements:[{name:"any"}],raw:"ReadonlyArray<any>",required:!0}}]}},description:""},height:{required:!1,tsType:{name:"number"},description:""},onUpdate:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:`When the DOM updates to replace the preloader with the image, or
vice-versa, we trigger this callback.`,defaultValue:{value:"() => {}",computed:!1}},overrideAriaHidden:{required:!1,tsType:{name:"boolean"},description:`If alt is provided, DO NOT set aria-hidden=true unless this override flag
is set.`},preloader:{required:!1,tsType:{name:"signature",type:"function",raw:"(dimensions: Dimensions) => React.ReactNode",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
    width?: number;
    height?: number;
}`,signature:{properties:[{key:"width",value:{name:"number",required:!1}},{key:"height",value:{name:"number",required:!1}}]}},name:"dimensions"}],return:{name:"ReactReactNode",raw:"React.ReactNode"}}},description:""},responsive:{required:!1,tsType:{name:"boolean"},description:`By default, this component attempts to be responsive whenever
possible (specifically, when width and height are passed in).

You can expliclty force unresponsive behavior by *either*
not passing in width/height *or* setting this prop to false.

The difference is that forcing via this prop will result in
explicit width and height styles being set on the rendered
component.`,defaultValue:{value:"true",computed:!1}},scale:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"1",computed:!1}},src:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'""',computed:!1}},title:{required:!1,tsType:{name:"string"},description:""},trackInteraction:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},width:{required:!1,tsType:{name:"number"},description:""},zoomToFullSizeOnMobile:{required:!1,tsType:{name:"boolean"},description:`Whether clicking this image will allow it to be fully zoomed in to
its original size on click, and allow the user to scroll in that
state. This also does some hacky viewport meta tag changing to
ensure this works on mobile devices, so I (david@) don't recommend
enabling this on desktop yet.`,defaultValue:{value:"false",computed:!1}},setAssetStatus:{required:!1,tsType:{name:"signature",type:"function",raw:"(assetKey: string, loaded: boolean) => void",signature:{arguments:[{type:{name:"string"},name:"assetKey"},{type:{name:"boolean"},name:"loaded"}],return:{name:"void"}}},description:`If provided, use AssetContext.Consumer, see renderer.jsx.
If not, it defaults to a no-op.`,defaultValue:{value:"(src: string, status: boolean) => {}",computed:!1}}}};export{we as G,Ne as I,Y as K,De as L,mn as S,ci as W,kt as a,yt as b};
