import{p as T}from"./util-RIbStVAz.js";import{c as C,E as R}from"./all-widgets-lE1eR97M.js";import"./phet-simulation-FTLyxKwk.js";import{_ as b}from"./underscore-885MUNGo.js";import{q as z,P as O}from"./random-util-wZstT-Qs.js";import"./dependencies-CP7Uh8Kq.js";import"./perseus-api-Y55S7ZPk.js";import"./server-item-renderer-qyuA732i.js";import"./article-renderer-At2j_bUh.js";import"./hints-renderer-mPvPoDw6.js";import"./renderer-dpx07z-k.js";import"./base-radio-BB9wTXoW.js";import{c as L}from"./components-6YTEm5_B.js";import"./i18n-context-g2lQsEMW.js";import"./svg-image-Ot4D9rrr.js";import{f as q}from"./index-J2t_5nK1.js";import"./jquery-5v7aFUvu.js";import"./index-smZ6iCr_.js";import{B as w}from"./index-dLgOY9TT.js";import{C as h,l as E}from"./index-Mag-4PMw.js";import{S as B}from"./index-86cQASob.js";import{s as m,c as S}from"./index-QHkT31Yt.js";import{H as x,e as W}from"./index-OUR0CuKj.js";import{n as p}from"./no-important-xCWWYXQR.js";import{r as a}from"./index-6oxdNXpR.js";import{F as Y}from"./index-9gkyvru-.js";var _=function(s){return s===Object(s)},D=function(){for(var s={},e=0;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)s[n]=t[n]}return s},f=function(s){return _(s)?Array.isArray(s)?s.slice():D(s):s},g=function(s){if(Array.isArray(s))return P;if(_(s))return U;if(typeof s=="string")return V},l=function(s){if(s instanceof l)return s;if(!(this instanceof l))return new l(s);var e=g(s);this._wrapped=e.thaw?e.thaw(s):s};l.prototype.freeze=function(){var s=this._wrapped,e=g(s);return e.freeze?e.freeze(s):s};l.prototype.zoom=function(s){return this._zoomStack===void 0&&(this._zoomStack=[]),this._zoomStack.push({zoom:s,wrapped:this._wrapped}),this._wrapped=l(this._wrapped).get(s),this};l.prototype.deZoom=function(){var s=this._zoomStack.pop();return this._wrapped=l(s.wrapped).set(s.zoom,this._wrapped).freeze(),this};l.prototype.get=function(s){for(var e=this._wrapped,t=0;t<s.length;t++)e=g(e).get(e,s[t]);return e};l.prototype.mod=function(s,e){var t=this._wrapped,n=f(t),r=g(t);if(s.length===0)this._wrapped=e(this._wrapped);else if(s.length===1)this._wrapped=r.mod(n,s[0],e);else{var o=s[0],d=s.slice(1);n[o]=l(t[o]).mod(d,e).freeze(),this._wrapped=n}return this};l.prototype.merge=function(s,e){return this._wrapped=l(this._wrapped).mod(s,function(t){return D(t,e)}).freeze(),this};l.prototype.del=function(s){var e=this._wrapped,t=g(e);if(s.length===1)this._wrapped=t.del(e,s[0]);else{var n=s[0],r=s.slice(1),o=f(e);o[n]=l(e[n]).del(r).freeze(),this._wrapped=o}return this};l.prototype.set=function(s,e){return this.mod(s,function(){return e})};const P={get:function(s,e){return s[e]},set:function(s,e,t){var n=s.splice();return n[e]=t,n},mod:function(s,e,t){var n=s.slice();return n[e]=t(s[e]),n},del:function(s,e){var t=s.slice();return t.splice(e,1),t}},U={get:function(s,e){return s[e]},set:function(s,e,t){var n=f(s);return n[e]=t,n},mod:function(s,e,t){var n=f(s);return n[e]=t(s[e]),n},del:function(s,e){var t=f(s);return delete t[e],t}},V={get:function(s,e){return s[e]},set:function(s,e,t){var n=s.splice();return n[e]=t,n},mod:function(s,e,t){var n=s.splice();return n[e]=t(s[e]),n},del:function(s,e){var t=s.slice();return t.splice(e),t}},F=class F extends a.Component{constructor(e){super(e),this.state={dragging:-1,components:this.props.components},this.onDrop=this.onDrop.bind(this),this.onDragStart=this.onDragStart.bind(this),this.onDragEnter=this.onDragEnter.bind(this)}componentDidMount(){this._setDragEvents()}UNSAFE_componentWillReceiveProps(e){this.setState({components:e.components})}componentDidUpdate(){this._setDragEvents()}onDragStart(e){this.setState({dragging:e})}onDrop(){this.setState({dragging:-1}),this.props.onReorder(this.state.components)}onDragEnter(e){if(this.state.dragging===e)return;const t=this.state.components.slice(),n=t.splice(this.state.dragging,1);t.splice(e,0,n[0]);const r=this.props.verify(t);return r&&this.setState({dragging:e,components:t}),r}_listenEvent(e){e.dataTransfer.setData("hackhackhack","because browsers!")}_cancelEvent(e){e.preventDefault()}_setDragEvents(){this._dragItems=this._dragItems||[];const e=Y.findDOMNode(this).querySelectorAll("[draggable=true]"),t=[],n=[];for(let r=0;r<this._dragItems.length;r++){const o=this._dragItems[r];e.indexOf(o)<0&&t.push(o)}for(let r=0;r<e.length;r++){const o=e[r];this._dragItems.indexOf(o)<0&&n.push(o)}for(let r=0;r<n.length;r++){const o=n[r];o.addEventListener("dragstart",this._listenEvent),o.addEventListener("drop",this._cancelEvent)}for(let r=0;r<t.length;r++){const o=t[r];o.removeEventListener("dragstart",this._listenEvent),o.removeEventListener("drop",this._cancelEvent)}}render(){const e=this.state.components.map((t,n)=>a.createElement($,{index:n,component:t,area:this,key:t.key,draggable:t.props.draggable,dragging:n===this.state.dragging}));return a.createElement("ol",{className:this.props.className,style:this.props.style},e)}};F.defaultProps={verify:()=>!0};let v=F;class $ extends a.Component{handleDragStart(e){e.nativeEvent.dataTransfer.effectAllowed="move",this.props.area.onDragStart(this.props.index)}handleDrop(){this.props.area.onDrop(this.props.index)}handleDragEnter(e){const t=this.props.area.onDragEnter(this.props.index);e.nativeEvent.dataTransfer.effectAllowed=t?"move":"none"}handleDragOver(e){e.preventDefault()}render(){let e="sortable-disabled";return this.props.dragging?e="sortable-dragging":this.props.draggable&&(e="sortable-enabled"),a.createElement("li",{draggable:this.props.draggable,className:[e,p.css(K.sortableListItem)].join(" "),onDragStart:this.handleDragStart,onDrop:this.handleDrop,onDragEnter:this.handleDragEnter,onDragOver:this.handleDragOver},this.props.component)}}const K=p.StyleSheet.create({sortableListItem:{margin:"5px 0"}});v.__docgenInfo={description:`TODO(LEMS-2667): 11/26/24, at the time of writing this comment
it has been identified that this file has been broken long before
the refactoring of createReactClass. Future implementation need
to determine how to fix this functionality or deprecate it.
*
Takes an array of components to sort.
As of 08/05/24, there are two sortable components
(one in perseus and one in perseus-editor).
As far as I can tell, this one is only used in ExpressionEditor.`,methods:[{name:"onDragStart",docblock:null,modifiers:[],params:[{name:"startIndex",optional:!1,type:null}],returns:null},{name:"onDrop",docblock:null,modifiers:[],params:[],returns:null},{name:"onDragEnter",docblock:null,modifiers:[],params:[{name:"enterIndex",optional:!1,type:null}],returns:null},{name:"_listenEvent",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:null}],returns:null},{name:"_cancelEvent",docblock:null,modifiers:[],params:[{name:"e",optional:!1,type:null}],returns:null},{name:"_setDragEvents",docblock:null,modifiers:[],params:[],returns:null}],displayName:"SortableArea",props:{className:{required:!1,tsType:{name:"string"},description:""},components:{required:!0,tsType:{name:"Array",elements:[{name:"ReactReactElement",raw:"React.ReactElement"}],raw:"React.ReactElement[]"},description:""},onReorder:{required:!0,tsType:{name:"signature",type:"function",raw:"(i: any[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"any"}],raw:"any[]"},name:"i"}],return:{name:"void"}}},description:""},style:{required:!1,tsType:{name:"any"},description:""},verify:{required:!1,tsType:{name:"signature",type:"function",raw:"(i: any) => boolean",signature:{arguments:[{type:{name:"any"},name:"i"}],return:{name:"boolean"}}},description:"",defaultValue:{value:"() => true",computed:!1}}}};const{InfoTip:u}=L,A=["basic","trig","prealgebra","logarithms","scientific","basic relations","advanced relations"],I=({key:s})=>Number.parseInt(s??""),H=s=>{const e=[];s.forEach(t=>{e[I(t)]=!0});for(let t=0;t<e.length;t++)if(!e[t])return t;return e.length},y=class y extends a.Component{constructor(e){super(e),this.change=(...t)=>C.apply(this,t),this.serialize=()=>{const t=["value","form","simplify","considered","key"],n=["answerForms","buttonSets","functions","times","visibleLabel","ariaLabel"],r=this.props.answerForms.map(o=>b(o).pick(t));return l(this.props).set(["answerForms"],r).mod([],o=>b(o).pick(n)).freeze()},this.getSaveWarnings=()=>{const t=[];return this.props.answerForms.length===0?t.push("No answers specified"):(this.props.answerForms.some(r=>r.considered==="correct")||t.push("No correct answer specified"),b(this.props.answerForms).each((r,o)=>{if(this.props.value==="")t.push(`Answer ${o+1} is empty`);else{const d=T(r.value,{functions:this.props.functions});d.parsed?r.simplify&&!d.expr.isSimplified()&&t.push(`${r.value} isn't simplified, but is required" +
                            " to be`):t.push(`Couldn't parse ${r.value}`)}})),t},this._newEmptyAnswerForm=()=>({considered:"correct",form:!1,key:`${H(this.props.answerForms)}`,simplify:!1,value:""}),this.newAnswer=()=>{const t=this.props.answerForms.slice();t.push(this._newEmptyAnswerForm()),this.change({answerForms:t})},this.handleRemoveForm=t=>{const n=this.props.answerForms.slice();n.splice(t,1);const r=n.map((o,d)=>({...o,key:`${d}`}));this.change({answerForms:r})},this.handleReorder=t=>{const n=t.map(r=>{const o=b(r.props).pick("considered","form","simplify","value");return o.key=r.key,o});this.change({answerForms:n})},this.handleButtonSet=t=>{const r=A.filter(o=>this.props.buttonSets.includes(o)!==(o===t));this.props.onChange({buttonSets:r})},this.handleToggleDiv=()=>{let t,n;this.props.buttonSets.includes("basic+div")?(t="basic",n="basic+div"):(t="basic+div",n="basic");const r=this.props.buttonSets.filter(o=>o!==n).concat(t);this.change("buttonSets",r)},this.handleTexInsert=t=>{this.refs.expression.insert(t)},this.handleFunctions=t=>{this.setState({functionsInternal:t});const n={};n.functions=t.split(/[ ,]+/).filter(q),this.props.onChange(n)},this.changeExpressionWidget=(t,n)=>{const r={...this.props.answerForms[t],key:`${t}`,value:n.value};this.updateAnswerForm(t,r)},this.state={functionsInternal:this.props.functions.join(" ")}}updateAnswerForm(e,t){const n=l(this.props.answerForms).merge([e],t).freeze();this.change({answerForms:n})}changeSimplify(e,t){const n={...this.props.answerForms[e],key:`${e}`,simplify:t};this.updateAnswerForm(e,n)}changeForm(e,t){const n={...this.props.answerForms[e],form:t,key:`${e}`};this.updateAnswerForm(e,n)}changeConsidered(e,t){const n={...this.props.answerForms[e],key:`${e}`,considered:t};this.updateAnswerForm(e,n)}changeTimes(e){this.change({times:e})}render(){const e=this.props.answerForms.map((r,o)=>{const d=I(r),N={times:this.props.times,functions:this.props.functions,buttonSets:this.props.buttonSets,buttonsVisible:"focused",value:r.value,onChange:c=>this.changeExpressionWidget(d,c),trackInteraction:()=>{},widgetId:this.props.widgetId+"-"+r.key,visibleLabel:this.props.visibleLabel,ariaLabel:this.props.ariaLabel};return a.createElement(G,{key:r.key,draggable:!0,considered:r.considered,expressionProps:N,form:r.form,simplify:r.simplify,onDelete:()=>this.handleRemoveForm(o),onChangeSimplify:c=>this.changeSimplify(d,c),onChangeForm:c=>this.changeForm(d,c),onChangeConsidered:c=>this.changeConsidered(d,c)})}),t=a.createElement(v,{components:e,onReorder:this.handleReorder}),n=A.map(r=>{const o=r==="basic",d=this.props.buttonSets.includes(r)||o;return a.createElement(h,{key:r,label:r,checked:d,disabled:o,onChange:()=>this.handleButtonSet(r)})});return n.unshift(a.createElement(h,{key:"show ÷ button",label:"show ÷ button",checked:this.props.buttonSets.includes("basic+div"),onChange:this.handleToggleDiv})),a.createElement("div",null,a.createElement(x,null,"Global Options"),a.createElement("div",{className:p.css(i.paddedY)},a.createElement(E,{label:"Visible label",value:this.props.visibleLabel||"",onChange:this.change("visibleLabel")}),a.createElement(u,null,a.createElement("p",null,"Optional visible text; strongly encouraged to help learners using dictation software, but can be omitted if the surrounding content provides enough context."))),a.createElement("div",{className:p.css(i.paddedY)},a.createElement(E,{label:"Aria label",value:this.props.ariaLabel||"",onChange:this.change("ariaLabel")}),a.createElement(u,null,a.createElement("p",null,"Label text that's read by screen readers. Highly recommend adding a label here to ensure your exercise is accessible. For more information on writting accessible labels, please see"," ",a.createElement("a",{href:"https://www.w3.org/WAI/tips/designing/#ensure-that-form-elements-include-clearly-associated-labels",target:"_blank",rel:"noreferrer"},"this article.")))),a.createElement("div",{className:p.css(i.paddedY)},a.createElement(E,{label:"Function variables",value:this.state.functionsInternal,onChange:this.handleFunctions}),a.createElement(u,null,a.createElement("p",null,'Single-letter variables listed here will be interpreted as functions. This let us know that f(x) means "f of x" and not "f times x".'))),a.createElement("div",{className:p.css(i.paddedY)},a.createElement(h,{label:"Use × instead of ⋅ for multiplication",checked:this.props.times,onChange:r=>{this.changeTimes(r)}}),a.createElement(u,null,a.createElement("p",null,"For pre-algebra problems this option displays multiplication as \\times instead of \\cdot in both the rendered output and the acceptable formats examples."))),a.createElement("div",{className:p.css(i.paddedY)},a.createElement(W,null,"Button Sets"),n),a.createElement(x,null,"Answers"),a.createElement("p",{style:{margin:"4px 0"}},"student responses area matched against these from top to bottom"),t,a.createElement("div",null,a.createElement(w,{size:"small",onClick:this.newAnswer},"Add new answer")))}};y.widgetName="expression",y.defaultProps=z.defaultWidgetOptions;let k=y;const M=function(s,e){let t=s.indexOf(e);return t=(t+1)%s.length,s[t]};class G extends a.Component{constructor(){super(...arguments),this.state={deleteFocused:!1},this.change=(...e)=>C.apply(this,e),this.handleImSure=()=>{this.props.onDelete(),this.handleCancelDelete()},this.handleCancelDelete=()=>{this.setState({deleteFocused:!1})},this.handleDelete=()=>{this.setState({deleteFocused:!0})},this.toggleConsidered=()=>{const e=M(O,this.props.considered);this.props.onChangeConsidered(e)}}render(){const e=this.state.deleteFocused?a.createElement(a.Fragment,null,a.createElement(w,{size:"small",onClick:this.handleImSure,color:"destructive"},"I'm sure!"),a.createElement(B,{size:m.small_12}),a.createElement(w,{size:"small",onClick:this.handleCancelDelete,light:!0},"Cancel")):a.createElement(w,{size:"small",onClick:this.handleDelete,color:"destructive",light:!0},"Delete"),t=p.css(i.answerStatus,this.props.considered==="wrong"&&i.answerStatusWrong,this.props.considered==="correct"&&i.answerStatusCorrect,this.props.considered==="ungraded"&&i.answerStatusUngraded);return a.createElement("div",{className:p.css(i.answerOption)},a.createElement("div",{className:p.css(i.answerHandle)}),a.createElement("div",{className:p.css(i.answerBody)},a.createElement("div",null,a.createElement("button",{onClick:this.toggleConsidered,className:t},this.props.considered),a.createElement("div",null,a.createElement(R,{...this.props.expressionProps}))),a.createElement("div",{className:p.css(i.paddedY,i.paddedX)},a.createElement(h,{label:"Answer expression must have the same form.",checked:this.props.form,onChange:this.props.onChangeForm}),a.createElement(u,null,a.createElement("p",null,"The student's answer must be in the same form. Commutativity and excess negative signs are ignored."))),a.createElement("div",{className:p.css(i.paddedY,i.paddedX)},a.createElement(h,{label:"Answer expression must be fully expanded and simplified.",checked:this.props.simplify,onChange:this.props.onChangeSimplify}),a.createElement(u,null,a.createElement("p",null,`The student's answer must be fully expanded and simplified. Answering this equation (x^2+2x+1) with this factored equation (x+1)^2 will render this response "Your answer is not fully expanded and simplified."`))),a.createElement("div",{className:p.css(i.buttonRow,i.paddedY)},e)))}}const i=p.StyleSheet.create({paddedX:{paddingLeft:m.xSmall_8,paddingRight:m.xSmall_8},paddedY:{paddingTop:m.xxSmall_6,paddingBottom:m.xxSmall_6},answerOption:{border:"1px solid #ddd",borderRadius:"3px",display:"flex"},answerHandle:{background:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==) no-repeat 50% 50%",borderRight:"1px solid #ddd",cursor:"move",width:"20px",minWidth:"20px"},answerStatus:{border:"none",userSelect:"none",width:"100px",paddingTop:m.small_12,paddingBottom:m.small_12},answerStatusWrong:{backgroundColor:S.fadedRed16},answerStatusCorrect:{backgroundColor:S.fadedGreen16},answerStatusUngraded:{backgroundColor:S.fadedBlue16},answerBody:{},buttonRow:{display:"flex"}});k.__docgenInfo={description:"",methods:[{name:"change",docblock:null,modifiers:[],params:[{name:"...args",optional:!1,type:null}],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:null},{name:"getSaveWarnings",docblock:null,modifiers:[],params:[],returns:null},{name:"_newEmptyAnswerForm",docblock:null,modifiers:[],params:[],returns:null},{name:"newAnswer",docblock:null,modifiers:[],params:[],returns:null},{name:"handleRemoveForm",docblock:null,modifiers:[],params:[{name:"i",optional:!1,type:null}],returns:null},{name:"updateAnswerForm",docblock:null,modifiers:[],params:[{name:"i",optional:!1,type:{name:"number"}},{name:"props",optional:!1,type:{name:"ReadonlyArray[number]",raw:'PerseusExpressionWidgetOptions["answerForms"][number]',alias:"AnswerForm"}}],returns:null},{name:"handleReorder",docblock:null,modifiers:[],params:[{name:"components",optional:!1,type:null}],returns:null},{name:"handleButtonSet",docblock:null,modifiers:[],params:[{name:"changingName",optional:!1,type:null}],returns:null},{name:"handleToggleDiv",docblock:null,modifiers:[],params:[],returns:null},{name:"handleTexInsert",docblock:null,modifiers:[],params:[{name:"str",optional:!1,type:null}],returns:null},{name:"handleFunctions",docblock:null,modifiers:[],params:[{name:"value",optional:!1,type:null}],returns:null},{name:"changeSimplify",docblock:null,modifiers:[],params:[{name:"key",optional:!1,type:{name:"number"}},{name:"simplify",optional:!1,type:{name:"boolean"}}],returns:null},{name:"changeForm",docblock:null,modifiers:[],params:[{name:"key",optional:!1,type:{name:"number"}},{name:"form",optional:!1,type:{name:"boolean"}}],returns:null},{name:"changeConsidered",docblock:null,modifiers:[],params:[{name:"key",optional:!1,type:{name:"number"}},{name:"considered",optional:!1,type:{name:"unknown[number]",raw:"(typeof PerseusExpressionAnswerFormConsidered)[number]"}}],returns:null},{name:"changeTimes",docblock:null,modifiers:[],params:[{name:"times",optional:!1,type:{name:"boolean"}}],returns:null},{name:"changeExpressionWidget",docblock:null,modifiers:[],params:[{name:"key",optional:!1,type:null},{name:"props",optional:!1,type:null}],returns:null}],displayName:"ExpressionEditor",props:{widgetId:{required:!1,tsType:{name:"any"},description:""},value:{required:!1,tsType:{name:"string"},description:""},answerForms:{defaultValue:{value:"[]",computed:!1},required:!1},times:{defaultValue:{value:"false",computed:!1},required:!1},buttonSets:{defaultValue:{value:'["basic"]',computed:!1},required:!1},functions:{defaultValue:{value:'["f", "g", "h"]',computed:!1},required:!1}}};export{k as E};
