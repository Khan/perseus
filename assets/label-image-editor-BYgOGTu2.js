var y=Object.defineProperty;var C=(l,t,e)=>t in l?y(l,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[t]=e;var n=(l,t,e)=>(C(l,typeof t!="symbol"?t+"":t,e),e);import{r as k,c6 as v,aB as w,j as i,n as h}from"./iframe-qfk1c0wx.js";import"./item-version-DXWFoSVz.js";import"./article-renderer-D2p-Zvlh.js";import"./server-item-renderer-vluqCfII.js";import"./hints-renderer-Dge91Vhi.js";import{E as A}from"./editor-jsonify-3tib6xqH.js";import{F as x}from"./form-wrapped-text-field-CLFza334.js";import{A as b}from"./answer-choices-wXj5kZRQ.js";import{B as I}from"./behavior--e4e26wb.js";import{Q as q}from"./question-markers-DHBA87VW.js";import{S}from"./select-image-CbcBghc9.js";class c extends k.Component{constructor(){super(...arguments);n(this,"_questionMarkers");n(this,"getSaveWarnings",()=>{const{choices:e,imageAlt:o,imageUrl:r,markers:a}=this.props,s=[];if(e.length<2&&s.push("Question requires at least two answer choices"),r?o||s.push("Question image has no alt text"):s.push("Image is not specified for question"),!a.length)s.push("Question has no markers, to label answers on image");else{let m=0,p=0;for(const d of a)d.answers.length||m++,d.label||p++;m&&s.push(`Question has ${m} markers with no answers selected`),p&&s.push(`Question has ${p} markers with no ARIA label`)}return s});n(this,"handleImageChange",e=>{this.props.onChange({imageUrl:e,imageWidth:0,imageHeight:0}),e&&w.getImageSize(e,(o,r)=>{this.props.onChange({imageUrl:e,imageWidth:o,imageHeight:r})})});n(this,"handleAltChange",e=>{this.props.onChange({imageAlt:e})});n(this,"handleChoicesChange",e=>{this.props.onChange({choices:e})});n(this,"handleMarkersChange",e=>{this.props.onChange({markers:e})});n(this,"handleBehaviorChange",e=>{this.props.onChange(e)})}componentDidUpdate(e){const o={};e.markers.forEach(a=>o[`${a.x}.${a.y}`]=a);const r=this.props.markers.map((a,s)=>o.hasOwnProperty(`${a.x}.${a.y}`)?-1:s).filter(a=>a!==-1);r.length&&this._questionMarkers&&this._questionMarkers.openDropdownForMarkerIndices(r)}serialize(){return A.serialize.call(this)}render(){const{choices:e,imageAlt:o,imageUrl:r,imageWidth:a,imageHeight:s,markers:m,multipleAnswers:p,hideChoicesFromInstructions:d}=this.props,f=r&&a>0&&s>0;return i.jsxs("div",{children:[i.jsx(S,{onChange:this.handleImageChange,url:r}),i.jsx("div",{className:h.css(u.smallSpacer)}),f&&i.jsx(x,{placeholder:"Alt text (for screen readers)",onChange:g=>this.handleAltChange(g.target.value),value:o,width:"100%"}),i.jsx("div",{className:h.css(u.largeSpacer)}),i.jsx(q,{choices:e,imageUrl:f?r:"",imageWidth:a,imageHeight:s,markers:m,onChange:this.handleMarkersChange,ref:g=>this._questionMarkers=g}),i.jsx("div",{className:h.css(u.largeSpacer)}),i.jsx(b,{choices:e,onChange:this.handleChoicesChange}),i.jsx("div",{className:h.css(u.largeSpacer)}),i.jsx(I,{multipleAnswers:p,hideChoicesFromInstructions:d,onChange:this.handleBehaviorChange})]})}}n(c,"defaultProps",v.defaultWidgetOptions),n(c,"widgetName","label-image");const u=h.StyleSheet.create({largeSpacer:{height:32},smallSpacer:{height:16}});c.__docgenInfo={description:"",methods:[{name:"getSaveWarnings",docblock:null,modifiers:[],params:[],returns:null},{name:"serialize",docblock:null,modifiers:[],params:[],returns:{type:{name:"any"}}},{name:"handleImageChange",docblock:null,modifiers:[],params:[{name:"url",optional:!1,type:{name:"string"}}],returns:null},{name:"handleAltChange",docblock:null,modifiers:[],params:[{name:"alt",optional:!1,type:{name:"string"}}],returns:null},{name:"handleChoicesChange",docblock:null,modifiers:[],params:[{name:"choices",optional:!1,type:{name:"ReadonlyArray",elements:[{name:"string"}],raw:"ReadonlyArray<string>",alias:"ReadonlyArray"}}],returns:null},{name:"handleMarkersChange",docblock:null,modifiers:[],params:[{name:"markers",optional:!1,type:{name:"Array",raw:'PerseusLabelImageWidgetOptions["markers"]'}}],returns:null},{name:"handleBehaviorChange",docblock:null,modifiers:[],params:[{name:"options",optional:!1,type:{name:"any"}}],returns:null}],displayName:"LabelImageEditor",props:{choices:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:"",defaultValue:{value:"[]",computed:!1}},imageAlt:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'""',computed:!1}},imageUrl:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'""',computed:!1}},imageWidth:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},imageHeight:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},markers:{required:!1,tsType:{name:"Array",raw:'PerseusLabelImageWidgetOptions["markers"]'},description:"",defaultValue:{value:"[]",computed:!1}},multipleAnswers:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},hideChoicesFromInstructions:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(options: any) => void",signature:{arguments:[{type:{name:"any"},name:"options"}],return:{name:"void"}}},description:""}}};export{c as L};
