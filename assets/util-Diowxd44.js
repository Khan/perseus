import{V as Le,W as Ie,X as Ae,Y as De,z as Ve,x as $e,Z as N,U as R,p as x,_ as z}from"./core-widget-registry-Be22yvXk.js";import{_ as p}from"./underscore-U-AHniOr.js";import{P as S,E as C}from"./perseus-error-CSETqePQ.js";import{$}from"./jquery-CkHB0_Mt.js";import{g as ke}from"./get-decimal-separator-B2cicA45.js";function b(e){const t=[1,1];return e.forEach((n,r)=>{let o=0;n.forEach((s,i)=>{s!=null&&s.toString().length&&(o=i+1)}),t[1]=Math.max(t[1],o),o>0&&(t[0]=Math.max(t[0],r+1))}),t}function ze(){return/\[\[☃ ([A-Za-z0-9- ]+)\]\]/g}function be(e){const t=[],n=ze();let r=n.exec(e);for(;r!==null;)t.push(r[1]),r=n.exec(e);return t}function q(e){return Array.isArray(e)?e.map(q):e}const ne=function(e,t,n={}){const o={...{form:!1,simplify:!1},...n},s=e.sameVars(t);if(!s.equal){let i;return s.equalIgnoringCase?i="Check your variables; one or more are using the wrong case (upper or lower).":i="Check your variables; you may have used the wrong letter for one or more of them.",{equal:!1,wrongVariableCase:s.equalIgnoringCase,wrongVariableNames:!s.equalIgnoringCase,message:i}}return e.compare(t)?o.form&&!e.sameForm(t)?{equal:!1,message:"Your answer is not in the correct form."}:o.simplify&&!e.isSimplified()?{equal:!1,message:"Your answer is not fully expanded and simplified."}:{equal:!0,message:null}:{equal:!1,message:null}},pr=function(e,t){return p.object(p.map(e,function(n,r){return[r,n[t]]}))},qe=function(e,t){const n={};return Object.keys(e).forEach(r=>{n[r]=t(e[r],r)}),n},We=!1,Ge=e=>{var c;const t=e.type;if(!p.isString(t))throw new S("widget type must be a string, but was: "+t,C.Internal);if(!Le(t))return e;const n=e.version||{major:0,minor:0},r=Ie(t);if(n.major>r.major||n.major===r.major&&n.minor>r.minor)return e;let o=p.clone(e.options)||{};const s=Ae(t);if(p.keys(o).length!==0)for(let u=n.major+1;u<=r.major;u++)if(s[String(u)])o=s[String(u)](o);else throw new S("No upgrade found for widget. Cannot render.",C.Internal,{metadata:{type:t,fromMajorVersion:u-1,toMajorVersion:u,oldWidgetInfo:JSON.stringify(e)}});o={...De(t),...o};let a=e.alignment;if((a==null||a==="default")&&(a=(c=Ve(t))==null?void 0:c[0],!a))throw new S("No default alignment found when upgrading widget",C.Internal,{metadata:{widgetType:t}});let l=e.static;return l==null&&(l=We),{...e,version:r,graded:e.graded!=null?e.graded:!0,alignment:a,static:l,options:o}};function je(e){return qe(e,(t,n)=>{if(!t.type||!t.alignment){const r={};t.type||(r.type=n.split(" ")[0]),t.alignment||(r.alignment="default"),t={...t,...r}}return Ge(t)})}const Ue="@khanacademy/kmath",Xe="__lib_version__";$e(Ue,Xe);const me=1e-9,He=Math.pow(2,-42);function Ye(e){return p.isNumber(e)&&!p.isNaN(e)}function _(e,t,n){return e==null||t==null?e===t:e===t?!0:(n==null&&(n=me),Math.abs(e-t)<n)}function dr(e,t){return _(e,0,t)?0:Math.abs(e)/e}function Qe(e,t){return _(Math.round(e),e,t)}function mr(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}function Be(e,t){return Math.round(e/t)*t}function Je(e,t){return Math.floor(e/t)*t}function Ke(e,t){return Math.ceil(e/t)*t}function re(e,t=He,n=1e3){let r=[1,0],o=[0,1],s=Math.floor(e),i=e-s;for(;o[0]<=n;){if(_(r[0]/o[0],e,t))return[r[0],o[0]];r=[s*r[0]+r[1],r[0]],o=[s*o[0]+o[1],o[0]],s=Math.floor(1/i),i=1/i-s}return[e,1]}function ge(e){return e.reduce((t,n)=>t+n,0)}function Ze(e){return e.reduce((t,n)=>t*n,1)}function A(...e){const t=Math.min(...e.map(r=>r.length)),n=[];for(let r=0;r<t;r++)n.push(e.map(o=>o[r]));return n}function et(e,t){return!Array.isArray(e)||t!==void 0&&e.length!==t?!1:e.every(Ye)}function gr(e){return Q(e,1/H(e))}function H(e){return Math.sqrt(W(e,e))}function W(e,t){const r=A(e,t).map(Ze);return ge(r)}function Y(...e){return A(...e).map(ge)}function P(e,t){return A(e,t).map(n=>n[0]-n[1])}function hr(e){return e.map(t=>-t)}function Q(e,t){return e.map(n=>n*t)}function tt(e,t,n){return e.length===t.length&&A(e,t).every(r=>_(r[0],r[1],n))}function nt(e){const t=H(e);let n=Math.atan2(e[1],e[0]);return n<0&&(n+=2*Math.PI),[t,n]}function rt(e){const t=nt(e);return[t[0],t[1]*180/Math.PI]}function ot(e,t=0){return[e*Math.cos(t),e*Math.sin(t)]}function st(e,t=0){return ot(e,t*Math.PI/180)}function yr(e,t){const n=rt(e),r=n[1]+t;return st(n[0],r)}function it(e,t){const n=W(e,t)/W(t,t);return Q(t,n)}function at(e,t){return e.map((n,r)=>Be(n,t[r]||t))}function ct(e,t){return e.map((n,r)=>Je(n,t[r]||t))}function lt(e,t){return e.map((n,r)=>Ke(n,t[r]||t))}function Rr(e,t){return H(P(e,t))}function vr(e,t){const n=P(t[1],t[0]),r=P(e,t[0]),o=it(r,n),s=P(Q(o,2),r);return Y(t[0],s)}const Er=et,Mr=Y,wr=Y,ut=tt,Or=at,Sr=ct,Cr=lt,g={cleanMath:function(e){return typeof e=="string"?e.replace(/\+\s*-/g,"- ").replace(/-\s*-/g,"+ ").replace(/\^1/g,""):e},bound:function(e){return e===0?e:e<0?-g.bound(-e):Math.max(1e-6,Math.min(e,1e20))},factorial:function(e){return e<=1?e:e*g.factorial(e-1)},getGCD:function(e,t){if(arguments.length>2){const r=[].slice.call(arguments,1);return g.getGCD(e,g.getGCD(...r))}let n;for(e=Math.abs(e),t=Math.abs(t);t;)n=e%t,e=t,t=n;return e},getLCM:function(e,t){if(arguments.length>2){const n=[].slice.call(arguments,1);return g.getLCM(e,g.getLCM(...n))}return Math.abs(e*t)/g.getGCD(e,t)},primes:[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97],isPrime:function(e){if(e<=1)return!1;if(e<101)return!!$.grep(g.primes,function(t,n){return Math.abs(t-e)<=.5}).length;if(e<=1||e>2&&e%2===0)return!1;for(let t=3,n=Math.sqrt(e);t<=n;t+=2)if(e%t===0)return!1;return!0},getPrimeFactorization:function(e){if(e===1)return[];if(g.isPrime(e))return[e];const t=Math.sqrt(e);for(let n=2;n<=t;n++)if(e%n===0)return $.merge(g.getPrimeFactorization(n),g.getPrimeFactorization(e/n))},roundToNearest:function(e,t){return Math.round(t/e)*e},roundTo:function(e,t){const n=Math.pow(10,e).toFixed(5);return Math.round((t*n).toFixed(5))/n},toFixedApprox:function(e,t){const n=e.toFixed(t);return _(+n,e)?n:"\\approx "+n},roundToApprox:function(e,t){const n=g.roundTo(t,e);return _(n,e)?String(n):g.toFixedApprox(e,t)},toFraction:function(e,t){if(t==null&&(t=Math.pow(2,-46)),e<0||e>1){let l=e%1;l+=l<0?1:0;const c=g.toFraction(l,t);return c[0]+=Math.round(e-l)*c[1],c}if(Math.abs(Math.round(Number(e))-e)<=t)return[Math.round(e),1];let n=0,r=1,o=1,s=1,i=1,a=2;for(;;){if(Math.abs(Number(i/a)-e)<=t)return[i,a];i/a<e?(n=i,r=a):(o=i,s=a),i=n+o,a=r+s}},getNumericFormat:function(e){if(e=$.trim(e),e=e.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1"),e.match(/^[+-]?\d+$/))return"integer";if(e.match(/^[+-]?\d+\s+\d+\s*\/\s*\d+$/))return"mixed";const t=e.match(/^[+-]?(\d+)\s*\/\s*(\d+)$/);return t?parseFloat(t[1])>parseFloat(t[2])?"improper":"proper":e.replace(/[,. ]/g,"").match(/^\d+$/)?"decimal":e.match(/(pi?|\u03c0|t(?:au)?|\u03c4|pau)/)?"pi":null},toNumericString:function(e,t){if(e==null)return"";if(e===0)return"0";if(t==="percent")return e*100+"%";if(t==="pi"){const n=re(e/Math.PI),r=Math.abs(n[0]),o=n[1];if(Qe(r))return(e<0?"-":"")+(r===1?"":r)+"π"+(o===1?"":"/"+o)}if(p(["proper","improper","mixed","fraction"]).contains(t)){const n=re(e),r=Math.abs(n[0]),o=n[1],s=e<0?"-":"";if(o===1)return s+r;if(t==="mixed"){const i=r%o,a=(r-i)/o;return s+(a?a+" ":"")+i+"/"+o}return s+r+"/"+o}return String(e)}};function ft(e){return e.reduce(pt,0)}function pt(e,t){return e+t}function B(e){return N(e,0)?0:e>0?1:-1}function D(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(n[0]-e[0])*(t[1]-e[1])}function dt(e,t,n){return N(D(e,t,n),0)}function mt(e,t,n){return n[0]<=Math.max(e[0],t[0])&&n[0]>=Math.min(e[0],t[0])&&n[1]<=Math.max(e[1],t[1])&&n[1]>=Math.min(e[1],t[1])}function he(e,t){const n=[[e[0],e[1],t[0]],[e[0],e[1],t[1]],[t[0],t[1],e[0]],[t[0],t[1],e[1]]],r=p.map(n,function(o){return B(D(...o))});if(r[0]!==r[1]&&r[2]!==r[3])return!0;for(let o=0;o<4;o++)if(r[o]===0&&mt(...n[o]))return!0;return!1}function gt(e){for(let t=0;t<e.length;t++)for(let n=t+1;n<e.length;n++){if(ut(e[t],e[n]))return!0;const r=(t+1)%e.length,o=(n+1)%e.length;if(r===n||o===t)continue;const s=[e[t],e[r]],i=[e[n],e[o]];if(he(s,i))return!0}return!1}function L(e,t){return p.map(p.zip(e,t),function(n){return n[0]-n[1]})}function ht(e){return[-e[0],-e[1]]}function ye(e){const t=p.zip(e,e.slice(1).concat(e.slice(0,1))),n=p.map(t,function(r){const o=r[0],s=r[1];return(s[0]-o[0])*(s[1]+o[1])});return ft(n)>0}function I(e){return Math.sqrt(p.reduce(e,function(t,n){return t+Math.pow(n,2)},0))}function yt(e,t){return p.reduce(p.zip(e,t),function(n,r){return n+r[0]*r[1]},0)}function oe(e){return p.zip(e,T(e)).map(function(n){return I(L(...n))})}function G(e){const t=p.zip(T(e,-1),e,T(e,1)),n=p.map(t,function(o){const s=L(o[1],o[0]),i=L(o[2],o[1]),a=Math.acos(yt(s,i)/(I(s)*I(i)));return B(D(...o))>0?a:-a}),r=p.reduce(n,function(o,s){return o+s},0);return p.map(n,function(o){return r>0?Math.PI-o:Math.PI+o})}function Rt(e,t,n){if(e.length!==t.length)return!1;const r=e.length,o=G(e),s=G(t),i=oe(e),a=oe(t);for(let l=0;l<2*r;l++){let c=s.slice(),u=a.slice();if(l>=r&&(c.reverse(),u.reverse(),u=T(u,1)),c=T(c,l),u=T(u,l),R(o,c)){const f=p.zip(i,u),m=p.map(f,function(w){return w[0]/w[1]}),h=p.all(m,function(w){return N(m[0],w)}),F=p.all(f,function(w){return _(w[0],w[1],n)});if(h&&F)return!0}}return!1}function vt(e,t,n){return Math.acos((e*e+t*t-n*n)/(2*e*t))*180/Math.PI}function Et([e,t,n,r]){e<0&&(e*=-1,t*=-1,n*=-1);const o=2*Math.PI;for(t<0&&(t*=-1,n*=-1,n+=o/2);n>0;)n-=o;for(;n<0;)n+=o;return[e,t,n,r]}function T(e,t){return t=typeof t>"u"?1:t%e.length,e.slice(t).concat(e.slice(0,t))}function Mt(e,t){if(N(e[0],t[0]))return"x = "+e[0].toFixed(3);const n=(t[1]-e[1])/(t[0]-e[0]),r=e[1]-n*e[0];return"y = "+n.toFixed(3)+"x + "+r.toFixed(3)}function Re(e,t){const n=e[0][0],r=e[0][1],o=e[1][0],s=e[1][1],i=t[0][0],a=t[0][1],l=t[1][0],c=t[1][1],u=(n-o)*(a-c)-(r-s)*(i-l);if(Math.abs(u)<1e-9)return null;const f=((n*s-r*o)*(i-l)-(n-o)*(i*c-a*l))/u,m=((n*s-r*o)*(a-c)-(r-s)*(i*c-a*l))/u;return[f,m]}function wt(e,t){const n=Re(e,t);if(n===null)return"Lines are parallel";const[r,o]=n;return"Intersection: ("+r.toFixed(3)+", "+o.toFixed(3)+")"}const Ot=Object.freeze(Object.defineProperty({__proto__:null,angleMeasures:G,canonicalSineCoefficients:Et,ccw:D,clockwise:ye,collinear:dt,getLineEquation:Mt,getLineIntersection:Re,getLineIntersectionString:wt,intersects:he,lawOfCosines:vt,magnitude:I,polygonSidesIntersect:gt,reverseVector:ht,rotate:T,sign:B,similar:Rt,vector:L},Symbol.toStringTag,{value:"Module"}));function St(e){return e/180*Math.PI}function Ct(e){const t=e/Math.PI*180;return Number(t.toPrecision(15))}function _t([e,t]){return Math.atan2(t,e)*180/Math.PI}function Tt(e,t){return typeof e=="number"&&(e=[e,e]),t=t*Math.PI/180,[e[0]*Math.cos(t),e[1]*Math.sin(t)]}const j=(e,t)=>{const n=e[0]-t[0],r=e[1]-t[1];return!n&&!r?0:(180+Math.atan2(-r,-n)*180/Math.PI+360)%360},Nt=(e,t=!1)=>{const n=[...e],s=!ye([n[0],n[2],n[1]])||t?n.reverse():n,i=j(s[0],s[1]),a=j(s[2],s[1]);return(i+360-a)%360},Ft=Object.freeze(Object.defineProperty({__proto__:null,calculateAngleInDegrees:_t,convertDegreesToRadians:St,convertRadiansToDegrees:Ct,getAngleFromVertex:j,getClockwiseAngle:Nt,polar:Tt},Symbol.toStringTag,{value:"Module"}));function xt(e){const t=e[0],n=e[1],r=n[1]-t[1],o=Math.PI/(2*(n[0]-t[0])),s=t[0]*o,i=t[1];return[r,o,s,i]}function Pt(e){const t=e[0],n=e[1],r=e[2],o=(t[0]-n[0])*(t[0]-r[0])*(n[0]-r[0]);if(o===0)return;const s=(r[0]*(n[1]-t[1])+n[0]*(t[1]-r[1])+t[0]*(r[1]-n[1]))/o,i=(r[0]*r[0]*(t[1]-n[1])+n[0]*n[0]*(r[1]-t[1])+t[0]*t[0]*(n[1]-r[1]))/o,a=(n[0]*r[0]*(n[0]-r[0])*t[1]+r[0]*t[0]*(r[0]-t[0])*n[1]+t[0]*n[0]*(t[0]-n[0])*r[1])/o;return[s,i,a]}const Lt=Object.freeze(Object.defineProperty({__proto__:null,getQuadraticCoefficients:Pt,getSinusoidCoefficients:xt},Symbol.toStringTag,{value:"Module"})),It="MISSING_PERCENT_ERROR",At="NEEDS_TO_BE_SIMPLIFIED_ERROR",Dt="APPROXIMATED_PI_ERROR",Vt="EXTRA_SYMBOLS_ERROR",$t="WRONG_CASE_ERROR",kt="WRONG_LETTER_ERROR",zt="MULTIPLICATION_SIGN_ERROR",bt="INVALID_SELECTION_ERROR",qt="CHOOSE_CORRECT_NUM_ERROR",Wt="NOT_NONE_ABOVE_ERROR",Gt="FILL_ALL_CELLS_ERROR",v={MISSING_PERCENT_ERROR:It,NEEDS_TO_BE_SIMPLIFIED_ERROR:At,APPROXIMATED_PI_ERROR:Dt,EXTRA_SYMBOLS_ERROR:Vt,WRONG_CASE_ERROR:$t,WRONG_LETTER_ERROR:kt,MULTIPLICATION_SIGN_ERROR:zt,INVALID_SELECTION_ERROR:bt,CHOOSE_CORRECT_NUM_ERROR:qt,NOT_NONE_ABOVE_ERROR:Wt,FILL_ALL_CELLS_ERROR:Gt},jt=Math.pow(2,-42),E={predicate:{defaultForms:"integer, proper, improper, mixed, decimal",createValidatorFunctional:function(e,t){t=p.extend({simplify:"required",ratio:!1,forms:E.predicate.defaultForms},t);let n;p.isArray(t.forms)?n=t.forms:n=t.forms.split(/\s*,\s*/),t.inexact===void 0&&(t.maxError=0),t.maxError=+t.maxError+jt,p.contains(n,"percent")&&(n=p.without(n,"percent"),n.push("percent"));const r=function(s){s=s.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").replace(/(^\s*)|(\s*$)/gi,"");const i=s.match(/^([+-]?\d+)\s*\/\s*([+-]?\d+)$/),a=s.match(/^([+-]?)\\frac\{([+-]?\d+)\}\{([+-]?\d+)\}$/),l=parseInt(s,10);if(i||a){let c,u,f=!0;return i?(c=parseFloat(i[1]),u=parseFloat(i[2])):(c=parseFloat(a[2]),a[1]==="-"&&(c<0&&(f=!1),c=-c),u=parseFloat(a[3])),f=f&&u>0&&(t.ratio||u!==1)&&g.getGCD(c,u)===1,[{value:c/u,exact:f}]}return!isNaN(l)&&""+l===s?[{value:l,exact:!0}]:[]},o={integer:function(s){const i=o.decimal(s),a=o.decimal(s,1);return i[0].value!=null&&i[0].value===a[0].value||i[1].value!=null&&i[1].value===a[1].value?i:[]},proper:function(s){return r(s).flatMap(a=>Math.abs(a.value)<1?[a]:[])},improper:function(s){return s.includes("/")||s.match(/\\(d?frac)/)?r(s).flatMap(l=>Math.abs(l.value)>=1?[l]:[]):[]},pi:function(s){let i,a=[];if(s=s.replace(/\u2212/,"-"),i=s.match(/^([+-]?)\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i))a=[{value:parseFloat(i[1]+"1"),exact:!0}];else if(i=s.match(/^([+-]?\s*\d+\s*(?:\/\s*[+-]?\s*\d+)?)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i))a=r(i[1]);else if(i=s.match(/^([+-]?)\s*(\d+)\s*([+-]?\d+)\s*\/\s*([+-]?\d+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i)){const c=parseFloat(i[1]+"1"),u=parseFloat(i[2]),f=parseFloat(i[3]),m=parseFloat(i[4]),h=f<m&&g.getGCD(f,m)===1;a=[{value:c*(u+f/m),exact:h}]}else if(i=s.match(/^([+-]?\s*\d+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)\s*(?:\/\s*([+-]?\s*\d+))?$/i))a=r(i[1]+"/"+i[3]);else if(i=s.match(/^([+-]?)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)\s*(?:\/\s*([+-]?\d+))?$/i))a=r(i[1]+"1/"+i[3]);else if(s==="0")a=[{value:0,exact:!0}];else if(i=s.match(/^(.+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i))a=o.decimal(i[1]);else{a=p.reduce(E.predicate.defaultForms.split(/\s*,\s*/),function(f,m){return f.concat(o[m](s))},[]);let c=!1;const u=parseFloat(s);if(!isNaN(u)&&u!==parseInt(s)){const f=Math.PI/12,m=f*Math.round(u/f);Math.abs(u-m)<.01&&(c=!0)}else s.match(/\/\s*7/)&&(c=!0);return c&&p.each(a,function(f){f.piApprox=!0}),a}let l=Math.PI;return s.match(/\\?tau|t|\u03c4/)&&(l=Math.PI*2),s.match(/pau/)&&(l=Math.PI*1.5),a.forEach(c=>{c.value*=l}),a},coefficient:function(s){let i=[];return s=s.replace(/\u2212/,"-"),s===""?i=[{value:1,exact:!0}]:s==="-"&&(i=[{value:-1,exact:!0}]),i},log:function(s){let i,a=[];return s=s.replace(/\u2212/,"-"),s=s.replace(/[ \(\)]/g,""),(i=s.match(/^log\s*(\S+)\s*$/i))?a=o.decimal(i[1]):s==="0"&&(a=[{value:0,exact:!0}]),a},percent:function(s){s=String(s).trim();let i=!1;s.indexOf("%")===s.length-1&&(s=s.substring(0,s.length-1).trim(),i=!0);const a=o.decimal(s);return a.forEach(l=>{l.exact=i,l.value=l.value/100}),a},mixed:function(s){const i=s.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").match(/^([+-]?)(\d+)\s+(\d+)\s*\/\s*(\d+)$/);if(i){const a=parseFloat(i[1]+"1"),l=parseFloat(i[2]),c=parseFloat(i[3]),u=parseFloat(i[4]),f=c<u&&g.getGCD(c,u)===1;return[{value:a*(l+c/u),exact:f}]}return[]},decimal:function(s,i=1e10){const a=function(c){c=String(c).trim();const u=c.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").match(/^([+-]?(?:\d{1,3}(?:[, ]?\d{3})*\.?|\d{0,3}(?:[, ]?\d{3})*\.(?:\d{3}[, ]?)*\d{1,3}))$/),f=c.match(/^0[0,]*,/);if(u&&!f){let m=parseFloat(u[1].replace(/[, ]/g,""));return t.inexact===void 0&&(m=Math.round(m*i)/i),m}},l=function(c){return c=c.replace(/([\.,])/g,function(u,f){return f==="."?",":"."}),a(c)};return[{value:a(s),exact:!0},{value:l(s),exact:!0}]}};return function(s){const i=t.fallback!=null?""+t.fallback:"";s=String(s).trim()||i;const a={empty:s==="",correct:!1,message:null,guess:s};if((()=>{for(const c of n){const u=o[c](s);for(let f=0,m=u.length;f<m;f++){const h=u[f].value,F=u[f].exact,w=u[f].piApprox;if(e(h,t.maxError))return F||t.simplify==="optional"?(a.correct=!0,a.message=t.message||null,a.empty=!1):c==="percent"?(a.empty=!0,a.message=v.MISSING_PERCENT_ERROR):(t.simplify!=="enforced"&&(a.empty=!0),a.message=v.NEEDS_TO_BE_SIMPLIFIED_ERROR),!1;w&&e(h,Math.abs(h*.001))&&(a.empty=!0,a.message=v.APPROXIMATED_PI_ERROR)}}})(),a.correct===!1){let c=!1;if(p.each(o,function(u){p.any(u(s),function(m){return m.value!=null&&!p.isNaN(m.value)})&&(c=!0)}),!c)return a.empty=!0,a.message=v.EXTRA_SYMBOLS_ERROR,a}return a}}},number:{convertToPredicate:function(e,t){const n=parseFloat(e);return[function(r,o){return Math.abs(r-n)<o},{...t,type:"predicate"}]},createValidatorFunctional:function(e,t){return E.predicate.createValidatorFunctional(...E.number.convertToPredicate(e,t))}},expression:{parseSolution:function(e,t){let n=x(e,t);if(n.parsed){if(t.simplified&&!n.expr.isSimplified())throw new S("The provided solution ("+e+") isn't fully expanded and simplified.",C.InvalidInput);n=n.expr}else throw new S("The provided solution ("+e+") didn't parse.",C.InvalidInput);return n},createValidatorFunctional:function(e,t){return function(n){const r={empty:!1,correct:!1,message:null,guess:n,ungraded:!1};if(!n)return r.empty=!0,r;const o=x(n,t);if(!o.parsed)return r.empty=!0,r;typeof e=="string"&&(e=E.expression.parseSolution(e,t));const s=ne(o.expr,e,t);if(s.equal)r.correct=!0;else if(s.wrongVariableNames||s.wrongVariableCase)r.ungraded=!0,r.message=s.wrongVariableCase?v.WRONG_CASE_ERROR:v.WRONG_LETTER_ERROR,r.suppressAlmostThere=!0;else if(s.message)r.message=s.message;else{const i=x(n.replace(/[xX]/g,"*"),t);if(i.parsed){const a=ne(i.expr,e,t);a.equal?(r.ungraded=!0,r.message=v.MULTIPLICATION_SIGN_ERROR):a.message&&(r.message=a.message+" Also, I'm a computer. I only understand multiplication if you use an asterisk (*) as the multiplication sign.")}}return r}}}};function Ut(e,t){let n=!0;return t.values.forEach((r,o)=>{e.values[o]!==r&&(n=!1)}),{type:"points",earned:n?1:0,total:1,message:null}}function Xt(e,t){return t.items.some((r,o)=>e.values[o]==null)?{type:"invalid",message:v.INVALID_SELECTION_ERROR}:null}function Ht(e){return e.status==="correct"?{type:"points",earned:1,total:1,message:e.message||null}:e.status==="incorrect"?{type:"points",earned:0,total:1,message:e.message||null}:{type:"invalid",message:"Keep going, you're not there yet!"}}function Yt(e,t){return{type:"points",earned:t.choices[e.value-1].correct?1:0,total:1,message:null}}function Qt(e){return e.value===0?{type:"invalid",message:null}:null}function Bt(e,t,n){const r=p.clone(t);p.extend(r,{decimal_separator:ke(n)});const o=c=>{const u=x(c.value,t);if(!u.parsed)throw new S("Unable to parse solution answer for expression",C.InvalidInput,{metadata:{rubric:JSON.stringify(t)}});return E.expression.createValidatorFunctional(u.expr,p({}).extend(r,{simplify:c.simplify,form:c.form}))};let s,i,a=!0,l;for(const c of t.answerForms||[]){const u=o(c);if(!u)continue;const f=u(e);if(f.correct){s=c,i=f.message||"";break}a=a&&f.empty,c.considered==="correct"&&f.ungraded&&!l&&(l=f)}return s?s.considered==="ungraded"?{type:"invalid",message:i}:{type:"points",earned:s.considered==="correct"?1:0,total:1,message:i}:l?{type:"invalid",message:l.message,suppressAlmostThere:l.suppressAlmostThere}:a?{type:"invalid",message:null}:{type:"points",earned:0,total:1}}function Jt(e){return e===""?{type:"invalid",message:null}:null}function se(e){if(e.coords!=null){if(e.type==="exponential"||e.type==="logarithm")return z(e.type).getCoefficients(e.coords,e.asymptote);if(e.type==="linear"||e.type==="quadratic"||e.type==="absolute_value"||e.type==="sinusoid"||e.type==="tangent")return z(e.type).getCoefficients(e.coords);throw new S("Invalid grapher type",C.InvalidInput)}}function Kt(e,t){if(e.type!==t.correct.type)return{type:"points",earned:0,total:1,message:null};if(e.coords==null)return{type:"invalid",message:null};const n=z(e.type),r=se(e),o=se(t.correct);return r==null||o==null?{type:"invalid",message:null}:n.areEqual(r,o)?{type:"points",earned:1,total:1,message:null}:{type:"points",earned:0,total:1,message:null}}function Zt(e){return e.status==="correct"?{type:"points",earned:1,total:1,message:e.message||null}:e.status==="incorrect"?{type:"points",earned:0,total:1,message:e.message||null}:{type:"invalid",message:"Keep going, you're not there yet!"}}const{collinear:y,canonicalSineCoefficients:ie,similar:k,clockwise:en}=Ot,{getClockwiseAngle:tn}=Ft,{getSinusoidCoefficients:ae,getQuadraticCoefficients:ce}=Lt;function nn(e,t){if(e.type==="none"&&t.correct.type==="none")return{type:"points",earned:0,total:0,message:null};const n=!!(e.coords||e.center&&e.radius);if(e.type===t.correct.type&&n){if(e.type==="linear"&&t.correct.type==="linear"&&e.coords!=null){const r=e.coords,o=t.correct.coords;if(y(o[0],o[1],r[0])&&y(o[0],o[1],r[1]))return{type:"points",earned:1,total:1,message:null}}else if(e.type==="linear-system"&&t.correct.type==="linear-system"&&e.coords!=null){const r=e.coords,o=t.correct.coords;if(y(o[0][0],o[0][1],r[0][0])&&y(o[0][0],o[0][1],r[0][1])&&y(o[1][0],o[1][1],r[1][0])&&y(o[1][0],o[1][1],r[1][1])||y(o[0][0],o[0][1],r[1][0])&&y(o[0][0],o[0][1],r[1][1])&&y(o[1][0],o[1][1],r[0][0])&&y(o[1][0],o[1][1],r[0][1]))return{type:"points",earned:1,total:1,message:null}}else if(e.type==="quadratic"&&t.correct.type==="quadratic"&&e.coords!=null){const r=ce(e.coords),o=ce(t.correct.coords);if(R(r,o))return{type:"points",earned:1,total:1,message:null}}else if(e.type==="sinusoid"&&t.correct.type==="sinusoid"&&e.coords!=null){const r=ae(e.coords),o=ae(t.correct.coords),s=ie(r),i=ie(o);if(R(s,i))return{type:"points",earned:1,total:1,message:null}}else if(e.type==="circle"&&t.correct.type==="circle"){if(R(e.center,t.correct.center)&&N(e.radius,t.correct.radius))return{type:"points",earned:1,total:1,message:null}}else if(e.type==="point"&&t.correct.type==="point"&&e.coords!=null){let r=t.correct.coords;if(r==null)throw new Error("Point graph rubric has null coords");const o=e.coords.slice();if(r=r.slice(),o==null||o.sort(),r.sort(),R(o,r))return{type:"points",earned:1,total:1,message:null}}else if(e.type==="polygon"&&t.correct.type==="polygon"&&e.coords!=null){const r=e.coords.slice(),o=t.correct.coords.slice();let s;if(t.correct.match==="similar"?s=k(r,o,Number.POSITIVE_INFINITY):t.correct.match==="congruent"?s=k(r,o,me):t.correct.match==="approx"?s=k(r,o,.1):(r.sort(),o.sort(),s=R(r,o)),s)return{type:"points",earned:1,total:1,message:null}}else if(e.type==="segment"&&t.correct.type==="segment"&&e.coords!=null){let r=q(e.coords),o=q(t.correct.coords);if(r=p.invoke(r,"sort").sort(),o=p.invoke(o,"sort").sort(),R(r,o))return{type:"points",earned:1,total:1,message:null}}else if(e.type==="ray"&&t.correct.type==="ray"&&e.coords!=null){const r=e.coords,o=t.correct.coords;if(R(r[0],o[0])&&y(o[0],o[1],r[1]))return{type:"points",earned:1,total:1,message:null}}else if(e.type==="angle"&&t.correct.type==="angle"){const r=e.coords,o=t.correct.coords,s=t.correct.allowReflexAngles;if(!r)return{type:"invalid",message:null};const l=en([r[0],r[2],r[1]])&&!s?r.slice().reverse():r;let c;if(t.correct.match==="congruent"){const u=p.map([l,o],function(f){return f?tn(f,s):!1});c=N(...u)}else c=R(l[1],o[1])&&y(o[1],o[0],l[0])&&y(o[1],o[2],l[2]);if(c)return{type:"points",earned:1,total:1,message:null}}}return!n||p.isEqual(e,t.graph)?{type:"invalid",message:null}:{type:"points",earned:0,total:1,message:null}}function rn(e,t){const n={hasAnswers:!1,isCorrect:!1};return e&&e.length>0&&(n.hasAnswers=!0),t.length>0?e&&e.length===t.length&&(n.isCorrect=e.every(r=>t.includes(r))):(!e||e.length===0)&&(n.isCorrect=!0),n}function on(e,t){let n=0;for(let r=0;r<e.markers.length;r++)rn(e.markers[r].selected,t.markers[r].answers).isCorrect&&n++;return{type:"points",earned:n===e.markers.length?1:0,total:1,message:null}}function sn(e,t){return{type:"points",earned:p.isEqual(e.left,t.left)&&p.isEqual(e.right,t.right)?1:0,total:1,message:null}}function an(e,t){const n=t.answers,r=e.answers,o=b(n),s=b(r),i=o[0]!==s[0]||o[1]!==s[1],a=E.number.createValidatorFunctional;let l=null,c=!1;return p(s[0]).times(u=>{p(s[1]).times(f=>{if(!i){const h=a(n[u][f],{simplify:!0})(r[u][f]);h.message&&(l=h.message),h.correct||(c=!0)}})}),i?{type:"points",earned:0,total:1,message:null}:{type:"points",earned:c?0:1,total:1,message:l}}function cn(e){const t=e.answers,n=b(t);for(let r=0;r<n[0];r++)for(let o=0;o<n[1];o++)if(t[r][o]==null||t[r][o].toString().length===0)return{type:"invalid",message:v.FILL_ALL_CELLS_ERROR};return null}function ln(e,t){const n=t.range,r=t.initialX!=null?t.initialX:n[0],o=t.isInequality?"ge":"eq",s=t.correctRel||"eq";return _(e.numLinePosition,t.correctX||0)&&s===e.rel?{type:"points",earned:1,total:1,message:null}:e.numLinePosition===r&&e.rel===o?{type:"invalid",message:null}:{type:"points",earned:0,total:1,message:null}}function un(e){const t=e.divisionRange,n=e.numDivisions>t[1]||e.numDivisions<t[0];return e.isTickCrtl&&n?{type:"invalid",message:"Number of divisions is outside the allowed range."}:null}function fn(e,t){let n=0;for(let r=t,o=e.length;r<o;r++){const s=e[r];if(s==="{"?n++:s==="}"&&n--,n<0)return r}return e.length}function le(e,t,n){const r=e.indexOf("{",t);if(r===-1)return{endpoint:e.length,expression:""};const o=r+1,s=fn(e,o),i=e.substring(o,s),a=ve(i,n);return{endpoint:s,expression:a}}function ue(e,t){const n="\\dfrac",o=e.indexOf("\\frac",t),s=e.indexOf(n,t);return o>-1&&s>-1?Math.min(o,s):o>-1?o:s>-1?s:-1}function ve(e,t){if(!e)return"";let n="",r=0,o=ue(e,r);for(;o>-1;){n+=e.substring(r,o),r=o;const s=le(e,r,t);r=s.endpoint+1;const i=le(e,r,t);r=i.endpoint+1,n.length&&(n+=" "),n+=t(s.expression,i.expression),o=ue(e,r)}return n+=e.slice(r),n}function Ee(e){return ve(e,function(r,o){return r+"/"+o}).replace("\\%","%")}const pn=[{title:"Integers",value:"integer",content:"6"},{title:"Decimals",value:"decimal",content:"0.75"},{title:"Proper fractions",value:"proper",content:"⅗"},{title:"Improper fractions",value:"improper",content:"⁷⁄₄"},{title:"Mixed numbers",value:"mixed",content:"1¾"},{title:"Numbers with π",value:"pi",content:"π"}];function dn(e,t){if(!(typeof e=="string"&&e.endsWith("%")))return e;const n=parseFloat(e.slice(0,-1));return isNaN(n)?e:t?n/100:n}function mn(e,t){const n=pn.map(c=>c.value).filter(c=>c!=="pi"),r=c=>{const u=`${c.value}`,f=[...c.answerForms??[]];return(!c.strict||f.length===0)&&f.push(...n),E.number.createValidatorFunctional(u,{message:c.message,simplify:c.status==="correct"?c.simplify:"optional",inexact:!0,maxError:c.maxError,forms:f})},o=Ee(e.currentValue),s=t.answers.filter(c=>c.status==="correct").every(c=>c.value!=null&&Math.abs(c.value)<=1);let i=o;t.coefficient&&(i?i==="-"&&(i=-1):i=1);const a=t.answers.map(c=>{const f=r(c)(dn(i,s));return{...c,score:f}}).find(c=>c.score.correct||c.status==="correct"&&c.score.empty),l=(a==null?void 0:a.status)==="correct"?a.score:{empty:(a==null?void 0:a.status)==="ungraded",correct:(a==null?void 0:a.status)==="correct",message:(a==null?void 0:a.message)??null};return l.empty?{type:"invalid",message:l.message}:{type:"points",earned:l.correct?1:0,total:1,message:l.message}}function gn(e,t){return{type:"points",earned:p.isEqual(e.current,t.correctOptions.map(r=>r.content))?1:0,total:1,message:null}}function hn(e){return e.current.length===0?{type:"invalid",message:null}:null}function yn(e,t){return{type:"points",earned:R(e,t.correct)?1:0,total:1,message:null}}function Rn(e,t){return R(e,t.starting)?{type:"invalid",message:null}:null}function vn(e,t){const n=e.choicesSelected.reduce((i,a)=>i+(a?1:0),0),r=t.choices.reduce((i,a)=>a.correct?i+1:i,0);return r>1&&n!==r?{type:"invalid",message:v.CHOOSE_CORRECT_NUM_ERROR}:t.choices.some((i,a)=>i.isNoneOfTheAbove&&e.choicesSelected[a])&&n>1?{type:"invalid",message:v.NOT_NONE_ABOVE_ERROR}:{type:"points",earned:e.choicesSelected.every((i,a)=>{let l;return t.choices[a].isNoneOfTheAbove?l=t.choices.every((c,u)=>a===u||!c.correct):l=!!t.choices[a].correct,l===i})?1:0,total:1,message:null}}function En(e){return e.choicesSelected.includes(!0)?null:{type:"invalid",message:null}}function Mn(e,t){return{type:"points",earned:R(e.options,t.correct)?1:0,total:1,message:null}}function wn(e){return e.changed?null:{type:"invalid",message:null}}const U=function(e){return e.filter(function(t){return t.some(n=>n)})};function Me(e){const t=U(e);return t.some(function(r){return r.some(function(o){return o===""})})||!t.length?{type:"invalid",message:null}:null}function On(e,t){const n=Me(e);if(n!=null)return n;const r=U(e),o=U(t.answers);if(r.length!==o.length)return{type:"points",earned:0,total:1,message:null};const s=E.number.createValidatorFunctional;let i=null;return{type:"points",earned:o.every(function(l){for(let c=0;c<r.length;c++)if(r[c].every(function(m,h){const F=l[h],V=s(F,{simplify:!0})(m);return V.message&&(i=V.message),V.correct}))return r.splice(c,1),!0;return!1})?1:0,total:1,message:i}}const Sn={number:{name:"Numbers",forms:"integer, decimal, proper, improper, mixed"},decimal:{name:"Decimals",forms:"decimal"},integer:{name:"Integers",forms:"integer"},rational:{name:"Fractions and mixed numbers",forms:"integer, proper, improper, mixed"},improper:{name:"Improper numbers (no mixed)",forms:"integer, proper, improper"},mixed:{name:"Mixed numbers (no improper)",forms:"integer, proper, mixed"},percent:{name:"Numbers or percents",forms:"integer, decimal, proper, improper, mixed, percent"},pi:{name:"Numbers with pi",forms:"pi"}};function Cn(e,t){t.answerType==null&&(t.answerType="number");const n=`${t.value}`,r=E.number.createValidatorFunctional(n,{simplify:t.simplify,inexact:t.inexact||void 0,maxError:t.maxError,forms:Sn[t.answerType].forms}),o=Ee(e.currentValue),s=r(o);return s.empty?{type:"invalid",message:s.message}:{type:"points",earned:s.correct?1:0,total:1,message:s.message}}function M(e=0){return{type:"points",earned:e,total:e,message:null}}function _n(e,t,n){const r=Se(t.widgets,Object.keys(t.widgets),e,n);return Oe(r)}function Tn(e,t,n,r){return t.filter(o=>{const s=e[o];if(!s||s.static===!0)return!1;const i=we(s.type),a=n[o],l=s.options,c=i==null?void 0:i(a,l,r);if(c)return In(c)})}function Nn(e,t,n){return Tn(t.widgets,Object.keys(t.widgets),e,n).length===0?null:{type:"invalid",message:null}}function Fn(e){let t=0;for(let n=0;n<e.markers.length;n++){const r=e.markers[n].selected;r&&r.length>0&&t++}return t!==e.markers.length?{type:"invalid",message:null}:null}function xn(e){return e.currentValue==null||e.currentValue===""?{type:"invalid",message:""}:null}function fe(e,t){const n=xn(e);return n??{type:"points",earned:e.currentValue===t.value?1:0,total:1,message:""}}const J={};function d(e,t,n){J[e]={scorer:t,validator:n}}const we=e=>{var t;return((t=J[e])==null?void 0:t.validator)??null},Pn=e=>{var t;return((t=J[e])==null?void 0:t.scorer)??null};d("categorizer",Ut,Xt);d("cs-program",Ht);d("dropdown",Yt,Qt);d("expression",Bt,Jt);d("grapher",Kt);d("group",_n,Nn);d("iframe",Zt);d("input-number",Cn);d("interactive-graph",nn);d("label-image",on,Fn);d("matcher",sn);d("matrix",an,cn);d("mock-widget",fe,fe);d("number-line",ln,un);d("numeric-input",mn);d("orderer",gn,hn);d("plotter",yn,Rn);d("radio",vn,En);d("sorter",Mn,wn);d("table",On,Me);d("deprecated-standin",()=>M(1));d("measurer",()=>M(1));d("definition",M);d("explanation",M);d("image",M);d("interaction",M);d("molecule",M);d("passage",M);d("passage-ref",M);d("passage-ref-target",M);d("video",M);const Ln={type:"points",earned:0,total:0,message:null};function In(e){return e.type==="invalid"&&(!e.message||e.message.length===0)}function An(e,t){let n;if(e.type==="points"&&t.type==="points")return e.message&&t.message&&e.message!==t.message?n=null:n=e.message||t.message,{type:"points",earned:e.earned+t.earned,total:e.total+t.total,message:n};if(e.type==="points"&&t.type==="invalid")return t;if(e.type==="invalid"&&t.type==="points")return e;if(e.type==="invalid"&&t.type==="invalid")return e.message&&t.message&&e.message!==t.message?n=null:n=e.message||t.message,{type:"invalid",message:n};throw new S("PerseusScore with unknown type encountered",C.InvalidInput,{metadata:{scoreA:JSON.stringify(e),scoreB:JSON.stringify(t)}})}function Oe(e){return Object.values(e).reduce(An,Ln)}function _r(e,t,n){const r=be(e.content),o=Se(e.widgets,r,t,n);return Oe(o)}function Se(e,t,n,r){const o=je(e),s=t.filter(a=>{const l=o[a],c=(l==null?void 0:l.graded)==null||l.graded,u=!!(l!=null&&l.static);return c&&!u}),i={};return s.forEach(a=>{const l=o[a];if(!l)return;const c=n[a],u=we(l.type),f=Pn(l.type),m=(u==null?void 0:u(c,l.options,r))??(f==null?void 0:f(c,l.options,r));m!=null&&(i[a]=m)}),i}const Ce=/^web\+graphie:/,_e=/^file\+graphie:/;function K(e){return Te(e)?Ne(e):e}function Te(e){return Ce.test(e)||_e.test(e)}function Z(e){return e.replace(Ce,"https:").replace(_e,"file:")}function Ne(e){return Z(e)+".svg"}function Dn(e){return Z(e)+"-data.json"}async function Vn(e){const t=new Image;return new Promise((n,r)=>{t.onload=()=>{n([t.naturalWidth,t.naturalHeight])},t.onerror=r,t.src=K(e)})}let pe=!1;const Fe=function(e,t,n){return Array.isArray(e)?p.map(e,function(r){return Fe(r,t)}):t.call(n,e)};function $n(e,t){return e==null||t==null?e==null==(t==null):e.length===t.length&&e.every((n,r)=>t[r]===n)}const xe=/^\[\[\u2603 (([a-z-]+) ([0-9]+))\]\]/,kn=/^([a-z-]+) ([0-9]+)$/,zn=new RegExp(xe.source+"$"),bn="☃",qn="x".split(/(.)/g).length?function(e,t){return e.split(t)}:function(e,t){const n=[];let r=t.lastIndex=0,o;for(;o=t.exec(e);){const s=o;n.push(e.slice(r,s.index)),n.push(...s.slice(1)),r=s.index+s[0].length}return n.push(e.slice(r)),n};function Wn(e){let t;return E.predicate.createValidatorFunctional(function(r){return t=r,!0},{simplify:"optional",inexact:!0,forms:"integer, proper, improper, pi, log, mixed, decimal"})(e),t}function X(e){return Array(e).fill("")}function Gn(e){const{rows:t,columns:n}=e;return X(t).map(()=>X(n))}function jn(e,t,n,r){const o=ee(t,n),i=e*o>30;return{scale:o,tickStep:e/r,unityLabel:i}}function Un(e,t,n){return p(2).times(function(r){const o=ee(e[r],n);return Pe(t[r],o)})}function Xn(e){return[e[0]/2,e[1]/2]}function Pe(e,t){const n=e*t,r=e,o=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),s=Math.floor(r/o);if(n<25)return e;if(n<50)return s===5?e:e/2;if(s===1)return e/2;if(s===2)return e/4;if(s===5)return e/5}function ee(e,t){const n=e[1]-e[0];return t/n}function Hn(e,t){const n=e[1]-e[0];let r;15<n&&n<=20?r=23:n>100||n<5?r=10:r=16;const o=t/500,s=r*o;return te(n,s)}function te(e,t){let n=Math.pow(10,Math.floor(Math.log(e/t)/Math.LN10));const r=t/e*n;return r<=.15?n*=10:r<=.35?n*=5:r<=.75&&(n*=2),n}const de=(e,t)=>{const n=t[1]-t[0],r=n/e;return r<=10?e:r<=20?e*2:te(n,10)};function Yn(e,t){return[de(e[0],t[0]),de(e[1],t[1])]}function Qn(e){e=e||window.location.search.substring(1);const t={},n=/\+/g,r=/([^&=]+)=?([^&]*)/g,o=function(i){return decodeURIComponent(i.replace(n," "))};let s;for(;s=r.exec(e);){const i=s;t[o(i[1])]=o(i[2])}return t}function Bn(e,t,n){n=encodeURIComponent(n);const r=new RegExp("([?&])"+t+"=.*?(&|$)","i"),o=e.indexOf("?")!==-1?"&":"?";return e.match(r)?e.replace(r,"$1"+t+"="+n+"$2"):e+o+t+"="+n}function Jn(e){return encodeURIComponent(e).replace(/['()!]/g,window.escape).replace(/\*/g,"%2A")}const O={pointerDown:!1,currentTouchIdentifier:null};function Kn(){Object.assign(O,{pointerDown:!1,currentTouchIdentifier:null})}function Zn(e){let t;if(O.pointerDown){if(O.currentTouchIdentifier!=null){const r=e.changedTouches?e.changedTouches.length:0;for(let o=0;o<r;o++)e.changedTouches[o].identifier===O.currentTouchIdentifier&&(t=e.changedTouches[o])}else t=e;const n=e.type==="touchend"||e.type==="touchcancel";t&&n&&(O.pointerDown=!1,O.currentTouchIdentifier=null)}else O.pointerDown=!0,e.changedTouches?(t=e.changedTouches[0],O.currentTouchIdentifier=t.identifier):t=e;if(t)return{left:t.pageX,top:t.pageY}}const er=()=>{try{const e=Object.defineProperty({},"passive",{get:function(){pe=!0}});window.addEventListener("testPassive",null,e),window.removeEventListener("testPassive",null,e)}catch{}return pe};function tr(e){e.stopPropagation()}function nr(e,t){const n=new Image;n.onload=function(){var r;n.width===0&&n.height===0?((r=document.body)==null||r.appendChild(n),p.defer(function(){var o;t(n.clientWidth,n.clientHeight),(o=document.body)==null||o.removeChild(n)})):t(n.width,n.height)},n.src=K(e)}function rr(e){const t=e.value,n=e.selectionStart-1,r=Math.max(t.lastIndexOf(`
`,n),t.lastIndexOf(" ",n))+1;return{string:t.substring(r,n+1),pos:{start:r,end:n}}}function or(e,t){e.selectionStart=t,e.selectionEnd=t}const sr={getWordBeforeCursor:rr,moveCursor:or},ir=e=>e.startsWith("$")&&e.endsWith("$")?e.slice(1,-1):e,Tr={inputPathsEqual:$n,nestedMap:Fe,rWidgetRule:xe,rTypeFromWidgetId:kn,rWidgetParts:zn,snowman:bn,split:qn,firstNumericalParse:Wn,stringArrayOfSize:X,stringArrayOfSize2D:Gn,gridDimensionConfig:jn,getGridStep:Un,snapStepFromGridStep:Xn,scaleFromExtent:ee,tickStepFromExtent:Hn,gridStepFromTickStep:Pe,tickStepFromNumTicks:te,constrainedTickStepsFromTickSteps:Yn,parseQueryString:Qn,updateQueryString:Bn,strongEncodeURIComponent:Jn,touchHandlers:O,resetTouchHandlers:Kn,extractPointerLocation:Zn,supportsPassiveEvents:er,captureScratchpadTouchStart:tr,getImageSize:nr,getImageSizeModern:Vn,getRealImageUrl:K,isLabeledSVG:Te,getBaseUrl:Z,getSvgUrl:Ne,getDataUrl:Dn,textarea:sr,unescapeMathMode:ir};export{Cr as A,Sr as B,Or as C,pr as D,qe as E,Tn as F,Se as G,Oe as H,vn as I,vr as J,g as K,Re as L,Lt as M,rn as N,Gn as O,re as P,dr as Q,Be as R,Tr as U,Qe as a,_ as b,Ft as c,P as d,tt as e,b as f,je as g,Er as h,Sn as i,Y as j,Q as k,H as l,Rr as m,st as n,gr as o,rt as p,Mr as q,mr as r,_r as s,Ot as t,Ge as u,ut as v,yr as w,hr as x,wr as y,A as z};
