import{r as e}from"./index-C6mWTJJr.js";import{n as w}from"./no-important-DlFk8a1I.js";import{I as v,x as I}from"./index-CfqIx-dS.js";import{B as R}from"./index-CYrfVekP.js";import{V as o}from"./index-CskvhqFA.js";import{P}from"./index-CIHqsnLr.js";import{L as _}from"./index-BRgWRRgj.js";import{a as c,s as a,f as B}from"./index-C9RM_t1w.js";import{b as W}from"./index-CbNKSLRm.js";import{a as U}from"./i18n-context-glBZFVwC.js";import{g as D}from"./dependencies-BsVPGK1s.js";import{l as j}from"./constants-BIpV3g0K.js";const z=(l,t="")=>({type:l,isSupported:!1,message:t}),F=""+new URL("info-C9QkPWf7.svg",import.meta.url).href,N=""+new URL("smiley-DF1jp_kf.svg",import.meta.url).href,O=""+new URL("warning-By3DoRa6.svg",import.meta.url).href,A=""+new URL("warning-circle-6sErWO7z.svg",import.meta.url).href,T=l=>{switch(l){case"success":return{color:c.status.success.foreground,icon:N,role:"status"};case"warning":return{color:c.status.warning.foreground,icon:O,role:"alert",ariaLive:"polite"};case"critical":return{color:c.status.critical.foreground,icon:A,role:"alert"};default:return{color:c.status.notice.foreground,icon:F,role:"status"}}},J=l=>{const{actions:t,"aria-label":r,dismissAriaLabel:s="Dismiss banner.",onDismiss:m,kind:u="info",layout:d,text:g,testId:h,icon:y}=l,L=()=>t==null?void 0:t.filter(Boolean).map((i,E)=>{if(i.type==="custom")return e.createElement(o,{style:n.action,key:`custom-action-${E}`},i.node);const x=i.onClick;if(i.type==="link"){var k;return e.createElement(o,{style:n.action,key:i.title},e.createElement(_,{href:i.href,onClick:x,"aria-label":(k=i.ariaLabel)!=null?k:i.title,style:n.link},i.title))}else{var C;return e.createElement(o,{style:n.action,key:i.title},e.createElement(R,{kind:"tertiary",size:"small","aria-label":(C=i.ariaLabel)!=null?C:i.title,onClick:x},i.title))}}),p=T(u);return e.createElement(o,{style:[n.containerOuter,d==="floating"&&n.floatingBorder,{borderInlineStartColor:p.color}],role:p.role,"aria-label":r,"aria-live":p.ariaLive,testId:h},e.createElement(o,{style:[n.backgroundColor,{backgroundColor:p.color}]}),e.createElement(o,{style:n.containerInner},e.createElement(P,{icon:y||p.icon,size:"medium",style:n.icon,"aria-label":u,testId:"banner-kind-icon",role:"img"}),e.createElement(o,{style:n.labelAndButtonsContainer},e.createElement(o,{style:n.labelContainer},e.createElement(W,null,g)),t&&e.createElement(o,{style:n.actionsContainer},L())),m?e.createElement(o,{style:n.dismissContainer},e.createElement(v,{icon:I,kind:"tertiary",onClick:m,style:n.dismiss,"aria-label":s})):null))},n=w.StyleSheet.create({backgroundColor:{position:"absolute",top:0,bottom:0,left:0,right:0,opacity:.08},containerOuter:{borderInlineStartWidth:a.xxSmall_6,width:"100%",backgroundColor:c.surface.primary},containerInner:{flexDirection:"row",padding:a.xSmall_8},icon:{marginTop:a.xSmall_8,marginBottom:a.xSmall_8,marginInlineStart:a.xxxxSmall_2,marginInlineEnd:a.xSmall_8,alignSelf:"flex-start",color:c.icon.primary},labelAndButtonsContainer:{flex:1,flexDirection:"row",alignItems:"center",alignContent:"center",flexWrap:"wrap",justifyContent:"space-between"},labelContainer:{flexShrink:1,margin:a.xSmall_8,textAlign:"start",overflowWrap:"break-word"},actionsContainer:{flexDirection:"row",justifyContent:"flex-start",marginTop:a.xSmall_8,marginBottom:a.xSmall_8,height:18,alignItems:"center"},action:{marginLeft:a.xSmall_8,marginRight:a.xSmall_8,justifyContent:"center"},link:{fontSize:B.size.small},dismiss:{flexShrink:1},dismissContainer:{height:40,width:40,justifyContent:"center",alignItems:"center",marginLeft:a.xSmall_8,marginRight:a.xSmall_8},floatingBorder:{borderRadius:4,overflow:"hidden"}}),q=""+new URL("corners-out-Blw9vUtj.svg",import.meta.url).href,V=()=>z("phet-simulation"),S=class S extends e.Component{constructor(t){super(t),this.iframeRef=e.createRef(),this.isWidget=!0,this.state={url:null,banner:null},this.getPhetCompatibleLocale=r=>{switch(r){case"pt-pt":return"pt";case"zh-hans":return"zh_CN";case"zh-hant":return"zh_TW";case"fa-af":return"fa_DA";default:return r}},this.displayLoadFailure=()=>{this.setState({url:null,banner:{message:this.context.strings.simulationLoadFail,kind:"critical"}})},this.locale=this.getPhetCompatibleLocale(D().kaLocale)}async componentDidMount(){await this.updateSimState(this.props.url)}async componentDidUpdate(t){t.url!==this.props.url&&await this.updateSimState(this.props.url)}getPromptJSON(){return V()}async updateSimState(t){const r=K(t,this.locale);if(r===null){this.displayLoadFailure();return}if(!(await fetch(r)).ok){this.displayLoadFailure();return}const m=await this.showLocaleWarning(r);this.setState({url:r,banner:m?{message:this.context.strings.simulationLocaleWarning,kind:"warning"}:null})}async showLocaleWarning(t){if(!t)return!1;const s=/https:\/\/phet\.colorado\.edu\/sims\/html\/([a-zA-Z0-9-]+)\/.*/g.exec(t.toString());if(s===null)return!1;const m=s[1],u=await fetch(`https://phet.colorado.edu/sims/html/${m}/latest/string-map.json`);if(!u.ok)return!1;let d;try{d=await u.json()}catch{return!1}const g=Object.keys(d),h=this.locale.split("_")[0];for(const y of g)if(h===y.split("_")[0])return!1;return!0}render(){var r;return e.createElement(o,{style:b.widgetContainer},this.state.banner!==null&&e.createElement(o,{style:{marginBottom:j}},e.createElement(J,{layout:"floating",kind:this.state.banner.kind,text:this.state.banner.message})),e.createElement(o,{style:b.iframeContainer},e.createElement("iframe",{ref:this.iframeRef,title:this.props.description,sandbox:"allow-same-origin allow-scripts",className:w.css(b.iframeResponsive),src:(r=this.state.url)==null?void 0:r.toString(),allow:"fullscreen"})),this.state.url!==null&&e.createElement(v,{icon:q,onClick:()=>{var s;(s=this.iframeRef.current)==null||s.requestFullscreen()},kind:"secondary","aria-label":"Fullscreen",style:{marginTop:5,marginBottom:5,alignSelf:"flex-end"}}))}};S.contextType=U;let f=S;const K=(l,t)=>{if(!URL.canParse(l))return null;const r=new URL(l);return r.origin!=="https://phet.colorado.edu"?null:(r.searchParams.set("locale",t),r)},b=w.StyleSheet.create({widgetContainer:{borderRadius:6,borderWidth:1,borderColor:"#CCC",padding:a.medium_16,paddingBottom:0},iframeContainer:{position:"relative",overflow:"hidden",width:"100%",paddingTop:"56.25%"},iframeResponsive:{borderWidth:0,position:"absolute",top:0,left:0,bottom:0,right:0,width:"100%",height:"100%"}}),ae={name:"phet-simulation",displayName:"PhET Simulation",widget:f,isLintable:!0};f.__docgenInfo={description:"",methods:[{name:"getPhetCompatibleLocale",docblock:null,modifiers:[],params:[{name:"kaLocale",optional:!1,type:null}],returns:null},{name:"getPromptJSON",docblock:null,modifiers:[],params:[],returns:{type:{name:"signature",type:"object",raw:`{
    type: UnsupportedWidget;
    message?: string;
    isSupported: boolean;
}`,signature:{properties:[{key:"type",value:{name:"union",raw:`| "cs-program"
| "iframe"
| "interaction"
| "interactive-graph-unsupported"
| "measurer"
| "phet-simulation"
| "plotter"
| "python-program"
| "video"`,elements:[{name:"literal",value:'"cs-program"'},{name:"literal",value:'"iframe"'},{name:"literal",value:'"interaction"'},{name:"literal",value:'"interactive-graph-unsupported"'},{name:"literal",value:'"measurer"'},{name:"literal",value:'"phet-simulation"'},{name:"literal",value:'"plotter"'},{name:"literal",value:'"python-program"'},{name:"literal",value:'"video"'}],required:!0}},{key:"message",value:{name:"string",required:!1}},{key:"isSupported",value:{name:"boolean",required:!0}}]}}}},{name:"displayLoadFailure",docblock:null,modifiers:[],params:[],returns:null},{name:"updateSimState",docblock:null,modifiers:["async"],params:[{name:"urlString",optional:!1,type:{name:"string"}}],returns:null},{name:"showLocaleWarning",docblock:null,modifiers:["async"],params:[{name:"url",optional:!1,type:{name:"URL",alias:"URL"}}],returns:{type:{name:"Promise",elements:[{name:"boolean"}],raw:"Promise<boolean>"}}}],displayName:"PhetSimulation"};export{J as B,f as P,ae as a,z as g,K as m};
