var xt=Object.defineProperty;var It=(u,s,t)=>s in u?xt(u,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):u[s]=t;var ne=(u,s,t)=>(It(u,typeof s!="symbol"?s+"":s,t),t);import{a as at}from"./version-akiLXZts.js";import{$ as de,_ as re}from"./jquery-yG1GhClm.js";import{c as ut,g as ct}from"./_commonjsHelpers-4gQjN7DL.js";const qe=Object.freeze({Unknown:"Unknown",Internal:"Internal",InvalidInput:"InvalidInput",NotAllowed:"NotAllowed",TransientService:"TransientService",Service:"Service"});class Ve extends Error{constructor(s,t,a){super(s),this.kind=t,this.metadata=a==null?void 0:a.metadata}}const Et="@khanacademy/kas",Mt="__lib_version__";at(Et,Mt);var ze={exports:{}};(function(u,s){(function(){var t=this,a=t._,c={},o=Array.prototype,f=Object.prototype,p=Function.prototype,g=o.push,m=o.slice,d=o.concat,y=f.toString,E=f.hasOwnProperty,M=o.forEach,k=o.map,w=o.reduce,q=o.reduceRight,A=o.filter,U=o.every,Y=o.some,ie=o.indexOf,he=o.lastIndexOf,K=Array.isArray,j=Object.keys,se=p.bind,r=function(e){if(e instanceof r)return e;if(!(this instanceof r))return new r(e);this._wrapped=e};u.exports&&(s=u.exports=r),s._=r,r.VERSION="1.4.4";var z=r.each=r.forEach=function(e,n,i){if(e!=null){if(M&&e.forEach===M)e.forEach(n,i);else if(e.length===+e.length){for(var l=0,h=e.length;l<h;l++)if(n.call(i,e[l],l,e)===c)return}else for(var I in e)if(r.has(e,I)&&n.call(i,e[I],I,e)===c)return}};r.map=r.collect=function(e,n,i){var l=[];return e==null?l:k&&e.map===k?e.map(n,i):(z(e,function(h,I,x){l[l.length]=n.call(i,h,I,x)}),l)};var me="Reduce of empty array with no initial value";r.reduce=r.foldl=r.inject=function(e,n,i,l){var h=arguments.length>2;if(e==null&&(e=[]),w&&e.reduce===w)return l&&(n=r.bind(n,l)),h?e.reduce(n,i):e.reduce(n);if(z(e,function(I,x,P){h?i=n.call(l,i,I,x,P):(i=I,h=!0)}),!h)throw new TypeError(me);return i},r.reduceRight=r.foldr=function(e,n,i,l){var h=arguments.length>2;if(e==null&&(e=[]),q&&e.reduceRight===q)return l&&(n=r.bind(n,l)),h?e.reduceRight(n,i):e.reduceRight(n);var I=e.length;if(I!==+I){var x=r.keys(e);I=x.length}if(z(e,function(P,D,W){D=x?x[--I]:--I,h?i=n.call(l,i,e[D],D,W):(i=e[D],h=!0)}),!h)throw new TypeError(me);return i},r.find=r.detect=function(e,n,i){var l;return X(e,function(h,I,x){if(n.call(i,h,I,x))return l=h,!0}),l},r.filter=r.select=function(e,n,i){var l=[];return e==null?l:A&&e.filter===A?e.filter(n,i):(z(e,function(h,I,x){n.call(i,h,I,x)&&(l[l.length]=h)}),l)},r.reject=function(e,n,i){return r.filter(e,function(l,h,I){return!n.call(i,l,h,I)},i)},r.every=r.all=function(e,n,i){n||(n=r.identity);var l=!0;return e==null?l:U&&e.every===U?e.every(n,i):(z(e,function(h,I,x){if(!(l=l&&n.call(i,h,I,x)))return c}),!!l)};var X=r.some=r.any=function(e,n,i){n||(n=r.identity);var l=!1;return e==null?l:Y&&e.some===Y?e.some(n,i):(z(e,function(h,I,x){if(l||(l=n.call(i,h,I,x)))return c}),!!l)};r.contains=r.include=function(e,n){return e==null?!1:ie&&e.indexOf===ie?e.indexOf(n)!=-1:X(e,function(i){return i===n})},r.invoke=function(e,n){var i=m.call(arguments,2),l=r.isFunction(n);return r.map(e,function(h){return(l?n:h[n]).apply(h,i)})},r.pluck=function(e,n){return r.map(e,function(i){return i[n]})},r.where=function(e,n,i){return r.isEmpty(n)?i?null:[]:r[i?"find":"filter"](e,function(l){for(var h in n)if(n[h]!==l[h])return!1;return!0})},r.findWhere=function(e,n){return r.where(e,n,!0)},r.max=function(e,n,i){if(!n&&r.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!n&&r.isEmpty(e))return-1/0;var l={computed:-1/0,value:-1/0};return z(e,function(h,I,x){var P=n?n.call(i,h,I,x):h;P>=l.computed&&(l={value:h,computed:P})}),l.value},r.min=function(e,n,i){if(!n&&r.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!n&&r.isEmpty(e))return 1/0;var l={computed:1/0,value:1/0};return z(e,function(h,I,x){var P=n?n.call(i,h,I,x):h;P<l.computed&&(l={value:h,computed:P})}),l.value},r.shuffle=function(e){var n,i=0,l=[];return z(e,function(h){n=r.random(i++),l[i-1]=l[n],l[n]=h}),l};var Q=function(e){return r.isFunction(e)?e:function(n){return n[e]}};r.sortBy=function(e,n,i){var l=Q(n);return r.pluck(r.map(e,function(h,I,x){return{value:h,index:I,criteria:l.call(i,h,I,x)}}).sort(function(h,I){var x=h.criteria,P=I.criteria;if(x!==P){if(x>P||x===void 0)return 1;if(x<P||P===void 0)return-1}return h.index<I.index?-1:1}),"value")};var F=function(e,n,i,l){var h={},I=Q(n||r.identity);return z(e,function(x,P){var D=I.call(i,x,P,e);l(h,D,x)}),h};r.groupBy=function(e,n,i){return F(e,n,i,function(l,h,I){(r.has(l,h)?l[h]:l[h]=[]).push(I)})},r.countBy=function(e,n,i){return F(e,n,i,function(l,h){r.has(l,h)||(l[h]=0),l[h]++})},r.sortedIndex=function(e,n,i,l){i=i==null?r.identity:Q(i);for(var h=i.call(l,n),I=0,x=e.length;I<x;){var P=I+x>>>1;i.call(l,e[P])<h?I=P+1:x=P}return I},r.toArray=function(e){return e?r.isArray(e)?m.call(e):e.length===+e.length?r.map(e,r.identity):r.values(e):[]},r.size=function(e){return e==null?0:e.length===+e.length?e.length:r.keys(e).length},r.first=r.head=r.take=function(e,n,i){if(e!=null)return n!=null&&!i?m.call(e,0,n):e[0]},r.initial=function(e,n,i){return m.call(e,0,e.length-(n==null||i?1:n))},r.last=function(e,n,i){if(e!=null)return n!=null&&!i?m.call(e,Math.max(e.length-n,0)):e[e.length-1]},r.rest=r.tail=r.drop=function(e,n,i){return m.call(e,n==null||i?1:n)},r.compact=function(e){return r.filter(e,r.identity)};var G=function(e,n,i){return z(e,function(l){r.isArray(l)?n?g.apply(i,l):G(l,n,i):i.push(l)}),i};r.flatten=function(e,n){return G(e,n,[])},r.without=function(e){return r.difference(e,m.call(arguments,1))},r.uniq=r.unique=function(e,n,i,l){r.isFunction(n)&&(l=i,i=n,n=!1);var h=i?r.map(e,i,l):e,I=[],x=[];return z(h,function(P,D){(n?!D||x[x.length-1]!==P:!r.contains(x,P))&&(x.push(P),I.push(e[D]))}),I},r.union=function(){return r.uniq(d.apply(o,arguments))},r.intersection=function(e){var n=m.call(arguments,1);return r.filter(r.uniq(e),function(i){return r.every(n,function(l){return r.indexOf(l,i)>=0})})},r.difference=function(e){var n=d.apply(o,m.call(arguments,1));return r.filter(e,function(i){return!r.contains(n,i)})},r.zip=function(){for(var e=m.call(arguments),n=r.max(r.pluck(e,"length")),i=new Array(n),l=0;l<n;l++)i[l]=r.pluck(e,""+l);return i},r.object=function(e,n){if(e==null)return{};for(var i={},l=0,h=e.length;l<h;l++)n?i[e[l]]=n[l]:i[e[l][0]]=e[l][1];return i},r.indexOf=function(e,n,i){if(e==null)return-1;var l=0,h=e.length;if(i)if(typeof i=="number")l=i<0?Math.max(0,h+i):i;else return l=r.sortedIndex(e,n),e[l]===n?l:-1;if(ie&&e.indexOf===ie)return e.indexOf(n,i);for(;l<h;l++)if(e[l]===n)return l;return-1},r.lastIndexOf=function(e,n,i){if(e==null)return-1;var l=i!=null;if(he&&e.lastIndexOf===he)return l?e.lastIndexOf(n,i):e.lastIndexOf(n);for(var h=l?i:e.length;h--;)if(e[h]===n)return h;return-1},r.range=function(e,n,i){arguments.length<=1&&(n=e||0,e=0),i=arguments[2]||1;for(var l=Math.max(Math.ceil((n-e)/i),0),h=0,I=new Array(l);h<l;)I[h++]=e,e+=i;return I},r.bind=function(e,n){if(e.bind===se&&se)return se.apply(e,m.call(arguments,1));var i=m.call(arguments,2);return function(){return e.apply(n,i.concat(m.call(arguments)))}},r.partial=function(e){var n=m.call(arguments,1);return function(){return e.apply(this,n.concat(m.call(arguments)))}},r.bindAll=function(e){var n=m.call(arguments,1);return n.length===0&&(n=r.functions(e)),z(n,function(i){e[i]=r.bind(e[i],e)}),e},r.memoize=function(e,n){var i={};return n||(n=r.identity),function(){var l=n.apply(this,arguments);return r.has(i,l)?i[l]:i[l]=e.apply(this,arguments)}},r.delay=function(e,n){var i=m.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},n)},r.defer=function(e){return r.delay.apply(r,[e,1].concat(m.call(arguments,1)))},r.throttle=function(e,n){var i,l,h,I,x=0,P=function(){x=new Date,h=null,I=e.apply(i,l)};return function(){var D=new Date,W=n-(D-x);return i=this,l=arguments,W<=0?(clearTimeout(h),h=null,x=D,I=e.apply(i,l)):h||(h=setTimeout(P,W)),I}},r.debounce=function(e,n,i){var l,h;return function(){var I=this,x=arguments,P=function(){l=null,i||(h=e.apply(I,x))},D=i&&!l;return clearTimeout(l),l=setTimeout(P,n),D&&(h=e.apply(I,x)),h}},r.once=function(e){var n=!1,i;return function(){return n||(n=!0,i=e.apply(this,arguments),e=null),i}},r.wrap=function(e,n){return function(){var i=[e];return g.apply(i,arguments),n.apply(this,i)}},r.compose=function(){var e=arguments;return function(){for(var n=arguments,i=e.length-1;i>=0;i--)n=[e[i].apply(this,n)];return n[0]}},r.after=function(e,n){return e<=0?n():function(){if(--e<1)return n.apply(this,arguments)}},r.keys=j||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var n=[];for(var i in e)r.has(e,i)&&(n[n.length]=i);return n},r.values=function(e){var n=[];for(var i in e)r.has(e,i)&&n.push(e[i]);return n},r.pairs=function(e){var n=[];for(var i in e)r.has(e,i)&&n.push([i,e[i]]);return n},r.invert=function(e){var n={};for(var i in e)r.has(e,i)&&(n[e[i]]=i);return n},r.functions=r.methods=function(e){var n=[];for(var i in e)r.isFunction(e[i])&&n.push(i);return n.sort()},r.extend=function(e){return z(m.call(arguments,1),function(n){if(n)for(var i in n)e[i]=n[i]}),e},r.pick=function(e){var n={},i=d.apply(o,m.call(arguments,1));return z(i,function(l){l in e&&(n[l]=e[l])}),n},r.omit=function(e){var n={},i=d.apply(o,m.call(arguments,1));for(var l in e)r.contains(i,l)||(n[l]=e[l]);return n},r.defaults=function(e){return z(m.call(arguments,1),function(n){if(n)for(var i in n)e[i]==null&&(e[i]=n[i])}),e},r.clone=function(e){return r.isObject(e)?r.isArray(e)?e.slice():r.extend({},e):e},r.tap=function(e,n){return n(e),e};var S=function(e,n,i,l){if(e===n)return e!==0||1/e==1/n;if(e==null||n==null)return e===n;e instanceof r&&(e=e._wrapped),n instanceof r&&(n=n._wrapped);var h=y.call(e);if(h!=y.call(n))return!1;switch(h){case"[object String]":return e==String(n);case"[object Number]":return e!=+e?n!=+n:e==0?1/e==1/n:e==+n;case"[object Date]":case"[object Boolean]":return+e==+n;case"[object RegExp]":return e.source==n.source&&e.global==n.global&&e.multiline==n.multiline&&e.ignoreCase==n.ignoreCase}if(typeof e!="object"||typeof n!="object")return!1;for(var I=i.length;I--;)if(i[I]==e)return l[I]==n;i.push(e),l.push(n);var x=0,P=!0;if(h=="[object Array]"){if(x=e.length,P=x==n.length,P)for(;x--&&(P=S(e[x],n[x],i,l)););}else{var D=e.constructor,W=n.constructor;if(D!==W&&!(r.isFunction(D)&&D instanceof D&&r.isFunction(W)&&W instanceof W))return!1;for(var $ in e)if(r.has(e,$)&&(x++,!(P=r.has(n,$)&&S(e[$],n[$],i,l))))break;if(P){for($ in n)if(r.has(n,$)&&!x--)break;P=!x}}return i.pop(),l.pop(),P};r.isEqual=function(e,n){return S(e,n,[],[])},r.isEmpty=function(e){if(e==null)return!0;if(r.isArray(e)||r.isString(e))return e.length===0;for(var n in e)if(r.has(e,n))return!1;return!0},r.isElement=function(e){return!!(e&&e.nodeType===1)},r.isArray=K||function(e){return y.call(e)=="[object Array]"},r.isObject=function(e){return e===Object(e)},z(["Arguments","Function","String","Number","Date","RegExp"],function(e){r["is"+e]=function(n){return y.call(n)=="[object "+e+"]"}}),r.isArguments(arguments)||(r.isArguments=function(e){return!!(e&&r.has(e,"callee"))}),typeof/./!="function"&&(r.isFunction=function(e){return typeof e=="function"}),r.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},r.isNaN=function(e){return r.isNumber(e)&&e!=+e},r.isBoolean=function(e){return e===!0||e===!1||y.call(e)=="[object Boolean]"},r.isNull=function(e){return e===null},r.isUndefined=function(e){return e===void 0},r.has=function(e,n){return E.call(e,n)},r.noConflict=function(){return t._=a,this},r.identity=function(e){return e},r.times=function(e,n,i){for(var l=Array(e),h=0;h<e;h++)l[h]=n.call(i,h);return l},r.random=function(e,n){return n==null&&(n=e,e=0),e+Math.floor(Math.random()*(n-e+1))};var R={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};R.unescape=r.invert(R.escape);var L={escape:new RegExp("["+r.keys(R.escape).join("")+"]","g"),unescape:new RegExp("("+r.keys(R.unescape).join("|")+")","g")};r.each(["escape","unescape"],function(e){r[e]=function(n){return n==null?"":(""+n).replace(L[e],function(i){return R[e][i]})}}),r.result=function(e,n){if(e==null)return null;var i=e[n];return r.isFunction(i)?i.call(e):i},r.mixin=function(e){z(r.functions(e),function(n){var i=r[n]=e[n];r.prototype[n]=function(){var l=[this._wrapped];return g.apply(l,arguments),ye.call(this,i.apply(r,l))}})};var V=0;r.uniqueId=function(e){var n=++V+"";return e?e+n:n},r.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var ce=/(.)^/,C={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},pe=/\\|'|\r|\n|\t|\u2028|\u2029/g;r.template=function(e,n,i){var l;i=r.defaults({},i,r.templateSettings);var h=new RegExp([(i.escape||ce).source,(i.interpolate||ce).source,(i.evaluate||ce).source].join("|")+"|$","g"),I=0,x="__p+='";e.replace(h,function(D,W,$,we,ve){return x+=e.slice(I,ve).replace(pe,function(Ee){return"\\"+C[Ee]}),W&&(x+=`'+
((__t=(`+W+`))==null?'':_.escape(__t))+
'`),$&&(x+=`'+
((__t=(`+$+`))==null?'':__t)+
'`),we&&(x+=`';
`+we+`
__p+='`),I=ve+D.length,D}),x+=`';
`,i.variable||(x=`with(obj||{}){
`+x+`}
`),x=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+x+`return __p;
`;try{l=new Function(i.variable||"obj","_",x)}catch(D){throw D.source=x,D}if(n)return l(n,r);var P=function(D){return l.call(this,D,r)};return P.source="function("+(i.variable||"obj")+`){
`+x+"}",P},r.chain=function(e){return r(e).chain()};var ye=function(e){return this._chain?r(e).chain():e};r.mixin(r),z(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var n=o[e];r.prototype[e]=function(){var i=this._wrapped;return n.apply(i,arguments),(e=="shift"||e=="splice")&&i.length===0&&delete i[0],ye.call(this,i)}}),z(["concat","join","slice"],function(e){var n=o[e];r.prototype[e]=function(){return ye.call(this,n.apply(this._wrapped,arguments))}}),r.extend(r.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(ut)})(ze,ze.exports);var kt=ze.exports;const v=ct(kt);(function(){var u=function(m,d,y,E){for(y=y||{},E=m.length;E--;y[m[E]]=d);return y},s=[1,11],t=[1,9],a=[8,17],c=[6,11],o=[6,11,13,17],f={trace:function(){},yy:{},symbols_:{error:2,unitvalue:3,magnitude:4,unit:5,EOF:6,float:7,POW:8,int:9,multatoms:10,DIV:11,expatom:12,MUL:13,atom:14,"^":15,nat:16,ATOM:17,FLOAT:18,NAT:19,NEG:20,$accept:0,$end:1},terminals_:{2:"error",6:"EOF",8:"POW",11:"DIV",13:"MUL",15:"^",17:"ATOM",18:"FLOAT",19:"NAT",20:"NEG"},productions_:[0,[3,3],[3,2],[4,3],[4,1],[5,3],[5,1],[10,3],[10,2],[10,1],[12,3],[12,1],[14,1],[7,1],[7,1],[16,1],[9,2],[9,1]],performAction:function(d,y,E,M,k,w,q){var A=w.length-1;switch(k){case 1:return{type:"unitMagnitude",magnitude:w[A-2],unit:w[A-1]};case 2:return{type:"unitStandalone",unit:w[A-1]};case 3:this.$=w[A-2]+"e"+w[A];break;case 4:case 13:case 14:case 15:case 17:this.$=w[A];break;case 5:this.$={num:w[A-2],denom:w[A]};break;case 6:this.$={num:w[A],denom:null};break;case 7:this.$=[w[A-2]].concat(w[A]);break;case 8:this.$=[w[A-1]].concat(w[A]);break;case 9:this.$=[w[A]];break;case 10:this.$={name:w[A-2],pow:w[A]};break;case 11:this.$={name:w[A],pow:1};break;case 12:this.$=d;break;case 16:this.$="-"+w[A];break}},table:[{3:1,4:2,5:3,7:4,10:5,12:8,14:10,16:7,17:s,18:[1,6],19:t},{1:[3]},{5:12,10:5,12:8,14:10,17:s},{6:[1,13]},{8:[1,14],17:[2,4]},{6:[2,6],11:[1,15]},u(a,[2,13]),u(a,[2,14]),u(c,[2,9],{12:8,14:10,10:17,13:[1,16],17:s}),u([6,8,11,13,17],[2,15]),u(o,[2,11],{15:[1,18]}),u([6,11,13,15,17],[2,12]),{6:[1,19]},{1:[2,2]},{9:20,19:[1,22],20:[1,21]},{10:23,12:8,14:10,17:s},{10:24,12:8,14:10,17:s},u(c,[2,8]),{16:25,19:t},{1:[2,1]},{17:[2,3]},{19:[1,26]},{17:[2,17]},{6:[2,5]},u(c,[2,7]),u(o,[2,10]),{17:[2,16]}],defaultActions:{13:[2,2],19:[2,1],20:[2,3],22:[2,17],23:[2,5],26:[2,16]},parseError:function(d,y){if(y.recoverable)this.trace(d);else throw new Error(d)},parse:function(d){var y=this,E=[0],M=[null],k=[],w=this.table,q="",A=0,U=0,Y=2,ie=1,he=k.slice.call(arguments,1),K=Object.create(this.lexer),j={yy:{}};for(var se in this.yy)Object.prototype.hasOwnProperty.call(this.yy,se)&&(j.yy[se]=this.yy[se]);K.setInput(d,j.yy),j.yy.lexer=K,j.yy.parser=this,typeof K.yylloc>"u"&&(K.yylloc={});var r=K.yylloc;k.push(r);var z=K.options&&K.options.ranges;typeof j.yy.parseError=="function"?this.parseError=j.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function me(){var pe;return pe=K.lex()||ie,typeof pe!="number"&&(pe=y.symbols_[pe]||pe),pe}for(var X,Q,F,G,S={},R,L,V,ce;;){if(Q=E[E.length-1],this.defaultActions[Q]?F=this.defaultActions[Q]:((X===null||typeof X>"u")&&(X=me()),F=w[Q]&&w[Q][X]),typeof F>"u"||!F.length||!F[0]){var C="";ce=[];for(R in w[Q])this.terminals_[R]&&R>Y&&ce.push("'"+this.terminals_[R]+"'");K.showPosition?C="Parse error on line "+(A+1)+`:
`+K.showPosition()+`
Expecting `+ce.join(", ")+", got '"+(this.terminals_[X]||X)+"'":C="Parse error on line "+(A+1)+": Unexpected "+(X==ie?"end of input":"'"+(this.terminals_[X]||X)+"'"),this.parseError(C,{text:K.match,token:this.terminals_[X]||X,line:K.yylineno,loc:r,expected:ce})}if(F[0]instanceof Array&&F.length>1)throw new Error("Parse Error: multiple actions possible at state: "+Q+", token: "+X);switch(F[0]){case 1:E.push(X),M.push(K.yytext),k.push(K.yylloc),E.push(F[1]),X=null,U=K.yyleng,q=K.yytext,A=K.yylineno,r=K.yylloc;break;case 2:if(L=this.productions_[F[1]][1],S.$=M[M.length-L],S._$={first_line:k[k.length-(L||1)].first_line,last_line:k[k.length-1].last_line,first_column:k[k.length-(L||1)].first_column,last_column:k[k.length-1].last_column},z&&(S._$.range=[k[k.length-(L||1)].range[0],k[k.length-1].range[1]]),G=this.performAction.apply(S,[q,U,A,j.yy,F[1],M,k].concat(he)),typeof G<"u")return G;L&&(E=E.slice(0,-1*L*2),M=M.slice(0,-1*L),k=k.slice(0,-1*L)),E.push(this.productions_[F[1]][0]),M.push(S.$),k.push(S._$),V=w[E[E.length-2]][E[E.length-1]],E.push(V);break;case 3:return!0}}return!0}},p=function(){var m={EOF:1,parseError:function(y,E){if(this.yy.parser)this.yy.parser.parseError(y,E);else throw new Error(y)},setInput:function(d,y){return this.yy=y||this.yy||{},this._input=d,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var d=this._input[0];this.yytext+=d,this.yyleng++,this.offset++,this.match+=d,this.matched+=d;var y=d.match(/(?:\r\n?|\n).*/g);return y?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),d},unput:function(d){var y=d.length,E=d.split(/(?:\r\n?|\n)/g);this._input=d+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-y),this.offset-=y;var M=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),E.length-1&&(this.yylineno-=E.length-1);var k=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:E?(E.length===M.length?this.yylloc.first_column:0)+M[M.length-E.length].length-E[0].length:this.yylloc.first_column-y},this.options.ranges&&(this.yylloc.range=[k[0],k[0]+this.yyleng-y]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(d){this.unput(this.match.slice(d))},pastInput:function(){var d=this.matched.substr(0,this.matched.length-this.match.length);return(d.length>20?"...":"")+d.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var d=this.match;return d.length<20&&(d+=this._input.substr(0,20-d.length)),(d.substr(0,20)+(d.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var d=this.pastInput(),y=new Array(d.length+1).join("-");return d+this.upcomingInput()+`
`+y+"^"},test_match:function(d,y){var E,M,k;if(this.options.backtrack_lexer&&(k={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(k.yylloc.range=this.yylloc.range.slice(0))),M=d[0].match(/(?:\r\n?|\n).*/g),M&&(this.yylineno+=M.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:M?M[M.length-1].length-M[M.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+d[0].length},this.yytext+=d[0],this.match+=d[0],this.matches=d,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(d[0].length),this.matched+=d[0],E=this.performAction.call(this,this.yy,this,y,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),E)return E;if(this._backtrack){for(var w in k)this[w]=k[w];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var d,y,E,M;this._more||(this.yytext="",this.match="");for(var k=this._currentRules(),w=0;w<k.length;w++)if(E=this._input.match(this.rules[k[w]]),E&&(!y||E[0].length>y[0].length)){if(y=E,M=w,this.options.backtrack_lexer){if(d=this.test_match(E,k[w]),d!==!1)return d;if(this._backtrack){y=!1;continue}else return!1}else if(!this.options.flex)break}return y?(d=this.test_match(y,k[M]),d!==!1?d:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var y=this.next();return y||this.lex()},begin:function(y){this.conditionStack.push(y)},popState:function(){var y=this.conditionStack.length-1;return y>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(y){return y=this.conditionStack.length-1-Math.abs(y||0),y>=0?this.conditionStack[y]:"INITIAL"},pushState:function(y){this.begin(y)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(y,E,M,k){switch(M){case 0:return 11;case 1:return"(";case 2:return")";case 3:return 8;case 4:return 15;case 5:return 13;case 6:return 18;case 7:return 19;case 8:return 20;case 9:return 17;case 10:return 17;case 11:return 17;case 12:break;case 13:return 6}},rules:[/^(?:\/)/,/^(?:\()/,/^(?:\))/,/^(?:(\*|x|\u00d7|\u2219|\u22c5|\u00b7)\s*10\s*\^)/,/^(?:\^)/,/^(?:\*)/,/^(?:[0-9]+\.[0-9]+)/,/^(?:[0-9]+)/,/^(?:-)/,/^(?:\u00b0( ?)[cCfF])/,/^(?:fl\.? oz\.?)/,/^(?:[\u00b5]?([A-Za-z-]+|[\u2103\u2109\u212b]))/,/^(?:\s+)/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};return m}();f.lexer=p;function g(){this.yy={}}return g.prototype=f,f.Parser=g,new g})();var Ae=function(){var u=function(Q,F,G,S){for(G=G||{},S=Q.length;S--;G[Q[S]]=F);return G},s=[1,7],t=[1,17],a=[1,13],c=[1,14],o=[1,15],f=[1,32],p=[1,22],g=[1,23],m=[1,24],d=[1,25],y=[1,26],E=[1,33],M=[1,27],k=[1,28],w=[1,29],q=[1,30],A=[1,20],U=[1,36],Y=[1,37],ie=[5,6,8,10,33,35,41,43,45],he=[1,39],K=[1,40],j=[5,6,8,10,12,14,16,19,21,22,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],se=[10,16,19,21,22,28,29,30,31,32,34,37,39,42,43,44,46],r=[5,6,8,10,12,14,16,18,19,21,22,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],z={trace:function(){},yy:{},symbols_:{error:2,equation:3,expression:4,SIGN:5,EOF:6,additive:7,"+":8,multiplicative:9,"-":10,triglog:11,"*":12,negative:13,"/":14,trig:15,TRIG:16,trigfunc:17,"^":18,TRIGINV:19,logbase:20,ln:21,log:22,_:23,subscriptable:24,power:25,primitive:26,variable:27,VAR:28,CONST:29,INT:30,FLOAT:31,"{":32,"}":33,"(":34,")":35,function:36,FUNC:37,invocation:38,sqrt:39,"[":40,"]":41,abs:42,"|":43,"LEFT|":44,"RIGHT|":45,FRAC:46,$accept:0,$end:1},terminals_:{2:"error",5:"SIGN",6:"EOF",8:"+",10:"-",12:"*",14:"/",16:"TRIG",18:"^",19:"TRIGINV",21:"ln",22:"log",23:"_",28:"VAR",29:"CONST",30:"INT",31:"FLOAT",32:"{",33:"}",34:"(",35:")",37:"FUNC",39:"sqrt",40:"[",41:"]",42:"abs",43:"|",44:"LEFT|",45:"RIGHT|",46:"FRAC"},productions_:[0,[3,4],[3,2],[3,1],[4,1],[7,3],[7,3],[7,1],[9,2],[9,3],[9,3],[9,1],[13,2],[13,1],[15,1],[17,1],[17,3],[17,1],[20,1],[20,1],[20,3],[11,2],[11,2],[11,1],[25,3],[25,1],[27,1],[24,3],[24,1],[24,1],[24,1],[24,1],[24,3],[24,3],[36,1],[38,4],[38,4],[38,7],[38,4],[38,3],[38,3],[38,4],[26,1],[26,1],[26,7]],performAction:function(F,G,S,R,L,V,ce){var C=V.length-1;switch(L){case 1:return new R.Eq(V[C-3],V[C-2],V[C-1]);case 2:return V[C-1];case 3:return new R.Add([]);case 4:case 7:case 11:case 13:case 15:case 20:case 23:case 25:case 42:case 43:this.$=V[C];break;case 5:this.$=R.Add.createOrAppend(V[C-2],V[C]);break;case 6:this.$=R.Add.createOrAppend(V[C-2],R.Mul.handleNegative(V[C],"subtract"));break;case 8:this.$=R.Mul.fold(R.Mul.createOrAppend(V[C-1],V[C]));break;case 9:this.$=R.Mul.fold(R.Mul.createOrAppend(V[C-2],V[C]));break;case 10:this.$=R.Mul.fold(R.Mul.handleDivide(V[C-2],V[C]));break;case 12:this.$=R.Mul.handleNegative(V[C]);break;case 14:case 17:this.$=[F];break;case 16:this.$=V[C-2].concat(V[C]);break;case 18:this.$=R.Log.natural();break;case 19:this.$=R.Log.common();break;case 21:this.$=R.Trig.create(V[C-1],V[C]);break;case 22:this.$=R.Log.create(V[C-1],V[C]);break;case 24:this.$=new R.Pow(V[C-2],V[C]);break;case 26:case 34:this.$=F;break;case 27:this.$=new R.Var(V[C-2],V[C]);break;case 28:this.$=new R.Var(V[C]);break;case 29:this.$=new R.Const(F.toLowerCase());break;case 30:this.$=R.Int.create(Number(F));break;case 31:this.$=R.Float.create(Number(F));break;case 32:this.$=V[C-1].completeParse();break;case 33:this.$=V[C-1].completeParse().addHint("parens");break;case 35:case 36:this.$=R.Pow.sqrt(V[C-1]);break;case 37:this.$=new R.Pow.nthroot(V[C-1],V[C-4]);break;case 38:case 39:case 40:this.$=new R.Abs(V[C-1]);break;case 41:this.$=new R.Func(V[C-3],V[C-1]);break;case 44:this.$=R.Mul.handleDivide(V[C-4],V[C-1]);break}},table:[{3:1,4:2,6:[1,3],7:4,9:5,10:s,11:8,13:6,15:12,16:t,17:9,19:a,20:10,21:c,22:o,24:18,25:11,26:16,27:21,28:f,29:p,30:g,31:m,32:d,34:y,36:31,37:E,38:19,39:M,42:k,43:w,44:q,46:A},{1:[3]},{5:[1,34],6:[1,35]},{1:[2,3]},u([5,6],[2,4],{8:U,10:Y}),u(ie,[2,7],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:he,14:K,16:t,19:a,21:c,22:o,28:f,29:p,30:g,31:m,32:d,34:y,37:E,39:M,42:k,44:q,46:A}),u(j,[2,11]),{10:s,11:8,13:41,15:12,16:t,17:9,19:a,20:10,21:c,22:o,24:18,25:11,26:16,27:21,28:f,29:p,30:g,31:m,32:d,34:y,36:31,37:E,38:19,39:M,42:k,43:w,44:q,46:A},u(j,[2,13]),{10:s,11:8,13:42,15:12,16:t,17:9,19:a,20:10,21:c,22:o,24:18,25:11,26:16,27:21,28:f,29:p,30:g,31:m,32:d,34:y,36:31,37:E,38:19,39:M,42:k,43:w,44:q,46:A},{10:s,11:8,13:43,15:12,16:t,17:9,19:a,20:10,21:c,22:o,24:18,25:11,26:16,27:21,28:f,29:p,30:g,31:m,32:d,34:y,36:31,37:E,38:19,39:M,42:k,43:w,44:q,46:A},u(j,[2,23]),u(se,[2,15],{18:[1,44]}),u(se,[2,17]),u(se,[2,18]),u(se,[2,19],{23:[1,45]}),u(j,[2,25],{18:[1,46]}),u([10,16,18,19,21,22,28,29,30,31,32,34,37,39,42,43,44,46],[2,14]),u(r,[2,42]),u(r,[2,43]),{32:[1,47]},u(r,[2,28],{23:[1,48]}),u(r,[2,29]),u(r,[2,30]),u(r,[2,31]),{7:49,9:5,10:s,11:8,13:6,15:12,16:t,17:9,19:a,20:10,21:c,22:o,24:18,25:11,26:16,27:21,28:f,29:p,30:g,31:m,32:d,34:y,36:31,37:E,38:19,39:M,42:k,43:w,44:q,46:A},{7:50,9:5,10:s,11:8,13:6,15:12,16:t,17:9,19:a,20:10,21:c,22:o,24:18,25:11,26:16,27:21,28:f,29:p,30:g,31:m,32:d,34:y,36:31,37:E,38:19,39:M,42:k,43:w,44:q,46:A},{32:[1,52],34:[1,51],40:[1,53]},{34:[1,54]},{7:55,9:5,10:s,11:8,13:6,15:12,16:t,17:9,19:a,20:10,21:c,22:o,24:18,25:11,26:16,27:21,28:f,29:p,30:g,31:m,32:d,34:y,36:31,37:E,38:19,39:M,42:k,43:w,44:q,46:A},{7:56,9:5,10:s,11:8,13:6,15:12,16:t,17:9,19:a,20:10,21:c,22:o,24:18,25:11,26:16,27:21,28:f,29:p,30:g,31:m,32:d,34:y,36:31,37:E,38:19,39:M,42:k,43:w,44:q,46:A},{34:[1,57]},u([5,6,8,10,12,14,16,18,19,21,22,23,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],[2,26]),{34:[2,34]},{4:58,7:4,9:5,10:s,11:8,13:6,15:12,16:t,17:9,19:a,20:10,21:c,22:o,24:18,25:11,26:16,27:21,28:f,29:p,30:g,31:m,32:d,34:y,36:31,37:E,38:19,39:M,42:k,43:w,44:q,46:A},{1:[2,2]},{9:59,10:s,11:8,13:6,15:12,16:t,17:9,19:a,20:10,21:c,22:o,24:18,25:11,26:16,27:21,28:f,29:p,30:g,31:m,32:d,34:y,36:31,37:E,38:19,39:M,42:k,43:w,44:q,46:A},{9:60,10:s,11:8,13:6,15:12,16:t,17:9,19:a,20:10,21:c,22:o,24:18,25:11,26:16,27:21,28:f,29:p,30:g,31:m,32:d,34:y,36:31,37:E,38:19,39:M,42:k,43:w,44:q,46:A},u(j,[2,8]),{10:s,11:8,13:61,15:12,16:t,17:9,19:a,20:10,21:c,22:o,24:18,25:11,26:16,27:21,28:f,29:p,30:g,31:m,32:d,34:y,36:31,37:E,38:19,39:M,42:k,43:w,44:q,46:A},{10:s,11:8,13:62,15:12,16:t,17:9,19:a,20:10,21:c,22:o,24:18,25:11,26:16,27:21,28:f,29:p,30:g,31:m,32:d,34:y,36:31,37:E,38:19,39:M,42:k,43:w,44:q,46:A},u(j,[2,12]),u(j,[2,21]),u(j,[2,22]),{10:s,11:8,13:63,15:12,16:t,17:9,19:a,20:10,21:c,22:o,24:18,25:11,26:16,27:21,28:f,29:p,30:g,31:m,32:d,34:y,36:31,37:E,38:19,39:M,42:k,43:w,44:q,46:A},{24:64,27:21,28:f,29:p,30:g,31:m,32:d,34:y},{10:s,11:8,13:65,15:12,16:t,17:9,19:a,20:10,21:c,22:o,24:18,25:11,26:16,27:21,28:f,29:p,30:g,31:m,32:d,34:y,36:31,37:E,38:19,39:M,42:k,43:w,44:q,46:A},{7:66,9:5,10:s,11:8,13:6,15:12,16:t,17:9,19:a,20:10,21:c,22:o,24:18,25:11,26:16,27:21,28:f,29:p,30:g,31:m,32:d,34:y,36:31,37:E,38:19,39:M,42:k,43:w,44:q,46:A},{24:67,27:21,28:f,29:p,30:g,31:m,32:d,34:y},{8:U,10:Y,33:[1,68]},{8:U,10:Y,35:[1,69]},{7:70,9:5,10:s,11:8,13:6,15:12,16:t,17:9,19:a,20:10,21:c,22:o,24:18,25:11,26:16,27:21,28:f,29:p,30:g,31:m,32:d,34:y,36:31,37:E,38:19,39:M,42:k,43:w,44:q,46:A},{7:71,9:5,10:s,11:8,13:6,15:12,16:t,17:9,19:a,20:10,21:c,22:o,24:18,25:11,26:16,27:21,28:f,29:p,30:g,31:m,32:d,34:y,36:31,37:E,38:19,39:M,42:k,43:w,44:q,46:A},{7:72,9:5,10:s,11:8,13:6,15:12,16:t,17:9,19:a,20:10,21:c,22:o,24:18,25:11,26:16,27:21,28:f,29:p,30:g,31:m,32:d,34:y,36:31,37:E,38:19,39:M,42:k,43:w,44:q,46:A},{7:73,9:5,10:s,11:8,13:6,15:12,16:t,17:9,19:a,20:10,21:c,22:o,24:18,25:11,26:16,27:21,28:f,29:p,30:g,31:m,32:d,34:y,36:31,37:E,38:19,39:M,42:k,43:w,44:q,46:A},{8:U,10:Y,43:[1,74]},{8:U,10:Y,45:[1,75]},{7:76,9:5,10:s,11:8,13:6,15:12,16:t,17:9,19:a,20:10,21:c,22:o,24:18,25:11,26:16,27:21,28:f,29:p,30:g,31:m,32:d,34:y,36:31,37:E,38:19,39:M,42:k,43:w,44:q,46:A},{6:[1,77]},u(ie,[2,5],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:he,14:K,16:t,19:a,21:c,22:o,28:f,29:p,30:g,31:m,32:d,34:y,37:E,39:M,42:k,44:q,46:A}),u(ie,[2,6],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:he,14:K,16:t,19:a,21:c,22:o,28:f,29:p,30:g,31:m,32:d,34:y,37:E,39:M,42:k,44:q,46:A}),u(j,[2,9]),u(j,[2,10]),u(se,[2,16]),u(se,[2,20]),u(j,[2,24]),{8:U,10:Y,33:[1,78]},u(r,[2,27]),u(r,[2,32]),u(r,[2,33]),{8:U,10:Y,35:[1,79]},{8:U,10:Y,33:[1,80]},{8:U,10:Y,41:[1,81]},{8:U,10:Y,35:[1,82]},u(r,[2,39]),u(r,[2,40]),{8:U,10:Y,35:[1,83]},{1:[2,1]},{32:[1,84]},u(r,[2,35]),u(r,[2,36]),{32:[1,85]},u(r,[2,38]),u(r,[2,41]),{7:86,9:5,10:s,11:8,13:6,15:12,16:t,17:9,19:a,20:10,21:c,22:o,24:18,25:11,26:16,27:21,28:f,29:p,30:g,31:m,32:d,34:y,36:31,37:E,38:19,39:M,42:k,43:w,44:q,46:A},{7:87,9:5,10:s,11:8,13:6,15:12,16:t,17:9,19:a,20:10,21:c,22:o,24:18,25:11,26:16,27:21,28:f,29:p,30:g,31:m,32:d,34:y,36:31,37:E,38:19,39:M,42:k,43:w,44:q,46:A},{8:U,10:Y,33:[1,88]},{8:U,10:Y,33:[1,89]},u(r,[2,44]),u(r,[2,37])],defaultActions:{3:[2,3],33:[2,34],35:[2,2],77:[2,1]},parseError:function(F,G){if(G.recoverable)this.trace(F);else throw new Error(F)},parse:function(F){var G=this,S=[0],R=[null],L=[],V=this.table,ce="",C=0,pe=0,ye=2,e=1,n=L.slice.call(arguments,1),i=Object.create(this.lexer),l={yy:{}};for(var h in this.yy)Object.prototype.hasOwnProperty.call(this.yy,h)&&(l.yy[h]=this.yy[h]);i.setInput(F,l.yy),l.yy.lexer=i,l.yy.parser=this,typeof i.yylloc>"u"&&(i.yylloc={});var I=i.yylloc;L.push(I);var x=i.options&&i.options.ranges;typeof l.yy.parseError=="function"?this.parseError=l.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function P(){var be;return be=i.lex()||e,typeof be!="number"&&(be=G.symbols_[be]||be),be}for(var D,W,$,we,ve={},Ee,xe,Ke,De;;){if(W=S[S.length-1],this.defaultActions[W]?$=this.defaultActions[W]:((D===null||typeof D>"u")&&(D=P()),$=V[W]&&V[W][D]),typeof $>"u"||!$.length||!$[0]){var Le="";De=[];for(Ee in V[W])this.terminals_[Ee]&&Ee>ye&&De.push("'"+this.terminals_[Ee]+"'");i.showPosition?Le="Parse error on line "+(C+1)+`:
`+i.showPosition()+`
Expecting `+De.join(", ")+", got '"+(this.terminals_[D]||D)+"'":Le="Parse error on line "+(C+1)+": Unexpected "+(D==e?"end of input":"'"+(this.terminals_[D]||D)+"'"),this.parseError(Le,{text:i.match,token:this.terminals_[D]||D,line:i.yylineno,loc:I,expected:De})}if($[0]instanceof Array&&$.length>1)throw new Error("Parse Error: multiple actions possible at state: "+W+", token: "+D);switch($[0]){case 1:S.push(D),R.push(i.yytext),L.push(i.yylloc),S.push($[1]),D=null,pe=i.yyleng,ce=i.yytext,C=i.yylineno,I=i.yylloc;break;case 2:if(xe=this.productions_[$[1]][1],ve.$=R[R.length-xe],ve._$={first_line:L[L.length-(xe||1)].first_line,last_line:L[L.length-1].last_line,first_column:L[L.length-(xe||1)].first_column,last_column:L[L.length-1].last_column},x&&(ve._$.range=[L[L.length-(xe||1)].range[0],L[L.length-1].range[1]]),we=this.performAction.apply(ve,[ce,pe,C,l.yy,$[1],R,L].concat(n)),typeof we<"u")return we;xe&&(S=S.slice(0,-1*xe*2),R=R.slice(0,-1*xe),L=L.slice(0,-1*xe)),S.push(this.productions_[$[1]][0]),R.push(ve.$),L.push(ve._$),Ke=V[S[S.length-2]][S[S.length-1]],S.push(Ke);break;case 3:return!0}}return!0}},me=function(){var Q={EOF:1,parseError:function(G,S){if(this.yy.parser)this.yy.parser.parseError(G,S);else throw new Error(G)},setInput:function(F,G){return this.yy=G||this.yy||{},this._input=F,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var F=this._input[0];this.yytext+=F,this.yyleng++,this.offset++,this.match+=F,this.matched+=F;var G=F.match(/(?:\r\n?|\n).*/g);return G?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),F},unput:function(F){var G=F.length,S=F.split(/(?:\r\n?|\n)/g);this._input=F+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-G),this.offset-=G;var R=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),S.length-1&&(this.yylineno-=S.length-1);var L=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:S?(S.length===R.length?this.yylloc.first_column:0)+R[R.length-S.length].length-S[0].length:this.yylloc.first_column-G},this.options.ranges&&(this.yylloc.range=[L[0],L[0]+this.yyleng-G]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(F){this.unput(this.match.slice(F))},pastInput:function(){var F=this.matched.substr(0,this.matched.length-this.match.length);return(F.length>20?"...":"")+F.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var F=this.match;return F.length<20&&(F+=this._input.substr(0,20-F.length)),(F.substr(0,20)+(F.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var F=this.pastInput(),G=new Array(F.length+1).join("-");return F+this.upcomingInput()+`
`+G+"^"},test_match:function(F,G){var S,R,L;if(this.options.backtrack_lexer&&(L={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(L.yylloc.range=this.yylloc.range.slice(0))),R=F[0].match(/(?:\r\n?|\n).*/g),R&&(this.yylineno+=R.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:R?R[R.length-1].length-R[R.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+F[0].length},this.yytext+=F[0],this.match+=F[0],this.matches=F,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(F[0].length),this.matched+=F[0],S=this.performAction.call(this,this.yy,this,G,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),S)return S;if(this._backtrack){for(var V in L)this[V]=L[V];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var F,G,S,R;this._more||(this.yytext="",this.match="");for(var L=this._currentRules(),V=0;V<L.length;V++)if(S=this._input.match(this.rules[L[V]]),S&&(!G||S[0].length>G[0].length)){if(G=S,R=V,this.options.backtrack_lexer){if(F=this.test_match(S,L[V]),F!==!1)return F;if(this._backtrack){G=!1;continue}else return!1}else if(!this.options.flex)break}return G?(F=this.test_match(G,L[R]),F!==!1?F:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var G=this.next();return G||this.lex()},begin:function(G){this.conditionStack.push(G)},popState:function(){var G=this.conditionStack.length-1;return G>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(G){return G=this.conditionStack.length-1-Math.abs(G||0),G>=0?this.conditionStack[G]:"INITIAL"},pushState:function(G){this.begin(G)},stateStackSize:function(){return this.conditionStack.length},options:{flex:!0},performAction:function(G,S,R,L){switch(R){case 0:break;case 1:break;case 2:break;case 3:return"INT";case 4:return"FLOAT";case 5:return"^";case 6:return"*";case 7:return"*";case 8:return"*";case 9:return"*";case 10:return"/";case 11:return"/";case 12:return"-";case 13:return"-";case 14:return"+";case 15:return"^";case 16:return"(";case 17:return")";case 18:return"(";case 19:return")";case 20:return"[";case 21:return"]";case 22:return"{";case 23:return"}";case 24:return"{";case 25:return"}";case 26:return"_";case 27:return"|";case 28:return"LEFT|";case 29:return"RIGHT|";case 30:return"!";case 31:return"SIGN";case 32:return S.yytext="<=","SIGN";case 33:return S.yytext=">=","SIGN";case 34:return S.yytext="<=","SIGN";case 35:return S.yytext=">=","SIGN";case 36:return S.yytext="<>","SIGN";case 37:return S.yytext="<>","SIGN";case 38:return S.yytext="<>","SIGN";case 39:return S.yytext="<>","SIGN";case 40:return S.yytext="<=","SIGN";case 41:return S.yytext=">=","SIGN";case 42:return"FRAC";case 43:return"FRAC";case 44:return"sqrt";case 45:return"abs";case 46:return"ln";case 47:return"log";case 48:return"TRIG";case 49:return"TRIG";case 50:return"TRIG";case 51:return"TRIG";case 52:return S.yytext="sin","TRIG";case 53:return S.yytext="cos","TRIG";case 54:return S.yytext="tan","TRIG";case 55:return S.yytext="csc","TRIG";case 56:return S.yytext="sec","TRIG";case 57:return S.yytext="cot","TRIG";case 58:return S.yytext="arcsin","TRIG";case 59:return S.yytext="arccos","TRIG";case 60:return S.yytext="arctan","TRIG";case 61:return S.yytext="arccsc","TRIG";case 62:return S.yytext="arcsec","TRIG";case 63:return S.yytext="arccot","TRIG";case 64:return"TRIGINV";case 65:return"TRIGINV";case 66:return S.yytext="sinh","TRIG";case 67:return S.yytext="cosh","TRIG";case 68:return S.yytext="tanh","TRIG";case 69:return S.yytext="csch","TRIG";case 70:return S.yytext="sech","TRIG";case 71:return S.yytext="tanh","TRIG";case 72:return"CONST";case 73:return S.yytext="pi","CONST";case 74:return S.yytext="pi","CONST";case 75:return"VAR";case 76:return S.yytext="theta","VAR";case 77:return S.yytext="theta","VAR";case 78:return"VAR";case 79:return S.yytext="phi","VAR";case 80:return S.yytext="phi","VAR";case 81:return G.symbolLexer(S.yytext);case 82:return"EOF";case 83:return"INVALID";case 84:console.log(S.yytext);break}},rules:[/^(?:\s+)/,/^(?:\\space)/,/^(?:\\ )/,/^(?:[0-9]+\.?)/,/^(?:([0-9]+)?\.[0-9]+)/,/^(?:\*\*)/,/^(?:\*)/,/^(?:\\cdot|·)/,/^(?:\\times|×)/,/^(?:\\ast)/,/^(?:\/)/,/^(?:\\div|÷)/,/^(?:-)/,/^(?:−)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:\\left\()/,/^(?:\\right\))/,/^(?:\[)/,/^(?:\])/,/^(?:\{)/,/^(?:\})/,/^(?:\\left\{)/,/^(?:\\right\})/,/^(?:_)/,/^(?:\|)/,/^(?:\\left\|)/,/^(?:\\right\|)/,/^(?:\!)/,/^(?:<=|>=|<>|<|>|=)/,/^(?:\\le)/,/^(?:\\ge)/,/^(?:\\leq)/,/^(?:\\geq)/,/^(?:=\/=)/,/^(?:\\ne)/,/^(?:\\neq)/,/^(?:≠)/,/^(?:≤)/,/^(?:≥)/,/^(?:\\frac)/,/^(?:\\dfrac)/,/^(?:sqrt|\\sqrt)/,/^(?:abs|\\abs)/,/^(?:ln|\\ln)/,/^(?:log|\\log)/,/^(?:sin|cos|tan)/,/^(?:csc|sec|cot)/,/^(?:sinh|cosh|tanh)/,/^(?:csch|sech|coth)/,/^(?:\\sin)/,/^(?:\\cos)/,/^(?:\\tan)/,/^(?:\\csc)/,/^(?:\\sec)/,/^(?:\\cot)/,/^(?:\\arcsin)/,/^(?:\\arccos)/,/^(?:\\arctan)/,/^(?:\\arccsc)/,/^(?:\\arcsec)/,/^(?:\\arccot)/,/^(?:arcsin|arccos|arctan)/,/^(?:arccsc|arcsec|arccot)/,/^(?:\\sinh)/,/^(?:\\cosh)/,/^(?:\\tanh)/,/^(?:\\csch)/,/^(?:\\sech)/,/^(?:\\coth)/,/^(?:pi)/,/^(?:π)/,/^(?:\\pi)/,/^(?:theta)/,/^(?:θ)/,/^(?:\\theta)/,/^(?:phi)/,/^(?:φ)/,/^(?:\\phi)/,/^(?:[a-zA-Z])/,/^(?:$)/,/^(?:.)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84],inclusive:!0}}};return Q}();z.lexer=me;function X(){this.yy={}}return X.prototype=z,z.Parser=X,new X}(),le=function(){throw new Error("Abstract method - must override for expr: "+this.print())},Ye=function(u){throw new Error(u)},Xe=function(u){return u!==u},Ot=function(u,s){var t=s-u;return Math.random()*t+u},Qe=12,je=9;class ge{constructor(){this.hints={parens:!1}}func(){le()}args(){return le()}construct(s){const t=this.func,a=new t(...s);if(typeof a>"u")throw new Error("constructor function returning undefined");return a}recurse(s,...t){var a=v.map(this.args(),function(c){return v.isString(c)?c:c[s].apply(c,t)});return this.construct(a)}eval(){return le()}codegen(){return le()}compile(){var s=this.codegen();try{return new Function("vars","return "+s+";")}catch{throw new Error("Function did not compile: "+s)}}print(){return le()}tex(){return le()}asTex(s){s=s||{},v.defaults(s,{display:!0,dynamic:!0,times:!1});var t=this.tex();return s.display&&(t="\\displaystyle "+t),s.dynamic&&(t=t.replace(/\(/g,"\\left("),t=t.replace(/\)/g,"\\right)")),s.times&&(t=t.replace(/\\cdot/g,"\\times")),t}name(){return this.func.name?this.func.name:this.func.toString().match(/^function\s*([^\s(]+)/)[1]}repr(){return this.name()+"("+v.map(this.args(),function(s){return v.isString(s)?s:s.repr()}).join(",")+")"}strip(){return this.recurse("strip")}normalize(){return this.recurse("normalize")}expand(){return this.recurse("expand")}factor(s){return this.recurse("factor",s)}collect(s){return this.recurse("collect",s)}equals(s){return this.normalize().print()===s.normalize().print()}simplify(s){s=v.extend({once:!1},s);var t=this.factor(s),a=t.collect(s);t.equals(a)&&(a=this.collect(s));var c=a.expand(s),o=c.collect(s);c.equals(o)&&(o=a.collect(s));var f=o;return s.once||this.equals(f)?f:f.simplify(s)}isSimplified(){return this.equals(this.simplify())}exprArgs(){return v.filter(this.args(),function(s){return s instanceof ge})}getVars(s){return v.uniq(v.flatten(v.invoke(this.exprArgs(),"getVars",s))).sort()}getConsts(){return v.uniq(v.flatten(v.invoke(this.exprArgs(),"getConsts"))).sort()}getUnits(){return v.flatten(v.invoke(this.exprArgs(),"getUnits"))}is(s){return this instanceof s}has(s){return this instanceof s?!0:v.any(this.exprArgs(),function(t){return t.has(s)})}raiseToThe(s){return new H(this,s)}isSubtract(){return!1}isDivide(){return!1}isRoot(){return!1}needsExplicitMul(){return this.args()[0].needsExplicitMul()}sameVars(s){var t=this.getVars(),a=s.getVars(),c=function(g,m){return!v.difference(g,m).length},o=function(g){return v.uniq(v.invoke(g,"toLowerCase")).sort()},f=c(t,a),p=c(o(t),o(a));return{equal:f,equalIgnoringCase:p}}compare(s){if(s instanceof Se)return!1;var t=v.union(this.getVars(!0),s.getVars(!0)),a=function(q,A){return Math.abs(q)<1||Math.abs(A)<1?Math.abs(q-A):Math.abs(1-q/A)},c=function(q,A){var U=a(q,A);return q===A||Xe(q)&&Xe(A)||U<Math.pow(10,-je)};if(!t.length&&!this.has(oe)&&!s.has(oe))return c(this.eval(),s.eval());var o=this.collect(),f=s.collect(),p=this.getUnits(),g=s.getUnits();if(!v.isEqual(p,g))return!1;for(var m=0;m<Qe;m++){var d={},y=Math.pow(10,1+Math.floor(3*m/Qe)),E=m%2===0;v.each(t,function(q){d[q]=E?Ot(-y,y):v.random(-y,y)});var M;if(o.has(Me)||f.has(Me)||o.has(oe)||f.has(oe)){var k=o.partialEval(d),w=f.partialEval(d);M=k.simplify().equals(w.simplify())}else{var k=o.eval(d),w=f.eval(d);M=c(k,w)}if(!M)return!1}return!0}partialEval(s){return this instanceof oe?this:this.has(Me)?this instanceof Me?new Me(this.symbol,this.arg.partialEval(s)):this.recurse("partialEval",s):new ue(this.eval(s).toFixed(je)).collect()}sameForm(s){return this.strip().equals(s.strip())}findGCD(s){return this.equals(s)?s:O.One}getDenominator(){return O.One}asMul(){return new N(O.One,this)}isPositive(){return le()}isNegative(){return!1}asPositiveFactor(){return this.isPositive()?this:O.One}addHint(s){if(!s)return this;var t=this.construct(this.args());return t.hints=v.clone(this.hints),t.hints[s]=!0,t}asExpr(){return this}completeParse(){return this.recurse("completeParse")}abs(){return le()}negate(){return new N(O.Neg,this)}}class Ge extends ge{constructor(...s){super(),s.length===1?this.terms=s[0]:this.terms=s}args(){return this.terms}normalize(){var s=v.sortBy(v.invoke(this.terms,"normalize"),function(t){return t.print()});return new this.func(s)}expand(){return this.recurse("expand").flatten()}partition(){var s=v.groupBy(this.terms,function(c){return c instanceof O}),t=s[!0]||[],a=s[!1]||[];return[new this.func(t),new this.func(a)]}flatten(){var s=this,t=v.reject(this.terms,function(p){return p.equals(s.identity)});if(t.length===0)return s.identity;if(t.length===1)return t[0];var a=v.groupBy(t,function(p){return p instanceof s.func}),c=a[!0]||[],o=a[!1]||[],f=o.concat(v.flatten(v.pluck(c,"terms"),!0));return new s.func(f)}reduce(s){return le()}isPositive(){var s=v.invoke(this.terms,"collect");return v.all(v.invoke(s,"isPositive"))}replace(s,t){var a;s instanceof ge?a=v.indexOf(this.terms,s):a=s;var c=[];v.isArray(t)?c=t:t&&(c=[t]);var o=this.terms.slice(0,a).concat(c).concat(this.terms.slice(a+1));return new this.func(o)}remove(s){return this.replace(s)}getDenominator(){return new N(v.invoke(this.terms,"getDenominator")).flatten()}}class te extends Ge{constructor(){super(...arguments);ne(this,"func",te)}eval(t,a){return v.reduce(this.terms,function(c,o){return c+o.eval(t,a)},0)}codegen(){return v.map(this.terms,function(t){return"("+t.codegen()+")"}).join(" + ")||"0"}print(){return v.invoke(this.terms,"print").join("+")}tex(){var t="";return v.each(this.terms,function(a){!t||a.isSubtract()?t+=a.tex():t+="+"+a.tex()}),t}collect(t){var a=v.invoke(this.terms,"collect",t),c=[];v.each(a,function(p){if(p instanceof N){var g=p.partition();c.push([g[1].flatten(),g[0].reduce(t)])}else p instanceof O?c.push([O.One,p]):c.push([p,O.One])});var o=v.groupBy(c,function(p){return p[0].normalize().print()}),f=v.compact(v.map(o,function(p){var g=p[0][0],m=new te(v.zip.apply(v,p)[1]),d=m.reduce(t);return new N(d,g).collect(t)}));return new te(f).flatten()}factor(t){t=v.extend({keepNegative:!1},t);var a=v.invoke(this.terms,"collect"),c;a[0]instanceof N?c=a[0].terms:c=[a[0]],v.each(v.rest(this.terms),function(f){c=v.map(c,function(p){return f.findGCD(p)})}),!t.keepNegative&&this.isNegative()&&c.push(O.Neg),c=new N(c).flatten().collect();var o=v.map(a,function(f){return N.handleDivide(f,c).simplify()});return o=new te(o).flatten(),N.createOrAppend(c,o).flatten()}reduce(t){return v.reduce(this.terms,function(a,c){return a.add(c,t)},this.identity)}needsExplicitMul(){return!1}isNegative(){var t=v.invoke(this.terms,"collect");return v.all(v.invoke(t,"isNegative"))}negate(){return new te(v.invoke(this.terms,"negate"))}}class N extends Ge{constructor(){super(...arguments);ne(this,"func",N)}eval(t,a){return v.reduce(this.terms,function(c,o){return c*o.eval(t,a)},1)}codegen(){return v.map(this.terms,function(t){return"("+t.codegen()+")"}).join(" * ")||"0"}print(){return v.map(this.terms,function(t){return t instanceof te?"("+t.print()+")":t.print()}).join("*")}getUnits(){var t=v(this.terms).chain().map(function(a){return a.getUnits()}).flatten().value();return t.sort((a,c)=>a.unit.localeCompare(c.unit)),t}tex(){for(var t=" \\cdot ",a=v.groupBy(this.terms,function(w){return w.isDivide()?"inverse":w instanceof O?"number":"other"}),c=a.inverse||[],o=a.number||[],f=a.other||[],p="",g,m=0;m<o.length;m++){var d=o[m]instanceof B&&!(o[m]instanceof _);if(d&&f.length>0&&c.length>0){var y=o.slice();y.splice(m,1);var E=y.concat(c).concat(f);return o[m].tex()+new N(E).tex()}}if(o=v.compact(v.map(o,function(w){var q=w instanceof B&&!(w instanceof _),A=!w.hints.fraction||c.length>0;if(q&&A){c.push(new H(new _(w.d),O.Div));var U=new _(w.n);return U.hints=w.hints,v.any(w.hints)?U:null}else return w})),o.length===0&&f.length===1)g=f[0].tex();else{var M="";v.each(o,function(w){w.hints.subtract&&w.hints.entered?(p+="-",M+=(M?t:"")+w.abs().tex()):w instanceof _&&w.n===-1&&(w.hints.negate||w.hints.subtract)?p+="-":M+=(M?t:"")+w.tex()}),v.each(f,function(w){w.needsExplicitMul()?M+=(M?t:"")+w.tex():w instanceof te?M+="("+w.tex()+")":M+=w.tex()}),g=M||"1"}if(c.length){var k=new N(v.invoke(c,"asDivide")).flatten().tex();return p+"\\frac{"+g+"}{"+k+"}"}else return p+g}strip(){var t=v.map(this.terms,function(a){return a instanceof O?a.abs():a.strip()});return new N(t).flatten()}expand(){var t=function(A){return A instanceof te},a=function(A){return A instanceof H&&A.exp.isNegative()},c=function(A){return a(A)&&t(A.base)},o=this.recurse("expand").flatten(),f=v.any(o.terms,t),p=v.any(o.terms,c);if(!(f||p))return o;var g=v.groupBy(o.terms,a),m=g[!1]||[],d=g[!0]||[];if(f){var y=v.groupBy(m,t),E=y[!0]||[],M=y[!1]||[],k=v.reduce(E,function(A,U){return v.reduce(A,function(Y,ie){return Y.concat(v.map(U.terms,function(he){return ie.concat(he)}))},[])},[[]]),w=v.map(k,function(A){return new N(M.concat(A)).flatten()});m=[new te(w)]}if(p){var q=new N(v.invoke(d,"getDenominator")).flatten();d=[new H(q.expand(),O.Div)]}return new N(m.concat(d)).flatten()}factor(t){var a=this.recurse("factor",t).flatten();if(!(a instanceof N))return a;var c=v.groupBy(a.terms,function(f){return f instanceof B}),o=v.reduce(c[!0],function(f,p){return{n:f.n*p.n,d:f.d*p.d}},{n:1,d:1});return o.d===1?o=new _(o.n):o=new B(o.n,o.d),new N((c[!1]||[]).concat(o)).flatten()}collect(t){var a=this.recurse("collect",t).partition(),c=a[0].reduce(t);if(c.eval()===0)return O.Zero;var o=a[1].flatten();if(!(o instanceof N))return new N(c,o).flatten();o=o.terms;var g=[];v.each(o,function(w){w instanceof H?g.push([w.base,w.exp]):g.push([w,O.One])});var f=v.groupBy(g,function(w){return w[0].normalize().print()}),p=v.compact(v.map(f,function(w){var q=w[0][0],A=new te(v.zip.apply(v,w)[1]),U=A.collect(t);return U instanceof O&&U.eval()===0?null:[q,U]})),g=v.groupBy(p,function(w){return w[0]instanceof J&&w[0].isBasic()?"trig":w[0]instanceof fe?"log":"expr"}),m=g.trig||[],d=g.log||[],y=g.expr||[];if(m.length>1){var E=v.groupBy(m,function(w){return w[0].arg.normalize().print()});m=[],v.each(E,function(w){var q=w[0][0].arg,A={sin:O.Zero,cos:O.Zero};v.each(w,function(U){A[U[0].type]=U[1]}),N.handleNegative(A.sin).collect(t).equals(A.cos)&&(A.cos.isNegative()?A={tan:A.sin}:A={cot:A.cos}),v.each(A,function(U,Y){m.push([new J(Y,q),U])})})}if(d.length>1){var M=v.groupBy(d,function(w){return w[0].base.normalize().print()});d=[],v.each(M,function(w){w.length===2&&N.handleNegative(w[0][1]).collect(t).equals(w[1][1])?w[0][1].isNegative()?d.push([new fe(w[0][0].power,w[1][0].power),w[1][1]]):d.push([new fe(w[1][0].power,w[0][0].power),w[0][1]]):d=d.concat(w)})}g=m.concat(d).concat(y);var k=v.map(g,function(w){return new H(w[0],w[1]).collect(t)});return new N([c].concat(k)).flatten()}isSubtract(){return v.any(this.terms,function(t){return t instanceof O&&t.hints.subtract})}factorIn(t){var a=this.partition(),c=a[0].terms,o=c.length&&v.all(c,function(p){return p.n>0});if(o){var f=c[0].negate();return f.hints=c[0].hints,this.replace(c[0],f.addHint(t))}else return new N([O.negativeOne(t)].concat(this.terms))}factorOut(){var t=!1,a=v.compact(v.map(this.terms,function(c,o,f){return!t&&c instanceof O&&c.hints.divide?(t=!0,c.n!==-1?c.negate():null):c}));return a.length===1?a[0]:new N(a)}reduce(t){return v.reduce(this.terms,function(a,c){return a.mul(c,t)},this.identity)}findGCD(t){return new N(v.invoke(this.terms,"findGCD",t)).flatten()}asMul(){return this}asPositiveFactor(){if(this.isPositive())return this;var t=v.invoke(this.collect().terms,"asPositiveFactor");return new N(t).flatten()}isNegative(){return v.any(v.invoke(this.collect().terms,"isNegative"))}fold(){return N.fold(this)}negate(){var t=function(c){return c instanceof O};if(v.any(this.terms,t)){var a=v.find(this.terms,t);return this.replace(a,a.negate())}else return new N([O.Neg].concat(this.terms))}static handleNegative(t,a){if(t instanceof O&&t.n>0){var c=t.negate();return c.hints=t.hints,c.addHint(a)}else return t instanceof N?t.factorIn(a):new N(O.negativeOne(a),t)}static handleDivide(t,a){if(a instanceof N){var c=N.handleDivide(t,a.terms[0]),o=new N(v.rest(a.terms)).flatten();return N.handleDivide(c,o)}var f=function(M){return M instanceof _},p=function(M){return M instanceof B};if(f(a)&&t instanceof N&&v.any(t.terms,f)){var g=t.terms.slice().reverse(),m=v.find(g,p);if(!f(m))return new N(t.terms.concat([new B(1,a.n).addHint("fraction")]));var d=new B(m.n,a.n);return d.hints=m.hints,m===g[0]&&(d=d.addHint("fraction")),m.n<0&&a.n<0?(d.d=-d.d,t.replace(m,[O.Neg,d])):t.replace(m,d)}var y=function(M,k){if(k instanceof _){if(M instanceof _)return M.n<0&&k.n<0?[O.Neg,new B(M.n,-k.n).addHint("fraction")]:[new B(M.n,k.n).addHint("fraction")];var w=new B(1,k.eval());return k.eval()<0?[M,w.addHint("negate")]:[M,w]}else{var q;if(k instanceof J&&k.exp){var A=k.exp;k.exp=void 0,k=new H(k,A)}return k instanceof H?q=new H(k.base,N.handleNegative(k.exp,"divide")):q=new H(k,O.Div),M instanceof _&&M.n===1?[q]:[M,q]}};if(t instanceof N){var E=y(v.last(t.terms),a);return new N(v.initial(t.terms).concat(E))}else{var E=y(t,a);return new N(E).flatten()}}static fold(t){if(t instanceof N){var a=v.find(v.initial(t.terms),function(k){return(k instanceof J||k instanceof fe)&&k.hints.open}),c=v.indexOf(t.terms,a);if(a){var o=v.last(t.terms);if(a.hints.parens||o.hints.parens||o.has(J)||o.has(fe))a.hints.open=!1;else{var f;return a instanceof J?f=J.create([a.type,a.exp],N.createOrAppend(a.arg,o).fold()):f=fe.create(a.base,N.createOrAppend(a.power,o).fold()),c===0?f:new N(t.terms.slice(0,c).concat(f)).fold()}}var p=t.partition(),g=p[0].terms,m=function(k){return k.n>0},d=function(k){return k.n===-1&&k.hints.negate},y=function(k){return m(k)||d(k)};if(g.length>1&&v.some(g,d)&&v.some(g,m)&&v.every(g,y)){var E=v.indexOf(t.terms,v.find(t.terms,d)),M=v.indexOf(t.terms,v.find(t.terms,m));if(E<M)return t.replace(M,t.terms[M].negate()).remove(E)}}return t}}v.each([te,N],function(u){u.createOrAppend=function(s,t){return s instanceof u?new u(s.terms.concat(t)):new u(s,t)}});const Z=class Z extends ge{constructor(t,a){super();ne(this,"func",Z);this.base=t,this.exp=a}args(){return[this.base,this.exp]}eval(t,a){var c=this.base.eval(t,a),o=this.exp.eval(t,a);if(c<0){var f=this.exp.simplify();if(f instanceof ue){var p=f.n,g=(p-p.toFixed()).toString().length-2,m=Math.pow(10,g),d=new B(p*m,m);f=d.simplify()}if(f instanceof B){var y=Math.abs(f.d)%2===1;if(y){var E=Math.abs(f.n)%2===1,M=E?-1:1;return M*Math.pow(-1*c,o)}}}return Math.pow(c,o)}getUnits(){return this.base.getUnits().map((function(t){return{unit:t.unit,pow:t.pow*this.exp.n}}).bind(this))}codegen(){return"Math.pow("+this.base.codegen()+", "+this.exp.codegen()+")"}print(){var t=this.base.print();return(this.base instanceof Ge||this.base instanceof Z)&&(t="("+t+")"),t+"^("+this.exp.print()+")"}tex(){if(this.isDivide())return"\\frac{1}{"+this.asDivide().tex()+"}";if(this.isRoot())return this.exp.n!==1&&Ye("Node marked with hint 'root' does not have exponent of form 1/x."),this.exp.d===2?"\\sqrt{"+this.base.tex()+"}":"\\sqrt["+this.exp.d+"]{"+this.base.tex()+"}";if(this.base instanceof J&&!this.base.isInverse()&&this.exp instanceof O&&this.exp.isSimple()&&this.exp.eval()>=0){var t=this.base.tex({split:!0});return t[0]+"^{"+this.exp.tex()+"}"+t[1]}else{var a=this.base.tex();return this.base instanceof Ge||this.base instanceof Z||this.base instanceof O&&!this.base.isSimple()?a="("+a+")":(this.base instanceof J||this.base instanceof fe)&&(a="["+a+"]"),a+"^{"+this.exp.tex()+"}"}}needsExplicitMul(){return this.isRoot()?!1:this.base.needsExplicitMul()}expand(){var t=this.recurse("expand");if(t.base instanceof N){var a=v.map(t.base.terms,function(y){return new Z(y,t.exp)});return new N(a).expand()}else if(t.base instanceof te&&t.exp instanceof _&&t.exp.abs().eval()>1){for(var c=t.exp.eval()>0,o=t.exp.abs().eval(),f=function(y){return c?y:new Z(y,O.Div)},p={1:t.base},g=2;g<=o;g*=2){var d=new N(p[g/2],p[g/2]);p[g]=d.expand().collect()}if(v.has(p,o))return f(p[o]);var m=v.map(o.toString(2).split(""),function(y,E,M){return Number(y)*Math.pow(2,M.length-E-1)});m=v.without(m,0);var d=new N(v.pick(p,m)).expand().collect();return f(d)}else if(t.exp instanceof te){var a=v.map(t.exp.terms,function(E){return new Z(t.base,E).expand()});return new N(a).expand()}else return t}factor(){var t=this.recurse("factor");if(t.base instanceof N){var a=v.map(t.base.terms,function(c){return c instanceof _&&t.exp.equals(O.Div)?new B(1,c.n):new Z(c,t.exp)});return new N(a)}else return t}collect(t){if(this.base instanceof Z){var a=this.base.base,c=N.createOrAppend(this.base.exp,this.exp);return new Z(a,c).collect(t)}var o=this.recurse("collect",t),f=function(E){return E instanceof fe&&E.base.equals(o.base)};if(o.exp instanceof O&&o.exp.eval()===0)return O.One;if(o.exp instanceof O&&o.exp.eval()===1)return o.base;if(f(o.exp))return o.exp.power;if(o.exp instanceof N&&v.any(o.exp.terms,f)){var p=v.find(o.exp.terms,f),a=p.power,c=o.exp.remove(p).flatten();return new Z(a,c).collect(t)}else if(o.base instanceof O&&o.exp instanceof O){if(t&&t.preciseFloats){var c=o.exp.asRational(),g=o.base.getDecimalPlaces(),m=new Z(o.base,new B(1,c.d)),d=m.collect().getDecimalPlaces();if(d>g){var y=new Z(o.base,new _(c.n)).collect();return new Z(y,new B(1,c.d))}}return o.base.raiseToThe(o.exp,t)}else return o}isDivide(){var t=function(a){return a instanceof O&&a.hints.divide};return t(this.exp)||this.exp instanceof N&&v.any(this.exp.terms,t)}asDivide(){if(this.exp instanceof O){if(this.exp.eval()===-1)return this.base;var t=this.exp.negate();return t.hints=v.clone(this.exp.hints),t.hints.divide=!1,new Z(this.base,t)}else{if(this.exp instanceof N)return new Z(this.base,this.exp.factorOut());Ye("called asDivide() on an Expr that wasn't a Num or Mul")}}isRoot(){return this.exp instanceof B&&this.exp.hints.root}isSquaredTrig(){return this.base instanceof J&&!this.base.isInverse()&&this.exp instanceof O&&this.exp.eval()===2}getDenominator(){if(this.exp instanceof O&&this.exp.eval()===-1)return N.createOrAppend(this.base,this.base.getDenominator()).flatten();if(this.exp.isNegative()){var t=new Z(this.base,N.handleNegative(this.exp).collect());return N.createOrAppend(t,t.collect().getDenominator()).flatten()}else return this.base instanceof O?new Z(this.base.getDenominator(),this.exp).collect():O.One}findGCD(t){var a,c;if(t instanceof Z?(a=t.base,c=t.exp):(a=t,c=O.One),this.base.equals(a)){if(this.exp.equals(c))return this;if(this.exp instanceof O&&c instanceof O)return new Z(this.base,O.min(this.exp,c)).collect();if(this.exp instanceof O||c instanceof O)return O.One;var o=this.exp.asMul().partition(),f=c.asMul().partition();if(o[1].equals(f[1])){var p=O.min(o[0].reduce(),f[0].reduce()),g=new N(p,o[1].flatten()).flatten();return new Z(a,g).collect()}}return O.One}isPositive(){if(this.base.isPositive())return!0;var t=this.exp.simplify();return t instanceof _&&t.eval()%2===0}asPositiveFactor(){if(this.isPositive())return this;var t=this.exp.simplify();if(t instanceof _){var a=t.eval();if(a>2)return new Z(this.base,new _(a-1));if(a<-2)return new Z(this.base,new _(a+1))}return O.One}static sqrt(t){return new Z(t,O.Sqrt)}};ne(Z,"nthroot",function(t,a){var c=N.fold(N.handleDivide(new _(1),a));return new Z(t,c.addHint("root"))});let H=Z;class fe extends ge{constructor(t,a){super();ne(this,"func",fe);this.base=t,this.power=a,this.hints=v.extend(this.hints,{open:!1})}args(){return[this.base,this.power]}eval(t,a){return Math.log(this.power.eval(t,a))/Math.log(this.base.eval(t,a))}codegen(){return"(Math.log("+this.power.codegen()+") / Math.log("+this.base.codegen()+"))"}print(){var t="("+this.power.print()+")";return this.isNatural()?"ln"+t:"log_("+this.base.print()+") "+t}tex(){var t="("+this.power.tex()+")";return this.isNatural()?"\\ln"+t:"\\log_{"+this.base.tex()+"}"+t}collect(t){var a=this.recurse("collect",t);return a.power instanceof O&&a.power.eval()===1?O.Zero:a.base.equals(a.power)?O.One:a.power instanceof H&&a.power.base.equals(a.base)?a.power.exp:a}expand(){var t=this.recurse("expand");if(t.power instanceof N){var a=v.map(t.power.terms,function(c){return new fe(t.base,c).expand()});return new te(a)}else return t.power instanceof H?new N(t.power.exp,new fe(t.base,t.power.base).expand()).flatten():t.isNatural()?t:N.handleDivide(new fe(Oe.e,t.power),new fe(Oe.e,t.base))}isPositive(){var t=this.collect();return t.base instanceof O&&t.power instanceof O?this.eval()>0:!1}needsExplicitMul(){return!1}isNatural(){return this.base.equals(Oe.e)}static natural(){return Oe.e}static common(){return O.Ten}static create(t,a){var c=new fe(t,a);return a.hints.parens||(c=c.addHint("open")),c}}class J extends ge{constructor(t,a){super();ne(this,"func",J);ne(this,"functions",{sin:{eval:Math.sin,codegen:"Math.sin((",tex:"\\sin",expand:function(){return this}},cos:{eval:Math.cos,codegen:"Math.cos((",tex:"\\cos",expand:function(){return this}},tan:{eval:Math.tan,codegen:"Math.tan((",tex:"\\tan",expand:function(){return N.handleDivide(J.sin(this.arg),J.cos(this.arg))}},csc:{eval:function(t){return 1/Math.sin(t)},codegen:"(1/Math.sin(",tex:"\\csc",expand:function(){return N.handleDivide(O.One,J.sin(this.arg))}},sec:{eval:function(t){return 1/Math.cos(t)},codegen:"(1/Math.cos(",tex:"\\sec",expand:function(){return N.handleDivide(O.One,J.cos(this.arg))}},cot:{eval:function(t){return 1/Math.tan(t)},codegen:"(1/Math.tan(",tex:"\\cot",expand:function(){return N.handleDivide(J.cos(this.arg),J.sin(this.arg))}},arcsin:{eval:Math.asin,codegen:"Math.asin((",tex:"\\arcsin"},arccos:{eval:Math.acos,codegen:"Math.acos((",tex:"\\arccos"},arctan:{eval:Math.atan,codegen:"Math.atan((",tex:"\\arctan"},arccsc:{eval:function(t){return Math.asin(1/t)},codegen:"Math.asin(1/(",tex:"\\operatorname{arccsc}"},arcsec:{eval:function(t){return Math.acos(1/t)},codegen:"Math.acos(1/(",tex:"\\operatorname{arcsec}"},arccot:{eval:function(t){return Math.atan(1/t)},codegen:"Math.atan(1/(",tex:"\\operatorname{arccot}"},sinh:{eval:function(t){return(Math.exp(t)-Math.exp(-t))/2},codegen:function(t){return"((Math.exp("+t+") - Math.exp(-("+t+"))) / 2)"},tex:"\\sinh",expand:function(){return this}},cosh:{eval:function(t){return(Math.exp(t)+Math.exp(-t))/2},codegen:function(t){return"((Math.exp("+t+") + Math.exp(-("+t+"))) / 2)"},tex:"\\cosh",expand:function(){return this}},tanh:{eval:function(t){return(Math.exp(t)-Math.exp(-t))/(Math.exp(t)+Math.exp(-t))},codegen:function(t){return"((Math.exp("+t+") - Math.exp(-("+t+"))) / (Math.exp("+t+") + Math.exp(-("+t+"))))"},tex:"\\tanh",expand:function(){return N.handleDivide(J.sinh(this.arg),J.cosh(this.arg))}},csch:{eval:function(t){return 2/(Math.exp(t)-Math.exp(-t))},codegen:function(t){return"(2 / (Math.exp("+t+") - Math.exp(-("+t+"))))"},tex:"\\csch",expand:function(){return N.handleDivide(O.One,J.sinh(this.arg))}},sech:{eval:function(t){return 2/(Math.exp(t)+Math.exp(-t))},codegen:function(t){return"(2 / (Math.exp("+t+") + Math.exp(-("+t+"))))"},tex:"\\sech",expand:function(){return N.handleDivide(O.One,J.cosh(this.arg))}},coth:{eval:function(t){return(Math.exp(t)+Math.exp(-t))/(Math.exp(t)-Math.exp(-t))},codegen:function(t){return"((Math.exp("+t+") + Math.exp(-("+t+"))) / (Math.exp("+t+") - Math.exp(-("+t+"))))"},tex:"\\coth",expand:function(){return N.handleDivide(J.cosh(this.arg),J.sinh(this.arg))}}});this.type=t,this.arg=a,this.hints=v.extend(this.hints,{open:!1})}args(){return[this.type,this.arg]}isEven(){return v.contains(["cos","sec"],this.type)}isInverse(){return this.type.indexOf("arc")===0}isBasic(){return v.contains(["sin","cos"],this.type)}eval(t,a){var c=this.functions[this.type].eval,o=this.arg.eval(t,a);return c(o)}codegen(){var t=this.functions[this.type].codegen;if(typeof t=="function")return t(this.arg.codegen());if(typeof t=="string")return t+this.arg.codegen()+"))";throw new Error("codegen not implemented for "+this.type)}print(){return this.type+"("+this.arg.print()+")"}tex(t){var a=this.functions[this.type].tex,c="("+this.arg.tex()+")";return t&&t.split?[a,c]:a+c}isPositive(){var t=this.collect();return t.arg instanceof O?this.eval()>0:!1}completeParse(){if(this.exp){var t=new H(this,this.exp);return this.exp=void 0,t}else return this}needsExplicitMul(){return!1}expand(){var t=this.recurse("expand");if(t.isInverse())return t;var a=t.functions[t.type].expand;return v.bind(a,t)()}collect(t){var a=this.recurse("collect",t);if(!a.isInverse()&&a.arg.isNegative()){var c;return a.arg instanceof O?c=a.arg.abs():c=N.handleDivide(a.arg,O.Neg).collect(t),a.isEven()?new J(a.type,c):new N(O.Neg,new J(a.type,c))}else return a}static create(t,a){var c=t[0],o=t[1];o&&o.equals(O.Neg)&&(c="arc"+c,o=void 0);var f=new J(c,a);return a.hints.parens||(f=f.addHint("open")),o&&(f.exp=o),f}static sin(t){return new J("sin",t)}static cos(t){return new J("cos",t)}static sinh(t){return new J("sinh",t)}static cosh(t){return new J("cosh",t)}}class Fe extends ge{constructor(t){super();ne(this,"func",Fe);this.arg=t}args(){return[this.arg]}eval(t,a){return Math.abs(this.arg.eval(t,a))}codegen(){return"Math.abs("+this.arg.codegen()+")"}print(){return"abs("+this.arg.print()+")"}tex(){return"\\left|"+this.arg.tex()+"\\right|"}collect(t){var a=this.recurse("collect",t);if(a.arg.isPositive())return a.arg;if(a.arg instanceof O)return a.arg.abs();if(a.arg instanceof N){var c=v.groupBy(a.arg.terms,function(f){return f.isPositive()?"positive":f instanceof O?"number":"other"}),o=c.positive.concat(v.invoke(c.number,"abs"));return c.other.length&&o.push(new Fe(new N(c.other).flatten())),new N(o).flatten()}else return a}expand(){var t=this.recurse("expand");if(t.arg instanceof N){var a=v.map(t.arg.terms,function(c){return new Fe(c)});return new N(a)}else return t}isPositive(){return!0}}class Se extends ge{constructor(t,a,c){super();ne(this,"func",Se);ne(this,"signs",{"=":" = ","<":" < ",">":" > ","<>":" \\ne ","<=":" \\le ",">=":" \\ge "});this.left=t,this.type=a,this.right=c}args(){return[this.left,this.type,this.right]}needsExplicitMul(){return!1}print(){return this.left.print()+this.type+this.right.print()}tex(){return this.left.tex()+this.signs[this.type]+this.right.tex()}normalize(){var t=this.recurse("normalize");return v.contains([">",">="],t.type)?new Se(t.right,t.type.replace(">","<"),t.left):t}asExpr(t){var a=function(m){return m instanceof O&&m.isSimple()&&m.eval()===0},c=[];this.left instanceof te?c=v.clone(this.left.terms):a(this.left)||(c=[this.left]),this.right instanceof te?c=c.concat(this.right.negate().terms):a(this.right)||c.push(this.right.negate());var o=!this.isEquality();c=v.invoke(c,"collect",{preciseFloats:!0});for(var f=0;f<c.length;f++){var p=c[f].getDenominator();o&&!p.isPositive()&&(p=p.asPositiveFactor()),p.equals(O.One)||(c=v.map(c,function(m){return N.createOrAppend(m,p).simplify({once:!0,preciseFloats:!0})}))}var g=new te(c).flatten();return t?g:this.divideThrough(g)}divideThrough(t){var a=!this.isEquality(),c=t.simplify({once:!0}),o=c.factor({keepNegative:a});if(!(o instanceof N))return t;var f=o.terms,p=function(w){return w instanceof te},g=function(w){return!!w.getVars().length},m=function(w){return w.equals(O.One)},d=v.groupBy(f,p),y=d[!0]||[],E=d[!1]||[];if(y.length&&this.isEquality())return new N(y).flatten();var M=E;y.length||(M=v.reject(M,g)),a&&(M=v.invoke(M,"asPositiveFactor")),M=v.reject(M,m),M=v.map(M,function(w){return new H(w,O.Div)});var k=new N(f.concat(M)).collect();return k.equals(o)?c:k}isEquality(){return v.contains(["=","<>"],this.type)}compare(t){if(!(t instanceof Se))return!1;var a=this.normalize(),c=t.normalize();if(a.type!==c.type)return!1;var o=a.divideThrough(a.asExpr(!0).collect()),f=c.divideThrough(c.asExpr(!0).collect());return a.isEquality()?o.compare(f)||o.compare(N.handleNegative(f)):o.compare(f)}sameForm(t){var a=this.normalize(),c=t.normalize(),o=a.left.sameForm(c.left)&&a.right.sameForm(c.right);return a.isEquality()?o||a.left.sameForm(c.right)&&a.right.sameForm(c.left):o}isSimplified(){var t=this.asExpr(!0),a=this.divideThrough(t).simplify();return t.equals(a)&&this.left.isSimplified()&&this.right.isSimplified()}solveLinearEquationForVariable(t){var a=this.asExpr();if(!a.is(te)||a.terms.length!==2)throw new Error("Can only handle linear equations of the form a + bx (= 0)");var c=function(p){return p.has(Ce)&&v.contains(p.getVars(),t.symbol)},o,f;return c(a.terms[0])?(o=N.handleNegative(a.terms[1]),f=N.handleDivide(a.terms[0],t)):(o=N.handleNegative(a.terms[0]),f=N.handleDivide(a.terms[1],t)),N.handleDivide(o,f).simplify()}}let Te=class lt extends ge{needsExplicitMul(){return!1}findGCD(s){return s instanceof lt||s instanceof O?this.equals(s)?this:O.One:s.findGCD(this)}};class Me extends Te{constructor(t,a){super();ne(this,"func",Me);this.symbol=t,this.arg=a}args(){return[this.symbol,this.arg]}print(){return this.symbol+"("+this.arg.print()+")"}tex(){return this.symbol+"("+this.arg.tex()+")"}eval(t,a){var c=this.arg,o=t[this.symbol],f=v.extend(v.clone(t),{x:c.eval(t,a)}),p=Pe(o,a);return p.parsed?p.expr.eval(f,a):p}codegen(){return'vars["'+this.symbol+'"]('+this.arg.codegen()+")"}getUnits(){return this.arg.getUnits()}getVars(t){return t?this.arg.getVars():v.union(this.arg.getVars(),[this.symbol]).sort()}getConsts(){return this.arg.getConsts()}}class Ce extends Te{constructor(t,a){super();ne(this,"func",Ce);this.symbol=t,this.subscript=a}args(){return[this.symbol,this.subscript]}exprArgs(){return[]}recurse(){return this}print(){var t="";return this.subscript&&(t="_("+this.subscript.print()+")"),this.symbol+t}prettyPrint(){var t=this.subscript;return t&&(t instanceof O||t instanceof Te)?this.symbol+"_"+t.print():this.print()}tex(){var t="";this.subscript&&(t="_{"+this.subscript.tex()+"}");var a=this.symbol.length>1?"\\":"";return a+this.symbol+t}repr(){return"Var("+this.print()+")"}eval(t,a){return t[this.prettyPrint()]}codegen(){return'vars["'+this.prettyPrint()+'"]'}getVars(){return[this.prettyPrint()]}isPositive(){return!1}}const ke=class ke extends Te{constructor(t){super();ne(this,"func",ke);this.symbol=t}args(){return[this.symbol]}recurse(){return this}eval(t,a){if(this.symbol==="pi")return Math.PI;if(this.symbol==="e")return Math.E}codegen(){if(this.symbol==="pi")return"Math.PI";if(this.symbol==="e")return"Math.E"}print(){return this.symbol}tex(){if(this.symbol==="pi")return"\\pi ";if(this.symbol==="e")return"e"}isPositive(){return this.eval()>0}abs(){return this.eval()>0?this:N.handleNegative(this)}getConsts(){return[this.print()]}};ne(ke,"e",new ke("e")),ne(ke,"pi",new ke("pi"));let Oe=ke;class O extends ge{constructor(){super(),this.hints=v.extend(this.hints,{negate:!1,subtract:!1,divide:!1,root:!1,fraction:!1,entered:!1})}repr(){return this.print()}strip(){return this.abs()}recurse(){return this}codegen(){return this.print()}add(){return le()}mul(){return le()}negate(){return le()}isSubtract(){return this.hints.subtract}abs(){return le()}needsExplicitMul(){return!0}findGCD(){return le()}isPositive(){return this.eval()>0}isNegative(){return this.eval()<0}asPositiveFactor(){return this.isPositive()?this:this.abs()}isSimple(){return le()}getDecimalPlaces(){var s=(""+this.n).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return s?Math.max(0,(s[1]?s[1].length:0)-(s[2]?+s[2]:0)):0}asRational(){return le()}static negativeOne(s){return s==="subtract"?O.Sub:s==="divide"?O.Div:O.Neg}static findGCD(s,t){var a;if(s=Math.abs(s),t=Math.abs(t),s!==Math.floor(s)||t!==Math.floor(t))return 1;for(;t;)a=s%t,s=t,t=a;return s}static min(...s){return v.min(s,function(t){return t.eval()})}static max(...s){return v.max(s,function(t){return t.eval()})}}class B extends O{constructor(t,a){super();ne(this,"func",B);var c=t,o=a;o<0&&(c=-c,o=-o),this.n=c,this.d=o}args(){return[this.n,this.d]}eval(){return this.n/this.d}print(){return this.n.toString()+"/"+this.d.toString()}tex(){var t="\\frac{"+Math.abs(this.n).toString()+"}{"+this.d.toString()+"}";return this.n<0?"-"+t:t}add(t,a){return t instanceof B?new B(this.n*t.d+this.d*t.n,this.d*t.d).collect():t.add(this,a)}mul(t,a){return t instanceof B?new B(this.n*t.n,this.d*t.d).collect():t.mul(this,a)}collect(){var t=O.findGCD(this.n,this.d),a=this.n/t,c=this.d/t;return c===1?new _(a):new B(a,c)}negate(){return new B(-this.n,this.d)}abs(){return new B(Math.abs(this.n),this.d)}findGCD(t){if(t instanceof B){var a=O.findGCD(this.n*t.d,t.n*this.d),c=this.d*t.d;return new B(a,c).collect()}else return t instanceof _?new B(O.findGCD(this.n,t.n),this.d):t.findGCD(this)}raiseToThe(t){if(t instanceof _){var a=t.eval()>0,c=t.abs().eval(),o=Math.pow(this.n,c),f=Math.pow(this.d,c);return a?new B(o,f).collect():new B(f,o).collect()}else return new ue(this.eval()).raiseToThe(t)}getDenominator(){return new _(this.d)}isSimple(){return!1}asRational(){return this}}class _ extends B{constructor(t){super(t,1);ne(this,"func",_)}args(){return[this.n]}print(){return this.n.toString()}tex(){return this.n.toString()}negate(){return new _(-this.n)}abs(){return new _(Math.abs(this.n))}isSimple(){return!0}findGCD(t){return t instanceof _?new _(O.findGCD(this.n,t.n)):t.findGCD(this)}static create(t){return new _(t).addHint("entered")}}class ue extends O{constructor(t){super();ne(this,"func",ue);this.n=t}args(){return[this.n]}eval(){return this.n}print(){return this.n.toString()}tex(){return this.n.toString()}add(t,a){return a&&a.preciseFloats?ue.toDecimalPlaces(this.n+t.eval(),Math.max(this.getDecimalPlaces(),t.getDecimalPlaces())):new ue(this.n+t.eval()).collect()}mul(t,a){return a&&a.preciseFloats?ue.toDecimalPlaces(this.n*t.eval(),this.getDecimalPlaces()+t.getDecimalPlaces()):new ue(this.n*t.eval()).collect()}collect(){return this}negate(){return new ue(-this.n)}abs(){return new ue(Math.abs(this.n))}findGCD(t){return t instanceof O?new ue(O.findGCD(this.eval(),t.eval())).collect():t.findGCD(this)}raiseToThe(t,a){return a&&a.preciseFloats&&t instanceof _&&t.n>1?ue.toDecimalPlaces(new H(this,t).eval(),this.getDecimalPlaces()*t.n):new ue(new H(this,t).eval()).collect()}asRational(){var t=this.n.toString().split(".");if(t.length===1)return new B(this.n,1);var a=Number(t.join("")),c=Math.pow(10,t[1].length);return new B(a,c).collect()}getDenominator(){return this.asRational().getDenominator()}isSimple(){return!0}static create(t){return new ue(t).addHint("entered")}static toDecimalPlaces(t,a){return new ue(+t.toFixed(Math.min(a,20))).collect()}}O.Neg=new _(-1).addHint("negate");O.Sub=new _(-1).addHint("subtract");O.Div=new _(-1).addHint("divide");O.Sqrt=new B(1,2).addHint("root");O.Zero=new _(0);O.One=new _(1);O.Ten=new _(10);te.prototype.identity=O.Zero;N.prototype.identity=O.One;var bt=function(u,s){throw new Error(s.loc.first_column)};Ae.yy={Add:te,Mul:N,Pow:H,Log:fe,Trig:J,Eq:Se,Abs:Fe,Func:Me,Const:Oe,Var:Ce,Int:_,Float:ue,parseError:bt,constants:["e"],symbolLexer:function(u){return v.contains(Ae.yy.constants,u)?"CONST":v.contains(Ae.yy.functions,u)?"FUNC":"VAR"}};const Pe=function(u,s){try{s&&s.functions?Ae.yy.functions=v.without(s.functions,"i"):Ae.yy.functions=[],s&&s.decimal_separator&&(u=u.split(s.decimal_separator).join("."));var t=Ae.parse(u).completeParse();return{parsed:!0,expr:t}}catch(a){return{parsed:!1,error:a.message}}};class oe extends Te{constructor(t){super();ne(this,"func",oe);this.symbol=t}args(){return[this.symbol]}recurse(){return this}eval(t,a){return 1}getUnits(){return[{unit:this.symbol,pow:1}]}codegen(){return"1"}print(){return this.symbol}tex(){return this.symbol}collect(t){if(v(Nt).has(this.symbol))return this;if(v(et).has(this.symbol))return et[this.symbol].conversion;throw new Error("could not understand unit: "+this.symbol)}}var Nt={m:new oe("m"),g:new oe("g"),s:new oe("s"),A:new oe("A"),K:new oe("K"),mol:new oe("mol"),cd:new oe("cd")};new H(new _(10),new _(-18)),new H(new _(10),new _(-15)),new H(new _(10),new _(-12)),new H(new _(10),new _(-9)),new H(new _(10),new _(-6)),new H(new _(10),new _(-3)),new H(new _(10),new _(-2)),new H(new _(10),new _(-1)),new _(10),new H(new _(10),new _(2)),new H(new _(10),new _(3)),new H(new _(10),new _(6)),new H(new _(10),new _(9)),new H(new _(10),new _(12)),new H(new _(10),new _(15)),new H(new _(10),new _(18)),new H(new _(10),new _(27));var ee={},T={},b=function(u,s){var t=u.split("|"),a=t[0].trim(),c=t[1].trim(),o=O.One;a!==""&&(o=Pe(a).expr);var f=c.split("/"),p=[o];return f[0]&&f[0].split(" ").filter(function(g){return g!==""}).map(function(g){p.push(new oe(g))}),f[1]&&f[1].split(" ").filter(function(g){return g!==""}).map(function(g){p.push(new H(new oe(g),O.Div))}),{conversion:new N(p),prefixes:s}},et={Da:b("1.6605388628 x 10^-24 | g",ee),u:b("| Da",T),meter:b("| m",T),meters:b("| m",T),in:b("254 / 10000 | m",T),ft:b("3048  / 10000 | m",T),yd:b("9144  / 10000 | m",T),mi:b("1609344 / 1000 | m",T),ly:b("9.4607 x 10^15 | m",T),nmi:b("1852 | m",T),Å:b("10^-10 | m",T),pc:b("3.0857 x 10^16 | m",T),min:b("60 | s",T),hr:b("3600 | s",T),sec:b("| s",T),day:b("86400 | s",T),wk:b("604800 | s",T),fortnight:b("14 | day",T),shake:b("10^-8 | s",T),olympiad:b("126200000 | s",T),"°C":b("1 | K",T),"°F":b("5/9 | K",T),"°R":b("5/9 | K",T),e:b("1.6021765314 x 10^-19 | C",T),c:b("299792458 | m / s",T),kn:b("514/1000 | m / s",T),kt:b("| kn",T),knot:b("| kn",T),J:b("| N m",ee),BTU:b("1060 | J",T),cal:b("4184 / 1000 | J",ee),eV:b("1.602176514 x 10^-19 | J",ee),erg:b("10^−7 | J",ee),W:b("| J / s",ee),"H-e":b("80 | W",T),N:b("1000 | g m / s s",ee),lb:b("4448221615 / 1000000000 | N",T),dyn:b("10^-5 | N",T),Pa:b("1 | N / m m m",ee),bar:b("10^5 | Pa",ee),"㏔":b("1/1000 | bar",T),"㍴":b("| bar",T),atm:b("101325 | Pa",T),Torr:b("1/760 | atm",T),mmHg:b("| Torr",T),ha:b("10^4 | m m",T),b:b("10^−28 | m m",ee),barn:b("| b",ee),acre:b("4046.87 | m m",T),skilodge:b("10^-31 | m m",T),outhouse:b("10^-34 | m m",T),shed:b("10^-52 | m m",T),L:b("1/1000 | m m m",ee),gal:b("3785/1000 | L",ee),cup:b("1/16 | gal",T),qt:b("1/4 | gal",T),quart:b("| qt",T),p:b("1/8 | gal",T),pt:b("| p",T),pint:b("| p",T),"fl oz":b("1/8 | cup",T),"fl. oz.":b("1/8 | cup",T),tbsp:b("1/16 | cup",T),tsp:b("1/3 | tbsp",T),rev:b("2 pi | rad",T),deg:b("180 pi | rad",T),"°":b("| deg",T),arcminute:b("1/60 | deg",T),arcsec:b("1/3600 | deg",T),Hu:b("1000 | dB",ee),dozen:b("12 |",T),mol:b("6.0221412927 x 10^23 |",ee),"%":b("1/100 |",T),percent:b("| %",T),ppm:b("1/1000000 |",T),V:b("1000 | g m m / s s C",ee),C:b("| A s",ee),ampere:b("| A",T),Ω:b("| V / A",ee),ohm:b("| Ω",T),F:b("| C / V",ee),H:b("| ohm s",ee),T:b("1000 | g / C s",ee),Wb:b("1000 | g m m / C s",ee),lm:b("pi x 10^4 | cd / m m",T),lx:b("| lm / m m",T),nit:b("| cd / m m",T),sb:b("10^4 | cd / m m",T),stilb:b("1 | sb",T),apostilb:b("1 / pi x 10^(-4) | sb",T),blondel:b("| apostilb",T),asb:b("| apostilb",T),la:b("| lm",T),Lb:b("| lm",T),sk:b("10^-7 | lm",T),skot:b("| sk",T),bril:b("10^-11 | lm",T),Hz:b("| / s",ee)};O.Zero;O.One;const tt=function(u,s,t){t={...{form:!1,simplify:!1},...t};const c=u.sameVars(s);if(!c.equal){let o;return c.equalIgnoringCase?o="Check your variables; one or more are using the wrong case (upper or lower).":o="Check your variables; you may have used the wrong letter for one or more of them.",{equal:!1,wrongVariableCase:c.equalIgnoringCase,wrongVariableNames:!c.equalIgnoringCase,message:o}}return u.compare(s)?t.form&&!u.sameForm(s)?{equal:!1,message:"Your answer is not in the correct form."}:t.simplify&&!u.isSimplified()?{equal:!1,message:"Your answer is not fully expanded and simplified."}:{equal:!0,message:null}:{equal:!1,message:null}},At="@khanacademy/kmath",St="__lib_version__";at(At,St);var Ue={exports:{}};(function(u,s){(function(){var t=this,a=t._,c={},o=Array.prototype,f=Object.prototype,p=Function.prototype,g=o.push,m=o.slice,d=o.concat,y=f.toString,E=f.hasOwnProperty,M=o.forEach,k=o.map,w=o.reduce,q=o.reduceRight,A=o.filter,U=o.every,Y=o.some,ie=o.indexOf,he=o.lastIndexOf,K=Array.isArray,j=Object.keys,se=p.bind,r=function(e){if(e instanceof r)return e;if(!(this instanceof r))return new r(e);this._wrapped=e};u.exports&&(s=u.exports=r),s._=r,r.VERSION="1.4.4";var z=r.each=r.forEach=function(e,n,i){if(e!=null){if(M&&e.forEach===M)e.forEach(n,i);else if(e.length===+e.length){for(var l=0,h=e.length;l<h;l++)if(n.call(i,e[l],l,e)===c)return}else for(var I in e)if(r.has(e,I)&&n.call(i,e[I],I,e)===c)return}};r.map=r.collect=function(e,n,i){var l=[];return e==null?l:k&&e.map===k?e.map(n,i):(z(e,function(h,I,x){l[l.length]=n.call(i,h,I,x)}),l)};var me="Reduce of empty array with no initial value";r.reduce=r.foldl=r.inject=function(e,n,i,l){var h=arguments.length>2;if(e==null&&(e=[]),w&&e.reduce===w)return l&&(n=r.bind(n,l)),h?e.reduce(n,i):e.reduce(n);if(z(e,function(I,x,P){h?i=n.call(l,i,I,x,P):(i=I,h=!0)}),!h)throw new TypeError(me);return i},r.reduceRight=r.foldr=function(e,n,i,l){var h=arguments.length>2;if(e==null&&(e=[]),q&&e.reduceRight===q)return l&&(n=r.bind(n,l)),h?e.reduceRight(n,i):e.reduceRight(n);var I=e.length;if(I!==+I){var x=r.keys(e);I=x.length}if(z(e,function(P,D,W){D=x?x[--I]:--I,h?i=n.call(l,i,e[D],D,W):(i=e[D],h=!0)}),!h)throw new TypeError(me);return i},r.find=r.detect=function(e,n,i){var l;return X(e,function(h,I,x){if(n.call(i,h,I,x))return l=h,!0}),l},r.filter=r.select=function(e,n,i){var l=[];return e==null?l:A&&e.filter===A?e.filter(n,i):(z(e,function(h,I,x){n.call(i,h,I,x)&&(l[l.length]=h)}),l)},r.reject=function(e,n,i){return r.filter(e,function(l,h,I){return!n.call(i,l,h,I)},i)},r.every=r.all=function(e,n,i){n||(n=r.identity);var l=!0;return e==null?l:U&&e.every===U?e.every(n,i):(z(e,function(h,I,x){if(!(l=l&&n.call(i,h,I,x)))return c}),!!l)};var X=r.some=r.any=function(e,n,i){n||(n=r.identity);var l=!1;return e==null?l:Y&&e.some===Y?e.some(n,i):(z(e,function(h,I,x){if(l||(l=n.call(i,h,I,x)))return c}),!!l)};r.contains=r.include=function(e,n){return e==null?!1:ie&&e.indexOf===ie?e.indexOf(n)!=-1:X(e,function(i){return i===n})},r.invoke=function(e,n){var i=m.call(arguments,2),l=r.isFunction(n);return r.map(e,function(h){return(l?n:h[n]).apply(h,i)})},r.pluck=function(e,n){return r.map(e,function(i){return i[n]})},r.where=function(e,n,i){return r.isEmpty(n)?i?null:[]:r[i?"find":"filter"](e,function(l){for(var h in n)if(n[h]!==l[h])return!1;return!0})},r.findWhere=function(e,n){return r.where(e,n,!0)},r.max=function(e,n,i){if(!n&&r.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!n&&r.isEmpty(e))return-1/0;var l={computed:-1/0,value:-1/0};return z(e,function(h,I,x){var P=n?n.call(i,h,I,x):h;P>=l.computed&&(l={value:h,computed:P})}),l.value},r.min=function(e,n,i){if(!n&&r.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!n&&r.isEmpty(e))return 1/0;var l={computed:1/0,value:1/0};return z(e,function(h,I,x){var P=n?n.call(i,h,I,x):h;P<l.computed&&(l={value:h,computed:P})}),l.value},r.shuffle=function(e){var n,i=0,l=[];return z(e,function(h){n=r.random(i++),l[i-1]=l[n],l[n]=h}),l};var Q=function(e){return r.isFunction(e)?e:function(n){return n[e]}};r.sortBy=function(e,n,i){var l=Q(n);return r.pluck(r.map(e,function(h,I,x){return{value:h,index:I,criteria:l.call(i,h,I,x)}}).sort(function(h,I){var x=h.criteria,P=I.criteria;if(x!==P){if(x>P||x===void 0)return 1;if(x<P||P===void 0)return-1}return h.index<I.index?-1:1}),"value")};var F=function(e,n,i,l){var h={},I=Q(n||r.identity);return z(e,function(x,P){var D=I.call(i,x,P,e);l(h,D,x)}),h};r.groupBy=function(e,n,i){return F(e,n,i,function(l,h,I){(r.has(l,h)?l[h]:l[h]=[]).push(I)})},r.countBy=function(e,n,i){return F(e,n,i,function(l,h){r.has(l,h)||(l[h]=0),l[h]++})},r.sortedIndex=function(e,n,i,l){i=i==null?r.identity:Q(i);for(var h=i.call(l,n),I=0,x=e.length;I<x;){var P=I+x>>>1;i.call(l,e[P])<h?I=P+1:x=P}return I},r.toArray=function(e){return e?r.isArray(e)?m.call(e):e.length===+e.length?r.map(e,r.identity):r.values(e):[]},r.size=function(e){return e==null?0:e.length===+e.length?e.length:r.keys(e).length},r.first=r.head=r.take=function(e,n,i){if(e!=null)return n!=null&&!i?m.call(e,0,n):e[0]},r.initial=function(e,n,i){return m.call(e,0,e.length-(n==null||i?1:n))},r.last=function(e,n,i){if(e!=null)return n!=null&&!i?m.call(e,Math.max(e.length-n,0)):e[e.length-1]},r.rest=r.tail=r.drop=function(e,n,i){return m.call(e,n==null||i?1:n)},r.compact=function(e){return r.filter(e,r.identity)};var G=function(e,n,i){return z(e,function(l){r.isArray(l)?n?g.apply(i,l):G(l,n,i):i.push(l)}),i};r.flatten=function(e,n){return G(e,n,[])},r.without=function(e){return r.difference(e,m.call(arguments,1))},r.uniq=r.unique=function(e,n,i,l){r.isFunction(n)&&(l=i,i=n,n=!1);var h=i?r.map(e,i,l):e,I=[],x=[];return z(h,function(P,D){(n?!D||x[x.length-1]!==P:!r.contains(x,P))&&(x.push(P),I.push(e[D]))}),I},r.union=function(){return r.uniq(d.apply(o,arguments))},r.intersection=function(e){var n=m.call(arguments,1);return r.filter(r.uniq(e),function(i){return r.every(n,function(l){return r.indexOf(l,i)>=0})})},r.difference=function(e){var n=d.apply(o,m.call(arguments,1));return r.filter(e,function(i){return!r.contains(n,i)})},r.zip=function(){for(var e=m.call(arguments),n=r.max(r.pluck(e,"length")),i=new Array(n),l=0;l<n;l++)i[l]=r.pluck(e,""+l);return i},r.object=function(e,n){if(e==null)return{};for(var i={},l=0,h=e.length;l<h;l++)n?i[e[l]]=n[l]:i[e[l][0]]=e[l][1];return i},r.indexOf=function(e,n,i){if(e==null)return-1;var l=0,h=e.length;if(i)if(typeof i=="number")l=i<0?Math.max(0,h+i):i;else return l=r.sortedIndex(e,n),e[l]===n?l:-1;if(ie&&e.indexOf===ie)return e.indexOf(n,i);for(;l<h;l++)if(e[l]===n)return l;return-1},r.lastIndexOf=function(e,n,i){if(e==null)return-1;var l=i!=null;if(he&&e.lastIndexOf===he)return l?e.lastIndexOf(n,i):e.lastIndexOf(n);for(var h=l?i:e.length;h--;)if(e[h]===n)return h;return-1},r.range=function(e,n,i){arguments.length<=1&&(n=e||0,e=0),i=arguments[2]||1;for(var l=Math.max(Math.ceil((n-e)/i),0),h=0,I=new Array(l);h<l;)I[h++]=e,e+=i;return I},r.bind=function(e,n){if(e.bind===se&&se)return se.apply(e,m.call(arguments,1));var i=m.call(arguments,2);return function(){return e.apply(n,i.concat(m.call(arguments)))}},r.partial=function(e){var n=m.call(arguments,1);return function(){return e.apply(this,n.concat(m.call(arguments)))}},r.bindAll=function(e){var n=m.call(arguments,1);return n.length===0&&(n=r.functions(e)),z(n,function(i){e[i]=r.bind(e[i],e)}),e},r.memoize=function(e,n){var i={};return n||(n=r.identity),function(){var l=n.apply(this,arguments);return r.has(i,l)?i[l]:i[l]=e.apply(this,arguments)}},r.delay=function(e,n){var i=m.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},n)},r.defer=function(e){return r.delay.apply(r,[e,1].concat(m.call(arguments,1)))},r.throttle=function(e,n){var i,l,h,I,x=0,P=function(){x=new Date,h=null,I=e.apply(i,l)};return function(){var D=new Date,W=n-(D-x);return i=this,l=arguments,W<=0?(clearTimeout(h),h=null,x=D,I=e.apply(i,l)):h||(h=setTimeout(P,W)),I}},r.debounce=function(e,n,i){var l,h;return function(){var I=this,x=arguments,P=function(){l=null,i||(h=e.apply(I,x))},D=i&&!l;return clearTimeout(l),l=setTimeout(P,n),D&&(h=e.apply(I,x)),h}},r.once=function(e){var n=!1,i;return function(){return n||(n=!0,i=e.apply(this,arguments),e=null),i}},r.wrap=function(e,n){return function(){var i=[e];return g.apply(i,arguments),n.apply(this,i)}},r.compose=function(){var e=arguments;return function(){for(var n=arguments,i=e.length-1;i>=0;i--)n=[e[i].apply(this,n)];return n[0]}},r.after=function(e,n){return e<=0?n():function(){if(--e<1)return n.apply(this,arguments)}},r.keys=j||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var n=[];for(var i in e)r.has(e,i)&&(n[n.length]=i);return n},r.values=function(e){var n=[];for(var i in e)r.has(e,i)&&n.push(e[i]);return n},r.pairs=function(e){var n=[];for(var i in e)r.has(e,i)&&n.push([i,e[i]]);return n},r.invert=function(e){var n={};for(var i in e)r.has(e,i)&&(n[e[i]]=i);return n},r.functions=r.methods=function(e){var n=[];for(var i in e)r.isFunction(e[i])&&n.push(i);return n.sort()},r.extend=function(e){return z(m.call(arguments,1),function(n){if(n)for(var i in n)e[i]=n[i]}),e},r.pick=function(e){var n={},i=d.apply(o,m.call(arguments,1));return z(i,function(l){l in e&&(n[l]=e[l])}),n},r.omit=function(e){var n={},i=d.apply(o,m.call(arguments,1));for(var l in e)r.contains(i,l)||(n[l]=e[l]);return n},r.defaults=function(e){return z(m.call(arguments,1),function(n){if(n)for(var i in n)e[i]==null&&(e[i]=n[i])}),e},r.clone=function(e){return r.isObject(e)?r.isArray(e)?e.slice():r.extend({},e):e},r.tap=function(e,n){return n(e),e};var S=function(e,n,i,l){if(e===n)return e!==0||1/e==1/n;if(e==null||n==null)return e===n;e instanceof r&&(e=e._wrapped),n instanceof r&&(n=n._wrapped);var h=y.call(e);if(h!=y.call(n))return!1;switch(h){case"[object String]":return e==String(n);case"[object Number]":return e!=+e?n!=+n:e==0?1/e==1/n:e==+n;case"[object Date]":case"[object Boolean]":return+e==+n;case"[object RegExp]":return e.source==n.source&&e.global==n.global&&e.multiline==n.multiline&&e.ignoreCase==n.ignoreCase}if(typeof e!="object"||typeof n!="object")return!1;for(var I=i.length;I--;)if(i[I]==e)return l[I]==n;i.push(e),l.push(n);var x=0,P=!0;if(h=="[object Array]"){if(x=e.length,P=x==n.length,P)for(;x--&&(P=S(e[x],n[x],i,l)););}else{var D=e.constructor,W=n.constructor;if(D!==W&&!(r.isFunction(D)&&D instanceof D&&r.isFunction(W)&&W instanceof W))return!1;for(var $ in e)if(r.has(e,$)&&(x++,!(P=r.has(n,$)&&S(e[$],n[$],i,l))))break;if(P){for($ in n)if(r.has(n,$)&&!x--)break;P=!x}}return i.pop(),l.pop(),P};r.isEqual=function(e,n){return S(e,n,[],[])},r.isEmpty=function(e){if(e==null)return!0;if(r.isArray(e)||r.isString(e))return e.length===0;for(var n in e)if(r.has(e,n))return!1;return!0},r.isElement=function(e){return!!(e&&e.nodeType===1)},r.isArray=K||function(e){return y.call(e)=="[object Array]"},r.isObject=function(e){return e===Object(e)},z(["Arguments","Function","String","Number","Date","RegExp"],function(e){r["is"+e]=function(n){return y.call(n)=="[object "+e+"]"}}),r.isArguments(arguments)||(r.isArguments=function(e){return!!(e&&r.has(e,"callee"))}),typeof/./!="function"&&(r.isFunction=function(e){return typeof e=="function"}),r.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},r.isNaN=function(e){return r.isNumber(e)&&e!=+e},r.isBoolean=function(e){return e===!0||e===!1||y.call(e)=="[object Boolean]"},r.isNull=function(e){return e===null},r.isUndefined=function(e){return e===void 0},r.has=function(e,n){return E.call(e,n)},r.noConflict=function(){return t._=a,this},r.identity=function(e){return e},r.times=function(e,n,i){for(var l=Array(e),h=0;h<e;h++)l[h]=n.call(i,h);return l},r.random=function(e,n){return n==null&&(n=e,e=0),e+Math.floor(Math.random()*(n-e+1))};var R={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};R.unescape=r.invert(R.escape);var L={escape:new RegExp("["+r.keys(R.escape).join("")+"]","g"),unescape:new RegExp("("+r.keys(R.unescape).join("|")+")","g")};r.each(["escape","unescape"],function(e){r[e]=function(n){return n==null?"":(""+n).replace(L[e],function(i){return R[e][i]})}}),r.result=function(e,n){if(e==null)return null;var i=e[n];return r.isFunction(i)?i.call(e):i},r.mixin=function(e){z(r.functions(e),function(n){var i=r[n]=e[n];r.prototype[n]=function(){var l=[this._wrapped];return g.apply(l,arguments),ye.call(this,i.apply(r,l))}})};var V=0;r.uniqueId=function(e){var n=++V+"";return e?e+n:n},r.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var ce=/(.)^/,C={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},pe=/\\|'|\r|\n|\t|\u2028|\u2029/g;r.template=function(e,n,i){var l;i=r.defaults({},i,r.templateSettings);var h=new RegExp([(i.escape||ce).source,(i.interpolate||ce).source,(i.evaluate||ce).source].join("|")+"|$","g"),I=0,x="__p+='";e.replace(h,function(D,W,$,we,ve){return x+=e.slice(I,ve).replace(pe,function(Ee){return"\\"+C[Ee]}),W&&(x+=`'+
((__t=(`+W+`))==null?'':_.escape(__t))+
'`),$&&(x+=`'+
((__t=(`+$+`))==null?'':__t)+
'`),we&&(x+=`';
`+we+`
__p+='`),I=ve+D.length,D}),x+=`';
`,i.variable||(x=`with(obj||{}){
`+x+`}
`),x=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+x+`return __p;
`;try{l=new Function(i.variable||"obj","_",x)}catch(D){throw D.source=x,D}if(n)return l(n,r);var P=function(D){return l.call(this,D,r)};return P.source="function("+(i.variable||"obj")+`){
`+x+"}",P},r.chain=function(e){return r(e).chain()};var ye=function(e){return this._chain?r(e).chain():e};r.mixin(r),z(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var n=o[e];r.prototype[e]=function(){var i=this._wrapped;return n.apply(i,arguments),(e=="shift"||e=="splice")&&i.length===0&&delete i[0],ye.call(this,i)}}),z(["concat","join","slice"],function(e){var n=o[e];r.prototype[e]=function(){return ye.call(this,n.apply(this._wrapped,arguments))}}),r.extend(r.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(ut)})(Ue,Ue.exports);var Ft=Ue.exports;const nt=ct(Ft),Pt=1e-9,Tt=Math.pow(2,-42);function wn(u){return nt.isNumber(u)&&!nt.isNaN(u)}function Re(u,s,t){return u==null||s==null?u===s:u===s?!0:(t==null&&(t=Pt),Math.abs(u-s)<t)}function xn(u,s){return Re(u,0,s)?0:Math.abs(u)/u}function Rt(u,s){return Re(Math.round(u),u,s)}function In(u,s){const t=Math.pow(10,s);return Math.round(u*t)/t}function En(u,s){return Math.round(u/s)*s}function Mn(u,s){return Math.floor(u/s)*s}function kn(u,s){return Math.ceil(u/s)*s}function rt(u,s=Tt,t=1e3){let a=[1,0],c=[0,1],o=Math.floor(u),f=u-o;for(;c[0]<=t;){if(Re(a[0]/c[0],u,s))return[a[0],c[0]];a=[o*a[0]+a[1],a[0]],c=[o*c[0]+c[1],c[0]],o=Math.floor(1/f),f=1/f-o}return[u,1]}const ae={cleanMath:function(u){return typeof u=="string"?u.replace(/\+\s*-/g,"- ").replace(/-\s*-/g,"+ ").replace(/\^1/g,""):u},bound:function(u){return u===0?u:u<0?-ae.bound(-u):Math.max(1e-6,Math.min(u,1e20))},factorial:function(u){return u<=1?u:u*ae.factorial(u-1)},getGCD:function(u,s){if(arguments.length>2){const a=[].slice.call(arguments,1);return ae.getGCD(u,ae.getGCD(...a))}let t;for(u=Math.abs(u),s=Math.abs(s);s;)t=u%s,u=s,s=t;return u},getLCM:function(u,s){if(arguments.length>2){const t=[].slice.call(arguments,1);return ae.getLCM(u,ae.getLCM(...t))}return Math.abs(u*s)/ae.getGCD(u,s)},primes:[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97],isPrime:function(u){if(u<=1)return!1;if(u<101)return!!de.grep(ae.primes,function(s,t){return Math.abs(s-u)<=.5}).length;if(u<=1||u>2&&u%2===0)return!1;for(let s=3,t=Math.sqrt(u);s<=t;s+=2)if(u%s===0)return!1;return!0},getPrimeFactorization:function(u){if(u===1)return[];if(ae.isPrime(u))return[u];const s=Math.sqrt(u);for(let t=2;t<=s;t++)if(u%t===0)return de.merge(ae.getPrimeFactorization(t),ae.getPrimeFactorization(u/t))},roundToNearest:function(u,s){return Math.round(s/u)*u},roundTo:function(u,s){const t=Math.pow(10,u).toFixed(5);return Math.round((s*t).toFixed(5))/t},toFixedApprox:function(u,s){const t=u.toFixed(s);return Re(+t,u)?t:"\\approx "+t},roundToApprox:function(u,s){const t=ae.roundTo(s,u);return Re(t,u)?String(t):ae.toFixedApprox(u,s)},toFraction:function(u,s){if(s==null&&(s=Math.pow(2,-46)),u<0||u>1){let g=u%1;g+=g<0?1:0;const m=ae.toFraction(g,s);return m[0]+=Math.round(u-g)*m[1],m}if(Math.abs(Math.round(Number(u))-u)<=s)return[Math.round(u),1];let t=0,a=1,c=1,o=1,f=1,p=2;for(;;){if(Math.abs(Number(f/p)-u)<=s)return[f,p];f/p<u?(t=f,a=p):(c=f,o=p),f=t+c,p=a+o}},getNumericFormat:function(u){if(u=de.trim(u),u=u.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1"),u.match(/^[+-]?\d+$/))return"integer";if(u.match(/^[+-]?\d+\s+\d+\s*\/\s*\d+$/))return"mixed";const s=u.match(/^[+-]?(\d+)\s*\/\s*(\d+)$/);return s?parseFloat(s[1])>parseFloat(s[2])?"improper":"proper":u.replace(/[,. ]/g,"").match(/^\d+$/)?"decimal":u.match(/(pi?|\u03c0|t(?:au)?|\u03c4|pau)/)?"pi":null},toNumericString:function(u,s){if(u==null)return"";if(u===0)return"0";if(s==="percent")return u*100+"%";if(s==="pi"){const t=rt(u/Math.PI),a=Math.abs(t[0]),c=t[1];if(Rt(a))return(u<0?"-":"")+(a===1?"":a)+"π"+(c===1?"":"/"+c)}if(re(["proper","improper","mixed","fraction"]).contains(s)){const t=rt(u),a=Math.abs(t[0]),c=t[1],o=u<0?"-":"";if(c===1)return o+a;if(s==="mixed"){const f=a%c,p=(a-f)/c;return o+(p?p+" ":"")+f+"/"+c}return o+a+"/"+c}return String(u)}};function On(u){return u.reduce(Dt,0)}function Dt(u,s){return u+s}const _t=Math.pow(2,-42),Ne={predicate:{defaultForms:"integer, proper, improper, mixed, decimal",createValidatorFunctional:function(u,s,t){s=re.extend({simplify:"required",ratio:!1,forms:Ne.predicate.defaultForms},s);let a;re.isArray(s.forms)?a=s.forms:a=s.forms.split(/\s*,\s*/),s.inexact===void 0&&(s.maxError=0),s.maxError=+s.maxError+_t,re.contains(a,"percent")&&(a=re.without(a,"percent"),a.push("percent"));const c=function(f){f=f.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").replace(/(^\s*)|(\s*$)/gi,"");const p=f.match(/^([+-]?\d+)\s*\/\s*([+-]?\d+)$/),g=f.match(/^([+-]?)\\frac\{([+-]?\d+)\}\{([+-]?\d+)\}$/),m=parseInt(f,10);if(p||g){let d,y,E=!0;return p?(d=parseFloat(p[1]),y=parseFloat(p[2])):(d=parseFloat(g[2]),g[1]==="-"&&(d<0&&(E=!1),d=-d),y=parseFloat(g[3])),E=E&&y>0&&(s.ratio||y!==1)&&ae.getGCD(d,y)===1,[{value:d/y,exact:E}]}return!isNaN(m)&&""+m===f?[{value:m,exact:!0}]:[]},o={integer:function(f){const p=o.decimal(f),g=o.decimal(f,1);return p[0].value!=null&&p[0].value===g[0].value||p[1].value!=null&&p[1].value===g[1].value?p:[]},proper:function(f){return de.map(c(f),function(p){return Math.abs(p.value)<1?[p]:[]})},improper:function(f){return de.map(c(f),function(p){return Math.abs(p.value)>=1?[p]:[]})},pi:function(f){let p,g=[];if(f=f.replace(/\u2212/,"-"),p=f.match(/^([+-]?)\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i))g=[{value:parseFloat(p[1]+"1"),exact:!0}];else if(p=f.match(/^([+-]?\s*\d+\s*(?:\/\s*[+-]?\s*\d+)?)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i))g=c(p[1]);else if(p=f.match(/^([+-]?)\s*(\d+)\s*([+-]?\d+)\s*\/\s*([+-]?\d+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i)){const d=parseFloat(p[1]+"1"),y=parseFloat(p[2]),E=parseFloat(p[3]),M=parseFloat(p[4]),k=E<M&&ae.getGCD(E,M)===1;g=[{value:d*(y+E/M),exact:k}]}else if(p=f.match(/^([+-]?\s*\d+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)\s*(?:\/\s*([+-]?\s*\d+))?$/i))g=c(p[1]+"/"+p[3]);else if(p=f.match(/^([+-]?)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)\s*(?:\/\s*([+-]?\d+))?$/i))g=c(p[1]+"1/"+p[3]);else if(f==="0")g=[{value:0,exact:!0}];else if(p=f.match(/^(.+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i))g=o.decimal(p[1]);else{g=re.reduce(Ne.predicate.defaultForms.split(/\s*,\s*/),function(E,M){return E.concat(o[M](f))},[]);let d=!1;const y=parseFloat(f);if(!isNaN(y)&&y!==parseInt(f)){const E=Math.PI/12,M=E*Math.round(y/E);Math.abs(y-M)<.01&&(d=!0)}else f.match(/\/\s*7/)&&(d=!0);return d&&re.each(g,function(E){E.piApprox=!0}),g}let m=Math.PI;return f.match(/\\?tau|t|\u03c4/)&&(m=Math.PI*2),f.match(/pau/)&&(m=Math.PI*1.5),de.each(g,function(d,y){y.value*=m}),g},coefficient:function(f){let p=[];return f=f.replace(/\u2212/,"-"),f===""?p=[{value:1,exact:!0}]:f==="-"&&(p=[{value:-1,exact:!0}]),p},log:function(f){let p,g=[];return f=f.replace(/\u2212/,"-"),f=f.replace(/[ \(\)]/g,""),(p=f.match(/^log\s*(\S+)\s*$/i))?g=o.decimal(p[1]):f==="0"&&(g=[{value:0,exact:!0}]),g},percent:function(f){f=de.trim(f);let p=!1;f.indexOf("%")===f.length-1&&(f=de.trim(f.substring(0,f.length-1)),p=!0);const g=o.decimal(f);return de.each(g,function(m,d){d.exact=p,d.value=d.value/100}),g},mixed:function(f){const p=f.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").match(/^([+-]?)(\d+)\s+(\d+)\s*\/\s*(\d+)$/);if(p){const g=parseFloat(p[1]+"1"),m=parseFloat(p[2]),d=parseFloat(p[3]),y=parseFloat(p[4]),E=d<y&&ae.getGCD(d,y)===1;return[{value:g*(m+d/y),exact:E}]}return[]},decimal:function(f,p=1e10){const g=function(d){d=de.trim(d);const y=d.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").match(/^([+-]?(?:\d{1,3}(?:[, ]?\d{3})*\.?|\d{0,3}(?:[, ]?\d{3})*\.(?:\d{3}[, ]?)*\d{1,3}))$/),E=d.match(/^0[0,]*,/);if(y&&!E){let M=parseFloat(y[1].replace(/[, ]/g,""));return s.inexact===void 0&&(M=Math.round(M*p)/p),M}},m=function(d){return d=d.replace(/([\.,])/g,function(y,E){return E==="."?",":"."}),g(d)};return[{value:g(f),exact:!0},{value:m(f),exact:!0}]}};return function(f){const p=s.fallback!=null?""+s.fallback:"";f=de.trim(f)||p;const g={empty:f==="",correct:!1,message:null,guess:f};if(de.each(a,function(m,d){const y=o[d](f);for(let E=0,M=y.length;E<M;E++){const k=y[E].value,w=y[E].exact,q=y[E].piApprox;if(u(k,s.maxError))return w||s.simplify==="optional"?(g.correct=!0,g.message=s.message||null,g.empty=!1):d==="percent"?(g.empty=!0,g.message=t.MISSING_PERCENT_ERROR):(s.simplify!=="enforced"&&(g.empty=!0),g.message=t.NEEDS_TO_BE_SIMPLFIED_ERROR),!1;q&&u(k,Math.abs(k*.001))&&(g.empty=!0,g.message=t.APPROXIMATED_PI_ERROR)}}),g.correct===!1){let m=!1;if(re.each(o,function(d){re.any(d(f),function(E){return E.value!=null&&!re.isNaN(E.value)})&&(m=!0)}),!m)return g.empty=!0,g.message=t.EXTRA_SYMBOLS_ERROR,g}return g}}},number:{convertToPredicate:function(u,s){const t=parseFloat(u);return[function(a,c){return Math.abs(a-t)<c},de.extend({},s,{type:"predicate"})]},createValidatorFunctional:function(u,s,t){return Ne.predicate.createValidatorFunctional(...Ne.number.convertToPredicate(u,s),t)}},expression:{parseSolution:function(u,s){let t=Pe(u,s);if(t.parsed){if(s.simplified&&!t.expr.isSimplified())throw new Ve("The provided solution ("+u+") isn't fully expanded and simplified.",qe.InvalidInput);t=t.expr}else throw new Ve("The provided solution ("+u+") didn't parse.",qe.InvalidInput);return t},createValidatorFunctional:function(u,s,t){return function(a){const c={empty:!1,correct:!1,message:null,guess:a,ungraded:!1};if(!a)return c.empty=!0,c;const o=Pe(a,s);if(!o.parsed)return c.empty=!0,c;typeof u=="string"&&(u=Ne.expression.parseSolution(u,s));const f=tt(o.expr,u,s);if(f.equal)c.correct=!0;else if(f.wrongVariableNames||f.wrongVariableCase)c.ungraded=!0,c.message=f.wrongVariableCase?t.WRONG_CASE_ERROR:t.WRONG_LETTER_ERROR,c.suppressAlmostThere=!0;else if(f.message)c.message=f.message;else{const p=Pe(a.replace(/[xX]/g,"*"),s);if(p.parsed){const g=tt(p.expr,u,s);g.equal?(c.ungraded=!0,c.message=t.MULTIPLICATION_SIGN_ERROR):g.message&&(c.message=g.message+" Also, I'm a computer. I only understand multiplication if you use an asterisk (*) as the multiplication sign.")}}return c}}}},ot=/^web\+graphie:/,ft=/^file\+graphie:/;function Be(u){return ht(u)?pt(u):u}function ht(u){return ot.test(u)||ft.test(u)}function We(u){return u.replace(ot,"https:").replace(ft,"file:")}function pt(u){return We(u)+".svg"}function qt(u){return We(u)+"-data.json"}async function Vt(u){const s=new Image;return new Promise((t,a)=>{s.onload=()=>{t([s.naturalWidth,s.naturalHeight])},s.onerror=a,s.src=Be(u)})}let it=!1;const dt=function(u,s,t){return Array.isArray(u)?re.map(u,function(a){return dt(a,s)}):s.call(t,u)};function Gt(u,s){return u==null||s==null?u==null==(s==null):u.length===s.length&&u.every((t,a)=>s[a]===t)}const vt=/^\[\[\u2603 (([a-z-]+) ([0-9]+))\]\]/,Ct=/^([a-z-]+) ([0-9]+)$/,Lt=new RegExp(vt.source+"$"),zt="☃",gt={type:"points",earned:0,total:0,message:null},$e=function(u){let s=u;return function(){let t=s;return t=t+2127912214+(t<<12)&4294967295,t=(t^3345072700^t>>>19)&4294967295,t=t+374761393+(t<<5)&4294967295,t=(t+3550635116^t<<9)&4294967295,t=t+4251993797+(t<<3)&4294967295,t=(t^3042594569^t>>>16)&4294967295,(s=t&268435455)/268435456}};function Ut(u,s,t=!1){const a=re.clone(u);if(!a.length||re.all(a,function(o){return re.isEqual(o,a[0])}))return a;let c;typeof s=="function"?c=s:c=$e(s);do for(let o=a.length;o>0;o--){const f=Math.floor(c()*o),p=a[f];a[f]=a[o-1],a[o-1]=p}while(t&&re.isEqual(u,a));return a}const Ht="x".split(/(.)/g).length?function(u,s){return u.split(s)}:function(u,s){const t=[];let a=s.lastIndex=0,c;for(;c=s.exec(u);){const o=c;t.push(u.slice(a,o.index)),t.push(...o.slice(1)),a=o.index+o[0].length}return t.push(u.slice(a)),t};function mt(u,s){let t;if(u.type==="points"&&s.type==="points")return u.message&&s.message&&u.message!==s.message?t=null:t=u.message||s.message,{type:"points",earned:u.earned+s.earned,total:u.total+s.total,message:t};if(u.type==="points"&&s.type==="invalid")return s;if(u.type==="invalid"&&s.type==="points")return u;if(u.type==="invalid"&&s.type==="invalid")return u.message&&s.message&&u.message!==s.message?t=null:t=u.message||s.message,{type:"invalid",message:t};throw new Ve("PerseusScore with unknown type encountered",qe.InvalidInput,{metadata:{scoreA:JSON.stringify(u),scoreB:JSON.stringify(s)}})}function Bt(u){return Object.values(u).reduce(mt,gt)}function Wt(u){return u.type==="points"&&u.earned>=u.total}function $t(u,s,t){if(u.type==="points")return{empty:!1,correct:Wt(u),message:u.message,guess:s,state:t};if(u.type==="invalid")return{empty:!0,correct:!1,message:u.message,suppressAlmostThere:u.suppressAlmostThere,guess:s,state:t};throw new Ve("Invalid score type: "+u.type,qe.InvalidInput,{metadata:{score:JSON.stringify(u),guess:JSON.stringify(s),state:JSON.stringify(t)}})}function Jt(u,s){let t;return Ne.predicate.createValidatorFunctional(function(c){return t=c,!0},{simplify:"optional",inexact:!0,forms:"integer, proper, improper, pi, log, mixed, decimal"},s)(u),t}function Zt(u){return re(u).times(function(){return""})}function Kt(u,s,t,a){const c=Je(s,t),f=u*c>30;return{scale:c,tickStep:u/a,unityLabel:f}}function Yt(u,s,t){return re(2).times(function(a){const c=Je(u[a],t);return yt(s[a],c)})}function Xt(u){return[u[0]/2,u[1]/2]}function yt(u,s){const t=u*s,a=u,c=Math.pow(10,Math.floor(Math.log(a)/Math.LN10)),o=Math.floor(a/c);if(t<25)return u;if(t<50)return o===5?u:u/2;if(o===1)return u/2;if(o===2)return u/4;if(o===5)return u/5}function Je(u,s){const t=u[1]-u[0];return s/t}function Qt(u,s){const t=u[1]-u[0];let a;15<t&&t<=20?a=23:t>100||t<5?a=10:a=16;const c=s/500,o=a*c;return Ze(t,o)}function Ze(u,s){let t=Math.pow(10,Math.floor(Math.log(u/s)/Math.LN10));const a=s/u*t;return a<=.15?t*=10:a<=.35?t*=5:a<=.75&&(t*=2),t}const st=(u,s)=>{const t=s[1]-s[0],a=t/u;return a<=10?u:a<=20?u*2:Ze(t,10)};function jt(u,s){return[st(u[0],s[0]),st(u[1],s[1])]}function He(u,s){return typeof u=="number"&&typeof s=="number"?Math.abs(u-s)<1e-9:u===s}function _e(u,s){if(Array.isArray(u)&&Array.isArray(s)){if(u.length!==s.length)return!1;for(let t=0;t<u.length;t++)if(!_e(u[t],s[t]))return!1;return!0}return Array.isArray(u)||Array.isArray(s)?!1:typeof u=="function"&&typeof s=="function"?He(u,s):typeof u=="function"||typeof s=="function"?!1:typeof u=="object"&&typeof s=="object"&&u&&s?u===s||re.all(u,function(t,a){return _e(s[a],t)})&&re.all(s,function(t,a){return _e(u[a],t)}):typeof u=="object"&&u||typeof s=="object"&&s?!1:He(u,s)}function en(u){u=u||window.location.search.substring(1);const s={},t=/\+/g,a=/([^&=]+)=?([^&]*)/g,c=function(f){return decodeURIComponent(f.replace(t," "))};let o;for(;o=a.exec(u);){const f=o;s[c(f[1])]=c(f[2])}return s}function tn(u,s,t){t=encodeURIComponent(t);const a=new RegExp("([?&])"+s+"=.*?(&|$)","i"),c=u.indexOf("?")!==-1?"&":"?";return u.match(a)?u.replace(a,"$1"+s+"="+t+"$2"):u+c+s+"="+t}function nn(u){return encodeURIComponent(u).replace(/['()!]/g,window.escape).replace(/\*/g,"%2A")}function rn(u){return u.type==="invalid"&&(!u.message||u.message.length===0)}const Ie={pointerDown:!1,currentTouchIdentifier:null};function sn(){Object.assign(Ie,{pointerDown:!1,currentTouchIdentifier:null})}function an(u){let s;if(Ie.pointerDown){if(Ie.currentTouchIdentifier!=null){const a=u.changedTouches?u.changedTouches.length:0;for(let c=0;c<a;c++)u.changedTouches[c].identifier===Ie.currentTouchIdentifier&&(s=u.changedTouches[c])}else s=u;const t=u.type==="touchend"||u.type==="touchcancel";s&&t&&(Ie.pointerDown=!1,Ie.currentTouchIdentifier=null)}else Ie.pointerDown=!0,u.changedTouches?(s=u.changedTouches[0],Ie.currentTouchIdentifier=s.identifier):s=u;if(s)return{left:s.pageX,top:s.pageY}}const un=()=>{try{const u=Object.defineProperty({},"passive",{get:function(){it=!0}});window.addEventListener("testPassive",null,u),window.removeEventListener("testPassive",null,u)}catch{}return it};function cn(u){u.stopPropagation()}function ln(u,s){const t=new Image;t.onload=function(){var a;t.width===0&&t.height===0?((a=document.body)==null||a.appendChild(t),re.defer(function(){var c;s(t.clientWidth,t.clientHeight),(c=document.body)==null||c.removeChild(t)})):s(t.width,t.height)},t.src=Be(u)}function on(u){const s=u.value,t=u.selectionStart-1,a=Math.max(s.lastIndexOf(`
`,t),s.lastIndexOf(" ",t))+1;return{string:s.substring(a,t+1),pos:{start:a,end:t}}}function fn(u,s){u.selectionStart=s,u.selectionEnd=s}const hn={getWordBeforeCursor:on,moveCursor:fn},pn=u=>u.startsWith("$")&&u.endsWith("$")?u.slice(1,-1):u,dn=$e(new Date().getTime()&4294967295);function wt(u){return Array.isArray(u)?u.map(wt):u}const bn={inputPathsEqual:Gt,nestedMap:dt,rWidgetRule:vt,rTypeFromWidgetId:Ct,rWidgetParts:Lt,snowman:zt,noScore:gt,seededRNG:$e,shuffle:Ut,split:Ht,combineScores:mt,flattenScores:Bt,keScoreFromPerseusScore:$t,firstNumericalParse:Jt,stringArrayOfSize:Zt,gridDimensionConfig:Kt,getGridStep:Yt,snapStepFromGridStep:Xt,scaleFromExtent:Je,tickStepFromExtent:Qt,gridStepFromTickStep:yt,tickStepFromNumTicks:Ze,constrainedTickStepsFromTickSteps:jt,eq:He,deepEq:_e,parseQueryString:en,updateQueryString:tn,strongEncodeURIComponent:nn,scoreIsEmpty:rn,touchHandlers:Ie,resetTouchHandlers:sn,extractPointerLocation:an,supportsPassiveEvents:un,captureScratchpadTouchStart:cn,getImageSize:ln,getImageSizeModern:Vt,getRealImageUrl:Be,isLabeledSVG:ht,getBaseUrl:We,getSvgUrl:pt,getDataUrl:qt,textarea:hn,unescapeMathMode:pn,random:dn,deepClone:wt};export{Pt as D,qe as E,ae as K,Ve as P,bn as U,Wt as a,wn as b,En as c,kn as d,Re as e,Mn as f,Ne as g,xn as h,Rt as i,Pe as p,In as r,On as s,rt as t};
