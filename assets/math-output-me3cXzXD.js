import{j as c}from"./jsx-runtime-BGVbfQ2Z.js";import{$ as l}from"./jquery-5v7aFUvu.js";import{r as x}from"./index-qhcEwEpg.js";import{R as g}from"./index-E09jvG0x.js";import{_ as N}from"./index-default-4_ZsnO94.js";import{g as _}from"./dependencies-fnqF3NiV.js";import{C as u}from"./perseus-api-XkoWPDUZ.js";function b(s,e){let n=0;for(let t=e,r=s.length;t<r;t++){const i=s[t];if(i==="{"?n++:i==="}"&&n--,n<0)return t}return s.length}function p(s,e,n){const r=s.indexOf("{",e)+1,i=b(s,r),a=s.substring(r,i),m=d(a,n);return{endpoint:i,expression:m}}function h(s,e){const n="\\dfrac",r=s.indexOf("\\frac",e),i=s.indexOf(n,e);return r>-1&&i>-1?Math.min(r,i):r>-1?r:i>-1?i:-1}function d(s,e){if(!s)return"";let n="",t=0,r=h(s,t);for(;r>-1;){n+=s.substring(t,r),t=r;const i=p(s,t,e);t=i.endpoint+1;const a=p(s,t,e);t=a.endpoint+1,n.length&&(n+=" "),n+=e(i.expression,a.expression),r=h(s,t)}return n+=s.slice(t),n}function y(s){function e(t){return t.indexOf("\\frac")>-1||t.indexOf("\\dfrac")>-1}return d(s,function(t,r){let i;return e(t)||e(r)?i="\\dfrac":i="\\frac",i+" {"+t+"}{"+r+"}"})}function T(s){return d(s,function(t,r){return t+"/"+r}).replace("\\%","%")}const v={parseTex:T,modifyTex:y},F=v.modifyTex,f=class f extends x.Component{constructor(){super(...arguments),this.state={focused:!1,selectorNamespace:N.uniqueId("math-output")},this._getInputClassName=()=>{let e="math-output "+u.INPUT+" "+u.INTERACTIVE;return this.state.focused&&(e+=" "+u.FOCUSED),this.props.className&&(e+=" "+this.props.className),e},this._getDisplayValue=e=>{let n;return e!=null?n=""+e:n="",F(n)},this.getValue=()=>this.props.value,this.focus=()=>{this.state.focused||(this.props.onFocus(),this._bindBlurHandler(),this.setState({focused:!0}))},this.blur=()=>{this.state.focused&&(this.props.onBlur(),this._unbindBlurHandler(),this.setState({focused:!1}))},this._bindBlurHandler=()=>{l(document).bind("vclick."+this.state.selectorNamespace,e=>{l(e.target).closest(g.findDOMNode(this)).length||this.blur()})},this._unbindBlurHandler=()=>{l(document).unbind("."+this.state.selectorNamespace)}}render(){const e={textAlign:"center"},{TeX:n}=_();return c("span",{ref:"input",className:this._getInputClassName(),"aria-label":this.props.labelText,onMouseDown:this.focus,onTouchStart:this.focus,children:c("div",{style:e,children:c(n,{children:this._getDisplayValue(this.props.value)})})})}componentWillUnmount(){this._unbindBlurHandler()}};f.defaultProps={value:"",onFocus:function(){},onBlur:function(){}};let o=f;try{o.displayName="MathOutput",o.__docgenInfo={description:"",displayName:"MathOutput",props:{value:{defaultValue:{value:""},description:"",name:"value",required:!1,type:{name:"string | number"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},labelText:{defaultValue:null,description:"",name:"labelText",required:!1,type:{name:"string"}},onFocus:{defaultValue:{value:"function () {}"},description:"",name:"onFocus",required:!1,type:{name:"() => void"}},onBlur:{defaultValue:{value:"function () {}"},description:"",name:"onBlur",required:!1,type:{name:"() => void"}}}}}catch{}export{o as M,v as T};
