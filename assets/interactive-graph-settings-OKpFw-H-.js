import{j as t,a as c}from"./jsx-runtime-BGVbfQ2Z.js";import{B as C}from"./article-renderer-Sq1ohdzk.js";import{_ as o}from"./index-default-4_ZsnO94.js";import{U as T}from"./util-EDQcR2F7.js";import{c as L}from"./unit-sO4C0-pw.js";import"./dependencies-fnqF3NiV.js";import"./perseus-api-9NPhLZtS.js";import"./multi-renderer-YyFy6FFf.js";import"./hints-renderer-H3v7urUa.js";import"./renderer-g-jl5vfe.js";import"./base-radio-RuMR7l5N.js";import{c as z}from"./components-z4rUD9qG.js";import"./jquery-5v7aFUvu.js";import{i as q}from"./constants-I_nlPaPx.js";import"./index-0C4KXdeC.js";import"./i18n-context-9-s9cJ--.js";import{V as R}from"./index-4c2J3ov1.js";import{S as B,O as d}from"./answer-choices-wcCMdqVl.js";import{s as m,c as _}from"./index-lUErx3pE.js";import{l as I}from"./index-awljIyHI.js";import{r as w}from"./index-qhcEwEpg.js";import{b as G}from"./index-2Es7CZJJ.js";const p=f=>{const{children:a,label:e,labelSide:r="left",style:l}=f;return t("label",{className:I.css(k.label),children:c(R,{style:[k.row,l],children:[r==="start"||t(G,{style:k.spaceEnd,children:e}),a,r==="end"&&t(G,{style:k.spaceStart,children:e})]})})},k=I.StyleSheet.create({label:{width:"fit-content"},row:{flexDirection:"row",marginTop:m.xSmall_8,alignItems:"center",width:"fit-content"},spaceStart:{marginInlineStart:m.xSmall_8},spaceEnd:{marginInlineEnd:m.xSmall_8}});try{labeledrow.displayName="labeledrow",labeledrow.__docgenInfo={description:"",displayName:"labeledrow",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},labelSide:{defaultValue:null,description:"",name:"labelSide",required:!1,type:{name:"enum",value:[{value:'"start"'},{value:'"end"'}]}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"any"}}}}}catch{}const{ButtonGroup:E,InfoTip:U,PropCheckBox:N,RangeInput:x}=z,P={url:null,width:0,height:0};function M(f,a){return Math.floor((f[1]-f[0])/a)}const v=class v extends w.Component{constructor(a){super(a),this._isMounted=!1,this.bgUrlRef=w.createRef(),this.labelXRef=w.createRef(),this.labelYRef=w.createRef(),this.change=(...e)=>L.apply(this,e),this.changeRulerLabel=e=>{this.change({rulerLabel:e.target.value})},this.changeRulerTicks=e=>{this.change({rulerTicks:+e.target.value})},this.changeBackgroundUrl=e=>{var i;if(e.type==="keypress"&&e.key!=="Enter")return;const r=(h,n,s)=>{const u={...this.props.backgroundImage};u.url=h,u.width=n,u.height=s,this.setState({backgroundImage:u},this.changeGraph)},l=(i=this.bgUrlRef.current)==null?void 0:i.value;l?T.getImageSize(l,(h,n)=>{this._isMounted&&r(l,h,n)}):r(null,0,0)},this.renderLabelChoices=e=>e.map(r=>t("option",{value:r[1],children:r[0]},r[1])),this.validRange=e=>o.every(e,function(l){return o.isFinite(l)})?e[0]>=e[1]?"Range must have a higher number on the right":!0:"Range must be a valid number",this.validateStepValue=e=>{const{step:r,range:l,name:i,minTicks:h,maxTicks:n}=e,s=M(l,r);return s<h?i+" is too large, there must be at least "+h+" ticks.":s>n?i+" is too small, there can be at most "+n+" ticks.":!0},this.validSnapStep=(e,r)=>this.validateStepValue({step:e,range:r,name:"Snap step",minTicks:5,maxTicks:60}),this.validGridStep=(e,r)=>this.validateStepValue({step:e,range:r,name:"Grid step",minTicks:3,maxTicks:60}),this.validStep=(e,r)=>this.validateStepValue({step:e,range:r,name:"Step",minTicks:3,maxTicks:20}),this.validBackgroundImageSize=e=>e.url?e.width<=450&&e.height<=450?!0:"Image must be smaller than 450px x 450px.":!0,this.validateGraphSettings=(e,r,l,i,h)=>{const n=this;let s;if(!o.every(e,function(b){return s=n.validRange(b),s===!0})||!o.every(r,function(b,S){return s=n.validStep(b,e[S]),s===!0})||!o.every(l,function(b,S){return s=n.validGridStep(b,e[S]),s===!0})||!o.every(i,function(b,S){return s=n.validSnapStep(b,e[S]),s===!0}))return s;const V=this.validBackgroundImageSize(h);return V!==!0?(s=V,s):!0},this.changeLabel=(e,r)=>{const l=r.target.value,i=this.state.labelsTextbox.slice();i[e]=l,this.setState({labelsTextbox:i},this.changeGraph)},this.changeRange=(e,r)=>{const l=this.state.rangeTextbox.slice();l[e]=r;const i=this.state.stepTextbox.slice(),h=this.state.gridStepTextbox.slice(),n=this.state.snapStepTextbox.slice(),s=T.scaleFromExtent(l[e],this.props.box[e]);if(this.validRange(l[e])===!0){i[e]=T.tickStepFromExtent(l[e],this.props.box[e]);const u=T.gridStepFromTickStep(i[e],s);u&&(h[e]=u),n[e]=h[e]/2}this.setState({stepTextbox:i,gridStepTextbox:h,snapStepTextbox:n,rangeTextbox:l},this.changeGraph)},this.changeStep=e=>{this.setState({stepTextbox:e},this.changeGraph)},this.changeSnapStep=e=>{this.setState({snapStepTextbox:e},this.changeGraph)},this.changeGridStep=e=>{this.setState({gridStepTextbox:e,snapStepTextbox:o.map(e,function(r){return r/2})},this.changeGraph)},this.changeGraph=()=>{const e=this.state.labelsTextbox,r=o.map(this.state.rangeTextbox,function(u){return o.map(u,Number)}),l=o.map(this.state.stepTextbox,Number),i=this.state.gridStepTextbox,h=this.state.snapStepTextbox,n=this.state.backgroundImage,s=this.validateGraphSettings(r,l,i,h,n);s===!0?this.change({valid:!0,labels:e,range:r,step:l,gridStep:i,snapStep:h,backgroundImage:n}):this.change({valid:s})},this.state=v.stateFromProps(a)}static stateFromProps(a){return{labelsTextbox:a.labels,gridStepTextbox:a.gridStep,snapStepTextbox:a.snapStep,stepTextbox:a.step,rangeTextbox:a.range,backgroundImage:{...a.backgroundImage}}}componentDidMount(){this._isMounted=!0,this.changeGraph=o.debounce(this.changeGraph,300)}UNSAFE_componentWillReceiveProps(a){(!o.isEqual(this.props.labels,a.labels)||!o.isEqual(this.props.gridStep,a.gridStep)||!o.isEqual(this.props.snapStep,a.snapStep)||!o.isEqual(this.props.step,a.step)||!o.isEqual(this.props.range,a.range)||!o.isEqual(this.props.backgroundImage,a.backgroundImage))&&this.setState(v.stateFromProps(a))}componentWillUnmount(){this._isMounted=!1}render(){return c("div",{children:[c("div",{className:"graph-settings",children:[c("div",{className:"perseus-widget-row",children:[t("div",{className:"perseus-widget-left-col",children:t(p,{label:"x Label",children:t("input",{type:"text",className:"graph-settings-axis-label",ref:this.labelXRef,onChange:a=>this.changeLabel(0,a),value:this.state.labelsTextbox[0]||""})})}),t("div",{className:"perseus-widget-right-col",children:t(p,{label:"y Label",children:t("input",{type:"text",className:"graph-settings-axis-label",ref:this.labelYRef,onChange:a=>this.changeLabel(1,a),value:this.state.labelsTextbox[1]||""})})})]}),c("div",{className:"perseus-widget-row",children:[t("div",{className:"perseus-widget-left-col",children:t(p,{label:"x Range",children:t(x,{value:this.state.rangeTextbox[0],onChange:a=>this.changeRange(0,a)})})}),t("div",{className:"perseus-widget-right-col",children:t(p,{label:"y Range",children:t(x,{value:this.state.rangeTextbox[1],onChange:a=>this.changeRange(1,a)})})})]}),c("div",{className:"perseus-widget-row",children:[t("div",{className:"perseus-widget-left-col",children:t(p,{label:"Tick Step",children:t(x,{value:this.state.stepTextbox,onChange:this.changeStep})})}),t("div",{className:"perseus-widget-right-col",children:t(p,{label:"Grid Step",children:t(x,{value:this.state.gridStepTextbox,onChange:this.changeGridStep})})})]}),t("div",{className:"perseus-widget-row",children:t("div",{className:"perseus-widget-left-col",children:t(p,{label:"Snap Step",children:t(x,{value:this.state.snapStepTextbox,onChange:this.changeSnapStep})})})}),t("div",{className:"perseus-widget-row",children:t(p,{label:"Markings:",children:t(E,{value:this.props.markings,allowEmpty:!1,buttons:[{value:"graph",content:"Graph"},{value:"grid",content:"Grid"},{value:"none",content:"None"}],onChange:this.change("markings")})})}),t("div",{className:"perseus-widget-left-col",children:t(N,{label:"Show tooltips",showTooltips:this.props.showTooltips,onChange:this.change})})]}),c(p,{label:"Background image URL:",style:g.resetSpaceTop,children:[t("input",{type:"text",className:I.css(g.backgroundUrlInput),ref:this.bgUrlRef,value:this.state.backgroundImage.url||"",onChange:a=>{const e={...this.props.backgroundImage};e.url=a.target.value,this.setState({backgroundImage:e})},onKeyPress:this.changeBackgroundUrl,onBlur:this.changeBackgroundUrl}),t(U,{children:t("p",{children:'Create an image in graphie, or use the "Add image" function to create a background.'})})]}),c(R,{style:g.rulerSection,children:[c(R,{style:g.checkboxRow,children:[t(N,{label:"Show ruler",showRuler:this.props.showRuler,onChange:this.change,style:g.resetSpaceTop}),t(N,{label:"Show protractor",showProtractor:this.props.showProtractor,onChange:this.change,style:g.resetSpaceTop})]}),(this.props.showRuler||this.props.showProtractor)&&t(C,{layout:"floating",text:"The ruler and protractor are not accessible. Please consider an alternate approach.",kind:"warning"}),this.props.showRuler&&c(R,{style:g.spaceTop,children:[t(p,{label:"Ruler label:",style:g.resetSpaceTop,children:c(B,{id:"ruler-label-select",selectedValue:this.props.rulerLabel,onChange:a=>{this.change({rulerLabel:a})},placeholder:"None",style:g.singleSelectShort,children:[t(d,{value:"",label:"None",horizontalRule:"full-width"}),t(d,{value:"mm",label:"Milimeters"}),t(d,{value:"cm",label:"Centimeters"}),t(d,{value:"m",label:"Meters"}),t(d,{value:"km",label:"Kilometers",horizontalRule:"full-width"}),t(d,{value:"in",label:"Inches"}),t(d,{value:"ft",label:"Feet"}),t(d,{value:"yd",label:"Yards"}),t(d,{value:"mi",label:"Miles"})]})}),t(p,{label:"Ruler ticks:",children:t(B,{id:"ruler-ticks-select",selectedValue:`${this.props.rulerTicks}`,onChange:a=>{this.change({rulerTicks:a})},placeholder:"10",style:g.singleSelectShort,children:[1,2,4,8,10,16].map(a=>t(d,{value:`${a}`,label:`${a}`},a))})})]})]})]})}};v.defaultProps={box:[q.defaultBoxSizeSmall,q.defaultBoxSizeSmall],labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],gridStep:[1,1],snapStep:[1,1],valid:!0,backgroundImage:P,markings:"graph",showProtractor:!1,showRuler:!1,showTooltips:!1,rulerLabel:"",rulerTicks:10};let y=v;const g=I.StyleSheet.create({resetSpaceTop:{marginTop:0},spaceTop:{marginTop:m.xSmall_8},singleSelectShort:{height:26},backgroundUrlInput:{border:`1px solid ${_.offBlack32}`,borderRadius:m.xxxSmall_4,padding:m.xxxSmall_4},checkboxRow:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:m.xSmall_8},rulerSection:{marginTop:m.xSmall_8,borderTop:`1px solid ${_.offBlack16}`,paddingTop:m.xSmall_8,paddingBottom:m.xSmall_8,borderBottom:`1px solid ${_.offBlack16}`}}),ce=y;try{y.displayName="InteractiveGraphSettings",y.__docgenInfo={description:"",displayName:"InteractiveGraphSettings",props:{box:{defaultValue:{value:`[
            interactiveSizes.defaultBoxSizeSmall,
            interactiveSizes.defaultBoxSizeSmall,
        ]`},description:"The size of the graph area in pixels.",name:"box",required:!1,type:{name:"[x: number, y: number]"}},labels:{defaultValue:{value:'["x", "y"]'},description:"The labels for the x and y axes.",name:"labels",required:!1,type:{name:"readonly string[]"}},range:{defaultValue:{value:`[
            [-10, 10],
            [-10, 10],
        ]`},description:"The range of the graph.",name:"range",required:!1,type:{name:"[x: Range, y: Range]"}},step:{defaultValue:{value:"[1, 1]"},description:`How far apart the tick marks on the axes are in the x and y
directions.`,name:"step",required:!1,type:{name:"[x: number, y: number]"}},gridStep:{defaultValue:{value:"[1, 1]"},description:"How far apart the grid lines are in the x and y directions.",name:"gridStep",required:!1,type:{name:"[x: number, y: number]"}},snapStep:{defaultValue:{value:"[1, 1]"},description:"How far apart the snap-to points are in the x and y directions.",name:"snapStep",required:!1,type:{name:"[x: number, y: number]"}},valid:{defaultValue:{value:"true"},description:`An error message to display in the graph area, or true if the
graph is valid.`,name:"valid",required:!1,type:{name:"string | boolean"}},backgroundImage:{defaultValue:{value:`{
    url: null,
    width: 0,
    height: 0,
} as const`},description:"The background image to display in the graph area and its properties.",name:"backgroundImage",required:!1,type:{name:"PerseusImageBackground"}},markings:{defaultValue:{value:"graph"},description:`The type of markings to display on the graph.
- graph: shows the axes and the grid lines
- grid: shows only the grid lines
- none: shows no markings`,name:"markings",required:!1,type:{name:"enum",value:[{value:'"graph"'},{value:'"grid"'},{value:'"none"'}]}},showProtractor:{defaultValue:{value:"false"},description:"Whether to show the protractor on the graph.",name:"showProtractor",required:!1,type:{name:"boolean"}},showRuler:{defaultValue:{value:"false"},description:"Whether to show the ruler on the graph.",name:"showRuler",required:!1,type:{name:"boolean"}},showTooltips:{defaultValue:{value:"false"},description:"Whether to show tooltips on the graph.",name:"showTooltips",required:!1,type:{name:"boolean"}},rulerLabel:{defaultValue:{value:""},description:"The label to display on the ruler, if any.",name:"rulerLabel",required:!1,type:{name:"string"}},rulerTicks:{defaultValue:{value:"10"},description:"The number of ticks to display on the ruler.",name:"rulerTicks",required:!1,type:{name:"number"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(arg1: Partial<Props>) => void"}}}}}catch{}export{ce as I,p as L};
