import{a as Ts}from"./version-akiLXZts.js";import{j as t,a as n}from"./jsx-runtime-BGVbfQ2Z.js";import{W as Is,G as Ps,a as ks,M as As,P as Es,T as Os,w as Ms}from"./article-renderer-2adRDJEs.js";import{l as S,c as m,p as y,a as Ls}from"./unit-tpB2tohZ.js";import"./index-eZ2N530f.js";import"./index-V35CFGao.js";import{r as c}from"./index-qhcEwEpg.js";import"./fixed-to-responsive-X0KGwmEJ.js";import{g as rs}from"./dependencies-fnqF3NiV.js";import"./video-transcript-link-ZVuMBlt5.js";import{_ as p}from"./index-default-4_ZsnO94.js";import{L as as,P as Rt,E as lt}from"./perseus-error-OpXxk17X.js";import{A as P,C as Rs}from"./perseus-api-Ly41NhN4.js";import{g as Vs,e as qs,d as Us}from"./multi-renderer-YWTbdcUg.js";import"./hints-renderer-Ce3AIV11.js";import{S as zs,P as os,j as ls,r as ps,a as hs,k as cs}from"./renderer-D-YI6qGu.js";import"./base-radio-AagZi9VH.js";import{c as v}from"./components-Jrc4FLty.js";import{I as V}from"./icon-paths-fAaGW1jp.js";import{U as Fe,b as Ds}from"./util-G-g1AweO.js";import{$ as Fs}from"./jquery-5v7aFUvu.js";import"./button-group-eBTrRsKy.js";import"./graph--20Axj0Z.js";import{e as Hs}from"./svg-image-Z3LkLiji.js";import"./hud-J4t6ihs4.js";import"./icon-HbAIhp4d.js";import"./info-tip-8U9pfYW-.js";import"./inline-icon-MJBS_-2U.js";import"./math-input-vBHKIVuy.js";import"./multi-button-group-rHU9dGVb.js";import"./number-input-fy1LqA4g.js";import{c as _t}from"./prop-check-box-PZNxg3Pm.js";import"./range-input-qgKts6Pq.js";import"./text-input-zeKg0zcv.js";import"./text-list-editor-bJphcq85.js";import{P as l}from"./index-tvtfaFq4.js";import{S as Ee}from"./section-control-button-IRm9Gcxt.js";import{E as b}from"./editor-oEzROQdc.js";import{R as pt,W as Ws}from"./structured-item-diff-x5A0CqiA.js";import{I as js}from"./item-extras-editor-tDczSF2C.js";import{M as Bs}from"./multi-items-5apf_bE4.js";import{l as d}from"./index-awljIyHI.js";import{R as Ue}from"./index-E09jvG0x.js";/* empty css                       */import{C as $s}from"./categorizer-editor-ZPsFA7UD.js";import{E as w}from"./editor-jsonify-78WT2WXm.js";import{B as x}from"./blur-input-0MWX_AIX.js";import{D as Gs}from"./definition-editor-Wn6joSRP.js";import{D as Ks}from"./dropdown-editor-aUCQzTeE.js";import{E as Js}from"./explanation-editor-2S4rj9y-.js";import{E as Ys}from"./expression-editor-YMrWn6wU.js";import{G as Xs}from"./graph-settings-BdqotOA9.js";import{I as Zs}from"./image-editor-t699yA11.js";import{I as Qs}from"./input-number-editor--C_I1GGI.js";import{I as ei}from"./interaction-editor-1aNxFyuf.js";import{I as ti}from"./interactive-graph-editor-OA5AeOGn.js";import{L as si}from"./label-image-editor-jlbXJEpy.js";import{M as ii}from"./matcher-editor-O9QE0nCv.js";import{N as ni}from"./number-line-editor-Flw3Gfyd.js";import{N as ri}from"./numeric-input-editor-I0hhkSPh.js";import{p as ai}from"./perseus-types-S-dfa6qp.js";import{P as oi}from"./python-program-editor-fh4oX6cv.js";import{R as li}from"./editor-bXIJDWjj.js";import{S as pi}from"./sorter-editor--gPJ13MP.js";import{u as ht,E as hi,M as ci,c as di,V as ui}from"./compare-VLxlEkSV.js";const gi="@khanacademy/perseus-editor",mi="__lib_version__";Ts(gi,mi);const ze={PHONE:"phone",TABLET:"tablet",DESKTOP:"desktop"},ds=36,us=1,fi=Object.freeze(Object.defineProperty({__proto__:null,devices:ze,lintGutterWidth:ds,perseusFrameBorderWidth:us},Symbol.toStringTag,{value:"Module"})),q={phone:{width:320,height:480,framedWidth:320},tablet:{width:750,height:920,framedWidth:525},desktop:{width:688,height:600,framedWidth:688}},xt=class xt extends c.Component{render(){const e=this.props.deviceType;if(this.props.nochrome)return t("div",{children:t("div",{style:{width:q[e].framedWidth+2*us+ds},children:t("div",{children:this.props.children})},"screen")});const s=q[e].framedWidth/q[e].width,i={backgroundColor:"white",color:"black",textAlign:"left",width:q[e].width,height:q[e].height,border:"solid 1px #CCC",margin:8,zoom:s};return t("div",{className:"screen",style:i,children:this.props.children},"screen")}};xt.propTypes={children:l.element.isRequired,deviceType:l.oneOf([ze.PHONE,ze.TABLET,ze.DESKTOP]).isRequired,nochrome:l.bool};let k=xt;try{k.displayName="DeviceFramer",k.__docgenInfo={description:"",displayName:"DeviceFramer",props:{}}}catch{}const Nt=_t({displayName:"JsonEditor",getInitialState:function(){return{currentValue:JSON.stringify(this.props.value,null,4),valid:!0}},UNSAFE_componentWillReceiveProps:function(r){(!this.state.valid||!p.isEqual(r.value,JSON.parse(this.state.currentValue)))&&this.setState(this.getInitialState())},render:function(){const r="perseus-json-editor "+(this.state.valid?"valid":"invalid");return t("textarea",{className:r,value:this.state.currentValue,onChange:this.handleChange,onKeyDown:this.handleKeyDown,onBlur:this.handleBlur})},handleKeyDown:function(r){if(r.key==="Tab"){const e=r.target.selectionStart,s=r.target.value,i=s.substring(0,e),a=s.substring(e,s.length);r.target.value=i+"    "+a,r.target.selectionStart=i.length+4,r.target.selectionEnd=i.length+4,r.preventDefault(),this.handleChange(r)}},handleChange:function(r){const e=r.target.value;try{let s=JSON.parse(e);p.isString(s)&&(s=JSON.parse(s)),this.setState({currentValue:e,valid:!0},function(){this.props.onChange(s)})}catch{this.setState({currentValue:e,valid:!1})}},handleBlur:function(r){const e=r.target.value;try{let s=JSON.parse(e);p.isString(s)&&(s=JSON.parse(s)),this.setState({currentValue:JSON.stringify(s,null,4),valid:!0},function(){this.props.onChange(s)})}catch{this.setState({currentValue:JSON.stringify(this.props.value,null,4),valid:!0})}}});let Vt=0;const ct={},dt={};window.iframeDataStore={};window.addEventListener("message",r=>{if(typeof r.data=="string"){const e=ct[r.data];e&&e()}else r.data.id&&(r.data.height!==void 0?dt[r.data.id](r.data.height):r.data.lintWarnings&&as.log("LINTER REPORT",{lintWarnings:JSON.stringify(r.data.lintWarnings)}))});class ne extends c.Component{constructor(){super(...arguments),this.container=c.createRef()}componentDidMount(){this._isMounted=!0,this.iframeID=Vt,Vt++,this._prepareFrame(),ct[this.iframeID]=()=>{this.sendNewData(this._lastData)},dt[this.iframeID]=e=>{this._lastHeight=e,this._isMounted&&this.props.seamless&&this.container.current&&(this.container.current.style.height=e+"px")}}shouldComponentUpdate(e){return e.datasetValue!==this.props.datasetValue||e.seamless!==this.props.seamless}componentDidUpdate(e){this.container.current&&(this.props.seamless?this.container.current.style.height=this._lastHeight+"px":this.container.current.style.height="100%"),e.datasetValue!==this.props.datasetValue&&this._prepareFrame()}componentWillUnmount(){ct[this.iframeID]=null,dt[this.iframeID]=null,this._isMounted=!1}_prepareFrame(){var s,i;this._frame&&((s=this.container.current)==null||s.removeChild(this._frame));const e=document.createElement("iframe");e.style.width="100%",e.style.height="100%",e.src=this.props.url,this.props.datasetKey&&(e.dataset[this.props.datasetKey]=this.props.datasetValue),e.dataset.id=String(this.iframeID),this.props.seamless&&(e.dataset.lintGutter="true"),(i=this.container.current)==null||i.appendChild(e),this._frame=e}sendNewData(e){const s=this._frame;this._isMounted&&e&&(s!=null&&s.contentWindow)&&(this._lastData=e,window.iframeDataStore[this.iframeID]=e,s.contentWindow.postMessage(this.iframeID,"*"))}render(){return t("div",{ref:this.container,style:{width:"100%",height:"100%"}})}}try{ne.displayName="IframeContentRenderer",ne.__docgenInfo={description:"",displayName:"IframeContentRenderer",props:{url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}},datasetKey:{defaultValue:null,description:"",name:"datasetKey",required:!0,type:{name:"string"}},datasetValue:{defaultValue:null,description:"",name:"datasetValue",required:!0,type:{name:"any"}},seamless:{defaultValue:null,description:"",name:"seamless",required:!0,type:{name:"boolean"}}}}}catch{}const{HUD:yi,InlineIcon:vi}=v,{iconCircleArrowDown:wi,iconCircleArrowUp:Ci,iconPlus:qt,iconTrash:bi}=V,Tt=class Tt extends c.Component{constructor(){super(...arguments),this.state={highlightLint:!0},this._handleJsonChange=e=>{this.props.onChange({json:e})},this._handleEditorChange=(e,s)=>{const i=p.clone(this._sections());i[e]=p.extend({},i[e],s),this.props.onChange({json:i})}}componentDidMount(){this._updatePreviewFrames()}componentDidUpdate(){this._updatePreviewFrames()}_updatePreviewFrames(){this.props.mode==="preview"?this.refs["frame-all"].sendNewData({type:"article-all",data:this._sections().map((e,s)=>this._apiOptionsForSection(e,s))}):this.props.mode==="edit"&&this._sections().forEach((e,s)=>{this.refs["frame-"+s].sendNewData({type:"article",data:this._apiOptionsForSection(e,s)})})}_apiOptionsForSection(e,s){const i=this.refs[`editor${s}`];return{apiOptions:{...P.defaults,...this.props.apiOptions,showAlignmentOptions:!0,isArticle:!0},json:e,useNewStyles:this.props.useNewStyles,linterContext:{contentType:"article",highlightLint:this.state.highlightLint,paths:this.props.contentPaths},legacyPerseusLint:i?i.getSaveWarnings():[]}}_sections(){return Array.isArray(this.props.json)?this.props.json:[this.props.json]}_renderEditor(){const{imageUploader:e,sectionImageUploadGenerator:s}=this.props,i={...P.defaults,...this.props.apiOptions,showAlignmentOptions:!0,isArticle:!0},a=this._sections();return n("div",{className:"perseus-editor-table",children:[a.map((o,h)=>[n("div",{className:"perseus-editor-row",children:[n("div",{className:"perseus-editor-left-cell",children:[n("div",{className:"pod-title",children:["Section ",h+1,n("div",{style:{display:"inline-block",float:"right"},children:[s(h),t(Ee,{icon:qt,onClick:()=>{this._handleAddSectionAfter(h)},title:"Add a new section after this one"}),h+1<a.length&&t(Ee,{icon:wi,onClick:()=>{this._handleMoveSectionLater(h)},title:"Move this section down"}),h>0&&t(Ee,{icon:Ci,onClick:()=>{this._handleMoveSectionEarlier(h)},title:"Move this section up"}),t(Ee,{icon:bi,onClick:()=>{const g="Are you sure you want to delete section "+(h+1)+"?";confirm(g)&&this._handleRemoveSection(h)},title:"Delete this section"})]})]}),t(b,{...o,apiOptions:i,imageUploader:e,onChange:p.partial(this._handleEditorChange,h),placeholder:"Type your section text here...",ref:"editor"+h})]}),t("div",{className:"editor-preview",children:this._renderIframePreview(h,!0)})]},h)]),this._renderAddSection(),this._renderLinterHUD()]})}_renderAddSection(){return t("div",{className:"perseus-editor-row",children:t("div",{className:"perseus-editor-left-cell",children:n("a",{href:"#",className:"simple-button orange",onClick:()=>{this._handleAddSectionAfter(this._sections().length-1)},children:[t(vi,{...qt})," Add a section"]})})})}_renderLinterHUD(){return t(yi,{message:"Style warnings",enabled:this.state.highlightLint,onClick:()=>{this.setState({highlightLint:!this.state.highlightLint})}})}_renderIframePreview(e,s){const i=this.props.screen==="phone"||this.props.screen==="tablet";return t(k,{deviceType:this.props.screen,nochrome:s,children:t(ne,{ref:"frame-"+e,datasetKey:"mobile",datasetValue:i,seamless:s,url:this.props.previewURL},this.props.screen)})}_renderPreviewMode(){return t("div",{className:"standalone-preview",children:this._renderIframePreview("all",!1)})}_handleMoveSectionEarlier(e){if(e===0)return;const s=p.clone(this._sections()),i=s[e];s.splice(e,1),s.splice(e-1,0,i),this.props.onChange({json:s})}_handleMoveSectionLater(e){const s=p.clone(this._sections());if(e+1===s.length)return;const i=s[e];s.splice(e,1),s.splice(e+1,0,i),this.props.onChange({json:s})}_handleAddSectionAfter(e){const s=p.clone(this.serialize()),i=e>=0?{widgets:s[e].widgets}:{};s.splice(e+1,0,i),this.props.onChange({json:s})}_handleRemoveSection(e){const s=p.clone(this._sections());s.splice(e,1),this.props.onChange({json:s})}serialize(){if(this.props.mode==="edit")return this._sections().map((e,s)=>this.refs["editor"+s].serialize());if(this.props.mode==="preview"||this.props.mode==="json")return this.props.json;throw new Rt("Could not serialize; mode "+this.props.mode+" not found",lt.Internal)}getSaveWarnings(){if(this.props.mode!=="edit")throw new Rt("Can only get save warnings in edit mode.",lt.NotAllowed);return this._sections().map((e,s)=>this.refs["editor"+s].getSaveWarnings())}render(){return n("div",{className:"framework-perseus perseus-article-editor",children:[this.props.mode==="edit"&&this._renderEditor(),this.props.mode==="preview"&&this._renderPreviewMode(),this.props.mode==="json"&&n("div",{className:"json-editor",children:[t("div",{className:"json-editor-warning",children:t("span",{children:"Warning: Editing in this mode can lead to broken articles!"})}),t(Nt,{multiLine:!0,onChange:this._handleJsonChange,value:this.props.json})]})]})}};Tt.defaultProps={contentPaths:[],json:[{}],mode:"edit",screen:"desktop",sectionImageUploadGenerator:()=>t("span",{}),useNewStyles:!1};let ut=Tt;try{articleeditor.displayName="articleeditor",articleeditor.__docgenInfo={description:"",displayName:"articleeditor",props:{contentPaths:{defaultValue:{value:"[]"},description:"",name:"contentPaths",required:!1,type:{name:"readonly string[]"}},json:{defaultValue:{value:"[{}]"},description:"",name:"json",required:!1,type:{name:"JsonType"}},mode:{defaultValue:{value:"edit"},description:"",name:"mode",required:!1,type:{name:"enum",value:[{value:'"json"'},{value:'"diff"'},{value:'"edit"'},{value:'"preview"'}]}},screen:{defaultValue:{value:"desktop"},description:"",name:"screen",required:!1,type:{name:"enum",value:[{value:'"phone"'},{value:'"tablet"'},{value:'"desktop"'}]}},sectionImageUploadGenerator:{defaultValue:{value:"() => <span />"},description:"",name:"sectionImageUploadGenerator",required:!1,type:{name:"(i: number) => ReactElement<DetailedHTMLProps<HTMLAttributes<HTMLSpanElement>, HTMLSpanElement>, string | JSXElementConstructor<...>>"}},useNewStyles:{defaultValue:{value:"false"},description:"",name:"useNewStyles",required:!1,type:{name:"boolean"}},apiOptions:{defaultValue:null,description:"",name:"apiOptions",required:!1,type:{name:"Readonly<{ isArticle?: boolean; onInputError?: ((widgetId: any, value: string, message?: string | null) => unknown) | undefined; onFocusChange?: ((newFocusPath: FocusPath, oldFocusPath: FocusPath, keypadHeight?: number | undefined, focusedElement?: HTMLElement | undefined) => unknown) | undef..."}},imageUploader:{defaultValue:null,description:"",name:"imageUploader",required:!1,type:{name:"((arg1: string, arg2: (arg1: string) => unknown) => unknown)"}},previewURL:{defaultValue:null,description:"",name:"previewURL",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(values: { [key: string]: any; }, callback?: (() => unknown) | null | undefined, silent?: boolean | undefined) => unknown"}}}}}catch{}const{ButtonGroup:_i,InlineIcon:Qe}=v,{devices:et}=fi,{iconDesktop:Ni,iconMobilePhone:Si,iconTablet:xi}=V,It=class It extends c.Component{constructor(){super(...arguments),this.handleChange=e=>{this.props.onViewportSizeChanged(e)}}render(){const e=n("span",{children:[t(Qe,{...Si})," Phone"]}),s=n("span",{children:[t(Qe,{...xi})," Tablet"]}),i=n("span",{children:[t(Qe,{...Ni})," Desktop"]});return n("span",{className:"viewport-resizer",children:["Viewport:"," ",t(_i,{value:this.props.deviceType,allowEmpty:!1,buttons:[{value:et.PHONE,content:e},{value:et.TABLET,content:s},{value:et.DESKTOP,content:i}],onChange:this.handleChange})]})}};It.propTypes={deviceType:l.string.isRequired,onViewportSizeChanged:l.func.isRequired};let re=It;try{re.displayName="ViewportResizer",re.__docgenInfo={description:"",displayName:"ViewportResizer",props:{deviceType:{defaultValue:null,description:"",name:"deviceType",required:!0,type:{name:"enum",value:[{value:'"phone"'},{value:'"tablet"'},{value:'"desktop"'}]}},onViewportSizeChanged:{defaultValue:null,description:"",name:"onViewportSizeChanged",required:!0,type:{name:"(arg1: DeviceType) => unknown"}}}}}catch{}const Oe=l.shape({content:l.string,images:l.objectOf(l.any),widgets:l.objectOf(l.any)}),M=class M extends c.Component{constructor(){super(...arguments),this.state=M._stateFromProps(this.props)}UNSAFE_componentWillReceiveProps(e){this.setState(M._stateFromProps(e))}render(){const{before:e,after:s}=this.state,i=Math.max(e.length,s.length),a=p.times(i,o=>t(pt,{before:o<e.length?e[o]:void 0,after:o<s.length?s[o]:void 0,title:`Section ${o+1}`,showAlignmentOptions:!0,showSeparator:o<i-1},o));return t("div",{className:"framework-perseus",children:a})}};M.propTypes={after:l.oneOfType([Oe,l.arrayOf(Oe)]).isRequired,before:l.oneOfType([Oe,l.arrayOf(Oe)]).isRequired},M._stateFromProps=e=>{const{before:s,after:i}=e;return{before:Array.isArray(s)?s:[s],after:Array.isArray(i)?i:[i]}};let He=M;try{He.displayName="ArticleDiff",He.__docgenInfo={description:"",displayName:"ArticleDiff",props:{}}}catch{}const Ut=l.shape({question:l.shape({}).isRequired,answerArea:l.shape({}).isRequired,hints:l.arrayOf(l.any).isRequired}),Pt=class Pt extends c.Component{render(){const{before:e,after:s}=this.props,i=Math.max(e.hints.length,s.hints.length),a=t(pt,{before:e.question,after:s.question,title:"Question",showAlignmentOptions:!1,showSeparator:!0}),o=t(Ws,{before:e.answerArea,after:s.answerArea,title:"Question extras"}),h=p.times(i,function(g){return t(pt,{before:g<e.hints.length?e.hints[g]:void 0,after:g<s.hints.length?s.hints[g]:void 0,title:`Hint ${g+1}`,showAlignmentOptions:!1,showSeparator:g<i-1},g)});return n("div",{className:"framework-perseus",children:[a,o,h&&t("div",{className:"diff-separator"}),h]})}};Pt.propTypes={after:Ut.isRequired,before:Ut.isRequired};let We=Pt;try{We.displayName="ItemDiff",We.__docgenInfo={description:"",displayName:"ItemDiff",props:{}}}catch{}const{InfoTip:Ti,InlineIcon:De}=v,{iconCircleArrowDown:Ii,iconCircleArrowUp:Pi,iconPlus:ki,iconTrash:Ai}=V,kt=class kt extends c.Component{constructor(){super(...arguments),this.editor=c.createRef(),this.handleChange=e=>{this.props.onChange({replace:e.target.checked})},this.focus=()=>{var e;(e=this.editor.current)==null||e.focus()},this.getSaveWarnings=()=>{var e;return(e=this.editor.current)==null?void 0:e.getSaveWarnings()},this.serialize=e=>{var s;return(s=this.editor.current)==null?void 0:s.serialize(e)}}render(){return n("div",{className:"perseus-hint-editor "+this.props.className,children:[this.props.showTitle&&t("div",{className:"pod-title",children:"Hint"}),t(b,{ref:this.editor,apiOptions:this.props.apiOptions,widgets:this.props.widgets||void 0,content:this.props.content||void 0,images:this.props.images,replace:this.props.replace,placeholder:"Type your hint here...",imageUploader:this.props.imageUploader,onChange:this.props.onChange},this.props.itemId),n("div",{className:"hint-controls-container clearfix",children:[this.props.showMoveButtons&&n("span",{className:"reorder-hints",children:[t("button",{type:"button",className:this.props.isLast?"hidden":"",onClick:p.partial(this.props.onMove,1),children:t(De,{...Ii})})," ",t("button",{type:"button",className:this.props.isFirst?"hidden":"",onClick:p.partial(this.props.onMove,-1),children:t(De,{...Pi})})," ",this.props.isLast&&t(Ti,{children:t("p",{children:"The last hint is automatically bolded."})})]}),t("input",{type:"checkbox",checked:this.props.replace,onChange:this.handleChange}),"Replace previous hint",this.props.showRemoveButton&&n("button",{type:"button",className:"remove-hint simple-button orange",onClick:this.props.onRemove,children:[t(De,{...Ai}),"Remove this hint"," "]})]})]})}};kt.defaultProps={className:"",content:"",replace:!1,showMoveButtons:!0,showTitle:!0,showRemoveButton:!0};let A=kt;const At=class At extends c.Component{constructor(){super(...arguments),this.editor=c.createRef(),this.frame=c.createRef(),this.updatePreview=()=>{var s;const e=this.props.isLast&&!/\*\*/.test(this.props.hint.content);(s=this.frame.current)==null||s.sendNewData({type:"hint",data:{hint:this.props.hint,bold:e,pos:this.props.pos,apiOptions:this.props.apiOptions,linterContext:{contentType:"hint",highlightLint:this.props.highlightLint,paths:this.props.contentPaths}}})},this.getSaveWarnings=()=>{var e;return(e=this.editor.current)==null?void 0:e.getSaveWarnings()},this.serialize=e=>{var s;return(s=this.editor.current)==null?void 0:s.serialize(e)},this.focus=()=>{var e;(e=this.editor.current)==null||e.focus()}}componentDidMount(){this.updatePreview()}componentDidUpdate(){this.updatePreview()}render(){const e=this.props.deviceType==="phone"||this.props.deviceType==="tablet";return n("div",{className:"perseus-combined-hint-editor perseus-editor-row",children:[t("div",{className:"perseus-editor-left-cell",children:t(A,{ref:this.editor,itemId:this.props.itemId,isFirst:this.props.isFirst,isLast:this.props.isLast,widgets:this.props.hint.widgets,content:this.props.hint.content,images:this.props.hint.images,replace:this.props.hint.replace,imageUploader:this.props.imageUploader,onChange:this.props.onChange,onRemove:this.props.onRemove,onMove:this.props.onMove,apiOptions:this.props.apiOptions})}),t("div",{className:"perseus-editor-right-cell",children:t(k,{deviceType:this.props.deviceType,nochrome:!0,children:t(ne,{ref:this.frame,datasetKey:"mobile",datasetValue:e,seamless:!0,url:this.props.previewURL})})})]})}};At.defaultProps={highlightLint:!1};let gt=At;const $e=class $e extends c.Component{constructor(){super(...arguments),this.handleHintChange=(e,s,i,a)=>{const o=p(this.props.hints).clone();o[e]=p.extend({},this.serializeHint(e,{keepDeletedWidgets:!0}),s),this.props.onChange({hints:o},i,a)},this.handleHintRemove=e=>{if(!confirm("Are you sure you want to delete this hint?"))return;const s=p(this.props.hints).clone();s.splice(e,1),this.props.onChange({hints:s})},this.handleHintMove=(e,s)=>{const i=p(this.props.hints).clone(),a=i.splice(e,1)[0];i.splice(e+s,0,a),this.props.onChange({hints:i},()=>{this.refs["hintEditor"+(e+s)].focus()})},this.addHint=()=>{const e=p(this.props.hints).clone().concat([{content:""}]);this.props.onChange({hints:e},()=>{const s=e.length-1;this.refs["hintEditor"+s].focus()})},this.getSaveWarnings=()=>p.chain(this.props.hints).map((e,s)=>p.map(this.refs["hintEditor"+s].getSaveWarnings(),i=>"Hint "+(s+1)+": "+i)).flatten(!0).value(),this.serialize=e=>this.props.hints.map((s,i)=>this.serializeHint(i,e)),this.serializeHint=(e,s)=>this.refs["hintEditor"+e].serialize(s)}render(){const{itemId:e,hints:s}=this.props,i=p.map(s,function(a,o){return t(gt,{ref:"hintEditor"+o,isFirst:o===0,isLast:o+1===s.length,itemId:e,hint:a,pos:o,imageUploader:this.props.imageUploader,onChange:this.handleHintChange.bind(this,o),onRemove:this.handleHintRemove.bind(this,o),onMove:this.handleHintMove.bind(this,o),deviceType:this.props.deviceType,apiOptions:this.props.apiOptions,highlightLint:this.props.highlightLint,previewURL:this.props.previewURL,contentPaths:[]},"hintEditor"+o)},this);return n("div",{className:"perseus-hints-editor perseus-editor-table",children:[i,t("div",{className:"perseus-editor-row",children:t("div",{className:"add-hint-container perseus-editor-left-cell",children:n("button",{type:"button",className:"add-hint simple-button orange",onClick:this.addHint,children:[t(De,{...ki})," Add a hint"]})})})]})}};$e.HintEditor=A,$e.defaultProps={onChange:()=>{},hints:[],highlightLint:!1};let ae=$e;try{A.displayName="HintEditor",A.__docgenInfo={description:"",displayName:"HintEditor",props:{itemId:{defaultValue:null,description:"",name:"itemId",required:!1,type:{name:"string"}},apiOptions:{defaultValue:null,description:"",name:"apiOptions",required:!1,type:{name:"Readonly<{ isArticle?: boolean; onInputError?: ((widgetId: any, value: string, message?: string | null) => unknown) | undefined; onFocusChange?: ((newFocusPath: FocusPath, oldFocusPath: FocusPath, keypadHeight?: number | undefined, focusedElement?: HTMLElement | undefined) => unknown) | undef..."}},className:{defaultValue:{value:""},description:"",name:"className",required:!1,type:{name:"string"}},imageUploader:{defaultValue:null,description:"",name:"imageUploader",required:!1,type:{name:"ImageUploader"}},showMoveButtons:{defaultValue:{value:"true"},description:"",name:"showMoveButtons",required:!1,type:{name:"boolean"}},showRemoveButton:{defaultValue:{value:"true"},description:"",name:"showRemoveButton",required:!1,type:{name:"boolean"}},showTitle:{defaultValue:{value:"true"},description:"",name:"showTitle",required:!1,type:{name:"boolean"}},content:{defaultValue:{value:""},description:"",name:"content",required:!1,type:{name:"string | null"}},replace:{defaultValue:{value:"false"},description:"",name:"replace",required:!1,type:{name:"boolean | null"}},widgets:{defaultValue:null,description:"",name:"widgets",required:!1,type:{name:"WidgetDict | null"}},images:{defaultValue:null,description:"",name:"images",required:!1,type:{name:"ImageDict | null"}},isLast:{defaultValue:null,description:"",name:"isLast",required:!0,type:{name:"boolean"}},isFirst:{defaultValue:null,description:"",name:"isFirst",required:!0,type:{name:"boolean"}},onMove:{defaultValue:null,description:"",name:"onMove",required:!0,type:{name:"(direction: number) => unknown"}},onRemove:{defaultValue:null,description:"",name:"onRemove",required:!0,type:{name:"() => unknown"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"ChangeHandler"}},__type:{defaultValue:null,description:"",name:"__type",required:!1,type:{name:"enum",value:[{value:'"hint"'}]}}}}}catch{}try{ae.displayName="CombinedHintsEditor",ae.__docgenInfo={description:"",displayName:"CombinedHintsEditor",props:{apiOptions:{defaultValue:null,description:"",name:"apiOptions",required:!1,type:{name:"Readonly<{ isArticle?: boolean; onInputError?: ((widgetId: any, value: string, message?: string | null) => unknown) | undefined; onFocusChange?: ((newFocusPath: FocusPath, oldFocusPath: FocusPath, keypadHeight?: number | undefined, focusedElement?: HTMLElement | undefined) => unknown) | undef..."}},deviceType:{defaultValue:null,description:"",name:"deviceType",required:!0,type:{name:"enum",value:[{value:'"phone"'},{value:'"tablet"'},{value:'"desktop"'}]}},imageUploader:{defaultValue:null,description:"",name:"imageUploader",required:!1,type:{name:"ImageUploader"}},highlightLint:{defaultValue:{value:"false"},description:"",name:"highlightLint",required:!1,type:{name:"boolean"}},hints:{defaultValue:{value:"[]"},description:"",name:"hints",required:!1,type:{name:"readonly Hint[]"}},previewURL:{defaultValue:null,description:"",name:"previewURL",required:!0,type:{name:"string"}},onChange:{defaultValue:{value:"() => {}"},description:"",name:"onChange",required:!1,type:{name:"ChangeHandler"}},itemId:{defaultValue:null,description:"",name:"itemId",required:!1,type:{name:"string"}}}}}catch{}const Ei=Vs,Et=class Et extends c.Component{constructor(){super(...arguments),this.frame=c.createRef(),this.questionEditor=c.createRef(),this.itemExtrasEditor=c.createRef(),this.updateProps=(e,s,i)=>{const a=p(this.props).pick("question","answerArea");this.props.onChange(p(a).extend(e),s,i)},this.triggerPreviewUpdate=e=>{var s;(s=this.frame.current)==null||s.sendNewData(e)},this.handleEditorChange=(e,s,i)=>{const a=p.extend({},this.props.question,e);this.updateProps({question:a},s,i)},this.handleItemExtrasChange=(e,s,i)=>{const a=p.extend({},this.props.answerArea,e);this.updateProps({answerArea:a},s,i)},this.getSaveWarnings=()=>{var e;return(e=this.questionEditor.current)==null?void 0:e.getSaveWarnings()},this.serialize=e=>{var s,i;return{question:(s=this.questionEditor.current)==null?void 0:s.serialize(e),answerArea:(i=this.itemExtrasEditor.current)==null?void 0:i.serialize(),itemDataVersion:Ei}}}render(){const e=this.props.deviceType==="phone"||this.props.deviceType==="tablet";return n("div",{className:"perseus-editor-table",children:[n("div",{className:"perseus-editor-row perseus-question-container",children:[n("div",{className:"perseus-editor-left-cell",children:[t("div",{className:"pod-title",children:"Question"}),t(b,{ref:this.questionEditor,placeholder:"Type your question here...",className:"perseus-question-editor",imageUploader:this.props.imageUploader,onChange:this.handleEditorChange,apiOptions:this.props.apiOptions,showWordCount:!0,...this.props.question},this.props.itemId)]}),t("div",{className:"perseus-editor-right-cell",children:n("div",{id:"problemarea",children:[t(k,{deviceType:this.props.deviceType,nochrome:!0,children:t(ne,{ref:this.frame,datasetKey:"mobile",datasetValue:e,seamless:!0,url:this.props.previewURL},this.props.deviceType)}),t("div",{id:"hintsarea",className:"hintsarea",style:{display:"none"}})]})})]}),n("div",{className:"perseus-editor-row perseus-answer-container",children:[n("div",{className:"perseus-editor-left-cell",children:[t("div",{className:"pod-title",children:"Question extras"}),t(js,{ref:this.itemExtrasEditor,onChange:this.handleItemExtrasChange,...this.props.answerArea})]}),t("div",{className:"perseus-editor-right-cell",children:t("div",{id:"answer_area"})})]})]})}};Et.defaultProps={onChange:()=>{},question:{},answerArea:{}};let oe=Et;try{oe.displayName="ItemEditor",oe.__docgenInfo={description:"",displayName:"ItemEditor",props:{apiOptions:{defaultValue:null,description:"",name:"apiOptions",required:!1,type:{name:"Readonly<{ isArticle?: boolean; onInputError?: ((widgetId: any, value: string, message?: string | null) => unknown) | undefined; onFocusChange?: ((newFocusPath: FocusPath, oldFocusPath: FocusPath, keypadHeight?: number | undefined, focusedElement?: HTMLElement | undefined) => unknown) | undef..."}},deviceType:{defaultValue:null,description:"",name:"deviceType",required:!1,type:{name:"string"}},gradeMessage:{defaultValue:null,description:"",name:"gradeMessage",required:!1,type:{name:"string"}},imageUploader:{defaultValue:null,description:"",name:"imageUploader",required:!1,type:{name:"ImageUploader"}},wasAnswered:{defaultValue:null,description:"",name:"wasAnswered",required:!1,type:{name:"boolean"}},question:{defaultValue:{value:"{}"},description:"",name:"question",required:!1,type:{name:"any"}},answerArea:{defaultValue:{value:"{}"},description:"",name:"answerArea",required:!1,type:{name:"any"}},previewURL:{defaultValue:null,description:"",name:"previewURL",required:!0,type:{name:"string"}},onChange:{defaultValue:{value:"() => {}"},description:"",name:"onChange",required:!1,type:{name:"ChangeHandler"}},itemId:{defaultValue:null,description:"",name:"itemId",required:!1,type:{name:"string"}}}}}catch{}const{HUD:Oi}=v,Ot=class Ot extends c.Component{constructor(e){super(e),this.itemEditor=c.createRef(),this.hintsEditor=c.createRef(),this.toggleJsonMode=()=>{this.setState({json:this.serialize({keepDeletedWidgets:!0})},()=>{this.props.onChange({jsonMode:!this.props.jsonMode})})},this.handleChange=(s,i,a)=>{const o=p(this.props).pick("question","hints","answerArea");p(o).extend(s),this.props.onChange(o,i,a)},this.changeJSON=s=>{this.setState({json:s}),this.props.onChange(s)},this.state={json:p.pick(this.props,"question","answerArea","hints","itemDataVersion"),gradeMessage:"",wasAnswered:!1,highlightLint:!0},this._isMounted=!1}componentDidMount(){this._isMounted=!0,this.updateRenderer()}componentDidUpdate(){setTimeout(()=>{this.updateRenderer()})}componentWillUnmount(){this._isMounted=!1}updateRenderer(){var a,o;const e=!this.props.developerMode||!this.props.jsonMode;if(!this._isMounted||!e)return;const s=this.props.previewDevice==="phone"||this.props.previewDevice==="tablet",i={...this.getApiOptions(),customKeypad:s,isMobile:s};(o=this.itemEditor.current)==null||o.triggerPreviewUpdate({type:"question",data:p({item:this.serialize(),apiOptions:i,initialHintsVisible:0,device:this.props.previewDevice,linterContext:{contentType:"exercise",highlightLint:this.state.highlightLint,paths:this.props.contentPaths||[]},reviewMode:!0,legacyPerseusLint:(a=this.itemEditor.current)==null?void 0:a.getSaveWarnings()}).extend(p(this.props).pick("workAreaSelector","solutionAreaSelector","hintsAreaSelector","problemNum"))})}getApiOptions(){return{...P.defaults,...this.props.apiOptions}}getSaveWarnings(){var i,a;const e=(i=this.itemEditor.current)==null?void 0:i.getSaveWarnings(),s=(a=this.hintsEditor.current)==null?void 0:a.getSaveWarnings();return e.concat(s)}serialize(e){var s,i;return this.props.jsonMode?this.state.json:p.extend((s=this.itemEditor.current)==null?void 0:s.serialize(e),{hints:(i=this.hintsEditor.current)==null?void 0:i.serialize(e)})}scorePreview(){return this.renderer?this.renderer.scoreInput():null}render(){let e="framework-perseus";const s=this.props.previewDevice==="phone"||this.props.previewDevice==="tablet",i={...this.getApiOptions(),customKeypad:s,isMobile:s};return i.isMobile&&(e+=" "+Rs.MOBILE),n("div",{id:"perseus",className:e,children:[n("div",{style:{marginBottom:10},children:[this.props.developerMode&&n("span",{children:[n("label",{children:[" ","Developer JSON Mode:"," ",t("input",{type:"checkbox",checked:this.props.jsonMode,onChange:this.toggleJsonMode})]})," "]}),!this.props.jsonMode&&t(re,{deviceType:this.props.previewDevice,onViewportSizeChanged:this.props.onPreviewDeviceChange}),!this.props.jsonMode&&t(Oi,{message:"Style warnings",enabled:this.state.highlightLint,onClick:()=>{this.setState({highlightLint:!this.state.highlightLint})}})]}),this.props.developerMode&&this.props.jsonMode&&t("div",{children:t(Nt,{multiLine:!0,value:this.state.json,onChange:this.changeJSON})}),(!this.props.developerMode||!this.props.jsonMode)&&t(oe,{ref:this.itemEditor,itemId:this.props.itemId,question:this.props.question,answerArea:this.props.answerArea,imageUploader:this.props.imageUploader,onChange:this.handleChange,wasAnswered:this.state.wasAnswered,gradeMessage:this.state.gradeMessage,deviceType:this.props.previewDevice,apiOptions:i,previewURL:this.props.previewURL}),(!this.props.developerMode||!this.props.jsonMode)&&t(ae,{ref:this.hintsEditor,itemId:this.props.itemId,hints:this.props.hints,imageUploader:this.props.imageUploader,onChange:this.handleChange,deviceType:this.props.previewDevice,apiOptions:i,previewURL:this.props.previewURL,highlightLint:this.state.highlightLint})]})}};Ot.defaultProps={developerMode:!1,jsonMode:!1,onChange:()=>{}};let le=Ot;try{le.displayName="EditorPage",le.__docgenInfo={description:"",displayName:"EditorPage",props:{apiOptions:{defaultValue:null,description:"",name:"apiOptions",required:!1,type:{name:"Readonly<{ isArticle?: boolean; onInputError?: ((widgetId: any, value: string, message?: string | null) => unknown) | undefined; onFocusChange?: ((newFocusPath: FocusPath, oldFocusPath: FocusPath, keypadHeight?: number | undefined, focusedElement?: HTMLElement | undefined) => unknown) | undef..."}},answerArea:{defaultValue:null,description:"",name:"answerArea",required:!1,type:{name:"any"}},contentPaths:{defaultValue:null,description:"",name:"contentPaths",required:!1,type:{name:"readonly string[]"}},developerMode:{defaultValue:{value:"false"},description:"",name:"developerMode",required:!1,type:{name:"boolean"}},frameSource:{defaultValue:null,description:"",name:"frameSource",required:!0,type:{name:"string"}},hints:{defaultValue:null,description:"",name:"hints",required:!1,type:{name:"readonly Hint[]"}},imageUploader:{defaultValue:null,description:"",name:"imageUploader",required:!1,type:{name:"ImageUploader"}},itemDataVersion:{defaultValue:null,description:"",name:"itemDataVersion",required:!1,type:{name:"Version"}},itemId:{defaultValue:null,description:"",name:"itemId",required:!0,type:{name:"string"}},jsonMode:{defaultValue:{value:"false"},description:"",name:"jsonMode",required:!1,type:{name:"boolean"}},onChange:{defaultValue:{value:"() => {}"},description:"",name:"onChange",required:!1,type:{name:"ChangeHandler"}},onPreviewDeviceChange:{defaultValue:null,description:"",name:"onPreviewDeviceChange",required:!0,type:{name:"(arg1: DeviceType) => unknown"}},previewDevice:{defaultValue:null,description:"",name:"previewDevice",required:!0,type:{name:"enum",value:[{value:'"phone"'},{value:'"tablet"'},{value:'"desktop"'}]}},question:{defaultValue:null,description:"",name:"question",required:!1,type:{name:"any"}},previewURL:{defaultValue:null,description:"",name:"previewURL",required:!0,type:{name:"string"}}}}}catch{}const Ge=class Ge extends c.Component{render(){const{children:e,color:s,onClick:i,...a}=this.props;return t("div",{className:d.css(tt.baseButton,s==="green"&&tt.green,s==="orange"&&tt.orange),onClick:i,...a,children:e})}};Ge.propTypes={children:l.node,color:l.oneOf(["orange","green"]),onClick:l.func},Ge.defaultProps={children:null,color:"green",onClick:()=>{}};let I=Ge;const tt=d.StyleSheet.create({baseButton:{top:"0",fontSize:"11px",padding:"3px 10px",backgroundRepeat:"repeat-x",borderColor:`
             rgba(0, 0, 0, 0.1)
             rgba(0, 0, 0, 0.1)
             rgba(0, 0, 0, 0.25)
         `,color:"#ffffff",borderRadius:"3px",lineHeight:"15px",cursor:"pointer",transition:"box-shadow ease-in-out 0.15s",appearance:"none",textDecoration:"none",textAlign:"center",":hover":{boxShadow:`0 1px 1px rgba(0, 0, 0, 0.35),
                 inset 0 0 50px 5px rgba(255, 255, 255, 0.2)`}},green:{border:"1px solid #7fab07",backgroundColor:"#80ac07",backgroundImage:"linear-gradient(to bottom, #8aba08, #719807)",":hover":{borderBottomColor:"#547105",backgroundColor:"#719807"}},orange:{border:"1px solid #d45704",backgroundColor:"#d55704",backgroundImage:"linear-gradient(to bottom, #e35d04, #c04f03)",":hover":{borderBottomColor:"#983e03",backgroundColor:"#c04f03"}}});try{I.displayName="SimpleButton",I.__docgenInfo={description:"",displayName:"SimpleButton",props:{}}}catch{}const{InlineIcon:st}=v,{iconChevronDown:zt,iconTrash:Mi}=V,{MultiRenderer:Li}=Bs;class Me extends c.Component{constructor(){super(...arguments),this._handleSelectMode=e=>{if(this.props.onChange){const s=e.target.value;this.props.onChange(s)}}}render(){return n("label",{children:["Mode:"," ",n("select",{value:this.props.currentMode,onChange:this._handleSelectMode,children:[t("option",{value:"edit",children:"Edit"}),t("option",{value:"preview",children:"Preview"}),t("option",{value:"json",children:"Dev-only JSON"})]})]})}}function gs(r){return r.replace(/[A-Z]/g,e=>" "+e.toLowerCase())}function je(r){return r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()}function ms(r){return r.charAt(r.length-1)==="s"?r.slice(0,-1):r}function T(r){return["_multi",...r]}const mt=({depth:r,...e})=>{const i=`h${Math.min(r,5)+1}`;return t(i,{...e})},St=r=>{const{shape:e,data:s,path:i,actions:a,name:o,controls:h,...g}=r,f=o||gs(i[i.length-1]||""),N=t(Ui,{...g,shape:e,data:s,path:i,actions:a}),_=i.join(".");return e.type==="array"?t(Vi,{name:f,controls:h,path:i,shape:e,actions:a,children:N},_):e.type==="object"?t(qi,{name:f,controls:h,path:i,children:N},_):t(Ri,{name:f,controls:h,path:i,shape:e,children:N},_)},Ri=({name:r,controls:e,children:s,path:i,shape:a})=>{const h=(a.type==="content"||a.type==="hint")&&t("div",{className:d.css(u.containerHeader),children:t(mt,{depth:i.length,className:d.css(u.containerTitle),children:je(r)})});return n("div",{className:d.css(u.container),children:[n("span",{className:d.css(u.row,u.rowHeading),children:[t("div",{className:d.css(u.columnLeft),children:n("div",{className:"pod-title "+d.css(u.containerHeader),children:[t("div",{className:d.css(u.containerTitle),children:je(r)}),e]})}),t("div",{className:d.css(u.columnRight),children:h})]}),s]})},Vi=r=>{const{name:e,controls:s,children:i,path:a,shape:o,actions:h}=r;return n("div",{className:d.css(u.container),children:[s&&t("div",{className:d.css(u.columnLeft,u.containerHeader),children:s}),t("div",{children:i}),t("div",{className:d.css(u.columnLeft),children:n("a",{href:"javascript:void 0",onClick:()=>h.addArrayElement(a,o.elementShape),children:["Add a ",ms(e)]})})]})},qi=({name:r,controls:e,children:s,path:i})=>{const a=n("div",{className:d.css(u.containerHeader),children:[t(mt,{depth:i.length,className:d.css(u.containerTitle),children:je(r)}),e]}),o=(r||e)&&t("div",{className:d.css(u.containerHeader,u.previewCollectionHeader),children:t(mt,{depth:i.length,className:d.css(u.containerTitle),children:je(r)})}),h=a&&o;return n("div",{className:d.css(u.container),children:[h&&n("span",{className:d.css(u.row),children:[t("div",{className:d.css(u.columnLeft),children:a}),t("div",{className:d.css(u.columnRight),children:o})]}),t("div",{className:d.css(i.length>0&&u.contentIndent),children:s})]})},Ui=r=>{const{shape:e,data:s,...i}=r;return e.type==="content"?t(zi,{shape:e,data:s,...i}):e.type==="hint"?t(Di,{shape:e,data:s,...i}):e.type==="tags"?t(Fi,{shape:e,data:s,...i}):e.type==="array"?t(Hi,{shape:e,data:s,...i}):e.type==="object"?t(Wi,{shape:e,data:s,...i}):null},fs=r=>class extends c.Component{constructor(){super(...arguments),this.state={sticky:!1},this.updateStickiness=()=>{const i=Ue.findDOMNode(this).offsetHeight,a=window.innerHeight,o=i>a;o!==this.state.sticky&&this.setState({sticky:o})}}componentDidMount(){this.stickynessTimer=setInterval(this.updateStickiness,1e3),this.updateStickiness()}componentWillUnmount(){clearInterval(this.stickynessTimer)}render(){return t(r,{...this.props,sticky:this.state.sticky})}},zi=fs(r=>{const{data:e,path:s,actions:i,apiOptions:a,renderers:o,sticky:h}=r,g=t("div",{className:"framework-perseus",children:S(o).get(s)});return t("span",{children:n("div",{className:d.css(u.row),children:[t("div",{className:d.css(u.columnLeft),children:t("div",{className:d.css(h&&u.sticky),children:t(b,{...e,onChange:f=>i.mergeValueAtPath(s,f),apiOptions:a})})}),t("div",{className:d.css(u.columnRight),children:t("div",{className:d.css(h&&u.sticky),children:g})})]})})}),Di=fs(r=>{const{data:e,path:s,actions:i,apiOptions:a,renderers:o,sticky:h}=r,g=t("div",{className:"framework-perseus",children:S(o).get(s)});return n("div",{className:d.css(u.row),children:[t("div",{className:d.css(u.columnLeft),children:t("div",{className:d.css(h&&u.sticky),children:t(A,{...e,className:d.css(u.hintEditor),onChange:f=>i.mergeValueAtPath(s,f),apiOptions:a,showTitle:!1,showRemoveButton:!1,showMoveButtons:!1,onRemove:()=>{},onMove:f=>{},isFirst:!0,isLast:!0})})}),t("div",{className:d.css(u.columnRight),children:t("div",{className:d.css(h&&u.sticky),children:g})})]})}),Fi=r=>{const{data:e,path:s,actions:i,apiOptions:a}=r,{GroupMetadataEditor:o}=a;return o==null?null:t("div",{className:d.css(u.columnLeft),children:t("div",{className:d.css(u.tagsEditor),children:t(o,{value:e,onChange:h=>i.setValueAtPath(s,h),showTitle:!1})})})},Hi=r=>{const{shape:e,data:s,path:i,actions:a,...o}=r,h=gs(i[i.length-1]),g=ms(h),f=e.elementShape.type,N=f==="content"||f==="hint",_=s.map((Ss,O)=>{const Ae=i.concat(O),xs=[O>0&&t("div",{className:d.css(u.control),children:t(I,{color:"orange",title:"Move up",onClick:()=>a.moveArrayElementUp(Ae),children:t("div",{className:d.css(u.verticalFlip),children:t(st,{...zt})})})},"moveArrayElementUp"),O<s.length-1&&t("div",{className:d.css(u.control),children:t(I,{color:"orange",title:"Move down",onClick:()=>a.moveArrayElementDown(Ae),children:t(st,{...zt})})},"moveArrayElementDown"),t("div",{className:d.css(u.control),children:t(I,{color:"orange",title:"Delete",onClick:()=>a.removeArrayElement(Ae),children:t(st,{...Mi})})},"removeArrayElement")];return t("div",{className:d.css(u.arrayElement,!N&&u.arrayElementAndNotLeaf),children:c.createElement(St,{...o,key:O,shape:e.elementShape,data:Ss,path:Ae,actions:a,name:`${g} ${O+1}`,controls:xs})},O)});return t("div",{children:_})},Wi=r=>{const{shape:e,data:s,path:i,...a}=r,o=Object.keys(e.shape).map(h=>t("div",{className:d.css(u.objectElement),children:t(St,{...a,shape:e.shape[h],data:s[h],path:i.concat(h)})},h));return t("div",{children:o})};class Dt extends c.Component{constructor(){super(...arguments),this._renderLayout=()=>{const{Layout:e,apiOptions:s,item:i}=this.props;return t(e,{ref:a=>this.layout=a,item:i,apiOptions:s})},this._renderJson=()=>n("div",{children:[t(Me,{currentMode:this.props.editorMode,onChange:e=>this.props.onChange({editorMode:e})}),t(Nt,{multiLine:!0,value:this.props.item,onChange:e=>this.props.onChange({item:e})})]}),this._renderPreview=()=>n("div",{children:[t(Me,{currentMode:this.props.editorMode,onChange:e=>this.props.onChange({editorMode:e})}),this._renderLayout()]}),this.mergeValueAtPath=(e,s)=>{this.props.onChange({item:S(this.props.item).merge(T(e),s).freeze()})},this.setValueAtPath=(e,s)=>{this.props.onChange({item:S(this.props.item).set(T(e),s).freeze()})},this.addArrayElement=(e,s)=>{const i=S(this.props.item).get(T(e)).length,a=e.concat(i),o=qs(s);this.props.onChange({item:S(this.props.item).set(T(a),o).freeze()})},this.removeArrayElement=e=>{this.props.onChange({item:S(this.props.item).del(T(e)).freeze()})},this.moveArrayElementDown=e=>{const i=e[e.length-1]+1,a=e.slice(0,-1).concat(i),o=S(this.props.item).get(T(e)),h=S(this.props.item).get(T(a));this.props.onChange({item:S(this.props.item).set(T(e),h).set(T(a),o).freeze()})},this.moveArrayElementUp=e=>{const s=e[e.length-1],i=e.slice(0,-1).concat(s-1);this.moveArrayElementDown(i)},this._renderEdit=()=>{const e={...P.defaults,...this.props.apiOptions},{item:s}=this.props,i=this.props.Layout.shape;return n("div",{className:"perseus-multirenderer-editor",children:[t(Me,{currentMode:this.props.editorMode,onChange:a=>this.props.onChange({editorMode:a})}),t(Li,{item:s,shape:i,apiOptions:e,dependencies:{analytics:{onAnalyticsEvent:async()=>{}}},children:({renderers:a})=>t(St,{shape:i,data:Us(s),path:[],actions:this,apiOptions:e,renderers:a})})]})},this.score=()=>{if(this.layout)return this.layout.score()},this.getSerializedState=()=>{if(this.layout)return this.layout.getSerializedState()},this.restoreSerializedState=e=>{this.layout&&this.layout.restoreSerializedState(e)},this._renderContent=()=>{switch(this.props.editorMode){case"json":return this._renderJson();case"preview":return this._renderPreview();case"edit":return this._renderEdit();default:return t(Me,{currentMode:this.props.editorMode,onChange:e=>this.props.onChange({editorMode:e})})}}}render(){return t("div",{id:"perseus",children:this._renderContent()})}}const u=d.StyleSheet.create({container:{},editor:{width:"100%"},treePreview:{position:"relative"},verticalFlip:{transform:"scaleY(-1)"},control:{marginLeft:12},containerHeader:{alignItems:"flex-end",display:"flex",flexDirection:"row"},previewCollectionHeader:{marginBottom:16},containerTitle:{flexGrow:1,margin:0},contentIndent:{marginLeft:8},hintEditor:{paddingBottom:0},arrayElement:{marginBottom:16},arrayElementAndNotLeaf:{borderBottom:"1px solid #ccc",":first-child":{borderTop:"1px solid #ccc",paddingTop:16}},objectElement:{marginBottom:16},tagsEditor:{border:"1px solid #ddd",padding:"5px 10px"},row:{display:"flex",position:"relative"},columnLeft:{width:360,marginRight:30,position:"relative"},columnRight:{flex:1,marginLeft:30,position:"relative"},sticky:{position:"sticky",top:33},rowHeading:{position:"sticky",backgroundColor:"white",width:"100%",zIndex:101,top:-1}});try{Dt.displayName="MultiRendererEditor",Dt.__docgenInfo={description:"",displayName:"MultiRendererEditor",props:{Layout:{defaultValue:null,description:"",name:"Layout",required:!0,type:{name:"ComponentType<any> & LayoutStatics"}},apiOptions:{defaultValue:null,description:"",name:"apiOptions",required:!0,type:{name:"Readonly<{ isArticle?: boolean | undefined; onInputError?: ((widgetId: any, value: string, message?: string | null | undefined) => unknown) | undefined; onFocusChange?: ((newFocusPath: FocusPath, oldFocusPath: FocusPath, keypadHeight?: number | undefined, focusedElement?: HTMLElement | undefined) => unknown) | undef..."}},item:{defaultValue:null,description:"",name:"item",required:!0,type:{name:"Item"}},editorMode:{defaultValue:null,description:"",name:"editorMode",required:!0,type:{name:"enum",value:[{value:'"json"'},{value:'"edit"'},{value:'"preview"'}]}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"ChangeHandler"}}}}}catch{}_t({displayName:"StatefulArticleEditor",getInitialState:function(){return p({}).extend(this.props,{mode:"edit",onChange:this.handleChange,ref:"editor",screen:"phone"})},componentDidMount:function(){this._isMounted=!0},UNSAFE_componentWillReceiveProps:function(r){this.setState(p(r).omit("onChange","ref"))},componentWillUnmount:function(){this._isMounted=!1},getSaveWarnings:function(){return this.refs.editor.getSaveWarnings()},serialize:function(){return this.refs.editor.serialize()},handleChange:function(r,e){this._isMounted&&this.setState(r,e)},scorePreview:function(){return this.refs.editor.scorePreview()},render:function(){const{mode:r,screen:e}=this.state;return n("div",{children:[n("div",{style:C.controlBar,children:[n("span",{style:C.controls,children:["Mode:"," ",t("span",{onClick:()=>this.setState({mode:"edit"}),style:r==="edit"?C.controlSelected:C.control,children:"EDIT"})," | ",t("span",{onClick:()=>this.setState({mode:"preview"}),style:r==="preview"?C.controlSelected:C.control,children:"PREVIEW"})," | ",t("span",{onClick:()=>this.setState({mode:"json"}),style:r==="json"?C.controlSelected:C.control,children:"JSON"})]}),n("span",{style:C.controls,children:["Screen:"," ",t("span",{onClick:()=>this.setState({screen:"phone"}),style:e==="phone"?C.controlSelected:C.control,children:"PHONE"})," | ",t("span",{onClick:()=>this.setState({screen:"tablet"}),style:e==="tablet"?C.controlSelected:C.control,children:"TABLET"})," | ",t("span",{onClick:()=>this.setState({screen:"desktop"}),style:e==="desktop"?C.controlSelected:C.control,children:"DESKTOP"})]})]}),t("div",{style:C.editor,children:t(ut,{...this.state})})]})}});const C={controlBar:{marginBottom:25,marginTop:5},controls:{marginRight:10},controlSelected:{cursor:"default",fontWeight:700},control:{cursor:"pointer"},editor:{marginTop:-20}};_t({displayName:"StatefulEditorPage",propTypes:{componentClass:l.func},getDefaultProps:function(){return{componentClass:le}},render:function(){const r=this.props.componentClass;return t(r,{...this.state})},getInitialState:function(){return p({}).extend(p.omit(this.props,"componentClass"),{onChange:this.handleChange,ref:"editor"})},componentDidMount:function(){this._isMounted=!0},componentWillUnmount:function(){this._isMounted=!1},UNSAFE_componentWillReceiveProps:function(r){this.setState(p(r).pick("apiOptions","imageUploader","developerMode","problemNum","previewDevice","frameSource"))},getSaveWarnings:function(){return this.refs.editor.getSaveWarnings()},serialize:function(){return this.refs.editor.serialize()},handleChange:function(r,e){this._isMounted&&this.setState(r,e)},scorePreview:function(){return this.refs.editor.scorePreview()}});const{InfoTip:Ft,PropCheckBox:Ht}=v,Wt=400,jt=400;var L;let ji=(L=class extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.serialize=()=>w.serialize.call(this)}render(){return n("fieldset",{className:"pair-editor",children:[n("label",{children:["Name:"," ",t(x,{value:this.props.name,onChange:this.change("name")})]}),n("label",{children:[" ","Value:"," ",t(x,{value:this.props.value,onChange:this.change("value")})]})]})}},L.propTypes={...y,name:l.string,value:l.string},L.defaultProps={name:"",value:""},L);var ke;let Bi=(ke=class extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.handlePairChange=(e,s)=>{const i=this.props.pairs.slice();i[e]=s;const a=i[i.length-1];a.name&&a.value&&i.push({name:"",value:""}),this.change("pairs",i)},this.serialize=()=>w.serialize.call(this)}render(){const e=p.map(this.props.pairs,(s,i)=>t(ji,{name:s.name,value:s.value,onChange:this.handlePairChange.bind(this,i)},i));return t("div",{children:e})}},ke.propTypes={...y,pairs:l.arrayOf(l.shape({name:l.string,value:l.string})).isRequired},ke);const $i=/khanacademy\.org\/computer-programming\/[^\/]+\/(\d+)/;function Gi(r){const e=$i.exec(r);return e&&(r=e[1]),r}const D=class D extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this._handleSettingsChange=e=>{this.change({settings:e.pairs})},this._handleProgramIDChange=e=>{e=Gi(e);const{isDevServer:s,InitialRequestUrl:i}=rs(),o=`${s?i.origin:"https://www.khanacademy.org"}/api/internal/scratchpads/${e}`;Fs.getJSON(o).done(h=>{const g=h.userAuthoredContentType;this.change({width:h.width,height:h.height,programID:e,programType:g})}).fail((h,g,f)=>{as.error("Error retrieving scratchpad info for program ID ",lt.TransientService,{cause:f,loggedMetadata:{textStatus:g,programID:e}}),this.change({width:Wt,height:jt,programID:e,programType:null})})},this.serialize=()=>w.serialize.call(this)}render(){return n("div",{children:[n("label",{children:["Url or Program ID:"," ",t(x,{value:this.props.programID,onChange:this._handleProgramIDChange})]}),t("br",{}),t(Ht,{label:"Show Editor",showEditor:this.props.showEditor,onChange:this.props.onChange}),t(Ft,{children:'If you show the editor, you should use the "full-width" alignment to make room for the width of the editor.'}),t("br",{}),t(Ht,{label:"Show Buttons",showButtons:this.props.showButtons,onChange:this.props.onChange}),t("br",{}),n("label",{children:["Settings:",t(Bi,{name:"settings",pairs:this.props.settings,onChange:this._handleSettingsChange}),n(Ft,{children:["Settings that you add here are available to the program as an object returned by ",t("code",{children:"Program.settings()"})]})]})]})}};D.propTypes={...y},D.widgetName="cs-program",D.defaultProps={programID:"",programType:null,settings:[{name:"",value:""}],showEditor:!1,showButtons:!1,width:Wt,height:jt};let pe=D;try{pe.displayName="CSProgramEditor",pe.__docgenInfo={description:"This is the main editor for this widget, to specify all the options.",displayName:"CSProgramEditor",props:{}}}catch{}const Mt=class Mt extends c.Component{serialize(){return w.serialize.call(this)}render(){return n("div",{children:[t("p",{children:"This widget has been deprecated and removed"}),t("p",{children:"Learners will see a message and they will not be graded on this part. Please replace this widget with a supported one."})]})}};Mt.widgetName="deprecated-standin";let he=Mt;try{he.displayName="DeprecatedStandinEditor",he.__docgenInfo={description:"",displayName:"DeprecatedStandinEditor",props:{onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(options: any) => void"}}}}}catch{}const{Graphie:ys}=v,it=ys.MovablePoint;var R;let Ki=(R=class extends c.Component{constructor(){super(...arguments),this.getUserInput=()=>Is.getUserInput.call(this),this.change=(...e)=>m.apply(this,e),this.movePoint=e=>{this.change({coord:e})},this._getGridConfig=e=>p.map(e.step,function(s,i){return Fe.gridDimensionConfig(s,e.range[i],e.box[i],e.gridStep[i])}),this.setupGraphie=(e,s)=>{const i=this._getGridConfig(s);e.graphInit({range:s.range,scale:p.pluck(i,"scale"),axisArrows:"<->",labelFormat:function(a){return"\\small{"+a+"}"},gridStep:s.gridStep,tickStep:p.pluck(i,"tickStep"),labelStep:1,unityLabels:p.pluck(i,"unityLabel")}),e.label([0,s.range[1][1]],s.labels[1],"above")},this.simpleValidate=e=>R.validate(this.getUserInput(),e)}static validate(e,s){return e.coord==null?{type:"invalid",message:null}:Hs(e.coord,s.correct)?{type:"points",earned:1,total:1,message:null}:{type:"points",earned:0,total:1,message:null}}render(){var e;return t(ys,{ref:"graphie",box:this.props.graph.box,range:this.props.graph.range,options:this.props.graph,setup:this.setupGraphie,setDrawingAreaAvailable:(e=this.props.apiOptions)==null?void 0:e.setDrawingAreaAvailable,children:t(it,{pointSize:5,coord:this.props.coord||[0,0],constraints:[it.constraints.snap(),it.constraints.bound()],onMove:this.movePoint})})}},R.defaultProps={coord:null,graph:{box:[400,400],labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],gridStep:[1,1],valid:!0,backgroundImage:null,markings:"grid",showProtractor:!1}},R);const vs={name:"example-graphie-widget",displayName:"Example Graphie Widget",hidden:!0,widget:Ki};try{examplegraphiewidget.displayName="examplegraphiewidget",examplegraphiewidget.__docgenInfo={description:`For this widget to work, we must export it.
We also must import this file in src/all-widgets.js`,displayName:"examplegraphiewidget",props:{}}}catch{}const Ji=vs.widget,F=class F extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.handleChange=e=>{e.coord&&this.change({correct:e.coord})},this.serialize=()=>w.serialize.call(this)}render(){return t("div",{children:t(Ji,{graph:this.props.graph,coord:this.props.correct,onChange:this.handleChange,apiOptions:this.props.apiOptions})})}};F.propTypes={...y},F.widgetName="example-graphie-widget",F.defaultProps={correct:[4,4],graph:{box:[340,340],labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],gridStep:[1,1],valid:!0,backgroundImage:null,markings:"grid",showProtractor:!1}};let ce=F;try{ce.displayName="ExampleGraphieWidgetEditor",ce.__docgenInfo={description:`This is the widget's editor. This is what shows up on the left side
of the screen in the demo page. Only the question writer sees this.`,displayName:"ExampleGraphieWidgetEditor",props:{}}}catch{}const H=class H extends c.Component{constructor(){super(...arguments),this.input=c.createRef(),this.handleAnswerChange=e=>{this.change({correct:e.target.value})},this.change=(...e)=>m.apply(this,e),this.focus=()=>{var e;return(e=this.input.current)==null||e.focus(),!0},this.serialize=()=>w.serialize.call(this)}render(){return t("div",{children:n("label",{children:["Correct answer:",t("input",{value:this.props.correct,onChange:this.handleAnswerChange,ref:this.input})]})})}};H.propTypes={...y},H.widgetName="example-widget",H.defaultProps={correct:""};let de=H;try{de.displayName="ExampleWidgetEditor",de.__docgenInfo={description:`This is the widget's editor. This is what shows up on the left side
of the screen in the demo. Only the question writer sees this.`,displayName:"ExampleWidgetEditor",props:{}}}catch{}const{InlineIcon:Bt,TextInput:Yi}=v,{iconPlus:Xi,iconTrash:Zi}=V,W=class W extends c.Component{constructor(){super(...arguments),this.editor=c.createRef(),this.hintEditor=c.createRef(),this.change=(...e)=>m.apply(this,e),this.handleAddHint=()=>{const e={content:""};this.props.onChange({hint:e},()=>{var s;(s=this.hintEditor.current)==null||s.focus()})},this.handleRemoveHint=e=>{this.props.onChange({hint:null})},this.getSaveWarnings=()=>{var e;return(e=this.editor.current)==null?void 0:e.getSaveWarnings()},this.serialize=()=>{var e,s;return{title:this.props.title,...(e=this.editor.current)==null?void 0:e.serialize(),hint:(s=this.hintEditor.current)==null?void 0:s.serialize()}}}render(){return n("div",{className:"perseus-group-editor",children:[t("div",{className:"perseus-widget-row",children:n("label",{className:d.css(nt.title),children:["Title:"," ",t(Yi,{value:this.props.title,className:d.css(nt.input),onChange:this.change("title")})]})}),t(b,{ref:this.editor,content:this.props.content,widgets:this.props.widgets,apiOptions:this.props.apiOptions,images:this.props.images,widgetEnabled:!0,immutableWidgets:!1,onChange:this.props.onChange,warnNoPrompt:!0,warnNoWidgets:!0}),!this.props.hint&&n("button",{type:"button",style:{marginTop:10},className:"add-hint simple-button orange",onClick:this.handleAddHint,children:[t(Bt,{...Xi})," Add a hint"]}),this.props.hint&&n("div",{className:"perseus-hint-editor",children:[t("div",{className:d.css(nt.hintsTitle),children:"Hint"}),t(b,{ref:this.hintEditor,content:this.props.hint?this.props.hint.content:"",widgets:this.props.hint?this.props.hint.widgets:{},apiOptions:this.props.apiOptions,images:this.props.hint&&this.props.hint.images,widgetEnabled:!0,immutableWidgets:!1,onChange:e=>{this.change("hint",Object.assign({},this.props.hint,e))}}),n("button",{type:"button",className:"remove-hint simple-button orange",onClick:this.handleRemoveHint,children:[t(Bt,{...Zi})," Remove this hint"]})]})]})}};W.propTypes={...y,title:l.string,content:l.string,widgets:l.object,images:l.object,apiOptions:P.propTypes},W.widgetName="graded-group",W.defaultProps={title:"",content:"",widgets:{},images:{},hint:null};let E=W;const nt=d.StyleSheet.create({title:{fontSize:18,fontWeight:"bold"},input:{fontSize:18},hintsTitle:{marginTop:10,fontSize:"110%",fontWeight:"bold"}});try{E.displayName="GradedGroupEditor",E.__docgenInfo={description:"",displayName:"GradedGroupEditor",props:{}}}catch{}const j=class j extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.getSaveWarnings=()=>[].concat(...this._editors.map(e=>e?e.getSaveWarnings():[])),this.serialize=()=>({gradedGroups:this.props.gradedGroups}),this.renderGroups=()=>this.props.gradedGroups?this.props.gradedGroups.map((e,s)=>t(E,{ref:i=>this._editors[s]=i,...e,apiOptions:this.props.apiOptions,widgetEnabled:!0,immutableWidgets:!1,onChange:i=>this.change("gradedGroups",Qi(this.props.gradedGroups,s,{...this.props.gradedGroups[s],...i}))},s)):null,this.addGroup=()=>{const e=this.props.gradedGroups||[];this.change("gradedGroups",e.concat([E.defaultProps]))}}UNSAFE_componentWillMount(){this._editors=[]}render(){return n("div",{className:"perseus-group-editor",children:[this.renderGroups(),t("button",{onClick:this.addGroup,children:"Add group"})]})}};j.propTypes={...y,apiOptions:P.propTypes,gradedGroups:l.array,onChange:l.func.isRequired},j.widgetName="graded-group-set",j.defaultProps={gradedGroups:[]};let ue=j;const Qi=(r,e,s)=>[...r.slice(0,e),s,...r.slice(e+1)];try{ue.displayName="GradedGroupSetEditor",ue.__docgenInfo={description:"",displayName:"GradedGroupSetEditor",props:{}}}catch{}const{InfoTip:en,MultiButtonGroup:tn}=v,{containerSizeClass:sn,getInteractiveBoxFromSizeClass:nn}=zs,rn=Ps.widget,{DEFAULT_GRAPHER_PROPS:rt,allTypes:an,chooseType:on,defaultPlotProps:ln,getEquationString:pn,typeToButton:hn}=ks,B=class B extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.handleAvailableTypesChange=e=>{let s=this.props.correct;if(!p.contains(e,this.props.correct.type)){const i=this.props.graph,a=on(e);s=ln(a,i)}this.props.onChange({availableTypes:e,correct:s})},this.serialize=()=>p.chain(this.props).pick("correct","availableTypes").extend({graph:p.omit(this.props.graph,"box")}).value()}render(){const e=sn.SMALL;let s,i;if(this.props.graph.valid===!0){const a={graph:this.props.graph,plot:this.props.correct,availableTypes:this.props.availableTypes,onChange:(o,h)=>{var f;let g=this.props.correct;g.type===((f=o.plot)==null?void 0:f.type)?g=p.extend({},g,o.plot):g=o.plot,this.props.onChange({correct:g},h)},trackInteraction:function(){}};i=t(rn,{...a,apiOptions:this.props.apiOptions,containerSizeClass:e}),s=pn(a)}else i=t("div",{className:"perseus-error",children:this.props.graph.valid});return n("div",{children:[n("div",{children:["Correct answer"," ",t(en,{children:t("p",{children:"Graph the correct answer in the graph below and ensure the equation or point coordinates displayed represent the correct answer."})})," ",": ",s]}),t(Xs,{editableSettings:["graph","snap","image"],box:nn(e),range:this.props.graph.range,labels:this.props.graph.labels,step:this.props.graph.step,gridStep:this.props.graph.gridStep,snapStep:this.props.graph.snapStep,valid:this.props.graph.valid,backgroundImage:this.props.graph.backgroundImage,markings:this.props.graph.markings,rulerLabel:this.props.graph.rulerLabel,rulerTicks:this.props.graph.rulerTicks,showTooltips:this.props.graph.showTooltips,onChange:this.change("graph")}),n("div",{className:"perseus-widget-row",children:[t("label",{children:"Available functions: "}),t(tn,{allowEmpty:!1,values:this.props.availableTypes,buttons:p.map(an,hn),onChange:this.handleAvailableTypesChange})]}),i]})}};B.propTypes={...y},B.widgetName="grapher",B.defaultProps={correct:rt.plot,graph:rt.graph,availableTypes:rt.availableTypes};let ge=B;try{ge.displayName="GrapherEditor",ge.__docgenInfo={description:"",displayName:"GrapherEditor",props:{}}}catch{}const $=class $ extends c.Component{constructor(){super(...arguments),this.editor=c.createRef(),this._renderMetadataEditor=()=>{const e=this.props.apiOptions.GroupMetadataEditor;return t(e,{value:this.props.metadata,onChange:this.change("metadata")})},this.change=(...e)=>m.apply(this,e),this.getSaveWarnings=()=>{var e;return(e=this.editor.current)==null?void 0:e.getSaveWarnings()},this.serialize=()=>{var e;return p.extend({},(e=this.editor.current)==null?void 0:e.serialize(),{metadata:this.props.metadata})}}render(){return n("div",{className:"perseus-group-editor",children:[t("div",{children:this._renderMetadataEditor()}),t(b,{ref:this.editor,content:this.props.content,widgets:this.props.widgets,apiOptions:this.props.apiOptions,images:this.props.images,widgetEnabled:!0,immutableWidgets:!1,onChange:this.props.onChange})]})}};$.propTypes={...y,content:l.string,widgets:l.object,images:l.object,metadata:l.any,apiOptions:P.propTypes},$.widgetName="group",$.defaultProps={content:"",widgets:{},images:{},metadata:void 0};let me=$;try{me.displayName="GroupEditor",me.__docgenInfo={description:"",displayName:"GroupEditor",props:{}}}catch{}const{PropCheckBox:$t}=v,Ke=class Ke extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.serialize=()=>w.serialize.call(this)}render(){return n("fieldset",{children:[n("label",{children:["Name:",t(x,{value:this.props.name,onChange:this.change("name")})]}),n("label",{children:["Value:",t(x,{value:this.props.value,onChange:this.change("value")})]})]})}};Ke.propTypes={...y,name:l.string,value:l.string},Ke.defaultProps={name:"",value:""};let ft=Ke;const Lt=class Lt extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.handlePairChange=(e,s)=>{const i=this.props.pairs.slice();i[e]=s;const a=i[i.length-1];a.name&&a.value&&i.push({name:"",value:""}),this.change("pairs",i)},this.serialize=()=>w.serialize.call(this)}render(){const e=p.map(this.props.pairs,(s,i)=>t(ft,{name:s.name,value:s.value,onChange:this.handlePairChange.bind(this,i)},i));return t("div",{children:e})}};Lt.propTypes={...y,pairs:l.arrayOf(l.shape({name:l.string,value:l.string})).isRequired};let yt=Lt;const G=class G extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.handleSettingsChange=e=>{this.change({settings:e.pairs})},this.serialize=()=>w.serialize.call(this)}render(){return n("div",{children:[n("div",{style:{fontWeight:"bold",textAlign:"center"},children:["This widget is deprecated! ",t("br",{}),"Try using the Video or CS Program widgets instead."]}),n("label",{children:["Url or Program ID:",t(x,{value:this.props.url,onChange:this.change("url")})]}),t("br",{}),n("label",{children:["Settings:",t(yt,{name:"settings",pairs:this.props.settings,onChange:this.handleSettingsChange})]}),t("br",{}),n("label",{children:["Width:",t(x,{value:this.props.width,onChange:this.change("width")})]}),n("label",{children:["Height:",t(x,{value:this.props.height,onChange:this.change("height")})]}),t($t,{label:"Allow full screen",allowFullScreen:this.props.allowFullScreen,onChange:this.props.onChange}),t("br",{}),t($t,{label:"Allow iframe content to redirect the page",allowTopNavigation:this.props.allowTopNavigation,onChange:this.props.onChange})]})}};G.propTypes={...y},G.widgetName="iframe",G.defaultProps={url:"",settings:[{name:"",value:""}],width:"400",height:"400",allowFullScreen:!1,allowTopNavigation:!1};let fe=G;try{fe.displayName="IframeEditor",fe.__docgenInfo={description:"This is the main editor for this widget, to specify all the options.",displayName:"IframeEditor",props:{}}}catch{}const{RangeInput:cn}=v,dn=As.widget,Gt=6,un=function(r){const e=[1,1];return p(r).each((s,i)=>{let a=0;p(s).each((o,h)=>{o!=null&&o.toString().length&&(a=h+1)}),e[1]=Math.max(e[1],a),a>0&&(e[0]=Math.max(e[0],i+1))}),e},K=class K extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.onMatrixBoardSizeChange=e=>{const s=un(this.props.answers);if(e[0]!==null&&e[1]!==null){e=[Math.round(Math.min(Math.max(e[0],1),Gt)),Math.round(Math.min(Math.max(e[1],1),Gt))];const i=p(Math.min(e[0],s[0])).times(a=>p(Math.min(e[1],s[1])).times(o=>this.props.answers[a][o]));this.props.onChange({matrixBoardSize:e,answers:i})}},this.serialize=()=>w.serialize.call(this)}render(){const e=p.extend({numericInput:!0,onBlur:()=>{},onFocus:()=>{},trackInteraction:()=>{}},this.props);return n("div",{className:"perseus-matrix-editor",children:[n("div",{className:"perseus-widget-row",children:[" ","Max matrix size:"," ",t(cn,{value:this.props.matrixBoardSize,onChange:this.onMatrixBoardSizeChange,format:this.props.labelStyle,useArrowKeys:!0})]}),t("div",{className:"perseus-widget-row",children:t(dn,{...e})}),n("div",{className:"perseus-widget-row",children:[" ","Matrix prefix:"," ",t(b,{ref:"prefix",apiOptions:this.props.apiOptions,content:this.props.prefix,widgetEnabled:!1,onChange:s=>{this.change({prefix:s.content})}})]}),n("div",{className:"perseus-widget-row",children:[" ","Matrix suffix:"," ",t(b,{ref:"suffix",apiOptions:this.props.apiOptions,content:this.props.suffix,widgetEnabled:!1,onChange:s=>{this.change({suffix:s.content})}})]})]})}};K.propTypes={...y,matrixBoardSize:l.arrayOf(l.number).isRequired,answers:l.arrayOf(l.arrayOf(l.number)),prefix:l.string,suffix:l.string,cursorPosition:l.arrayOf(l.number)},K.widgetName="matrix",K.defaultProps={matrixBoardSize:[3,3],answers:[[]],prefix:"",suffix:"",cursorPosition:[0,0]};let ye=K;try{ye.displayName="MatrixEditor",ye.__docgenInfo={description:"",displayName:"MatrixEditor",props:{}}}catch{}const{InfoTip:gn,NumberInput:Le,PropCheckBox:Kt,RangeInput:mn}=v,fn={url:null,top:0,left:0},J=class J extends c.Component{constructor(){super(...arguments),this.className="perseus-widget-measurer",this.change=(...e)=>m.apply(this,e),this._changeUrl=e=>{this._changeImage("url",e.target.value)},this._changeTop=e=>{this._changeImage("top",e)},this._changeLeft=e=>{this._changeImage("left",e)},this._changeImage=(e,s)=>{const i=p.clone(this.props.image);i[e]=s,this.change("image",i)},this.renderLabelChoices=e=>p.map(e,function(s){const[i,a]=s;return t("option",{value:a,children:i},a)}),this.serialize=()=>w.serialize.call(this)}render(){const e=p.extend({},fn,this.props.image);return n("div",{className:"perseus-widget-measurer",children:[t("div",{children:"Image displayed under protractor and/or ruler:"}),n("div",{children:["URL:"," ",t("input",{type:"text",className:"perseus-widget-measurer-url",ref:"image-url",defaultValue:e.url,onChange:this._changeUrl}),t(gn,{children:t("p",{children:'Create an image in graphie, or use the "Add image" function to create a background.'})})]}),e.url&&n("div",{className:"perseus-widget-row",children:[n("label",{className:"perseus-widget-left-col",children:["Pixels from top:"," ",t(Le,{placeholder:0,onChange:this._changeTop,value:e.top,useArrowKeys:!0})]}),n("label",{className:"perseus-widget-right-col",children:["Pixels from left:"," ",t(Le,{placeholder:0,onChange:this._changeLeft,value:e.left,useArrowKeys:!0})]})]}),n("div",{children:["Containing area [width, height]:"," ",t(mn,{onChange:this.change("box"),value:this.props.box,useArrowKeys:!0})]}),n("div",{className:"perseus-widget-row",children:[t("div",{className:"perseus-widget-left-col",children:t(Kt,{label:"Show ruler",showRuler:this.props.showRuler,onChange:this.props.onChange})}),t("div",{className:"perseus-widget-right-col",children:t(Kt,{label:"Show protractor",showProtractor:this.props.showProtractor,onChange:this.props.onChange})})]}),this.props.showRuler&&n("div",{children:[t("div",{children:n("label",{children:[" ","Ruler label:"," ",n("select",{onChange:s=>this.change("rulerLabel",s.target.value),value:this.props.rulerLabel,children:[t("option",{value:"",children:"None"}),t("optgroup",{label:"Metric",children:this.renderLabelChoices([["milimeters","mm"],["centimeters","cm"],["meters","m"],["kilometers","km"]])}),t("optgroup",{label:"Imperial",children:this.renderLabelChoices([["inches","in"],["feet","ft"],["yards","yd"],["miles","mi"]])})]})]})}),t("div",{children:n("label",{children:[" ","Ruler ticks:"," ",t("select",{onChange:s=>this.change("rulerTicks",+s.target.value),value:this.props.rulerTicks,children:p.map([1,2,4,8,10,16],function(s){return t("option",{value:s,children:s},s)})})]})}),t("div",{children:n("label",{children:["Ruler pixels per unit:"," ",t(Le,{placeholder:40,onChange:this.change("rulerPixels"),value:this.props.rulerPixels,useArrowKeys:!0})]})}),t("div",{children:n("label",{children:["Ruler length in units:"," ",t(Le,{placeholder:10,onChange:this.change("rulerLength"),value:this.props.rulerLength,useArrowKeys:!0})]})})]})]})}};J.widgetName="measurer",J.propTypes={...y,box:l.arrayOf(l.number),image:l.shape({url:l.string,top:l.number,left:l.number}),showProtractor:l.bool,showRuler:l.bool,rulerLabel:l.string,rulerTicks:l.number,rulerPixels:l.number,rulerLength:l.number},J.defaultProps={box:[480,480],image:{},showProtractor:!0,showRuler:!1,rulerLabel:"",rulerTicks:10,rulerPixels:40,rulerLength:10};let ve=J;try{ve.displayName="MeasurerEditor",ve.__docgenInfo={description:"",displayName:"MeasurerEditor",props:{}}}catch{}const{NumberInput:yn,TextInput:vn}=v,Je=class Je extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.updateMolecule=e=>{this.change({smiles:e})},this.updateRotation=e=>{this.change({rotationAngle:e})},this.serialize=()=>w.serialize.call(this)}render(){return n("div",{children:[t("div",{children:n("label",{children:["SMILES:",t(vn,{onChange:this.updateMolecule,value:this.props.smiles})]})}),t("div",{children:n("label",{children:["Rotation (deg):",t(yn,{onChange:this.updateRotation,value:this.props.rotationAngle})]})})]})}};Je.propTypes={...y,rotationAngle:l.number,smiles:l.string},Je.widgetName="molecule-renderer";let we=Je;try{we.displayName="MoleculeWidgetEditor",we.__docgenInfo={description:"",displayName:"MoleculeWidgetEditor",props:{}}}catch{}const{InfoTip:Re,TextListEditor:Jt}=v,at="normal",Yt="auto",ot="horizontal",Xt="vertical",Y=class Y extends c.Component{constructor(){super(...arguments),this.onOptionsChange=(e,s,i)=>{const a={};a[e]=p.map(s,function(o){return{content:o}}),this.props.onChange(a,i)},this.onLayoutChange=e=>{this.props.onChange({layout:e.target.value})},this.onHeightChange=e=>{this.props.onChange({height:e.target.value})},this.serialize=()=>({options:p.chain(p.pluck(this.props.correctOptions,"content")).union(p.pluck(this.props.otherOptions,"content")).uniq().reject(function(s){return s===""}).sort().sortBy(function(s){return/\d/.test(s)?0:/^\$?[a-zA-Z]+\$?$/.test(s)?2:1}).map(function(s){return{content:s}}).value(),correctOptions:this.props.correctOptions,otherOptions:this.props.otherOptions,height:this.props.height,layout:this.props.layout})}render(){return n("div",{className:"perseus-widget-orderer",children:[n("div",{children:[" ","Correct answer:"," ",t(Re,{children:t("p",{children:"Place the cards in the correct order. The same card can be used more than once in the answer but will only be displayed once at the top of a stack of identical cards."})})]}),t(Jt,{options:p.pluck(this.props.correctOptions,"content"),onChange:this.onOptionsChange.bind(this,"correctOptions"),layout:this.props.layout}),n("div",{children:[" ","Other cards:"," ",t(Re,{children:t("p",{children:"Create cards that are not part of the answer."})})]}),t(Jt,{options:p.pluck(this.props.otherOptions,"content"),onChange:this.onOptionsChange.bind(this,"otherOptions"),layout:this.props.layout}),n("div",{children:[n("label",{children:[" ","Layout:"," ",n("select",{value:this.props.layout,onChange:this.onLayoutChange,children:[t("option",{value:ot,children:"Horizontal"}),t("option",{value:Xt,children:"Vertical"})]})]}),t(Re,{children:t("p",{children:"Use the horizontal layout for short text and small images. The vertical layout is best for longer text (e.g. proofs)."})})]}),n("div",{children:[n("label",{children:[" ","Height:"," ",n("select",{value:this.props.height,onChange:this.onHeightChange,children:[t("option",{value:at,children:"Normal"}),t("option",{value:Yt,children:"Automatic"})]})]}),t(Re,{children:t("p",{children:'Use "Normal" for text, "Automatic" for images.'})})]})]})}};Y.propTypes={correctOptions:l.array,otherOptions:l.array,height:l.oneOf([at,Yt]),layout:l.oneOf([ot,Xt]),onChange:l.func.isRequired},Y.widgetName="orderer",Y.defaultProps={correctOptions:[{content:"$x$"}],otherOptions:[{content:"$y$"}],height:at,layout:ot};let Ce=Y;try{Ce.displayName="OrdererEditor",Ce.__docgenInfo={description:"",displayName:"OrdererEditor",props:{}}}catch{}const{InfoTip:Zt,PropCheckBox:wn}=v,X=class X extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.serialize=()=>w.serialize.call(this)}render(){const e=t(b,{ref:"passage-editor",apiOptions:this.props.apiOptions,content:this.props.passageText,widgetEnabled:!1,placeholder:"Type passage here...",onChange:i=>{this.change({passageText:i.content})},showWordCount:!0}),s=t(b,{ref:"passage-footnotes-editor",apiOptions:this.props.apiOptions,content:this.props.footnotes,widgetEnabled:!1,placeholder:"Type footnotes here...",onChange:i=>{this.change({footnotes:i.content})}});return n("div",{className:"perseus-widget-passage-editor",children:[t("div",{className:"perseus-widget-row",children:t(wn,{label:"Show line numbers",labelAlignment:"right",showLineNumbers:this.props.showLineNumbers,onChange:this.props.onChange})}),n("div",{children:["Passage title:",t(Zt,{children:t("p",{children:"An optional title that will appear directly above the passage in the same font style. (E.g. Passage 1)"})}),t("div",{children:t("input",{type:"text",defaultValue:this.props.passageTitle,onChange:i=>{this.change({passageTitle:i.target.value})}})})]}),n("div",{children:["Passage Text:",e]}),n("div",{children:["Footnotes:",t(Zt,{children:t("p",{children:"To add footnotes, add ^ characters where they belong in the passage. Then, add ^ in the footnotes area to reference the footnotes in the passage."})}),s]})]})}};X.propTypes={...y,passageTitle:l.string,passageText:l.string,footnotes:l.string,showLineNumbers:l.bool},X.widgetName="passage",X.defaultProps={passageTitle:"",passageText:"",footnotes:"",showLineNumbers:!0};let be=X;try{be.displayName="PassageEditor",be.__docgenInfo={description:"",displayName:"PassageEditor",props:{}}}catch{}const{InfoTip:Cn,NumberInput:Qt,TextInput:bn}=v,Z=class Z extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.serialize=()=>w.serialize.call(this)}render(){return n("div",{children:[t("div",{children:n("label",{children:["Passage Number: ",t(Qt,{value:this.props.passageNumber,onChange:this.change("passageNumber")})]})}),t("div",{children:n("label",{children:["Reference Number: ",t(Qt,{value:this.props.referenceNumber,onChange:this.change("referenceNumber")})]})}),t("div",{children:n("label",{children:["Summary Text: ",t(bn,{value:this.props.summaryText,onChange:this.change("summaryText")}),n(Cn,{children:[t("p",{children:"Short summary of the referenced section. This will be included in parentheses and quotes automatically."}),t("p",{children:"Ex: The start ... the end"})]})]})})]})}};Z.propTypes={...y,passageNumber:l.number,referenceNumber:l.number,summaryText:l.string},Z.widgetName="passage-ref",Z.defaultProps={passageNumber:1,referenceNumber:1,summaryText:""};let _e=Z;try{_e.displayName="PassageRefEditor",_e.__docgenInfo={description:"",displayName:"PassageRefEditor",props:{}}}catch{}const Q=class Q extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.handleContentChange=e=>{this.change({content:e.target.value})},this.serialize=()=>w.serialize.call(this)}render(){return n("div",{children:["Content:",t("input",{type:"text",value:this.props.content,onChange:this.handleContentChange})]})}};Q.propTypes={...y,content:l.string},Q.widgetName="passage-ref-target",Q.defaultProps={content:""};let Ne=Q;try{Ne.displayName="PassageRefTargetEditor",Ne.__docgenInfo={description:"",displayName:"PassageRefTargetEditor",props:{}}}catch{}const{InfoTip:U,NumberInput:es,RangeInput:_n,TextListEditor:Nn}=v,Sn=Es.widget,vt="starting",wt="correct",xn=[vt,wt];function ts(r,e,s){const i=p.clone(r);i.length=e;for(let a=r.length;a<e;a++)i[a]=s;return i}const Ve={scaleY:1,maxY:10,snapsPerLine:2},ss=r=>"$"+Ds(r,2)+"$",Ye=class Ye extends c.Component{constructor(){super(...arguments),this.state={editing:this.props.static?vt:wt,pic:null,loadedUrl:null,minX:null,maxX:null,tickStep:null},this.fetchPic=e=>{if(this.state.loadedUrl!==e){const s=new Image;s.src=e,s.onload=()=>{this.setState({pic:s,loadedUrl:e})}}},this.handleChangeTickStep=e=>{this.setState({tickStep:e})},this.handleChangeRange=e=>{this.setState({minX:e[0],maxX:e[1]})},this.changeLabelInterval=e=>{this.props.onChange({labelInterval:e})},this.handlePlotterChange=e=>{const s={};s[this.state.editing]=e.values,this.props.onChange(s)},this.changeType=e=>{let s;if(e==="histogram"?(s=[ss(0)].concat(this.props.categories),this.props.onChange({type:e,categories:s})):this.props.type==="histogram"?(s=this.props.categories.slice(1),this.props.onChange({type:e,categories:s})):this.props.onChange({type:e}),s){const i=Ue.findDOMNode(this.refs.categories);i.value=s.join(", ")}},this.changeLabel=(e,s)=>{const i=p.clone(this.props.labels);i[e]=s.target.value,this.props.onChange({labels:i})},this.changePicUrl=e=>{const s=Fe.getRealImageUrl(e);this.props.onChange({picUrl:s})},this.changeCategories=e=>{let s=e.length;this.props.type==="histogram"&&s--;const i=this.props.scaleY;this.props.onChange({categories:e,correct:ts(this.props.correct,s,i),starting:ts(this.props.starting,s,i)})},this.changeScale=e=>{const s=this.props.scaleY,i=+e.target.value||Ve.scaleY,a=function(h){return h*i/s},o=a(this.props.maxY);this.props.onChange({scaleY:i,maxY:o,correct:p.map(this.props.correct,a),starting:p.map(this.props.starting,a)}),Ue.findDOMNode(this.refs.maxY).value=o},this.changeMax=e=>{this.props.onChange({maxY:+e.target.value||Ve.maxY})},this.changeSnaps=e=>{this.props.onChange({snapsPerLine:+e.target.value||Ve.snapsPerLine})},this.changeEditing=e=>{this.setState({editing:e})},this.setCategoriesFromScale=()=>{const e=this.state.tickStep||1,s=this.state.minX||0,i=this.state.maxX||0,a=Math.floor((i-s)/e)*e;let o;this.props.type==="histogram"||this.props.type==="dotplot"?o=p.range(0,a+e,e):o=p.range(e,a+e,e),o=p.map(o,g=>g+s),o=p.map(o,ss),this.changeCategories(o);const h=Ue.findDOMNode(this.refs.categories);h.value=o.join(", ")},this.serialize=()=>{const e=p.pick(this.props,"correct","starting","type","labels","categories","scaleY","maxY","snapsPerLine","labelInterval");return this.props.type==="pic"&&(e.picUrl=this.props.picUrl),e}}UNSAFE_componentWillMount(){this.fetchPic(this.props.picUrl)}UNSAFE_componentWillReceiveProps(e){this.fetchPic(e.picUrl),e.static&&this.setState({editing:"starting"})}render(){const e=p.contains(["line","histogram","dotplot"],this.props.type),s=!p.contains(["pic","dotplot"],this.props.type),i={trackInteraction:()=>{},...this.props};return n("div",{className:"perseus-widget-plotter-editor",children:[n("div",{children:["Chart type:"," ",ai.map(a=>n("label",{children:[t("input",{type:"radio",name:"chart-type",checked:this.props.type===a,onChange:p.partial(this.changeType,a)}),a]},a),this)]}),n("div",{children:["Labels:"," ",["x","y"].map((a,o)=>n("label",{children:[a+":",t("input",{type:"text",onChange:p.partial(this.changeLabel,o),defaultValue:this.props.labels[o]})]},a),this)]}),e&&n("div",{className:"set-from-scale-box",children:[t("span",{className:"categories-title",children:"Set Categories From Scale"}),n("div",{children:[n("label",{children:["Tick Step:"," ",t(es,{placeholder:1,useArrowKeys:!0,value:this.state.tickStep,onChange:this.handleChangeTickStep})]}),t(U,{children:t("p",{children:"The difference between adjacent ticks."})})]}),t("div",{children:n("label",{children:["Range:"," ",t(_n,{placeholder:[0,10],useArrowKeys:!0,value:[this.state.minX,this.state.maxX],onChange:this.handleChangeRange})]})}),t("div",{children:n("button",{onClick:this.setCategoriesFromScale,children:["Set Categories"," "]})})]}),n("div",{children:[n("label",{children:["Label Interval:"," ",t(es,{useArrowKeys:!0,value:this.props.labelInterval,onChange:this.changeLabelInterval})]}),t(U,{children:t("p",{children:'Which ticks to display the labels for. For instance, setting this to "4" will only show every 4th label (plus the last one)'})})]}),this.props.type==="pic"&&n("div",{children:[n("label",{children:["Picture:"," ",t(x,{className:"pic-url",value:this.props.picUrl,onChange:this.changePicUrl}),t(U,{children:t("p",{children:'Use the default picture of Earth, or insert the URL for a different picture using the "Add image" function.'})})]}),this.state.pic&&this.state.pic.width!==this.state.pic.height&&n("p",{className:"warning",children:[t("b",{children:"Warning"}),": You are using a picture which is not square. This means the image will get distorted. You should probably crop it to be square."]})]}),t("div",{children:n("label",{children:["Categories:"," ",t(Nn,{ref:"categories",layout:"horizontal",options:this.props.categories,onChange:this.changeCategories})]})}),t("div",{children:n("label",{children:["Scale (y):"," ",t("input",{type:"text",onChange:this.changeScale,defaultValue:this.props.scaleY})]})}),t("div",{children:n("label",{children:["Max y:"," ",t("input",{type:"text",ref:"maxY",onChange:this.changeMax,defaultValue:this.props.maxY})]})}),s&&n("div",{children:[n("label",{children:["Snaps per line:"," ",t("input",{type:"text",onChange:this.changeSnaps,defaultValue:this.props.snapsPerLine})]}),t(U,{children:t("p",{children:"Creates the specified number of divisions between the horizontal lines. Fewer snaps between lines makes the graph easier for the student to create correctly."})})]}),n("div",{children:["Editing values:"," ",xn.map(a=>n("label",{children:[t("input",{type:"radio",disabled:a===wt&&this.props.static,checked:this.props.static?a===vt:this.state.editing===a,onChange:o=>this.changeEditing(a)}),a]},a)),n(U,{children:[t("p",{children:"Use this toggle to switch between editing the correct answer (what the student will be graded on) and the starting values (what the student will see plotted when they start the problem). Note: These cannot be the same."}),t("p",{children:"In static mode, the starting values are rendered out to the displayed widget."})]})]}),t(Sn,{...i,starting:this.props[this.state.editing],onChange:this.handlePlotterChange})]})}};Ye.widgetName="plotter",Ye.defaultProps={...Ve,correct:[1],starting:[1],type:"bar",labels:["",""],categories:[""],picSize:30,picBoxHeight:36,plotDimensions:[275,200],labelInterval:1,get picUrl(){const e=rs().staticUrl;return e?e("/images/badges/earth-small.png"):null}};let Se=Ye;try{Se.displayName="PlotterEditor",Se.__docgenInfo={description:"",displayName:"PlotterEditor",props:{type:{defaultValue:{value:"bar"},description:"",name:"type",required:!1,type:{name:"enum",value:[{value:'"line"'},{value:'"bar"'},{value:'"pic"'},{value:'"histogram"'},{value:'"dotplot"'}]}},labels:{defaultValue:{value:'["", ""]'},description:"",name:"labels",required:!1,type:{name:"string[]"}},categories:{defaultValue:{value:'[""]'},description:"",name:"categories",required:!1,type:{name:"readonly (string | number)[]"}},scaleY:{defaultValue:null,description:"",name:"scaleY",required:!0,type:{name:"number"}},maxY:{defaultValue:null,description:"",name:"maxY",required:!0,type:{name:"number"}},snapsPerLine:{defaultValue:null,description:"",name:"snapsPerLine",required:!0,type:{name:"number"}},picSize:{defaultValue:{value:"30"},description:"",name:"picSize",required:!1,type:{name:"number"}},picBoxHeight:{defaultValue:{value:"36"},description:"",name:"picBoxHeight",required:!1,type:{name:"number"}},picUrl:{defaultValue:null,description:"",name:"picUrl",required:!0,type:{name:"string"}},plotDimensions:{defaultValue:{value:"[275, 200]"},description:"",name:"plotDimensions",required:!1,type:{name:"readonly number[]"}},labelInterval:{defaultValue:{value:"1"},description:"",name:"labelInterval",required:!1,type:{name:"number"}},starting:{defaultValue:{value:"[1]"},description:"",name:"starting",required:!1,type:{name:"readonly number[]"}},correct:{defaultValue:{value:"[1]"},description:"",name:"correct",required:!1,type:{name:"readonly number[]"}},static:{defaultValue:null,description:"",name:"static",required:!0,type:{name:"boolean"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"any"}}}}}catch{}class Tn extends c.Component{constructor(){super(...arguments),this.focus=()=>(this.refs.input.focus(),!0),this.changeValue=e=>{this.props.onChange(e.target.value)}}render(){return t("textarea",{ref:"input",value:this.props.value||"",onChange:this.changeValue})}}const ee=class ee extends c.Component{constructor(){super(...arguments),this.input=c.createRef(),this.change=(...e)=>m.apply(this,e),this.focus=()=>{var e;return(e=this.input.current)==null||e.focus(),!0},this.serialize=()=>w.serialize.call(this)}render(){return t("div",{children:n("label",{children:[t("div",{children:"Simple markdown contents:"}),t("div",{children:t(Tn,{value:this.props.value,onChange:this.change("value"),ref:this.input})})]})})}};ee.propTypes={...y},ee.widgetName="simple-markdown-tester",ee.defaultProps={value:""};let xe=ee;try{xe.displayName="SimpleMarkdownTesterEditor",xe.__docgenInfo={description:"",displayName:"SimpleMarkdownTesterEditor",props:{}}}catch{}const{InfoTip:In,NumberInput:is}=v,Pn=Os.widget,te=class te extends c.Component{constructor(){super(...arguments),this.numberOfColumns=c.createRef(),this.focus=()=>{var e;(e=this.numberOfColumns.current)==null||e.focus()},this.onSizeInput=(e,s)=>{let i=+e||0,a=+s||0;i=Math.min(Math.max(1,i),30),a=Math.min(Math.max(1,a),6);const o=this.props.columns,h=this.props.rows,g=this.props.answers;i<=h?g.length=i:p(i-h).times(function(){g.push(Fe.stringArrayOfSize(o))});function f(_){a<=o?_.length=a:p(a-o).times(function(){_.push("")})}const N=this.props.headers;f(N),p.each(g,f),this.props.onChange({rows:i,columns:a,answers:g,headers:N})},this.serialize=()=>{const e=p.pick(this.props,"headers","rows","columns");return p.extend({},e,{answers:p.map(this.props.answers,p.clone)})}}render(){const e=p.pick(this.props,"headers","answers","onChange","apiOptions");return p.extend(e,{editableHeaders:!0,Editor:b,onFocus:()=>{},onBlur:()=>{},trackInteraction:()=>{}}),n("div",{children:[t("div",{className:"perseus-widget-row",children:n("label",{children:["Number of columns:"," ",t(is,{ref:this.numberOfColumns,value:this.props.columns,onChange:s=>{s&&this.onSizeInput(this.props.rows,s)},useArrowKeys:!0})]})}),t("div",{className:"perseus-widget-row",children:n("label",{children:["Number of rows:"," ",t(is,{ref:"numberOfRows",value:this.props.rows,onChange:s=>{s&&this.onSizeInput(s,this.props.columns)},useArrowKeys:!0})]})}),n("div",{children:[" ","Table of answers:"," ",t(In,{children:t("p",{children:"The student has to fill out all cells in the table. For partially filled tables create a table using the template, and insert text input boxes as desired."})})]}),t("div",{children:t(Pn,{...e})})]})}};te.propTypes={rows:l.number,columns:l.number,headers:l.arrayOf(l.string),answers:l.arrayOf(l.arrayOf(l.string))},te.widgetName="table",te.defaultProps=function(){const i=p(4).times(function(){return Fe.stringArrayOfSize(1)});return{headers:[""],rows:4,columns:1,answers:i}}();let Te=te;try{Te.displayName="TableEditor",Te.__docgenInfo={description:"",displayName:"TableEditor",props:{}}}catch{}const{InlineIcon:Be,NumberInput:kn}=v,{iconOk:ws,iconRemove:Cs}=V,qe="all",z="some",bs=10,An=function(r,e){return Ls(r,e,-bs,!1)},ns=function(r){return r.simplify().asMul().partition()[1].flatten().simplify()};class En extends c.Component{constructor(){super(...arguments),this._checkValidity=({name:e,original:s,sigfigs:i})=>{const a=ht(e);let o="",h=!0;if(a.parsed&&s){const g=new ui("x"),{unit:f}=a,N=new hi(s,"=",new ci(g,f));try{const _=N.solveLinearEquationForVariable(g);o=An(_.eval(),i),h=di(ns(s),ns(f)).equal}catch{h=!1}}else h=!1;this.setState({valid:h,solvedExample:o})}}UNSAFE_componentWillMount(){this._checkValidity(this.props)}UNSAFE_componentWillReceiveProps(e){this._checkValidity(e)}render(){let e;return this.state.valid?e=n("span",{children:[t("span",{className:"unit-example-okay",children:t(Be,{...ws})}),this.state.solvedExample]}):e=t("span",{className:"unit-example-not-okay",children:t(Be,{...Cs})}),n("div",{children:[e," ",this.props.name]})}}const se=class se extends c.Component{constructor(e){super(e),this.change=(...s)=>m.apply(this,s),this.handleAcceptingUnitsChange=s=>{const i=s.target.value.split(",").map(a=>a.trim()).filter(a=>a!=="");this.change({acceptingUnits:i})},this.handleSigfigChange=s=>{this.change({sigfigs:s})},this._checkSigfigValidity=s=>s>0&&s<=bs,this._setAccepting=s=>{this.change({accepting:s})},this._doOriginal=s=>{const i=ht(s.value);this.parsed=!1,i.parsed&&i.type==="unitMagnitude"&&(this.original=i.expr,this.parsed=!0)},this.onChange=s=>{this.props.onChange({value:s.target.value})},this.getSaveWarnings=()=>{const{value:s,accepting:i,acceptingUnits:a}=this.props,o=[];return ht(s).parsed||o.push("Answer did not parse"),i===z&&a.length===0&&o.push("There are no accepted units"),o},this.serialize=()=>w.serialize.call(this),this.groupId=p.uniqueId("accepting"),this._doOriginal(e)}UNSAFE_componentWillReceiveProps(e){this._doOriginal(e)}render(){const{acceptingUnits:e=[],accepting:s}=this.props;let i=null;if(s===z){const a=e.map((o,h)=>t(En,{name:o,original:this.original||null,sigfigs:this.props.sigfigs},h));i=n("div",{children:[t("input",{type:"text",defaultValue:e.join(", "),onChange:this.handleAcceptingUnitsChange})," ","(comma-separated)",a]})}return n("div",{className:"unit-editor",children:[n("div",{children:[t("input",{value:this.props.value,className:"unit-editor-canonical",onChange:this.onChange})," ",this.parsed?t("span",{className:"unit-example-okay",children:t(Be,{...ws})}):t("span",{className:"unit-example-not-okay",children:t(Be,{...Cs})})]}),n("div",{children:["Significant Figures:"," ",t(kn,{value:this.props.sigfigs,onChange:this.handleSigfigChange,checkValidity:this._checkSigfigValidity,useArrowKeys:!0})]}),n("div",{children:[n("label",{children:[t("input",{type:"radio",name:this.groupId,onChange:()=>this._setAccepting(qe),checked:this.props.accepting===qe})," Any equivalent unit "]}),n("label",{children:[t("input",{type:"radio",name:this.groupId,onChange:()=>this._setAccepting(z),checked:this.props.accepting===z})," Only these units "]})]}),i]})}};se.propTypes={...y,value:l.string,acceptingUnits:l.arrayOf(l.string),accepting:l.oneOf([qe,z]),sigfigs:l.number},se.widgetName="unit-input",se.defaultProps={value:"5x10^5 kg m / s^2",accepting:qe,sigfigs:3};let Ie=se;try{Ie.displayName="UnitInputEditor",Ie.__docgenInfo={description:"",displayName:"UnitInputEditor",props:{}}}catch{}const{InfoTip:On}=v,Mn=/khanacademy\.org\/.*\/v\/(.*)$/;function Ln(r){const e=Mn.exec(r);return e?e[1]:r}const ie=class ie extends c.Component{constructor(){super(...arguments),this._handleUrlChange=e=>{this.props.onChange({location:Ln(e)})},this.change=(...e)=>m.apply(this,e),this.serialize=()=>w.serialize.call(this)}render(){return t("div",{children:n("label",{children:["KA Video Slug:"," ",t(x,{value:this.props.location,style:{width:290},onChange:this._handleUrlChange}),t(On,{children:"KA video URLs will be converted to just the slug."})]})})}};ie.propTypes={...y,location:l.string,onChange:l.func},ie.widgetName="video",ie.defaultProps={location:""};let Pe=ie;try{Pe.displayName="VideoEditor",Pe.__docgenInfo={description:"This is the main editor for this widget, to specify all the options.",displayName:"VideoEditor",props:{}}}catch{}const _s=[$s,pe,Gs,Ks,ce,de,Js,Ys,E,ue,ge,me,fe,Zs,Qs,ei,ti,si,ii,ye,ve,we,ni,ri,Ce,be,_e,Ne,Se,oi,xe,pi,Te,Ie,Pe,li,he];class Rn extends c.Component{constructor(){super(...arguments),this.input=c.createRef(),this.focus=()=>{var e;return(e=this.input.current)==null||e.focus(),!0},this.changeValue=e=>{this.props.onChange(e.target.value)}}render(){return t("input",{ref:this.input,value:this.props.value||"",onChange:this.changeValue})}}const Xe=class Xe extends c.Component{constructor(){super(...arguments),this.input=c.createRef(),this.change=(...e)=>m.apply(this,e),this.getUserInput=()=>this.props.value,this.focus=()=>{var e;return(e=this.input.current)==null||e.focus(),!0},this.simpleValidate=e=>Xe.validate(this.getUserInput(),e)}static validate(e,s){return e===""?{type:"invalid",message:"It looks like you haven't answered all of the question yet."}:e===s.correct?{type:"points",earned:1,total:1,message:null}:{type:"points",earned:0,total:1,message:null}}render(){return t(Rn,{ref:this.input,value:this.props.value,onChange:this.change("value")})}};Xe.defaultProps={value:""};let Ct=Xe;const Vn={name:"example-widget",displayName:"Example Widget",defaultAlignment:"inline-block",hidden:!0,widget:Ct};try{examplewidget.displayName="examplewidget",examplewidget.__docgenInfo={description:"For this widget to work, we must import this file in src/all-widgets.js",displayName:"examplewidget",props:{}}}catch{}const qn=os.parse,Un=os.basicOutput,Ze=class Ze extends c.Component{constructor(){super(...arguments),this.change=(...e)=>m.apply(this,e),this.toJSON=()=>({}),this.focus=()=>(this.refs.input.focus(),!0),this.simpleValidate=e=>Ze.validate(this.toJSON(),e)}static validate(e,s){return{type:"points",earned:0,total:0,message:null}}render(){const e=qn(this.props.value),s=Un(e);return t("div",{children:s})}};Ze.defaultProps={value:""};let bt=Ze;const zn={name:"simple-markdown-tester",displayName:"Simple Markdown Tester",hidden:!0,widget:bt,transform:p.identity};try{simplemarkdowntester.displayName="simplemarkdowntester",simplemarkdowntester.__docgenInfo={description:"For this widget to work, we must import this file in src/all-widgets.js",displayName:"simplemarkdowntester",props:{}}}catch{}const Dn=[vs,Vn,zn],Ns=[...Ms,...Dn];ls(_s);ps(Ns);hs();cs();const Qr=()=>{ps(Ns),ls(_s),hs(),cs()};export{le as E,Qr as r};
