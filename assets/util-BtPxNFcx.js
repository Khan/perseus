import{Q as on,R as ln,S as un,T as fn,u as hn,t as zt,U as We,O as ve,V as it}from"./core-widget-registry-uiKfW1Am.js";import{_ as B}from"./index-default-4_ZsnO94.js";import{c as Ut,g as Bt}from"./_commonjsHelpers-4gQjN7DL.js";import{P as Ae,E as Pe}from"./perseus-error-l3K_anoI.js";import{$ as ge}from"./jquery-5v7aFUvu.js";import{g as pn}from"./get-decimal-separator-c07pHhM9.js";function at(n){const e=[1,1];return B(n).each((r,s)=>{let o=0;B(r).each((l,f)=>{l!=null&&l.toString().length&&(o=f+1)}),e[1]=Math.max(e[1],o),o>0&&(e[0]=Math.max(e[0],s+1))}),e}function dn(){return/\[\[☃ ([A-Za-z0-9- ]+)\]\]/g}function gn(n){const e=[],r=dn();let s=r.exec(n);for(;s!==null;)e.push(s[1]),s=r.exec(n);return e}function ct(n){return Array.isArray(n)?n.map(ct):n}const ti=function(n,e){return B.object(B.map(n,function(r,s){return[s,r[e]]}))},mn=function(n,e){const r={};return Object.keys(n).forEach(s=>{r[s]=e(n[s],s)}),r},vn=!1,yn=n=>{var h;const e=n.type;if(!B.isString(e))throw new Ae("widget type must be a string, but was: "+e,Pe.Internal);if(!on(e))return n;const r=n.version||{major:0,minor:0},s=ln(e);if(r.major>s.major||r.major===s.major&&r.minor>s.minor)return n;let o=B.clone(n.options)||{};const l=un(e);if(B.keys(o).length!==0)for(let d=r.major+1;d<=s.major;d++)if(l[String(d)])o=l[String(d)](o);else throw new Ae("No upgrade found for widget. Cannot render.",Pe.Internal,{metadata:{type:e,fromMajorVersion:d-1,toMajorVersion:d,oldWidgetInfo:JSON.stringify(n)}});o={...fn(e),...o};let p=n.alignment;if((p==null||p==="default")&&(p=(h=hn(e))==null?void 0:h[0],!p))throw new Ae("No default alignment found when upgrading widget",Pe.Internal,{metadata:{widgetType:e}});let v=n.static;return v==null&&(v=vn),{...n,version:s,graded:n.graded!=null?n.graded:!0,alignment:p,static:v,options:o}};function xn(n){return mn(n,(e,r)=>{if(!e.type||!e.alignment){const s={};e.type||(s.type=r.split(" ")[0]),e.alignment||(s.alignment="default"),e={...e,...s}}return yn(e)})}const wn="@khanacademy/kas",En="__lib_version__";zt(wn,En);var ot={exports:{}};(function(n,e){(function(){var r=this,s=r._,o={},l=Array.prototype,f=Object.prototype,p=Function.prototype,v=l.push,h=l.slice,d=l.concat,m=f.toString,y=f.hasOwnProperty,M=l.forEach,R=l.map,I=l.reduce,k=l.reduceRight,C=l.filter,$=l.every,J=l.some,ae=l.indexOf,ye=l.lastIndexOf,Z=Array.isArray,te=Object.keys,ce=p.bind,a=function(t){if(t instanceof a)return t;if(!(this instanceof a))return new a(t);this._wrapped=t};n.exports&&(e=n.exports=a),e._=a,a.VERSION="1.4.4";var G=a.each=a.forEach=function(t,i,c){if(t!=null){if(M&&t.forEach===M)t.forEach(i,c);else if(t.length===+t.length){for(var u=0,g=t.length;u<g;u++)if(i.call(c,t[u],u,t)===o)return}else for(var E in t)if(a.has(t,E)&&i.call(c,t[E],E,t)===o)return}};a.map=a.collect=function(t,i,c){var u=[];return t==null?u:R&&t.map===R?t.map(i,c):(G(t,function(g,E,w){u[u.length]=i.call(c,g,E,w)}),u)};var Me="Reduce of empty array with no initial value";a.reduce=a.foldl=a.inject=function(t,i,c,u){var g=arguments.length>2;if(t==null&&(t=[]),I&&t.reduce===I)return u&&(i=a.bind(i,u)),g?t.reduce(i,c):t.reduce(i);if(G(t,function(E,w,T){g?c=i.call(u,c,E,w,T):(c=E,g=!0)}),!g)throw new TypeError(Me);return c},a.reduceRight=a.foldr=function(t,i,c,u){var g=arguments.length>2;if(t==null&&(t=[]),k&&t.reduceRight===k)return u&&(i=a.bind(i,u)),g?t.reduceRight(i,c):t.reduceRight(i);var E=t.length;if(E!==+E){var w=a.keys(t);E=w.length}if(G(t,function(T,F,H){F=w?w[--E]:--E,g?c=i.call(u,c,t[F],F,H):(c=t[F],g=!0)}),!g)throw new TypeError(Me);return c},a.find=a.detect=function(t,i,c){var u;return j(t,function(g,E,w){if(i.call(c,g,E,w))return u=g,!0}),u},a.filter=a.select=function(t,i,c){var u=[];return t==null?u:C&&t.filter===C?t.filter(i,c):(G(t,function(g,E,w){i.call(c,g,E,w)&&(u[u.length]=g)}),u)},a.reject=function(t,i,c){return a.filter(t,function(u,g,E){return!i.call(c,u,g,E)},c)},a.every=a.all=function(t,i,c){i||(i=a.identity);var u=!0;return t==null?u:$&&t.every===$?t.every(i,c):(G(t,function(g,E,w){if(!(u=u&&i.call(c,g,E,w)))return o}),!!u)};var j=a.some=a.any=function(t,i,c){i||(i=a.identity);var u=!1;return t==null?u:J&&t.some===J?t.some(i,c):(G(t,function(g,E,w){if(u||(u=i.call(c,g,E,w)))return o}),!!u)};a.contains=a.include=function(t,i){return t==null?!1:ae&&t.indexOf===ae?t.indexOf(i)!=-1:j(t,function(c){return c===i})},a.invoke=function(t,i){var c=h.call(arguments,2),u=a.isFunction(i);return a.map(t,function(g){return(u?i:g[i]).apply(g,c)})},a.pluck=function(t,i){return a.map(t,function(c){return c[i]})},a.where=function(t,i,c){return a.isEmpty(i)?c?null:[]:a[c?"find":"filter"](t,function(u){for(var g in i)if(i[g]!==u[g])return!1;return!0})},a.findWhere=function(t,i){return a.where(t,i,!0)},a.max=function(t,i,c){if(!i&&a.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!i&&a.isEmpty(t))return-1/0;var u={computed:-1/0,value:-1/0};return G(t,function(g,E,w){var T=i?i.call(c,g,E,w):g;T>=u.computed&&(u={value:g,computed:T})}),u.value},a.min=function(t,i,c){if(!i&&a.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!i&&a.isEmpty(t))return 1/0;var u={computed:1/0,value:1/0};return G(t,function(g,E,w){var T=i?i.call(c,g,E,w):g;T<u.computed&&(u={value:g,computed:T})}),u.value},a.shuffle=function(t){var i,c=0,u=[];return G(t,function(g){i=a.random(c++),u[c-1]=u[i],u[i]=g}),u};var ee=function(t){return a.isFunction(t)?t:function(i){return i[t]}};a.sortBy=function(t,i,c){var u=ee(i);return a.pluck(a.map(t,function(g,E,w){return{value:g,index:E,criteria:u.call(c,g,E,w)}}).sort(function(g,E){var w=g.criteria,T=E.criteria;if(w!==T){if(w>T||w===void 0)return 1;if(w<T||T===void 0)return-1}return g.index<E.index?-1:1}),"value")};var _=function(t,i,c,u){var g={},E=ee(i||a.identity);return G(t,function(w,T){var F=E.call(c,w,T,t);u(g,F,w)}),g};a.groupBy=function(t,i,c){return _(t,i,c,function(u,g,E){(a.has(u,g)?u[g]:u[g]=[]).push(E)})},a.countBy=function(t,i,c){return _(t,i,c,function(u,g){a.has(u,g)||(u[g]=0),u[g]++})},a.sortedIndex=function(t,i,c,u){c=c==null?a.identity:ee(c);for(var g=c.call(u,i),E=0,w=t.length;E<w;){var T=E+w>>>1;c.call(u,t[T])<g?E=T+1:w=T}return E},a.toArray=function(t){return t?a.isArray(t)?h.call(t):t.length===+t.length?a.map(t,a.identity):a.values(t):[]},a.size=function(t){return t==null?0:t.length===+t.length?t.length:a.keys(t).length},a.first=a.head=a.take=function(t,i,c){if(t!=null)return i!=null&&!c?h.call(t,0,i):t[0]},a.initial=function(t,i,c){return h.call(t,0,t.length-(i==null||c?1:i))},a.last=function(t,i,c){if(t!=null)return i!=null&&!c?h.call(t,Math.max(t.length-i,0)):t[t.length-1]},a.rest=a.tail=a.drop=function(t,i,c){return h.call(t,i==null||c?1:i)},a.compact=function(t){return a.filter(t,a.identity)};var V=function(t,i,c){return G(t,function(u){a.isArray(u)?i?v.apply(c,u):V(u,i,c):c.push(u)}),c};a.flatten=function(t,i){return V(t,i,[])},a.without=function(t){return a.difference(t,h.call(arguments,1))},a.uniq=a.unique=function(t,i,c,u){a.isFunction(i)&&(u=c,c=i,i=!1);var g=c?a.map(t,c,u):t,E=[],w=[];return G(g,function(T,F){(i?!F||w[w.length-1]!==T:!a.contains(w,T))&&(w.push(T),E.push(t[F]))}),E},a.union=function(){return a.uniq(d.apply(l,arguments))},a.intersection=function(t){var i=h.call(arguments,1);return a.filter(a.uniq(t),function(c){return a.every(i,function(u){return a.indexOf(u,c)>=0})})},a.difference=function(t){var i=d.apply(l,h.call(arguments,1));return a.filter(t,function(c){return!a.contains(i,c)})},a.zip=function(){for(var t=h.call(arguments),i=a.max(a.pluck(t,"length")),c=new Array(i),u=0;u<i;u++)c[u]=a.pluck(t,""+u);return c},a.object=function(t,i){if(t==null)return{};for(var c={},u=0,g=t.length;u<g;u++)i?c[t[u]]=i[u]:c[t[u][0]]=t[u][1];return c},a.indexOf=function(t,i,c){if(t==null)return-1;var u=0,g=t.length;if(c)if(typeof c=="number")u=c<0?Math.max(0,g+c):c;else return u=a.sortedIndex(t,i),t[u]===i?u:-1;if(ae&&t.indexOf===ae)return t.indexOf(i,c);for(;u<g;u++)if(t[u]===i)return u;return-1},a.lastIndexOf=function(t,i,c){if(t==null)return-1;var u=c!=null;if(ye&&t.lastIndexOf===ye)return u?t.lastIndexOf(i,c):t.lastIndexOf(i);for(var g=u?c:t.length;g--;)if(t[g]===i)return g;return-1},a.range=function(t,i,c){arguments.length<=1&&(i=t||0,t=0),c=arguments[2]||1;for(var u=Math.max(Math.ceil((i-t)/c),0),g=0,E=new Array(u);g<u;)E[g++]=t,t+=c;return E},a.bind=function(t,i){if(t.bind===ce&&ce)return ce.apply(t,h.call(arguments,1));var c=h.call(arguments,2);return function(){return t.apply(i,c.concat(h.call(arguments)))}},a.partial=function(t){var i=h.call(arguments,1);return function(){return t.apply(this,i.concat(h.call(arguments)))}},a.bindAll=function(t){var i=h.call(arguments,1);return i.length===0&&(i=a.functions(t)),G(i,function(c){t[c]=a.bind(t[c],t)}),t},a.memoize=function(t,i){var c={};return i||(i=a.identity),function(){var u=i.apply(this,arguments);return a.has(c,u)?c[u]:c[u]=t.apply(this,arguments)}},a.delay=function(t,i){var c=h.call(arguments,2);return setTimeout(function(){return t.apply(null,c)},i)},a.defer=function(t){return a.delay.apply(a,[t,1].concat(h.call(arguments,1)))},a.throttle=function(t,i){var c,u,g,E,w=0,T=function(){w=new Date,g=null,E=t.apply(c,u)};return function(){var F=new Date,H=i-(F-w);return c=this,u=arguments,H<=0?(clearTimeout(g),g=null,w=F,E=t.apply(c,u)):g||(g=setTimeout(T,H)),E}},a.debounce=function(t,i,c){var u,g;return function(){var E=this,w=arguments,T=function(){u=null,c||(g=t.apply(E,w))},F=c&&!u;return clearTimeout(u),u=setTimeout(T,i),F&&(g=t.apply(E,w)),g}},a.once=function(t){var i=!1,c;return function(){return i||(i=!0,c=t.apply(this,arguments),t=null),c}},a.wrap=function(t,i){return function(){var c=[t];return v.apply(c,arguments),i.apply(this,c)}},a.compose=function(){var t=arguments;return function(){for(var i=arguments,c=t.length-1;c>=0;c--)i=[t[c].apply(this,i)];return i[0]}},a.after=function(t,i){return t<=0?i():function(){if(--t<1)return i.apply(this,arguments)}},a.keys=te||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var i=[];for(var c in t)a.has(t,c)&&(i[i.length]=c);return i},a.values=function(t){var i=[];for(var c in t)a.has(t,c)&&i.push(t[c]);return i},a.pairs=function(t){var i=[];for(var c in t)a.has(t,c)&&i.push([c,t[c]]);return i},a.invert=function(t){var i={};for(var c in t)a.has(t,c)&&(i[t[c]]=c);return i},a.functions=a.methods=function(t){var i=[];for(var c in t)a.isFunction(t[c])&&i.push(c);return i.sort()},a.extend=function(t){return G(h.call(arguments,1),function(i){if(i)for(var c in i)t[c]=i[c]}),t},a.pick=function(t){var i={},c=d.apply(l,h.call(arguments,1));return G(c,function(u){u in t&&(i[u]=t[u])}),i},a.omit=function(t){var i={},c=d.apply(l,h.call(arguments,1));for(var u in t)a.contains(c,u)||(i[u]=t[u]);return i},a.defaults=function(t){return G(h.call(arguments,1),function(i){if(i)for(var c in i)t[c]==null&&(t[c]=i[c])}),t},a.clone=function(t){return a.isObject(t)?a.isArray(t)?t.slice():a.extend({},t):t},a.tap=function(t,i){return i(t),t};var S=function(t,i,c,u){if(t===i)return t!==0||1/t==1/i;if(t==null||i==null)return t===i;t instanceof a&&(t=t._wrapped),i instanceof a&&(i=i._wrapped);var g=m.call(t);if(g!=m.call(i))return!1;switch(g){case"[object String]":return t==String(i);case"[object Number]":return t!=+t?i!=+i:t==0?1/t==1/i:t==+i;case"[object Date]":case"[object Boolean]":return+t==+i;case"[object RegExp]":return t.source==i.source&&t.global==i.global&&t.multiline==i.multiline&&t.ignoreCase==i.ignoreCase}if(typeof t!="object"||typeof i!="object")return!1;for(var E=c.length;E--;)if(c[E]==t)return u[E]==i;c.push(t),u.push(i);var w=0,T=!0;if(g=="[object Array]"){if(w=t.length,T=w==i.length,T)for(;w--&&(T=S(t[w],i[w],c,u)););}else{var F=t.constructor,H=i.constructor;if(F!==H&&!(a.isFunction(F)&&F instanceof F&&a.isFunction(H)&&H instanceof H))return!1;for(var Y in t)if(a.has(t,Y)&&(w++,!(T=a.has(i,Y)&&S(t[Y],i[Y],c,u))))break;if(T){for(Y in i)if(a.has(i,Y)&&!w--)break;T=!w}}return c.pop(),u.pop(),T};a.isEqual=function(t,i){return S(t,i,[],[])},a.isEmpty=function(t){if(t==null)return!0;if(a.isArray(t)||a.isString(t))return t.length===0;for(var i in t)if(a.has(t,i))return!1;return!0},a.isElement=function(t){return!!(t&&t.nodeType===1)},a.isArray=Z||function(t){return m.call(t)=="[object Array]"},a.isObject=function(t){return t===Object(t)},G(["Arguments","Function","String","Number","Date","RegExp"],function(t){a["is"+t]=function(i){return m.call(i)=="[object "+t+"]"}}),a.isArguments(arguments)||(a.isArguments=function(t){return!!(t&&a.has(t,"callee"))}),typeof/./!="function"&&(a.isFunction=function(t){return typeof t=="function"}),a.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},a.isNaN=function(t){return a.isNumber(t)&&t!=+t},a.isBoolean=function(t){return t===!0||t===!1||m.call(t)=="[object Boolean]"},a.isNull=function(t){return t===null},a.isUndefined=function(t){return t===void 0},a.has=function(t,i){return y.call(t,i)},a.noConflict=function(){return r._=s,this},a.identity=function(t){return t},a.times=function(t,i,c){for(var u=Array(t),g=0;g<t;g++)u[g]=i.call(c,g);return u},a.random=function(t,i){return i==null&&(i=t,t=0),t+Math.floor(Math.random()*(i-t+1))};var P={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};P.unescape=a.invert(P.escape);var L={escape:new RegExp("["+a.keys(P.escape).join("")+"]","g"),unescape:new RegExp("("+a.keys(P.unescape).join("|")+")","g")};a.each(["escape","unescape"],function(t){a[t]=function(i){return i==null?"":(""+i).replace(L[t],function(c){return P[t][c]})}}),a.result=function(t,i){if(t==null)return null;var c=t[i];return a.isFunction(c)?c.call(t):c},a.mixin=function(t){G(a.functions(t),function(i){var c=a[i]=t[i];a.prototype[i]=function(){var u=[this._wrapped];return v.apply(u,arguments),Oe.call(this,c.apply(a,u))}})};var D=0;a.uniqueId=function(t){var i=++D+"";return t?t+i:i},a.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var fe=/(.)^/,q={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},pe=/\\|'|\r|\n|\t|\u2028|\u2029/g;a.template=function(t,i,c){var u;c=a.defaults({},c,a.templateSettings);var g=new RegExp([(c.escape||fe).source,(c.interpolate||fe).source,(c.evaluate||fe).source].join("|")+"|$","g"),E=0,w="__p+='";t.replace(g,function(F,H,Y,Ne,me){return w+=t.slice(E,me).replace(pe,function(_e){return"\\"+q[_e]}),H&&(w+=`'+
((__t=(`+H+`))==null?'':_.escape(__t))+
'`),Y&&(w+=`'+
((__t=(`+Y+`))==null?'':__t)+
'`),Ne&&(w+=`';
`+Ne+`
__p+='`),E=me+F.length,F}),w+=`';
`,c.variable||(w=`with(obj||{}){
`+w+`}
`),w=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+w+`return __p;
`;try{u=new Function(c.variable||"obj","_",w)}catch(F){throw F.source=w,F}if(i)return u(i,a);var T=function(F){return u.call(this,F,a)};return T.source="function("+(c.variable||"obj")+`){
`+w+"}",T},a.chain=function(t){return a(t).chain()};var Oe=function(t){return this._chain?a(t).chain():t};a.mixin(a),G(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var i=l[t];a.prototype[t]=function(){var c=this._wrapped;return i.apply(c,arguments),(t=="shift"||t=="splice")&&c.length===0&&delete c[0],Oe.call(this,c)}}),G(["concat","join","slice"],function(t){var i=l[t];a.prototype[t]=function(){return Oe.call(this,i.apply(this._wrapped,arguments))}}),a.extend(a.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(Ut)})(ot,ot.exports);var Rn=ot.exports;const x=Bt(Rn);(function(){var n=function(h,d,m,y){for(m=m||{},y=h.length;y--;m[h[y]]=d);return m},e=[1,11],r=[1,9],s=[8,17],o=[6,11],l=[6,11,13,17],f={trace:function(){},yy:{},symbols_:{error:2,unitvalue:3,magnitude:4,unit:5,EOF:6,float:7,POW:8,int:9,multatoms:10,DIV:11,expatom:12,MUL:13,atom:14,"^":15,nat:16,ATOM:17,FLOAT:18,NAT:19,NEG:20,$accept:0,$end:1},terminals_:{2:"error",6:"EOF",8:"POW",11:"DIV",13:"MUL",15:"^",17:"ATOM",18:"FLOAT",19:"NAT",20:"NEG"},productions_:[0,[3,3],[3,2],[4,3],[4,1],[5,3],[5,1],[10,3],[10,2],[10,1],[12,3],[12,1],[14,1],[7,1],[7,1],[16,1],[9,2],[9,1]],performAction:function(d,m,y,M,R,I,k){var C=I.length-1;switch(R){case 1:return{type:"unitMagnitude",magnitude:I[C-2],unit:I[C-1]};case 2:return{type:"unitStandalone",unit:I[C-1]};case 3:this.$=I[C-2]+"e"+I[C];break;case 4:case 13:case 14:case 15:case 17:this.$=I[C];break;case 5:this.$={num:I[C-2],denom:I[C]};break;case 6:this.$={num:I[C],denom:null};break;case 7:this.$=[I[C-2]].concat(I[C]);break;case 8:this.$=[I[C-1]].concat(I[C]);break;case 9:this.$=[I[C]];break;case 10:this.$={name:I[C-2],pow:I[C]};break;case 11:this.$={name:I[C],pow:1};break;case 12:this.$=d;break;case 16:this.$="-"+I[C];break}},table:[{3:1,4:2,5:3,7:4,10:5,12:8,14:10,16:7,17:e,18:[1,6],19:r},{1:[3]},{5:12,10:5,12:8,14:10,17:e},{6:[1,13]},{8:[1,14],17:[2,4]},{6:[2,6],11:[1,15]},n(s,[2,13]),n(s,[2,14]),n(o,[2,9],{12:8,14:10,10:17,13:[1,16],17:e}),n([6,8,11,13,17],[2,15]),n(l,[2,11],{15:[1,18]}),n([6,11,13,15,17],[2,12]),{6:[1,19]},{1:[2,2]},{9:20,19:[1,22],20:[1,21]},{10:23,12:8,14:10,17:e},{10:24,12:8,14:10,17:e},n(o,[2,8]),{16:25,19:r},{1:[2,1]},{17:[2,3]},{19:[1,26]},{17:[2,17]},{6:[2,5]},n(o,[2,7]),n(l,[2,10]),{17:[2,16]}],defaultActions:{13:[2,2],19:[2,1],20:[2,3],22:[2,17],23:[2,5],26:[2,16]},parseError:function(d,m){if(m.recoverable)this.trace(d);else throw new Error(d)},parse:function(d){var m=this,y=[0],M=[null],R=[],I=this.table,k="",C=0,$=0,J=2,ae=1,ye=R.slice.call(arguments,1),Z=Object.create(this.lexer),te={yy:{}};for(var ce in this.yy)Object.prototype.hasOwnProperty.call(this.yy,ce)&&(te.yy[ce]=this.yy[ce]);Z.setInput(d,te.yy),te.yy.lexer=Z,te.yy.parser=this,typeof Z.yylloc>"u"&&(Z.yylloc={});var a=Z.yylloc;R.push(a);var G=Z.options&&Z.options.ranges;typeof te.yy.parseError=="function"?this.parseError=te.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function Me(){var pe;return pe=Z.lex()||ae,typeof pe!="number"&&(pe=m.symbols_[pe]||pe),pe}for(var j,ee,_,V,S={},P,L,D,fe;;){if(ee=y[y.length-1],this.defaultActions[ee]?_=this.defaultActions[ee]:((j===null||typeof j>"u")&&(j=Me()),_=I[ee]&&I[ee][j]),typeof _>"u"||!_.length||!_[0]){var q="";fe=[];for(P in I[ee])this.terminals_[P]&&P>J&&fe.push("'"+this.terminals_[P]+"'");Z.showPosition?q="Parse error on line "+(C+1)+`:
`+Z.showPosition()+`
Expecting `+fe.join(", ")+", got '"+(this.terminals_[j]||j)+"'":q="Parse error on line "+(C+1)+": Unexpected "+(j==ae?"end of input":"'"+(this.terminals_[j]||j)+"'"),this.parseError(q,{text:Z.match,token:this.terminals_[j]||j,line:Z.yylineno,loc:a,expected:fe})}if(_[0]instanceof Array&&_.length>1)throw new Error("Parse Error: multiple actions possible at state: "+ee+", token: "+j);switch(_[0]){case 1:y.push(j),M.push(Z.yytext),R.push(Z.yylloc),y.push(_[1]),j=null,$=Z.yyleng,k=Z.yytext,C=Z.yylineno,a=Z.yylloc;break;case 2:if(L=this.productions_[_[1]][1],S.$=M[M.length-L],S._$={first_line:R[R.length-(L||1)].first_line,last_line:R[R.length-1].last_line,first_column:R[R.length-(L||1)].first_column,last_column:R[R.length-1].last_column},G&&(S._$.range=[R[R.length-(L||1)].range[0],R[R.length-1].range[1]]),V=this.performAction.apply(S,[k,$,C,te.yy,_[1],M,R].concat(ye)),typeof V<"u")return V;L&&(y=y.slice(0,-1*L*2),M=M.slice(0,-1*L),R=R.slice(0,-1*L)),y.push(this.productions_[_[1]][0]),M.push(S.$),R.push(S._$),D=I[y[y.length-2]][y[y.length-1]],y.push(D);break;case 3:return!0}}return!0}},p=function(){var h={EOF:1,parseError:function(m,y){if(this.yy.parser)this.yy.parser.parseError(m,y);else throw new Error(m)},setInput:function(d,m){return this.yy=m||this.yy||{},this._input=d,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var d=this._input[0];this.yytext+=d,this.yyleng++,this.offset++,this.match+=d,this.matched+=d;var m=d.match(/(?:\r\n?|\n).*/g);return m?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),d},unput:function(d){var m=d.length,y=d.split(/(?:\r\n?|\n)/g);this._input=d+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-m),this.offset-=m;var M=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),y.length-1&&(this.yylineno-=y.length-1);var R=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:y?(y.length===M.length?this.yylloc.first_column:0)+M[M.length-y.length].length-y[0].length:this.yylloc.first_column-m},this.options.ranges&&(this.yylloc.range=[R[0],R[0]+this.yyleng-m]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(d){this.unput(this.match.slice(d))},pastInput:function(){var d=this.matched.substr(0,this.matched.length-this.match.length);return(d.length>20?"...":"")+d.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var d=this.match;return d.length<20&&(d+=this._input.substr(0,20-d.length)),(d.substr(0,20)+(d.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var d=this.pastInput(),m=new Array(d.length+1).join("-");return d+this.upcomingInput()+`
`+m+"^"},test_match:function(d,m){var y,M,R;if(this.options.backtrack_lexer&&(R={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(R.yylloc.range=this.yylloc.range.slice(0))),M=d[0].match(/(?:\r\n?|\n).*/g),M&&(this.yylineno+=M.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:M?M[M.length-1].length-M[M.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+d[0].length},this.yytext+=d[0],this.match+=d[0],this.matches=d,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(d[0].length),this.matched+=d[0],y=this.performAction.call(this,this.yy,this,m,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),y)return y;if(this._backtrack){for(var I in R)this[I]=R[I];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var d,m,y,M;this._more||(this.yytext="",this.match="");for(var R=this._currentRules(),I=0;I<R.length;I++)if(y=this._input.match(this.rules[R[I]]),y&&(!m||y[0].length>m[0].length)){if(m=y,M=I,this.options.backtrack_lexer){if(d=this.test_match(y,R[I]),d!==!1)return d;if(this._backtrack){m=!1;continue}else return!1}else if(!this.options.flex)break}return m?(d=this.test_match(m,R[M]),d!==!1?d:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var m=this.next();return m||this.lex()},begin:function(m){this.conditionStack.push(m)},popState:function(){var m=this.conditionStack.length-1;return m>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(m){return m=this.conditionStack.length-1-Math.abs(m||0),m>=0?this.conditionStack[m]:"INITIAL"},pushState:function(m){this.begin(m)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(m,y,M,R){switch(M){case 0:return 11;case 1:return"(";case 2:return")";case 3:return 8;case 4:return 15;case 5:return 13;case 6:return 18;case 7:return 19;case 8:return 20;case 9:return 17;case 10:return 17;case 11:return 17;case 12:break;case 13:return 6}},rules:[/^(?:\/)/,/^(?:\()/,/^(?:\))/,/^(?:(\*|x|\u00d7|\u2219|\u22c5|\u00b7)\s*10\s*\^)/,/^(?:\^)/,/^(?:\*)/,/^(?:[0-9]+\.[0-9]+)/,/^(?:[0-9]+)/,/^(?:-)/,/^(?:\u00b0( ?)[cCfF])/,/^(?:fl\.? oz\.?)/,/^(?:[\u00b5]?([A-Za-z-]+|[\u2103\u2109\u212b]))/,/^(?:\s+)/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};return h}();f.lexer=p;function v(){this.yy={}}return v.prototype=f,f.Parser=v,new v})();var Ge=function(){var n=function(ee,_,V,S){for(V=V||{},S=ee.length;S--;V[ee[S]]=_);return V},e=[1,7],r=[1,17],s=[1,13],o=[1,14],l=[1,15],f=[1,32],p=[1,22],v=[1,23],h=[1,24],d=[1,25],m=[1,26],y=[1,33],M=[1,27],R=[1,28],I=[1,29],k=[1,30],C=[1,20],$=[1,36],J=[1,37],ae=[5,6,8,10,33,35,41,43,45],ye=[1,39],Z=[1,40],te=[5,6,8,10,12,14,16,19,21,22,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],ce=[10,16,19,21,22,28,29,30,31,32,34,37,39,42,43,44,46],a=[5,6,8,10,12,14,16,18,19,21,22,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],G={trace:function(){},yy:{},symbols_:{error:2,equation:3,expression:4,SIGN:5,EOF:6,additive:7,"+":8,multiplicative:9,"-":10,triglog:11,"*":12,negative:13,"/":14,trig:15,TRIG:16,trigfunc:17,"^":18,TRIGINV:19,logbase:20,ln:21,log:22,_:23,subscriptable:24,power:25,primitive:26,variable:27,VAR:28,CONST:29,INT:30,FLOAT:31,"{":32,"}":33,"(":34,")":35,function:36,FUNC:37,invocation:38,sqrt:39,"[":40,"]":41,abs:42,"|":43,"LEFT|":44,"RIGHT|":45,FRAC:46,$accept:0,$end:1},terminals_:{2:"error",5:"SIGN",6:"EOF",8:"+",10:"-",12:"*",14:"/",16:"TRIG",18:"^",19:"TRIGINV",21:"ln",22:"log",23:"_",28:"VAR",29:"CONST",30:"INT",31:"FLOAT",32:"{",33:"}",34:"(",35:")",37:"FUNC",39:"sqrt",40:"[",41:"]",42:"abs",43:"|",44:"LEFT|",45:"RIGHT|",46:"FRAC"},productions_:[0,[3,4],[3,2],[3,1],[4,1],[7,3],[7,3],[7,1],[9,2],[9,3],[9,3],[9,1],[13,2],[13,1],[15,1],[17,1],[17,3],[17,1],[20,1],[20,1],[20,3],[11,2],[11,2],[11,1],[25,3],[25,1],[27,1],[24,3],[24,1],[24,1],[24,1],[24,1],[24,3],[24,3],[36,1],[38,4],[38,4],[38,7],[38,4],[38,3],[38,3],[38,4],[26,1],[26,1],[26,7]],performAction:function(_,V,S,P,L,D,fe){var q=D.length-1;switch(L){case 1:return new P.Eq(D[q-3],D[q-2],D[q-1]);case 2:return D[q-1];case 3:return new P.Add([]);case 4:case 7:case 11:case 13:case 15:case 20:case 23:case 25:case 42:case 43:this.$=D[q];break;case 5:this.$=P.Add.createOrAppend(D[q-2],D[q]);break;case 6:this.$=P.Add.createOrAppend(D[q-2],P.Mul.handleNegative(D[q],"subtract"));break;case 8:this.$=P.Mul.fold(P.Mul.createOrAppend(D[q-1],D[q]));break;case 9:this.$=P.Mul.fold(P.Mul.createOrAppend(D[q-2],D[q]));break;case 10:this.$=P.Mul.fold(P.Mul.handleDivide(D[q-2],D[q]));break;case 12:this.$=P.Mul.handleNegative(D[q]);break;case 14:case 17:this.$=[_];break;case 16:this.$=D[q-2].concat(D[q]);break;case 18:this.$=P.Log.natural();break;case 19:this.$=P.Log.common();break;case 21:this.$=P.Trig.create(D[q-1],D[q]);break;case 22:this.$=P.Log.create(D[q-1],D[q]);break;case 24:this.$=new P.Pow(D[q-2],D[q]);break;case 26:case 34:this.$=_;break;case 27:this.$=new P.Var(D[q-2],D[q]);break;case 28:this.$=new P.Var(D[q]);break;case 29:this.$=new P.Const(_.toLowerCase());break;case 30:this.$=P.Int.create(Number(_));break;case 31:this.$=P.Float.create(Number(_));break;case 32:this.$=D[q-1].completeParse();break;case 33:this.$=D[q-1].completeParse().addHint("parens");break;case 35:case 36:this.$=P.Pow.sqrt(D[q-1]);break;case 37:this.$=new P.Pow.nthroot(D[q-1],D[q-4]);break;case 38:case 39:case 40:this.$=new P.Abs(D[q-1]);break;case 41:this.$=new P.Func(D[q-3],D[q-1]);break;case 44:this.$=P.Mul.handleDivide(D[q-4],D[q-1]);break}},table:[{3:1,4:2,6:[1,3],7:4,9:5,10:e,11:8,13:6,15:12,16:r,17:9,19:s,20:10,21:o,22:l,24:18,25:11,26:16,27:21,28:f,29:p,30:v,31:h,32:d,34:m,36:31,37:y,38:19,39:M,42:R,43:I,44:k,46:C},{1:[3]},{5:[1,34],6:[1,35]},{1:[2,3]},n([5,6],[2,4],{8:$,10:J}),n(ae,[2,7],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:ye,14:Z,16:r,19:s,21:o,22:l,28:f,29:p,30:v,31:h,32:d,34:m,37:y,39:M,42:R,44:k,46:C}),n(te,[2,11]),{10:e,11:8,13:41,15:12,16:r,17:9,19:s,20:10,21:o,22:l,24:18,25:11,26:16,27:21,28:f,29:p,30:v,31:h,32:d,34:m,36:31,37:y,38:19,39:M,42:R,43:I,44:k,46:C},n(te,[2,13]),{10:e,11:8,13:42,15:12,16:r,17:9,19:s,20:10,21:o,22:l,24:18,25:11,26:16,27:21,28:f,29:p,30:v,31:h,32:d,34:m,36:31,37:y,38:19,39:M,42:R,43:I,44:k,46:C},{10:e,11:8,13:43,15:12,16:r,17:9,19:s,20:10,21:o,22:l,24:18,25:11,26:16,27:21,28:f,29:p,30:v,31:h,32:d,34:m,36:31,37:y,38:19,39:M,42:R,43:I,44:k,46:C},n(te,[2,23]),n(ce,[2,15],{18:[1,44]}),n(ce,[2,17]),n(ce,[2,18]),n(ce,[2,19],{23:[1,45]}),n(te,[2,25],{18:[1,46]}),n([10,16,18,19,21,22,28,29,30,31,32,34,37,39,42,43,44,46],[2,14]),n(a,[2,42]),n(a,[2,43]),{32:[1,47]},n(a,[2,28],{23:[1,48]}),n(a,[2,29]),n(a,[2,30]),n(a,[2,31]),{7:49,9:5,10:e,11:8,13:6,15:12,16:r,17:9,19:s,20:10,21:o,22:l,24:18,25:11,26:16,27:21,28:f,29:p,30:v,31:h,32:d,34:m,36:31,37:y,38:19,39:M,42:R,43:I,44:k,46:C},{7:50,9:5,10:e,11:8,13:6,15:12,16:r,17:9,19:s,20:10,21:o,22:l,24:18,25:11,26:16,27:21,28:f,29:p,30:v,31:h,32:d,34:m,36:31,37:y,38:19,39:M,42:R,43:I,44:k,46:C},{32:[1,52],34:[1,51],40:[1,53]},{34:[1,54]},{7:55,9:5,10:e,11:8,13:6,15:12,16:r,17:9,19:s,20:10,21:o,22:l,24:18,25:11,26:16,27:21,28:f,29:p,30:v,31:h,32:d,34:m,36:31,37:y,38:19,39:M,42:R,43:I,44:k,46:C},{7:56,9:5,10:e,11:8,13:6,15:12,16:r,17:9,19:s,20:10,21:o,22:l,24:18,25:11,26:16,27:21,28:f,29:p,30:v,31:h,32:d,34:m,36:31,37:y,38:19,39:M,42:R,43:I,44:k,46:C},{34:[1,57]},n([5,6,8,10,12,14,16,18,19,21,22,23,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],[2,26]),{34:[2,34]},{4:58,7:4,9:5,10:e,11:8,13:6,15:12,16:r,17:9,19:s,20:10,21:o,22:l,24:18,25:11,26:16,27:21,28:f,29:p,30:v,31:h,32:d,34:m,36:31,37:y,38:19,39:M,42:R,43:I,44:k,46:C},{1:[2,2]},{9:59,10:e,11:8,13:6,15:12,16:r,17:9,19:s,20:10,21:o,22:l,24:18,25:11,26:16,27:21,28:f,29:p,30:v,31:h,32:d,34:m,36:31,37:y,38:19,39:M,42:R,43:I,44:k,46:C},{9:60,10:e,11:8,13:6,15:12,16:r,17:9,19:s,20:10,21:o,22:l,24:18,25:11,26:16,27:21,28:f,29:p,30:v,31:h,32:d,34:m,36:31,37:y,38:19,39:M,42:R,43:I,44:k,46:C},n(te,[2,8]),{10:e,11:8,13:61,15:12,16:r,17:9,19:s,20:10,21:o,22:l,24:18,25:11,26:16,27:21,28:f,29:p,30:v,31:h,32:d,34:m,36:31,37:y,38:19,39:M,42:R,43:I,44:k,46:C},{10:e,11:8,13:62,15:12,16:r,17:9,19:s,20:10,21:o,22:l,24:18,25:11,26:16,27:21,28:f,29:p,30:v,31:h,32:d,34:m,36:31,37:y,38:19,39:M,42:R,43:I,44:k,46:C},n(te,[2,12]),n(te,[2,21]),n(te,[2,22]),{10:e,11:8,13:63,15:12,16:r,17:9,19:s,20:10,21:o,22:l,24:18,25:11,26:16,27:21,28:f,29:p,30:v,31:h,32:d,34:m,36:31,37:y,38:19,39:M,42:R,43:I,44:k,46:C},{24:64,27:21,28:f,29:p,30:v,31:h,32:d,34:m},{10:e,11:8,13:65,15:12,16:r,17:9,19:s,20:10,21:o,22:l,24:18,25:11,26:16,27:21,28:f,29:p,30:v,31:h,32:d,34:m,36:31,37:y,38:19,39:M,42:R,43:I,44:k,46:C},{7:66,9:5,10:e,11:8,13:6,15:12,16:r,17:9,19:s,20:10,21:o,22:l,24:18,25:11,26:16,27:21,28:f,29:p,30:v,31:h,32:d,34:m,36:31,37:y,38:19,39:M,42:R,43:I,44:k,46:C},{24:67,27:21,28:f,29:p,30:v,31:h,32:d,34:m},{8:$,10:J,33:[1,68]},{8:$,10:J,35:[1,69]},{7:70,9:5,10:e,11:8,13:6,15:12,16:r,17:9,19:s,20:10,21:o,22:l,24:18,25:11,26:16,27:21,28:f,29:p,30:v,31:h,32:d,34:m,36:31,37:y,38:19,39:M,42:R,43:I,44:k,46:C},{7:71,9:5,10:e,11:8,13:6,15:12,16:r,17:9,19:s,20:10,21:o,22:l,24:18,25:11,26:16,27:21,28:f,29:p,30:v,31:h,32:d,34:m,36:31,37:y,38:19,39:M,42:R,43:I,44:k,46:C},{7:72,9:5,10:e,11:8,13:6,15:12,16:r,17:9,19:s,20:10,21:o,22:l,24:18,25:11,26:16,27:21,28:f,29:p,30:v,31:h,32:d,34:m,36:31,37:y,38:19,39:M,42:R,43:I,44:k,46:C},{7:73,9:5,10:e,11:8,13:6,15:12,16:r,17:9,19:s,20:10,21:o,22:l,24:18,25:11,26:16,27:21,28:f,29:p,30:v,31:h,32:d,34:m,36:31,37:y,38:19,39:M,42:R,43:I,44:k,46:C},{8:$,10:J,43:[1,74]},{8:$,10:J,45:[1,75]},{7:76,9:5,10:e,11:8,13:6,15:12,16:r,17:9,19:s,20:10,21:o,22:l,24:18,25:11,26:16,27:21,28:f,29:p,30:v,31:h,32:d,34:m,36:31,37:y,38:19,39:M,42:R,43:I,44:k,46:C},{6:[1,77]},n(ae,[2,5],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:ye,14:Z,16:r,19:s,21:o,22:l,28:f,29:p,30:v,31:h,32:d,34:m,37:y,39:M,42:R,44:k,46:C}),n(ae,[2,6],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:ye,14:Z,16:r,19:s,21:o,22:l,28:f,29:p,30:v,31:h,32:d,34:m,37:y,39:M,42:R,44:k,46:C}),n(te,[2,9]),n(te,[2,10]),n(ce,[2,16]),n(ce,[2,20]),n(te,[2,24]),{8:$,10:J,33:[1,78]},n(a,[2,27]),n(a,[2,32]),n(a,[2,33]),{8:$,10:J,35:[1,79]},{8:$,10:J,33:[1,80]},{8:$,10:J,41:[1,81]},{8:$,10:J,35:[1,82]},n(a,[2,39]),n(a,[2,40]),{8:$,10:J,35:[1,83]},{1:[2,1]},{32:[1,84]},n(a,[2,35]),n(a,[2,36]),{32:[1,85]},n(a,[2,38]),n(a,[2,41]),{7:86,9:5,10:e,11:8,13:6,15:12,16:r,17:9,19:s,20:10,21:o,22:l,24:18,25:11,26:16,27:21,28:f,29:p,30:v,31:h,32:d,34:m,36:31,37:y,38:19,39:M,42:R,43:I,44:k,46:C},{7:87,9:5,10:e,11:8,13:6,15:12,16:r,17:9,19:s,20:10,21:o,22:l,24:18,25:11,26:16,27:21,28:f,29:p,30:v,31:h,32:d,34:m,36:31,37:y,38:19,39:M,42:R,43:I,44:k,46:C},{8:$,10:J,33:[1,88]},{8:$,10:J,33:[1,89]},n(a,[2,44]),n(a,[2,37])],defaultActions:{3:[2,3],33:[2,34],35:[2,2],77:[2,1]},parseError:function(_,V){if(V.recoverable)this.trace(_);else throw new Error(_)},parse:function(_){var V=this,S=[0],P=[null],L=[],D=this.table,fe="",q=0,pe=0,Oe=2,t=1,i=L.slice.call(arguments,1),c=Object.create(this.lexer),u={yy:{}};for(var g in this.yy)Object.prototype.hasOwnProperty.call(this.yy,g)&&(u.yy[g]=this.yy[g]);c.setInput(_,u.yy),u.yy.lexer=c,u.yy.parser=this,typeof c.yylloc>"u"&&(c.yylloc={});var E=c.yylloc;L.push(E);var w=c.options&&c.options.ranges;typeof u.yy.parseError=="function"?this.parseError=u.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function T(){var Le;return Le=c.lex()||t,typeof Le!="number"&&(Le=V.symbols_[Le]||Le),Le}for(var F,H,Y,Ne,me={},_e,Ie,Ot,Xe;;){if(H=S[S.length-1],this.defaultActions[H]?Y=this.defaultActions[H]:((F===null||typeof F>"u")&&(F=T()),Y=D[H]&&D[H][F]),typeof Y>"u"||!Y.length||!Y[0]){var nt="";Xe=[];for(_e in D[H])this.terminals_[_e]&&_e>Oe&&Xe.push("'"+this.terminals_[_e]+"'");c.showPosition?nt="Parse error on line "+(q+1)+`:
`+c.showPosition()+`
Expecting `+Xe.join(", ")+", got '"+(this.terminals_[F]||F)+"'":nt="Parse error on line "+(q+1)+": Unexpected "+(F==t?"end of input":"'"+(this.terminals_[F]||F)+"'"),this.parseError(nt,{text:c.match,token:this.terminals_[F]||F,line:c.yylineno,loc:E,expected:Xe})}if(Y[0]instanceof Array&&Y.length>1)throw new Error("Parse Error: multiple actions possible at state: "+H+", token: "+F);switch(Y[0]){case 1:S.push(F),P.push(c.yytext),L.push(c.yylloc),S.push(Y[1]),F=null,pe=c.yyleng,fe=c.yytext,q=c.yylineno,E=c.yylloc;break;case 2:if(Ie=this.productions_[Y[1]][1],me.$=P[P.length-Ie],me._$={first_line:L[L.length-(Ie||1)].first_line,last_line:L[L.length-1].last_line,first_column:L[L.length-(Ie||1)].first_column,last_column:L[L.length-1].last_column},w&&(me._$.range=[L[L.length-(Ie||1)].range[0],L[L.length-1].range[1]]),Ne=this.performAction.apply(me,[fe,pe,q,u.yy,Y[1],P,L].concat(i)),typeof Ne<"u")return Ne;Ie&&(S=S.slice(0,-1*Ie*2),P=P.slice(0,-1*Ie),L=L.slice(0,-1*Ie)),S.push(this.productions_[Y[1]][0]),P.push(me.$),L.push(me._$),Ot=D[S[S.length-2]][S[S.length-1]],S.push(Ot);break;case 3:return!0}}return!0}},Me=function(){var ee={EOF:1,parseError:function(V,S){if(this.yy.parser)this.yy.parser.parseError(V,S);else throw new Error(V)},setInput:function(_,V){return this.yy=V||this.yy||{},this._input=_,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var _=this._input[0];this.yytext+=_,this.yyleng++,this.offset++,this.match+=_,this.matched+=_;var V=_.match(/(?:\r\n?|\n).*/g);return V?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),_},unput:function(_){var V=_.length,S=_.split(/(?:\r\n?|\n)/g);this._input=_+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-V),this.offset-=V;var P=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),S.length-1&&(this.yylineno-=S.length-1);var L=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:S?(S.length===P.length?this.yylloc.first_column:0)+P[P.length-S.length].length-S[0].length:this.yylloc.first_column-V},this.options.ranges&&(this.yylloc.range=[L[0],L[0]+this.yyleng-V]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(_){this.unput(this.match.slice(_))},pastInput:function(){var _=this.matched.substr(0,this.matched.length-this.match.length);return(_.length>20?"...":"")+_.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var _=this.match;return _.length<20&&(_+=this._input.substr(0,20-_.length)),(_.substr(0,20)+(_.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var _=this.pastInput(),V=new Array(_.length+1).join("-");return _+this.upcomingInput()+`
`+V+"^"},test_match:function(_,V){var S,P,L;if(this.options.backtrack_lexer&&(L={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(L.yylloc.range=this.yylloc.range.slice(0))),P=_[0].match(/(?:\r\n?|\n).*/g),P&&(this.yylineno+=P.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:P?P[P.length-1].length-P[P.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+_[0].length},this.yytext+=_[0],this.match+=_[0],this.matches=_,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(_[0].length),this.matched+=_[0],S=this.performAction.call(this,this.yy,this,V,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),S)return S;if(this._backtrack){for(var D in L)this[D]=L[D];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var _,V,S,P;this._more||(this.yytext="",this.match="");for(var L=this._currentRules(),D=0;D<L.length;D++)if(S=this._input.match(this.rules[L[D]]),S&&(!V||S[0].length>V[0].length)){if(V=S,P=D,this.options.backtrack_lexer){if(_=this.test_match(S,L[D]),_!==!1)return _;if(this._backtrack){V=!1;continue}else return!1}else if(!this.options.flex)break}return V?(_=this.test_match(V,L[P]),_!==!1?_:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var V=this.next();return V||this.lex()},begin:function(V){this.conditionStack.push(V)},popState:function(){var V=this.conditionStack.length-1;return V>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(V){return V=this.conditionStack.length-1-Math.abs(V||0),V>=0?this.conditionStack[V]:"INITIAL"},pushState:function(V){this.begin(V)},stateStackSize:function(){return this.conditionStack.length},options:{flex:!0},performAction:function(V,S,P,L){switch(P){case 0:break;case 1:break;case 2:break;case 3:return"INT";case 4:return"FLOAT";case 5:return"^";case 6:return"*";case 7:return"*";case 8:return"*";case 9:return"*";case 10:return"/";case 11:return"/";case 12:return"-";case 13:return"-";case 14:return"+";case 15:return"^";case 16:return"(";case 17:return")";case 18:return"(";case 19:return")";case 20:return"[";case 21:return"]";case 22:return"{";case 23:return"}";case 24:return"{";case 25:return"}";case 26:return"_";case 27:return"|";case 28:return"LEFT|";case 29:return"RIGHT|";case 30:return"!";case 31:return"SIGN";case 32:return S.yytext="<=","SIGN";case 33:return S.yytext=">=","SIGN";case 34:return S.yytext="<=","SIGN";case 35:return S.yytext=">=","SIGN";case 36:return S.yytext="<>","SIGN";case 37:return S.yytext="<>","SIGN";case 38:return S.yytext="<>","SIGN";case 39:return S.yytext="<>","SIGN";case 40:return S.yytext="<=","SIGN";case 41:return S.yytext=">=","SIGN";case 42:return"FRAC";case 43:return"FRAC";case 44:return"sqrt";case 45:return"abs";case 46:return"ln";case 47:return"log";case 48:return"TRIG";case 49:return"TRIG";case 50:return"TRIG";case 51:return"TRIG";case 52:return S.yytext="sin","TRIG";case 53:return S.yytext="cos","TRIG";case 54:return S.yytext="tan","TRIG";case 55:return S.yytext="csc","TRIG";case 56:return S.yytext="sec","TRIG";case 57:return S.yytext="cot","TRIG";case 58:return S.yytext="arcsin","TRIG";case 59:return S.yytext="arccos","TRIG";case 60:return S.yytext="arctan","TRIG";case 61:return S.yytext="arccsc","TRIG";case 62:return S.yytext="arcsec","TRIG";case 63:return S.yytext="arccot","TRIG";case 64:return"TRIGINV";case 65:return"TRIGINV";case 66:return S.yytext="sinh","TRIG";case 67:return S.yytext="cosh","TRIG";case 68:return S.yytext="tanh","TRIG";case 69:return S.yytext="csch","TRIG";case 70:return S.yytext="sech","TRIG";case 71:return S.yytext="tanh","TRIG";case 72:return"CONST";case 73:return S.yytext="pi","CONST";case 74:return S.yytext="pi","CONST";case 75:return"VAR";case 76:return S.yytext="theta","VAR";case 77:return S.yytext="theta","VAR";case 78:return"VAR";case 79:return S.yytext="phi","VAR";case 80:return S.yytext="phi","VAR";case 81:return V.symbolLexer(S.yytext);case 82:return"EOF";case 83:return"INVALID";case 84:console.log(S.yytext);break}},rules:[/^(?:\s+)/,/^(?:\\space)/,/^(?:\\ )/,/^(?:[0-9]+\.?)/,/^(?:([0-9]+)?\.[0-9]+)/,/^(?:\*\*)/,/^(?:\*)/,/^(?:\\cdot|·)/,/^(?:\\times|×)/,/^(?:\\ast)/,/^(?:\/)/,/^(?:\\div|÷)/,/^(?:-)/,/^(?:−)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:\\left\()/,/^(?:\\right\))/,/^(?:\[)/,/^(?:\])/,/^(?:\{)/,/^(?:\})/,/^(?:\\left\{)/,/^(?:\\right\})/,/^(?:_)/,/^(?:\|)/,/^(?:\\left\|)/,/^(?:\\right\|)/,/^(?:\!)/,/^(?:<=|>=|<>|<|>|=)/,/^(?:\\le)/,/^(?:\\ge)/,/^(?:\\leq)/,/^(?:\\geq)/,/^(?:=\/=)/,/^(?:\\ne)/,/^(?:\\neq)/,/^(?:≠)/,/^(?:≤)/,/^(?:≥)/,/^(?:\\frac)/,/^(?:\\dfrac)/,/^(?:sqrt|\\sqrt)/,/^(?:abs|\\abs)/,/^(?:ln|\\ln)/,/^(?:log|\\log)/,/^(?:sin|cos|tan)/,/^(?:csc|sec|cot)/,/^(?:sinh|cosh|tanh)/,/^(?:csch|sech|coth)/,/^(?:\\sin)/,/^(?:\\cos)/,/^(?:\\tan)/,/^(?:\\csc)/,/^(?:\\sec)/,/^(?:\\cot)/,/^(?:\\arcsin)/,/^(?:\\arccos)/,/^(?:\\arctan)/,/^(?:\\arccsc)/,/^(?:\\arcsec)/,/^(?:\\arccot)/,/^(?:arcsin|arccos|arctan)/,/^(?:arccsc|arcsec|arccot)/,/^(?:\\sinh)/,/^(?:\\cosh)/,/^(?:\\tanh)/,/^(?:\\csch)/,/^(?:\\sech)/,/^(?:\\coth)/,/^(?:pi)/,/^(?:π)/,/^(?:\\pi)/,/^(?:theta)/,/^(?:θ)/,/^(?:\\theta)/,/^(?:phi)/,/^(?:φ)/,/^(?:\\phi)/,/^(?:[a-zA-Z])/,/^(?:$)/,/^(?:.)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84],inclusive:!0}}};return ee}();G.lexer=Me;function j(){this.yy={}}return j.prototype=G,G.Parser=j,new j}();const Nt=function(n){return n!==n},Mn=function(n,e){var r=e-n;return Math.random()*r+n};var It=12,St=9;function ze(n,e){const r=[],s=[];return x.forEach(n,(o,l,f)=>{e(o,l,f)?r.push(o):s.push(o)}),[r,s]}function On(n){return n instanceof Re}const Ye=function(n){return n instanceof se};function Nn(n){return n instanceof W}function rt(n){return n instanceof N?n.terms:[n]}class Re{constructor(){this.hints={parens:!1}}construct(e){const r=this.func,s=new r(...e);if(typeof s>"u")throw new Error("constructor function returning undefined");return s}recurse(e,...r){var s=this.args().map(function(o){return x.isString(o)||x.isNumber(o)?o:o==null?void 0:o[e].apply(o,r)});return this.construct(s)}eval(e={},r){throw new Error("Abstract method - must override for expr: "+this.print())}codegen(){throw new Error("Abstract method - must override for expr: "+this.print())}compile(){var e=this.codegen();try{return new Function("vars","return "+e+";")}catch{throw new Error("Function did not compile: "+e)}}asTex(e){e=e||{},x.defaults(e,{display:!0,dynamic:!0,times:!1});let r=this.tex();return e.display&&(r="\\displaystyle "+r),e.dynamic&&(r=r.replace(/\(/g,"\\left("),r=r.replace(/\)/g,"\\right)")),e.times&&(r=r.replace(/\\cdot/g,"\\times")),r}name(){return this.func.name}repr(){return this.name()+"("+this.args().map(function(e){return x.isString(e)||x.isNumber(e)?e:e==null?void 0:e.repr()}).join(",")+")"}strip(){return this.recurse("strip")}normalize(){return this.recurse("normalize")}expand(){return this.recurse("expand")}factor(e){return this.recurse("factor",e)}collect(e){return this.recurse("collect",e)}equals(e){return this.normalize().print()===e.normalize().print()}simplify(e){e={once:!1,...e};var r=this.factor(e),s=r.collect(e);r.equals(s)&&(s=this.collect(e));var o=s.expand(),l=o.collect(e);o.equals(l)&&(l=s.collect(e));var f=l;return e.once||this.equals(f)?f:f.simplify(e)}isSimplified(){return this.equals(this.simplify())}exprArgs(){return this.args().filter(On)}getVars(e){return x.uniq(x.flatten(x.invoke(this.exprArgs(),"getVars",e))).sort()}getConsts(){return x.uniq(x.flatten(x.invoke(this.exprArgs(),"getConsts"))).sort()}getUnits(){return x.flatten(x.invoke(this.exprArgs(),"getUnits"))}is(e){return this instanceof e}has(e){return this instanceof e?!0:x.any(this.exprArgs(),function(r){return r.has(e)})}raiseToThe(e,r){return new U(this,e)}isSubtract(){return!1}isDivide(){return!1}isRoot(){return!1}needsExplicitMul(){return this.exprArgs()[0].needsExplicitMul()}sameVars(e){var r=this.getVars(),s=e.getVars(),o=function(v,h){return!x.difference(v,h).length},l=function(v){return x.uniq(x.invoke(v,"toLowerCase")).sort()},f=o(r,s),p=o(l(r),l(s));return{equal:f,equalIgnoringCase:p}}compare(e){if(e instanceof Ue)return!1;var r=x.union(this.getVars(!0),e.getVars(!0)),s=function(M,R){return Math.abs(M)<1||Math.abs(R)<1?Math.abs(M-R):Math.abs(1-M/R)},o=function(M,R){var I=s(M,R);return M===R||Nt(M)&&Nt(R)||I<Math.pow(10,-St)};if(!r.length&&!this.has(he)&&!e.has(he))return o(this.eval(),e.eval());var l=this.collect(),f=e.collect(),p=this.getUnits(),v=e.getUnits();if(!x.isEqual(p,v))return!1;for(var h=0;h<It;h++){var d={},m=Math.pow(10,1+Math.floor(3*h/It)),y=h%2===0;x.each(r,function(R){d[R]=y?Mn(-m,m):x.random(-m,m)});let M;if(l.has(Te)||f.has(Te)||l.has(he)||f.has(he)){const R=l.partialEval(d),I=f.partialEval(d);M=R.simplify().equals(I.simplify())}else{const R=l.eval(d),I=f.eval(d);M=o(R,I)}if(!M)return!1}return!0}partialEval(e){return this instanceof he?this:this.has(Te)?this instanceof Te?new Te(this.symbol,this.arg.partialEval(e)):this.recurse("partialEval",e):new le(+this.eval(e).toFixed(St)).collect()}sameForm(e){return this.strip().equals(e.strip())}findGCD(e){return this.equals(e)?e:re}getDenominator(){return re}asMul(){return new N(re,this)}isPositive(){throw new Error("Abstract method - must override for expr: "+this.print())}isNegative(){return!1}asPositiveFactor(){return this.isPositive()?this:re}addHint(e){if(!e)return this;var r=this.construct(this.args());return r.hints=x.clone(this.hints),r.hints[e]=!0,r}completeParse(){return this.recurse("completeParse")}abs(){throw new Error("Abstract method - must override for expr: "+this.print())}negate(){return new N(ke,this)}}class Je extends Re{constructor(...e){super(),e.length===1?this.terms=e[0]:this.terms=e}args(){return this.terms}normalize(){var e=x.sortBy(x.invoke(this.terms,"normalize"),r=>r.print());return new this.func(e)}expand(){return this.recurse("expand").flatten()}partition(){var[e,r]=ze(this.terms,s=>s instanceof z);return[new this.func(e),new this.func(r)]}flatten(){var e=this,r=x.reject(this.terms,f=>f.equals(e.identity));if(r.length===0)return e.identity;if(r.length===1)return r[0];const[s,o]=ze(r,f=>f instanceof e.func);var l=o.concat(x.flatten(x.pluck(s,"terms"),!0));return new e.func(l)}isPositive(){var e=x.invoke(this.terms,"collect");return x.all(x.invoke(e,"isPositive"))}replace(e,r){const s=e instanceof Re?x.indexOf(this.terms,e):e;var o=[];Array.isArray(r)?o=r:r&&(o=[r]);var l=this.terms.slice(0,s).concat(o).concat(this.terms.slice(s+1));return new this.func(l)}remove(e){return this.replace(e)}getDenominator(){return new N(x.invoke(this.terms,"getDenominator")).flatten()}}class se extends Je{constructor(){super(...arguments),this.identity=He,this.func=se}eval(e={},r){return x.reduce(this.terms,(s,o)=>s+o.eval(e,r),0)}codegen(){return x.map(this.terms,e=>"("+e.codegen()+")").join(" + ")||"0"}print(){return x.invoke(this.terms,"print").join("+")}tex(){let e="";return x.each(this.terms,r=>{!e||r.isSubtract()?e+=r.tex():e+="+"+r.tex()}),e}collect(e){var r=x.invoke(this.terms,"collect",e),s=[];x.each(r,f=>{if(f instanceof N){var p=f.partition();s.push([p[1].flatten(),p[0].reduce(e)])}else f instanceof z?s.push([re,f]):s.push([f,re])});var o=x.groupBy(s,f=>f[0].normalize().print()),l=x.compact(x.map(o,f=>{var p=f[0][0],v=new se(x.zip.apply(x,f)[1]),h=v.reduce(e);return new N(h,p).collect(e)}));return new se(l).flatten()}factor(e={keepNegative:!1}){const r=this.terms.map(p=>p.collect());let s;r[0]instanceof N?s=r[0].terms:s=[r[0]],x.each(x.rest(this.terms),p=>{s=x.map(s,v=>p.findGCD(v))}),!e.keepNegative&&this.isNegative()&&s.push(ke);const o=new N(s).flatten().collect(),l=r.map(p=>N.handleDivide(p,o).simplify()),f=new se(l).flatten();return N.createOrAppend(o,f).flatten()}reduce(e){return x.reduce(this.terms,(r,s)=>r.add(s,e),this.identity)}needsExplicitMul(){return!1}isNegative(){var e=x.invoke(this.terms,"collect");return x.all(x.invoke(e,"isNegative"))}negate(){return new se(x.invoke(this.terms,"negate"))}static createOrAppend(e,r){return e instanceof se?new se(e.terms.concat(r)):new se(e,r)}}class N extends Je{constructor(){super(...arguments),this.identity=re,this.func=N}eval(e={},r){return x.reduce(this.terms,(s,o)=>s*o.eval(e,r),1)}codegen(){return x.map(this.terms,e=>"("+e.codegen()+")").join(" * ")||"0"}print(){return x.map(this.terms,e=>e instanceof se?"("+e.print()+")":e.print()).join("*")}getUnits(){var e=x(this.terms).chain().map(r=>r.getUnits()).flatten().value();return e.sort((r,s)=>r.unit.localeCompare(s.unit)),e}tex(){for(var e=" \\cdot ",r=x.groupBy(this.terms,R=>R.isDivide()?"inverse":R instanceof z?"number":"other"),s=r.inverse||[],o=r.number||[],l=r.other||[],f="",p,v=0;v<o.length;v++){var h=o[v]instanceof W&&!(o[v]instanceof b);if(h&&l.length>0&&s.length>0){var d=o.slice();d.splice(v,1);var m=d.concat(s).concat(l);return o[v].tex()+new N(m).tex()}}if(o=x.compact(x.map(o,R=>{var I=!R.hints.fraction||s.length>0;if(R instanceof W&&!(R instanceof b)&&I){s.push(new U(new b(R.d),Fe));var k=new b(R.n);return k.hints=R.hints,x.any(R.hints)?k:null}else return R})),o.length===0&&l.length===1)p=l[0].tex();else{var y="";x.each(o,R=>{R.hints.subtract&&R.hints.entered?(f+="-",y+=(y?e:"")+R.abs().tex()):R instanceof b&&R.n===-1&&(R.hints.negate||R.hints.subtract)?f+="-":y+=(y?e:"")+R.tex()}),x.each(l,R=>{R.needsExplicitMul()?y+=(y?e:"")+R.tex():R instanceof se?y+="("+R.tex()+")":y+=R.tex()}),p=y||"1"}if(s.length){var M=new N(x.invoke(s,"asDivide")).flatten().tex();return f+"\\frac{"+p+"}{"+M+"}"}else return f+p}strip(){var e=x.map(this.terms,r=>r instanceof z?r.abs():r.strip());return new N(e).flatten()}expand(){const e=function(h){return h instanceof U&&h.exp.isNegative()},r=function(h){return e(h)&&Ye(h.base)},s=this.recurse("expand").flatten(),o=rt(s),l=x.any(o,Ye),f=x.any(o,r);if(!(l||f))return s;let[p,v]=ze(o,e);if(l){const[h,d]=ze(v,Ye),m=x.reduce(h,function(M,R){return x.reduce(M,function(I,k){return I.concat(x.map(R.terms,C=>k.concat(C)))},[])},[[]]),y=x.map(m,function(M){return new N(d.concat(M)).flatten()});v=[new se(y)]}if(f){const h=new N(x.invoke(p,"getDenominator")).flatten();p=[new U(h.expand(),Fe)]}return new N(v.concat(p)).flatten()}factor(e){var r=this.recurse("factor",e).flatten();if(!(r instanceof N))return r;var[s,o]=ze(r.terms,p=>p instanceof W);const l=x.reduce(s,(p,v)=>({n:p.n*v.n,d:p.d*v.d}),{n:1,d:1}),f=l.d===1?new b(l.n):new W(l.n,l.d);return new N(o.concat(f)).flatten()}collect(e){var r=this.recurse("collect",e).partition(),s=r[0].reduce(e);if(s.eval()===0)return He;const o=r[1].flatten();if(!(o instanceof N))return new N(s,o).flatten();const l=o.terms;var f=[];x.each(l,k=>{k instanceof U?f.push([k.base,k.exp]):f.push([k,re])});var p=x.groupBy(f,k=>k[0].normalize().print()),v=x.compact(x.map(p,k=>{var C=k[0][0],$=new se(x.zip.apply(x,k)[1]),J=$.collect(e);return J instanceof z&&J.eval()===0?null:[C,J]}));const h=x.groupBy(v,k=>k[0]instanceof X&&k[0].isBasic()?"trig":k[0]instanceof ue?"log":"expr");let d=h.trig||[],m=h.log||[];const y=h.expr||[];if(d.length>1){var M=x.groupBy(d,k=>k[0].arg.normalize().print());d=[],x.each(M,k=>{const C=k[0][0].arg;let $={sin:He,cos:He};x.each(k,J=>{$[J[0].type]=J[1]}),N.handleNegative($.sin).collect(e).equals($.cos)&&($.cos.isNegative()?$={tan:$.sin}:$={cot:$.cos}),x.each($,(J,ae)=>{d.push([new X(ae,C),J])})})}if(m.length>1){var R=x.groupBy(m,k=>k[0].base.normalize().print());m=[],x.each(R,k=>{k.length===2&&N.handleNegative(k[0][1]).collect(e).equals(k[1][1])?k[0][1].isNegative()?m.push([new ue(k[0][0].power,k[1][0].power),k[1][1]]):m.push([new ue(k[1][0].power,k[0][0].power),k[0][1]]):m=m.concat(k)})}var I=x.map([...d,...m,...y],k=>new U(k[0],k[1]).collect(e));return new N([s].concat(I)).flatten()}isSubtract(){return x.any(this.terms,e=>e instanceof z&&!!e.hints.subtract)}factorIn(e){var r=this.partition(),s=r[0].terms,o=s.length&&x.all(s,f=>f.n>0);if(o){var l=s[0].negate();return l.hints=s[0].hints,this.replace(s[0],l.addHint(e))}else return new N([z.negativeOne(e)].concat(this.terms))}factorOut(){var e=!1,r=x.compact(x.map(this.terms,s=>!e&&s instanceof z&&s.hints.divide?(e=!0,s.n!==-1?s.negate():null):s));return r.length===1?r[0]:new N(r)}reduce(e){return x.reduce(this.terms,(r,s)=>r.mul(s,e),this.identity)}findGCD(e){return new N(x.invoke(this.terms,"findGCD",e)).flatten()}asMul(){return this}asPositiveFactor(){if(this.isPositive())return this;{const e=rt(this.collect()).map(r=>r.asPositiveFactor());return new N(e).flatten()}}isNegative(){const e=rt(this.collect()).map(r=>r.isNegative());return x.any(e)}fold(){return N.fold(this)}negate(){var e=s=>s instanceof z;const r=x.find(this.terms,e);return r?this.replace(r,r.negate()):new N([ke].concat(this.terms))}static handleNegative(e,r){if(e instanceof z&&e.n>0){var s=e.negate();return s.hints=e.hints,s.addHint(r)}else return e instanceof N?e.factorIn(r):new N(z.negativeOne(r),e)}static handleDivide(e,r){if(r instanceof N){var s=N.handleDivide(e,r.terms[0]),o=new N(x.rest(r.terms)).flatten();return N.handleDivide(s,o)}var l=y=>y instanceof b,f=y=>y instanceof W;if(l(r)&&e instanceof N&&x.any(e.terms,l)){var p=e.terms.slice().reverse(),v=p.find(f);if(!l(v))return new N(e.terms.concat([new W(1,r.n).addHint("fraction")]));var h=new W(v.n,r.n);return h.hints=v.hints,v===p[0]&&(h=h.addHint("fraction")),v.n<0&&r.n<0?(h.d=-h.d,e.replace(v,[ke,h])):e.replace(v,h)}var d=(y,M)=>{if(M instanceof b){if(y instanceof b)return y.n<0&&M.n<0?[ke,new W(y.n,-M.n).addHint("fraction")]:[new W(y.n,M.n).addHint("fraction")];var R=new W(1,M.eval());return M.eval()<0?[y,R.addHint("negate")]:[y,R]}else{var I;if(M instanceof X&&M.exp){var k=M.exp;M.exp=void 0,M=new U(M,k)}return M instanceof U?I=new U(M.base,N.handleNegative(M.exp,"divide")):I=new U(M,Fe),y instanceof b&&y.n===1?[I]:[y,I]}};if(e instanceof N){var m=d(x.last(e.terms),r);return new N(x.initial(e.terms).concat(m))}else{var m=d(e,r);return new N(m).flatten()}}static fold(e){if(e instanceof N){var r=x.find(x.initial(e.terms),y=>(y instanceof X||y instanceof ue)&&!!y.hints.open);if(r){const y=x.last(e.terms);if(r.hints.parens||y.hints.parens||y.has(X)||y.has(ue))r.hints.open=!1;else{const M=r instanceof X?X.create([r.type,r.exp],N.createOrAppend(r.arg,y).fold()):ue.create(r.base,N.createOrAppend(r.power,y).fold()),R=x.indexOf(e.terms,r);return R===0?M:new N(e.terms.slice(0,R).concat(M)).fold()}}var s=e.partition(),o=s[0].terms,l=y=>y.n>0,f=y=>y.n===-1&&!!y.hints.negate,p=function(y){return l(y)||f(y)};const d=o.find(l),m=o.find(f);if(o.length>1&&m&&d&&x.every(o,p)){var v=x.indexOf(e.terms,m),h=x.indexOf(e.terms,d);if(v<h)return e.replace(h,e.terms[h].negate()).remove(v)}}return e}static createOrAppend(e,r){return e instanceof N?new N(e.terms.concat(r)):new N(e,r)}}const Q=class Q extends Re{constructor(e,r){super(),this.func=Q,this.base=e,this.exp=r}args(){return[this.base,this.exp]}eval(e={},r){var s=this.base.eval(e,r),o=this.exp.eval(e,r);if(s<0){var l=this.exp.simplify();if(l instanceof le){var f=l.n,p=(f-+f.toFixed()).toString().length-2,v=Math.pow(10,p),h=new W(f*v,v);l=h.simplify()}if(l instanceof W){var d=Math.abs(l.d)%2===1;if(d){var m=Math.abs(l.n)%2===1,y=m?-1:1;return y*Math.pow(-1*s,o)}}}return Math.pow(s,o)}getUnits(){return this.base.getUnits().map(e=>({unit:e.unit,pow:e.pow*this.exp.n}))}codegen(){return"Math.pow("+this.base.codegen()+", "+this.exp.codegen()+")"}print(){var e=this.base.print();return(this.base instanceof Je||this.base instanceof Q)&&(e="("+e+")"),e+"^("+this.exp.print()+")"}tex(){if(this.isDivide())return"\\frac{1}{"+this.asDivide().tex()+"}";if(this.isRoot()&&Nn(this.exp)){if(this.exp.n!==1)throw new Error("Node marked with hint 'root' does not have exponent of form 1/x.");return this.exp.d===2?"\\sqrt{"+this.base.tex()+"}":"\\sqrt["+this.exp.d+"]{"+this.base.tex()+"}"}else if(this.base instanceof X&&!this.base.isInverse()&&this.exp instanceof z&&this.exp.isSimple()&&this.exp.eval()>=0){var e=this.base.texSplit();return e[0]+"^{"+this.exp.tex()+"}"+e[1]}else{var r=this.base.tex();return this.base instanceof Je||this.base instanceof Q||this.base instanceof z&&!this.base.isSimple()?r="("+r+")":(this.base instanceof X||this.base instanceof ue)&&(r="["+r+"]"),r+"^{"+this.exp.tex()+"}"}}needsExplicitMul(){return this.isRoot()?!1:this.base.needsExplicitMul()}expand(){var e=this.recurse("expand");if(e.base instanceof N){var r=x.map(e.base.terms,p=>new Q(p,e.exp));return new N(r).expand()}else if(e.base instanceof se&&e.exp instanceof b&&e.exp.abs().eval()>1){var s=e.exp.eval()>0,o=e.exp.abs().eval(),l=function(m){return s?m:new Q(m,Fe)};const p={1:e.base};for(var f=2;f<=o;f*=2){const m=new N(p[f/2],p[f/2]);p[f]=m.expand().collect()}if(o in p)return l(p[o]);let v=x.map(o.toString(2).split(""),function(m,y,M){return Number(m)*Math.pow(2,M.length-y-1)});v=x.without(v,0);const h=[];for(const m of v)m in p&&h.push(p[m]);const d=new N(h).expand().collect();return l(d)}else if(e.exp instanceof se){const p=x.map(e.exp.terms,v=>new Q(e.base,v).expand());return new N(p).expand()}else return e}factor(){var e=this.recurse("factor");if(e.base instanceof N){var r=x.map(e.base.terms,s=>s instanceof b&&e.exp.equals(Fe)?new W(1,s.n):new Q(s,e.exp));return new N(r)}else return e}collect(e){if(this.base instanceof Q){const o=this.base.base,l=N.createOrAppend(this.base.exp,this.exp);return new Q(o,l).collect(e)}const r=this.recurse("collect",e),s=function(o){return o instanceof ue&&o.base.equals(r.base)};if(r.exp instanceof z&&r.exp.eval()===0)return re;if(r.exp instanceof z&&r.exp.eval()===1)return r.base;if(s(r.exp))return r.exp.power;if(r.exp instanceof N&&x.any(r.exp.terms,s)){const o=r.exp.terms.find(s),l=o.power,f=r.exp.remove(o).flatten();return new Q(l,f).collect(e)}else if(r.base instanceof z&&r.exp instanceof z){if(e&&e.preciseFloats){const o=r.exp.asRational(),l=r.base.getDecimalPlaces();if(new Q(r.base,new W(1,o.d)).collect().getDecimalPlaces()>l){const v=new Q(r.base,new b(o.n)).collect();return new Q(v,new W(1,o.d))}}return r.base.raiseToThe(r.exp,e)}else return r}isDivide(){var e=function(r){return r instanceof z&&!!r.hints.divide};return e(this.exp)||this.exp instanceof N&&x.any(this.exp.terms,e)}asDivide(){if(this.exp instanceof z){if(this.exp.eval()===-1)return this.base;var e=this.exp.negate();return e.hints=x.clone(this.exp.hints),e.hints.divide=!1,new Q(this.base,e)}else{if(this.exp instanceof N)return new Q(this.base,this.exp.factorOut());throw new Error("called asDivide() on an Expr that wasn't a Num or Mul")}}isRoot(){return this.exp instanceof W&&!!this.exp.hints.root}isSquaredTrig(){return this.base instanceof X&&!this.base.isInverse()&&this.exp instanceof z&&this.exp.eval()===2}getDenominator(){if(this.exp instanceof z&&this.exp.eval()===-1)return N.createOrAppend(this.base,this.base.getDenominator()).flatten();if(this.exp.isNegative()){var e=new Q(this.base,N.handleNegative(this.exp).collect());return N.createOrAppend(e,e.collect().getDenominator()).flatten()}else return this.base instanceof z?new Q(this.base.getDenominator(),this.exp).collect():re}findGCD(e){const[r,s]=e instanceof Q?[e.base,e.exp]:[e,re];if(this.base.equals(r)){if(this.exp.equals(s))return this;if(this.exp instanceof z&&s instanceof z)return new Q(this.base,z.min(this.exp,s)).collect();if(this.exp instanceof z||s instanceof z)return re;var o=this.exp.asMul().partition(),l=s.asMul().partition();if(o[1].equals(l[1])){var f=z.min(o[0].reduce(),l[0].reduce()),p=new N(f,o[1].flatten()).flatten();return new Q(r,p).collect()}}return re}isPositive(){if(this.base.isPositive())return!0;var e=this.exp.simplify();return e instanceof b&&e.eval()%2===0}asPositiveFactor(){if(this.isPositive())return this;var e=this.exp.simplify();if(e instanceof b){var r=e.eval();if(r>2)return new Q(this.base,new b(r-1));if(r<-2)return new Q(this.base,new b(r+1))}return re}static sqrt(e){return new Q(e,Sn)}};Q.nthroot=function(e,r){var s=N.fold(N.handleDivide(new b(1),r));return new Q(e,s.addHint("root"))};let U=Q;class ue extends Re{constructor(e,r){super(),this.func=ue,this.base=e,this.power=r,this.hints={...this.hints,open:!1}}args(){return[this.base,this.power]}eval(e={},r){return Math.log(this.power.eval(e,r))/Math.log(this.base.eval(e,r))}codegen(){return"(Math.log("+this.power.codegen()+") / Math.log("+this.base.codegen()+"))"}print(){var e="("+this.power.print()+")";return this.isNatural()?"ln"+e:"log_("+this.base.print()+") "+e}tex(){var e="("+this.power.tex()+")";return this.isNatural()?"\\ln"+e:"\\log_{"+this.base.tex()+"}"+e}collect(e){var r=this.recurse("collect",e);return r.power instanceof z&&r.power.eval()===1?He:r.base.equals(r.power)?re:r.power instanceof U&&r.power.base.equals(r.base)?r.power.exp:r}expand(){var e=this.recurse("expand");if(e.power instanceof N){var r=x.map(e.power.terms,s=>new ue(e.base,s).expand());return new se(r)}else return e.power instanceof U?new N(e.power.exp,new ue(e.base,e.power.base).expand()).flatten():e.isNatural()?e:N.handleDivide(new ue(De.e,e.power),new ue(De.e,e.base))}isPositive(){var e=this.collect();return e instanceof ue&&e.base instanceof z&&e.power instanceof z?this.eval()>0:!1}needsExplicitMul(){return!1}isNatural(){return this.base.equals(De.e)}static natural(){return De.e}static common(){return kn}static create(e,r){var s=new ue(e,r);return r.hints.parens||(s=s.addHint("open")),s}}class X extends Re{constructor(e,r){super(),this.func=X,this.functions={sin:{eval:Math.sin,codegen:"Math.sin((",tex:"\\sin",expand:()=>this},cos:{eval:Math.cos,codegen:"Math.cos((",tex:"\\cos",expand:()=>this},tan:{eval:Math.tan,codegen:"Math.tan((",tex:"\\tan",expand:()=>N.handleDivide(X.sin(this.arg),X.cos(this.arg))},csc:{eval:s=>1/Math.sin(s),codegen:"(1/Math.sin(",tex:"\\csc",expand:()=>N.handleDivide(re,X.sin(this.arg))},sec:{eval:s=>1/Math.cos(s),codegen:"(1/Math.cos(",tex:"\\sec",expand:()=>N.handleDivide(re,X.cos(this.arg))},cot:{eval:s=>1/Math.tan(s),codegen:"(1/Math.tan(",tex:"\\cot",expand:()=>N.handleDivide(X.cos(this.arg),X.sin(this.arg))},arcsin:{eval:Math.asin,codegen:"Math.asin((",tex:"\\arcsin"},arccos:{eval:Math.acos,codegen:"Math.acos((",tex:"\\arccos"},arctan:{eval:Math.atan,codegen:"Math.atan((",tex:"\\arctan"},arccsc:{eval:s=>Math.asin(1/s),codegen:"Math.asin(1/(",tex:"\\operatorname{arccsc}"},arcsec:{eval:s=>Math.acos(1/s),codegen:"Math.acos(1/(",tex:"\\operatorname{arcsec}"},arccot:{eval:s=>Math.atan(1/s),codegen:"Math.atan(1/(",tex:"\\operatorname{arccot}"},sinh:{eval:s=>(Math.exp(s)-Math.exp(-s))/2,codegen:s=>"((Math.exp("+s+") - Math.exp(-("+s+"))) / 2)",tex:"\\sinh",expand:()=>this},cosh:{eval:s=>(Math.exp(s)+Math.exp(-s))/2,codegen:s=>"((Math.exp("+s+") + Math.exp(-("+s+"))) / 2)",tex:"\\cosh",expand:()=>this},tanh:{eval:s=>(Math.exp(s)-Math.exp(-s))/(Math.exp(s)+Math.exp(-s)),codegen:s=>"((Math.exp("+s+") - Math.exp(-("+s+"))) / (Math.exp("+s+") + Math.exp(-("+s+"))))",tex:"\\tanh",expand:()=>N.handleDivide(X.sinh(this.arg),X.cosh(this.arg))},csch:{eval:s=>2/(Math.exp(s)-Math.exp(-s)),codegen:s=>"(2 / (Math.exp("+s+") - Math.exp(-("+s+"))))",tex:"\\csch",expand:()=>N.handleDivide(re,X.sinh(this.arg))},sech:{eval:s=>2/(Math.exp(s)+Math.exp(-s)),codegen:s=>"(2 / (Math.exp("+s+") + Math.exp(-("+s+"))))",tex:"\\sech",expand:()=>N.handleDivide(re,X.cosh(this.arg))},coth:{eval:s=>(Math.exp(s)+Math.exp(-s))/(Math.exp(s)-Math.exp(-s)),codegen:s=>"((Math.exp("+s+") + Math.exp(-("+s+"))) / (Math.exp("+s+") - Math.exp(-("+s+"))))",tex:"\\coth",expand:()=>N.handleDivide(X.cosh(this.arg),X.sinh(this.arg))}},this.type=e,this.arg=r,this.hints={...this.hints,open:!1}}args(){return[this.type,this.arg]}isEven(){return x.contains(["cos","sec"],this.type)}isInverse(){return this.type.indexOf("arc")===0}isBasic(){return x.contains(["sin","cos"],this.type)}eval(e={},r){var s=this.functions[this.type].eval,o=this.arg.eval(e,r);return s(o)}codegen(){var e=this.functions[this.type].codegen;if(typeof e=="function")return e(this.arg.codegen());if(typeof e=="string")return e+this.arg.codegen()+"))";throw new Error("codegen not implemented for "+this.type)}print(){return this.type+"("+this.arg.print()+")"}tex(){var e=this.functions[this.type].tex,r="("+this.arg.tex()+")";return e+r}texSplit(){var e=this.functions[this.type].tex,r="("+this.arg.tex()+")";return[e,r]}isPositive(){var e=this.collect();return e instanceof X&&e.arg instanceof z?this.eval()>0:!1}completeParse(){if(this.exp){var e=new U(this,this.exp);return this.exp=void 0,e}else return this}needsExplicitMul(){return!1}expand(){var e=this.recurse("expand");if(e.isInverse())return e;var r=e.functions[e.type].expand;return x.bind(r,e)()}collect(e){var r=this.recurse("collect",e);if(!r.isInverse()&&r.arg.isNegative()){const s=r.arg instanceof z?r.arg.abs():N.handleDivide(r.arg,ke).collect(e);return r.isEven()?new X(r.type,s):new N(ke,new X(r.type,s))}else return r}static create(e,r){var s=e[0],o=e[1];o&&o.equals(ke)&&(s="arc"+s,o=void 0);var l=new X(s,r);return r.hints.parens||(l=l.addHint("open")),o&&(l.exp=o),l}static sin(e){return new X("sin",e)}static cos(e){return new X("cos",e)}static sinh(e){return new X("sinh",e)}static cosh(e){return new X("cosh",e)}}class $e extends Re{constructor(e){super(),this.func=$e,this.arg=e}args(){return[this.arg]}eval(e={},r){return Math.abs(this.arg.eval(e,r))}codegen(){return"Math.abs("+this.arg.codegen()+")"}print(){return"abs("+this.arg.print()+")"}tex(){return"\\left|"+this.arg.tex()+"\\right|"}collect(e){var r=this.recurse("collect",e);if(r.arg.isPositive())return r.arg;if(r.arg instanceof z)return r.arg.abs();if(r.arg instanceof N){var s=x.groupBy(r.arg.terms,l=>l.isPositive()?"positive":l instanceof z?"number":"other"),o=s.positive.concat(x.invoke(s.number,"abs"));return s.other.length&&o.push(new $e(new N(s.other).flatten())),new N(o).flatten()}else return r}expand(){var e=this.recurse("expand");if(e.arg instanceof N){var r=x.map(e.arg.terms,s=>new $e(s));return new N(r)}else return e}isPositive(){return!0}}class Ue extends Re{constructor(e,r,s){super(),this.func=Ue,this.signs={"=":" = ","<":" < ",">":" > ","<>":" \\ne ","<=":" \\le ",">=":" \\ge "},this.left=e,this.type=r,this.right=s}args(){return[this.left,this.type,this.right]}needsExplicitMul(){return!1}print(){return this.left.print()+this.type+this.right.print()}tex(){return this.left.tex()+this.signs[this.type]+this.right.tex()}normalize(){var e=this.recurse("normalize");return x.contains([">",">="],e.type)?new Ue(e.right,e.type.replace(">","<"),e.left):e}asExpr(e=!1){var r=v=>v instanceof z&&v.isSimple()&&v.eval()===0;let s=[];this.left instanceof se?s=x.clone(this.left.terms):r(this.left)||(s=[this.left]),this.right instanceof se?s=s.concat(this.right.negate().terms):r(this.right)||s.push(this.right.negate());var o=!this.isEquality();s=x.invoke(s,"collect",{preciseFloats:!0});for(var l=0;l<s.length;l++){var f=s[l].getDenominator();o&&!f.isPositive()&&(f=f.asPositiveFactor()),f.equals(re)||(s=x.map(s,v=>N.createOrAppend(v,f).simplify({once:!0,preciseFloats:!0})))}var p=new se(s).flatten();return e?p:this.divideThrough(p)}divideThrough(e){const r=!this.isEquality(),s=e.simplify({once:!0}),o=s.factor({keepNegative:r});if(!(o instanceof N))return e;const l=o.terms,f=y=>!!y.getVars().length,p=y=>y.equals(re),[v,h]=ze(l,Ye);if(v.length&&this.isEquality())return new N(v).flatten();let d=h;v.length||(d=x.reject(d,f)),r&&(d=x.invoke(d,"asPositiveFactor")),d=x.reject(d,p),d=x.map(d,y=>new U(y,Fe));const m=new N(l.concat(d)).collect();return m.equals(o)?s:m}isEquality(){return x.contains(["=","<>"],this.type)}compare(e){if(!(e instanceof Ue))return!1;var r=this.normalize(),s=e.normalize();if(r.type!==s.type)return!1;var o=r.divideThrough(r.asExpr(!0).collect()),l=s.divideThrough(s.asExpr(!0).collect());return r.isEquality()?o.compare(l)||o.compare(N.handleNegative(l)):o.compare(l)}sameForm(e){var r=this.normalize(),s=e.normalize(),o=r.left.sameForm(s.left)&&r.right.sameForm(s.right);return r.isEquality()?o||r.left.sameForm(s.right)&&r.right.sameForm(s.left):o}isSimplified(){var e=this.asExpr(!0),r=this.divideThrough(e).simplify();return e.equals(r)&&this.left.isSimplified()&&this.right.isSimplified()}solveLinearEquationForVariable(e){var r=this.asExpr();if(!(r instanceof se)||r.terms.length!==2)throw new Error("Can only handle linear equations of the form a + bx (= 0)");var s=p=>p.has(je)&&x.contains(p.getVars(),e.symbol);const o=s(r.terms[0]),l=o?N.handleNegative(r.terms[1]):N.handleNegative(r.terms[0]),f=o?N.handleDivide(r.terms[0],e):N.handleDivide(r.terms[1],e);return N.handleDivide(l,f).simplify()}}class qe extends Re{needsExplicitMul(){return!1}findGCD(e){return e instanceof qe||e instanceof z?this.equals(e)?this:re:e.findGCD(this)}}class Te extends qe{constructor(e,r){super(),this.func=Te,this.symbol=e,this.arg=r}args(){return[this.symbol,this.arg]}print(){return this.symbol+"("+this.arg.print()+")"}tex(){return this.symbol+"("+this.arg.tex()+")"}eval(e={},r){var s=this.arg,o=e[this.symbol],l=x.extend(x.clone(e),{x:s.eval(e,r)}),f=Be(o,r);return f.parsed?f.expr.eval(l,r):f}codegen(){return'vars["'+this.symbol+'"]('+this.arg.codegen()+")"}getUnits(){return this.arg.getUnits()}getVars(e){return e?this.arg.getVars():x.union(this.arg.getVars(),[this.symbol]).sort()}getConsts(){return this.arg.getConsts()}}class je extends qe{constructor(e,r){super(),this.func=je,this.symbol=e,this.subscript=r}args(){return[this.symbol,this.subscript]}exprArgs(){return[]}recurse(){return this}print(){var e="";return this.subscript&&(e="_("+this.subscript.print()+")"),this.symbol+e}prettyPrint(){var e=this.subscript;return e&&(e instanceof z||e instanceof qe)?this.symbol+"_"+e.print():this.print()}tex(){var e="";this.subscript&&(e="_{"+this.subscript.tex()+"}");var r=this.symbol.length>1?"\\":"";return r+this.symbol+e}repr(){return"Var("+this.print()+")"}eval(e={},r){return e[this.prettyPrint()]}codegen(){return'vars["'+this.prettyPrint()+'"]'}getVars(){return[this.prettyPrint()]}isPositive(){return!1}}const Ce=class Ce extends qe{constructor(e){super(),this.func=Ce,this.symbol=e}args(){return[this.symbol]}recurse(){return this}eval(e={},r){return this.symbol==="pi"?Math.PI:this.symbol==="e"?Math.E:void 0}codegen(){return this.symbol==="pi"?"Math.PI":this.symbol==="e"?"Math.E":void 0}print(){return this.symbol}tex(){return this.symbol==="pi"?"\\pi ":this.symbol==="e"?"e":void 0}isPositive(){return this.eval()>0}abs(){return this.eval()>0?this:N.handleNegative(this)}getConsts(){return[this.print()]}};Ce.e=new Ce("e"),Ce.pi=new Ce("pi");let De=Ce;class z extends Re{constructor(){super(),this.n=0,this.hints={...this.hints,negate:!1,subtract:!1,divide:!1,root:!1,fraction:!1,entered:!1}}repr(){return this.print()}strip(){return this.abs()}recurse(){return this}codegen(){return this.print()}isSubtract(){return!!this.hints.subtract}needsExplicitMul(){return!0}isPositive(){return this.eval()>0}isNegative(){return this.eval()<0}asPositiveFactor(){return this.isPositive()?this:this.abs()}getDecimalPlaces(){var e=(""+this.n).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0}static negativeOne(e){return e==="subtract"?In:e==="divide"?Fe:ke}static findGCD(e,r){var s;if(e=Math.abs(e),r=Math.abs(r),e!==Math.floor(e)||r!==Math.floor(r))return 1;for(;r;)s=e%r,e=r,r=s;return e}static min(...e){return x.min(e,r=>r.eval())}static max(...e){return x.max(e,r=>r.eval())}}class W extends z{constructor(e,r){super(),this.func=W;var s=e,o=r;o<0&&(s=-s,o=-o),this.n=s,this.d=o}args(){return[this.n,this.d]}eval(){return this.n/this.d}print(){return this.n.toString()+"/"+this.d.toString()}tex(){var e="\\frac{"+Math.abs(this.n).toString()+"}{"+this.d.toString()+"}";return this.n<0?"-"+e:e}add(e,r){return e instanceof W?new W(this.n*e.d+this.d*e.n,this.d*e.d).collect():e.add(this,r)}mul(e,r){return e instanceof W?new W(this.n*e.n,this.d*e.d).collect():e.mul(this,r)}collect(){var e=z.findGCD(this.n,this.d),r=this.n/e,s=this.d/e;return s===1?new b(r):new W(r,s)}negate(){return new W(-this.n,this.d)}abs(){return new W(Math.abs(this.n),this.d)}findGCD(e){if(e instanceof W){var r=z.findGCD(this.n*e.d,e.n*this.d),s=this.d*e.d;return new W(r,s).collect()}else return e instanceof b?new W(z.findGCD(this.n,e.n),this.d):e.findGCD(this)}raiseToThe(e){if(e instanceof b){var r=e.eval()>0,s=e.abs().eval(),o=Math.pow(this.n,s),l=Math.pow(this.d,s);return r?new W(o,l).collect():new W(l,o).collect()}else return new le(this.eval()).raiseToThe(e)}getDenominator(){return new b(this.d)}isSimple(){return!1}asRational(){return this}}class b extends W{constructor(e){super(e,1),this.func=b}args(){return[this.n]}print(){return this.n.toString()}tex(){return this.n.toString()}negate(){return new b(-this.n)}abs(){return new b(Math.abs(this.n))}isSimple(){return!0}findGCD(e){return e instanceof b?new b(z.findGCD(this.n,e.n)):e.findGCD(this)}static create(e){return new b(e).addHint("entered")}}class le extends z{constructor(e){super(),this.func=le,this.n=e}args(){return[this.n]}eval(){return this.n}print(){return this.n.toString()}tex(){return this.n.toString()}add(e,r){return r&&r.preciseFloats?le.toDecimalPlaces(this.n+e.eval(),Math.max(this.getDecimalPlaces(),e.getDecimalPlaces())):new le(this.n+e.eval()).collect()}mul(e,r){return r&&r.preciseFloats?le.toDecimalPlaces(this.n*e.eval(),this.getDecimalPlaces()+e.getDecimalPlaces()):new le(this.n*e.eval()).collect()}collect(e){return this}negate(){return new le(-this.n)}abs(){return new le(Math.abs(this.n))}findGCD(e){return e instanceof z?new le(z.findGCD(this.eval(),e.eval())).collect():e.findGCD(this)}raiseToThe(e,r){return r&&r.preciseFloats&&e instanceof b&&e.n>1?le.toDecimalPlaces(new U(this,e).eval(),this.getDecimalPlaces()*e.n):new le(new U(this,e).eval()).collect()}asRational(){var e=this.n.toString().split(".");if(e.length===1)return new W(this.n,1);var r=Number(e.join("")),s=Math.pow(10,e[1].length);return new W(r,s).collect()}getDenominator(){return this.asRational().getDenominator()}isSimple(){return!0}static create(e){return new le(e).addHint("entered")}static toDecimalPlaces(e,r){return new le(+e.toFixed(Math.min(r,20))).collect()}}const ke=new b(-1).addHint("negate"),In=new b(-1).addHint("subtract"),Fe=new b(-1).addHint("divide"),Sn=new W(1,2).addHint("root"),He=new b(0),re=new b(1),kn=new b(10);var _n=function(n,e){throw new Error(e.loc.first_column)};Ge.yy={Add:se,Mul:N,Pow:U,Log:ue,Trig:X,Eq:Ue,Abs:$e,Func:Te,Const:De,Var:je,Int:b,Float:le,parseError:_n,constants:["e"],symbolLexer:function(n){return x.contains(Ge.yy.constants,n)?"CONST":x.contains(Ge.yy.functions,n)?"FUNC":"VAR"}};const Be=function(n,e){try{e&&e.functions?Ge.yy.functions=x.without(e.functions,"i"):Ge.yy.functions=[],e&&e.decimal_separator&&(n=n.split(e.decimal_separator).join("."));var r=Ge.parse(n).completeParse();return{parsed:!0,expr:r}}catch(s){return{parsed:!1,error:s.message}}};class he extends qe{constructor(e){super(),this.func=he,this.symbol=e}args(){return[this.symbol]}recurse(){return this}eval(e={},r){return 1}getUnits(){return[{unit:this.symbol,pow:1}]}codegen(){return"1"}print(){return this.symbol}tex(){return this.symbol}collect(e){if(x(Tn).has(this.symbol))return this;if(x(kt).has(this.symbol))return kt[this.symbol].conversion;throw new Error("could not understand unit: "+this.symbol)}}var Tn={m:new he("m"),g:new he("g"),s:new he("s"),A:new he("A"),K:new he("K"),mol:new he("mol"),cd:new he("cd")};new U(new b(10),new b(-18)),new U(new b(10),new b(-15)),new U(new b(10),new b(-12)),new U(new b(10),new b(-9)),new U(new b(10),new b(-6)),new U(new b(10),new b(-3)),new U(new b(10),new b(-2)),new U(new b(10),new b(-1)),new b(10),new U(new b(10),new b(2)),new U(new b(10),new b(3)),new U(new b(10),new b(6)),new U(new b(10),new b(9)),new U(new b(10),new b(12)),new U(new b(10),new b(15)),new U(new b(10),new b(18)),new U(new b(10),new b(27));const ne="hasPrefixes",A="hasntPrefixes",O=function(n,e){var r=n.split("|"),s=r[0].trim(),o=r[1].trim(),l=re;s!==""&&(l=Be(s).expr);var f=o.split("/"),p=[l];return f[0]&&f[0].split(" ").filter(v=>v!=="").forEach(v=>p.push(new he(v))),f[1]&&f[1].split(" ").filter(v=>v!=="").forEach(v=>p.push(new U(new he(v),Fe))),{conversion:new N(p),prefixes:e}};var kt={Da:O("1.6605388628 x 10^-24 | g",ne),u:O("| Da",A),meter:O("| m",A),meters:O("| m",A),in:O("254 / 10000 | m",A),ft:O("3048  / 10000 | m",A),yd:O("9144  / 10000 | m",A),mi:O("1609344 / 1000 | m",A),ly:O("9.4607 x 10^15 | m",A),nmi:O("1852 | m",A),Å:O("10^-10 | m",A),pc:O("3.0857 x 10^16 | m",A),min:O("60 | s",A),hr:O("3600 | s",A),sec:O("| s",A),day:O("86400 | s",A),wk:O("604800 | s",A),fortnight:O("14 | day",A),shake:O("10^-8 | s",A),olympiad:O("126200000 | s",A),"°C":O("1 | K",A),"°F":O("5/9 | K",A),"°R":O("5/9 | K",A),e:O("1.6021765314 x 10^-19 | C",A),c:O("299792458 | m / s",A),kn:O("514/1000 | m / s",A),kt:O("| kn",A),knot:O("| kn",A),J:O("| N m",ne),BTU:O("1060 | J",A),cal:O("4184 / 1000 | J",ne),eV:O("1.602176514 x 10^-19 | J",ne),erg:O("10^−7 | J",ne),W:O("| J / s",ne),"H-e":O("80 | W",A),N:O("1000 | g m / s s",ne),lb:O("4448221615 / 1000000000 | N",A),dyn:O("10^-5 | N",A),Pa:O("1 | N / m m m",ne),bar:O("10^5 | Pa",ne),"㏔":O("1/1000 | bar",A),"㍴":O("| bar",A),atm:O("101325 | Pa",A),Torr:O("1/760 | atm",A),mmHg:O("| Torr",A),ha:O("10^4 | m m",A),b:O("10^−28 | m m",ne),barn:O("| b",ne),acre:O("4046.87 | m m",A),skilodge:O("10^-31 | m m",A),outhouse:O("10^-34 | m m",A),shed:O("10^-52 | m m",A),L:O("1/1000 | m m m",ne),gal:O("3785/1000 | L",ne),cup:O("1/16 | gal",A),qt:O("1/4 | gal",A),quart:O("| qt",A),p:O("1/8 | gal",A),pt:O("| p",A),pint:O("| p",A),"fl oz":O("1/8 | cup",A),"fl. oz.":O("1/8 | cup",A),tbsp:O("1/16 | cup",A),tsp:O("1/3 | tbsp",A),rev:O("2 pi | rad",A),deg:O("180 pi | rad",A),"°":O("| deg",A),arcminute:O("1/60 | deg",A),arcsec:O("1/3600 | deg",A),Hu:O("1000 | dB",ne),dozen:O("12 |",A),mol:O("6.0221412927 x 10^23 |",ne),"%":O("1/100 |",A),percent:O("| %",A),ppm:O("1/1000000 |",A),V:O("1000 | g m m / s s C",ne),C:O("| A s",ne),ampere:O("| A",A),Ω:O("| V / A",ne),ohm:O("| Ω",A),F:O("| C / V",ne),H:O("| ohm s",ne),T:O("1000 | g / C s",ne),Wb:O("1000 | g m m / C s",ne),lm:O("pi x 10^4 | cd / m m",A),lx:O("| lm / m m",A),nit:O("| cd / m m",A),sb:O("10^4 | cd / m m",A),stilb:O("1 | sb",A),apostilb:O("1 / pi x 10^(-4) | sb",A),blondel:O("| apostilb",A),asb:O("| apostilb",A),la:O("| lm",A),Lb:O("| lm",A),sk:O("10^-7 | lm",A),skot:O("| sk",A),bril:O("10^-11 | lm",A),Hz:O("| / s",ne)};const _t=function(n,e,r={}){const o={...{form:!1,simplify:!1},...r},l=n.sameVars(e);if(!l.equal){let f;return l.equalIgnoringCase?f="Check your variables; one or more are using the wrong case (upper or lower).":f="Check your variables; you may have used the wrong letter for one or more of them.",{equal:!1,wrongVariableCase:l.equalIgnoringCase,wrongVariableNames:!l.equalIgnoringCase,message:f}}return n.compare(e)?o.form&&!n.sameForm(e)?{equal:!1,message:"Your answer is not in the correct form."}:o.simplify&&!n.isSimplified()?{equal:!1,message:"Your answer is not fully expanded and simplified."}:{equal:!0,message:null}:{equal:!1,message:null}},An="@khanacademy/kmath",Pn="__lib_version__";zt(An,Pn);var lt={exports:{}};(function(n,e){(function(){var r=this,s=r._,o={},l=Array.prototype,f=Object.prototype,p=Function.prototype,v=l.push,h=l.slice,d=l.concat,m=f.toString,y=f.hasOwnProperty,M=l.forEach,R=l.map,I=l.reduce,k=l.reduceRight,C=l.filter,$=l.every,J=l.some,ae=l.indexOf,ye=l.lastIndexOf,Z=Array.isArray,te=Object.keys,ce=p.bind,a=function(t){if(t instanceof a)return t;if(!(this instanceof a))return new a(t);this._wrapped=t};n.exports&&(e=n.exports=a),e._=a,a.VERSION="1.4.4";var G=a.each=a.forEach=function(t,i,c){if(t!=null){if(M&&t.forEach===M)t.forEach(i,c);else if(t.length===+t.length){for(var u=0,g=t.length;u<g;u++)if(i.call(c,t[u],u,t)===o)return}else for(var E in t)if(a.has(t,E)&&i.call(c,t[E],E,t)===o)return}};a.map=a.collect=function(t,i,c){var u=[];return t==null?u:R&&t.map===R?t.map(i,c):(G(t,function(g,E,w){u[u.length]=i.call(c,g,E,w)}),u)};var Me="Reduce of empty array with no initial value";a.reduce=a.foldl=a.inject=function(t,i,c,u){var g=arguments.length>2;if(t==null&&(t=[]),I&&t.reduce===I)return u&&(i=a.bind(i,u)),g?t.reduce(i,c):t.reduce(i);if(G(t,function(E,w,T){g?c=i.call(u,c,E,w,T):(c=E,g=!0)}),!g)throw new TypeError(Me);return c},a.reduceRight=a.foldr=function(t,i,c,u){var g=arguments.length>2;if(t==null&&(t=[]),k&&t.reduceRight===k)return u&&(i=a.bind(i,u)),g?t.reduceRight(i,c):t.reduceRight(i);var E=t.length;if(E!==+E){var w=a.keys(t);E=w.length}if(G(t,function(T,F,H){F=w?w[--E]:--E,g?c=i.call(u,c,t[F],F,H):(c=t[F],g=!0)}),!g)throw new TypeError(Me);return c},a.find=a.detect=function(t,i,c){var u;return j(t,function(g,E,w){if(i.call(c,g,E,w))return u=g,!0}),u},a.filter=a.select=function(t,i,c){var u=[];return t==null?u:C&&t.filter===C?t.filter(i,c):(G(t,function(g,E,w){i.call(c,g,E,w)&&(u[u.length]=g)}),u)},a.reject=function(t,i,c){return a.filter(t,function(u,g,E){return!i.call(c,u,g,E)},c)},a.every=a.all=function(t,i,c){i||(i=a.identity);var u=!0;return t==null?u:$&&t.every===$?t.every(i,c):(G(t,function(g,E,w){if(!(u=u&&i.call(c,g,E,w)))return o}),!!u)};var j=a.some=a.any=function(t,i,c){i||(i=a.identity);var u=!1;return t==null?u:J&&t.some===J?t.some(i,c):(G(t,function(g,E,w){if(u||(u=i.call(c,g,E,w)))return o}),!!u)};a.contains=a.include=function(t,i){return t==null?!1:ae&&t.indexOf===ae?t.indexOf(i)!=-1:j(t,function(c){return c===i})},a.invoke=function(t,i){var c=h.call(arguments,2),u=a.isFunction(i);return a.map(t,function(g){return(u?i:g[i]).apply(g,c)})},a.pluck=function(t,i){return a.map(t,function(c){return c[i]})},a.where=function(t,i,c){return a.isEmpty(i)?c?null:[]:a[c?"find":"filter"](t,function(u){for(var g in i)if(i[g]!==u[g])return!1;return!0})},a.findWhere=function(t,i){return a.where(t,i,!0)},a.max=function(t,i,c){if(!i&&a.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!i&&a.isEmpty(t))return-1/0;var u={computed:-1/0,value:-1/0};return G(t,function(g,E,w){var T=i?i.call(c,g,E,w):g;T>=u.computed&&(u={value:g,computed:T})}),u.value},a.min=function(t,i,c){if(!i&&a.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!i&&a.isEmpty(t))return 1/0;var u={computed:1/0,value:1/0};return G(t,function(g,E,w){var T=i?i.call(c,g,E,w):g;T<u.computed&&(u={value:g,computed:T})}),u.value},a.shuffle=function(t){var i,c=0,u=[];return G(t,function(g){i=a.random(c++),u[c-1]=u[i],u[i]=g}),u};var ee=function(t){return a.isFunction(t)?t:function(i){return i[t]}};a.sortBy=function(t,i,c){var u=ee(i);return a.pluck(a.map(t,function(g,E,w){return{value:g,index:E,criteria:u.call(c,g,E,w)}}).sort(function(g,E){var w=g.criteria,T=E.criteria;if(w!==T){if(w>T||w===void 0)return 1;if(w<T||T===void 0)return-1}return g.index<E.index?-1:1}),"value")};var _=function(t,i,c,u){var g={},E=ee(i||a.identity);return G(t,function(w,T){var F=E.call(c,w,T,t);u(g,F,w)}),g};a.groupBy=function(t,i,c){return _(t,i,c,function(u,g,E){(a.has(u,g)?u[g]:u[g]=[]).push(E)})},a.countBy=function(t,i,c){return _(t,i,c,function(u,g){a.has(u,g)||(u[g]=0),u[g]++})},a.sortedIndex=function(t,i,c,u){c=c==null?a.identity:ee(c);for(var g=c.call(u,i),E=0,w=t.length;E<w;){var T=E+w>>>1;c.call(u,t[T])<g?E=T+1:w=T}return E},a.toArray=function(t){return t?a.isArray(t)?h.call(t):t.length===+t.length?a.map(t,a.identity):a.values(t):[]},a.size=function(t){return t==null?0:t.length===+t.length?t.length:a.keys(t).length},a.first=a.head=a.take=function(t,i,c){if(t!=null)return i!=null&&!c?h.call(t,0,i):t[0]},a.initial=function(t,i,c){return h.call(t,0,t.length-(i==null||c?1:i))},a.last=function(t,i,c){if(t!=null)return i!=null&&!c?h.call(t,Math.max(t.length-i,0)):t[t.length-1]},a.rest=a.tail=a.drop=function(t,i,c){return h.call(t,i==null||c?1:i)},a.compact=function(t){return a.filter(t,a.identity)};var V=function(t,i,c){return G(t,function(u){a.isArray(u)?i?v.apply(c,u):V(u,i,c):c.push(u)}),c};a.flatten=function(t,i){return V(t,i,[])},a.without=function(t){return a.difference(t,h.call(arguments,1))},a.uniq=a.unique=function(t,i,c,u){a.isFunction(i)&&(u=c,c=i,i=!1);var g=c?a.map(t,c,u):t,E=[],w=[];return G(g,function(T,F){(i?!F||w[w.length-1]!==T:!a.contains(w,T))&&(w.push(T),E.push(t[F]))}),E},a.union=function(){return a.uniq(d.apply(l,arguments))},a.intersection=function(t){var i=h.call(arguments,1);return a.filter(a.uniq(t),function(c){return a.every(i,function(u){return a.indexOf(u,c)>=0})})},a.difference=function(t){var i=d.apply(l,h.call(arguments,1));return a.filter(t,function(c){return!a.contains(i,c)})},a.zip=function(){for(var t=h.call(arguments),i=a.max(a.pluck(t,"length")),c=new Array(i),u=0;u<i;u++)c[u]=a.pluck(t,""+u);return c},a.object=function(t,i){if(t==null)return{};for(var c={},u=0,g=t.length;u<g;u++)i?c[t[u]]=i[u]:c[t[u][0]]=t[u][1];return c},a.indexOf=function(t,i,c){if(t==null)return-1;var u=0,g=t.length;if(c)if(typeof c=="number")u=c<0?Math.max(0,g+c):c;else return u=a.sortedIndex(t,i),t[u]===i?u:-1;if(ae&&t.indexOf===ae)return t.indexOf(i,c);for(;u<g;u++)if(t[u]===i)return u;return-1},a.lastIndexOf=function(t,i,c){if(t==null)return-1;var u=c!=null;if(ye&&t.lastIndexOf===ye)return u?t.lastIndexOf(i,c):t.lastIndexOf(i);for(var g=u?c:t.length;g--;)if(t[g]===i)return g;return-1},a.range=function(t,i,c){arguments.length<=1&&(i=t||0,t=0),c=arguments[2]||1;for(var u=Math.max(Math.ceil((i-t)/c),0),g=0,E=new Array(u);g<u;)E[g++]=t,t+=c;return E},a.bind=function(t,i){if(t.bind===ce&&ce)return ce.apply(t,h.call(arguments,1));var c=h.call(arguments,2);return function(){return t.apply(i,c.concat(h.call(arguments)))}},a.partial=function(t){var i=h.call(arguments,1);return function(){return t.apply(this,i.concat(h.call(arguments)))}},a.bindAll=function(t){var i=h.call(arguments,1);return i.length===0&&(i=a.functions(t)),G(i,function(c){t[c]=a.bind(t[c],t)}),t},a.memoize=function(t,i){var c={};return i||(i=a.identity),function(){var u=i.apply(this,arguments);return a.has(c,u)?c[u]:c[u]=t.apply(this,arguments)}},a.delay=function(t,i){var c=h.call(arguments,2);return setTimeout(function(){return t.apply(null,c)},i)},a.defer=function(t){return a.delay.apply(a,[t,1].concat(h.call(arguments,1)))},a.throttle=function(t,i){var c,u,g,E,w=0,T=function(){w=new Date,g=null,E=t.apply(c,u)};return function(){var F=new Date,H=i-(F-w);return c=this,u=arguments,H<=0?(clearTimeout(g),g=null,w=F,E=t.apply(c,u)):g||(g=setTimeout(T,H)),E}},a.debounce=function(t,i,c){var u,g;return function(){var E=this,w=arguments,T=function(){u=null,c||(g=t.apply(E,w))},F=c&&!u;return clearTimeout(u),u=setTimeout(T,i),F&&(g=t.apply(E,w)),g}},a.once=function(t){var i=!1,c;return function(){return i||(i=!0,c=t.apply(this,arguments),t=null),c}},a.wrap=function(t,i){return function(){var c=[t];return v.apply(c,arguments),i.apply(this,c)}},a.compose=function(){var t=arguments;return function(){for(var i=arguments,c=t.length-1;c>=0;c--)i=[t[c].apply(this,i)];return i[0]}},a.after=function(t,i){return t<=0?i():function(){if(--t<1)return i.apply(this,arguments)}},a.keys=te||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var i=[];for(var c in t)a.has(t,c)&&(i[i.length]=c);return i},a.values=function(t){var i=[];for(var c in t)a.has(t,c)&&i.push(t[c]);return i},a.pairs=function(t){var i=[];for(var c in t)a.has(t,c)&&i.push([c,t[c]]);return i},a.invert=function(t){var i={};for(var c in t)a.has(t,c)&&(i[t[c]]=c);return i},a.functions=a.methods=function(t){var i=[];for(var c in t)a.isFunction(t[c])&&i.push(c);return i.sort()},a.extend=function(t){return G(h.call(arguments,1),function(i){if(i)for(var c in i)t[c]=i[c]}),t},a.pick=function(t){var i={},c=d.apply(l,h.call(arguments,1));return G(c,function(u){u in t&&(i[u]=t[u])}),i},a.omit=function(t){var i={},c=d.apply(l,h.call(arguments,1));for(var u in t)a.contains(c,u)||(i[u]=t[u]);return i},a.defaults=function(t){return G(h.call(arguments,1),function(i){if(i)for(var c in i)t[c]==null&&(t[c]=i[c])}),t},a.clone=function(t){return a.isObject(t)?a.isArray(t)?t.slice():a.extend({},t):t},a.tap=function(t,i){return i(t),t};var S=function(t,i,c,u){if(t===i)return t!==0||1/t==1/i;if(t==null||i==null)return t===i;t instanceof a&&(t=t._wrapped),i instanceof a&&(i=i._wrapped);var g=m.call(t);if(g!=m.call(i))return!1;switch(g){case"[object String]":return t==String(i);case"[object Number]":return t!=+t?i!=+i:t==0?1/t==1/i:t==+i;case"[object Date]":case"[object Boolean]":return+t==+i;case"[object RegExp]":return t.source==i.source&&t.global==i.global&&t.multiline==i.multiline&&t.ignoreCase==i.ignoreCase}if(typeof t!="object"||typeof i!="object")return!1;for(var E=c.length;E--;)if(c[E]==t)return u[E]==i;c.push(t),u.push(i);var w=0,T=!0;if(g=="[object Array]"){if(w=t.length,T=w==i.length,T)for(;w--&&(T=S(t[w],i[w],c,u)););}else{var F=t.constructor,H=i.constructor;if(F!==H&&!(a.isFunction(F)&&F instanceof F&&a.isFunction(H)&&H instanceof H))return!1;for(var Y in t)if(a.has(t,Y)&&(w++,!(T=a.has(i,Y)&&S(t[Y],i[Y],c,u))))break;if(T){for(Y in i)if(a.has(i,Y)&&!w--)break;T=!w}}return c.pop(),u.pop(),T};a.isEqual=function(t,i){return S(t,i,[],[])},a.isEmpty=function(t){if(t==null)return!0;if(a.isArray(t)||a.isString(t))return t.length===0;for(var i in t)if(a.has(t,i))return!1;return!0},a.isElement=function(t){return!!(t&&t.nodeType===1)},a.isArray=Z||function(t){return m.call(t)=="[object Array]"},a.isObject=function(t){return t===Object(t)},G(["Arguments","Function","String","Number","Date","RegExp"],function(t){a["is"+t]=function(i){return m.call(i)=="[object "+t+"]"}}),a.isArguments(arguments)||(a.isArguments=function(t){return!!(t&&a.has(t,"callee"))}),typeof/./!="function"&&(a.isFunction=function(t){return typeof t=="function"}),a.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},a.isNaN=function(t){return a.isNumber(t)&&t!=+t},a.isBoolean=function(t){return t===!0||t===!1||m.call(t)=="[object Boolean]"},a.isNull=function(t){return t===null},a.isUndefined=function(t){return t===void 0},a.has=function(t,i){return y.call(t,i)},a.noConflict=function(){return r._=s,this},a.identity=function(t){return t},a.times=function(t,i,c){for(var u=Array(t),g=0;g<t;g++)u[g]=i.call(c,g);return u},a.random=function(t,i){return i==null&&(i=t,t=0),t+Math.floor(Math.random()*(i-t+1))};var P={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};P.unescape=a.invert(P.escape);var L={escape:new RegExp("["+a.keys(P.escape).join("")+"]","g"),unescape:new RegExp("("+a.keys(P.unescape).join("|")+")","g")};a.each(["escape","unescape"],function(t){a[t]=function(i){return i==null?"":(""+i).replace(L[t],function(c){return P[t][c]})}}),a.result=function(t,i){if(t==null)return null;var c=t[i];return a.isFunction(c)?c.call(t):c},a.mixin=function(t){G(a.functions(t),function(i){var c=a[i]=t[i];a.prototype[i]=function(){var u=[this._wrapped];return v.apply(u,arguments),Oe.call(this,c.apply(a,u))}})};var D=0;a.uniqueId=function(t){var i=++D+"";return t?t+i:i},a.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var fe=/(.)^/,q={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},pe=/\\|'|\r|\n|\t|\u2028|\u2029/g;a.template=function(t,i,c){var u;c=a.defaults({},c,a.templateSettings);var g=new RegExp([(c.escape||fe).source,(c.interpolate||fe).source,(c.evaluate||fe).source].join("|")+"|$","g"),E=0,w="__p+='";t.replace(g,function(F,H,Y,Ne,me){return w+=t.slice(E,me).replace(pe,function(_e){return"\\"+q[_e]}),H&&(w+=`'+
((__t=(`+H+`))==null?'':_.escape(__t))+
'`),Y&&(w+=`'+
((__t=(`+Y+`))==null?'':__t)+
'`),Ne&&(w+=`';
`+Ne+`
__p+='`),E=me+F.length,F}),w+=`';
`,c.variable||(w=`with(obj||{}){
`+w+`}
`),w=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+w+`return __p;
`;try{u=new Function(c.variable||"obj","_",w)}catch(F){throw F.source=w,F}if(i)return u(i,a);var T=function(F){return u.call(this,F,a)};return T.source="function("+(c.variable||"obj")+`){
`+w+"}",T},a.chain=function(t){return a(t).chain()};var Oe=function(t){return this._chain?a(t).chain():t};a.mixin(a),G(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var i=l[t];a.prototype[t]=function(){var c=this._wrapped;return i.apply(c,arguments),(t=="shift"||t=="splice")&&c.length===0&&delete c[0],Oe.call(this,c)}}),G(["concat","join","slice"],function(t){var i=l[t];a.prototype[t]=function(){return Oe.call(this,i.apply(this._wrapped,arguments))}}),a.extend(a.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(Ut)})(lt,lt.exports);var Fn=lt.exports;const ie=Bt(Fn),Wt=1e-9,bn=Math.pow(2,-42);function Cn(n){return ie.isNumber(n)&&!ie.isNaN(n)}function be(n,e,r){return n==null||e==null?n===e:n===e?!0:(r==null&&(r=Wt),Math.abs(n-e)<r)}function ni(n,e){return be(n,0,e)?0:Math.abs(n)/n}function Dn(n,e){return be(Math.round(n),n,e)}function ri(n,e){const r=Math.pow(10,e);return Math.round(n*r)/r}function Vn(n,e){return Math.round(n/e)*e}function qn(n,e){return Math.floor(n/e)*e}function Ln(n,e){return Math.ceil(n/e)*e}function Tt(n,e=bn,r=1e3){let s=[1,0],o=[0,1],l=Math.floor(n),f=n-l;for(;o[0]<=r;){if(be(s[0]/o[0],n,e))return[s[0],o[0]];s=[l*s[0]+s[1],s[0]],o=[l*o[0]+o[1],o[0]],l=Math.floor(1/f),f=1/f-l}return[n,1]}function $t(n){return n.reduce((e,r)=>e+r,0)}function Gn(n){return n.reduce((e,r)=>e*r,1)}function et(...n){const e=Math.min(...n.map(s=>s.length)),r=[];for(let s=0;s<e;s++)r.push(n.map(o=>o[s]));return r}function si(n,e){return[e(n[0],0),e(n[1],1)]}function zn(n,e){return!Array.isArray(n)||e!==void 0&&n.length!==e?!1:n.every(Cn)}function ii(n){return mt(n,1/dt(n))}function dt(n){return Math.sqrt(ut(n,n))}function ut(n,e){const s=et(n,e).map(Gn);return $t(s)}function gt(...n){return et(...n).map($t)}function Ke(n,e){return et(n,e).map(r=>r[0]-r[1])}function ai(n){return n.map(e=>-e)}function mt(n,e){return n.map(r=>r*e)}function Un(n,e,r){return n.length===e.length&&et(n,e).every(s=>be(s[0],s[1],r))}function Bn(n){const e=dt(n);let r=Math.atan2(n[1],n[0]);return r<0&&(r+=2*Math.PI),[e,r]}function Wn(n){const e=Bn(n);return[e[0],e[1]*180/Math.PI]}function $n(n,e=0){return[n*Math.cos(e),n*Math.sin(e)]}function Hn(n,e=0){return $n(n,e*Math.PI/180)}function ci(n,e){const r=Wn(n),s=r[1]+e;return Hn(r[0],s)}function Xn(n,e){const r=ut(n,e)/ut(e,e);return mt(e,r)}function Yn(n,e){return n.map((r,s)=>Vn(r,e[s]||e))}function Kn(n,e){return n.map((r,s)=>qn(r,e[s]||e))}function Jn(n,e){return n.map((r,s)=>Ln(r,e[s]||e))}function oi(n,e){return dt(Ke(n,e))}function li(n,e){const r=Ke(e[1],e[0]),s=Ke(n,e[0]),o=Xn(s,r),l=Ke(mt(o,2),s);return gt(e[0],l)}const ui=zn,fi=gt,hi=gt,Qn=Un,pi=Yn,di=Kn,gi=Jn;function vt(n){return We(n,0)?0:n>0?1:-1}function tt(n,e,r){return(e[0]-n[0])*(r[1]-n[1])-(r[0]-n[0])*(e[1]-n[1])}function Zn(n,e,r){return We(tt(n,e,r),0)}function jn(n,e,r){return r[0]<=Math.max(n[0],e[0])&&r[0]>=Math.min(n[0],e[0])&&r[1]<=Math.max(n[1],e[1])&&r[1]>=Math.min(n[1],e[1])}function Ht(n,e){const r=[[n[0],n[1],e[0]],[n[0],n[1],e[1]],[e[0],e[1],n[0]],[e[0],e[1],n[1]]],s=ie.map(r,function(o){return vt(tt(...o))});if(s[0]!==s[1]&&s[2]!==s[3])return!0;for(let o=0;o<4;o++)if(s[o]===0&&jn(...r[o]))return!0;return!1}function er(n){for(let e=0;e<n.length;e++)for(let r=e+1;r<n.length;r++){if(Qn(n[e],n[r]))return!0;const s=(e+1)%n.length,o=(r+1)%n.length;if(s===r||o===e)continue;const l=[n[e],n[s]],f=[n[r],n[o]];if(Ht(l,f))return!0}return!1}function Qe(n,e){return ie.map(ie.zip(n,e),function(r){return r[0]-r[1]})}function tr(n){return[-n[0],-n[1]]}function Xt(n){const e=ie.zip(n,n.slice(1).concat(n.slice(0,1))),r=ie.map(e,function(s){const o=s[0],l=s[1];return(l[0]-o[0])*(l[1]+o[1])});return yr(r)>0}function Ze(n){return Math.sqrt(ie.reduce(n,function(e,r){return e+Math.pow(r,2)},0))}function nr(n,e){return ie.reduce(ie.zip(n,e),function(r,s){return r+s[0]*s[1]},0)}function At(n){return ie.zip(n,Ve(n)).map(function(r){return Ze(Qe(...r))})}function ft(n){const e=ie.zip(Ve(n,-1),n,Ve(n,1)),r=ie.map(e,function(o){const l=Qe(o[1],o[0]),f=Qe(o[2],o[1]),p=Math.acos(nr(l,f)/(Ze(l)*Ze(f)));return vt(tt(...o))>0?p:-p}),s=ie.reduce(r,function(o,l){return o+l},0);return ie.map(r,function(o){return s>0?Math.PI-o:Math.PI+o})}function rr(n,e,r){if(n.length!==e.length)return!1;const s=n.length,o=ft(n),l=ft(e),f=At(n),p=At(e);for(let v=0;v<2*s;v++){let h=l.slice(),d=p.slice();if(v>=s&&(h.reverse(),d.reverse(),d=Ve(d,1)),h=Ve(h,v),d=Ve(d,v),ve(o,h)){const m=ie.zip(f,d),y=ie.map(m,function(I){return I[0]/I[1]}),M=ie.all(y,function(I){return We(y[0],I)}),R=ie.all(m,function(I){return be(I[0],I[1],r)});if(M&&R)return!0}}return!1}function sr(n,e,r){return Math.acos((n*n+e*e-r*r)/(2*n*e))*180/Math.PI}function ir([n,e,r,s]){n<0&&(n*=-1,e*=-1,r*=-1);const o=2*Math.PI;for(e<0&&(e*=-1,r*=-1,r+=o/2);r>0;)r-=o;for(;r<0;)r+=o;return[n,e,r,s]}function Ve(n,e){return e=typeof e>"u"?1:e%n.length,n.slice(e).concat(n.slice(0,e))}function ar(n,e){if(We(n[0],e[0]))return"x = "+n[0].toFixed(3);const r=(e[1]-n[1])/(e[0]-n[0]),s=n[1]-r*n[0];return"y = "+r.toFixed(3)+"x + "+s.toFixed(3)}function cr(n,e){const r=n[0][0],s=n[0][1],o=n[1][0],l=n[1][1],f=e[0][0],p=e[0][1],v=e[1][0],h=e[1][1],d=(r-o)*(p-h)-(s-l)*(f-v);if(Math.abs(d)<1e-9)return"Lines are parallel";const m=((r*l-s*o)*(f-v)-(r-o)*(f*h-p*v))/d,y=((r*l-s*o)*(p-h)-(s-l)*(f*h-p*v))/d;return"Intersection: ("+m.toFixed(3)+", "+y.toFixed(3)+")"}const or=Object.freeze(Object.defineProperty({__proto__:null,angleMeasures:ft,canonicalSineCoefficients:ir,ccw:tt,clockwise:Xt,collinear:Zn,getLineEquation:ar,getLineIntersection:cr,intersects:Ht,lawOfCosines:sr,magnitude:Ze,polygonSidesIntersect:er,reverseVector:tr,rotate:Ve,sign:vt,similar:rr,vector:Qe},Symbol.toStringTag,{value:"Module"}));function lr(n){return n/180*Math.PI}function ur(n){const e=n/Math.PI*180;return Number(e.toPrecision(15))}function fr([n,e]){return Math.atan2(e,n)*180/Math.PI}function hr(n,e){return typeof n=="number"&&(n=[n,n]),e=e*Math.PI/180,[n[0]*Math.cos(e),n[1]*Math.sin(e)]}const ht=(n,e)=>{const r=n[0]-e[0],s=n[1]-e[1];return!r&&!s?0:(180+Math.atan2(-s,-r)*180/Math.PI+360)%360},pr=(n,e=!1)=>{const r=[...n],l=!Xt([r[0],r[2],r[1]])||e?r.reverse():r,f=ht(l[0],l[1]),p=ht(l[2],l[1]);return(f+360-p)%360},dr=Object.freeze(Object.defineProperty({__proto__:null,calculateAngleInDegrees:fr,convertDegreesToRadians:lr,convertRadiansToDegrees:ur,getAngleFromVertex:ht,getClockwiseAngle:pr,polar:hr},Symbol.toStringTag,{value:"Module"}));function gr(n){const e=n[0],r=n[1],s=r[1]-e[1],o=Math.PI/(2*(r[0]-e[0])),l=e[0]*o,f=e[1];return[s,o,l,f]}function mr(n){const e=n[0],r=n[1],s=n[2],o=(e[0]-r[0])*(e[0]-s[0])*(r[0]-s[0]);if(o===0)return;const l=(s[0]*(r[1]-e[1])+r[0]*(e[1]-s[1])+e[0]*(s[1]-r[1]))/o,f=(s[0]*s[0]*(e[1]-r[1])+r[0]*r[0]*(s[1]-e[1])+e[0]*e[0]*(r[1]-s[1]))/o,p=(r[0]*s[0]*(r[0]-s[0])*e[1]+s[0]*e[0]*(s[0]-e[0])*r[1]+e[0]*r[0]*(e[0]-r[0])*s[1])/o;return[l,f,p]}const vr=Object.freeze(Object.defineProperty({__proto__:null,getQuadraticCoefficients:mr,getSinusoidCoefficients:gr},Symbol.toStringTag,{value:"Module"})),oe={cleanMath:function(n){return typeof n=="string"?n.replace(/\+\s*-/g,"- ").replace(/-\s*-/g,"+ ").replace(/\^1/g,""):n},bound:function(n){return n===0?n:n<0?-oe.bound(-n):Math.max(1e-6,Math.min(n,1e20))},factorial:function(n){return n<=1?n:n*oe.factorial(n-1)},getGCD:function(n,e){if(arguments.length>2){const s=[].slice.call(arguments,1);return oe.getGCD(n,oe.getGCD(...s))}let r;for(n=Math.abs(n),e=Math.abs(e);e;)r=n%e,n=e,e=r;return n},getLCM:function(n,e){if(arguments.length>2){const r=[].slice.call(arguments,1);return oe.getLCM(n,oe.getLCM(...r))}return Math.abs(n*e)/oe.getGCD(n,e)},primes:[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97],isPrime:function(n){if(n<=1)return!1;if(n<101)return!!ge.grep(oe.primes,function(e,r){return Math.abs(e-n)<=.5}).length;if(n<=1||n>2&&n%2===0)return!1;for(let e=3,r=Math.sqrt(n);e<=r;e+=2)if(n%e===0)return!1;return!0},getPrimeFactorization:function(n){if(n===1)return[];if(oe.isPrime(n))return[n];const e=Math.sqrt(n);for(let r=2;r<=e;r++)if(n%r===0)return ge.merge(oe.getPrimeFactorization(r),oe.getPrimeFactorization(n/r))},roundToNearest:function(n,e){return Math.round(e/n)*n},roundTo:function(n,e){const r=Math.pow(10,n).toFixed(5);return Math.round((e*r).toFixed(5))/r},toFixedApprox:function(n,e){const r=n.toFixed(e);return be(+r,n)?r:"\\approx "+r},roundToApprox:function(n,e){const r=oe.roundTo(e,n);return be(r,n)?String(r):oe.toFixedApprox(n,e)},toFraction:function(n,e){if(e==null&&(e=Math.pow(2,-46)),n<0||n>1){let v=n%1;v+=v<0?1:0;const h=oe.toFraction(v,e);return h[0]+=Math.round(n-v)*h[1],h}if(Math.abs(Math.round(Number(n))-n)<=e)return[Math.round(n),1];let r=0,s=1,o=1,l=1,f=1,p=2;for(;;){if(Math.abs(Number(f/p)-n)<=e)return[f,p];f/p<n?(r=f,s=p):(o=f,l=p),f=r+o,p=s+l}},getNumericFormat:function(n){if(n=ge.trim(n),n=n.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1"),n.match(/^[+-]?\d+$/))return"integer";if(n.match(/^[+-]?\d+\s+\d+\s*\/\s*\d+$/))return"mixed";const e=n.match(/^[+-]?(\d+)\s*\/\s*(\d+)$/);return e?parseFloat(e[1])>parseFloat(e[2])?"improper":"proper":n.replace(/[,. ]/g,"").match(/^\d+$/)?"decimal":n.match(/(pi?|\u03c0|t(?:au)?|\u03c4|pau)/)?"pi":null},toNumericString:function(n,e){if(n==null)return"";if(n===0)return"0";if(e==="percent")return n*100+"%";if(e==="pi"){const r=Tt(n/Math.PI),s=Math.abs(r[0]),o=r[1];if(Dn(s))return(n<0?"-":"")+(s===1?"":s)+"π"+(o===1?"":"/"+o)}if(ie(["proper","improper","mixed","fraction"]).contains(e)){const r=Tt(n),s=Math.abs(r[0]),o=r[1],l=n<0?"-":"";if(o===1)return l+s;if(e==="mixed"){const f=s%o,p=(s-f)/o;return l+(p?p+" ":"")+f+"/"+o}return l+s+"/"+o}return String(n)}};function yr(n){return n.reduce(xr,0)}function xr(n,e){return n+e}const wr="MISSING_PERCENT_ERROR",Er="NEEDS_TO_BE_SIMPLIFIED_ERROR",Rr="APPROXIMATED_PI_ERROR",Mr="EXTRA_SYMBOLS_ERROR",Or="WRONG_CASE_ERROR",Nr="WRONG_LETTER_ERROR",Ir="MULTIPLICATION_SIGN_ERROR",Sr="INVALID_SELECTION_ERROR",kr="CHOOSE_CORRECT_NUM_ERROR",_r="NOT_NONE_ABOVE_ERROR",Tr="FILL_ALL_CELLS_ERROR",xe={MISSING_PERCENT_ERROR:wr,NEEDS_TO_BE_SIMPLIFIED_ERROR:Er,APPROXIMATED_PI_ERROR:Rr,EXTRA_SYMBOLS_ERROR:Mr,WRONG_CASE_ERROR:Or,WRONG_LETTER_ERROR:Nr,MULTIPLICATION_SIGN_ERROR:Ir,INVALID_SELECTION_ERROR:Sr,CHOOSE_CORRECT_NUM_ERROR:kr,NOT_NONE_ABOVE_ERROR:_r,FILL_ALL_CELLS_ERROR:Tr},Ar=Math.pow(2,-42),we={predicate:{defaultForms:"integer, proper, improper, mixed, decimal",createValidatorFunctional:function(n,e){e=B.extend({simplify:"required",ratio:!1,forms:we.predicate.defaultForms},e);let r;B.isArray(e.forms)?r=e.forms:r=e.forms.split(/\s*,\s*/),e.inexact===void 0&&(e.maxError=0),e.maxError=+e.maxError+Ar,B.contains(r,"percent")&&(r=B.without(r,"percent"),r.push("percent"));const s=function(l){l=l.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").replace(/(^\s*)|(\s*$)/gi,"");const f=l.match(/^([+-]?\d+)\s*\/\s*([+-]?\d+)$/),p=l.match(/^([+-]?)\\frac\{([+-]?\d+)\}\{([+-]?\d+)\}$/),v=parseInt(l,10);if(f||p){let h,d,m=!0;return f?(h=parseFloat(f[1]),d=parseFloat(f[2])):(h=parseFloat(p[2]),p[1]==="-"&&(h<0&&(m=!1),h=-h),d=parseFloat(p[3])),m=m&&d>0&&(e.ratio||d!==1)&&oe.getGCD(h,d)===1,[{value:h/d,exact:m}]}return!isNaN(v)&&""+v===l?[{value:v,exact:!0}]:[]},o={integer:function(l){const f=o.decimal(l),p=o.decimal(l,1);return f[0].value!=null&&f[0].value===p[0].value||f[1].value!=null&&f[1].value===p[1].value?f:[]},proper:function(l){return ge.map(s(l),function(f){return Math.abs(f.value)<1?[f]:[]})},improper:function(l){return ge.map(s(l),function(f){return Math.abs(f.value)>=1?[f]:[]})},pi:function(l){let f,p=[];if(l=l.replace(/\u2212/,"-"),f=l.match(/^([+-]?)\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i))p=[{value:parseFloat(f[1]+"1"),exact:!0}];else if(f=l.match(/^([+-]?\s*\d+\s*(?:\/\s*[+-]?\s*\d+)?)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i))p=s(f[1]);else if(f=l.match(/^([+-]?)\s*(\d+)\s*([+-]?\d+)\s*\/\s*([+-]?\d+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i)){const h=parseFloat(f[1]+"1"),d=parseFloat(f[2]),m=parseFloat(f[3]),y=parseFloat(f[4]),M=m<y&&oe.getGCD(m,y)===1;p=[{value:h*(d+m/y),exact:M}]}else if(f=l.match(/^([+-]?\s*\d+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)\s*(?:\/\s*([+-]?\s*\d+))?$/i))p=s(f[1]+"/"+f[3]);else if(f=l.match(/^([+-]?)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)\s*(?:\/\s*([+-]?\d+))?$/i))p=s(f[1]+"1/"+f[3]);else if(l==="0")p=[{value:0,exact:!0}];else if(f=l.match(/^(.+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i))p=o.decimal(f[1]);else{p=B.reduce(we.predicate.defaultForms.split(/\s*,\s*/),function(m,y){return m.concat(o[y](l))},[]);let h=!1;const d=parseFloat(l);if(!isNaN(d)&&d!==parseInt(l)){const m=Math.PI/12,y=m*Math.round(d/m);Math.abs(d-y)<.01&&(h=!0)}else l.match(/\/\s*7/)&&(h=!0);return h&&B.each(p,function(m){m.piApprox=!0}),p}let v=Math.PI;return l.match(/\\?tau|t|\u03c4/)&&(v=Math.PI*2),l.match(/pau/)&&(v=Math.PI*1.5),ge.each(p,function(h,d){d.value*=v}),p},coefficient:function(l){let f=[];return l=l.replace(/\u2212/,"-"),l===""?f=[{value:1,exact:!0}]:l==="-"&&(f=[{value:-1,exact:!0}]),f},log:function(l){let f,p=[];return l=l.replace(/\u2212/,"-"),l=l.replace(/[ \(\)]/g,""),(f=l.match(/^log\s*(\S+)\s*$/i))?p=o.decimal(f[1]):l==="0"&&(p=[{value:0,exact:!0}]),p},percent:function(l){l=ge.trim(l);let f=!1;l.indexOf("%")===l.length-1&&(l=ge.trim(l.substring(0,l.length-1)),f=!0);const p=o.decimal(l);return ge.each(p,function(v,h){h.exact=f,h.value=h.value/100}),p},mixed:function(l){const f=l.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").match(/^([+-]?)(\d+)\s+(\d+)\s*\/\s*(\d+)$/);if(f){const p=parseFloat(f[1]+"1"),v=parseFloat(f[2]),h=parseFloat(f[3]),d=parseFloat(f[4]),m=h<d&&oe.getGCD(h,d)===1;return[{value:p*(v+h/d),exact:m}]}return[]},decimal:function(l,f=1e10){const p=function(h){h=ge.trim(h);const d=h.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").match(/^([+-]?(?:\d{1,3}(?:[, ]?\d{3})*\.?|\d{0,3}(?:[, ]?\d{3})*\.(?:\d{3}[, ]?)*\d{1,3}))$/),m=h.match(/^0[0,]*,/);if(d&&!m){let y=parseFloat(d[1].replace(/[, ]/g,""));return e.inexact===void 0&&(y=Math.round(y*f)/f),y}},v=function(h){return h=h.replace(/([\.,])/g,function(d,m){return m==="."?",":"."}),p(h)};return[{value:p(l),exact:!0},{value:v(l),exact:!0}]}};return function(l){const f=e.fallback!=null?""+e.fallback:"";l=ge.trim(l)||f;const p={empty:l==="",correct:!1,message:null,guess:l};if(ge.each(r,function(v,h){const d=o[h](l);for(let m=0,y=d.length;m<y;m++){const M=d[m].value,R=d[m].exact,I=d[m].piApprox;if(n(M,e.maxError))return R||e.simplify==="optional"?(p.correct=!0,p.message=e.message||null,p.empty=!1):h==="percent"?(p.empty=!0,p.message=xe.MISSING_PERCENT_ERROR):(e.simplify!=="enforced"&&(p.empty=!0),p.message=xe.NEEDS_TO_BE_SIMPLIFIED_ERROR),!1;I&&n(M,Math.abs(M*.001))&&(p.empty=!0,p.message=xe.APPROXIMATED_PI_ERROR)}}),p.correct===!1){let v=!1;if(B.each(o,function(h){B.any(h(l),function(m){return m.value!=null&&!B.isNaN(m.value)})&&(v=!0)}),!v)return p.empty=!0,p.message=xe.EXTRA_SYMBOLS_ERROR,p}return p}}},number:{convertToPredicate:function(n,e){const r=parseFloat(n);return[function(s,o){return Math.abs(s-r)<o},ge.extend({},e,{type:"predicate"})]},createValidatorFunctional:function(n,e){return we.predicate.createValidatorFunctional(...we.number.convertToPredicate(n,e))}},expression:{parseSolution:function(n,e){let r=Be(n,e);if(r.parsed){if(e.simplified&&!r.expr.isSimplified())throw new Ae("The provided solution ("+n+") isn't fully expanded and simplified.",Pe.InvalidInput);r=r.expr}else throw new Ae("The provided solution ("+n+") didn't parse.",Pe.InvalidInput);return r},createValidatorFunctional:function(n,e){return function(r){const s={empty:!1,correct:!1,message:null,guess:r,ungraded:!1};if(!r)return s.empty=!0,s;const o=Be(r,e);if(!o.parsed)return s.empty=!0,s;typeof n=="string"&&(n=we.expression.parseSolution(n,e));const l=_t(o.expr,n,e);if(l.equal)s.correct=!0;else if(l.wrongVariableNames||l.wrongVariableCase)s.ungraded=!0,s.message=l.wrongVariableCase?xe.WRONG_CASE_ERROR:xe.WRONG_LETTER_ERROR,s.suppressAlmostThere=!0;else if(l.message)s.message=l.message;else{const f=Be(r.replace(/[xX]/g,"*"),e);if(f.parsed){const p=_t(f.expr,n,e);p.equal?(s.ungraded=!0,s.message=xe.MULTIPLICATION_SIGN_ERROR):p.message&&(s.message=p.message+" Also, I'm a computer. I only understand multiplication if you use an asterisk (*) as the multiplication sign.")}}return s}}}};function Pr(n,e){let r=!0;return e.values.forEach((s,o)=>{n.values[o]!==s&&(r=!1)}),{type:"points",earned:r?1:0,total:1,message:null}}function Fr(n,e){return e.items.some((s,o)=>n.values[o]==null)?{type:"invalid",message:xe.INVALID_SELECTION_ERROR}:null}function br(n){return n.status==="correct"?{type:"points",earned:1,total:1,message:n.message||null}:n.status==="incorrect"?{type:"points",earned:0,total:1,message:n.message||null}:{type:"invalid",message:"Keep going, you're not there yet!"}}function Cr(n,e){return{type:"points",earned:e.choices[n.value-1].correct?1:0,total:1,message:null}}function Dr(n){return n.value===0?{type:"invalid",message:null}:null}function Vr(n,e,r){const s=B.clone(e);B.extend(s,{decimal_separator:pn(r)});const o=h=>{const d=Be(h.value,e);if(!d.parsed)throw new Ae("Unable to parse solution answer for expression",Pe.InvalidInput,{metadata:{rubric:JSON.stringify(e)}});return we.expression.createValidatorFunctional(d.expr,B({}).extend(s,{simplify:h.simplify,form:h.form}))};let l,f,p=!0,v;for(const h of e.answerForms||[]){const d=o(h);if(!d)continue;const m=d(n);if(m.correct){l=h,f=m.message||"";break}p=p&&m.empty,h.considered==="correct"&&m.ungraded&&!v&&(v=m)}return l?l.considered==="ungraded"?{type:"invalid",message:f}:{type:"points",earned:l.considered==="correct"?1:0,total:1,message:f}:v?{type:"invalid",message:v.message,suppressAlmostThere:v.suppressAlmostThere}:p?{type:"invalid",message:null}:{type:"points",earned:0,total:1}}function qr(n){return n===""?{type:"invalid",message:null}:null}function Pt(n){if(n.coords!=null){if(n.type==="exponential"||n.type==="logarithm")return it(n.type).getCoefficients(n.coords,n.asymptote);if(n.type==="linear"||n.type==="quadratic"||n.type==="absolute_value"||n.type==="sinusoid"||n.type==="tangent")return it(n.type).getCoefficients(n.coords);throw new Ae("Invalid grapher type",Pe.InvalidInput)}}function Lr(n,e){if(n.type!==e.correct.type)return{type:"points",earned:0,total:1,message:null};if(n.coords==null)return{type:"invalid",message:null};const r=it(n.type),s=Pt(n),o=Pt(e.correct);return s==null||o==null?{type:"invalid",message:null}:r.areEqual(s,o)?{type:"points",earned:1,total:1,message:null}:{type:"points",earned:0,total:1,message:null}}function Gr(n){return n.status==="correct"?{type:"points",earned:1,total:1,message:n.message||null}:n.status==="incorrect"?{type:"points",earned:0,total:1,message:n.message||null}:{type:"invalid",message:"Keep going, you're not there yet!"}}const{collinear:de,canonicalSineCoefficients:Ft,similar:st,clockwise:zr}=or,{getClockwiseAngle:Ur}=dr,{getSinusoidCoefficients:bt,getQuadraticCoefficients:Ct}=vr;function Br(n,e){if(n.type==="none"&&e.correct.type==="none")return{type:"points",earned:0,total:0,message:null};const r=!!(n.coords||n.center&&n.radius);if(n.type===e.correct.type&&r){if(n.type==="linear"&&e.correct.type==="linear"&&n.coords!=null){const s=n.coords,o=e.correct.coords;if(de(o[0],o[1],s[0])&&de(o[0],o[1],s[1]))return{type:"points",earned:1,total:1,message:null}}else if(n.type==="linear-system"&&e.correct.type==="linear-system"&&n.coords!=null){const s=n.coords,o=e.correct.coords;if(de(o[0][0],o[0][1],s[0][0])&&de(o[0][0],o[0][1],s[0][1])&&de(o[1][0],o[1][1],s[1][0])&&de(o[1][0],o[1][1],s[1][1])||de(o[0][0],o[0][1],s[1][0])&&de(o[0][0],o[0][1],s[1][1])&&de(o[1][0],o[1][1],s[0][0])&&de(o[1][0],o[1][1],s[0][1]))return{type:"points",earned:1,total:1,message:null}}else if(n.type==="quadratic"&&e.correct.type==="quadratic"&&n.coords!=null){const s=Ct(n.coords),o=Ct(e.correct.coords);if(ve(s,o))return{type:"points",earned:1,total:1,message:null}}else if(n.type==="sinusoid"&&e.correct.type==="sinusoid"&&n.coords!=null){const s=bt(n.coords),o=bt(e.correct.coords),l=Ft(s),f=Ft(o);if(ve(l,f))return{type:"points",earned:1,total:1,message:null}}else if(n.type==="circle"&&e.correct.type==="circle"){if(ve(n.center,e.correct.center)&&We(n.radius,e.correct.radius))return{type:"points",earned:1,total:1,message:null}}else if(n.type==="point"&&e.correct.type==="point"&&n.coords!=null){let s=e.correct.coords;if(s==null)throw new Error("Point graph rubric has null coords");const o=n.coords.slice();if(s=s.slice(),o==null||o.sort(),s.sort(),ve(o,s))return{type:"points",earned:1,total:1,message:null}}else if(n.type==="polygon"&&e.correct.type==="polygon"&&n.coords!=null){const s=n.coords.slice(),o=e.correct.coords.slice();let l;if(e.correct.match==="similar"?l=st(s,o,Number.POSITIVE_INFINITY):e.correct.match==="congruent"?l=st(s,o,Wt):e.correct.match==="approx"?l=st(s,o,.1):(s.sort(),o.sort(),l=ve(s,o)),l)return{type:"points",earned:1,total:1,message:null}}else if(n.type==="segment"&&e.correct.type==="segment"&&n.coords!=null){let s=ct(n.coords),o=ct(e.correct.coords);if(s=B.invoke(s,"sort").sort(),o=B.invoke(o,"sort").sort(),ve(s,o))return{type:"points",earned:1,total:1,message:null}}else if(n.type==="ray"&&e.correct.type==="ray"&&n.coords!=null){const s=n.coords,o=e.correct.coords;if(ve(s[0],o[0])&&de(o[0],o[1],s[1]))return{type:"points",earned:1,total:1,message:null}}else if(n.type==="angle"&&e.correct.type==="angle"){const s=n.coords,o=e.correct.coords,l=e.correct.allowReflexAngles;if(!s)return{type:"invalid",message:null};const v=zr([s[0],s[2],s[1]])&&!l?s.slice().reverse():s;let h;if(e.correct.match==="congruent"){const d=B.map([v,o],function(m){return m?Ur(m,l):!1});h=We(...d)}else h=ve(v[1],o[1])&&de(o[1],o[0],v[0])&&de(o[1],o[2],v[2]);if(h)return{type:"points",earned:1,total:1,message:null}}}return!r||B.isEqual(n,e.graph)?{type:"invalid",message:null}:{type:"points",earned:0,total:1,message:null}}function Wr(n,e){const r={hasAnswers:!1,isCorrect:!1};return n&&n.length>0&&(r.hasAnswers=!0),e.length>0?n&&n.length===e.length&&(r.isCorrect=n.every(s=>e.includes(s))):(!n||n.length===0)&&(r.isCorrect=!0),r}function $r(n,e){let r=0;for(let s=0;s<n.markers.length;s++)Wr(n.markers[s].selected,e.markers[s].answers).isCorrect&&r++;return{type:"points",earned:r===n.markers.length?1:0,total:1,message:null}}function Hr(n,e){return{type:"points",earned:B.isEqual(n.left,e.left)&&B.isEqual(n.right,e.right)?1:0,total:1,message:null}}function Xr(n,e){const r=e.answers,s=n.answers,o=at(r),l=at(s),f=o[0]!==l[0]||o[1]!==l[1],p=we.number.createValidatorFunctional;let v=null,h=!1;return B(l[0]).times(d=>{B(l[1]).times(m=>{if(!f){const M=p(r[d][m],{simplify:!0})(s[d][m]);M.message&&(v=M.message),M.correct||(h=!0)}})}),f?{type:"points",earned:0,total:1,message:null}:{type:"points",earned:h?0:1,total:1,message:v}}function Yr(n){const e=n.answers,r=at(e);for(let s=0;s<r[0];s++)for(let o=0;o<r[1];o++)if(e[s][o]==null||e[s][o].toString().length===0)return{type:"invalid",message:xe.FILL_ALL_CELLS_ERROR};return null}function Kr(n,e){const r=e.range,s=e.initialX!=null?e.initialX:r[0],o=e.isInequality?"ge":"eq",l=e.correctRel||"eq";return be(n.numLinePosition,e.correctX||0)&&l===n.rel?{type:"points",earned:1,total:1,message:null}:n.numLinePosition===s&&n.rel===o?{type:"invalid",message:null}:{type:"points",earned:0,total:1,message:null}}function Jr(n){const e=n.divisionRange,r=n.numDivisions>e[1]||n.numDivisions<e[0];return n.isTickCrtl&&r?{type:"invalid",message:"Number of divisions is outside the allowed range."}:null}function Qr(n,e){let r=0;for(let s=e,o=n.length;s<o;s++){const l=n[s];if(l==="{"?r++:l==="}"&&r--,r<0)return s}return n.length}function Dt(n,e,r){const o=n.indexOf("{",e)+1,l=Qr(n,o),f=n.substring(o,l),p=Yt(f,r);return{endpoint:l,expression:p}}function Vt(n,e){const r="\\dfrac",o=n.indexOf("\\frac",e),l=n.indexOf(r,e);return o>-1&&l>-1?Math.min(o,l):o>-1?o:l>-1?l:-1}function Yt(n,e){if(!n)return"";let r="",s=0,o=Vt(n,s);for(;o>-1;){r+=n.substring(s,o),s=o;const l=Dt(n,s,e);s=l.endpoint+1;const f=Dt(n,s,e);s=f.endpoint+1,r.length&&(r+=" "),r+=e(l.expression,f.expression),o=Vt(n,s)}return r+=n.slice(s),r}function Kt(n){return Yt(n,function(s,o){return s+"/"+o}).replace("\\%","%")}const Zr=[{title:"Integers",value:"integer",content:"6"},{title:"Decimals",value:"decimal",content:"0.75"},{title:"Proper fractions",value:"proper",content:"⅗"},{title:"Improper fractions",value:"improper",content:"⁷⁄₄"},{title:"Mixed numbers",value:"mixed",content:"1¾"},{title:"Numbers with π",value:"pi",content:"π"}];function jr(n,e){if(!(typeof n=="string"&&n.endsWith("%")))return n;const r=parseFloat(n.slice(0,-1));return isNaN(r)?n:e?r/100:r}function es(n,e){const r=Zr.map(h=>h.value).filter(h=>h!=="pi"),s=h=>{const d=`${h.value}`,m=[...h.answerForms??[]];return(!h.strict||m.length===0)&&m.push(...r),we.number.createValidatorFunctional(d,{message:h.message,simplify:h.status==="correct"?h.simplify:"optional",inexact:!0,maxError:h.maxError,forms:m})},o=Kt(n.currentValue),l=e.answers.filter(h=>h.status==="correct").every(h=>h.value!=null&&Math.abs(h.value)<=1);let f=o;e.coefficient&&(f?f==="-"&&(f=-1):f=1);const p=e.answers.map(h=>{const m=s(h)(jr(f,l));return{...h,score:m}}).find(h=>h.score.correct||h.status==="correct"&&h.score.empty),v=(p==null?void 0:p.status)==="correct"?p.score:{empty:(p==null?void 0:p.status)==="ungraded",correct:(p==null?void 0:p.status)==="correct",message:(p==null?void 0:p.message)??null,guess:f};return v.empty?{type:"invalid",message:v.message}:{type:"points",earned:v.correct?1:0,total:1,message:v.message}}function ts(n,e){return{type:"points",earned:B.isEqual(n.current,e.correctOptions.map(s=>s.content))?1:0,total:1,message:null}}function ns(n){return n.current.length===0?{type:"invalid",message:null}:null}function rs(n,e){return{type:"points",earned:ve(n,e.correct)?1:0,total:1,message:null}}function ss(n,e){return ve(n,e.starting)?{type:"invalid",message:null}:null}function is(n,e){const r=n.choicesSelected.reduce((f,p)=>f+(p?1:0),0),s=e.choices.reduce((f,p)=>p.correct?f+1:f,0);return s>1&&r!==s?{type:"invalid",message:xe.CHOOSE_CORRECT_NUM_ERROR}:e.choices.some((f,p)=>f.isNoneOfTheAbove&&n.choicesSelected[p])&&r>1?{type:"invalid",message:xe.NOT_NONE_ABOVE_ERROR}:{type:"points",earned:n.choicesSelected.every((f,p)=>{let v;return e.choices[p].isNoneOfTheAbove?v=e.choices.every((h,d)=>p===d||!h.correct):v=!!e.choices[p].correct,v===f})?1:0,total:1,message:null}}function as(n){return n.choicesSelected.reduce((r,s)=>r+(s?1:0),0)===0?{type:"invalid",message:null}:null}function cs(n,e){return{type:"points",earned:ve(n.options,e.correct)?1:0,total:1,message:null}}function os(n){return n.changed?null:{type:"invalid",message:null}}const pt=function(n){return n.filter(function(e){return e.some(r=>r)})};function Jt(n){const e=pt(n);return e.some(function(s){return s.some(function(o){return o===""})})||!e.length?{type:"invalid",message:null}:null}function ls(n,e){const r=Jt(n);if(r!=null)return r;const s=pt(n),o=pt(e.answers);if(s.length!==o.length)return{type:"points",earned:0,total:1,message:null};const l=we.number.createValidatorFunctional;let f=null;return{type:"points",earned:o.every(function(v){for(let h=0;h<s.length;h++)if(s[h].every(function(y,M){const R=v[M],k=l(R,{simplify:!0})(y);return k.message&&(f=k.message),k.correct}))return s.splice(h,1),!0;return!1})?1:0,total:1,message:f}}const us={number:{name:"Numbers",forms:"integer, decimal, proper, improper, mixed"},decimal:{name:"Decimals",forms:"decimal"},integer:{name:"Integers",forms:"integer"},rational:{name:"Fractions and mixed numbers",forms:"integer, proper, improper, mixed"},improper:{name:"Improper numbers (no mixed)",forms:"integer, proper, improper"},mixed:{name:"Mixed numbers (no improper)",forms:"integer, proper, mixed"},percent:{name:"Numbers or percents",forms:"integer, decimal, proper, improper, mixed, percent"},pi:{name:"Numbers with pi",forms:"pi"}};function fs(n,e){e.answerType==null&&(e.answerType="number");const r=`${e.value}`,s=we.number.createValidatorFunctional(r,{simplify:e.simplify,inexact:e.inexact||void 0,maxError:e.maxError,forms:us[e.answerType].forms}),o=Kt(n.currentValue),l=s(o);return l.empty?{type:"invalid",message:l.message}:{type:"points",earned:l.correct?1:0,total:1,message:l.message}}function Ee(n=0){return{type:"points",earned:n,total:n,message:null}}function hs(n,e,r){const s=jt(e.widgets,Object.keys(e.widgets),n,r);return Zt(s)}function ps(n,e,r,s){return e.filter(o=>{const l=n[o];if(!l||l.static===!0)return!1;const f=Qt(l.type),p=r[o],v=l.options,h=f==null?void 0:f(p,v,s);if(h)return xs(h)})}function ds(n,e,r){return ps(e.widgets,Object.keys(e.widgets),n,r).length===0?null:{type:"invalid",message:null}}function gs(n){let e=0;for(let r=0;r<n.markers.length;r++){const s=n.markers[r].selected;s&&s.length>0&&e++}return e!==n.markers.length?{type:"invalid",message:null}:null}function ms(n){return n.currentValue==null||n.currentValue===""?{type:"invalid",message:""}:null}function qt(n,e){const r=ms(n);return r??{type:"points",earned:n.currentValue===e.value?1:0,total:1,message:""}}const yt={};function K(n,e,r){yt[n]={scorer:e,validator:r}}const Qt=n=>{var e;return((e=yt[n])==null?void 0:e.validator)??null},vs=n=>{var e;return((e=yt[n])==null?void 0:e.scorer)??null};K("categorizer",Pr,Fr);K("cs-program",br);K("dropdown",Cr,Dr);K("expression",Vr,qr);K("grapher",Lr);K("group",hs,ds);K("iframe",Gr);K("input-number",fs);K("interactive-graph",Br);K("label-image",$r,gs);K("matcher",Hr);K("matrix",Xr,Yr);K("mock-widget",qt,qt);K("number-line",Kr,Jr);K("numeric-input",es);K("orderer",ts,ns);K("plotter",rs,ss);K("radio",is,as);K("sorter",cs,os);K("table",ls,Jt);K("deprecated-standin",()=>Ee(1));K("measurer",()=>Ee(1));K("definition",Ee);K("explanation",Ee);K("image",Ee);K("interaction",Ee);K("molecule",Ee);K("passage",Ee);K("passage-ref",Ee);K("passage-ref-target",Ee);K("video",Ee);const ys={type:"points",earned:0,total:0,message:null};function xs(n){return n.type==="invalid"&&(!n.message||n.message.length===0)}function ws(n,e){let r;if(n.type==="points"&&e.type==="points")return n.message&&e.message&&n.message!==e.message?r=null:r=n.message||e.message,{type:"points",earned:n.earned+e.earned,total:n.total+e.total,message:r};if(n.type==="points"&&e.type==="invalid")return e;if(n.type==="invalid"&&e.type==="points")return n;if(n.type==="invalid"&&e.type==="invalid")return n.message&&e.message&&n.message!==e.message?r=null:r=n.message||e.message,{type:"invalid",message:r};throw new Ae("PerseusScore with unknown type encountered",Pe.InvalidInput,{metadata:{scoreA:JSON.stringify(n),scoreB:JSON.stringify(e)}})}function Zt(n){return Object.values(n).reduce(ws,ys)}function mi(n,e,r){const s=gn(n.content),o=jt(n.widgets,s,e,r);return Zt(o)}function jt(n,e,r,s){const o=xn(n),l=e.filter(p=>{const v=o[p],h=(v==null?void 0:v.graded)==null||v.graded,d=!!(v!=null&&v.static);return h&&!d}),f={};return l.forEach(p=>{const v=o[p];if(!v)return;const h=r[p],d=Qt(v.type),m=vs(v.type),y=(d==null?void 0:d(h,v.options,s))??(m==null?void 0:m(h,v.options,s));y!=null&&(f[p]=y)}),f}const en=/^web\+graphie:/,tn=/^file\+graphie:/;function xt(n){return nn(n)?rn(n):n}function nn(n){return en.test(n)||tn.test(n)}function wt(n){return n.replace(en,"https:").replace(tn,"file:")}function rn(n){return wt(n)+".svg"}function Es(n){return wt(n)+"-data.json"}async function Rs(n){const e=new Image;return new Promise((r,s)=>{e.onload=()=>{r([e.naturalWidth,e.naturalHeight])},e.onerror=s,e.src=xt(n)})}let Lt=!1;const sn=function(n,e,r){return Array.isArray(n)?B.map(n,function(s){return sn(s,e)}):e.call(r,n)};function Ms(n,e){return n==null||e==null?n==null==(e==null):n.length===e.length&&n.every((r,s)=>e[s]===r)}const an=/^\[\[\u2603 (([a-z-]+) ([0-9]+))\]\]/,Os=/^([a-z-]+) ([0-9]+)$/,Ns=new RegExp(an.source+"$"),Is="☃",Et=function(n){let e=n;return function(){let r=e;return r=r+2127912214+(r<<12)&4294967295,r=(r^3345072700^r>>>19)&4294967295,r=r+374761393+(r<<5)&4294967295,r=(r+3550635116^r<<9)&4294967295,r=r+4251993797+(r<<3)&4294967295,r=(r^3042594569^r>>>16)&4294967295,(e=r&268435455)/268435456}};function Ss(n,e,r=!1){const s=B.clone(n);if(!s.length||B.all(s,function(l){return B.isEqual(l,s[0])}))return s;let o;typeof e=="function"?o=e:o=Et(e);do for(let l=s.length;l>0;l--){const f=Math.floor(o()*l),p=s[f];s[f]=s[l-1],s[l-1]=p}while(r&&B.isEqual(n,s));return s}const ks="x".split(/(.)/g).length?function(n,e){return n.split(e)}:function(n,e){const r=[];let s=e.lastIndex=0,o;for(;o=e.exec(n);){const l=o;r.push(n.slice(s,l.index)),r.push(...l.slice(1)),s=l.index+l[0].length}return r.push(n.slice(s)),r};function _s(n,e){let r;return we.predicate.createValidatorFunctional(function(o){return r=o,!0},{simplify:"optional",inexact:!0,forms:"integer, proper, improper, pi, log, mixed, decimal"})(n),r}function Ts(n){return B(n).times(function(){return""})}function As(n,e,r,s){const o=Rt(e,r),f=n*o>30;return{scale:o,tickStep:n/s,unityLabel:f}}function Ps(n,e,r){return B(2).times(function(s){const o=Rt(n[s],r);return cn(e[s],o)})}function Fs(n){return[n[0]/2,n[1]/2]}function cn(n,e){const r=n*e,s=n,o=Math.pow(10,Math.floor(Math.log(s)/Math.LN10)),l=Math.floor(s/o);if(r<25)return n;if(r<50)return l===5?n:n/2;if(l===1)return n/2;if(l===2)return n/4;if(l===5)return n/5}function Rt(n,e){const r=n[1]-n[0];return e/r}function bs(n,e){const r=n[1]-n[0];let s;15<r&&r<=20?s=23:r>100||r<5?s=10:s=16;const o=e/500,l=s*o;return Mt(r,l)}function Mt(n,e){let r=Math.pow(10,Math.floor(Math.log(n/e)/Math.LN10));const s=e/n*r;return s<=.15?r*=10:s<=.35?r*=5:s<=.75&&(r*=2),r}const Gt=(n,e)=>{const r=e[1]-e[0],s=r/n;return s<=10?n:s<=20?n*2:Mt(r,10)};function Cs(n,e){return[Gt(n[0],e[0]),Gt(n[1],e[1])]}function Ds(n){n=n||window.location.search.substring(1);const e={},r=/\+/g,s=/([^&=]+)=?([^&]*)/g,o=function(f){return decodeURIComponent(f.replace(r," "))};let l;for(;l=s.exec(n);){const f=l;e[o(f[1])]=o(f[2])}return e}function Vs(n,e,r){r=encodeURIComponent(r);const s=new RegExp("([?&])"+e+"=.*?(&|$)","i"),o=n.indexOf("?")!==-1?"&":"?";return n.match(s)?n.replace(s,"$1"+e+"="+r+"$2"):n+o+e+"="+r}function qs(n){return encodeURIComponent(n).replace(/['()!]/g,window.escape).replace(/\*/g,"%2A")}const Se={pointerDown:!1,currentTouchIdentifier:null};function Ls(){Object.assign(Se,{pointerDown:!1,currentTouchIdentifier:null})}function Gs(n){let e;if(Se.pointerDown){if(Se.currentTouchIdentifier!=null){const s=n.changedTouches?n.changedTouches.length:0;for(let o=0;o<s;o++)n.changedTouches[o].identifier===Se.currentTouchIdentifier&&(e=n.changedTouches[o])}else e=n;const r=n.type==="touchend"||n.type==="touchcancel";e&&r&&(Se.pointerDown=!1,Se.currentTouchIdentifier=null)}else Se.pointerDown=!0,n.changedTouches?(e=n.changedTouches[0],Se.currentTouchIdentifier=e.identifier):e=n;if(e)return{left:e.pageX,top:e.pageY}}const zs=()=>{try{const n=Object.defineProperty({},"passive",{get:function(){Lt=!0}});window.addEventListener("testPassive",null,n),window.removeEventListener("testPassive",null,n)}catch{}return Lt};function Us(n){n.stopPropagation()}function Bs(n,e){const r=new Image;r.onload=function(){var s;r.width===0&&r.height===0?((s=document.body)==null||s.appendChild(r),B.defer(function(){var o;e(r.clientWidth,r.clientHeight),(o=document.body)==null||o.removeChild(r)})):e(r.width,r.height)},r.src=xt(n)}function Ws(n){const e=n.value,r=n.selectionStart-1,s=Math.max(e.lastIndexOf(`
`,r),e.lastIndexOf(" ",r))+1;return{string:e.substring(s,r+1),pos:{start:s,end:r}}}function $s(n,e){n.selectionStart=e,n.selectionEnd=e}const Hs={getWordBeforeCursor:Ws,moveCursor:$s},Xs=n=>n.startsWith("$")&&n.endsWith("$")?n.slice(1,-1):n,Ys=Et(new Date().getTime()&4294967295),vi={inputPathsEqual:Ms,nestedMap:sn,rWidgetRule:an,rTypeFromWidgetId:Os,rWidgetParts:Ns,snowman:Is,seededRNG:Et,shuffle:Ss,split:ks,firstNumericalParse:_s,stringArrayOfSize:Ts,gridDimensionConfig:As,getGridStep:Ps,snapStepFromGridStep:Fs,scaleFromExtent:Rt,tickStepFromExtent:bs,gridStepFromTickStep:cn,tickStepFromNumTicks:Mt,constrainedTickStepsFromTickSteps:Cs,parseQueryString:Ds,updateQueryString:Vs,strongEncodeURIComponent:qs,touchHandlers:Se,resetTouchHandlers:Ls,extractPointerLocation:Gs,supportsPassiveEvents:zs,captureScratchpadTouchStart:Us,getImageSize:Bs,getImageSizeModern:Rs,getRealImageUrl:xt,isLabeledSVG:nn,getBaseUrl:wt,getSvgUrl:rn,getDataUrl:Es,textarea:Hs,unescapeMathMode:Xs,random:Ys};export{hi as A,pi as B,gi as C,di as D,ti as E,xn as F,mn as G,ps as H,jt as I,Zt as J,oe as K,is as L,li as M,vr as N,Wr as O,ni as P,Tt as Q,Vn as R,vi as U,Dn as a,be as b,dr as c,Ke as d,Un as e,ui as f,at as g,gt as h,us as i,mt as j,oi as k,dt as l,si as m,Hn as n,ii as o,Be as p,Wn as q,ri as r,mi as s,fi as t,yn as u,or as v,Qn as w,ci as x,ai as y,et as z};
