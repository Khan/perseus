"use strict";(self.webpackChunkperseus=self.webpackChunkperseus||[]).push([[2867],{"./node_modules/@storybook/addon-actions/dist/index.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{aD:()=>action});var v4=__webpack_require__("./node_modules/@storybook/addon-actions/node_modules/uuid/dist/esm-browser/v4.js"),external_STORYBOOK_MODULE_PREVIEW_API_=__webpack_require__("@storybook/preview-api"),external_STORYBOOK_MODULE_GLOBAL_=__webpack_require__("@storybook/global"),preview_errors=__webpack_require__("./node_modules/@storybook/core-events/dist/errors/preview-errors.mjs"),ADDON_ID="storybook/actions",EVENT_ID=`${ADDON_ID}/action-event`,config={depth:10,clearOnStoryChange:!0,limit:50},findProto=(obj,callback)=>{let proto=Object.getPrototypeOf(obj);return!proto||callback(proto)?proto:findProto(proto,callback)},serializeArg=a=>{if("object"==typeof(e=a)&&e&&findProto(e,(proto=>/^Synthetic(?:Base)?Event$/.test(proto.constructor.name)))&&"function"==typeof e.persist){let e=Object.create(a.constructor.prototype,Object.getOwnPropertyDescriptors(a));e.persist();let viewDescriptor=Object.getOwnPropertyDescriptor(e,"view"),view=viewDescriptor?.value;return"object"==typeof view&&"Window"===view?.constructor.name&&Object.defineProperty(e,"view",{...viewDescriptor,value:Object.create(view.constructor.prototype)}),e}var e;return a},generateId=()=>"object"==typeof crypto&&"function"==typeof crypto.getRandomValues?(0,v4.Z)():Date.now().toString(36)+Math.random().toString(36).substring(2);function action(name,options={}){let actionOptions={...config,...options},handler=function(...args){if(options.implicit){let storyRenderer=("__STORYBOOK_PREVIEW__"in external_STORYBOOK_MODULE_GLOBAL_.global?external_STORYBOOK_MODULE_GLOBAL_.global.__STORYBOOK_PREVIEW__:void 0)?.storyRenders.find((render=>"playing"===render.phase||"rendering"===render.phase));if(storyRenderer){let deprecated=!window?.FEATURES?.disallowImplicitActionsInRenderV8,error=new preview_errors.is({phase:storyRenderer.phase,name,deprecated});if(!deprecated)throw error;console.warn(error)}}let channel=external_STORYBOOK_MODULE_PREVIEW_API_.addons.getChannel(),id=generateId(),serializedArgs=args.map(serializeArg),normalizedArgs=args.length>1?serializedArgs:serializedArgs[0],actionDisplayToEmit={id,count:0,data:{name,args:normalizedArgs},options:{...actionOptions,maxDepth:5+(actionOptions.depth||3),allowFunction:actionOptions.allowFunction||!1}};channel.emit(EVENT_ID,actionDisplayToEmit)};return handler.isAction=!0,handler}},"./packages/perseus-editor/src/widgets/__stories__/numeric-input-editor.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var _storybook_addon_actions__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@storybook/addon-actions/dist/index.mjs"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_numeric_input_editor__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/perseus-editor/src/widgets/numeric-input-editor.tsx");const __WEBPACK_DEFAULT_EXPORT__={title:"Perseus/Editor/Widgets/NumericInput Editor"},Default=args=>react__WEBPACK_IMPORTED_MODULE_1__.createElement(_numeric_input_editor__WEBPACK_IMPORTED_MODULE_2__.Z,{onChange:(0,_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_0__.aD)("onChange")});Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:'(args: StoryArgs): React.ReactElement => {\n  return <NumericInputEditor onChange={action("onChange")} />;\n}',...Default.parameters?.docs?.source}}};const __namedExportsOrder=["Default"];try{Default.displayName="Default",Default.__docgenInfo={description:"",displayName:"Default",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/perseus-editor/src/widgets/__stories__/numeric-input-editor.stories.tsx#Default"]={docgenInfo:Default.__docgenInfo,name:"Default",path:"packages/perseus-editor/src/widgets/__stories__/numeric-input-editor.stories.tsx#Default"})}catch(__react_docgen_typescript_loader_error){}},"./packages/perseus-editor/src/widgets/numeric-input-editor.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _khanacademy_perseus__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./packages/perseus/src/index.ts"),create_react_class__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/create-react-class/index.js"),create_react_class__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(create_react_class__WEBPACK_IMPORTED_MODULE_1__),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/index.js"),underscore__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/underscore/modules/index-all.js"),_editor__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./packages/perseus-editor/src/editor.tsx");const{ButtonGroup,InfoTip,InlineIcon,MultiButtonGroup,NumberInput,PropCheckBox,TextInput}=_khanacademy_perseus__WEBPACK_IMPORTED_MODULE_0__.components,{iconGear,iconTrash}=_khanacademy_perseus__WEBPACK_IMPORTED_MODULE_0__.icons,{firstNumericalParse}=_khanacademy_perseus__WEBPACK_IMPORTED_MODULE_0__.Util,answerFormButtons=[{title:"Integers",value:"integer",content:"6"},{title:"Decimals",value:"decimal",content:"0.75"},{title:"Proper fractions",value:"proper",content:"⅗"},{title:"Improper fractions",value:"improper",content:"⁷⁄₄"},{title:"Mixed numbers",value:"mixed",content:"1¾"},{title:"Numbers with π",value:"pi",content:"π"}],initAnswer=status=>({value:null,status,message:"",simplify:"required",answerForms:[],strict:!1,maxError:null}),__WEBPACK_DEFAULT_EXPORT__=create_react_class__WEBPACK_IMPORTED_MODULE_1___default()({displayName:"NumericInputEditor",propTypes:{..._khanacademy_perseus__WEBPACK_IMPORTED_MODULE_0__.ye.i},statics:{widgetName:"numeric-input"},getDefaultProps:function(){return{answers:[initAnswer("correct")],size:"normal",coefficient:!1,labelText:"",rightAlign:!1}},getInitialState:function(){return{lastStatus:"wrong",showOptions:underscore__WEBPACK_IMPORTED_MODULE_3__.ZP.map(this.props.answers,(()=>!1))}},render:function(){const answers=this.props.answers,unsimplifiedAnswers=i=>react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:"perseus-widget-row"},react__WEBPACK_IMPORTED_MODULE_2__.createElement("label",null,"Unsimplified answers are"),react__WEBPACK_IMPORTED_MODULE_2__.createElement(ButtonGroup,{value:answers[i].simplify,allowEmpty:!1,buttons:[{value:"required",content:"ungraded"},{value:"optional",content:"accepted"},{value:"enforced",content:"wrong"}],onChange:this.updateAnswer(i,"simplify")}),react__WEBPACK_IMPORTED_MODULE_2__.createElement(InfoTip,null,react__WEBPACK_IMPORTED_MODULE_2__.createElement("p",null,'Normally select "ungraded". This will give the user a message saying the answer is correct but not simplified. The user will then have to simplify it and re-enter, but will not be penalized. (5th grade and after)'),react__WEBPACK_IMPORTED_MODULE_2__.createElement("p",null,'Select "accepted" only if the user is not expected to know how to simplify fractions yet. (Anything prior to 5th grade)'),react__WEBPACK_IMPORTED_MODULE_2__.createElement("p",null,'Select "wrong" ',react__WEBPACK_IMPORTED_MODULE_2__.createElement("em",null,"only")," if we are specifically assessing the ability to simplify."))),suggestedAnswerTypes=i=>react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:"perseus-widget-row"},react__WEBPACK_IMPORTED_MODULE_2__.createElement("label",null,"Choose the suggested answer formats"),react__WEBPACK_IMPORTED_MODULE_2__.createElement(MultiButtonGroup,{buttons:answerFormButtons,values:answers[i].answerForms,onChange:this.updateAnswer(i,"answerForms")}),react__WEBPACK_IMPORTED_MODULE_2__.createElement(InfoTip,null,react__WEBPACK_IMPORTED_MODULE_2__.createElement("p",null,'Formats will be autoselected for you based on the given answer; to show no suggested formats and accept all types, simply have a decimal/integer be the answer. Values with π will have format "pi", and values that are fractions will have some subset (mixed will be "mixed" and "proper"; improper/proper will both be "improper" and "proper"). If you would like to specify that it is only a proper fraction (or only a mixed/improper fraction), deselect the other format. Except for specific cases, you should not need to change the autoselected formats.'),react__WEBPACK_IMPORTED_MODULE_2__.createElement("p",null,"To restrict the answer to ",react__WEBPACK_IMPORTED_MODULE_2__.createElement("em",null,"only"),' an improper fraction (i.e. 7/4), select the improper fraction and toggle "strict" to true. This ',react__WEBPACK_IMPORTED_MODULE_2__.createElement("b",null,"will not")," ","accept 1.75 as an answer."," "),react__WEBPACK_IMPORTED_MODULE_2__.createElement("p",null,"Unless you are testing that specific skill, please do not restrict the answer format."))),react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:"perseus-widget-row"},react__WEBPACK_IMPORTED_MODULE_2__.createElement(PropCheckBox,{label:"Strictly match only these formats",strict:answers[i].strict,onChange:this.updateAnswer.bind(this,i)}))),maxError=i=>react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:"perseus-widget-row"},react__WEBPACK_IMPORTED_MODULE_2__.createElement("label",null,"Max error"," ",react__WEBPACK_IMPORTED_MODULE_2__.createElement(NumberInput,{className:"max-error",value:answers[i].maxError,onChange:this.updateAnswer(i,"maxError"),placeholder:"0"}))),inputSize=react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:"perseus-widget-row"},react__WEBPACK_IMPORTED_MODULE_2__.createElement("label",null,"Width: "),react__WEBPACK_IMPORTED_MODULE_2__.createElement(ButtonGroup,{value:this.props.size,allowEmpty:!1,buttons:[{value:"normal",content:"Normal (80px)"},{value:"small",content:"Small (40px)"}],onChange:this.change("size")}),react__WEBPACK_IMPORTED_MODULE_2__.createElement(InfoTip,null,react__WEBPACK_IMPORTED_MODULE_2__.createElement("p",null,'Use size "Normal" for all text boxes, unless there are multiple text boxes in one line and the answer area is too narrow to fit them.'))),rightAlign=react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:"perseus-widget-row"},react__WEBPACK_IMPORTED_MODULE_2__.createElement(PropCheckBox,{label:"Right alignment",rightAlign:this.props.rightAlign,onChange:this.props.onChange})),labelText=react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:"perseus-widget-row"},react__WEBPACK_IMPORTED_MODULE_2__.createElement("label",null,"Label text:"," ",react__WEBPACK_IMPORTED_MODULE_2__.createElement(TextInput,{value:this.props.labelText,onChange:this.change("labelText")})),react__WEBPACK_IMPORTED_MODULE_2__.createElement(InfoTip,null,react__WEBPACK_IMPORTED_MODULE_2__.createElement("p",null,"Text to describe this input. This will be shown to users using screenreaders."))),coefficientCheck=react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:"perseus-widget-row"},react__WEBPACK_IMPORTED_MODULE_2__.createElement(PropCheckBox,{label:"Coefficient",coefficient:this.props.coefficient,onChange:this.props.onChange}),react__WEBPACK_IMPORTED_MODULE_2__.createElement(InfoTip,null,react__WEBPACK_IMPORTED_MODULE_2__.createElement("p",null,"A coefficient style number allows the student to use - for -1 and an empty string to mean 1.")))),addAnswerButton=react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_2__.createElement("a",{href:"javascript:void(0)",className:"simple-button orange",onClick:()=>this.addAnswer(),onKeyDown:e=>this.onSpace(e,this.addAnswer)},react__WEBPACK_IMPORTED_MODULE_2__.createElement("span",null,"Add new answer"))),instructions={wrong:"(address the mistake/misconception)",ungraded:"(explain in detail to avoid confusion)",correct:"(reinforce the user's understanding)"};return react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:"perseus-input-number-editor"},react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:"ui-title"},"User input"),react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:"msg-title"},"Message shown to user on attempt"),(()=>answers.map(((answer,i)=>{const editor=react__WEBPACK_IMPORTED_MODULE_2__.createElement(_editor__WEBPACK_IMPORTED_MODULE_4__.Z,{apiOptions:this.props.apiOptions,content:answer.message||"",placeholder:"Why is this answer "+answer.status+"?\t"+instructions[answer.status],widgetEnabled:!1,onChange:newProps=>{"content"in newProps&&this.updateAnswer(i,{message:newProps.content})}});return react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:"perseus-widget-row",key:i},react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:"input-answer-editor-value-container"+(answer.maxError?" with-max-error":"")},react__WEBPACK_IMPORTED_MODULE_2__.createElement(NumberInput,{value:answer.value,className:"numeric-input-value",placeholder:"answer",format:underscore__WEBPACK_IMPORTED_MODULE_3__.ZP.last(answer.answerForms),onFormatChange:(newValue,format)=>{let forms;"pi"===format?forms=["pi"]:"mixed"===format?forms=["proper","mixed"]:"proper"!==format&&"improper"!==format||(forms=["proper","improper"]),this.updateAnswer(i,{value:firstNumericalParse(newValue),answerForms:forms})},onChange:newValue=>{this.updateAnswer(i,{value:firstNumericalParse(newValue)})}}),answer.strict&&react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:"is-strict-indicator",title:"strictly equivalent to"},"≡"),"required"!==answer.simplify&&"correct"===answer.status&&react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:"simplify-indicator "+answer.simplify,title:"accepts unsimplified answers"},"‰"),answer.maxError?react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:"max-error-container"},react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:"max-error-plusmn"},"±"),react__WEBPACK_IMPORTED_MODULE_2__.createElement(NumberInput,{placeholder:0,value:answers[i].maxError,format:underscore__WEBPACK_IMPORTED_MODULE_3__.ZP.last(answer.answerForms),onChange:this.updateAnswer(i,"maxError")})):null,react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:"value-divider"}),react__WEBPACK_IMPORTED_MODULE_2__.createElement("a",{href:"javascript:void(0)",className:"answer-status "+answer.status,onClick:()=>this.onStatusChange(i),onKeyDown:e=>this.onSpace(e,this.onStatusChange,i)},answer.status),react__WEBPACK_IMPORTED_MODULE_2__.createElement("a",{href:"javascript:void(0)",className:"answer-trash","aria-label":"Delete answer",onClick:()=>this.onTrashAnswer(i),onKeyDown:e=>this.onSpace(e,this.onTrashAnswer,i)},react__WEBPACK_IMPORTED_MODULE_2__.createElement(InlineIcon,iconTrash)),react__WEBPACK_IMPORTED_MODULE_2__.createElement("a",{href:"javascript:void(0)",className:"options-toggle","aria-label":"Toggle options",onClick:()=>this.onToggleOptions(i),onKeyDown:e=>this.onSpace(e,this.onToggleOptions,i)},react__WEBPACK_IMPORTED_MODULE_2__.createElement(InlineIcon,iconGear))),react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:"input-answer-editor-message"},editor),this.state.showOptions[i]&&react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:"options-container"},maxError(i),"correct"===answer.status&&unsimplifiedAnswers(i),suggestedAnswerTypes(i)))})))(),addAnswerButton,inputSize,rightAlign,coefficientCheck,labelText)},change(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _khanacademy_perseus__WEBPACK_IMPORTED_MODULE_0__.ye.m.apply(this,args)},onToggleOptions:function(choiceIndex){const showOptions=this.state.showOptions.slice();showOptions[choiceIndex]=!showOptions[choiceIndex],this.setState({showOptions})},onTrashAnswer:function(choiceIndex){if(choiceIndex>=0&&choiceIndex<this.props.answers.length){const answers=this.props.answers.slice(0);answers.splice(choiceIndex,1),this.props.onChange({answers})}},onSpace:function(e,callback){if(" "===e.key){e.preventDefault();const args=underscore__WEBPACK_IMPORTED_MODULE_3__.ZP.toArray(arguments).slice(2);callback.apply(this,args)}},onStatusChange:function(choiceIndex){const statuses=["wrong","ungraded","correct"],answers=this.props.answers,newStatus=statuses[(underscore__WEBPACK_IMPORTED_MODULE_3__.ZP.indexOf(statuses,answers[choiceIndex].status)+1)%statuses.length];this.updateAnswer(choiceIndex,{status:newStatus,simplify:"correct"===newStatus?"required":"accepted"})},updateAnswer:function(choiceIndex,update){if(!underscore__WEBPACK_IMPORTED_MODULE_3__.ZP.isObject(update))return underscore__WEBPACK_IMPORTED_MODULE_3__.ZP.partial(((choiceIndex,key,value)=>{const update={};update[key]=value,this.updateAnswer(choiceIndex,update)}),choiceIndex,update);let answers=underscore__WEBPACK_IMPORTED_MODULE_3__.ZP.clone(this.props.answers);if(choiceIndex===answers.length){const lastAnswer=initAnswer(this.state.lastStatus);answers=answers.concat(lastAnswer)}answers[choiceIndex]=underscore__WEBPACK_IMPORTED_MODULE_3__.ZP.extend({},answers[choiceIndex],update),this.props.onChange({answers})},addAnswer:function(){const lastAnswer=initAnswer(this.state.lastStatus),answers=this.props.answers.concat(lastAnswer);this.props.onChange({answers})},getSaveWarnings:function(){const warnings=[];return underscore__WEBPACK_IMPORTED_MODULE_3__.ZP.contains(underscore__WEBPACK_IMPORTED_MODULE_3__.ZP.pluck(this.props.answers,"value"),"")&&warnings.push("One or more answers is empty"),this.props.answers.forEach(((answer,i)=>{answer.strict&&(!answer.answerForms||0===answer.answerForms.length)&&warnings.push(`Answer ${i+1} is set to string format matching, but no format was selected`)})),warnings},serialize(){return _khanacademy_perseus__WEBPACK_IMPORTED_MODULE_0__.yU.serialize.call(this)}})}}]);